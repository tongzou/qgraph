{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","qgraph.js","webpack:/webpack/bootstrap dc719c1ba2bfdf4ea9c0","webpack:///src/index.js","webpack:///src/util/base64.js","webpack:///src/util/Utils.js","webpack:///src/geometry/Point.js","webpack:///src/geometry/Rectangle.js","webpack:/external {\"root\":\"_\",\"commonjs\":\"lodash\",\"commonjs2\":\"lodash\",\"amd\":\"lodash\"}","webpack:///src/geometry/Shape.js","webpack:///src/util/DomUtils.js","webpack:///src/util/StringBuffer.js","webpack:///src/geometry/Line.js","webpack:///src/geometry/Ellipse.js","webpack:///src/geometry/Link.js","webpack:///~/bean/bean.js","webpack:///src/event/EventDispatcher.js","webpack:///src/event/KeyUtils.js","webpack:///src/graph/Graph.js","webpack:///src/graph/Node.js","webpack:///src/graph/Cell.js","webpack:///src/util/Cache.js","webpack:///src/view/Label.js","webpack:///src/graph/Edge.js","webpack:///src/view/Marker.js","webpack:///src/layout/Layout.js","webpack:///src/layout/FlowLayout.js","webpack:///src/view/Renderer.js","webpack:///src/behavior/GraphBehavior.js","webpack:///src/behavior/Behavior.js","webpack:///src/behavior/SelectionBehavior.js","webpack:///src/view/SVGRenderer.js"],"names":["root","factory","exports","module","require","define","amd","this","__WEBPACK_EXTERNAL_MODULE_5__","modules","__webpack_require__","moduleId","installedModules","id","loaded","call","m","c","p","_interopRequireDefault","obj","__esModule","default","Object","defineProperty","value","_base","_base2","_Utils","_Utils2","_DomUtils","_DomUtils2","_StringBuffer","_StringBuffer2","_Point","_Point2","_Line","_Line2","_Shape","_Shape2","_Rectangle","_Rectangle2","_Ellipse","_Ellipse2","_Link","_Link2","_bean","_bean2","_EventDispatcher","_EventDispatcher2","_Graph","_Graph2","_Cell","_Cell2","_Node","_Node2","_Edge","_Edge2","_Layout","_Layout2","_FlowLayout","_FlowLayout2","_Label","_Label2","_Marker","_Marker2","_Renderer","_Renderer2","_SVGRenderer","_SVGRenderer2","_GraphBehavior","_GraphBehavior2","_SelectionBehavior","_SelectionBehavior2","addShape","Events","Base64","Cache","Utils","DomUtils","StringBuffer","Point","Line","Shape","Rectangle","Ellipse","Link","EventDispatcher","Label","Marker","Graph","Cell","Node","Edge","Layout","FlowLayout","Renderer","SVGRenderer","GraphBehavior","SelectionBehavior","_keyStr","encode","input","chr1","chr2","chr3","enc1","enc2","enc3","enc4","output","i","_utf8_encode","length","charCodeAt","isNaN","charAt","decode","replace","indexOf","String","fromCharCode","_utf8_decode","string","utftext","n","c1","c2","c3","global","_classCallCheck","instance","Constructor","TypeError","_possibleConstructorReturn","self","ReferenceError","_inherits","subClass","superClass","prototype","create","constructor","enumerable","writable","configurable","setPrototypeOf","__proto__","window","addEventHandler","document","navigator","_debugging","_debugAll","typeRegistry","splice","Array","type","namespace","name","_type","Map","set","get","createType","props","defaultType","extend","_extend","getPrototypeOf","apply","arguments","config","_","assign","typeName","log","buildTypes","types","_this2","remove","defaultsDeep","forEach","child","parent","protoProps","staticProps","Surrogate","superclass","initConfig","cArr","DEFAULTS","prop","getConstructor","jsClass","defaultClass","isString","eval","debug","moduleName","push","message","console","substring","info","getRelativePosition","bounds","geometry","x","Math","abs","width","y","height","offsetPosition","pos","anchorX","offsetX","anchorY","offsetY","unscale","t","scale","o","_scale","getProperty","has","isFunction","_createClass","defineProperties","target","descriptor","key","aPt","sqrt","p2","dist","distance","angle","cos","PI","sin","clone","rotate","rect","vertical","W","N","S","E","NE","NW","SE","SW","_lodash","_lodash2","_Shape3","el","w","h","left","right","top","bottom","pt","contains","pt1","pt2","horizontal","contains1","contains2","outPt","orthogonal","undefined","dx","dy","alpha","atan2","pi","pi2","beta","tan","dir","getDirection","point","direction","pts","margin","isArray","min","max","rects","minx","miny","maxx","Infinity","maxy","each","r","registry","defaults","refPt","getPerimeter","view","template","getTemplate","isIE","sAgent","userAgent","Idx","parseInt","match","isFireFox","InstallTrigger","createElement","tag","attribs","styles","html","setElement","innerHTML","createElementByString","str","temp","childNodes","setAttribute","style","testElement","node","method","nodeType","getAncestorBy","parentNode","getPosition","context","body","elRect","getBoundingClientRect","contextRect","getCenterPosition","move","getSize","offsetWidth","offsetHeight","resize","preloadImages","array","list","img","that","Image","onload","index","src","getImageInfo","downloadImage","image","mime","split","b64toBlob","msSaveBlob","link","href","download","display","appendChild","click","removeChild","b64Data","contentType","sliceSize","byteCharacters","atob","byteArrays","offset","slice","byteNumbers","byteArray","Uint8Array","Blob","openImage","myWindow","open","myDocument","eventFromInput","e","tagName","buffer","stuff","concat","pop","sep","join","start","end","l","cosa","dotProduct","x0","y0","x1","y1","x2","y2","x3","y3","denom","nume_a","nume_b","ua","ub","intersectionX","intersectionY","a","b","cx","cy","px","py","d","f","g","det","xout1","xout2","yout1","yout2","dist1","pow","dist2","xout","yout","defaultConfig","showGauge","defaultGeometry","linkTypes","terminalVisual","shapeConfig","startMarker","endMarker","startNormal","endNormal","renderLink","isNumber","points","translate","getScaled","linkClass","DirectLink","BezierLink","ctrlpts","controlPts","p1","p3","p4","s","EntityRelations","_Link3","source","Port","getBounds","edge","isSourceLeft","isTargetLeft","result","getCenterY","xe","ye","seg","segment","dep","arr","midY","Manhattan","_Link4","MIN_BUFFER","autoRoute","maxChannelWidth","container","boxes","startBox","endBox","side","side2","box","intersect","j","channel","channel2","endPadding","startPadding","_getChannel","_getFirstIntersection","_getRouteTendency","_hasIntersection","_moveSegment","detectIntersection","savedIndex","savedSide","breakPt","_getRouteDirection","getCenter","box2","box1","getLeft","getRight","getBottom","getTop","_moveSegment2","_x7","_x8","_x9","_x10","_x11","toString","getTranslated","h2","h1","equals","findPositions","_mergeSegments","getCommonAncestor","getDescendants","excludeFromRouting","isAncestor","startBufferNormal","endBufferNormal","startBuffer","endBuffer","middle","prunePts","average","getMidPoint","startPositive","endPositive","positions","current","prev","__WEBPACK_AMD_DEFINE_FACTORY__","__WEBPACK_AMD_DEFINE_RESULT__","definition","selectorEngine","win","old","namespaceRegex","nameRegex","addEvent","removeEvent","doc","documentElement","W3C_MODEL","eventSupport","ONE","str2arr","standardNativeEvents","w3cNativeEvents","nativeEvents","hash","events","customEvents","element","compareDocumentPosition","check","event","related","relatedTarget","prefix","test","mouseenter","base","condition","mouseleave","mousewheel","Event","commonProps","mouseProps","mouseWheelProps","keyProps","textProps","touchProps","messageProps","stateProps","overOutRegex","typeFixers","reg","fix","newEvent","keyCode","which","rightClick","button","pageX","pageY","clientX","clientY","scrollLeft","scrollTop","typeFixerMap","isNative","ownerDocument","parentWindow","originalEvent","isBean","fixer","srcElement","preventDefault","returnValue","stopPropagation","cancelBubble","stop","stopped","stopImmediatePropagation","isImmediatePropagationStopped","currentTarget","ne","targetElement","RegEntry","wrappedHandler","fn","args","eargs","findTarget","eventElement","__beanDel","ft","handler","original","namespaces","customType","once","removeListener","eventType","inNamespaces","checkNamespaces","matches","checkElement","checkOriginal","checkHandler","map","forAll","pfx","all","substr","entries","entry","put","del","removed","setSelectorEngine","querySelectorAll","Error","rootListener","propertyName","listeners","listener","add","custom","attachEvent","detachEvent","rm","originalFn","orgType","handlers","delegate","selector","fireListener","evt","createEvent","dispatchEvent","fireEvent","createEventObject","off","typeSpec","k","isTypeStr","hasOwnProperty","on","first","delfn","one","fire","names","from","beanDel","bean","noConflict","cleanup","CollectGarbage","_interopRequireWildcard","newObj","_KeyUtils","KeyUtils","zoomScale","rootNS","getAttribute","dragging","bind","handleEvent","started","enterStack","startKeys","stopKeys","buf","ns","stack","isRoot","startsWith","rootTarget","nsTarget","prepend","targetStack","data","_this","isKeyEvent","getKeyEvent","getEventInfo","wheelDelta","dragObject","mouse","dragPos","mousemove","currentPos","dispatch","mouseup","simulateEnterLeave","last","clearEnterStack","getNS","val","append","item","nsType","regexp","callback","lastPosition","_this3","registerKey","getKeyData","ctrl","alt","shift","meta","code","_this4","unregisterKey","zIndex","_this5","register","RegExp","registeredType","changedTouches","svg","ownerSVGElement","createSVGPoint","matrixTransform","getScreenCTM","inverse","clientLeft","clientTop","KeyboardEvent","ctrlKey","altKey","shiftKey","metaKey","nodeDefaults","role","draggable","selectable","editable","resizable","sourceable","targetable","visible","edgeDefaults","size","color","uniqueId","model","nodes","edges","selection","destroyed","nodeTypes","edgeTypes","markers","marker","markerConfig","getMarker","loadModel","currentRoot","NodeClass","getJSClass","addChild","to","EdgeClass","addNode","addEdge","children","without","allowDanglingEdges","multiConnect","readOnly","viewOnly","_typeof","Symbol","iterator","_Cell3","graph","inEdges","outEdges","ports","_ret","render","v","portName","endPt","shape","getShape","label","_Cache","_Cache2","decorators","createDecorators","views","viewProps","isUndefined","className","computedClassName","viewProp","shapeClass","getView","getLabelBox","renderLabel","_computedClassName","caches","getCache","clear","namesapce","FONT_BOLD","FONT_ITALIC","FONT_UNDERLINE","FONT_SHADOW","fontSize","fontFamily","fontStyle","fontColor","padding","linePadding","align","rotation","labelConfig","containerWidth","containerHeight","_getLabelBox","getLabelBoxForLink","bold","wrappedLabel","wrap","anchor","setAnchorX","pivot","maxBounds","_label","underline","italic","shadow","lineHeight","baseline","stringMeasureEl","measureDiv","baselineDiv","getStringSize","memoize","position","visibility","contentWindow","write","close","getElementById","fontWeight","strut","firstChild","baselineHeight","offsetTop","maxWidth","spaceSize","space","lines","word","words","line","currentWidth","wordWidth","newLine","editor","refEl","textEl","singleLine","unselectable","overflow","border","font-family","font-size","font-weight","focus","select","cancel","_get","object","property","receiver","Function","desc","getOwnPropertyDescriptor","getter","setSource","sourcePos","setTarget","targetPos","setTerminal","setEdgeAt","removeEdge","addOutEdge","addInEdge","center","refPts","getReferencePoints","terminals","getBound","getPort","getLink","getTerminalVisual","arrow","sign","viewBox","ref","fill","triangle","oval","diamond","orientation","toUpperCase","HORIZONTAL","VERTICAL","_Layout3","items","getLinkedNodes","owner","hgap","vgap","_flPos","moveTo","trigger","tabindex","layout","layoutClass","_translate","dispatcher","graphBehavior","selectionBehavior","nodeBehavior","edgeBehavior","connectionBehavior","scaled","_viewport","isNull","vp","transform","refresh","_graph","viewport","initializeBehaviors","renderMarkers","preprocessor","TEMPLATES","parts","part","trim","camelCase","interpolate","gridSize","gBounds","vBounds","parseFloat","defaultClickMode","hideOutline","singleSelect","gridEnabled","guidesEnabled","maxZoom","minZoom","zoomFactor","maskOpacity","_Behavior2","_Behavior3","_Behavior","renderer","handleDrag","handleZoom","pan","Behavior","selectCell","unselectCell","handleMultiSelect","selectedNodes","selectedLinks","attachedLinks","classed","selectedVertices","getShapes","getAttachedEdges","selectedEdges","cell","toggle","isSelected","_firstSelection","d3","dataTarget","moveToFront","setSelection","util","startPt","getBoundingRectangle","rubberband","appendNode","getCellLayer","cells","getCurrentRoot","filter","attr","_Renderer3","NS","SVGElement","createElementNS","outerHTML","$node","$temp","cloneNode","ropen","nodeName","rclose","markup","lastChild","firstElementChild","toDataURL","exportSVG","svg_xml","_svg","svg_dataurl","base64dataURLencode","options","b64","btoa","exportImage","canvas","ctx","getContext","svg_img","drawImage","image_dataurl","onerror","exportImageCanvg","canvg","xcanvas","jsCanvas","keepOutsideViewport","bbox","getBBox","compile","msg","keepNonSafe","renderDefs","querySelector","str1","str2","renderShape","round","newPts","next","d1","d2","corner","_i","getPathData","content","_transform","$root","$edge","Triangle","Rhombus","Hexagon","Polygon","removeLast","Grid","variable"],"mappings":"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","file":"qgraph.min.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory(require(\"lodash\"));\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([\"lodash\"], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"qgraph\"] = factory(require(\"lodash\"));\n\telse\n\t\troot[\"qgraph\"] = factory(root[\"_\"]);\n})(this, function(__WEBPACK_EXTERNAL_MODULE_5__) {\nreturn \n\n\n/** WEBPACK FOOTER **\n ** webpack/universalModuleDefinition\n **/","/*!\n * \n * \tqgraph - A Graph Manipulation and Visualization Library\n * \tAuthor: Tong Zou\n * \tVersion: v0.1.3\n * \tUrl: https://github.com/tongzou/qgraph\n * \tLicense(s): MIT\n * \n */\n(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory(require(\"lodash\"));\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([\"lodash\"], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"qgraph\"] = factory(require(\"lodash\"));\n\telse\n\t\troot[\"qgraph\"] = factory(root[\"_\"]);\n})(this, function(__WEBPACK_EXTERNAL_MODULE_5__) {\nreturn /******/ (function(modules) { // webpackBootstrap\n/******/ \t// The module cache\n/******/ \tvar installedModules = {};\n/******/\n/******/ \t// The require function\n/******/ \tfunction __webpack_require__(moduleId) {\n/******/\n/******/ \t\t// Check if module is in cache\n/******/ \t\tif(installedModules[moduleId])\n/******/ \t\t\treturn installedModules[moduleId].exports;\n/******/\n/******/ \t\t// Create a new module (and put it into the cache)\n/******/ \t\tvar module = installedModules[moduleId] = {\n/******/ \t\t\texports: {},\n/******/ \t\t\tid: moduleId,\n/******/ \t\t\tloaded: false\n/******/ \t\t};\n/******/\n/******/ \t\t// Execute the module function\n/******/ \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n/******/\n/******/ \t\t// Flag the module as loaded\n/******/ \t\tmodule.loaded = true;\n/******/\n/******/ \t\t// Return the exports of the module\n/******/ \t\treturn module.exports;\n/******/ \t}\n/******/\n/******/\n/******/ \t// expose the modules object (__webpack_modules__)\n/******/ \t__webpack_require__.m = modules;\n/******/\n/******/ \t// expose the module cache\n/******/ \t__webpack_require__.c = installedModules;\n/******/\n/******/ \t// __webpack_public_path__\n/******/ \t__webpack_require__.p = \"\";\n/******/\n/******/ \t// Load entry module and return exports\n/******/ \treturn __webpack_require__(0);\n/******/ })\n/************************************************************************/\n/******/ ([\n/* 0 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t\tvalue: true\n\t});\n\t\n\tvar _base = __webpack_require__(1);\n\t\n\tvar _base2 = _interopRequireDefault(_base);\n\t\n\tvar _Utils = __webpack_require__(2);\n\t\n\tvar _Utils2 = _interopRequireDefault(_Utils);\n\t\n\tvar _DomUtils = __webpack_require__(7);\n\t\n\tvar _DomUtils2 = _interopRequireDefault(_DomUtils);\n\t\n\tvar _StringBuffer = __webpack_require__(8);\n\t\n\tvar _StringBuffer2 = _interopRequireDefault(_StringBuffer);\n\t\n\tvar _Point = __webpack_require__(3);\n\t\n\tvar _Point2 = _interopRequireDefault(_Point);\n\t\n\tvar _Line = __webpack_require__(9);\n\t\n\tvar _Line2 = _interopRequireDefault(_Line);\n\t\n\tvar _Shape = __webpack_require__(6);\n\t\n\tvar _Shape2 = _interopRequireDefault(_Shape);\n\t\n\tvar _Rectangle = __webpack_require__(4);\n\t\n\tvar _Rectangle2 = _interopRequireDefault(_Rectangle);\n\t\n\tvar _Ellipse = __webpack_require__(10);\n\t\n\tvar _Ellipse2 = _interopRequireDefault(_Ellipse);\n\t\n\tvar _Link = __webpack_require__(11);\n\t\n\tvar _Link2 = _interopRequireDefault(_Link);\n\t\n\tvar _bean = __webpack_require__(12);\n\t\n\tvar _bean2 = _interopRequireDefault(_bean);\n\t\n\tvar _EventDispatcher = __webpack_require__(13);\n\t\n\tvar _EventDispatcher2 = _interopRequireDefault(_EventDispatcher);\n\t\n\tvar _Graph = __webpack_require__(15);\n\t\n\tvar _Graph2 = _interopRequireDefault(_Graph);\n\t\n\tvar _Cell = __webpack_require__(17);\n\t\n\tvar _Cell2 = _interopRequireDefault(_Cell);\n\t\n\tvar _Node = __webpack_require__(16);\n\t\n\tvar _Node2 = _interopRequireDefault(_Node);\n\t\n\tvar _Edge = __webpack_require__(20);\n\t\n\tvar _Edge2 = _interopRequireDefault(_Edge);\n\t\n\tvar _Layout = __webpack_require__(22);\n\t\n\tvar _Layout2 = _interopRequireDefault(_Layout);\n\t\n\tvar _FlowLayout = __webpack_require__(23);\n\t\n\tvar _FlowLayout2 = _interopRequireDefault(_FlowLayout);\n\t\n\tvar _Label = __webpack_require__(19);\n\t\n\tvar _Label2 = _interopRequireDefault(_Label);\n\t\n\tvar _Marker = __webpack_require__(21);\n\t\n\tvar _Marker2 = _interopRequireDefault(_Marker);\n\t\n\tvar _Renderer = __webpack_require__(24);\n\t\n\tvar _Renderer2 = _interopRequireDefault(_Renderer);\n\t\n\tvar _SVGRenderer = __webpack_require__(28);\n\t\n\tvar _SVGRenderer2 = _interopRequireDefault(_SVGRenderer);\n\t\n\tvar _GraphBehavior = __webpack_require__(25);\n\t\n\tvar _GraphBehavior2 = _interopRequireDefault(_GraphBehavior);\n\t\n\tvar _SelectionBehavior = __webpack_require__(27);\n\t\n\tvar _SelectionBehavior2 = _interopRequireDefault(_SelectionBehavior);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\t_Shape2.default.addShape(\"Rectangle\", _Rectangle2.default);\n\t_Shape2.default.addShape(\"Ellipse\", _Ellipse2.default);\n\t\n\texports.default = {\n\t\tEvents: _bean2.default,\n\t\tBase64: _base2.default,\n\t\tCache: _Utils2.default,\n\t\tUtils: _Utils2.default,\n\t\tDomUtils: _DomUtils2.default,\n\t\tStringBuffer: _StringBuffer2.default,\n\t\tPoint: _Point2.default,\n\t\tLine: _Line2.default,\n\t\tShape: _Shape2.default,\n\t\tRectangle: _Rectangle2.default,\n\t\tEllipse: _Ellipse2.default,\n\t\tLink: _Link2.default,\n\t\tEventDispatcher: _EventDispatcher2.default,\n\t\tLabel: _Label2.default,\n\t\tMarker: _Marker2.default,\n\t\tGraph: _Graph2.default,\n\t\tCell: _Cell2.default,\n\t\tNode: _Node2.default,\n\t\tEdge: _Edge2.default,\n\t\tLayout: _Layout2.default,\n\t\tFlowLayout: _FlowLayout2.default,\n\t\tRenderer: _Renderer2.default,\n\t\tSVGRenderer: _SVGRenderer2.default,\n\t\tGraphBehavior: _GraphBehavior2.default,\n\t\tSelectionBehavior: _SelectionBehavior2.default\n\t};\n\n/***/ },\n/* 1 */\n/***/ function(module, exports) {\n\n\t\"use strict\";\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t\tvalue: true\n\t});\n\t// http://www.webtoolkit.info/javascript-base64.html\n\t\n\tvar Base64 = {\n\t\n\t\t// private property\n\t\t_keyStr: \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=\",\n\t\n\t\t// public method for encoding\n\t\tencode: function encode(input) {\n\t\t\tvar output = \"\";\n\t\t\tvar chr1, chr2, chr3, enc1, enc2, enc3, enc4;\n\t\t\tvar i = 0;\n\t\n\t\t\tinput = Base64._utf8_encode(input);\n\t\n\t\t\twhile (i < input.length) {\n\t\n\t\t\t\tchr1 = input.charCodeAt(i++);\n\t\t\t\tchr2 = input.charCodeAt(i++);\n\t\t\t\tchr3 = input.charCodeAt(i++);\n\t\n\t\t\t\tenc1 = chr1 >> 2;\n\t\t\t\tenc2 = (chr1 & 3) << 4 | chr2 >> 4;\n\t\t\t\tenc3 = (chr2 & 15) << 2 | chr3 >> 6;\n\t\t\t\tenc4 = chr3 & 63;\n\t\n\t\t\t\tif (isNaN(chr2)) {\n\t\t\t\t\tenc3 = enc4 = 64;\n\t\t\t\t} else if (isNaN(chr3)) {\n\t\t\t\t\tenc4 = 64;\n\t\t\t\t}\n\t\n\t\t\t\toutput = output + this._keyStr.charAt(enc1) + this._keyStr.charAt(enc2) + this._keyStr.charAt(enc3) + this._keyStr.charAt(enc4);\n\t\t\t}\n\t\n\t\t\treturn output;\n\t\t},\n\t\n\t\t// public method for decoding\n\t\tdecode: function decode(input) {\n\t\t\tvar output = \"\";\n\t\t\tvar chr1, chr2, chr3;\n\t\t\tvar enc1, enc2, enc3, enc4;\n\t\t\tvar i = 0;\n\t\n\t\t\tinput = input.replace(/[^A-Za-z0-9\\+\\/\\=]/g, \"\");\n\t\n\t\t\twhile (i < input.length) {\n\t\n\t\t\t\tenc1 = this._keyStr.indexOf(input.charAt(i++));\n\t\t\t\tenc2 = this._keyStr.indexOf(input.charAt(i++));\n\t\t\t\tenc3 = this._keyStr.indexOf(input.charAt(i++));\n\t\t\t\tenc4 = this._keyStr.indexOf(input.charAt(i++));\n\t\n\t\t\t\tchr1 = enc1 << 2 | enc2 >> 4;\n\t\t\t\tchr2 = (enc2 & 15) << 4 | enc3 >> 2;\n\t\t\t\tchr3 = (enc3 & 3) << 6 | enc4;\n\t\n\t\t\t\toutput = output + String.fromCharCode(chr1);\n\t\n\t\t\t\tif (enc3 != 64) {\n\t\t\t\t\toutput = output + String.fromCharCode(chr2);\n\t\t\t\t}\n\t\t\t\tif (enc4 != 64) {\n\t\t\t\t\toutput = output + String.fromCharCode(chr3);\n\t\t\t\t}\n\t\t\t}\n\t\n\t\t\toutput = Base64._utf8_decode(output);\n\t\n\t\t\treturn output;\n\t\t},\n\t\n\t\t// private method for UTF-8 encoding\n\t\t_utf8_encode: function _utf8_encode(string) {\n\t\t\tstring = string.replace(/\\r\\n/g, \"\\n\");\n\t\t\tvar utftext = \"\";\n\t\n\t\t\tfor (var n = 0; n < string.length; n++) {\n\t\n\t\t\t\tvar c = string.charCodeAt(n);\n\t\n\t\t\t\tif (c < 128) {\n\t\t\t\t\tutftext += String.fromCharCode(c);\n\t\t\t\t} else if (c > 127 && c < 2048) {\n\t\t\t\t\tutftext += String.fromCharCode(c >> 6 | 192);\n\t\t\t\t\tutftext += String.fromCharCode(c & 63 | 128);\n\t\t\t\t} else {\n\t\t\t\t\tutftext += String.fromCharCode(c >> 12 | 224);\n\t\t\t\t\tutftext += String.fromCharCode(c >> 6 & 63 | 128);\n\t\t\t\t\tutftext += String.fromCharCode(c & 63 | 128);\n\t\t\t\t}\n\t\t\t}\n\t\n\t\t\treturn utftext;\n\t\t},\n\t\n\t\t// private method for UTF-8 decoding\n\t\t_utf8_decode: function _utf8_decode(utftext) {\n\t\t\tvar string = \"\";\n\t\t\tvar i = 0;\n\t\t\tvar c = c1 = c2 = 0;\n\t\n\t\t\twhile (i < utftext.length) {\n\t\n\t\t\t\tc = utftext.charCodeAt(i);\n\t\n\t\t\t\tif (c < 128) {\n\t\t\t\t\tstring += String.fromCharCode(c);\n\t\t\t\t\ti++;\n\t\t\t\t} else if (c > 191 && c < 224) {\n\t\t\t\t\tc2 = utftext.charCodeAt(i + 1);\n\t\t\t\t\tstring += String.fromCharCode((c & 31) << 6 | c2 & 63);\n\t\t\t\t\ti += 2;\n\t\t\t\t} else {\n\t\t\t\t\tc2 = utftext.charCodeAt(i + 1);\n\t\t\t\t\tc3 = utftext.charCodeAt(i + 2);\n\t\t\t\t\tstring += String.fromCharCode((c & 15) << 12 | (c2 & 63) << 6 | c3 & 63);\n\t\t\t\t\ti += 3;\n\t\t\t\t}\n\t\t\t}\n\t\n\t\t\treturn string;\n\t\t}\n\t\n\t};\n\t\n\texports.default = Base64;\n\n/***/ },\n/* 2 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t/* WEBPACK VAR INJECTION */(function(global) {\"use strict\";\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t\tvalue: true\n\t});\n\t\n\tvar _Point = __webpack_require__(3);\n\t\n\tvar _Point2 = _interopRequireDefault(_Point);\n\t\n\tvar _Rectangle = __webpack_require__(4);\n\t\n\tvar _Rectangle2 = _interopRequireDefault(_Rectangle);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\t\n\tfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\t\n\t// bean requires the existence of window\n\tif (typeof window === 'undefined' && typeof global !== 'undefined') {\n\t\tglobal.window = { addEventHandler: function addEventHandler() {} };\n\t\tglobal.document = {};\n\t\tglobal.navigator = {};\n\t}\n\t\n\t// util variables\n\tvar _debugging = [],\n\t    _debugAll = false,\n\t    typeRegistry = {},\n\t    splice = Array.splice;\n\t\n\t/**\n\t * Utility functions\n\t */\n\texports.default = {\n\t\ttype: function type(namespace, name, _type) {\n\t\t\tif (!typeRegistry[namespace]) typeRegistry[namespace] = new Map();\n\t\t\tif (!name) return typeRegistry[namespace];\n\t\t\tif (!_type) return typeRegistry[namespace].get(name);\n\t\t\ttypeRegistry[namespace].set(name, _type);\n\t\t},\n\t\n\t\tcreateType: function createType(namespace, props, defaultType) {\n\t\t\tvar name = props.name;\n\t\n\t\t\t// first check if type exists\n\t\t\tvar type = this.type(namespace, name);\n\t\t\tif (!type) {\n\t\t\t\tvar extend = props.extends ? this.type(namespace, props.extends) : null;\n\t\t\t\tif (!extend && defaultType) extend = defaultType;\n\t\t\t\tif (extend) type = function (_extend) {\n\t\t\t\t\t_inherits(type, _extend);\n\t\n\t\t\t\t\tfunction type() {\n\t\t\t\t\t\t_classCallCheck(this, type);\n\t\n\t\t\t\t\t\treturn _possibleConstructorReturn(this, Object.getPrototypeOf(type).apply(this, arguments));\n\t\t\t\t\t}\n\t\n\t\t\t\t\treturn type;\n\t\t\t\t}(extend);else {\n\t\t\t\t\ttype = function type(config) {\n\t\t\t\t\t\t_classCallCheck(this, type);\n\t\n\t\t\t\t\t\t_.assign(this, config);\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t\tdelete props.name;\n\t\t\t\tdelete props.extends;\n\t\t\t\t_.assign(type.prototype, props);\n\t\t\t\ttype.typeName = name;\n\t\t\t\tthis.type(namespace, name, type);\n\t\t\t\tthis.log('Utils', 'Utils.createType - ' + namespace + '.' + name);\n\t\t\t}\n\t\t\treturn type;\n\t\t},\n\t\n\t\tbuildTypes: function buildTypes(types, namespace, defaultType) {\n\t\t\tvar _this2 = this;\n\t\n\t\t\tthis.log('Utils', 'Utils.buildTypes - ' + namespace);\n\t\n\t\t\tif (!types && defaultType) {\n\t\t\t\tthis.createType(namespace, defaultType);\n\t\t\t\tthis.log('Utils', 'Utils.buildTypes end');\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tif (defaultType) {\n\t\t\t\tvar type = _.remove(types, { name: defaultType.name });\n\t\t\t\ttype = type.length > 0 ? type[0] : null;\n\t\t\t\tif (type) defaultType = this.createType(namespace, _.defaultsDeep(type, defaultType));else defaultType = this.createType(namespace, defaultType);\n\t\t\t}\n\t\n\t\t\t_.forEach(types, function (type) {\n\t\t\t\t_this2.createType(namespace, type, defaultType);\n\t\t\t});\n\t\t\tthis.log('Utils', 'Utils.buildTypes end');\n\t\t},\n\t\n\t\t// Helper function to correctly set up the prototype chain, for subclasses.\n\t\t// Similar to `goog.inherits`, but uses a hash of prototype properties and\n\t\t// class properties to be extended.\n\t\textend: function extend(child, parent, protoProps, staticProps) {\n\t\t\t// Add static properties to the constructor function, if supplied.\n\t\t\t_.extend(child, parent, staticProps);\n\t\n\t\t\t// Set the prototype chain to inherit from `parent`, without calling\n\t\t\t// `parent`'s constructor function.\n\t\t\tvar Surrogate = function Surrogate() {\n\t\t\t\tthis.constructor = child;\n\t\t\t};\n\t\t\tSurrogate.prototype = parent.prototype;\n\t\t\tchild.prototype = new Surrogate();\n\t\n\t\t\t// Add prototype properties (instance properties) to the subclass,\n\t\t\t// if supplied.\n\t\t\tif (protoProps) _.extend(child.prototype, protoProps);\n\t\n\t\t\t// Set a convenience property in case the parent's prototype is needed later.\n\t\t\tchild.superclass = parent.prototype;\n\t\n\t\t\treturn child;\n\t\t},\n\t\n\t\tinitConfig: function initConfig(obj, config) {\n\t\t\tvar props = {},\n\t\t\t    c = obj.constructor,\n\t\t\t    cArr = [c];\n\t\t\twhile (c) {\n\t\t\t\tif (c.super) {\n\t\t\t\t\tc = c.super.constructor;\n\t\t\t\t\tsplice.apply(cArr, [0, 0, c]);\n\t\t\t\t} else c = null;\n\t\t\t}\n\t\n\t\t\tfor (var i = 0; i < cArr.length; i++) {\n\t\t\t\tc = cArr[i];\n\t\t\t\tif (c.DEFAULTS) _.assign(props, c.DEFAULTS);\n\t\t\t}\n\t\t\tobj.props = _.assign(props, config);\n\t\t\tc.prototype.prop = function (name, value) {\n\t\t\t\tif (!value) return this.props[name];\n\t\t\t\tthis.props[name] = value;\n\t\t\t};\n\t\t},\n\t\n\t\t/**\n\t  * Gets the JS class constructor.\n\t  * @param {Object} jsClass\n\t  * @param {Object} defaultClass\n\t  */\n\t\tgetConstructor: function getConstructor(jsClass, defaultClass) {\n\t\t\tif (!jsClass) jsClass = defaultClass;\n\t\n\t\t\tif (_.isString(jsClass)) jsClass = eval(jsClass);\n\t\t\treturn jsClass;\n\t\t},\n\t\n\t\tdebug: function debug(moduleName) {\n\t\t\tif (moduleName) {\n\t\t\t\t_debugging.push(moduleName);\n\t\t\t} else {\n\t\t\t\t_debugAll = true;\n\t\t\t}\n\t\t},\n\t\n\t\tlog: function log(name, message) {\n\t\t\tif (!window.console) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tvar debug = _debugAll;\n\t\t\tif (!_debugAll) {\n\t\t\t\tdebug = false;\n\t\t\t\tfor (var i = 0; i < _debugging.length; i++) {\n\t\t\t\t\tif (_debugging[i] == name) debug = true;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (!debug) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\twhile (name.length < 10) {\n\t\t\t\tname = name + ' ';\n\t\t\t}\n\t\t\tname = name.substring(0, 10) + \" - \";\n\t\t\tconsole.info(name, message);\n\t\t},\n\t\n\t\t/**\n\t  * Get the relative position of sub shapes within a parent share.\n\t  * @param bounds\n\t  * @param geometry The geometry information, the format of Geometry is:\n\t  * {\n\t  *      x: \"x coordinate of ref point, if less than 1, will be treated as the percentage of the parent width.\",\n\t  *      y: \"y coordinate of ref point.\",\n\t  *      anchorX: \"x pos of child relative to the ref point\",\n\t  *      anchorY: \"y pos of child relative to the ref point\",\n\t  *      offsetX: \"the offset in the x direction.\",\n\t  *      offsetY: \"the offset in the y direction.\",\n\t  *      width: \"the width of the child element\",\n\t  *      height: \"the height of the child element\"\n\t  * }\n\t  * @returns {*[]}\n\t  */\n\t\tgetRelativePosition: function getRelativePosition(bounds, geometry) {\n\t\t\tvar x = Math.abs(geometry.x) <= 1 ? bounds.width * geometry.x : geometry.x;\n\t\t\tvar y = Math.abs(geometry.y) <= 1 ? bounds.height * geometry.y : geometry.y;\n\t\t\treturn this.offsetPosition([x, y], geometry);\n\t\t},\n\t\n\t\toffsetPosition: function offsetPosition(pos, geometry) {\n\t\t\treturn [pos[0] + geometry.width * geometry.anchorX + geometry.offsetX, pos[1] + geometry.height * geometry.anchorY + geometry.offsetY];\n\t\t},\n\t\n\t\t/**\n\t  * Get the position relative to the graph that's unscaled, i.e., absolute position without considering translation and scale.\n\t  * @param t the current translate\n\t  * @param scale the current scale\n\t  * @param o can be either a Point or a Rectangle or a Point array.\n\t  */\n\t\tunscale: function unscale(t, scale, o) {\n\t\t\tif (o instanceof _Rectangle2.default) return new _Rectangle2.default(o.x * scale + t[0], o.y * scale + t[1], o.width * scale, o.height * scale);else if (o instanceof _Point2.default) return new _Point2.default(o.x * scale + t[0], o.y * scale + t[1]);else return [o[0] * scale + t[0], o[1] * scale + t[1]];\n\t\t},\n\t\n\t\t/**\n\t  * Get the position relative to the graph that's scaled, i.e., relative position considering translation and scale.\n\t  * @param t the current translation\n\t  * @param scale the current scale\n\t  * @param o can be either a Point or a Rectangle or a Point array.\n\t  */\n\t\tscale: function scale(t, _scale, o) {\n\t\t\tif (o instanceof _Rectangle2.default) return new _Rectangle2.default((o.x - t[0]) / _scale, (o.y - t[1]) / _scale, o.width / _scale, o.height / _scale);else if (o instanceof _Point2.default) return new _Point2.default((o.x - t[0]) / _scale, (o.y - t[1]) / _scale);else return [(o[0] - t[0]) / _scale, (o[1] - t[1]) / _scale];\n\t\t},\n\t\n\t\t/**\n\t  * Convenience method.\n\t  */\n\t\tgetProperty: function getProperty(obj, prop) {\n\t\t\tif (!obj) return null;\n\t\t\tif (_.has(obj, prop)) return obj[prop];\n\t\t\tif (obj.prop && _.isFunction(obj.prop)) return obj.prop(prop);\n\t\t\treturn null;\n\t\t}\n\t};\n\t/* WEBPACK VAR INJECTION */}.call(exports, (function() { return this; }())))\n\n/***/ },\n/* 3 */\n/***/ function(module, exports) {\n\n\t\"use strict\";\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t\tvalue: true\n\t});\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tvar Point = function () {\n\t\tfunction Point(x, y) {\n\t\t\t_classCallCheck(this, Point);\n\t\n\t\t\tthis.x = x;\n\t\t\tthis.y = y;\n\t\t}\n\t\n\t\t/**\n\t  * Make a clone of this point\n\t  */\n\t\n\t\n\t\t_createClass(Point, [{\n\t\t\tkey: \"clone\",\n\t\t\tvalue: function clone() {\n\t\t\t\treturn new Point(this.x, this.y);\n\t\t\t}\n\t\n\t\t\t/**\n\t   * Calculate the distance from this pt to the other pt.\n\t   * @param aPt\n\t   * @returns {number}\n\t   */\n\t\n\t\t}, {\n\t\t\tkey: \"distance\",\n\t\t\tvalue: function distance(aPt) {\n\t\t\t\treturn Math.sqrt((this.x - aPt.x) * (this.x - aPt.x) + (this.y - aPt.y) * (this.y - aPt.y));\n\t\t\t}\n\t\n\t\t\t/**\n\t   * Translate this point\n\t  \t */\n\t\n\t\t}, {\n\t\t\tkey: \"translate\",\n\t\t\tvalue: function translate(p2) {\n\t\t\t\tthis.x += p2.x;\n\t\t\t\tthis.y += p2.y;\n\t\t\t\treturn this;\n\t\t\t}\n\t\n\t\t\t/**\n\t   * Scale this vector\n\t  \t */\n\t\n\t\t}, {\n\t\t\tkey: \"scale\",\n\t\t\tvalue: function scale(_scale) {\n\t\t\t\tthis.x *= _scale;\n\t\t\t\tthis.y *= _scale;\n\t\t\t\treturn this;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"getScaled\",\n\t\t\tvalue: function getScaled(scale) {\n\t\t\t\treturn new Point(this.x * scale, this.y * scale);\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"getTranslated\",\n\t\t\tvalue: function getTranslated(p2) {\n\t\t\t\treturn new Point(this.x + p2.x, this.y + p2.y);\n\t\t\t}\n\t\n\t\t\t/**\n\t   * Get the direction vector from this point to p2.\n\t   * @param p2\n\t   * @returns {Point}\n\t   */\n\t\n\t\t}, {\n\t\t\tkey: \"getDirection\",\n\t\t\tvalue: function getDirection(p2) {\n\t\t\t\tvar dist = this.distance(p2);\n\t\t\t\treturn new Point((p2.x - this.x) / dist, (p2.y - this.y) / dist);\n\t\t\t}\n\t\n\t\t\t/**\n\t   * rotate the point about the origin. With the specified angle.\n\t   * @param angle the angle to rotate\n\t   */\n\t\n\t\t}, {\n\t\t\tkey: \"rotate\",\n\t\t\tvalue: function rotate(angle) {\n\t\t\t\tvar cos = Math.cos(angle * Math.PI / 180);\n\t\t\t\tvar sin = Math.sin(angle * Math.PI / 180);\n\t\t\t\tvar x = this.x,\n\t\t\t\t    y = this.y;\n\t\t\t\tthis.x = x * cos - y * sin;\n\t\t\t\tthis.y = x * sin + y * cos;\n\t\t\t\treturn this;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"getRotated\",\n\t\t\tvalue: function getRotated(angle) {\n\t\t\t\treturn this.clone().rotate(angle);\n\t\t\t}\n\t\n\t\t\t/**\n\t   * Calculate the dot product, treating this and p2 as vectors.\n\t   */\n\t\n\t\t}, {\n\t\t\tkey: \"dotProduct\",\n\t\t\tvalue: function dotProduct(p2) {\n\t\t\t\treturn this.x * p2.x + this.y * p2.y;\n\t\t\t}\n\t\n\t\t\t/**\n\t   * Get the mid point between this and p2.\n\t  \t */\n\t\n\t\t}, {\n\t\t\tkey: \"getMidPoint\",\n\t\t\tvalue: function getMidPoint(p2) {\n\t\t\t\treturn new Point((this.x + p2.x) / 2, (this.y + p2.y) / 2);\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"reverse\",\n\t\t\tvalue: function reverse() {\n\t\t\t\tthis.x = -this.x;\n\t\t\t\tthis.y = -this.y;\n\t\t\t\treturn this;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"equals\",\n\t\t\tvalue: function equals(p2) {\n\t\t\t\tif (!p2 || p2.constructor != Point) return false;\n\t\n\t\t\t\treturn this.x == p2.x && this.y == p2.y;\n\t\t\t}\n\t\n\t\t\t/**\n\t   * Reflect this point w.r.t. the rectangle.\n\t   * If vertical is true, it will reflect the point cross the vertical\n\t   * central line of the rectangle, otherwise reflect cross the horizontal\n\t   * central line.\n\t   *\n\t   * @param rect the rectangle\n\t   * @param vertical whether is vertical reflection or horizontal reflection.\n\t   */\n\t\n\t\t}, {\n\t\t\tkey: \"reflect\",\n\t\t\tvalue: function reflect(rect, vertical) {\n\t\t\t\tif (vertical) this.x = 2 * rect.x - this.x;else this.y = 2 * rect.y - this.y;\n\t\t\t\treturn this;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"toString\",\n\t\t\tvalue: function toString() {\n\t\t\t\treturn this.x + \",\" + this.y;\n\t\t\t}\n\t\t}]);\n\t\n\t\treturn Point;\n\t}();\n\t\n\tPoint.W = new Point(-1, 0);\n\tPoint.N = new Point(0, -1);\n\tPoint.S = new Point(0, 1);\n\tPoint.E = new Point(1, 0);\n\tPoint.NE = new Point(1, -1);\n\tPoint.NW = new Point(-1, -1);\n\tPoint.SE = new Point(1, 1);\n\tPoint.SW = new Point(-1, 1);\n\t\n\texports.default = Point;\n\n/***/ },\n/* 4 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t\tvalue: true\n\t});\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tvar _lodash = __webpack_require__(5);\n\t\n\tvar _lodash2 = _interopRequireDefault(_lodash);\n\t\n\tvar _Point = __webpack_require__(3);\n\t\n\tvar _Point2 = _interopRequireDefault(_Point);\n\t\n\tvar _Shape2 = __webpack_require__(6);\n\t\n\tvar _Shape3 = _interopRequireDefault(_Shape2);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\t\n\tfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\t\n\tvar Rectangle = function (_Shape) {\n\t\t_inherits(Rectangle, _Shape);\n\t\n\t\tfunction Rectangle() {\n\t\t\t_classCallCheck(this, Rectangle);\n\t\n\t\t\treturn _possibleConstructorReturn(this, Object.getPrototypeOf(Rectangle).apply(this, arguments));\n\t\t}\n\t\n\t\t_createClass(Rectangle, [{\n\t\t\tkey: \"contains\",\n\t\n\t\t\t/**\r\n\t   * Checks whether this rectangle contains a given point of a given rectangle\r\n\t   */\n\t\t\tvalue: function contains(el) {\n\t\t\t\tvar w = el.width || 0;\n\t\t\t\tvar h = el.height || 0;\n\t\t\t\tvar left = el.x - w / 2;\n\t\t\t\tvar right = el.x + w / 2;\n\t\t\t\tvar top = el.y - h / 2;\n\t\t\t\tvar bottom = el.y + h / 2;\n\t\t\t\treturn right <= this.right && left >= this.left && top >= this.top && bottom <= this.bottom;\n\t\t\t}\n\t\n\t\t\t/**\r\n\t   * Calcualte the distance to a point. 0 if this rectangle contains the point.\r\n\t   */\n\t\n\t\t}, {\n\t\t\tkey: \"distance\",\n\t\t\tvalue: function distance(pt) {\n\t\t\t\tif (this.contains(pt)) return 0;\n\t\n\t\t\t\tif (pt.x < this.left) {\n\t\t\t\t\tif (pt.y < this.top) return pt.distance(new _Point2.default(this.left, this.top));\n\t\t\t\t\tif (pt.y <= this.bottom) return this.left - pt.x;\n\t\t\t\t\treturn pt.distance(new _Point2.default(this.left, this.bottom));\n\t\t\t\t}\n\t\t\t\tif (pt.x <= this.right) {\n\t\t\t\t\tif (pt.y <= this.top) return this.top - pt.y;\n\t\t\t\t\treturn pt.y - this.bottom;\n\t\t\t\t}\n\t\t\t\tif (pt.y < this.top) return pt.distance(new _Point2.default(this.right, this.top));\n\t\t\t\tif (pt.y <= this.bottom) return pt.x - this.right;\n\t\t\t\treturn pt.distance(new _Point2.default(this.right, this.bottom));\n\t\t\t}\n\t\n\t\t\t/**\r\n\t   * Given two points, we want to detect whether the line joining the pts intersect\r\n\t   * with the rectangle or not. We assume only horizontal or vertical line segments.\r\n\t   *\r\n\t   * @return int the side of the intersection: -1: no intersection, 0: left, 1: top, 2: right, 3: bottom, 4: containment.\r\n\t   */\n\t\n\t\t}, {\n\t\t\tkey: \"detectIntersection\",\n\t\t\tvalue: function detectIntersection(pt1, pt2) {\n\t\t\t\tvar horizontal = pt1.y == pt2.y;\n\t\t\t\tvar contains1 = this.contains(pt1);\n\t\t\t\tvar contains2 = this.contains(pt2);\n\t\t\t\tif (contains1 && contains2) return 4;\n\t\t\t\tif (!contains1 && !contains2) {\n\t\t\t\t\tif (horizontal && pt1.y >= this.top && pt1.y <= this.bottom) {\n\t\t\t\t\t\tif (pt1.x < this.left && pt2.x > this.right) return 0;\n\t\t\t\t\t\tif (pt1.x > this.right && pt2.x < this.left) return 2;\n\t\t\t\t\t}\n\t\t\t\t\tif (!horizontal && pt1.x >= this.left && pt1.x <= this.right) {\n\t\t\t\t\t\tif (pt1.y < this.top && pt2.y > this.bottom) return 1;\n\t\t\t\t\t\tif (pt1.y > this.bottom && pt2.y < this.top) return 3;\n\t\t\t\t\t}\n\t\t\t\t\treturn -1;\n\t\t\t\t}\n\t\n\t\t\t\tvar outPt = contains1 ? pt2 : pt1;\n\t\t\t\tif (horizontal) {\n\t\t\t\t\tif (outPt.x > this.right) return 2;\n\t\t\t\t\treturn 0;\n\t\t\t\t} else {\n\t\t\t\t\tif (outPt.y < this.top) return 1;\n\t\t\t\t\treturn 3;\n\t\t\t\t}\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"toString\",\n\t\t\tvalue: function toString() {\n\t\t\t\treturn 'Rectangle:{x=' + this.x + ';y=' + this.y + ';width=' + this.width + ';height=' + this.height + '}';\n\t\t\t}\n\t\t}], [{\n\t\t\tkey: \"getPerimeter\",\n\t\t\tvalue: function getPerimeter(rect, pt) {\n\t\t\t\tvar orthogonal = arguments.length <= 2 || arguments[2] === undefined ? false : arguments[2];\n\t\n\t\t\t\tvar x = rect.x;\n\t\t\t\tvar y = rect.y;\n\t\t\t\tvar dx = pt.x - x;\n\t\t\t\tvar dy = pt.y - y;\n\t\t\t\tvar alpha = Math.atan2(dy, dx);\n\t\t\t\tvar p = new _Point2.default(0, 0);\n\t\t\t\tvar pi = Math.PI;\n\t\t\t\tvar pi2 = Math.PI / 2;\n\t\t\t\tvar beta = pi2 - alpha;\n\t\t\t\tvar t = Math.atan2(rect.height, rect.width);\n\t\n\t\t\t\tif (alpha < -pi + t || alpha > pi - t) {\n\t\t\t\t\t// Left edge\n\t\t\t\t\tp.x = rect.left;\n\t\t\t\t\tp.y = y - rect.width * Math.tan(alpha) / 2;\n\t\t\t\t} else if (alpha < -t) {\n\t\t\t\t\t// Top Edge\n\t\t\t\t\tp.y = rect.top;\n\t\t\t\t\tp.x = x - rect.height * Math.tan(beta) / 2;\n\t\t\t\t} else if (alpha < t) {\n\t\t\t\t\t// Right Edge\n\t\t\t\t\tp.x = rect.right;\n\t\t\t\t\tp.y = y + rect.width * Math.tan(alpha) / 2;\n\t\t\t\t} else {\n\t\t\t\t\t// Bottom Edge\n\t\t\t\t\tp.y = rect.bottom;\n\t\t\t\t\tp.x = x + rect.height * Math.tan(beta) / 2;\n\t\t\t\t}\n\t\n\t\t\t\tif (orthogonal) {\n\t\t\t\t\tif (alpha < -pi + t || alpha > pi - t) {\n\t\t\t\t\t\t// Left edge\n\t\t\t\t\t\tp.x = rect.left;\n\t\t\t\t\t\tp.y = y;\n\t\t\t\t\t} else if (alpha < -t) {\n\t\t\t\t\t\t// Top Edge\n\t\t\t\t\t\tp.y = rect.top;\n\t\t\t\t\t\tp.x = x;\n\t\t\t\t\t} else if (alpha < t) {\n\t\t\t\t\t\t// Right Edge\n\t\t\t\t\t\tp.x = rect.right;\n\t\t\t\t\t\tp.y = y;\n\t\t\t\t\t} else {\n\t\t\t\t\t\t// Bottom Edge\n\t\t\t\t\t\tp.y = rect.bottom;\n\t\t\t\t\t\tp.x = x;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\n\t\t\t\tvar dir = Rectangle.getDirection(rect, p, orthogonal);\n\t\t\t\treturn { point: p, direction: dir };\n\t\t\t}\n\t\n\t\t\t/**\r\n\t   * Return the bounding rectangle that contains p1 and p2\r\n\t   */\n\t\n\t\t}, {\n\t\t\tkey: \"getBoundingRectangle\",\n\t\t\tvalue: function getBoundingRectangle(pts, margin) {\n\t\t\t\tif (!pts || pts.length == 0) return null;\n\t\t\t\tmargin = margin || [0, 0, 0, 0];\n\t\t\t\tif (!_lodash2.default.isArray(margin)) margin = [margin, margin, margin, margin];\n\t\t\t\tvar min = [pts[0].x, pts[0].y];\n\t\t\t\tvar max = [pts[0].x, pts[0].y];\n\t\t\t\tfor (var i = 1; i < pts.length; i++) {\n\t\t\t\t\tvar p = pts[i];\n\t\t\t\t\tif (p.x < min[0]) {\n\t\t\t\t\t\tmin[0] = p.x;\n\t\t\t\t\t}\n\t\t\t\t\tif (p.y < min[1]) {\n\t\t\t\t\t\tmin[1] = p.y;\n\t\t\t\t\t}\n\t\t\t\t\tif (p.x > max[0]) {\n\t\t\t\t\t\tmax[0] = p.x;\n\t\t\t\t\t}\n\t\t\t\t\tif (p.y > max[1]) {\n\t\t\t\t\t\tmax[1] = p.y;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tmin[0] = min[0] - margin[0];\n\t\t\t\tmin[1] = min[1] - margin[1];\n\t\t\t\tmax[0] = max[0] + margin[2];\n\t\t\t\tmax[1] = max[1] + margin[3];\n\t\t\t\tvar w = Math.abs(max[0] - min[0]);\n\t\t\t\tvar h = Math.abs(max[1] - min[1]);\n\t\t\t\treturn new Rectangle(min[0] + w / 2, min[1] + h / 2, w, h);\n\t\t\t}\n\t\n\t\t\t/**\r\n\t   * Create a union of all the rectangles.\r\n\t   * @param rects\r\n\t   */\n\t\n\t\t}, {\n\t\t\tkey: \"union\",\n\t\t\tvalue: function union(rects) {\n\t\t\t\tvar minx = null,\n\t\t\t\t    miny = null,\n\t\t\t\t    maxx = -Infinity,\n\t\t\t\t    maxy = -Infinity;\n\t\t\t\t_lodash2.default.each(rects, function (rect) {\n\t\t\t\t\tminx = minx || rect.x;\n\t\t\t\t\tminy = miny || rect.y;\n\t\t\t\t\tminx = Math.min(minx, rect.x);\n\t\t\t\t\tminy = Math.min(miny, rect.y);\n\t\t\t\t\tmaxx = Math.max(maxx, rect.right());\n\t\t\t\t\tmaxy = Math.max(maxy, rect.bottom());\n\t\t\t\t});\n\t\t\t\tminx = minx || 0;\n\t\t\t\tminy = miny || 0;\n\t\t\t\treturn new Rectangle(minx, miny, maxx - minx, maxy - miny);\n\t\t\t}\n\t\n\t\t\t/**\r\n\t   * Returns the direction the point <i>p</i> is in relation to the given rectangle.\r\n\t   * Possible values are WEST (-1,0), EAST (1,0), NORTH (0,-1) and SOUTH (0,1) if orthogonal is true, otherwise return\r\n\t   * the direction connection the center of r and p.\r\n\t   * @param r\r\n\t   * @param p\r\n\t   * @param orthogonal\r\n\t   * @returns {Point|*}\r\n\t   */\n\t\n\t\t}, {\n\t\t\tkey: \"getDirection\",\n\t\t\tvalue: function getDirection(r, p) {\n\t\t\t\tvar orthogonal = arguments.length <= 2 || arguments[2] === undefined ? false : arguments[2];\n\t\n\t\t\t\tif (!orthogonal) return new _Point2.default(r.x, r.y).getDirection(new _Point2.default(p.x, p.y));\n\t\n\t\t\t\tvar i = void 0,\n\t\t\t\t    distance = Math.abs(r.left - p.x),\n\t\t\t\t    direction = _Point2.default.W;\n\t\n\t\t\t\ti = Math.abs(r.top - p.y);\n\t\t\t\tif (i <= distance) {\n\t\t\t\t\tdistance = i;\n\t\t\t\t\tdirection = _Point2.default.N;\n\t\t\t\t}\n\t\n\t\t\t\ti = Math.abs(r.bottom - p.y);\n\t\t\t\tif (i <= distance) {\n\t\t\t\t\tdistance = i;\n\t\t\t\t\tdirection = _Point2.default.S;\n\t\t\t\t}\n\t\n\t\t\t\ti = Math.abs(r.right - p.x);\n\t\t\t\tif (i < distance) {\n\t\t\t\t\tdirection = _Point2.default.E;\n\t\t\t\t}\n\t\n\t\t\t\treturn direction;\n\t\t\t}\n\t\t}]);\n\t\n\t\treturn Rectangle;\n\t}(_Shape3.default);\n\t\n\texports.default = Rectangle;\n\n/***/ },\n/* 5 */\n/***/ function(module, exports) {\n\n\tmodule.exports = __WEBPACK_EXTERNAL_MODULE_5__;\n\n/***/ },\n/* 6 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t\tvalue: true\n\t});\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tvar _lodash = __webpack_require__(5);\n\t\n\tvar _lodash2 = _interopRequireDefault(_lodash);\n\t\n\tvar _Point = __webpack_require__(3);\n\t\n\tvar _Point2 = _interopRequireDefault(_Point);\n\t\n\tvar _Rectangle = __webpack_require__(4);\n\t\n\tvar _Rectangle2 = _interopRequireDefault(_Rectangle);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tvar registry = {};\n\t\n\tvar Shape = function () {\n\t\tfunction Shape(x, y, width, height, config) {\n\t\t\t_classCallCheck(this, Shape);\n\t\n\t\t\tthis.x = x;\n\t\t\tthis.y = y;\n\t\t\tthis.width = width;\n\t\t\tthis.height = height;\n\t\t\t_lodash2.default.defaults(this, config, { x: 0, y: 0, width: 0, height: 0 });\n\t\t}\n\t\n\t\t/**\n\t  * Return the y-coord of the top side of this rectangle\n\t  */\n\t\n\t\n\t\t_createClass(Shape, [{\n\t\t\tkey: \"contains\",\n\t\t\tvalue: function contains(el) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\n\t\t\t/**\n\t   * This will generate n ports on the shape.\n\t   */\n\t\n\t\t}, {\n\t\t\tkey: \"getRegularPoints\",\n\t\t\tvalue: function getRegularPoints(n) {\n\t\t\t\treturn null;\n\t\t\t}\n\t\n\t\t\t/**\n\t   * Get the intersection between boundary of this shape and the line connecting (x,y) with the refPt.\n\t   * @param refPt\n\t   * @returns {null}\n\t   */\n\t\n\t\t}, {\n\t\t\tkey: \"getPerimeter\",\n\t\t\tvalue: function getPerimeter(refPt) {\n\t\t\t\tvar orthogonal = arguments.length <= 1 || arguments[1] === undefined ? false : arguments[1];\n\t\n\t\t\t\treturn this.constructor.getPerimeter(this, refPt, orthogonal);\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"render\",\n\t\t\tvalue: function render(view) {\n\t\t\t\tvar template = _lodash2.default.template(view.getTemplate(this.name, this));\n\t\t\t\treturn template(this);\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"top\",\n\t\t\tget: function get() {\n\t\t\t\treturn this.y - this.height / 2;\n\t\t\t}\n\t\n\t\t\t/**\n\t   * Returns the y-coordinate of the bottom of this Rectangle.\n\t   */\n\t\n\t\t}, {\n\t\t\tkey: \"bottom\",\n\t\t\tget: function get() {\n\t\t\t\treturn this.y + this.height / 2;\n\t\t\t}\n\t\n\t\t\t/**\n\t   * Return the x-coord of left side of this rectangle\n\t   */\n\t\n\t\t}, {\n\t\t\tkey: \"left\",\n\t\t\tget: function get() {\n\t\t\t\treturn this.x - this.width / 2;\n\t\t\t}\n\t\n\t\t\t/**\n\t   * Returns the x-coordinate of the right side of this Rectangle.\n\t   */\n\t\n\t\t}, {\n\t\t\tkey: \"right\",\n\t\t\tget: function get() {\n\t\t\t\treturn this.x + this.width / 2;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"center\",\n\t\t\tget: function get() {\n\t\t\t\treturn new _Point2.default(this.x, this.y);\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"bounds\",\n\t\t\tget: function get() {\n\t\t\t\treturn new _Rectangle2.default(this.x, this.y, this.width, this.height);\n\t\t\t}\n\t\t}], [{\n\t\t\tkey: \"getShape\",\n\t\t\tvalue: function getShape(name) {\n\t\t\t\treturn registry[name];\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"addShape\",\n\t\t\tvalue: function addShape(name, c) {\n\t\t\t\tregistry[name] = c;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"removeShape\",\n\t\t\tvalue: function removeShape(name) {\n\t\t\t\tdelete registry[name];\n\t\t\t}\n\t\t}]);\n\t\n\t\treturn Shape;\n\t}();\n\t\n\texports.default = Shape;\n\n/***/ },\n/* 7 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t\tvalue: true\n\t});\n\t\n\tvar _lodash = __webpack_require__(5);\n\t\n\tvar _lodash2 = _interopRequireDefault(_lodash);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\t/**\n\t * dom Utility functions\n\t */\n\texports.default = {\n\t\tisIE: function () {\n\t\t\tif (!window || !window.navigator || !navigator) return false;\n\t\t\tvar sAgent = window.navigator.userAgent;\n\t\t\tvar Idx = sAgent.indexOf(\"MSIE\");\n\t\n\t\t\t// If IE, return version number.\n\t\t\tif (Idx > 0) return parseInt(sAgent.substring(Idx + 5, sAgent.indexOf(\".\", Idx)));\n\t\n\t\t\t// If IE 11 then look for Updated user agent string.\n\t\t\telse if (!!navigator.userAgent.match(/Trident\\/7\\./)) return 11;else return false;\n\t\t}(),\n\t\n\t\tisFireFox: function () {\n\t\t\t// InstallTrigger: Firefox's API to install add-ons\n\t\t\treturn typeof InstallTrigger !== 'undefined';\n\t\t}(),\n\t\n\t\tcreateElement: function createElement(tag, attribs, styles, html) {\n\t\t\tvar el = document.createElement(tag);\n\t\t\tthis.setElement(el, attribs, styles);\n\t\t\tif (html) el.innerHTML = html;\n\t\t\treturn el;\n\t\t},\n\t\n\t\tcreateElementByString: function createElementByString(str) {\n\t\t\tvar temp = this.createElement('div', null, null, str);\n\t\t\treturn temp.childNodes;\n\t\t},\n\t\n\t\tsetElement: function setElement(el, attribs, styles) {\n\t\t\tif (attribs) {\n\t\t\t\t_lodash2.default.forEach(attribs, function (value, key) {\n\t\t\t\t\tel.setAttribute(key, value);\n\t\t\t\t});\n\t\t\t}\n\t\t\tif (styles) {\n\t\t\t\t_lodash2.default.forEach(styles, function (value, key) {\n\t\t\t\t\tel.style[key] = value;\n\t\t\t\t});\n\t\t\t}\n\t\t},\n\t\n\t\ttestElement: function testElement(node, method) {\n\t\t\treturn node && node.nodeType == 1 && (!method || method(node));\n\t\t},\n\t\n\t\tgetAncestorBy: function getAncestorBy(node, method) {\n\t\t\twhile (node = node.parentNode) {\n\t\t\t\tif (this.testElement(node, method)) return node;\n\t\t\t}return null;\n\t\t},\n\t\n\t\t/**\n\t  * Get the position of element relative to the context.\n\t  * @param el the element\n\t  * @param context\n\t  * @returns {*[]}\n\t  */\n\t\tgetPosition: function getPosition(el, context) {\n\t\t\tif (!context) context = document.body;\n\t\t\tvar elRect = el.getBoundingClientRect();\n\t\t\tvar contextRect = context.getBoundingClientRect();\n\t\n\t\t\treturn [elRect.left - contextRect.left, elRect.top - contextRect.top];\n\t\t},\n\t\tgetCenterPosition: function getCenterPosition(el, context) {\n\t\t\tif (!context) context = document.body;\n\t\t\tvar elRect = el.getBoundingClientRect();\n\t\t\tvar contextRect = context.getBoundingClientRect();\n\t\t\tvar w = elRect.right - elRect.left;\n\t\t\tvar h = elRect.bottom - elRect.top;\n\t\n\t\t\treturn [elRect.left - contextRect.left + w / 2, elRect.top - contextRect.top + h / 2];\n\t\t},\n\t\n\t\n\t\tmove: function move(el, x, y) {\n\t\t\tif (x) el.style.left = x + 'px';\n\t\t\tif (y) el.style.top = y + 'px';\n\t\t},\n\t\n\t\tgetSize: function getSize(el) {\n\t\t\tvar w = parseInt(el.style.offsetWidth, 10);\n\t\t\tvar h = parseInt(el.style.offsetHeight, 10);\n\t\t\treturn [w, h];\n\t\t},\n\t\n\t\tresize: function resize(el, w, h) {\n\t\t\tif (w) el.style.width = w + \"px\";\n\t\t\tif (h) el.style.height = h + 'px';\n\t\t},\n\t\n\t\tpreloadImages: function preloadImages(array) {\n\t\t\tif (!this.preloadImages.list) this.preloadImages.list = [];\n\t\t\tif (!this.preloadImages.loaded) this.preloadImages.loaded = {};\n\t\n\t\t\tvar list = this.preloadImages.list;\n\t\t\tvar img,\n\t\t\t    that = this;\n\t\t\tfor (var i = 0; i < array.length; i++) {\n\t\t\t\timg = new Image();\n\t\t\t\timg.onload = function () {\n\t\t\t\t\tvar index = list.indexOf(this);\n\t\t\t\t\tif (index !== -1) {\n\t\t\t\t\t\tthat.preloadImages.loaded[this.name] = { width: this.width, height: this.height };\n\t\t\t\t\t\t// remove image from the array once it's loaded\n\t\t\t\t\t\t// for memory consumption reasons\n\t\t\t\t\t\tlist.splice(index, 1);\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t\tlist.push(img);\n\t\t\t\timg.src = array[i];\n\t\t\t\timg.name = array[i];\n\t\t\t}\n\t\t},\n\t\n\t\t/**\n\t  * Get's the image's information given the url. Must be preloaded by calling the preloadImage function.\n\t  * @param src\n\t  */\n\t\tgetImageInfo: function getImageInfo(src) {\n\t\t\tif (this.preloadImages.loaded) {\n\t\t\t\treturn this.preloadImages.loaded[src];\n\t\t\t}\n\t\t\treturn null;\n\t\t},\n\t\n\t\tdownloadImage: function downloadImage(name, image) {\n\t\t\tif (!image) return;\n\t\t\tvar mime = image.match(/^data:([^;]*)/)[1];\n\t\t\tvar type = mime.split('/')[1];\n\t\t\tif (type.indexOf('+') > 0) type = type.split('+')[0];\n\t\t\tif (this.isIE) {\n\t\t\t\timage = this.b64toBlob(image.replace('data:' + mime + ';base64,', ''), mime);\n\t\t\t\tnavigator.msSaveBlob(image, name + '.' + type);\n\t\t\t} else {\n\t\t\t\tvar link = this.createElement('a', { href: image, download: name + '.' + type }, { display: \"none\" });\n\t\t\t\tdocument.body.appendChild(link);\n\t\t\t\tlink.click();\n\t\t\t\tlink.parentNode.removeChild(link);\n\t\t\t}\n\t\t},\n\t\n\t\t/**\n\t  * Convert b54 to blob. IE only\n\t  */\n\t\tb64toBlob: function b64toBlob(b64Data, contentType, sliceSize) {\n\t\t\tcontentType = contentType || '';\n\t\t\tsliceSize = sliceSize || 512;\n\t\n\t\t\tvar byteCharacters = atob(b64Data);\n\t\t\tvar byteArrays = [];\n\t\n\t\t\tfor (var offset = 0; offset < byteCharacters.length; offset += sliceSize) {\n\t\t\t\tvar slice = byteCharacters.slice(offset, offset + sliceSize);\n\t\n\t\t\t\tvar byteNumbers = new Array(slice.length);\n\t\t\t\tfor (var i = 0; i < slice.length; i++) {\n\t\t\t\t\tbyteNumbers[i] = slice.charCodeAt(i);\n\t\t\t\t}\n\t\t\t\tvar byteArray = new Uint8Array(byteNumbers);\n\t\t\t\tbyteArrays.push(byteArray);\n\t\t\t}\n\t\t\treturn new Blob(byteArrays, { type: contentType });\n\t\t},\n\t\n\t\topenImage: function openImage(name, image) {\n\t\t\tvar myWindow = window.open(\"\", \"_blank\", \"toolbar=yes, scrollbars=yes, resizable=yes, width=500, height=500\");\n\t\t\tvar myDocument = myWindow.document;\n\t\t\tvar img = myDocument.createElement(\"img\");\n\t\t\tthis.setElement(img, { src: image, name: name });\n\t\t\tmyDocument.body.appendChild(img);\n\t\t},\n\t\n\t\t/**\n\t  * Check whether the key event is from input, textarea or select.\n\t  * @param e  input event\n\t  */\n\t\teventFromInput: function eventFromInput(e) {\n\t\t\tvar tagName = e.target.tagName;\n\t\t\treturn tagName == 'INPUT' || tagName == 'TEXTAREA' || tagName == 'SELECT';\n\t\t}\n\t};\n\n/***/ },\n/* 8 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t\tvalue: true\n\t});\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tvar _lodash = __webpack_require__(5);\n\t\n\tvar _lodash2 = _interopRequireDefault(_lodash);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\t/**\n\t * A string buffer for fast string manipulation\n\t */\n\t\n\tvar StringBuffer = function () {\n\t\tfunction StringBuffer(str) {\n\t\t\t_classCallCheck(this, StringBuffer);\n\t\n\t\t\tthis.buffer = [];\n\t\t\tif (str) this.buffer.push(str);\n\t\t}\n\t\n\t\t_createClass(StringBuffer, [{\n\t\t\tkey: \"append\",\n\t\t\tvalue: function append(stuff) {\n\t\t\t\tif (_lodash2.default.isString(stuff)) this.buffer.push(stuff);else if (_lodash2.default.isArray(stuff)) this.buffer = this.buffer.concat(stuff);else this.buffer.push(\"\" + stuff);\n\t\t\t\treturn this;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"prepend\",\n\t\t\tvalue: function prepend(stuff) {\n\t\t\t\tif (_lodash2.default.isString(stuff)) this.buffer.splice(0, 0, stuff);else if (_lodash2.default.isArray(stuff)) this.buffer = stuff.concat(this.buffer);else this.buffer.splice(0, 0, \"\" + stuff);\n\t\t\t\treturn this;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"clear\",\n\t\t\tvalue: function clear() {\n\t\t\t\tthis.buffer = [];\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"removeLast\",\n\t\t\tvalue: function removeLast() {\n\t\t\t\tthis.buffer.pop();\n\t\t\t\treturn this;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"toString\",\n\t\t\tvalue: function toString(sep) {\n\t\t\t\tif (!sep) sep = '';\n\t\t\t\treturn this.buffer.join(sep);\n\t\t\t}\n\t\t}]);\n\t\n\t\treturn StringBuffer;\n\t}();\n\t\n\texports.default = StringBuffer;\n\n/***/ },\n/* 9 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t\tvalue: true\n\t});\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tvar _Point = __webpack_require__(3);\n\t\n\tvar _Point2 = _interopRequireDefault(_Point);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tvar Line = function () {\n\t\tfunction Line(start, end) {\n\t\t\t_classCallCheck(this, Line);\n\t\n\t\t\tthis.start = start;\n\t\t\tthis.end = end;\n\t\t}\n\t\n\t\t/**\n\t  * Calculate the length of this line\n\t  */\n\t\n\t\n\t\t_createClass(Line, [{\n\t\t\tkey: 'length',\n\t\t\tvalue: function length() {\n\t\t\t\treturn this.start.distance(this.end);\n\t\t\t}\n\t\n\t\t\t/**\n\t   * Calculate the distance of this line to the point.\n\t   */\n\t\n\t\t}, {\n\t\t\tkey: 'distance',\n\t\t\tvalue: function distance(pt) {\n\t\t\t\tvar x = this.start.distance(pt);\n\t\t\t\tif (x == 0) return 0;\n\t\n\t\t\t\tvar l = this.length();\n\t\t\t\tvar cosa = new _Point2.default((this.end.x - this.start.x) / l, (this.end.y - this.start.y) / l).dotProduct(new _Point2.default(pt.x / x, pt.y / x));\n\t\n\t\t\t\treturn x * Math.sqrt(1 - cosa * cosa);\n\t\t\t}\n\t\n\t\t\t/**\n\t   * Function: intersection\n\t   *\n\t   * Returns the intersection of two lines as an <mxPoint>.\n\t   *\n\t   * Parameters:\n\t   *\n\t   * x0 - X-coordinate of the first line's startpoint.\n\t   * y0 - X-coordinate of the first line's startpoint.\n\t   * x1 - X-coordinate of the first line's endpoint.\n\t   * y1 - Y-coordinate of the first line's endpoint.\n\t   * x2 - X-coordinate of the second line's startpoint.\n\t   * y2 - Y-coordinate of the second line's startpoint.\n\t   * x3 - X-coordinate of the second line's endpoint.\n\t   * y3 - Y-coordinate of the second line's endpoint.\n\t   */\n\t\n\t\t}, {\n\t\t\tkey: 'toString',\n\t\t\tvalue: function toString() {\n\t\t\t\treturn 'Line:{start=' + this.start + ';end=' + this.end + '}';\n\t\t\t}\n\t\t}], [{\n\t\t\tkey: 'intersection',\n\t\t\tvalue: function intersection(x0, y0, x1, y1, x2, y2, x3, y3) {\n\t\t\t\tvar denom = (y3 - y2) * (x1 - x0) - (x3 - x2) * (y1 - y0);\n\t\t\t\tvar nume_a = (x3 - x2) * (y0 - y2) - (y3 - y2) * (x0 - x2);\n\t\t\t\tvar nume_b = (x1 - x0) * (y0 - y2) - (y1 - y0) * (x0 - x2);\n\t\n\t\t\t\tvar ua = nume_a / denom;\n\t\t\t\tvar ub = nume_b / denom;\n\t\n\t\t\t\tif (ua >= 0.0 && ua <= 1.0 && ub >= 0.0 && ub <= 1.0) {\n\t\t\t\t\t// Get the intersection point\n\t\t\t\t\tvar intersectionX = x0 + ua * (x1 - x0);\n\t\t\t\t\tvar intersectionY = y0 + ua * (y1 - y0);\n\t\n\t\t\t\t\treturn new _Point2.default(intersectionX, intersectionY);\n\t\t\t\t}\n\t\n\t\t\t\t// No intersection\n\t\t\t\treturn null;\n\t\t\t}\n\t\t}]);\n\t\n\t\treturn Line;\n\t}();\n\t\n\texports.default = Line;\n\n/***/ },\n/* 10 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t\tvalue: true\n\t});\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tvar _Shape2 = __webpack_require__(6);\n\t\n\tvar _Shape3 = _interopRequireDefault(_Shape2);\n\t\n\tvar _Point = __webpack_require__(3);\n\t\n\tvar _Point2 = _interopRequireDefault(_Point);\n\t\n\tvar _Rectangle = __webpack_require__(4);\n\t\n\tvar _Rectangle2 = _interopRequireDefault(_Rectangle);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\t\n\tfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\t\n\tvar Ellipse = function (_Shape) {\n\t\t_inherits(Ellipse, _Shape);\n\t\n\t\tfunction Ellipse() {\n\t\t\t_classCallCheck(this, Ellipse);\n\t\n\t\t\treturn _possibleConstructorReturn(this, Object.getPrototypeOf(Ellipse).apply(this, arguments));\n\t\t}\n\t\n\t\t_createClass(Ellipse, [{\n\t\t\tkey: \"toString\",\n\t\t\tvalue: function toString() {\n\t\t\t\treturn 'Ellipse:{x=' + this.x + ';y=' + this.y + ';width=' + this.width + ';height=' + this.height + '}';\n\t\t\t}\n\t\t}], [{\n\t\t\tkey: \"getPerimeter\",\n\t\t\tvalue: function getPerimeter(rect, pt) {\n\t\t\t\tvar orthogonal = arguments.length <= 2 || arguments[2] === undefined ? false : arguments[2];\n\t\n\t\t\t\tvar a = rect.width / 2;\n\t\t\t\tvar b = rect.height / 2;\n\t\t\t\tvar cx = rect.x;\n\t\t\t\tvar cy = rect.y;\n\t\t\t\tvar px = pt.x;\n\t\t\t\tvar py = pt.y;\n\t\n\t\t\t\t// Calculates straight line equation through\n\t\t\t\t// point and ellipse center y = d * x + h\n\t\t\t\tvar dx = parseInt(px - cx);\n\t\t\t\tvar dy = parseInt(py - cy);\n\t\n\t\t\t\tvar tx, ty;\n\t\n\t\t\t\tif (dx == 0 && dy != 0) {\n\t\t\t\t\treturn new _Point2.default(cx, cy + b * dy / Math.abs(dy));\n\t\t\t\t} else if (dx == 0 && dy == 0) {\n\t\t\t\t\treturn new _Point2.default(px, py);\n\t\t\t\t}\n\t\n\t\t\t\t// Calculates intersection\n\t\t\t\tvar d = dy / dx;\n\t\t\t\tvar h = cy - d * cx;\n\t\t\t\tvar e = a * a * d * d + b * b;\n\t\t\t\tvar f = -2 * cx * e;\n\t\t\t\tvar g = a * a * d * d * cx * cx + b * b * cx * cx - a * a * b * b;\n\t\t\t\tvar det = Math.sqrt(f * f - 4 * e * g);\n\t\n\t\t\t\t// Two solutions (perimeter points)\n\t\t\t\tvar xout1 = (-f + det) / (2 * e);\n\t\t\t\tvar xout2 = (-f - det) / (2 * e);\n\t\t\t\tvar yout1 = d * xout1 + h;\n\t\t\t\tvar yout2 = d * xout2 + h;\n\t\t\t\tvar dist1 = Math.sqrt(Math.pow(xout1 - px, 2) + Math.pow(yout1 - py, 2));\n\t\t\t\tvar dist2 = Math.sqrt(Math.pow(xout2 - px, 2) + Math.pow(yout2 - py, 2));\n\t\n\t\t\t\t// Correct solution\n\t\t\t\tvar xout = 0;\n\t\t\t\tvar yout = 0;\n\t\n\t\t\t\tif (dist1 < dist2) {\n\t\t\t\t\txout = xout1;\n\t\t\t\t\tyout = yout1;\n\t\t\t\t} else {\n\t\t\t\t\txout = xout2;\n\t\t\t\t\tyout = yout2;\n\t\t\t\t}\n\t\n\t\t\t\tvar p = new _Point2.default(xout, yout);\n\t\t\t\tvar dir = _Rectangle2.default.getDirection(rect, p, orthogonal);\n\t\t\t\tif (orthogonal) {\n\t\t\t\t\tif (dir.x == -1) {\n\t\t\t\t\t\treturn { point: new _Point2.default(cx - a, cy), direction: dir };\n\t\t\t\t\t}\n\t\t\t\t\tif (dir.x == 1) {\n\t\t\t\t\t\treturn { point: new _Point2.default(cx + a, cy), direction: dir };\n\t\t\t\t\t}\n\t\t\t\t\tif (dir.y == -1) {\n\t\t\t\t\t\treturn { point: new _Point2.default(cx, cy - b), direction: dir };\n\t\t\t\t\t}\n\t\t\t\t\tif (dir.y == 1) {\n\t\t\t\t\t\treturn { point: new _Point2.default(cx, cy + b), direction: dir };\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn { point: p, direction: dir };\n\t\t\t}\n\t\t}]);\n\t\n\t\treturn Ellipse;\n\t}(_Shape3.default);\n\t\n\texports.default = Ellipse;\n\n/***/ },\n/* 11 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t\tvalue: true\n\t});\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tvar _lodash = __webpack_require__(5);\n\t\n\tvar _lodash2 = _interopRequireDefault(_lodash);\n\t\n\tvar _Point = __webpack_require__(3);\n\t\n\tvar _Point2 = _interopRequireDefault(_Point);\n\t\n\tvar _Utils = __webpack_require__(2);\n\t\n\tvar _Utils2 = _interopRequireDefault(_Utils);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\t\n\tfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tvar defaultConfig = {\n\t\ttype: \"direct\",\n\t\tshowGauge: true,\n\t\torthogonal: false\n\t};\n\t\n\tvar defaultGeometry = {\n\t\twidth: 0,\n\t\theight: 0,\n\t\tanchorX: 0,\n\t\tanchorY: 0,\n\t\toffsetX: 0,\n\t\toffsetY: 0\n\t};\n\t\n\tvar linkTypes = {};\n\t\n\tvar Link = function () {\n\t\tfunction Link(terminalVisual) {\n\t\t\tvar shapeConfig = arguments.length <= 1 || arguments[1] === undefined ? {} : arguments[1];\n\t\t\tvar startMarker = arguments.length <= 2 || arguments[2] === undefined ? null : arguments[2];\n\t\t\tvar endMarker = arguments.length <= 3 || arguments[3] === undefined ? null : arguments[3];\n\t\n\t\t\t_classCallCheck(this, Link);\n\t\n\t\t\tthis.start = terminalVisual[0].point;\n\t\t\tthis.end = terminalVisual[1].point;\n\t\t\tthis.startNormal = terminalVisual[0].direction;\n\t\t\tthis.endNormal = terminalVisual[1].direction;\n\t\t\tthis.startMarker = startMarker;\n\t\t\tthis.endMarker = endMarker;\n\t\t\t_lodash2.default.assign(this, shapeConfig);\n\t\t}\n\t\n\t\t_createClass(Link, [{\n\t\t\tkey: \"render\",\n\t\t\tvalue: function render(view) {\n\t\t\t\treturn view.renderLink(this);\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"getRelativePosition\",\n\t\n\t\n\t\t\t/**\r\n\t   * Calculate the position where to put modifiers or label..\r\n\t   *\r\n\t   * @param geometry: defines how far along the edge should the point be placed.\r\n\t   * @return *[] the relative position.\r\n\t   */\n\t\t\tvalue: function getRelativePosition(geometry) {\n\t\t\t\tif (_lodash2.default.isNumber(geometry)) geometry = { x: geometry };\n\t\t\t\tgeometry = _lodash2.default.defaults(geometry, defaultGeometry);\n\t\t\t\tvar p = geometry.x,\n\t\t\t\t    l = this.length;\n\t\t\t\tif (Math.abs(p) <= 1) p *= l;\n\t\t\t\tif (p < 0) p = l + p;\n\t\t\t\tif (p > l) p = l;\n\t\n\t\t\t\tvar points = this.points,\n\t\t\t\t    d = void 0,\n\t\t\t\t    point = void 0,\n\t\t\t\t    dir = void 0;\n\t\t\t\tfor (var i = 0; i < points.length - 1; i++) {\n\t\t\t\t\td = points[i].distance(points[i + 1]);\n\t\t\t\t\tif (p <= d) {\n\t\t\t\t\t\t// we've located the line segment.\n\t\t\t\t\t\tpoint = points[i].clone();\n\t\t\t\t\t\tdir = point.getDirection(points[i + 1]);\n\t\t\t\t\t\tpoint.translate(dir.getScaled(p));\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\tp -= d;\n\t\t\t\t}\n\t\n\t\t\t\t// return the last point.\n\t\t\t\tif (!point) point = points[points.length - 1];\n\t\t\t\treturn _Utils2.default.offsetPosition([point.x, point.y], geometry);\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"toString\",\n\t\t\tvalue: function toString() {\n\t\t\t\treturn 'Link';\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"points\",\n\t\t\tget: function get() {\n\t\t\t\treturn null;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"controlPts\",\n\t\t\tget: function get() {\n\t\t\t\treturn null;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"length\",\n\t\t\tget: function get() {\n\t\t\t\tvar points = this.points;\n\t\t\t\tvar i = void 0,\n\t\t\t\t    l = 0;\n\t\t\t\tfor (i = 0; i < points.length - 1; i++) {\n\t\t\t\t\tl += points[i].distance(points[i + 1]);\n\t\t\t\t}return l;\n\t\t\t}\n\t\t}], [{\n\t\t\tkey: \"getLink\",\n\t\t\tvalue: function getLink(terminalVisual) {\n\t\t\t\tvar shapeConfig = arguments.length <= 1 || arguments[1] === undefined ? {} : arguments[1];\n\t\t\t\tvar startMarker = arguments.length <= 2 || arguments[2] === undefined ? null : arguments[2];\n\t\t\t\tvar endMarker = arguments.length <= 3 || arguments[3] === undefined ? null : arguments[3];\n\t\n\t\t\t\tshapeConfig = _lodash2.default.defaultsDeep(shapeConfig, defaultConfig);\n\t\t\t\tvar linkClass = linkTypes[shapeConfig.type];\n\t\t\t\tif (linkClass) return new linkClass(terminalVisual, shapeConfig, startMarker, endMarker);\n\t\t\t\tconsole.log('link type not supported: ' + shapeConfig.type);\n\t\t\t\treturn null;\n\t\t\t}\n\t\t}]);\n\t\n\t\treturn Link;\n\t}();\n\t\n\tvar DirectLink = function (_Link) {\n\t\t_inherits(DirectLink, _Link);\n\t\n\t\tfunction DirectLink() {\n\t\t\t_classCallCheck(this, DirectLink);\n\t\n\t\t\treturn _possibleConstructorReturn(this, Object.getPrototypeOf(DirectLink).apply(this, arguments));\n\t\t}\n\t\n\t\t_createClass(DirectLink, [{\n\t\t\tkey: \"points\",\n\t\t\tget: function get() {\n\t\t\t\treturn [this.start, this.end];\n\t\t\t}\n\t\t}]);\n\t\n\t\treturn DirectLink;\n\t}(Link);\n\t\n\tvar BezierLink = function (_Link2) {\n\t\t_inherits(BezierLink, _Link2);\n\t\n\t\tfunction BezierLink() {\n\t\t\t_classCallCheck(this, BezierLink);\n\t\n\t\t\treturn _possibleConstructorReturn(this, Object.getPrototypeOf(BezierLink).apply(this, arguments));\n\t\t}\n\t\n\t\t_createClass(BezierLink, [{\n\t\t\tkey: \"getRelativePosition\",\n\t\t\tvalue: function getRelativePosition(geometry) {\n\t\t\t\tif (_lodash2.default.isNumber(geometry)) geometry = { x: geometry };\n\t\t\t\tgeometry = _lodash2.default.defaults(geometry, defaultGeometry);\n\t\t\t\tvar p = geometry.x,\n\t\t\t\t    l = this.length;\n\t\t\t\tif (Math.abs(p) > 1) p /= l;\n\t\t\t\tif (p < 0) p++;\n\t\t\t\tif (p > 1) p--;\n\t\n\t\t\t\tvar pts = this.points;\n\t\t\t\tvar ctrlpts = this.controlPts;\n\t\t\t\tvar p1 = pts[0];\n\t\t\t\tvar p2 = ctrlpts[1][0];\n\t\t\t\tvar p3 = ctrlpts[1][1];\n\t\t\t\tvar p4 = pts[1];\n\t\n\t\t\t\tvar point = [(1 - p) * (1 - p) * (1 - p) * p1.x + 3 * p * (1 - p) * (1 - p) * p2.x + 3 * p * p * (1 - p) * p3.x + p * p * p * p4.x, (1 - p) * (1 - p) * (1 - p) * p1.y + 3 * p * (1 - p) * (1 - p) * p2.y + 3 * p * p * (1 - p) * p3.y + p * p * p * p4.y];\n\t\t\t\treturn _Utils2.default.offsetPosition([point.x, point.y], geometry);\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"points\",\n\t\t\tget: function get() {\n\t\t\t\treturn [this.start, this.end];\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"controlPts\",\n\t\t\tget: function get() {\n\t\t\t\tvar s = this.points[0],\n\t\t\t\t    e = this.points[1];\n\t\t\t\tvar pts = [];\n\t\t\t\tpts[0] = null;\n\t\t\t\tpts[1] = [];\n\t\t\t\tif (this.startNormal.x == 0) {\n\t\t\t\t\tpts[1][0] = new _Point2.default(s.x, (s.y + e.y) / 2);\n\t\t\t\t} else {\n\t\t\t\t\tpts[1][0] = new _Point2.default((s.x + e.x) / 2, s.y);\n\t\t\t\t}\n\t\t\t\tif (this.endNormal.x == 0) {\n\t\t\t\t\tpts[1][1] = new _Point2.default(e.x, (s.y + e.y) / 2);\n\t\t\t\t} else {\n\t\t\t\t\tpts[1][1] = new _Point2.default((s.x + e.x) / 2, e.y);\n\t\t\t\t}\n\t\t\t\treturn pts;\n\t\t\t}\n\t\t}]);\n\t\n\t\treturn BezierLink;\n\t}(Link);\n\t\n\tvar EntityRelations = function (_Link3) {\n\t\t_inherits(EntityRelations, _Link3);\n\t\n\t\tfunction EntityRelations() {\n\t\t\t_classCallCheck(this, EntityRelations);\n\t\n\t\t\treturn _possibleConstructorReturn(this, Object.getPrototypeOf(EntityRelations).apply(this, arguments));\n\t\t}\n\t\n\t\t_createClass(EntityRelations, [{\n\t\t\tkey: \"points\",\n\t\t\tget: function get() {\n\t\t\t\tvar source = Port.getBounds(edge, true);\n\t\t\t\tvar target = Port.getBounds(edge, false);\n\t\t\t\tvar isSourceLeft = target.right() < source.x;\n\t\t\t\tvar isTargetLeft = source.right() < target.x;\n\t\t\t\tvar result = [];\n\t\n\t\t\t\tvar x0 = isSourceLeft ? source.x : source.x + source.width;\n\t\t\t\tvar y0 = source.getCenterY();\n\t\t\t\tresult.push(new _Point2.default(x0, y0));\n\t\n\t\t\t\tvar xe = isTargetLeft ? target.x : target.x + target.width;\n\t\t\t\tvar ye = target.getCenterY();\n\t\n\t\t\t\tvar seg = this.segment;\n\t\n\t\t\t\tvar dx = isSourceLeft ? -seg : seg;\n\t\t\t\tvar dep = new _Point2.default(x0 + dx, y0);\n\t\n\t\t\t\tdx = isTargetLeft ? -seg : seg;\n\t\t\t\tvar arr = new _Point2.default(xe + dx, ye);\n\t\n\t\t\t\t// Adds intermediate points if both go out on same side\n\t\t\t\tif (isSourceLeft == isTargetLeft) {\n\t\t\t\t\tvar x = isSourceLeft ? Math.min(x0, xe) - seg : Math.max(x0, xe) + seg;\n\t\n\t\t\t\t\tresult.push(new _Point2.default(x, y0));\n\t\t\t\t\tresult.push(new _Point2.default(x, ye));\n\t\t\t\t} else if (dep.x < arr.x == isSourceLeft) {\n\t\t\t\t\tvar midY = y0 + (ye - y0) / 2;\n\t\n\t\t\t\t\tresult.push(dep);\n\t\t\t\t\tresult.push(new _Point2.default(dep.x, midY));\n\t\t\t\t\tresult.push(new _Point2.default(arr.x, midY));\n\t\t\t\t\tresult.push(arr);\n\t\t\t\t} else {\n\t\t\t\t\tresult.push(dep);\n\t\t\t\t\tresult.push(arr);\n\t\t\t\t}\n\t\n\t\t\t\tresult.push(new _Point2.default(xe, ye));\n\t\t\t\treturn result;\n\t\t\t}\n\t\t}]);\n\t\n\t\treturn EntityRelations;\n\t}(Link);\n\t\n\tvar Manhattan = function (_Link4) {\n\t\t_inherits(Manhattan, _Link4);\n\t\n\t\tfunction Manhattan(terminalVisual, shapeConfig, startMarker, endMarker) {\n\t\t\t_classCallCheck(this, Manhattan);\n\t\n\t\t\tshapeConfig = _lodash2.default.defaults(shapeConfig, {\n\t\t\t\tMIN_BUFFER: 10,\n\t\t\t\tautoRoute: false,\n\t\t\t\tmaxChannelWidth: 100\n\t\t\t});\n\t\t\treturn _possibleConstructorReturn(this, Object.getPrototypeOf(Manhattan).call(this, terminalVisual, shapeConfig, startMarker, endMarker));\n\t\t}\n\t\n\t\t_createClass(Manhattan, [{\n\t\t\tkey: \"autoRoute\",\n\t\n\t\n\t\t\t/**\r\n\t   * Automatically route the connection to avoid intersections with other vertices.\r\n\t   */\n\t\t\tvalue: function autoRoute(pts, container, boxes, startBox, endBox) {\n\t\t\t\tvar side, side2, d, box, intersect, j;\n\t\t\t\tvar channel, channel2, pt, dir;\n\t\n\t\t\t\tvar startPadding = 0,\n\t\t\t\t    endPadding;\n\t\t\t\t// first get the start and end channel\n\t\t\t\tbox = boxes[endBox];\n\t\t\t\tpt = pts[pts.length - 2];\n\t\t\t\tif (pt.y < box.y) side = 1;else if (pt.y > box.y + box.height) side = 3;else if (pt.x < box.x) side = 0;else side = 2;\n\t\t\t\tchannel = _getChannel(container, endBox, boxes, side);\n\t\t\t\tendPadding = channel.horizontal ? (channel.right - channel.left) / 2 : (channel.bottom - channel.top) / 2;\n\t\n\t\t\t\tfor (var i = 0; i < pts.length - 1; i++) {\n\t\t\t\t\tif (pts[i + 1].x == pts[i].x && pts[i + 1].y == pts[i].y) continue;\n\t\t\t\t\tintersect = _getFirstIntersection(pts, i, boxes, startBox, endBox);\n\t\t\t\t\tif (!intersect) continue;\n\t\t\t\t\tj = intersect[0];\n\t\t\t\t\tside = intersect[1];\n\t\t\t\t\tbox = boxes[j];\n\t\t\t\t\tchannel = _getChannel(container, j, boxes, side);\n\t\t\t\t\tswitch (side) {\n\t\t\t\t\t\tcase 0:\n\t\t\t\t\t\tcase 2:\n\t\t\t\t\t\t\tpt = new _Point2.default((channel.right + channel.left) / 2, pts[i].y);\n\t\t\t\t\t\t\tdir = _getRouteTendency(pts, i, pt, box, side);\n\t\t\t\t\t\t\tside2 = dir < 0 ? 1 : 3;\n\t\t\t\t\t\t\tchannel2 = _getChannel(container, j, boxes, side2);\n\t\t\t\t\t\t\t// if the previous point is in the channel2, use that point instead of center of the channel.\n\t\t\t\t\t\t\tif (i > 1 && pts[i - 2].y == pts[i - 1].y && pts[i - 1].y > channel2.top && pts[i - 1].y < channel2.bottom) d = pts[i - 1].y - pt.y;else if (i < pts.length - 3 && pts[i + 2].y == pts[i + 3].y && pts[i + 2].y > channel2.top && pts[i + 2].y < channel2.bottom) d = pts[i + 2].y - pt.y;else d = (channel2.bottom + channel2.top) / 2 - pt.y;\n\t\t\t\t\t\t\t// check if we need this pt.\n\t\t\t\t\t\t\tif (side == 0 && pt.x <= pts[i].x || side == 2 && pt.x >= pts[i].x) pt = null;else if (i > 0) {\n\t\t\t\t\t\t\t\t// see if we can push the line out to where we started.\n\t\t\t\t\t\t\t\tif (!_hasIntersection([new _Point2.default(pts[i].x, pts[i].y), new _Point2.default(pts[i].x, pts[i].y + d), new _Point2.default(pt.x, pt.y + d)], boxes)) pt = null;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 1:\n\t\t\t\t\t\tcase 3:\n\t\t\t\t\t\t\tpt = new _Point2.default(pts[i].x, (channel.bottom + channel.top) / 2);\n\t\t\t\t\t\t\tdir = _getRouteTendency(pts, i, pt, box, side);\n\t\t\t\t\t\t\tside2 = dir < 0 ? 0 : 2;\n\t\t\t\t\t\t\tchannel2 = _getChannel(container, j, boxes, side2);\n\t\t\t\t\t\t\t// if the previous point is in the channel2, use that point instead of center of the channel.\n\t\t\t\t\t\t\tif (i > 1 && pts[i - 2].x == pts[i - 1].x && pts[i - 1].x > channel2.left && pts[i - 1].x < channel2.right) d = pts[i - 1].x - pt.x;else if (i < pts.length - 3 && pts[i + 2].x == pts[i + 3].x && pts[i + 2].x > channel2.left && pts[i + 2].x < channel2.right) d = pts[i + 2].x - pt.x;else d = (channel2.right + channel2.left) / 2 - pt.x;\n\t\t\t\t\t\t\t// check if we need this pt.\n\t\t\t\t\t\t\tif (side == 1 && pt.y <= pts[i].y || side == 3 && pt.y >= pts[i].y) pt = null;else if (i > 0) {\n\t\t\t\t\t\t\t\t// see if we can push the line out to where we started.\n\t\t\t\t\t\t\t\tif (!_hasIntersection([new _Point2.default(pts[i].x, pts[i].y), new _Point2.default(pts[i].x + d, pts[i].y), new _Point2.default(pt.x + d, pt.y)], boxes)) pt = null;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 4:\n\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\t\t\t\t\t// max points.\n\t\t\t\t\tif (i > 20) return;\n\t\t\t\t\tif (pt && (pt.x != pts[i].x || pt.y != pts[i].y)) {\n\t\t\t\t\t\tpts.splice(i + 1, 0, pt);\n\t\t\t\t\t\t_moveSegment(pts, i + 1, d, startPadding, endPadding);\n\t\t\t\t\t\ti++;\n\t\t\t\t\t} else _moveSegment(pts, i, d, startPadding, endPadding);\n\t\t\t\t}\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"_hasIntersection\",\n\t\t\tvalue: function _hasIntersection(pts, boxes) {\n\t\t\t\tfor (var i = 0; i < pts.length - 1; i++) {\n\t\t\t\t\tfor (var j = 0; j < boxes.length; j++) {\n\t\t\t\t\t\tif (boxes[j].detectIntersection(pts[i], pts[i + 1]) >= 0) return true;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"_getFirstIntersection\",\n\t\t\tvalue: function _getFirstIntersection(pts, i, boxes, startBox, endBox) {\n\t\t\t\tvar box,\n\t\t\t\t    side,\n\t\t\t\t    savedIndex = null,\n\t\t\t\t    savedSide = null;\n\t\t\t\tfor (var j = 0; j < boxes.length; j++) {\n\t\t\t\t\tif (i == 0 && j == startBox || i == pts.length - 2 && j == endBox) continue;\n\t\t\t\t\tbox = boxes[j];\n\t\t\t\t\tside = box.detectIntersection(pts[i], pts[i + 1]);\n\t\t\t\t\tif (side >= 0) {\n\t\t\t\t\t\tif (savedIndex == null) {\n\t\t\t\t\t\t\tsavedIndex = j;\n\t\t\t\t\t\t\tsavedSide = side;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tif (boxes[savedIndex].distance(pts[i]) > box.distance(pts[i])) {\n\t\t\t\t\t\t\t\tsavedIndex = j;\n\t\t\t\t\t\t\t\tsavedSide = side;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (savedIndex != null) return [savedIndex, savedSide];\n\t\t\t\treturn null;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"_getRouteTendency\",\n\t\t\tvalue: function _getRouteTendency(pts, i, breakPt, box, side) {\n\t\t\t\tvar dir;\n\t\t\t\tvar p;\n\t\t\t\tswitch (side) {\n\t\t\t\t\tcase 0:\n\t\t\t\t\tcase 2:\n\t\t\t\t\t\tp = \"y\";\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 1:\n\t\t\t\t\tcase 3:\n\t\t\t\t\t\tp = \"x\";\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\t//first try the breakpt.\n\t\t\t\tdir = _getRouteDirection(breakPt, pts[pts.length - 1])[p];\n\t\t\t\tif (dir == 0) {\n\t\t\t\t\tdir = -_getRouteDirection(pts[0], pts[pts.length - 1])[p];\n\t\t\t\t\tif (dir == 0) {\n\t\t\t\t\t\tif (breakPt[p] < box.getCenter()[p]) dir = -1;else dir = 1;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn dir;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"_getRouteDirection\",\n\t\t\tvalue: function _getRouteDirection(pt1, pt2) {\n\t\t\t\tif (pt1.x == pt2.x) {\n\t\t\t\t\tif (pt1.y < pt2.y) return _Point2.default.S;\n\t\t\t\t\treturn _Point2.default.N;\n\t\t\t\t} else if (pt1.y == pt2.y) {\n\t\t\t\t\tif (pt1.x < pt2.x) return _Point2.default.E;\n\t\t\t\t\treturn _Point2.default.W;\n\t\t\t\t} else if (pt1.x < pt2.x) {\n\t\t\t\t\tif (pt1.y < pt2.y) return _Point2.default.SE;\n\t\t\t\t\treturn _Point2.default.NE;\n\t\t\t\t} else {\n\t\t\t\t\tif (pt1.y < pt2.y) return _Point2.default.SW;\n\t\t\t\t\treturn _Point2.default.NW;\n\t\t\t\t}\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"_getChannel\",\n\t\t\tvalue: function _getChannel(container, index, boxes, side) {\n\t\t\t\tvar maxChannelWidth = this.maxChannelWidth;\n\t\t\t\tvar box1 = boxes[index],\n\t\t\t\t    box2;\n\t\t\t\tvar pt, i;\n\t\t\t\tvar channel = {},\n\t\t\t\t    l,\n\t\t\t\t    t,\n\t\t\t\t    b,\n\t\t\t\t    r;\n\t\t\t\tswitch (side) {\n\t\t\t\t\tcase 0:\n\t\t\t\t\t\tpt = box1.getLeft();\n\t\t\t\t\t\tchannel.right = pt.x;\n\t\t\t\t\t\tchannel.horizontal = false;\n\t\t\t\t\t\tfor (i = 0; i < boxes.length; i++) {\n\t\t\t\t\t\t\tif (i == index) continue;\n\t\t\t\t\t\t\tr = boxes[i].getRight().x;\n\t\t\t\t\t\t\tif (r >= pt.x) continue;\n\t\t\t\t\t\t\tif (!channel.left || channel.left < r) channel.left = r;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (!channel.left) {\n\t\t\t\t\t\t\tchannel.left = container.getLeft().x;\n\t\t\t\t\t\t\tif (channel.right - channel.left > maxChannelWidth) channel.left = channel.right - maxChannelWidth;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tfor (i = 0; i < boxes.length; i++) {\n\t\t\t\t\t\t\tif (i == index) continue;\n\t\t\t\t\t\t\tbox2 = boxes[i];\n\t\t\t\t\t\t\tb = box2.getBottom().y;\n\t\t\t\t\t\t\tt = box2.getTop().y;\n\t\t\t\t\t\t\tif (b < pt.y && box2.getRight() > channel.left && box2.getLeft() < channel.right) {\n\t\t\t\t\t\t\t\tif (!channel.top || channel.top < b) channel.top = b;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (t > pt.y && box2.getRight() > channel.left && box2.getLeft() < channel.right) {\n\t\t\t\t\t\t\t\tif (!channel.bottom || channel.bottom > t) channel.bottom = t;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (!channel.top) channel.top = container.getTop().y;\n\t\t\t\t\t\tif (!channel.bottom) channel.bottom = container.getBottom().y;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 1:\n\t\t\t\t\t\tpt = box1.getTop();\n\t\t\t\t\t\tchannel.horizontal = true;\n\t\t\t\t\t\tchannel.bottom = pt.y;\n\t\t\t\t\t\tfor (i = 0; i < boxes.length; i++) {\n\t\t\t\t\t\t\tif (i == index) continue;\n\t\t\t\t\t\t\tb = boxes[i].getBottom().y;\n\t\t\t\t\t\t\tif (b >= pt.y) continue;\n\t\t\t\t\t\t\tif (!channel.top || channel.top < b) channel.top = b;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (!channel.top) {\n\t\t\t\t\t\t\tchannel.top = container.getTop().y;\n\t\t\t\t\t\t\tif (channel.bottom - channel.top > maxChannelWidth) channel.top = channel.bottom - maxChannelWidth;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tfor (i = 0; i < boxes.length; i++) {\n\t\t\t\t\t\t\tif (i == index) continue;\n\t\t\t\t\t\t\tbox2 = boxes[i];\n\t\t\t\t\t\t\tl = box2.getLeft().x;\n\t\t\t\t\t\t\tr = box2.getRight().x;\n\t\t\t\t\t\t\tif (r < pt.x && box2.getBottom() > channel.top && box2.getTop() < channel.bottom) {\n\t\t\t\t\t\t\t\tif (!channel.left || channel.left < r) channel.left = r;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (l > pt.x && box2.getBottom() > channel.top && box2.getTop() < channel.bottom) {\n\t\t\t\t\t\t\t\tif (!channel.right || channel.right > l) channel.right = l;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (!channel.left) channel.left = container.getLeft().x;\n\t\t\t\t\t\tif (!channel.right) channel.right = container.getRight().x;\n\t\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 2:\n\t\t\t\t\t\tpt = box1.getRight();\n\t\t\t\t\t\tchannel.horizontal = false;\n\t\t\t\t\t\tchannel.left = pt.x;\n\t\t\t\t\t\tfor (i = 0; i < boxes.length; i++) {\n\t\t\t\t\t\t\tif (i == index) continue;\n\t\t\t\t\t\t\tl = boxes[i].getLeft().x;\n\t\t\t\t\t\t\tif (l <= pt.x) continue;\n\t\t\t\t\t\t\tif (!channel.right || channel.right > l) channel.right = l;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (!channel.right) {\n\t\t\t\t\t\t\tchannel.right = container.getRight().x;\n\t\t\t\t\t\t\tif (channel.right - channel.left > maxChannelWidth) channel.right = channel.left + maxChannelWidth;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tfor (i = 0; i < boxes.length; i++) {\n\t\t\t\t\t\t\tif (i == index) continue;\n\t\t\t\t\t\t\tbox2 = boxes[i];\n\t\t\t\t\t\t\tb = box2.getBottom().y;\n\t\t\t\t\t\t\tt = box2.getTop().y;\n\t\t\t\t\t\t\tif (b < pt.y && box2.getRight() > channel.left && box2.getLeft() < channel.right) {\n\t\t\t\t\t\t\t\tif (!channel.top || channel.top < b) channel.top = b;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (t > pt.y && box2.getRight() > channel.left && box2.getLeft() < channel.right) {\n\t\t\t\t\t\t\t\tif (!channel.bottom || channel.bottom > t) channel.bottom = t;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (!channel.top) channel.top = container.getTop().y;\n\t\t\t\t\t\tif (!channel.bottom) channel.bottom = container.getBottom().y;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 3:\n\t\t\t\t\t\tpt = box1.getBottom();\n\t\t\t\t\t\tchannel.horizontal = true;\n\t\t\t\t\t\tchannel.top = pt.y;\n\t\t\t\t\t\tfor (i = 0; i < boxes.length; i++) {\n\t\t\t\t\t\t\tif (i == index) continue;\n\t\t\t\t\t\t\tbox2 = boxes[i];\n\t\t\t\t\t\t\tif (box2.getTop().y <= pt.y) continue;\n\t\t\t\t\t\t\tif (!channel.bottom || channel.bottom > box2.getTop().y) channel.bottom = box2.getTop().y;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (!channel.bottom) {\n\t\t\t\t\t\t\tchannel.bottom = container.getBottom().y;\n\t\t\t\t\t\t\tif (channel.bottom - channel.top > maxChannelWidth) channel.bottom = channel.top + maxChannelWidth;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tfor (i = 0; i < boxes.length; i++) {\n\t\t\t\t\t\t\tif (i == index) continue;\n\t\t\t\t\t\t\tbox2 = boxes[i];\n\t\t\t\t\t\t\tl = box2.getLeft().x;\n\t\t\t\t\t\t\tr = box2.getRight().x;\n\t\t\t\t\t\t\tif (r < pt.x && box2.getBottom() > channel.top && box2.getTop() < channel.bottom) {\n\t\t\t\t\t\t\t\tif (!channel.left || channel.left < r) channel.left = r;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (l > pt.x && box2.getBottom() > channel.top && box2.getTop() < channel.bottom) {\n\t\t\t\t\t\t\t\tif (!channel.right || channel.right > l) channel.right = l;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (!channel.left) channel.left = container.getLeft().x;\n\t\t\t\t\t\tif (!channel.right) channel.right = container.getRight().x;\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\treturn channel;\n\t\t\t}\n\t\n\t\t\t/**\r\n\t   * Move a line segment by a specified distance.\r\n\t   *\r\n\t   * @param pts the list of points.\r\n\t   * @param i the index of the segment.\r\n\t   * @param d the distance to move.\r\n\t   * @param startPadding\r\n\t   * @param endPadding\r\n\t   */\n\t\n\t\t}, {\n\t\t\tkey: \"_moveSegment\",\n\t\t\tvalue: function (_moveSegment2) {\n\t\t\t\tfunction _moveSegment(_x7, _x8, _x9, _x10, _x11) {\n\t\t\t\t\treturn _moveSegment2.apply(this, arguments);\n\t\t\t\t}\n\t\n\t\t\t\t_moveSegment.toString = function () {\n\t\t\t\t\treturn _moveSegment2.toString();\n\t\t\t\t};\n\t\n\t\t\t\treturn _moveSegment;\n\t\t\t}(function (pts, i, d, startPadding, endPadding) {\n\t\t\t\t// first check if we need to add new line segments.\n\t\t\t\tvar dir, l, pt;\n\t\t\t\tif (i == 0) {\n\t\t\t\t\t// we need to break off the segment, since we can't change the starting point.\n\t\t\t\t\tdir = pts[0].getDirection(pts[1]);\n\t\t\t\t\tif (!startPadding) startPadding = this.MIN_BUFFER;\n\t\t\t\t\tl = Math.min(startPadding, pts[0].distance(pts[1]) / 2);\n\t\t\t\t\tpt = pts[0].getTranslated(dir.scale(l));\n\t\t\t\t\tpts.splice(1, 0, pt);\n\t\t\t\t\t_moveSegment(pts, i + 1, d);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tif (i == pts.length - 2) {\n\t\t\t\t\t// we need to break off the segment, since we can't change the end point.\n\t\t\t\t\tdir = pts[pts.length - 1].getDirection(pts[pts.length - 2]);\n\t\t\t\t\tif (!endPadding) endPadding = this.MIN_BUFFER;\n\t\t\t\t\tl = Math.min(endPadding, pts[pts.length - 1].distance(pts[pts.length - 2]) / 2);\n\t\t\t\t\tpt = pts[pts.length - 1].getTranslated(dir.scale(l));\n\t\t\t\t\tpts.splice(pts.length - 1, 0, pt);\n\t\t\t\t\t_moveSegment(pts, i, d);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\n\t\t\t\tif (pts[i].y == pts[i + 1].y) {\n\t\t\t\t\tif (i > 0 && pts[i - 1].y == pts[i].y) {\n\t\t\t\t\t\tpts.splice(i + 1, 0, pts[i].clone());\n\t\t\t\t\t\ti++;\n\t\t\t\t\t}\n\t\t\t\t\tif (i < pts.length - 2 && pts[i + 1].y == pts[i + 2].y) pts.splice(i + 1, 0, pts[i + 1].clone());\n\t\t\t\t\tpts[i].y += d;\n\t\t\t\t\tpts[i + 1].y += d;\n\t\t\t\t} else {\n\t\t\t\t\tif (i > 0 && pts[i - 1].x == pts[i].x) {\n\t\t\t\t\t\tpts.splice(i + 1, 0, pts[i].clone());\n\t\t\t\t\t\ti++;\n\t\t\t\t\t}\n\t\t\t\t\tif (i < pts.length - 2 && pts[i + 1].x == pts[i + 2].x) pts.splice(i + 1, 0, pts[i + 1].clone());\n\t\t\t\t\tpts[i].x += d;\n\t\t\t\t\tpts[i + 1].x += d;\n\t\t\t\t}\n\t\t\t})\n\t\n\t\t\t/**\r\n\t   * This method will merge the redundant segments.\r\n\t   */\n\t\n\t\t}, {\n\t\t\tkey: \"_mergeSegments\",\n\t\t\tvalue: function _mergeSegments(pts) {\n\t\t\t\tvar h1 = pts[pts.length - 1].y == pts[pts.length - 2].y;\n\t\t\t\tvar h2;\n\t\t\t\tfor (var i = pts.length - 2; i >= 1; i--) {\n\t\t\t\t\th2 = pts[i].y == pts[i - 1].y;\n\t\t\t\t\tif (h2 == h1 || pts[i].equals(pts[i - 1])) pts.splice(i, 1);else h1 = !h1;\n\t\t\t\t}\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"points\",\n\t\t\tget: function get() {\n\t\t\t\t//let pos = Manhattan.routeInternal(this.start, this.end, this.startNormal, this.endNormal, this.MIN_BUFFER);\n\t\t\t\t//pos = Manhattan.processPositions(this.start, this.end, pos, this.startNormal.x!=0);\n\t\t\t\tvar pos = Manhattan.findPositions(this.start, this.end, this.startNormal, this.endNormal, this.MIN_BUFFER);\n\t\t\t\tif (this.autoRoute) {\n\t\t\t\t\tthis._mergeSegments(pos);\n\t\t\t\t\tvar boxes = [],\n\t\t\t\t\t    node,\n\t\t\t\t\t    startBox,\n\t\t\t\t\t    endBox;\n\t\t\t\t\tvar container = edge.source.getCommonAncestor(edge.target);\n\t\t\t\t\tvar childNodes = container.getDescendants();\n\t\t\t\t\tvar index = 0;\n\t\t\t\t\tfor (var i = 0; i < childNodes.length; i++) {\n\t\t\t\t\t\tnode = childNodes[i];\n\t\t\t\t\t\t// Do not include source or target ancestors in routing.\n\t\t\t\t\t\tif (node.excludeFromRouting(edge) || node.isAncestor(edge.source) || node.isAncestor(edge.target)) continue;\n\t\t\t\t\t\tif (node == edge.source) startBox = index;\n\t\t\t\t\t\tif (node == edge.target) endBox = index;\n\t\t\t\t\t\tboxes.push(node.getBounds(document));\n\t\t\t\t\t\tindex++;\n\t\t\t\t\t}\n\t\t\t\t\tif (boxes.length > 1) this.autoRoute(pos, container.getBounds(document), boxes, startBox, endBox);\n\t\t\t\t}\n\t\t\t\tthis._mergeSegments(pos);\n\t\t\t\treturn pos;\n\t\t\t}\n\t\n\t\t\t//New function for finding route\n\t\n\t\t}], [{\n\t\t\tkey: \"findPositions\",\n\t\t\tvalue: function findPositions(start, end, startNormal, endNormal, buffer) {\n\t\t\t\tvar startBuffer = new _Point2.default(start.x + startNormal.x * buffer, start.y + startNormal.y * buffer);\n\t\t\t\tvar endBuffer = new _Point2.default(end.x + endNormal.x * buffer, end.y + endNormal.y * buffer);\n\t\t\t\tvar startBufferNormal, endBufferNormal;\n\t\t\t\tvar pts;\n\t\t\t\tif (startNormal.x != 0) {\n\t\t\t\t\tif ((endBuffer.x - startBuffer.x) / startNormal.x > 0) {\n\t\t\t\t\t\tstartBufferNormal = startNormal;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tstartBufferNormal = new _Point2.default(0, endBuffer.y >= startBuffer.y ? 1 : -1);\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tif ((endBuffer.y - startBuffer.y) / startNormal.y > 0) {\n\t\t\t\t\t\tstartBufferNormal = startNormal;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tstartBufferNormal = new _Point2.default(endBuffer.x >= startBuffer.x ? 1 : -1, 0);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (endNormal.x != 0) {\n\t\t\t\t\tif ((startBuffer.x - endBuffer.x) / endNormal.x > 0) {\n\t\t\t\t\t\tendBufferNormal = endNormal;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tendBufferNormal = new _Point2.default(0, startBuffer.y >= endBuffer.y ? 1 : -1);\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tif ((startBuffer.y - endBuffer.y) / endNormal.y > 0) {\n\t\t\t\t\t\tendBufferNormal = endNormal;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tendBufferNormal = new _Point2.default(startBuffer.x >= endBuffer.x ? 1 : -1, 0);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\n\t\t\t\tif (startBufferNormal.dotProduct(endBufferNormal) == 0) {\n\t\t\t\t\tvar middle = startBufferNormal.x == 0 ? new _Point2.default(startBuffer.x, endBuffer.y) : new _Point2.default(endBuffer.x, startBuffer.y);\n\t\t\t\t\tpts = [start, startBuffer, middle, endBuffer, end];\n\t\t\t\t} else if (startBufferNormal.dotProduct(endBufferNormal) < 0) {\n\t\t\t\t\tif (startBufferNormal.x == 0) {\n\t\t\t\t\t\tpts = [start, startBuffer, new _Point2.default(startBuffer.x, (start.y + end.y) / 2), new _Point2.default(endBuffer.x, (start.y + end.y) / 2), endBuffer, end];\n\t\t\t\t\t} else {\n\t\t\t\t\t\tpts = [start, startBuffer, new _Point2.default((start.x + end.x) / 2, startBuffer.y), new _Point2.default((start.x + end.x) / 2, endBuffer.y), endBuffer, end];\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tpts = [start, startBuffer, new _Point2.default(startBuffer.x + startBufferNormal.x * buffer, startBuffer.y + startBufferNormal.y * buffer), new _Point2.default(endBuffer.x + endBufferNormal.x * buffer, endBuffer.y + endBufferNormal.y * buffer), endBuffer, end];\n\t\t\t\t}\n\t\n\t\t\t\tvar prunePts = [];\n\t\t\t\tprunePts[0] = pts[0];\n\t\t\t\tfor (var i = 1; i < pts.length - 1; i++) {\n\t\t\t\t\tif (pts[i].x == pts[i - 1].x && pts[i].x == pts[i + 1].x || pts[i].y == pts[i - 1].y && pts[i].y == pts[i + 1].y) {\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\t\t\t\t\tprunePts.push(pts[i]);\n\t\t\t\t}\n\t\t\t\tprunePts.push(pts[pts.length - 1]);\n\t\t\t\treturn prunePts;\n\t\t\t}\n\t\n\t\t\t/**\r\n\t   * Make a route based on the start, end and startNormal and endNormal\r\n\t   * None of the parameters can be null\r\n\t   * TODO: This method could use some improvement...\r\n\t   */\n\t\n\t\t}, {\n\t\t\tkey: \"routeInternal\",\n\t\t\tvalue: function routeInternal(start, end, startNormal, endNormal, buffer) {\n\t\t\t\tvar direction = start.getDirection(end);\n\t\t\t\tvar average = start.getMidPoint(end);\n\t\t\t\tvar pos = [];\n\t\t\t\tvar startPositive = new _Point2.default(startNormal.x * startNormal.x, startNormal.y * startNormal.y);\n\t\t\t\tvar endPositive = new _Point2.default(endNormal.x * endNormal.x, endNormal.y * endNormal.y);\n\t\t\t\tvar horizontal = startNormal.x != 0;\n\t\t\t\tpos[0] = horizontal ? start.y : start.x;\n\t\n\t\t\t\thorizontal = !horizontal;\n\t\t\t\tvar i;\n\t\t\t\tif (startNormal.dotProduct(endNormal) == 0) {\n\t\t\t\t\tif (startNormal.dotProduct(direction) >= 0 && endNormal.dotProduct(direction) <= 0) {\n\t\t\t\t\t\t// 0\n\t\t\t\t\t} else {\n\t\t\t\t\t\t// 2\n\t\t\t\t\t\tif (startNormal.dotProduct(direction) < 0) i = startPositive.dotProduct(start.getTranslated(startNormal.getScaled(buffer)));else i = horizontal ? average.y : average.x;\n\t\n\t\t\t\t\t\tpos.push(i);\n\t\t\t\t\t\thorizontal = !horizontal;\n\t\n\t\t\t\t\t\tif (endNormal.dotProduct(direction) > 0) i = endPositive.dotProduct(end.getTranslated(endNormal.getScaled(buffer)));else i = horizontal ? average.y : average.x;\n\t\n\t\t\t\t\t\tpos.push(i);\n\t\t\t\t\t\thorizontal = !horizontal;\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tif (startNormal.dotProduct(endNormal) > 0) {\n\t\t\t\t\t\t//1\n\t\t\t\t\t\tif (startNormal.dotProduct(direction) >= 0) i = startPositive.dotProduct(start.getTranslated(startNormal.getScaled(buffer)));else i = endPositive.dotProduct(end.getTranslated(endNormal.getScaled(buffer)));\n\t\t\t\t\t\tpos.push(i);\n\t\t\t\t\t\thorizontal = !horizontal;\n\t\t\t\t\t} else {\n\t\t\t\t\t\t//3 or 1\n\t\t\t\t\t\tif (startNormal.dotProduct(direction) < 0) {\n\t\t\t\t\t\t\ti = startPositive.dotProduct(start.getTranslated(startNormal.getScaled(buffer)));\n\t\t\t\t\t\t\tpos.push(i);\n\t\t\t\t\t\t\thorizontal = !horizontal;\n\t\t\t\t\t\t}\n\t\n\t\t\t\t\t\ti = horizontal ? average.y : average.x;\n\t\t\t\t\t\tpos.push(i);\n\t\t\t\t\t\thorizontal = !horizontal;\n\t\n\t\t\t\t\t\tif (startNormal.dotProduct(direction) < 0) {\n\t\t\t\t\t\t\ti = endPositive.dotProduct(end.getTranslated(endNormal.getScaled(buffer)));\n\t\t\t\t\t\t\tpos.push(i);\n\t\t\t\t\t\t\thorizontal = !horizontal;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tpos.push(horizontal ? end.y : end.x);\n\t\n\t\t\t\treturn pos;\n\t\t\t}\n\t\n\t\t\t// Process the positions.\n\t\n\t\t}, {\n\t\t\tkey: \"processPositions\",\n\t\t\tvalue: function processPositions(start, end, positions, horizontal) {\n\t\t\t\tvar pos = [];\n\t\t\t\tpos[0] = horizontal ? start.x : start.y;\n\t\t\t\tvar i;\n\t\t\t\tfor (i = 0; i < positions.length; i++) {\n\t\t\t\t\tpos[i + 1] = positions[i];\n\t\t\t\t}\n\t\t\t\tpos.push(horizontal == (positions.length % 2 == 1) ? end.x : end.y);\n\t\n\t\t\t\tvar pts = [];\n\t\t\t\tpts[0] = start;\n\t\t\t\tvar p;\n\t\t\t\tvar current, prev;\n\t\t\t\tfor (i = 2; i < pos.length - 1; i++) {\n\t\t\t\t\thorizontal = !horizontal;\n\t\t\t\t\tprev = pos[i - 1];\n\t\t\t\t\tcurrent = pos[i];\n\t\t\t\t\tp = horizontal ? new _Point2.default(prev, current) : new _Point2.default(current, prev);\n\t\t\t\t\tpts.push(p);\n\t\t\t\t}\n\t\t\t\tpts.push(end);\n\t\t\t\treturn pts;\n\t\t\t}\n\t\t}]);\n\t\n\t\treturn Manhattan;\n\t}(Link);\n\t\n\tlinkTypes['direct'] = DirectLink;\n\tlinkTypes['bezier'] = BezierLink;\n\tlinkTypes['entityRelations'] = EntityRelations;\n\tlinkTypes['manhattan'] = Manhattan;\n\t\n\texports.default = Link;\n\n/***/ },\n/* 12 */\n/***/ function(module, exports, __webpack_require__) {\n\n\tvar __WEBPACK_AMD_DEFINE_FACTORY__, __WEBPACK_AMD_DEFINE_RESULT__;/*!\n\t  * Bean - copyright (c) Jacob Thornton 2011-2012\n\t  * https://github.com/fat/bean\n\t  * MIT license\n\t  */\n\t(function (name, context, definition) {\n\t  if (typeof module != 'undefined' && module.exports) module.exports = definition()\n\t  else if (true) !(__WEBPACK_AMD_DEFINE_FACTORY__ = (definition), __WEBPACK_AMD_DEFINE_RESULT__ = (typeof __WEBPACK_AMD_DEFINE_FACTORY__ === 'function' ? (__WEBPACK_AMD_DEFINE_FACTORY__.call(exports, __webpack_require__, exports, module)) : __WEBPACK_AMD_DEFINE_FACTORY__), __WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__))\n\t  else context[name] = definition()\n\t})('bean', this, function (name, context) {\n\t  name    = name    || 'bean'\n\t  context = context || this\n\t\n\t  var win            = window\n\t    , old            = context[name]\n\t    , namespaceRegex = /[^\\.]*(?=\\..*)\\.|.*/\n\t    , nameRegex      = /\\..*/\n\t    , addEvent       = 'addEventListener'\n\t    , removeEvent    = 'removeEventListener'\n\t    , doc            = document || {}\n\t    , root           = doc.documentElement || {}\n\t    , W3C_MODEL      = root[addEvent]\n\t    , eventSupport   = W3C_MODEL ? addEvent : 'attachEvent'\n\t    , ONE            = {} // singleton for quick matching making add() do one()\n\t\n\t    , slice          = Array.prototype.slice\n\t    , str2arr        = function (s, d) { return s.split(d || ' ') }\n\t    , isString       = function (o) { return typeof o == 'string' }\n\t    , isFunction     = function (o) { return typeof o == 'function' }\n\t\n\t      // events that we consider to be 'native', anything not in this list will\n\t      // be treated as a custom event\n\t    , standardNativeEvents =\n\t        'click dblclick mouseup mousedown contextmenu '                  + // mouse buttons\n\t        'mousewheel mousemultiwheel DOMMouseScroll '                     + // mouse wheel\n\t        'mouseover mouseout mousemove selectstart selectend '            + // mouse movement\n\t        'keydown keypress keyup '                                        + // keyboard\n\t        'orientationchange '                                             + // mobile\n\t        'focus blur change reset select submit '                         + // form elements\n\t        'load unload beforeunload resize move DOMContentLoaded '         + // window\n\t        'readystatechange message '                                      + // window\n\t        'error abort scroll '                                              // misc\n\t      // element.fireEvent('onXYZ'... is not forgiving if we try to fire an event\n\t      // that doesn't actually exist, so make sure we only do these on newer browsers\n\t    , w3cNativeEvents =\n\t        'show '                                                          + // mouse buttons\n\t        'input invalid '                                                 + // form elements\n\t        'touchstart touchmove touchend touchcancel '                     + // touch\n\t        'gesturestart gesturechange gestureend '                         + // gesture\n\t        'textinput '                                                     + // TextEvent\n\t        'readystatechange pageshow pagehide popstate '                   + // window\n\t        'hashchange offline online '                                     + // window\n\t        'afterprint beforeprint '                                        + // printing\n\t        'dragstart dragenter dragover dragleave drag drop dragend '      + // dnd\n\t        'loadstart progress suspend emptied stalled loadmetadata '       + // media\n\t        'loadeddata canplay canplaythrough playing waiting seeking '     + // media\n\t        'seeked ended durationchange timeupdate play pause ratechange '  + // media\n\t        'volumechange cuechange '                                        + // media\n\t        'checking noupdate downloading cached updateready obsolete '       // appcache\n\t\n\t      // convert to a hash for quick lookups\n\t    , nativeEvents = (function (hash, events, i) {\n\t        for (i = 0; i < events.length; i++) events[i] && (hash[events[i]] = 1)\n\t        return hash\n\t      }({}, str2arr(standardNativeEvents + (W3C_MODEL ? w3cNativeEvents : ''))))\n\t\n\t      // custom events are events that we *fake*, they are not provided natively but\n\t      // we can use native events to generate them\n\t    , customEvents = (function () {\n\t        var isAncestor = 'compareDocumentPosition' in root\n\t              ? function (element, container) {\n\t                  return container.compareDocumentPosition && (container.compareDocumentPosition(element) & 16) === 16\n\t                }\n\t              : 'contains' in root\n\t                ? function (element, container) {\n\t                    container = container.nodeType === 9 || container === window ? root : container\n\t                    return container !== element && container.contains(element)\n\t                  }\n\t                : function (element, container) {\n\t                    while (element = element.parentNode) if (element === container) return 1\n\t                    return 0\n\t                  }\n\t          , check = function (event) {\n\t              var related = event.relatedTarget\n\t              return !related\n\t                ? related == null\n\t                : (related !== this && related.prefix !== 'xul' && !/document/.test(this.toString())\n\t                    && !isAncestor(related, this))\n\t            }\n\t\n\t        return {\n\t            mouseenter: { base: 'mouseover', condition: check }\n\t          , mouseleave: { base: 'mouseout', condition: check }\n\t          , mousewheel: { base: /Firefox/.test(navigator.userAgent) ? 'DOMMouseScroll' : 'mousewheel' }\n\t        }\n\t      }())\n\t\n\t      // we provide a consistent Event object across browsers by taking the actual DOM\n\t      // event object and generating a new one from its properties.\n\t    , Event = (function () {\n\t            // a whitelist of properties (for different event types) tells us what to check for and copy\n\t        var commonProps  = str2arr('altKey attrChange attrName bubbles cancelable ctrlKey currentTarget ' +\n\t              'detail eventPhase getModifierState isTrusted metaKey relatedNode relatedTarget shiftKey '  +\n\t              'srcElement target timeStamp type view which propertyName')\n\t          , mouseProps   = commonProps.concat(str2arr('button buttons clientX clientY dataTransfer '      +\n\t              'fromElement offsetX offsetY pageX pageY screenX screenY toElement'))\n\t          , mouseWheelProps = mouseProps.concat(str2arr('wheelDelta wheelDeltaX wheelDeltaY wheelDeltaZ ' +\n\t              'axis')) // 'axis' is FF specific\n\t          , keyProps     = commonProps.concat(str2arr('char charCode key keyCode keyIdentifier '          +\n\t              'keyLocation location'))\n\t          , textProps    = commonProps.concat(str2arr('data'))\n\t          , touchProps   = commonProps.concat(str2arr('touches targetTouches changedTouches scale rotation'))\n\t          , messageProps = commonProps.concat(str2arr('data origin source'))\n\t          , stateProps   = commonProps.concat(str2arr('state'))\n\t          , overOutRegex = /over|out/\n\t            // some event types need special handling and some need special properties, do that all here\n\t          , typeFixers   = [\n\t                { // key events\n\t                    reg: /key/i\n\t                  , fix: function (event, newEvent) {\n\t                      newEvent.keyCode = event.keyCode || event.which\n\t                      return keyProps\n\t                    }\n\t                }\n\t              , { // mouse events\n\t                    reg: /click|mouse(?!(.*wheel|scroll))|menu|drag|drop/i\n\t                  , fix: function (event, newEvent, type) {\n\t                      newEvent.rightClick = event.which === 3 || event.button === 2\n\t                      newEvent.pos = { x: 0, y: 0 }\n\t                      if (event.pageX || event.pageY) {\n\t                        newEvent.clientX = event.pageX\n\t                        newEvent.clientY = event.pageY\n\t                      } else if (event.clientX || event.clientY) {\n\t                        newEvent.clientX = event.clientX + doc.body.scrollLeft + root.scrollLeft\n\t                        newEvent.clientY = event.clientY + doc.body.scrollTop + root.scrollTop\n\t                      }\n\t                      if (overOutRegex.test(type)) {\n\t                        newEvent.relatedTarget = event.relatedTarget\n\t                          || event[(type == 'mouseover' ? 'from' : 'to') + 'Element']\n\t                      }\n\t                      return mouseProps\n\t                    }\n\t                }\n\t              , { // mouse wheel events\n\t                    reg: /mouse.*(wheel|scroll)/i\n\t                  , fix: function () { return mouseWheelProps }\n\t                }\n\t              , { // TextEvent\n\t                    reg: /^text/i\n\t                  , fix: function () { return textProps }\n\t                }\n\t              , { // touch and gesture events\n\t                    reg: /^touch|^gesture/i\n\t                  , fix: function () { return touchProps }\n\t                }\n\t              , { // message events\n\t                    reg: /^message$/i\n\t                  , fix: function () { return messageProps }\n\t                }\n\t              , { // popstate events\n\t                    reg: /^popstate$/i\n\t                  , fix: function () { return stateProps }\n\t                }\n\t              , { // everything else\n\t                    reg: /.*/\n\t                  , fix: function () { return commonProps }\n\t                }\n\t            ]\n\t          , typeFixerMap = {} // used to map event types to fixer functions (above), a basic cache mechanism\n\t\n\t          , Event = function (event, element, isNative) {\n\t              if (!arguments.length) return\n\t              event = event || ((element.ownerDocument || element.document || element).parentWindow || win).event\n\t              this.originalEvent = event\n\t              this.isNative       = isNative\n\t              this.isBean         = true\n\t\n\t              if (!event) return\n\t\n\t              var type   = event.type\n\t                , target = event.target || event.srcElement\n\t                , i, l, p, props, fixer\n\t\n\t              this.target = target && target.nodeType === 3 ? target.parentNode : target\n\t\n\t              if (isNative) { // we only need basic augmentation on custom events, the rest expensive & pointless\n\t                fixer = typeFixerMap[type]\n\t                if (!fixer) { // haven't encountered this event type before, map a fixer function for it\n\t                  for (i = 0, l = typeFixers.length; i < l; i++) {\n\t                    if (typeFixers[i].reg.test(type)) { // guaranteed to match at least one, last is .*\n\t                      typeFixerMap[type] = fixer = typeFixers[i].fix\n\t                      break\n\t                    }\n\t                  }\n\t                }\n\t\n\t                props = fixer(event, this, type)\n\t                for (i = props.length; i--;) {\n\t                  if (!((p = props[i]) in this) && p in event) this[p] = event[p]\n\t                }\n\t              }\n\t            }\n\t\n\t        // preventDefault() and stopPropagation() are a consistent interface to those functions\n\t        // on the DOM, stop() is an alias for both of them together\n\t        Event.prototype.preventDefault = function () {\n\t          if (this.originalEvent.preventDefault) this.originalEvent.preventDefault()\n\t          else this.originalEvent.returnValue = false\n\t        }\n\t        Event.prototype.stopPropagation = function () {\n\t          if (this.originalEvent.stopPropagation) this.originalEvent.stopPropagation()\n\t          else this.originalEvent.cancelBubble = true\n\t        }\n\t        Event.prototype.stop = function () {\n\t          this.preventDefault()\n\t          this.stopPropagation()\n\t          this.stopped = true\n\t        }\n\t        // stopImmediatePropagation() has to be handled internally because we manage the event list for\n\t        // each element\n\t        // note that originalElement may be a Bean#Event object in some situations\n\t        Event.prototype.stopImmediatePropagation = function () {\n\t          if (this.originalEvent.stopImmediatePropagation) this.originalEvent.stopImmediatePropagation()\n\t          this.isImmediatePropagationStopped = function () { return true }\n\t        }\n\t        Event.prototype.isImmediatePropagationStopped = function () {\n\t          return this.originalEvent.isImmediatePropagationStopped && this.originalEvent.isImmediatePropagationStopped()\n\t        }\n\t        Event.prototype.clone = function (currentTarget) {\n\t          //TODO: this is ripe for optimisation, new events are *expensive*\n\t          // improving this will speed up delegated events\n\t          var ne = new Event(this, this.element, this.isNative)\n\t          ne.currentTarget = currentTarget\n\t          return ne\n\t        }\n\t\n\t        return Event\n\t      }())\n\t\n\t      // if we're in old IE we can't do onpropertychange on doc or win so we use doc.documentElement for both\n\t    , targetElement = function (element, isNative) {\n\t        return !W3C_MODEL && !isNative && (element === doc || element === win) ? root : element\n\t      }\n\t\n\t      /**\n\t        * Bean maintains an internal registry for event listeners. We don't touch elements, objects\n\t        * or functions to identify them, instead we store everything in the registry.\n\t        * Each event listener has a RegEntry object, we have one 'registry' for the whole instance.\n\t        */\n\t    , RegEntry = (function () {\n\t        // each handler is wrapped so we can handle delegation and custom events\n\t        var wrappedHandler = function (element, fn, condition, args) {\n\t            var call = function (event, eargs) {\n\t                  return fn.apply(element, args ? slice.call(eargs, event ? 0 : 1).concat(args) : eargs)\n\t                }\n\t              , findTarget = function (event, eventElement) {\n\t                  return fn.__beanDel ? fn.__beanDel.ft(event.target, element) : eventElement\n\t                }\n\t              , handler = condition\n\t                  ? function (event) {\n\t                      var target = findTarget(event, this) // deleated event\n\t                      if (condition.apply(target, arguments)) {\n\t                        if (event) event.currentTarget = target\n\t                        return call(event, arguments)\n\t                      }\n\t                    }\n\t                  : function (event) {\n\t                      if (fn.__beanDel) event = event.clone(findTarget(event)) // delegated event, fix the fix\n\t                      return call(event, arguments)\n\t                    }\n\t            handler.__beanDel = fn.__beanDel\n\t            return handler\n\t          }\n\t\n\t        , RegEntry = function (element, type, handler, original, namespaces, args, root) {\n\t            var customType     = customEvents[type]\n\t              , isNative\n\t\n\t            if (type == 'unload') {\n\t              // self clean-up\n\t              handler = once(removeListener, element, type, handler, original)\n\t            }\n\t\n\t            if (customType) {\n\t              if (customType.condition) {\n\t                handler = wrappedHandler(element, handler, customType.condition, args)\n\t              }\n\t              type = customType.base || type\n\t            }\n\t\n\t            this.isNative      = isNative = nativeEvents[type] && !!element[eventSupport]\n\t            this.customType    = !W3C_MODEL && !isNative && type\n\t            this.element       = element\n\t            this.type          = type\n\t            this.original      = original\n\t            this.namespaces    = namespaces\n\t            this.eventType     = W3C_MODEL || isNative ? type : 'propertychange'\n\t            this.target        = targetElement(element, isNative)\n\t            this[eventSupport] = !!this.target[eventSupport]\n\t            this.root          = root\n\t            this.handler       = wrappedHandler(element, handler, null, args)\n\t          }\n\t\n\t        // given a list of namespaces, is our entry in any of them?\n\t        RegEntry.prototype.inNamespaces = function (checkNamespaces) {\n\t          var i, j, c = 0\n\t          if (!checkNamespaces) return true\n\t          if (!this.namespaces) return false\n\t          for (i = checkNamespaces.length; i--;) {\n\t            for (j = this.namespaces.length; j--;) {\n\t              if (checkNamespaces[i] == this.namespaces[j]) c++\n\t            }\n\t          }\n\t          return checkNamespaces.length === c\n\t        }\n\t\n\t        // match by element, original fn (opt), handler fn (opt)\n\t        RegEntry.prototype.matches = function (checkElement, checkOriginal, checkHandler) {\n\t          return this.element === checkElement &&\n\t            (!checkOriginal || this.original === checkOriginal) &&\n\t            (!checkHandler || this.handler === checkHandler)\n\t        }\n\t\n\t        return RegEntry\n\t      }())\n\t\n\t    , registry = (function () {\n\t        // our map stores arrays by event type, just because it's better than storing\n\t        // everything in a single array.\n\t        // uses '$' as a prefix for the keys for safety and 'r' as a special prefix for\n\t        // rootListeners so we can look them up fast\n\t        var map = {}\n\t\n\t          // generic functional search of our registry for matching listeners,\n\t          // `fn` returns false to break out of the loop\n\t          , forAll = function (element, type, original, handler, root, fn) {\n\t              var pfx = root ? 'r' : '$'\n\t              if (!type || type == '*') {\n\t                // search the whole registry\n\t                for (var t in map) {\n\t                  if (t.charAt(0) == pfx) {\n\t                    forAll(element, t.substr(1), original, handler, root, fn)\n\t                  }\n\t                }\n\t              } else {\n\t                var i = 0, l, list = map[pfx + type], all = element == '*'\n\t                if (!list) return\n\t                for (l = list.length; i < l; i++) {\n\t                  if ((all || list[i].matches(element, original, handler)) && !fn(list[i], list, i, type)) return\n\t                }\n\t              }\n\t            }\n\t\n\t          , has = function (element, type, original, root) {\n\t              // we're not using forAll here simply because it's a bit slower and this\n\t              // needs to be fast\n\t              var i, list = map[(root ? 'r' : '$') + type]\n\t              if (list) {\n\t                for (i = list.length; i--;) {\n\t                  if (!list[i].root && list[i].matches(element, original, null)) return true\n\t                }\n\t              }\n\t              return false\n\t            }\n\t\n\t          , get = function (element, type, original, root) {\n\t              var entries = []\n\t              forAll(element, type, original, null, root, function (entry) {\n\t                return entries.push(entry)\n\t              })\n\t              return entries\n\t            }\n\t\n\t          , put = function (entry) {\n\t              var has = !entry.root && !this.has(entry.element, entry.type, null, false)\n\t                , key = (entry.root ? 'r' : '$') + entry.type\n\t              ;(map[key] || (map[key] = [])).push(entry)\n\t              return has\n\t            }\n\t\n\t          , del = function (entry) {\n\t              forAll(entry.element, entry.type, null, entry.handler, entry.root, function (entry, list, i) {\n\t                list.splice(i, 1)\n\t                entry.removed = true\n\t                if (list.length === 0) delete map[(entry.root ? 'r' : '$') + entry.type]\n\t                return false\n\t              })\n\t            }\n\t\n\t            // dump all entries, used for onunload\n\t          , entries = function () {\n\t              var t, entries = []\n\t              for (t in map) {\n\t                if (t.charAt(0) == '$') entries = entries.concat(map[t])\n\t              }\n\t              return entries\n\t            }\n\t\n\t        return { has: has, get: get, put: put, del: del, entries: entries }\n\t      }())\n\t\n\t      // we need a selector engine for delegated events, use querySelectorAll if it exists\n\t      // but for older browsers we need Qwery, Sizzle or similar\n\t    , selectorEngine\n\t    , setSelectorEngine = function (e) {\n\t        if (!arguments.length) {\n\t          selectorEngine = doc.querySelectorAll\n\t            ? function (s, r) {\n\t                return r.querySelectorAll(s)\n\t              }\n\t            : function () {\n\t                throw new Error('Bean: No selector engine installed') // eeek\n\t              }\n\t        } else {\n\t          selectorEngine = e\n\t        }\n\t      }\n\t\n\t      // we attach this listener to each DOM event that we need to listen to, only once\n\t      // per event type per DOM element\n\t    , rootListener = function (event, type) {\n\t        if (!W3C_MODEL && type && event && event.propertyName != '_on' + type) return\n\t\n\t        var listeners = registry.get(this, type || event.type, null, false)\n\t          , l = listeners.length\n\t          , i = 0\n\t\n\t        event = new Event(event, this, true)\n\t        if (type) event.type = type\n\t\n\t        // iterate through all handlers registered for this type, calling them unless they have\n\t        // been removed by a previous handler or stopImmediatePropagation() has been called\n\t        for (; i < l && !event.isImmediatePropagationStopped(); i++) {\n\t          if (!listeners[i].removed) listeners[i].handler.call(this, event)\n\t        }\n\t      }\n\t\n\t      // add and remove listeners to DOM elements\n\t    , listener = W3C_MODEL\n\t        ? function (element, type, add) {\n\t            // new browsers\n\t            element[add ? addEvent : removeEvent](type, rootListener, false)\n\t          }\n\t        : function (element, type, add, custom) {\n\t            // IE8 and below, use attachEvent/detachEvent and we have to piggy-back propertychange events\n\t            // to simulate event bubbling etc.\n\t            var entry\n\t            if (add) {\n\t              registry.put(entry = new RegEntry(\n\t                  element\n\t                , custom || type\n\t                , function (event) { // handler\n\t                    rootListener.call(element, event, custom)\n\t                  }\n\t                , rootListener\n\t                , null\n\t                , null\n\t                , true // is root\n\t              ))\n\t              if (custom && element['_on' + custom] == null) element['_on' + custom] = 0\n\t              entry.target.attachEvent('on' + entry.eventType, entry.handler)\n\t            } else {\n\t              entry = registry.get(element, custom || type, rootListener, true)[0]\n\t              if (entry) {\n\t                entry.target.detachEvent('on' + entry.eventType, entry.handler)\n\t                registry.del(entry)\n\t              }\n\t            }\n\t          }\n\t\n\t    , once = function (rm, element, type, fn, originalFn) {\n\t        // wrap the handler in a handler that does a remove as well\n\t        return function () {\n\t          fn.apply(this, arguments)\n\t          rm(element, type, originalFn)\n\t        }\n\t      }\n\t\n\t    , removeListener = function (element, orgType, handler, namespaces) {\n\t        var type     = orgType && orgType.replace(nameRegex, '')\n\t          , handlers = registry.get(element, type, null, false)\n\t          , removed  = {}\n\t          , i, l\n\t\n\t        for (i = 0, l = handlers.length; i < l; i++) {\n\t          if ((!handler || handlers[i].original === handler) && handlers[i].inNamespaces(namespaces)) {\n\t            // TODO: this is problematic, we have a registry.get() and registry.del() that\n\t            // both do registry searches so we waste cycles doing this. Needs to be rolled into\n\t            // a single registry.forAll(fn) that removes while finding, but the catch is that\n\t            // we'll be splicing the arrays that we're iterating over. Needs extra tests to\n\t            // make sure we don't screw it up. @rvagg\n\t            registry.del(handlers[i])\n\t            if (!removed[handlers[i].eventType] && handlers[i][eventSupport])\n\t              removed[handlers[i].eventType] = { t: handlers[i].eventType, c: handlers[i].type }\n\t          }\n\t        }\n\t        // check each type/element for removed listeners and remove the rootListener where it's no longer needed\n\t        for (i in removed) {\n\t          if (!registry.has(element, removed[i].t, null, false)) {\n\t            // last listener of this type, remove the rootListener\n\t            listener(element, removed[i].t, false, removed[i].c)\n\t          }\n\t        }\n\t      }\n\t\n\t      // set up a delegate helper using the given selector, wrap the handler function\n\t    , delegate = function (selector, fn) {\n\t        //TODO: findTarget (therefore $) is called twice, once for match and once for\n\t        // setting e.currentTarget, fix this so it's only needed once\n\t        var findTarget = function (target, root) {\n\t              var i, array = isString(selector) ? selectorEngine(selector, root) : selector\n\t              for (; target && target !== root; target = target.parentNode) {\n\t                for (i = array.length; i--;) {\n\t                  if (array[i] === target) return target\n\t                }\n\t              }\n\t            }\n\t          , handler = function (e) {\n\t              var match = findTarget(e.target, this)\n\t              if (match) fn.apply(match, arguments)\n\t            }\n\t\n\t        // __beanDel isn't pleasant but it's a private function, not exposed outside of Bean\n\t        handler.__beanDel = {\n\t            ft       : findTarget // attach it here for customEvents to use too\n\t          , selector : selector\n\t        }\n\t        return handler\n\t      }\n\t\n\t    , fireListener = W3C_MODEL ? function (isNative, type, element) {\n\t        // modern browsers, do a proper dispatchEvent()\n\t        var evt = doc.createEvent(isNative ? 'HTMLEvents' : 'UIEvents')\n\t        evt[isNative ? 'initEvent' : 'initUIEvent'](type, true, true, win, 1)\n\t        element.dispatchEvent(evt)\n\t      } : function (isNative, type, element) {\n\t        // old browser use onpropertychange, just increment a custom property to trigger the event\n\t        element = targetElement(element, isNative)\n\t        isNative ? element.fireEvent('on' + type, doc.createEventObject()) : element['_on' + type]++\n\t      }\n\t\n\t      /**\n\t        * Public API: off(), on(), add(), (remove()), one(), fire(), clone()\n\t        */\n\t\n\t      /**\n\t        * off(element[, eventType(s)[, handler ]])\n\t        */\n\t    , off = function (element, typeSpec, fn) {\n\t        var isTypeStr = isString(typeSpec)\n\t          , k, type, namespaces, i\n\t\n\t        if (isTypeStr && typeSpec.indexOf(' ') > 0) {\n\t          // off(el, 't1 t2 t3', fn) or off(el, 't1 t2 t3')\n\t          typeSpec = str2arr(typeSpec)\n\t          for (i = typeSpec.length; i--;)\n\t            off(element, typeSpec[i], fn)\n\t          return element\n\t        }\n\t\n\t        type = isTypeStr && typeSpec.replace(nameRegex, '')\n\t        if (type && customEvents[type]) type = customEvents[type].base\n\t\n\t        if (!typeSpec || isTypeStr) {\n\t          // off(el) or off(el, t1.ns) or off(el, .ns) or off(el, .ns1.ns2.ns3)\n\t          if (namespaces = isTypeStr && typeSpec.replace(namespaceRegex, '')) namespaces = str2arr(namespaces, '.')\n\t          removeListener(element, type, fn, namespaces)\n\t        } else if (isFunction(typeSpec)) {\n\t          // off(el, fn)\n\t          removeListener(element, null, typeSpec)\n\t        } else {\n\t          // off(el, { t1: fn1, t2, fn2 })\n\t          for (k in typeSpec) {\n\t            if (typeSpec.hasOwnProperty(k)) off(element, k, typeSpec[k])\n\t          }\n\t        }\n\t\n\t        return element\n\t      }\n\t\n\t      /**\n\t        * on(element, eventType(s)[, selector], handler[, args ])\n\t        */\n\t    , on = function(element, events, selector, fn) {\n\t        var originalFn, type, types, i, args, entry, first\n\t\n\t        //TODO: the undefined check means you can't pass an 'args' argument, fix this perhaps?\n\t        if (selector === undefined && typeof events == 'object') {\n\t          //TODO: this can't handle delegated events\n\t          for (type in events) {\n\t            if (events.hasOwnProperty(type)) {\n\t              on.call(this, element, type, events[type])\n\t            }\n\t          }\n\t          return\n\t        }\n\t\n\t        if (!isFunction(selector)) {\n\t          // delegated event\n\t          originalFn = fn\n\t          args       = slice.call(arguments, 4)\n\t          fn         = delegate(selector, originalFn, selectorEngine)\n\t        } else {\n\t          args       = slice.call(arguments, 3)\n\t          fn         = originalFn = selector\n\t        }\n\t\n\t        types = str2arr(events)\n\t\n\t        // special case for one(), wrap in a self-removing handler\n\t        if (this === ONE) {\n\t          fn = once(off, element, events, fn, originalFn)\n\t        }\n\t\n\t        for (i = types.length; i--;) {\n\t          // add new handler to the registry and check if it's the first for this element/type\n\t          first = registry.put(entry = new RegEntry(\n\t              element\n\t            , types[i].replace(nameRegex, '') // event type\n\t            , fn\n\t            , originalFn\n\t            , str2arr(types[i].replace(namespaceRegex, ''), '.') // namespaces\n\t            , args\n\t            , false // not root\n\t          ))\n\t          if (entry[eventSupport] && first) {\n\t            // first event of this type on this element, add root listener\n\t            listener(element, entry.eventType, true, entry.customType)\n\t          }\n\t        }\n\t\n\t        return element\n\t      }\n\t\n\t      /**\n\t        * add(element[, selector], eventType(s), handler[, args ])\n\t        *\n\t        * Deprecated: kept (for now) for backward-compatibility\n\t        */\n\t    , add = function (element, events, fn, delfn) {\n\t        return on.apply(\n\t            null\n\t          , !isString(fn)\n\t              ? slice.call(arguments)\n\t              : [ element, fn, events, delfn ].concat(arguments.length > 3 ? slice.call(arguments, 5) : [])\n\t        )\n\t      }\n\t\n\t      /**\n\t        * one(element, eventType(s)[, selector], handler[, args ])\n\t        */\n\t    , one = function () {\n\t        return on.apply(ONE, arguments)\n\t      }\n\t\n\t      /**\n\t        * fire(element, eventType(s)[, args ])\n\t        *\n\t        * The optional 'args' argument must be an array, if no 'args' argument is provided\n\t        * then we can use the browser's DOM event system, otherwise we trigger handlers manually\n\t        */\n\t    , fire = function (element, type, args) {\n\t        var types = str2arr(type)\n\t          , i, j, l, names, handlers\n\t\n\t        for (i = types.length; i--;) {\n\t          type = types[i].replace(nameRegex, '')\n\t          if (names = types[i].replace(namespaceRegex, '')) names = str2arr(names, '.')\n\t          if (!names && !args && element[eventSupport]) {\n\t            fireListener(nativeEvents[type], type, element)\n\t          } else {\n\t            // non-native event, either because of a namespace, arguments or a non DOM element\n\t            // iterate over all listeners and manually 'fire'\n\t            handlers = registry.get(element, type, null, false)\n\t            args = [false].concat(args)\n\t            for (j = 0, l = handlers.length; j < l; j++) {\n\t              if (handlers[j].inNamespaces(names)) {\n\t                handlers[j].handler.apply(element, args)\n\t              }\n\t            }\n\t          }\n\t        }\n\t        return element\n\t      }\n\t\n\t      /**\n\t        * clone(dstElement, srcElement[, eventType ])\n\t        *\n\t        * TODO: perhaps for consistency we should allow the same flexibility in type specifiers?\n\t        */\n\t    , clone = function (element, from, type) {\n\t        var handlers = registry.get(from, type, null, false)\n\t          , l = handlers.length\n\t          , i = 0\n\t          , args, beanDel\n\t\n\t        for (; i < l; i++) {\n\t          if (handlers[i].original) {\n\t            args = [ element, handlers[i].type ]\n\t            if (beanDel = handlers[i].handler.__beanDel) args.push(beanDel.selector)\n\t            args.push(handlers[i].original)\n\t            on.apply(null, args)\n\t          }\n\t        }\n\t        return element\n\t      }\n\t\n\t    , bean = {\n\t          'on'                : on\n\t        , 'add'               : add\n\t        , 'one'               : one\n\t        , 'off'               : off\n\t        , 'remove'            : off\n\t        , 'clone'             : clone\n\t        , 'fire'              : fire\n\t        , 'Event'             : Event\n\t        , 'setSelectorEngine' : setSelectorEngine\n\t        , 'noConflict'        : function () {\n\t            context[name] = old\n\t            return this\n\t          }\n\t      }\n\t\n\t  // for IE, clean up on unload to avoid leaks\n\t  if (win.attachEvent) {\n\t    var cleanup = function () {\n\t      var i, entries = registry.entries()\n\t      for (i in entries) {\n\t        if (entries[i].type && entries[i].type !== 'unload') off(entries[i].element, entries[i].type)\n\t      }\n\t      win.detachEvent('onunload', cleanup)\n\t      win.CollectGarbage && win.CollectGarbage()\n\t    }\n\t    win.attachEvent('onunload', cleanup)\n\t  }\n\t\n\t  // initialize selector engine to internal default (qSA or throw Error)\n\t  setSelectorEngine()\n\t\n\t  return bean\n\t});\n\n\n/***/ },\n/* 13 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t\tvalue: true\n\t});\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tvar _lodash = __webpack_require__(5);\n\t\n\tvar _lodash2 = _interopRequireDefault(_lodash);\n\t\n\tvar _bean = __webpack_require__(12);\n\t\n\tvar _bean2 = _interopRequireDefault(_bean);\n\t\n\tvar _KeyUtils = __webpack_require__(14);\n\t\n\tvar KeyUtils = _interopRequireWildcard(_KeyUtils);\n\t\n\tvar _Utils = __webpack_require__(2);\n\t\n\tvar _Utils2 = _interopRequireDefault(_Utils);\n\t\n\tvar _DomUtils = __webpack_require__(7);\n\t\n\tvar _DomUtils2 = _interopRequireDefault(_DomUtils);\n\t\n\tvar _StringBuffer = __webpack_require__(8);\n\t\n\tvar _StringBuffer2 = _interopRequireDefault(_StringBuffer);\n\t\n\tfunction _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj.default = obj; return newObj; } }\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tvar DEFAULTS = {\n\t\tstopPropagation: false\n\t};\n\t\n\tvar EventDispatcher = function () {\n\t\t/**\n\t  * Constructor\n\t  * @param root the root element that the manager will listen to.\n\t  * @param zoomScale\n\t  * @param config the configuraton for the event dispatcher.\n\t  */\n\t\n\t\tfunction EventDispatcher(root) {\n\t\t\tvar zoomScale = arguments.length <= 1 || arguments[1] === undefined ? [0, Infinity] : arguments[1];\n\t\t\tvar config = arguments.length <= 2 || arguments[2] === undefined ? {} : arguments[2];\n\t\n\t\t\t_classCallCheck(this, EventDispatcher);\n\t\n\t\t\tthis.root = root;\n\t\t\tthis.rootNS = root.getAttribute('ns') || 'root';\n\t\t\tthis.zoomScale = zoomScale;\n\t\t\t_lodash2.default.assign(this, DEFAULTS, config);\n\t\t\tthis.scale = 1.0;\n\t\t\tthis.listeners = {};\n\t\t\tthis.dragging = false;\n\t\t\tthis.handler = _lodash2.default.bind(this.handleEvent, this);\n\t\t\tthis.started = false;\n\t\n\t\t\t// Simulate mouseenter/mouseleave events\n\t\t\tthis.enterStack = [];\n\t\t}\n\t\n\t\t/**\n\t  * Start listening for events.\n\t  */\n\t\n\t\n\t\t_createClass(EventDispatcher, [{\n\t\t\tkey: \"start\",\n\t\t\tvalue: function start() {\n\t\t\t\tif (this.started) return;\n\t\t\t\t_bean2.default.on(this.root, 'mousedown mouseover mouseout mouseenter mouseleave dblclick click contextmenu mousewheel', this.handler);\n\t\t\t\tthis.startKeys();\n\t\t\t\tthis.started = true;\n\t\t\t}\n\t\n\t\t\t/**\n\t   * Stop listening for events.\n\t   */\n\t\n\t\t}, {\n\t\t\tkey: \"stop\",\n\t\t\tvalue: function stop() {\n\t\t\t\tif (!this.started) return;\n\t\t\t\t_bean2.default.off(this.root, 'mousedown mouseover mouseout mouseenter mouseleave dblclick click contextmenu mousewheel', this.handler);\n\t\t\t\tthis.stopKeys();\n\t\t\t\tthis.started = false;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"startKeys\",\n\t\t\tvalue: function startKeys() {\n\t\t\t\t_bean2.default.on(document, 'keydown keyup', this.handler);\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"stopKeys\",\n\t\t\tvalue: function stopKeys() {\n\t\t\t\t_bean2.default.off(document, 'keydown keyup', this.handler);\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"zoomIn\",\n\t\t\tvalue: function zoomIn() {\n\t\t\t\tthis.scale *= 1.25;\n\t\t\t\tthis.scale = Math.max(Math.min(this.zoomScale[1], this.scale), this.zoomScale[0]);\n\t\t\t\treturn this.scale;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"zoomOut\",\n\t\t\tvalue: function zoomOut() {\n\t\t\t\tthis.scale *= 0.8;\n\t\t\t\tthis.scale = Math.max(Math.min(this.zoomScale[1], this.scale), this.zoomScale[0]);\n\t\t\t\treturn this.scale;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"getEventInfo\",\n\t\t\tvalue: function getEventInfo(event) {\n\t\t\t\tvar target = event.target;\n\t\t\t\tvar buf = new _StringBuffer2.default(),\n\t\t\t\t    ns = void 0,\n\t\t\t\t    stack = [],\n\t\t\t\t    isRoot = false;\n\t\t\t\twhile (!isRoot && target && target != document) {\n\t\t\t\t\tns = target.getAttribute('ns');\n\t\t\t\t\tif (ns) {\n\t\t\t\t\t\tisRoot = _lodash2.default.startsWith(ns, \"root.\");\n\t\t\t\t\t\tif (isRoot) {\n\t\t\t\t\t\t\tns = ns.substring(5);\n\t\t\t\t\t\t\tevent.rootTarget = target;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (!event.nsTarget) event.nsTarget = target;\n\t\t\t\t\t\tstack.splice(0, 0, target);\n\t\t\t\t\t\tbuf.prepend(ns);\n\t\t\t\t\t}\n\t\t\t\t\ttarget = target.parentNode;\n\t\t\t\t}\n\t\t\t\tif (!isRoot) event.rootTarget = event.nsTarget;\n\t\n\t\t\t\t// target stack is a stack of all the ns targets up to the one with the data binding.\n\t\t\t\tevent.targetStack = stack;\n\t\t\t\tns = buf.toString('.');\n\t\t\t\tif (ns == '') ns = this.rootNS;\n\t\t\t\treturn { data: event.rootTarget, ns: ns };\n\t\t\t}\n\t\n\t\t\t/**\n\t   * The main event handler method, it processes event and generate relevant events to dispatch.\n\t   */\n\t\n\t\t}, {\n\t\t\tkey: \"handleEvent\",\n\t\t\tvalue: function handleEvent(event) {\n\t\t\t\tvar _this = this;\n\t\n\t\t\t\tvar type = event.type;\n\t\n\t\t\t\t// Do not dispatch other events if we are dragging.\n\t\t\t\tif (this.dragging || _DomUtils2.default.eventFromInput(event)) return;\n\t\n\t\t\t\tvar data = void 0,\n\t\t\t\t    ns = void 0,\n\t\t\t\t    pos = this.getPosition(event),\n\t\t\t\t    info = void 0,\n\t\t\t\t    isKeyEvent = type == 'keydown' || type == 'keyup';\n\t\t\t\tif (isKeyEvent) {\n\t\t\t\t\tdata = this.root;\n\t\t\t\t\tns = KeyUtils.getKeyEvent(event);\n\t\t\t\t} else {\n\t\t\t\t\tinfo = this.getEventInfo(event);\n\t\t\t\t\tif (!info) return;\n\t\t\t\t\tdata = info.data;\n\t\t\t\t\tns = info.ns;\n\t\t\t\t}\n\t\n\t\t\t\t//Utils.log('EventDispatcher', \"handleEvent - \" + type + ';ns=' + ns);\n\t\n\t\t\t\tif (type == 'mousewheel') {\n\t\t\t\t\tthis.scale *= Math.pow(2, event.wheelDelta * 0.002);\n\t\t\t\t\tthis.scale = Math.max(Math.min(this.zoomScale[1], this.scale), this.zoomScale[0]);\n\t\t\t\t\tevent.scale = this.scale;\n\t\t\t\t\ttype = 'zoom';\n\t\t\t\t}\n\t\n\t\t\t\t// See if we should create drag events\n\t\t\t\tif (type == 'mousedown' && event.button == 0 /*only drag on left click*/) {\n\t\t\t\t\t\t(function () {\n\t\t\t\t\t\t\t// Create drag object.\n\t\t\t\t\t\t\tvar dragObject = { data: data, pos: ns == 'root' ? EventDispatcher.mouse(_this.root, event) : pos };\n\t\t\t\t\t\t\t_this.dragging = false;\n\t\t\t\t\t\t\t// Start listening for mouse move.\n\t\t\t\t\t\t\tvar dragPos = void 0;\n\t\n\t\t\t\t\t\t\tvar mousemove = function mousemove(event) {\n\t\t\t\t\t\t\t\tvar currentPos = _this.getPosition(event);\n\t\t\t\t\t\t\t\tif (!_this.dragging) {\n\t\t\t\t\t\t\t\t\t// check if the mouse has moved. IE always fire mousemove after mousedown even if the mouse hasn't moved yet.\n\t\t\t\t\t\t\t\t\tif (dragObject.pos[0] == currentPos[0] && dragObject.pos[1] == currentPos[1]) return;\n\t\n\t\t\t\t\t\t\t\t\t// start dragging\n\t\t\t\t\t\t\t\t\t_this.dragging = true;\n\t\t\t\t\t\t\t\t\tevent.rootTarget = dragObject.data;\n\t\t\t\t\t\t\t\t\t_this.dispatch(event, 'dragstart', ns, dragObject.data, dragObject.pos);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tif (ns == \"root\") dragPos = EventDispatcher.mouse(_this.root, event);else dragPos = currentPos;\n\t\t\t\t\t\t\t\t_this.getEventInfo(event);\n\t\t\t\t\t\t\t\t_this.dispatch(event, 'drag', ns, dragObject.data, dragPos);\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\tvar mouseup = function mouseup(event) {\n\t\t\t\t\t\t\t\tif (ns == \"root\") dragPos = EventDispatcher.mouse(_this.root, event);else dragPos = _this.getPosition(event);\n\t\n\t\t\t\t\t\t\t\tvar info = _this.getEventInfo(event);\n\t\t\t\t\t\t\t\tif (_this.dragging) {\n\t\t\t\t\t\t\t\t\t_this.dragging = false;\n\t\t\t\t\t\t\t\t\t_this.dispatch(event, 'dragend', ns, dragObject.data, dragPos);\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t_this.dispatch(event, 'mouseup', ns, info.data, dragPos);\n\t\t\t\t\t\t\t\t}\n\t\n\t\t\t\t\t\t\t\t_bean2.default.off(window, 'mousemove', mousemove);\n\t\t\t\t\t\t\t\t_bean2.default.off(window, 'mouseup', mouseup);\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\tevent.preventDefault();\n\t\t\t\t\t\t\t_bean2.default.on(window, 'mousemove', mousemove);\n\t\t\t\t\t\t\t_bean2.default.on(window, 'mouseup', mouseup);\n\t\t\t\t\t\t})();\n\t\t\t\t\t}\n\t\n\t\t\t\tif (!isKeyEvent) this.simulateEnterLeave(event, type, ns, data, pos);\n\t\t\t\tthis.dispatch(event, type, ns, data, pos);\n\t\n\t\t\t\t// disable the default context menu\n\t\t\t\t//if (type == 'contextmenu')\n\t\t\t\t//\tevent.preventDefault();\n\t\t\t}\n\t\n\t\t\t/**\n\t   * try to simulate mouseenter/mouseleave events.\n\t   */\n\t\n\t\t}, {\n\t\t\tkey: \"simulateEnterLeave\",\n\t\t\tvalue: function simulateEnterLeave(event, type, ns, data, pos) {\n\t\t\t\tvar _this2 = this;\n\t\n\t\t\t\tvar last = void 0,\n\t\t\t\t    stack = void 0;\n\t\t\t\tvar clearEnterStack = function clearEnterStack(k) {\n\t\t\t\t\tk = k || 0;\n\t\t\t\t\t// Clear off the enter stack.\n\t\t\t\t\twhile (_this2.enterStack.length >= k + 1) {\n\t\t\t\t\t\tlast = _this2.enterStack.pop();\n\t\t\t\t\t\t_this2.dispatch(event, 'mouseleave', last.ns, last.data, pos);\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t\tvar getNS = function getNS(index) {\n\t\t\t\t\tvar buf = new _StringBuffer2.default();\n\t\t\t\t\tfor (var i = 0; i <= index; i++) {\n\t\t\t\t\t\tvar val = stack[i].getAttribute(\"ns\");\n\t\t\t\t\t\tif (_lodash2.default.startsWith(val, \"root.\")) val = val.substring(5);\n\t\t\t\t\t\tbuf.append(val);\n\t\t\t\t\t}\n\t\t\t\t\treturn buf.toString('.');\n\t\t\t\t};\n\t\n\t\t\t\tif (ns && ns != this.rootNS) {\n\t\t\t\t\tif (type == 'mouseover') {\n\t\t\t\t\t\tstack = event.targetStack;\n\t\t\t\t\t\tvar item = void 0;\n\t\t\t\t\t\tfor (var i = 0; i < stack.length; i++) {\n\t\t\t\t\t\t\tif (i < this.enterStack.length) {\n\t\t\t\t\t\t\t\tif (this.enterStack[i].target != stack[i]) {\n\t\t\t\t\t\t\t\t\tclearEnterStack(i);\n\t\t\t\t\t\t\t\t} else continue;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\titem = { data: data, ns: getNS(i), target: stack[i] };\n\t\t\t\t\t\t\tthis.enterStack.push(item);\n\t\t\t\t\t\t\tthis.dispatch(event, 'mouseenter', item.ns, data, pos);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (stack.length < this.enterStack.length) clearEnterStack(stack.length);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (ns == this.rootNS && this.enterStack.length > 0) clearEnterStack();\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"dispatch\",\n\t\t\tvalue: function dispatch(event, type, ns, data, pos) {\n\t\t\t\t//if (type != 'mouseover' && type != 'mouseout')\n\t\t\t\t//\tUtils.log('EventDispatcher', \"dispatch - \" + type + '.' + ns + ';' + pos + ';rootTarget=' + event.rootTarget + ';data=' + data);\n\t\t\t\tif (!this.started) return;\n\t\t\t\tvar nsType = ns ? type + '.' + ns : type;\n\t\t\t\t_lodash2.default.forEach(this.listeners, function (listeners, key) {\n\t\t\t\t\tif (EventDispatcher.match(nsType, listeners.regexp ? listeners.regexp : key)) {\n\t\t\t\t\t\t_lodash2.default.forEach(listeners, function (listener) {\n\t\t\t\t\t\t\tif (!listener.context) listener.callback.apply(window, [type, ns, data, pos, event]);else listener.callback.apply(listener.context, [type, ns, data, pos, event]);\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t});\n\t\n\t\t\t\t// after dispatching, do not propagate.\n\t\t\t\tif (this.stopPropagation && event.stopPropagation) event.stopPropagation();\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"getPosition\",\n\t\t\tvalue: function getPosition(event) {\n\t\t\t\tvar pos = EventDispatcher.mouse(this.root, event);\n\t\t\t\tif (!_lodash2.default.isNaN(pos[0]) && !_lodash2.default.isNaN(pos[1])) this.lastPosition = pos;\n\t\t\t\treturn this.lastPosition;\n\t\t\t}\n\t\n\t\t\t/**\n\t   * Registers a key event handler\n\t   * // Key is object {ctrl, alt, shift, meta, code}\n\t   */\n\t\n\t\t}, {\n\t\t\tkey: \"registerKey\",\n\t\t\tvalue: function registerKey(type, key, callback, context) {\n\t\t\t\tvar _this3 = this;\n\t\n\t\t\t\tif (_lodash2.default.isArray(key)) {\n\t\t\t\t\t_lodash2.default.forEach(key, function (k) {\n\t\t\t\t\t\t_this3.registerKey(type, k, callback, context);\n\t\t\t\t\t});\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tkey = KeyUtils.getKeyData(key.ctrl, key.alt, key.shift, key.meta, key.code);\n\t\t\t\tif (!key.length) return;\n\t\t\t\tkey = new _StringBuffer2.default(type).append(key).toString('.');\n\t\n\t\t\t\tvar listener = { callback: callback, context: context };\n\t\t\t\tthis.listeners[key] || (this.listeners[key] = []);\n\t\t\t\tthis.listeners[key].push(listener);\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"unregisterKey\",\n\t\t\tvalue: function unregisterKey(type, key, callback, context) {\n\t\t\t\tvar _this4 = this;\n\t\n\t\t\t\tif (_lodash2.default.isArray(key)) {\n\t\t\t\t\t_lodash2.default.forEach(key, function (k) {\n\t\t\t\t\t\t_this4.unregisterKey(type, k, callback, context);\n\t\t\t\t\t});\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tkey = KeyUtils.getKeyData(key.ctrl, key.alt, key.shift, key.meta, key.code);\n\t\t\t\tif (!key.length) return;\n\t\t\t\tkey = new _StringBuffer2.default(type).append(key).toString('.');\n\t\n\t\t\t\tvar listeners = this.listeners[key],\n\t\t\t\t    listener = void 0;\n\t\t\t\tif (!listeners) return;\n\t\t\t\tfor (var i = 0; i < listeners.length; i++) {\n\t\t\t\t\tlistener = listeners[i];\n\t\t\t\t\tif (listener.callback === callback && (!context || context === listener.context)) {\n\t\t\t\t\t\tlisteners.splice(i, 1);\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\n\t\t\t/**\n\t   * Registers an event handler\n\t   */\n\t\n\t\t}, {\n\t\t\tkey: \"register\",\n\t\t\tvalue: function register(type, callback, context, zIndex) {\n\t\t\t\tvar _this5 = this;\n\t\n\t\t\t\tif (_lodash2.default.isArray(type)) {\n\t\t\t\t\t_lodash2.default.forEach(type, function (t) {\n\t\t\t\t\t\t_this5.register(t, callback, context, zIndex);\n\t\t\t\t\t});\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tvar listener = { callback: callback, context: context, zIndex: zIndex };\n\t\t\t\tvar regexp = null;\n\t\t\t\tif (type instanceof RegExp) {\n\t\t\t\t\tregexp = type;\n\t\t\t\t\ttype = type + '';\n\t\t\t\t}\n\t\t\t\tthis.listeners[type] || (this.listeners[type] = []);\n\t\t\t\tif (regexp && !this.listeners[type].regexp) this.listeners[type].regexp = regexp;\n\t\t\t\tthis.listeners[type].push(listener);\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"unregister\",\n\t\t\tvalue: function unregister(type, callback, context) {\n\t\t\t\tif (type instanceof RegExp) type = type + '';\n\t\t\t\tvar listeners = this.listeners[type],\n\t\t\t\t    listener = void 0;\n\t\t\t\tif (!listeners) return;\n\t\t\t\tfor (var i = 0; i < listeners.length; i++) {\n\t\t\t\t\tlistener = listeners[i];\n\t\t\t\t\tif (listener.callback === callback && (!context || context === listener.context)) {\n\t\t\t\t\t\tlisteners.splice(i, 1);\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"destroy\",\n\t\t\tvalue: function destroy() {\n\t\t\t\tthis.stop();\n\t\t\t\tdelete this.root;\n\t\t\t\tdelete this.listeners;\n\t\t\t\tdelete this.enterStack;\n\t\t\t}\n\t\n\t\t\t/**\n\t   * Check if the registered event type matches the real event type. \"*\" is allowed as a wild card.\n\t   */\n\t\n\t\t}], [{\n\t\t\tkey: \"match\",\n\t\t\tvalue: function match(nsType, registeredType) {\n\t\t\t\tif (registeredType instanceof RegExp) return nsType.match(registeredType);\n\t\n\t\t\t\treturn nsType == registeredType;\n\t\t\t\t/*const arr = registeredType.split('*');\n\t   if (arr.length == 1)\n\t   \treturn nsType == registeredType;\n\t   \tlet substr, index = 0;\n\t   for (let i = 0; i < arr.length; i++) {\n\t   \tif (arr[i].length == 0) continue;\n\t   \tsubstr = nsType.slice(index);\n\t   \tindex = substr.indexOf(arr[i]);\n\t   \tif (index < 0)\n\t   \t\treturn false;\n\t   \tindex += arr[i].length;\n\t   }\n\t   return true;*/\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"mouse\",\n\t\t\tvalue: function mouse(container, e) {\n\t\t\t\tif (e.changedTouches) e = e.changedTouches[0];\n\t\t\t\tvar svg = container.ownerSVGElement || container;\n\t\t\t\tif (svg.createSVGPoint) {\n\t\t\t\t\tvar point = svg.createSVGPoint();\n\t\t\t\t\tpoint.x = e.clientX;point.y = e.clientY;\n\t\t\t\t\tpoint = point.matrixTransform(container.getScreenCTM().inverse());\n\t\t\t\t\treturn [point.x, point.y];\n\t\t\t\t}\n\t\t\t\tvar rect = container.getBoundingClientRect();\n\t\t\t\treturn [e.clientX - rect.left - container.clientLeft, e.clientY - rect.top - container.clientTop];\n\t\t\t}\n\t\t}]);\n\t\n\t\treturn EventDispatcher;\n\t}();\n\t\n\texports.default = EventDispatcher;\n\n/***/ },\n/* 14 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t\tvalue: true\n\t});\n\texports.getKeyEvent = getKeyEvent;\n\texports.getKeyData = getKeyData;\n\t\n\tvar _StringBuffer = __webpack_require__(8);\n\t\n\tvar _StringBuffer2 = _interopRequireDefault(_StringBuffer);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\t/**\n\t * KEY constant\n\t */\n\tvar KEY = {\n\t\tALT: 18,\n\t\tBACK_SPACE: 8,\n\t\tCAPS_LOCK: 20,\n\t\tCONTROL: 17,\n\t\tDELETE: 46,\n\t\tDOWN: 40,\n\t\tEND: 35,\n\t\tENTER: 13,\n\t\tESCAPE: 220,\n\t\tHOME: 36,\n\t\tLEFT: 37,\n\t\tMETA: 224,\n\t\tNUM_LOCK: 144,\n\t\tPAGE_DOWN: 34,\n\t\tPAGE_UP: 33,\n\t\tPAUSE: 19,\n\t\tPRINTSCREEN: 44,\n\t\tRIGHT: 39,\n\t\tSCROLL_LOCK: 145,\n\t\tSHIFT: 16,\n\t\tSPACE: 32,\n\t\tTAB: 9,\n\t\tUP: 38\n\t\t//ADD          : DomUtils.isFireFox ? 61  : 187,\n\t\t//SUBTRACT     : DomUtils.isFireFox ? 173 : 189\n\t}; ///////////////////////////////////////////////////////////////////////////////\n\t//                                                                           //\n\t//           The Key Utility CLass for the Event Dispatcher          \t     //\n\t//                                                                           //\n\t///////////////////////////////////////////////////////////////////////////////\n\t\n\tfunction getKeyEvent(event) {\n\t\tif (!event || !event instanceof KeyboardEvent) {\n\t\t\treturn null;\n\t\t}\n\t\n\t\tvar key = event.keyCode || event.which;\n\t\n\t\t// Need to find a way to avoid this\n\t\tif (key >= 16 && key <= 18) {\n\t\t\tkey = null;\n\t\t}\n\t\n\t\treturn getKeyData(event.ctrlKey, event.altKey, event.shiftKey, event.metaKey, key);\n\t}\n\t\n\tfunction getKeyData(ctrl, alt, shift, meta, key) {\n\t\tvar buf = new _StringBuffer2.default();\n\t\n\t\tif (ctrl) buf.append(\"CTRL\");\n\t\tif (alt) buf.append(\"ALT\");\n\t\tif (shift) buf.append(\"SHIFT\");\n\t\tif (meta) buf.append(\"META\");\n\t\tif (key) buf.append(key);\n\t\n\t\treturn buf.toString(\".\");\n\t}\n\n/***/ },\n/* 15 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t\tvalue: true\n\t});\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tvar _lodash = __webpack_require__(5);\n\t\n\tvar _lodash2 = _interopRequireDefault(_lodash);\n\t\n\tvar _Utils = __webpack_require__(2);\n\t\n\tvar _Utils2 = _interopRequireDefault(_Utils);\n\t\n\tvar _Node = __webpack_require__(16);\n\t\n\tvar _Node2 = _interopRequireDefault(_Node);\n\t\n\tvar _Edge = __webpack_require__(20);\n\t\n\tvar _Edge2 = _interopRequireDefault(_Edge);\n\t\n\tvar _Marker = __webpack_require__(21);\n\t\n\tvar _Marker2 = _interopRequireDefault(_Marker);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tvar nodeDefaults = {\n\t\tname: 'Default',\n\t\trole: 'node',\n\t\tdraggable: true,\n\t\tselectable: true,\n\t\teditable: true,\n\t\tresizable: false,\n\t\tsourceable: true,\n\t\ttargetable: true,\n\t\tvisible: true\n\t};\n\t\n\tvar edgeDefaults = {\n\t\tname: 'Default',\n\t\trole: 'edge',\n\t\tselectable: true,\n\t\tvisible: true,\n\t\tstartMarker: null,\n\t\tendMarker: {\n\t\t\tid: 'Default_EndMarker',\n\t\t\ttype: 'arrow',\n\t\t\tsize: 10,\n\t\t\tcolor: '#0ea117'\n\t\t},\n\t\t/* start and end is only used if the edge is not connected to a node */\n\t\tstart: [0, 0],\n\t\tend: [400, 200]\n\t};\n\t\n\tvar Graph = function () {\n\t\tfunction Graph() {\n\t\t\tvar id = arguments.length <= 0 || arguments[0] === undefined ? _lodash2.default.uniqueId(\"G\") : arguments[0];\n\t\t\tvar config = arguments.length <= 1 || arguments[1] === undefined ? {} : arguments[1];\n\t\t\tvar model = arguments[2];\n\t\n\t\t\t_classCallCheck(this, Graph);\n\t\n\t\t\tthis.id = id;\n\t\n\t\t\tthis.nodes = {};\n\t\t\tthis.edges = {};\n\t\n\t\t\tthis.selection = null;\n\t\t\tthis.destroyed = false;\n\t\n\t\t\t_Utils2.default.buildTypes(config.nodeTypes, \"Nodes\", nodeDefaults);\n\t\t\t_Utils2.default.buildTypes(config.edgeTypes, \"Edges\", edgeDefaults);\n\t\t\t// check for markers.\n\t\t\tthis.markers = [];\n\t\t\tvar edgeTypes = _Utils2.default.type(_Edge2.default.namespace),\n\t\t\t    marker = void 0,\n\t\t\t    markerConfig = void 0;\n\t\t\tedgeTypes.forEach(function (type) {\n\t\t\t\tmarkerConfig = type.prototype.startMarker;\n\t\t\t\tif (markerConfig) {\n\t\t\t\t\tmarker = _Marker2.default.getMarker(markerConfig, true);\n\t\t\t\t\tthis.markers.push(marker);\n\t\t\t\t}\n\t\t\t\tmarkerConfig = type.prototype.endMarker;\n\t\t\t\tif (markerConfig) {\n\t\t\t\t\tmarker = _Marker2.default.getMarker(markerConfig, false);\n\t\t\t\t\tthis.markers.push(marker);\n\t\t\t\t}\n\t\t\t}, this);\n\t\n\t\t\tdelete config.nodeTypes;\n\t\t\tdelete config.edgeTypes;\n\t\t\t_Utils2.default.initConfig(this, config);\n\t\t\tthis.root = null;\n\t\t\tif (model) this.loadModel(model);\n\t\t}\n\t\n\t\t_createClass(Graph, [{\n\t\t\tkey: \"addNode\",\n\t\n\t\n\t\t\t/**\n\t   * Create a new Node\n\t   */\n\t\t\tvalue: function addNode(config) {\n\t\t\t\tvar parent = arguments.length <= 1 || arguments[1] === undefined ? this.currentRoot : arguments[1];\n\t\t\t\tvar pos = arguments[2];\n\t\n\t\t\t\tvar NodeClass = Graph.getJSClass(config, _Node2.default);\n\t\t\t\tvar node = new NodeClass(this, config);\n\t\n\t\t\t\tif (parent) Graph.addChild(parent, node, pos);else {\n\t\t\t\t\tthis.root = node;\n\t\t\t\t\tthis.root.prop('role', 'root');\n\t\t\t\t}\n\t\n\t\t\t\tthis.nodes[node.id] = node;\n\t\t\t\treturn node;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"addEdge\",\n\t\t\tvalue: function addEdge(config) {\n\t\t\t\tvar parent = arguments.length <= 1 || arguments[1] === undefined ? this.currentRoot : arguments[1];\n\t\t\t\tvar from = arguments[2];\n\t\t\t\tvar to = arguments[3];\n\t\n\t\t\t\tvar EdgeClass = Graph.getJSClass(config, _Edge2.default);\n\t\t\t\tvar edge = new EdgeClass(this, config, from, to);\n\t\n\t\t\t\tGraph.addChild(parent, edge);\n\t\t\t\tthis.edges[edge.id] = edge;\n\t\t\t\treturn edge;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"loadModel\",\n\t\t\tvalue: function loadModel(model) {\n\t\t\t\tvar _this = this;\n\t\n\t\t\t\tvar parent = arguments.length <= 1 || arguments[1] === undefined ? this.currentRoot : arguments[1];\n\t\n\t\t\t\tvar nodes = model.nodes;\n\t\t\t\tvar edges = model.edges;\n\t\t\t\tdelete model.nodes;\n\t\t\t\tdelete model.edges;\n\t\n\t\t\t\tvar node = this.addNode(model, parent);\n\t\t\t\tif (nodes) {\n\t\t\t\t\t_lodash2.default.forEach(nodes, function (child) {\n\t\t\t\t\t\t_this.loadModel(child, node);\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\tif (edges) {\n\t\t\t\t\t_lodash2.default.forEach(edges, function (edge) {\n\t\t\t\t\t\tvar from = void 0,\n\t\t\t\t\t\t    to = void 0;\n\t\t\t\t\t\tif (edge.from) from = _this.nodes[edge.from];\n\t\t\t\t\t\tif (edge.to) to = _this.nodes[edge.to];\n\t\t\t\t\t\t_this.addEdge(edge, node, from, to);\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"reset\",\n\t\t\tvalue: function reset() {}\n\t\t}, {\n\t\t\tkey: \"destroy\",\n\t\t\tvalue: function destroy() {}\n\t\t}, {\n\t\t\tkey: \"currentRoot\",\n\t\t\tget: function get() {\n\t\t\t\treturn this.root;\n\t\t\t}\n\t\t}], [{\n\t\t\tkey: \"getJSClass\",\n\t\t\tvalue: function getJSClass(config, defaultClass) {\n\t\t\t\tvar jsClass = null;\n\t\t\t\tif (config && config.type) {\n\t\t\t\t\t// See if we can get the js class from config.\n\t\t\t\t\tvar type = _Utils2.default.type(defaultClass.namespace, config.type);\n\t\t\t\t\tif (type) jsClass = type.jsClass;\n\t\t\t\t}\n\t\n\t\t\t\treturn _Utils2.default.getConstructor(jsClass, defaultClass);\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"addChild\",\n\t\t\tvalue: function addChild(parent, child) {\n\t\t\t\tif (!parent.children) parent.children = [];\n\t\n\t\t\t\tif (child.parent != parent) {\n\t\t\t\t\tparent.children.push(child);\n\t\n\t\t\t\t\tif (child.parent && child.parent.children) child.parent.children = _lodash2.default.without(child.parent.children, child);\n\t\t\t\t}\n\t\t\t\tchild.parent = parent;\n\t\t\t}\n\t\t}]);\n\t\n\t\treturn Graph;\n\t}();\n\t\n\tGraph.DEFAULTS = {\n\t\tallowDanglingEdges: true,\n\t\tmultiConnect: false,\n\t\treadOnly: false,\n\t\tviewOnly: false\n\t};\n\t\n\texports.default = Graph;\n\n/***/ },\n/* 16 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t\tvalue: true\n\t});\n\t\n\tvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol ? \"symbol\" : typeof obj; };\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tvar _lodash = __webpack_require__(5);\n\t\n\tvar _lodash2 = _interopRequireDefault(_lodash);\n\t\n\tvar _StringBuffer = __webpack_require__(8);\n\t\n\tvar _StringBuffer2 = _interopRequireDefault(_StringBuffer);\n\t\n\tvar _Cell2 = __webpack_require__(17);\n\t\n\tvar _Cell3 = _interopRequireDefault(_Cell2);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\t\n\tfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\t\n\tvar Node = function (_Cell) {\n\t\t_inherits(Node, _Cell);\n\t\n\t\tfunction Node(graph) {\n\t\t\tvar config = arguments.length <= 1 || arguments[1] === undefined ? {} : arguments[1];\n\t\n\t\t\t_classCallCheck(this, Node);\n\t\n\t\t\tif (!config.id) config.id = _lodash2.default.uniqueId('N');\n\t\n\t\t\tvar _this = _possibleConstructorReturn(this, Object.getPrototypeOf(Node).call(this, graph, config));\n\t\n\t\t\t_this.inEdges = [];\n\t\t\t_this.outEdges = [];\n\t\t\t_this.ports = null;\n\t\t\t_this.parent = null;\n\t\t\treturn _this;\n\t\t}\n\t\n\t\t_createClass(Node, [{\n\t\t\tkey: \"isAncestor\",\n\t\t\tvalue: function isAncestor(n) {\n\t\t\t\t// TODO: should we move this to graph class ?\n\t\t\t\tvar node = n.parent;\n\t\t\t\twhile (node) {\n\t\t\t\t\tif (this == node) {\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t}\n\t\t\t\t\tnode = node.parent;\n\t\t\t\t}\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"removeEdge\",\n\t\t\tvalue: function removeEdge(edge) {\n\t\t\t\tvar edges = edge.source == this ? this.outEdges : this.inEdges;\n\t\t\t\tfor (var i = 0; i < edges.length; i++) {\n\t\t\t\t\tif (edge == edges[i]) {\n\t\t\t\t\t\tedges.splice(i, 1);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\n\t\t\t// Add a new incoming edge\n\t\n\t\t}, {\n\t\t\tkey: \"addInEdge\",\n\t\t\tvalue: function addInEdge(edge, pos) {\n\t\t\t\tif (pos == null || pos === undefined) this.inEdges.push(edge);else this.inEdges.splice(pos, 0, edge);\n\t\t\t}\n\t\n\t\t\t// Add a new outgoing edge\n\t\n\t\t}, {\n\t\t\tkey: \"addOutEdge\",\n\t\t\tvalue: function addOutEdge(edge, pos) {\n\t\t\t\tif (pos == null || pos === undefined || pos > edge.length - 1) this.outEdges.push(edge);else this.outEdges.splice(pos, 0, edge);\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"renderChildren\",\n\t\t\tvalue: function renderChildren(view) {\n\t\t\t\tvar _this2 = this;\n\t\n\t\t\t\tif (this.children) {\n\t\t\t\t\tvar _ret = function () {\n\t\t\t\t\t\tvar buf = new _StringBuffer2.default();\n\t\t\t\t\t\t_lodash2.default.forEach(_this2.children, function (child) {\n\t\t\t\t\t\t\tbuf.append(child.render(view));\n\t\t\t\t\t\t});\n\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\tv: buf.toString()\n\t\t\t\t\t\t};\n\t\t\t\t\t}();\n\t\n\t\t\t\t\tif ((typeof _ret === \"undefined\" ? \"undefined\" : _typeof(_ret)) === \"object\") return _ret.v;\n\t\t\t\t}\n\t\t\t\treturn '';\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"getPort\",\n\t\t\tvalue: function getPort(key) {\n\t\t\t\tvar portName = arguments.length <= 1 || arguments[1] === undefined ? 'auto' : arguments[1];\n\t\t\t\tvar endPt = arguments[2];\n\t\t\t\tvar orthogonal = arguments[3];\n\t\n\t\t\t\tvar shape = this.getShape(key);\n\t\t\t\tif (portName == 'auto') {\n\t\t\t\t\treturn shape.getPerimeter(endPt, orthogonal);\n\t\t\t\t}\n\t\t\t\treturn null;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"toString\",\n\t\t\tvalue: function toString() {\n\t\t\t\tvar label = this.prop(\"label\") ? this.prop(\"label\") : \"undefined\";\n\t\t\t\tif (_lodash2.default.isArray(label)) label = label[0];\n\t\t\t\treturn 'Node:{id:' + this.id + ';label:' + label + ';type:' + this.props.constructor.typeName + '}';\n\t\t\t}\n\t\t}]);\n\t\n\t\treturn Node;\n\t}(_Cell3.default);\n\t\n\tNode.namespace = \"Nodes\";\n\t\n\texports.default = Node;\n\t\n\t/*\n\n\t/**\n\t * The DrillDownParent is the parent that displays the vertex when drilled down.\n\t *\n\tVertex.prototype.getDrillDownParent = function() {\n\t\treturn this.parent;\n\t};\n\n\tVertex.prototype.isLocked = function() {\n\t\tvar mode = this.getProperty(\"mode\") || 3;\n\t\treturn !(mode & Graph.ALLOW_INTERACTIONS);\n\t};\n\n\tVertex.prototype.getCrumbText = function() {\n\t\tif (this.isLocked())\n\t\t\treturn '<span><img src=\"webwb/pzreadonly.png\" /></span><span>&nbsp;' + this.getProperty(\"label\") + '</span>';\n\t\treturn this.getProperty(\"label\");\n\t};\n\n\tVertex.prototype.canEdit = function() {\n\t\treturn (!this.parent || !this.parent.isLocked()) && Vertex.superclass.canEdit.call(this);\n\t};\n\n\tVertex.prototype.isContainer = function() {\n\t\treturn this.getProperty(\"container\");\n\t};\n\n\t*/\n\n/***/ },\n/* 17 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t\tvalue: true\n\t});\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tvar _lodash = __webpack_require__(5);\n\t\n\tvar _lodash2 = _interopRequireDefault(_lodash);\n\t\n\tvar _Utils = __webpack_require__(2);\n\t\n\tvar _Utils2 = _interopRequireDefault(_Utils);\n\t\n\tvar _Cache = __webpack_require__(18);\n\t\n\tvar _Cache2 = _interopRequireDefault(_Cache);\n\t\n\tvar _StringBuffer = __webpack_require__(8);\n\t\n\tvar _StringBuffer2 = _interopRequireDefault(_StringBuffer);\n\t\n\tvar _Shape = __webpack_require__(6);\n\t\n\tvar _Shape2 = _interopRequireDefault(_Shape);\n\t\n\tvar _Rectangle = __webpack_require__(4);\n\t\n\tvar _Rectangle2 = _interopRequireDefault(_Rectangle);\n\t\n\tvar _Label = __webpack_require__(19);\n\t\n\tvar _Label2 = _interopRequireDefault(_Label);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\t/**\n\t * The Cell is the common parent for Node and Edge.\n\t */\n\t\n\tvar Cell = function () {\n\t\tfunction Cell(graph) {\n\t\t\tvar config = arguments.length <= 1 || arguments[1] === undefined ? { id: _lodash2.default.uniqueId() } : arguments[1];\n\t\n\t\t\t_classCallCheck(this, Cell);\n\t\n\t\t\tthis.graph = graph;\n\t\t\tthis.id = config.id;\n\t\t\tdelete config.id;\n\t\n\t\t\t// Initialize decorators\n\t\t\tif (config.decorators) {\n\t\t\t\tthis.createDecorators(config.decorators);\n\t\t\t\tdelete config.decorators;\n\t\t\t}\n\t\n\t\t\t// Initialize View Properties\n\t\t\tif (config.views) {\n\t\t\t\tthis.viewProps = config.views;\n\t\t\t\tdelete config.views;\n\t\t\t}\n\t\n\t\t\t// Initialize type\n\t\t\tvar type = config.type || \"Default\";\n\t\t\ttype = _Utils2.default.type(this.constructor.namespace, type);\n\t\t\tif (!type) throw new Error(\"Type not found \" + config.type);\n\t\t\tdelete config.type;\n\t\t\tthis.props = new type(config);\n\t\t}\n\t\n\t\t_createClass(Cell, [{\n\t\t\tkey: \"prop\",\n\t\t\tvalue: function prop(name, value) {\n\t\t\t\tif (_lodash2.default.isUndefined(value)) return this.props[name];\n\t\t\t\tthis.props[name] = value;\n\t\t\t}\n\t\n\t\t\t/**\n\t   * Get/Set property stored by views.\n\t   * @param key\n\t   * @param name\n\t   * @param value\n\t   * @returns {*}\n\t   */\n\t\n\t\t}, {\n\t\t\tkey: \"viewProp\",\n\t\t\tvalue: function viewProp() {\n\t\t\t\tvar key = arguments.length <= 0 || arguments[0] === undefined ? 'default' : arguments[0];\n\t\t\t\tvar name = arguments[1];\n\t\t\t\tvar value = arguments[2];\n\t\n\t\t\t\tif (_lodash2.default.isUndefined(value)) {\n\t\t\t\t\tif (key == 'default') return this.prop(name, value);\n\t\t\t\t\treturn this.viewProps[key][name];\n\t\t\t\t}\n\t\t\t\tif (key == 'default') {\n\t\t\t\t\tthis.prop(name, value);\n\t\t\t\t} else {\n\t\t\t\t\tif (!this.viewProps[key]) this.viewProps[key] = {};\n\t\t\t\t\tthis.viewProps[key][name] = value;\n\t\t\t\t}\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"createDecorators\",\n\t\t\tvalue: function createDecorators(decorators) {}\n\t\n\t\t\t/**\n\t   * Get properties needed for rendering this element\n\t   * @returns {{key: (string|*), className: *, namespace: *, bounds: *}}\n\t   */\n\t\n\t\t}, {\n\t\t\tkey: \"getView\",\n\t\t\tvalue: function getView(key) {\n\t\t\t\tvar shape = this.getShape(key);\n\t\t\t\treturn _lodash2.default.assign({\n\t\t\t\t\tid: this.id,\n\t\t\t\t\tkey: key,\n\t\t\t\t\tclassName: this.computedClassName,\n\t\t\t\t\tstyle: this.viewProp(key, 'style'),\n\t\t\t\t\tnamespace: this.namespace\n\t\t\t\t}, shape);\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"getShape\",\n\t\t\tvalue: function getShape(key) {\n\t\t\t\tvar shape = _Cache2.default.get(this.id + \".shape\", key);\n\t\t\t\tif (shape) return shape;\n\t\n\t\t\t\tvar shapeConfig = this.viewProp(key, 'shape');\n\t\t\t\tvar shapeClass = shapeConfig ? _Shape2.default.getShape(shapeConfig.name) : _Shape2.default.getShape('Rectangle');\n\t\t\t\tvar x = this.viewProp(key, \"x\");\n\t\t\t\tvar y = this.viewProp(key, \"y\");\n\t\t\t\tvar width = this.viewProp(key, \"width\");\n\t\t\t\tvar height = this.viewProp(key, \"height\");\n\t\t\t\tshape = new shapeClass(x, y, width, height, shapeConfig);\n\t\t\t\t_Cache2.default.set(this.id + '.shape', shape, key);\n\t\t\t\treturn shape;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"render\",\n\t\t\tvalue: function render(view) {\n\t\t\t\tvar template = _Cache2.default.get(this.id + '.template', view.id);\n\t\t\t\tif (!template) {\n\t\t\t\t\t//create the template\n\t\t\t\t\tvar role = this.prop('role');\n\t\t\t\t\ttemplate = view.getTemplate('$' + role, null, this);\n\t\t\t\t\tif (_lodash2.default.isString(template)) template = _lodash2.default.template(template);\n\t\t\t\t\t_Cache2.default.set(this.id + '.template', template, view.id);\n\t\t\t\t}\n\t\t\t\treturn template(this.getView(view.id));\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"renderShape\",\n\t\t\tvalue: function renderShape(view) {\n\t\t\t\tvar shape = this.getShape(view.id);\n\t\t\t\tif (shape) return shape.render(view);\n\t\t\t\treturn '';\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"renderLabel\",\n\t\t\tvalue: function renderLabel(view) {\n\t\t\t\tif (this == this.graph.currentRoot) return null;\n\t\t\t\tvar box = this.getLabelBox(view.id);\n\t\t\t\tif (box) return view.renderLabel(box);\n\t\t\t\treturn '';\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"getLabelBox\",\n\t\t\tvalue: function getLabelBox(key) {\n\t\t\t\tvar box = _Cache2.default.get(this.id + '.labelBox', key);\n\t\t\t\tif (box) return box;\n\t\t\t\tvar shape = this.getShape(key);\n\t\t\t\t// Just get the config will have a positive performance boost for IE11 and IE10.\n\t\t\t\tbox = _Label2.default.getLabelBox(this.prop('label'), this.viewProp(key, 'labelConfig'), shape.width, shape.height);\n\t\t\t\t_Cache2.default.set(this.id + '.labelBox', box, key);\n\t\t\t\treturn box;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"destroy\",\n\t\t\tvalue: function destroy() {\n\t\t\t\tdelete this.graph;\n\t\t\t\tdelete this.decorators;\n\t\t\t\tdelete this.props;\n\t\t\t\tdelete this.viewProps;\n\t\t\t\tthis.destroyed = true;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"computedClassName\",\n\t\t\tget: function get() {\n\t\t\t\tif (!this._computedClassName) {\n\t\t\t\t\tvar buf = new _StringBuffer2.default(this.prop(\"role\"));\n\t\t\t\t\tvar props = this.props;\n\t\t\t\t\tif (props.hasOwnProperty(\"className\")) buf.append(props[\"className\"]);\n\t\t\t\t\tprops = props.constructor.prototype;\n\t\t\t\t\twhile (props) {\n\t\t\t\t\t\tif (props.hasOwnProperty(\"className\")) buf.append(props[\"className\"]);\n\t\t\t\t\t\tprops = Object.getPrototypeOf(props);\n\t\t\t\t\t}\n\t\t\t\t\tthis._computedClassName = buf.toString(' ');\n\t\t\t\t}\n\t\t\t\treturn this._computedClassName;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"namespace\",\n\t\t\tget: function get() {\n\t\t\t\tif (this == this.graph.currentRoot) return '';\n\t\t\t\treturn \"root.\" + this.prop(\"role\");\n\t\t\t}\n\t\t}]);\n\t\n\t\treturn Cell;\n\t}();\n\t\n\t/*\n\t\n\tCell.prototype.move = function(x, y) {\n\t\tthis.setProperty(\"x\", Math.round(x));\n\t\tthis.setProperty(\"y\", Math.round(y));\n\t\tdelete this.bounds;\n\t};\n\t\n\tCell.prototype.resize = function(w, h) {\n\t\tthis.setProperty(\"width\", w);\n\t\tthis.setProperty(\"height\", h);\n\t\tdelete this.bounds;\n\t};\n\t\n\tCell.prototype.canEdit = function() {\n\t\treturn (this.graph ? this.graph.canEdit() : true) && this.getProperty(\"editable\");\n\t};\n\t\n\tCell.prototype.canSelect = function() {\n\t\treturn (this.graph ? this.graph.canSelect() : true) && this.getProperty(\"selectable\");\n\t};\n\t\n\tCell.prototype.canMove = function() {\n\t\treturn (this.graph ? this.graph.canEdit() : true) && this.getProperty(\"draggable\");\n\t};\n\t\n\tCell.prototype.canResize = function() {\n\t\treturn (this.graph ? this.graph.canEdit() : true) && this.getProperty(\"resizable\");\n\t};\n\t\n\tCell.prototype.getTypeFromString = function(typeStr) {\n\t\treturn this.graph.getType(typeStr);\n\t};\n\t\n\tCell.prototype.createModifiers = function(modifiers) {\n\t\tthis.modifiers = null;\n\t\tvar modifierSettings = this.getProperty(\"modifierSettings\");\n\t\tif (modifierSettings) {\n\t\t\t_.each(modifiers, function(config) {\n\t\t\t\tconfig.type = this.graph.getModifierType(config.className);\n\t\t\t\tconfig.setting = modifierSettings[config.className];\n\t\t\t\tif (!config.type || !config.setting) return;\n\t\n\t\t\t\tthis.addModifier(config.className, new Modifier(this, config));\n\t\t\t}, this);\n\t\n\t\t\t// Check for showAlways settings\n\t\t\t_.each(modifierSettings, function(setting, name) {\n\t\t\t\tif (setting.showAlways && (!this.modifiers || !this.modifiers[name])) {\n\t\t\t\t\tvar config = {type: this.graph.getModifierType(name), setting: setting};\n\t\t\t\t\tif (!config.type) return;\n\t\t\t\t\tthis.addModifier(name, new Modifier(this, config));\n\t\t\t\t}\n\t\t\t}, this);\n\t\t}\n\t};\n\t\n\tCell.prototype.addModifier = function(name, modifier) {\n\t\tif (!this.modifiers)\n\t\t\tthis.modifiers = {};\n\t\n\t\tif (!modifier.hasOwnProperty(\"showHeader\"))\n\t\t\tmodifier.showHeader = true;\n\t\n\t\t// @hack preferably set it in configurations.\n\t\tif (modifier.name == \"HoverProcessModifier\" || modifier.name == \"HoverResults\")\n\t\t\tmodifier.showHeader = false;\n\t\n\t\tthis.modifiers[name] = modifier;\n\t};\n\t\n\tCell.prototype.getModifiers = function() {\n\t\tif (_.isUndefined(this.modifiers))\n\t\t\tthis.createModifiers();\n\t\treturn this.modifiers;\n\t};\n\t\n\tCell.prototype.getModifier = function(name) {\n\t\tvar modifiers = this.getModifiers();\n\t\tif (modifiers)\n\t\t\treturn modifiers[name];\n\t\treturn null;\n\t};\n\t\n\tCell.prototype.isVisible = function() {\n\t\treturn this.getProperty('visible');\n\t};\n\t\n\tCell.prototype.isContainer = function() {\n\t\treturn false;\n\t};\n\t*/\n\t\n\t\n\texports.default = Cell;\n\n/***/ },\n/* 18 */\n/***/ function(module, exports) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t\tvalue: true\n\t});\n\t/**\n\t * Created by tong on 6/7/2016.\n\t */\n\t\n\tvar caches = {};\n\t\n\tvar Cache = {\n\t\tget: function get(key, namespace) {\n\t\t\treturn this.getCache(namespace)[key];\n\t\t},\n\t\n\t\tset: function set(key, value, namespace) {\n\t\t\tthis.getCache(namespace)[key] = value;\n\t\t},\n\t\n\t\tcontains: function contains(key, namespace) {\n\t\t\treturn key in this.getCache(namespace);\n\t\t},\n\t\n\t\tremove: function remove(key, namespace) {\n\t\t\tdelete this.getCache(namespace)[key];\n\t\t},\n\t\n\t\tclear: function clear(namesapce) {\n\t\t\tif (!namespace) caches = {};else if (caches[namespace]) caches[namespace] = {};\n\t\t},\n\t\n\t\tgetCache: function getCache() {\n\t\t\tvar namespace = arguments.length <= 0 || arguments[0] === undefined ? 'default' : arguments[0];\n\t\n\t\t\tif (!caches[namespace]) caches[namespace] = {};\n\t\t\treturn caches[namespace];\n\t\t}\n\t};\n\t\n\texports.default = Cache;\n\n/***/ },\n/* 19 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t\tvalue: true\n\t});\n\t\n\tvar _lodash = __webpack_require__(5);\n\t\n\tvar _lodash2 = _interopRequireDefault(_lodash);\n\t\n\tvar _bean = __webpack_require__(12);\n\t\n\tvar _bean2 = _interopRequireDefault(_bean);\n\t\n\tvar _Utils = __webpack_require__(2);\n\t\n\tvar _Utils2 = _interopRequireDefault(_Utils);\n\t\n\tvar _DomUtils = __webpack_require__(7);\n\t\n\tvar _DomUtils2 = _interopRequireDefault(_DomUtils);\n\t\n\tvar _StringBuffer = __webpack_require__(8);\n\t\n\tvar _StringBuffer2 = _interopRequireDefault(_StringBuffer);\n\t\n\tvar _Rectangle = __webpack_require__(4);\n\t\n\tvar _Rectangle2 = _interopRequireDefault(_Rectangle);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tvar FONT_BOLD = 1,\n\t    FONT_ITALIC = 2,\n\t    FONT_UNDERLINE = 4,\n\t    FONT_SHADOW = 8;\n\t\n\tvar defaultConfig = {\n\t\tfontSize: 11,\n\t\tfontFamily: \"Arial\",\n\t\tfontStyle: 0,\n\t\tfontColor: 'black',\n\t\tpadding: 0,\n\t\tlinePadding: 0,\n\t\talign: \"left\",\n\t\twidth: 0,\n\t\theight: 0,\n\t\trotation: null,\n\t\tgeometry: { x: 0, y: 0, anchorY: 0, offsetX: 0, offsetY: 0 }\n\t};\n\t\n\t/**\n\t * The label object handles label sizing/positioning\n\t */\n\t\n\texports.default = function () {\n\t\tvar stringMeasureEl = null,\n\t\t    measureDiv = void 0,\n\t\t    baselineDiv = void 0;\n\t\n\t\t/**\n\t  * Calculate the size of the string.\n\t  */\n\t\tvar getStringSize = _lodash2.default.memoize(function (str, fontSize, fontFamily, bold) {\n\t\t\tfontSize = fontSize || 11;\n\t\t\tfontFamily = fontFamily || 'Arial,Helvetica';\n\t\t\tbold = !_lodash2.default.isUndefined(bold) ? bold : false;\n\t\n\t\t\t// first check if there is a string-measuring div available, if not, create now.\n\t\t\tif (!stringMeasureEl) {\n\t\t\t\tstringMeasureEl = _DomUtils2.default.createElement('iframe', { id: \"_ComputeStylesIframe\" }, { position: \"absolute\", visibility: \"hidden\", width: \"auto\" });\n\t\t\t\tdocument.body.appendChild(stringMeasureEl);\n\t\t\t\tvar doc = stringMeasureEl.contentWindow.document;\n\t\t\t\tdoc.open();\n\t\t\t\tdoc.write('<html><body>\\\n\t\t\t\t\t<div id=\"baselineDiv\" style=\"height:100px;\"><span style=\"line-height:0\">T</span><span style=\"height:100%;display:inline-block;\"></span></div>\\\n\t\t\t\t\t<div id=\"measureDiv\" style=\"position:absolute;width:auto;height:auto;padding:0;white-space:pre-wrap;word-wrap:break-word;display:inline-block;\"></div>\\\n\t\t\t\t\t</body></html>');\n\t\t\t\tdoc.close();\n\t\t\t\tmeasureDiv = doc.getElementById(\"measureDiv\");\n\t\t\t\tbaselineDiv = doc.getElementById(\"baselineDiv\");\n\t\t\t}\n\t\t\tbaselineDiv.style.fontSize = measureDiv.style.fontSize = fontSize;\n\t\t\tbaselineDiv.style.fontFamily = measureDiv.style.fontFamily = fontFamily;\n\t\t\tbaselineDiv.style.fontWeight = measureDiv.style.fontWeight = bold ? 'bold' : 'normal';\n\t\t\tmeasureDiv.innerHTML = str;\n\t\n\t\t\tvar strut = baselineDiv.firstChild;\n\t\t\tvar baselineHeight = strut.offsetTop + strut.offsetHeight - baselineDiv.offsetHeight - baselineDiv.offsetTop;\n\t\n\t\t\treturn { width: measureDiv.offsetWidth, height: measureDiv.offsetHeight, baseline: baselineHeight };\n\t\t}, function (str, fontSize, fontFamily, bold) {\n\t\t\treturn str + ';' + fontSize + ';' + fontFamily + ';' + bold;\n\t\t});\n\t\n\t\t/**\n\t  * Create a wrapped text.\n\t  * @param {String} string the string to wrap.\n\t  * @param {maxWidth} the maximum width this string can take.\n\t  * @param {fontSize}\n\t  * @param {fontFamily}\n\t  * @param {bold}\n\t  */\n\t\tvar wrap = _lodash2.default.memoize(function (string, maxWidth, fontSize, fontFamily, bold) {\n\t\t\tmaxWidth = maxWidth || 0;\n\t\t\tfontSize = fontSize || 11;\n\t\t\tfontFamily = fontFamily || 'Arial,Helvetica';\n\t\t\tbold = !_lodash2.default.isUndefined(bold) ? bold : false;\n\t\n\t\t\tvar arr = [];\n\t\t\tvar spaceSize = getStringSize(\"&nbsp;\", fontSize, fontFamily, bold),\n\t\t\t    space = spaceSize.width;\n\t\t\tarr.lineHeight = spaceSize.height;\n\t\t\tarr.baseline = spaceSize.baseline;\n\t\n\t\t\tif (!maxWidth || !string || string == \"\") {\n\t\t\t\tarr.push(string);\n\t\t\t\tarr.width = !string || string == \"\" ? space : getStringSize(string, fontSize, fontFamily, bold).width;\n\t\t\t\tarr.height = arr.lineHeight;\n\t\t\t\treturn arr;\n\t\t\t}\n\t\n\t\t\tvar width = 0;\n\t\t\t//split the text by lines\n\t\t\tvar lines = string.split('\\n');\n\t\n\t\t\tvar buf = new _StringBuffer2.default();\n\t\n\t\t\tfor (var j = 0; j < lines.length; j++) {\n\t\t\t\t//split each line by word\n\t\t\t\tvar words = lines[j].split(/\\s/);\n\t\t\t\tvar line = \"\",\n\t\t\t\t    currentWidth = 0,\n\t\t\t\t    wordWidth = 0,\n\t\t\t\t    newLine = true,\n\t\t\t\t    word;\n\t\n\t\t\t\tfor (var i = 0; i < words.length; i++) {\n\t\t\t\t\tword = words[i];\n\t\t\t\t\twordWidth = getStringSize(word, fontSize, fontFamily, bold).width;\n\t\n\t\t\t\t\tif ((newLine ? wordWidth : currentWidth + space + wordWidth) > maxWidth) {\n\t\t\t\t\t\tif (newLine) {\n\t\t\t\t\t\t\tbuf.append(word);\n\t\t\t\t\t\t\twidth = Math.max(width, wordWidth);\n\t\t\t\t\t\t\tif (i < words.length - 1) {\n\t\t\t\t\t\t\t\tarr.push(buf.toString());\n\t\t\t\t\t\t\t\tbuf.clear();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tarr.push(buf.append(line).toString());\n\t\t\t\t\t\t\twidth = Math.max(width, currentWidth + space + wordWidth);\n\t\t\t\t\t\t\tbuf.clear();\n\t\t\t\t\t\t}\n\t\t\t\t\t\tline = \"\";\n\t\t\t\t\t\tcurrentWidth = 0;\n\t\t\t\t\t\tif (!newLine) i--; // move back one word.\n\t\t\t\t\t\tnewLine = true;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tline = newLine ? word : line + \" \" + word;\n\t\t\t\t\t\tcurrentWidth = newLine ? wordWidth : currentWidth + space + wordWidth;\n\t\t\t\t\t\twidth = Math.max(width, currentWidth);\n\t\t\t\t\t\tnewLine = false;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (line != \"\") buf.append(line);\n\t\t\t\tif (j < lines.length - 1) {\n\t\t\t\t\tarr.push(buf.toString());\n\t\t\t\t\tbuf.clear();\n\t\t\t\t}\n\t\t\t}\n\t\n\t\t\tarr.push(buf.toString());\n\t\t\tarr.width = width;\n\t\t\tarr.height = arr.lineHeight * arr.length;\n\t\t\treturn arr;\n\t\t}, function (str, maxWidth, fontSize, fontFamily, bold) {\n\t\t\treturn str + ';' + maxWidth + ';' + fontSize + ';' + fontFamily + ';' + bold;\n\t\t});\n\t\n\t\t/**\n\t  *  Get the view information for how to display the label.\n\t  * @param label The string that needs to be displayed\n\t  * @param containerWidth The width of the parent container.\n\t  * @param containerHeight The height of the parent container.\n\t  * @param labelConfig The configuration on how to display label. It should be an object with the following parameters:\n\t  * {\n\t  *      fontSize, fontFamily, fontStyle, padding,\n\t  *      align: can be either \"left\", \"center\" or \"right\",\n\t  *      width: the maximum width of the label. if less than 1, then is treated as percentage. If 0, no wrapping will occur,\n\t  *      height,\n\t  *      geometry\n\t  * }\n\t  * @returns {*}\n\t  */\n\t\tfunction getLabelBox(label, labelConfig, containerWidth, containerHeight) {\n\t\t\treturn _getLabelBox.call(this, label, labelConfig, { width: containerWidth, height: containerHeight });\n\t\t}\n\t\n\t\tfunction getLabelBoxForLink(label, labelConfig, link) {\n\t\t\treturn _getLabelBox.call(this, label, labelConfig, link);\n\t\t}\n\t\n\t\tfunction _getLabelBox(label) {\n\t\t\tvar labelConfig = arguments.length <= 1 || arguments[1] === undefined ? {} : arguments[1];\n\t\t\tvar context = arguments[2];\n\t\n\t\t\tlabelConfig = _lodash2.default.defaultsDeep(labelConfig, defaultConfig);\n\t\t\tvar fontSize = labelConfig.fontSize;\n\t\t\tvar fontFamily = labelConfig.fontFamily;\n\t\t\tvar fontStyle = labelConfig.fontStyle;\n\t\t\tvar bold = (fontStyle & FONT_BOLD) == FONT_BOLD;\n\t\t\tvar padding = labelConfig.padding;\n\t\t\tvar linePadding = labelConfig.linePadding;\n\t\t\tvar align = labelConfig.align;\n\t\n\t\t\tvar w = labelConfig.width,\n\t\t\t    h = labelConfig.height;\n\t\t\tif (context.width) {\n\t\t\t\tw = w <= 5 ? context.width * w : w;\n\t\t\t\th = h <= 5 ? context.height * h : h;\n\t\t\t}\n\t\t\tw -= 2 * padding;\n\t\t\th -= 2 * padding;\n\t\t\tw = Math.max(0, w);\n\t\t\th = Math.max(0, h);\n\t\n\t\t\tvar geometry = _lodash2.default.clone(labelConfig.geometry);\n\t\t\tvar wrappedLabel = this.wrap(label, w, fontSize, fontFamily, bold);\n\t\t\tgeometry.width = wrappedLabel.width + 2 * padding;\n\t\t\tgeometry.height = wrappedLabel.height + 2 * padding + (wrappedLabel.length - 1) * linePadding;\n\t\t\tvar anchor = \"start\",\n\t\t\t    dx = 0,\n\t\t\t    setAnchorX = !_lodash2.default.has(geometry, \"anchorX\");\n\t\t\tswitch (align) {\n\t\t\t\tcase \"center\":\n\t\t\t\t\tanchor = \"middle\";\n\t\t\t\t\tif (setAnchorX) geometry.anchorX = 0;\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"right\":\n\t\t\t\t\tanchor = \"end\";\n\t\t\t\t\tdx = wrappedLabel.width / 2;\n\t\t\t\t\tif (setAnchorX) geometry.anchorX = -0.5;\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"left\":\n\t\t\t\t\tdx = -wrappedLabel.width / 2;\n\t\t\t\t\tif (setAnchorX) geometry.anchorX = 0.5;\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t\tvar pos = void 0;\n\t\t\tif (context.getRelativePosition) pos = context.getRelativePosition(geometry);else pos = _Utils2.default.getRelativePosition({ width: context.width, height: context.height }, geometry);\n\t\n\t\t\tvar bounds = new _Rectangle2.default(pos[0], pos[1], geometry.width, geometry.height);\n\t\t\t// the pivot is the center of rotation when the label has a rotation specified.\n\t\t\tvar pivot = align == 'center' ? [0, 0] : align == 'left' ? [-wrappedLabel.width / 2, 0] : [wrappedLabel.width / 2, 0];\n\t\n\t\t\t// the maximum bounds for the label, used to position inline editor\n\t\t\tgeometry.width = Math.max(w + 2 * padding, geometry.width);\n\t\t\tgeometry.height = Math.max(h + 2 * padding, geometry.height);\n\t\n\t\t\tif (context.getRelativePosition) pos = context.getRelativePosition(geometry);else pos = _Utils2.default.getRelativePosition({ width: context.width, height: context.height }, geometry);\n\t\n\t\t\tvar maxBounds = new _Rectangle2.default(pos[0], pos[1], geometry.width, geometry.height);\n\t\t\treturn {\n\t\t\t\tconfig: labelConfig, label: wrappedLabel, _label: label,\n\t\t\t\tbold: bold, underline: fontStyle & FONT_UNDERLINE, italic: fontStyle & FONT_ITALIC, shadow: fontStyle & FONT_SHADOW,\n\t\t\t\tdx: dx, dy: -geometry.height / 2 + padding + wrappedLabel.lineHeight - wrappedLabel.baseline, anchor: anchor, lineHeight: wrappedLabel.lineHeight + linePadding,\n\t\t\t\tpivot: pivot, bounds: bounds, maxBounds: maxBounds\n\t\t\t};\n\t\t}\n\t\n\t\tfunction render(view, box) {\n\t\t\treturn view.renderLabel(box);\n\t\t}\n\t\n\t\tvar editor = {\n\t\t\tstart: function start(key, container, box, refEl, textEl) {\n\t\t\t\tvar _this = this;\n\t\n\t\t\t\tvar scale = arguments.length <= 5 || arguments[5] === undefined ? 1.0 : arguments[5];\n\t\t\t\tvar singleLine = arguments.length <= 6 || arguments[6] === undefined ? true : arguments[6];\n\t\n\t\t\t\tif (this.input) {\n\t\t\t\t\tif (this.key != key) {\n\t\t\t\t\t\t// need to close the existing editor first\n\t\t\t\t\t\tthis.stop();\n\t\t\t\t\t} else return;\n\t\t\t\t}\n\t\t\t\tvar tag = singleLine ? 'input' : 'textarea';\n\t\t\t\tthis.input = _DomUtils2.default.createElement(tag, { id: \"inlineEditor\", unselectable: \"off\" }, { position: \"absolute\", overflow: \"hidden\", padding: \"0px\", margin: \"0px\", border: \"transparent\" });\n\t\t\t\tif (singleLine) {\n\t\t\t\t\t_bean2.default.on(this.input, 'keydown keyup', function (event) {\n\t\t\t\t\t\tif (event.keyCode == 13) {\n\t\t\t\t\t\t\t_bean2.default.off(_this.input, 'keydown keyup');\n\t\t\t\t\t\t\t_this.stop();\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\tcontainer.appendChild(this.input);\n\t\n\t\t\t\tthis.key = key;\n\t\t\t\tthis.box = box;\n\t\t\t\tthis.refEl = refEl;\n\t\t\t\tthis.textEl = textEl;\n\t\n\t\t\t\tvar labelConfig = box.config;\n\t\t\t\tvar maxBounds = new _Rectangle2.default(box.maxBounds.x, box.maxBounds.y, box.maxBounds.width * scale, box.maxBounds.height * scale);\n\t\t\t\tvar pos = _DomUtils2.default.getCenterPosition(refEl, container);\n\t\t\t\tpos = [pos[0] + maxBounds.left, pos[1] + maxBounds.top];\n\t\n\t\t\t\tif (textEl) textEl.style.visibility = 'hidden';\n\t\n\t\t\t\t_DomUtils2.default.setElement(this.input, null, {\n\t\t\t\t\tvisibility: 'visible',\n\t\t\t\t\tleft: pos[0] + \"px\",\n\t\t\t\t\ttop: pos[1] + \"px\",\n\t\t\t\t\twidth: maxBounds.width + 'px',\n\t\t\t\t\theight: maxBounds.height + 'px',\n\t\t\t\t\t\"font-family\": labelConfig.fontFamily,\n\t\t\t\t\t\"font-size\": labelConfig.fontSize * scale + 'px',\n\t\t\t\t\t\"font-weight\": (labelConfig.fontStyle & FONT_BOLD) == FONT_BOLD ? 'bold' : 'normal'\n\t\t\t\t\t/*\"color\": labelConfig.fontColor*/\n\t\t\t\t});\n\t\n\t\t\t\tthis.input.value = box._label;\n\t\t\t\tthis.input.focus();\n\t\t\t\tthis.input.select();\n\t\t\t\t_bean2.default.fire(this, 'editor.start', [this.key]);\n\t\t\t},\n\t\n\t\t\tstop: function stop(cancel) {\n\t\t\t\tif (!this.input) return;\n\t\n\t\t\t\tcancel = cancel || false;\n\t\t\t\tif (this.textEl) this.textEl.style.visibility = null;\n\t\n\t\t\t\tif (!cancel) _bean2.default.fire(this, 'editor.update', [this.key, this.input.value]);\n\t\n\t\t\t\t_bean2.default.fire(this, 'editor.stop', [this.key]);\n\t\n\t\t\t\t// remove the input\n\t\t\t\tthis.input.parentNode.removeChild(this.input);\n\t\t\t\tdelete this.input;\n\t\t\t\tdelete this.key;\n\t\t\t\tdelete this.box;\n\t\t\t\tdelete this.refEl;\n\t\t\t\tdelete this.textEl;\n\t\t\t}\n\t\t};\n\t\n\t\treturn {\n\t\t\tFONT_BOLD: FONT_BOLD,\n\t\t\tFONT_ITALIC: FONT_ITALIC,\n\t\t\tFONT_UNDERLINE: FONT_UNDERLINE,\n\t\t\tFONT_SHADOW: FONT_SHADOW,\n\t\t\tgetStringSize: getStringSize,\n\t\t\twrap: wrap,\n\t\t\tgetLabelBox: getLabelBox,\n\t\t\tgetLabelBoxForLink: getLabelBoxForLink,\n\t\t\trender: render,\n\t\t\teditor: editor\n\t\t};\n\t}();\n\n/***/ },\n/* 20 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t\tvalue: true\n\t});\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tvar _get = function get(object, property, receiver) { if (object === null) object = Function.prototype; var desc = Object.getOwnPropertyDescriptor(object, property); if (desc === undefined) { var parent = Object.getPrototypeOf(object); if (parent === null) { return undefined; } else { return get(parent, property, receiver); } } else if (\"value\" in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } };\n\t\n\tvar _lodash = __webpack_require__(5);\n\t\n\tvar _lodash2 = _interopRequireDefault(_lodash);\n\t\n\tvar _Cell2 = __webpack_require__(17);\n\t\n\tvar _Cell3 = _interopRequireDefault(_Cell2);\n\t\n\tvar _Rectangle = __webpack_require__(4);\n\t\n\tvar _Rectangle2 = _interopRequireDefault(_Rectangle);\n\t\n\tvar _Link = __webpack_require__(11);\n\t\n\tvar _Link2 = _interopRequireDefault(_Link);\n\t\n\tvar _Label = __webpack_require__(19);\n\t\n\tvar _Label2 = _interopRequireDefault(_Label);\n\t\n\tvar _Cache = __webpack_require__(18);\n\t\n\tvar _Cache2 = _interopRequireDefault(_Cache);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\t\n\tfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\t\n\tvar Edge = function (_Cell) {\n\t\t_inherits(Edge, _Cell);\n\t\n\t\tfunction Edge(graph) {\n\t\t\tvar config = arguments.length <= 1 || arguments[1] === undefined ? {} : arguments[1];\n\t\t\tvar source = arguments[2];\n\t\t\tvar target = arguments[3];\n\t\n\t\t\t_classCallCheck(this, Edge);\n\t\n\t\t\tif (!config.id) config.id = _lodash2.default.uniqueId('E');\n\t\n\t\t\tvar _this = _possibleConstructorReturn(this, Object.getPrototypeOf(Edge).call(this, graph, config));\n\t\n\t\t\t_this.source = _this.target = null;\n\t\t\t_this.setSource(source, config.sourcePos);\n\t\t\t_this.setTarget(target, config.targetPos);\n\t\t\treturn _this;\n\t\t}\n\t\n\t\t_createClass(Edge, [{\n\t\t\tkey: \"setSource\",\n\t\t\tvalue: function setSource(node, pos) {\n\t\t\t\tthis.setTerminal(node, pos, 'source');\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"setTarget\",\n\t\t\tvalue: function setTarget(node, pos) {\n\t\t\t\tthis.setTerminal(node, pos, 'target');\n\t\t\t}\n\t\n\t\t\t/**\n\t   * Internal methods to set either the source or target\n\t   */\n\t\n\t\t}, {\n\t\t\tkey: \"setTerminal\",\n\t\t\tvalue: function setTerminal(node, pos, dir) {\n\t\t\t\tvar end = dir == 'source' ? this.source : this.target;\n\t\t\t\tif (end == node) {\n\t\t\t\t\t// simply change the position of the edge.\n\t\t\t\t\tif (node) node.setEdgeAt(this, pos);\n\t\t\t\t} else {\n\t\t\t\t\tif (end) {\n\t\t\t\t\t\t// first remove the edge from the current end\n\t\t\t\t\t\tend.removeEdge(this);\n\t\t\t\t\t}\n\t\n\t\t\t\t\tif (node) {\n\t\t\t\t\t\tif (dir == 'source') node.addOutEdge(this, pos);else node.addInEdge(this, pos);\n\t\t\t\t\t}\n\t\t\t\t\tif (dir == 'source') this.source = node;else this.target = node;\n\t\t\t\t\t//this.clearPoints();\n\t\t\t\t}\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"getLabelBox\",\n\t\t\tvalue: function getLabelBox(key) {\n\t\t\t\tvar label = this.prop('label');\n\t\t\t\tif (label) return _Label2.default.getLabelBoxForLink(label, this.viewProp(key, 'labelConfig'), this.getShape(key));\n\t\t\t\treturn null;\n\t\t\t}\n\t\n\t\t\t/**\n\t   * Return a pair of points as reference to the calculation of start and end points.\n\t   */\n\t\n\t\t}, {\n\t\t\tkey: \"getReferencePoints\",\n\t\t\tvalue: function getReferencePoints(key) {\n\t\t\t\tvar pts = [];\n\t\t\t\tif (this.source) pts.push(this.source.getShape(key).center);else pts.push(this.viewProp(key, 'start'));\n\t\n\t\t\t\tif (this.target) pts.push(this.target.getShape(key).center);else pts.push(this.viewProp(key, 'end'));\n\t\n\t\t\t\treturn pts;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"getTerminalVisual\",\n\t\t\tvalue: function getTerminalVisual(key, orthogonal) {\n\t\t\t\tvar refPts = this.getReferencePoints(key);\n\t\t\t\tvar terminals = [];\n\t\n\t\t\t\tvar getBound = function getBound(pt) {\n\t\t\t\t\treturn new _Rectangle2.default(pt.x, pt.y, 3, 3);\n\t\t\t\t};\n\t\n\t\t\t\tif (this.source) {\n\t\t\t\t\tterminals.push(this.source.getPort(key, this.prop('sourcePort'), refPts[1], orthogonal));\n\t\t\t\t} else terminals.push({ point: refPts[0], direction: _Rectangle2.default.getDirection(getBound(refPts[0]), refPts[1], true) });\n\t\n\t\t\t\tif (this.target) {\n\t\t\t\t\tterminals.push(this.target.getPort(key, this.prop('targetPort'), refPts[0], orthogonal));\n\t\t\t\t} else terminals.push({ point: refPts[1], direction: _Rectangle2.default.getDirection(getBound(refPts[1]), refPts[0], true) });\n\t\t\t\treturn terminals;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"getShape\",\n\t\t\tvalue: function getShape(key) {\n\t\t\t\tvar shape = _Cache2.default.get(this.id + \".shape\", key);\n\t\t\t\tif (shape) return shape;\n\t\n\t\t\t\tvar config = this.viewProp(key, 'shape');\n\t\t\t\tshape = _Link2.default.getLink(this.getTerminalVisual(key, config.orthogonal), config, this.prop('startMarker'), this.prop('endMarker'));\n\t\t\t\t_Cache2.default.set(this.id + '.shape', shape, key);\n\t\t\t\treturn shape;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"toString\",\n\t\t\tvalue: function toString() {\n\t\t\t\treturn 'Edge:{' + (!this.source ? 'null' : this.source.id) + '--' + (!this.target ? 'null' : this.target.id) + '}';\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"destroy\",\n\t\t\tvalue: function destroy() {\n\t\t\t\t_get(Object.getPrototypeOf(Edge.prototype), \"destroy\", this).call(this);\n\t\t\t\tthis.setSource(null);\n\t\t\t\tthis.setTarget(null);\n\t\t\t}\n\t\t}]);\n\t\n\t\treturn Edge;\n\t}(_Cell3.default);\n\t\n\tEdge.namespace = \"Edges\";\n\t\n\texports.default = Edge;\n\t\n\t/*\n\n\tEdge.prototype.isVisible = function() {\n\t\tif (this.graph.getProperty(\"allowDanglingEdges\")) {\n\t\t\treturn (this.source ? this.source.isVisible() : true) && (this.target ? this.target.isVisible() : true) && this.getProperty(\"visible\");\n\t\t} else\n\t\t\treturn this.source && this.target && this.getProperty('visible') && this.source.isVisible() && this.target.isVisible();\n\t};\n\n\t*/\n\n/***/ },\n/* 21 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t\tvalue: true\n\t});\n\t\n\tvar _Rectangle = __webpack_require__(4);\n\t\n\tvar _Rectangle2 = _interopRequireDefault(_Rectangle);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tvar registry = {};\n\t\n\tvar Marker = function () {\n\t\n\t\t/** Begin Standard Marker Type **/\n\t\tfunction arrow(size, source, styles) {\n\t\t\tvar sign = source ? -1 : 1;\n\t\t\tvar marker = {\n\t\t\t\tviewBox: new _Rectangle2.default(-5, -5, 10, 10),\n\t\t\t\tsize: size,\n\t\t\t\tref: [4 * sign, 0],\n\t\t\t\tfill: styles.color\n\t\t\t};\n\t\t\tmarker.shape = {\n\t\t\t\tname: 'Polygon',\n\t\t\t\tpoints: [[-2 * sign, 0], [-4 * sign, 4], [4 * sign, 0], [-4 * sign, -4]]\n\t\t\t};\n\t\t\treturn marker;\n\t\t}\n\t\n\t\tfunction triangle(size, source, styles) {\n\t\t\tvar sign = source ? -1 : 1;\n\t\t\tvar marker = {\n\t\t\t\tviewBox: new _Rectangle2.default(-5, -5, 10, 10),\n\t\t\t\tsize: size,\n\t\t\t\tref: [4 * sign, 0],\n\t\t\t\tfill: styles.color\n\t\t\t};\n\t\t\tmarker.shape = {\n\t\t\t\tname: 'Polygon',\n\t\t\t\tpoints: [[-5 * sign, -5], [-5 * sign, 5], [4 * sign, 0]]\n\t\t\t};\n\t\t\treturn marker;\n\t\t}\n\t\n\t\tfunction oval(size, source, styles) {\n\t\t\tvar r = size / 2;\n\t\t\tvar marker = {\n\t\t\t\tviewBox: new _Rectangle2.default(-r, -r, size, size),\n\t\t\t\tsize: size,\n\t\t\t\tref: [0, 0],\n\t\t\t\tfill: styles.color\n\t\t\t};\n\t\t\tmarker.shape = '<ellipse cx=\"0\" cy=\"0\" rx=\"' + r + '\" ry=\"' + r + '\"></ellipse>';\n\t\t\treturn marker;\n\t\t}\n\t\n\t\tfunction diamond(size, source, styles) {\n\t\t\tvar sign = source ? -1 : 1;\n\t\t\tvar marker = {\n\t\t\t\tviewBox: new _Rectangle2.default(-5, -5, 10, 10),\n\t\t\t\tsize: size,\n\t\t\t\tref: [4 * sign, 0],\n\t\t\t\tfill: styles.color\n\t\t\t};\n\t\t\tmarker.shape = '';\n\t\t\treturn marker;\n\t\t}\n\t\t/** End Standard Marker Type **/\n\t\tfunction getMarker(config, source) {\n\t\t\tvar factory = registry[config.type];\n\t\t\tvar marker = factory(config.size, source, config);\n\t\t\tmarker.id = config.id;\n\t\t\treturn marker;\n\t\t}\n\t\n\t\tregistry['arrow'] = arrow;\n\t\tregistry['triangle'] = triangle;\n\t\tregistry['oval'] = oval;\n\t\tregistry['diamond'] = diamond;\n\t\n\t\treturn {\n\t\t\tregistry: registry,\n\t\t\tgetMarker: getMarker\n\t\t};\n\t}();\n\t\n\texports.default = Marker;\n\n/***/ },\n/* 22 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t\tvalue: true\n\t});\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tvar _lodash = __webpack_require__(5);\n\t\n\tvar _lodash2 = _interopRequireDefault(_lodash);\n\t\n\tvar _Utils = __webpack_require__(2);\n\t\n\tvar _Utils2 = _interopRequireDefault(_Utils);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tvar Layout = function () {\n\t\tfunction Layout() {\n\t\t\tvar config = arguments.length <= 0 || arguments[0] === undefined ? {} : arguments[0];\n\t\n\t\t\t_classCallCheck(this, Layout);\n\t\n\t\t\tif (config.hasOwnProperty(\"orientation\") && _lodash2.default.isString(config.orientation)) {\n\t\t\t\tif (config.orientation.toUpperCase() == \"HORIZONTAL\") config.orientation = Layout.HORIZONTAL;else delete config.orientation;\n\t\t\t}\n\t\t\t_Utils2.default.initConfig(this, config);\n\t\t}\n\t\n\t\t_createClass(Layout, [{\n\t\t\tkey: \"layout\",\n\t\t\tvalue: function layout(root, bounds) {}\n\t\t}, {\n\t\t\tkey: \"reset\",\n\t\t\tvalue: function reset() {}\n\t\t}, {\n\t\t\tkey: \"destroy\",\n\t\t\tvalue: function destroy() {}\n\t\t}]);\n\t\n\t\treturn Layout;\n\t}();\n\t\n\tLayout.VERTICAL = 0;\n\tLayout.HORIZONTAL = 1;\n\t\n\tLayout.DEFAULTS = {\n\t\torientation: Layout.VERTICAL\n\t};\n\t\n\texports.default = Layout;\n\n/***/ },\n/* 23 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t\tvalue: true\n\t});\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tvar _Layout2 = __webpack_require__(22);\n\t\n\tvar _Layout3 = _interopRequireDefault(_Layout2);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\t\n\tfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\t\n\tvar FlowLayout = function (_Layout) {\n\t\t_inherits(FlowLayout, _Layout);\n\t\n\t\tfunction FlowLayout() {\n\t\t\t_classCallCheck(this, FlowLayout);\n\t\n\t\t\treturn _possibleConstructorReturn(this, Object.getPrototypeOf(FlowLayout).apply(this, arguments));\n\t\t}\n\t\n\t\t_createClass(FlowLayout, [{\n\t\t\tkey: \"layout\",\n\t\t\tvalue: function layout(root, bounds) {\n\t\t\t\tvar items;\n\t\t\t\tif (!root) items = this.owner.childNodes;else if (_.isArray(root)) items = root;else items = root.getLinkedNodes('target');\n\t\t\t\tif (!items || items.length == 0) return;\n\t\n\t\t\t\tvar x = 0,\n\t\t\t\t    y = 0,\n\t\t\t\t    h = 0,\n\t\t\t\t    node;\n\t\t\t\tvar p1 = 0,\n\t\t\t\t    p2 = 0;\n\t\t\t\tfor (var i = 0; i < items.length; i++) {\n\t\t\t\t\tnode = items[i];\n\t\t\t\t\tif (x > 0 && x + this.hgap + node.getProperty(\"width\") > bounds.width) {\n\t\t\t\t\t\t// create new line\n\t\t\t\t\t\ty += h + this.vgap;\n\t\t\t\t\t\tx = 0;h = 0;p1 = 0;p2++;\n\t\t\t\t\t}\n\t\t\t\t\tnode._flPos = [p1, p2];\n\t\t\t\t\tnode.moveTo([bounds.x + x, bounds.y + y]);\n\t\t\t\t\tx += this.hgap + node.getProperty(\"width\");\n\t\t\t\t\tp1++;\n\t\t\t\t\th = h < node.getProperty(\"height\") ? node.getProperty(\"height\") : h;\n\t\t\t\t}\n\t\t\t\tthis.trigger(new Rectangle(bounds.x, bounds.y, bounds.width, y + h));\n\t\t\t}\n\t\t}]);\n\t\n\t\treturn FlowLayout;\n\t}(_Layout3.default);\n\t\n\tFlowLayout.DEFAULTS = {\n\t\thgap: 10,\n\t\tvgap: 10\n\t};\n\t\n\texports.default = FlowLayout;\n\n/***/ },\n/* 24 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t\tvalue: true\n\t});\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tvar _lodash = __webpack_require__(5);\n\t\n\tvar _lodash2 = _interopRequireDefault(_lodash);\n\t\n\tvar _bean = __webpack_require__(12);\n\t\n\tvar _bean2 = _interopRequireDefault(_bean);\n\t\n\tvar _Utils = __webpack_require__(2);\n\t\n\tvar _Utils2 = _interopRequireDefault(_Utils);\n\t\n\tvar _DomUtils = __webpack_require__(7);\n\t\n\tvar _DomUtils2 = _interopRequireDefault(_DomUtils);\n\t\n\tvar _Layout = __webpack_require__(22);\n\t\n\tvar _Layout2 = _interopRequireDefault(_Layout);\n\t\n\tvar _Rectangle = __webpack_require__(4);\n\t\n\tvar _Rectangle2 = _interopRequireDefault(_Rectangle);\n\t\n\tvar _EventDispatcher = __webpack_require__(13);\n\t\n\tvar _EventDispatcher2 = _interopRequireDefault(_EventDispatcher);\n\t\n\tvar _GraphBehavior = __webpack_require__(25);\n\t\n\tvar _GraphBehavior2 = _interopRequireDefault(_GraphBehavior);\n\t\n\tvar _SelectionBehavior = __webpack_require__(27);\n\t\n\tvar _SelectionBehavior2 = _interopRequireDefault(_SelectionBehavior);\n\t\n\tvar _Label = __webpack_require__(19);\n\t\n\tvar _Label2 = _interopRequireDefault(_Label);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tvar Renderer = function () {\n\t\tfunction Renderer(id, container) {\n\t\t\tvar config = arguments.length <= 2 || arguments[2] === undefined ? {} : arguments[2];\n\t\t\tvar graph = arguments.length <= 3 || arguments[3] === undefined ? null : arguments[3];\n\t\n\t\t\t_classCallCheck(this, Renderer);\n\t\n\t\t\tthis.id = id;\n\t\t\tthis.box = _DomUtils2.default.createElement('div', { id: this.id, tabindex: 0, ns: 'graph' }, { overflow: \"hidden\", width: \"100%\", height: \"100%\", position: 'relative' });\n\t\t\tcontainer.appendChild(this.box);\n\t\t\tif (config.layout) {\n\t\t\t\tvar layoutClass = _Utils2.default.getConstructor(config.layout.jsClass, _Layout2.default);\n\t\t\t\tthis.layout = new layoutClass(config.layout.config);\n\t\t\t\tdelete config.layout;\n\t\t\t}\n\t\t\tthis.clear = true;\n\t\t\tthis._translate = [0, 0];\n\t\t\tthis._scale = 1.0;\n\t\t\tthis.graph = graph;\n\t\t\tthis.dispatcher = null;\n\t\t\tthis.graphBehavior = null;\n\t\t\tthis.selectionBehavior = null;\n\t\t\tthis.nodeBehavior = null;\n\t\t\tthis.edgeBehavior = null;\n\t\t\tthis.connectionBehavior = null;\n\t\t\t_Utils2.default.initConfig(this, config);\n\t\n\t\t\t_bean2.default.on(_Label2.default.editor, 'editor.update.*', function (key, value) {\n\t\t\t\tconsole.log(key + '=' + value);\n\t\t\t});\n\t\t}\n\t\n\t\t_createClass(Renderer, [{\n\t\t\tkey: \"viewport\",\n\t\t\tvalue: function viewport(scaled, _viewport) {\n\t\t\t\tif (_lodash2.default.isUndefined(scaled) || _lodash2.default.isNull(scaled)) scaled = false;\n\t\t\t\tif (!_viewport) {\n\t\t\t\t\tvar vp = new _Rectangle2.default(0, 0, this.box.offsetWidth, this.box.offsetHeight);\n\t\t\t\t\tif (scaled) return _Utils2.default.scale(this.translate, this.scale, vp);\n\t\t\t\t\treturn vp;\n\t\t\t\t}\n\t\t\t\tif (!scaled) _viewport = _Utils2.default.scale(this.translate, this.scale, _viewport);\n\t\t\t\tvar w = this.box.offsetWidth;\n\t\t\t\tvar scale = w / _viewport.width;\n\t\t\t\tthis.transform(-_viewport.x * scale, -_viewport.y * scale, scale);\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"transform\",\n\t\t\tvalue: function transform() {\n\t\t\t\tvar x = arguments.length <= 0 || arguments[0] === undefined ? null : arguments[0];\n\t\t\t\tvar y = arguments.length <= 1 || arguments[1] === undefined ? null : arguments[1];\n\t\t\t\tvar scale = arguments.length <= 2 || arguments[2] === undefined ? null : arguments[2];\n\t\n\t\t\t\tvar graph = this.graph;\n\t\t\t\tvar root = graph ? graph.currentRoot : null;\n\t\t\t\tif (!_lodash2.default.isNull(x)) {\n\t\t\t\t\tthis._translate[0] = x;\n\t\t\t\t\tif (root) root.viewProp(this.id, 'x', x);\n\t\t\t\t}\n\t\t\t\tif (!_lodash2.default.isNull(y)) {\n\t\t\t\t\tthis._translate[1] = y;\n\t\t\t\t\tif (root) root.viewProp(this.id, 'y', y);\n\t\t\t\t}\n\t\t\t\tif (!_lodash2.default.isNull(scale)) {\n\t\t\t\t\tthis._scale = scale;\n\t\t\t\t\tif (root) root.viewProp(this.id, 'scale', scale);\n\t\t\t\t\t// sync the scale between the dispatcher and the graph\n\t\t\t\t\tvar s = this.dispatcher.scale;\n\t\t\t\t\tif (s != scale) this.dispatcher.scale = scale;\n\t\t\t\t}\n\t\t\t\tthis.refresh();\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"render\",\n\t\t\tvalue: function render() {\n\t\t\t\tif (!this._graph) return false;\n\t\t\t\tif (this.layout) this.layout.layout(this._graph.currentRoot, this.viewport());\n\t\n\t\t\t\tthis.initializeBehaviors();\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"renderLabel\",\n\t\t\tvalue: function renderLabel(box) {\n\t\t\t\treturn this.constructor.renderLabel(box);\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"renderLink\",\n\t\t\tvalue: function renderLink(shape) {\n\t\t\t\treturn this.constructor.renderLink(shape);\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"renderMarkers\",\n\t\t\tvalue: function renderMarkers(markers) {\n\t\t\t\treturn this.constructor.renderMarkers(markers);\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"initializeBehaviors\",\n\t\t\tvalue: function initializeBehaviors() {\n\t\t\t\t// create the event dispatcher if necessary.\n\t\t\t\tif (!this.dispatcher) {\n\t\t\t\t\tthis.dispatcher = new _EventDispatcher2.default(this.box, [this.prop('minZoom'), this.prop('maxZoom')]);\n\t\t\t\t\tvar jsClass = void 0;\n\t\t\t\t\tif (this.prop('graphBehavior')) {\n\t\t\t\t\t\tjsClass = _Utils2.default.getConstructor(this.prop('graphBehavior'));\n\t\t\t\t\t\tthis.graphBehavior = new jsClass(this);\n\t\t\t\t\t}\n\t\t\t\t\tif (this.prop('selectionBehavior')) {\n\t\t\t\t\t\tjsClass = _Utils2.default.getConstructor(this.prop('selectionBehavior'));\n\t\t\t\t\t\tthis.selectionBehavior = new jsClass(this);\n\t\t\t\t\t}\n\t\t\t\t\t/*this.dispatcher.register('mouseup.node.label', function(type, ns, target, pos, event) {\n\t    \tlet node = this._graph.nodes[target.getAttribute('id')];\n\t    \tif (!this.dispatcher.dragging && !node._firstSelection) {\n\t    \t\tLabel._delayEdit = _.delay(() => {\n\t    \t\t\tif (Label._delayEdit) {\n\t    \t\t\t\tdelete Label._delayEdit;\n\t    \t\t\t\tLabel.editor.start(node.id, this.box, node.getLabelBox(this.id), target, event.nsTarget, this.scale);\n\t    \t\t\t}\n\t    \t\t}, 250);\n\t    \t}\n\t    }, this);\n\t    this.dispatcher.register([/^mousedown/, /^zoom/], function(type, ns, target, pos, event) {\n\t    \tif (!DomUtils.eventFromInput(event)) {\n\t    \t\tLabel.editor.stop();\n\t    \t}\n\t    }, this);*/\n\t\t\t\t}\n\t\t\t\tthis.dispatcher.start();\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"refresh\",\n\t\t\tvalue: function refresh() {}\n\t\n\t\t\t/**\n\t   * Get the template for the specified key.\n\t   * @param key\n\t   * @param config if the template is a function, this config will be passed as the argument.\n\t   * @param preprocessor if the template contains preprossing elements, such as #{shape}, the preprocessor will be\n\t   * used to render them.\n\t   * @returns {*}\n\t   */\n\t\n\t\t}, {\n\t\t\tkey: \"getTemplate\",\n\t\t\tvalue: function getTemplate(key, config, preprocessor) {\n\t\t\t\tvar t = this.constructor.TEMPLATES[key];\n\t\t\t\tif (t && _lodash2.default.isFunction(t)) {\n\t\t\t\t\tt = t(config);\n\t\t\t\t}\n\t\t\t\t// check if there are any preprocessing tags.\n\t\t\t\tif (preprocessor) {\n\t\t\t\t\tvar parts = t.match(/(#{[^#]*})/g);\n\t\t\t\t\tvar obj = {};\n\t\t\t\t\tfor (var part in parts) {\n\t\t\t\t\t\tpart = parts[part];\n\t\t\t\t\t\tpart = part.substring(2, part.length - 1).trim();\n\t\t\t\t\t\tobj[part] = preprocessor[_lodash2.default.camelCase('render ' + part)](this);\n\t\t\t\t\t}\n\t\t\t\t\tt = _lodash2.default.template(t, { interpolate: /#{([\\s\\S]+?)}/g })(obj);\n\t\t\t\t}\n\t\t\t\treturn t;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"reset\",\n\t\t\tvalue: function reset() {}\n\t\t}, {\n\t\t\tkey: \"destroy\",\n\t\t\tvalue: function destroy() {\n\t\t\t\tdelete this._graph;\n\t\t\t\tdelete this.layout;\n\t\t\t\tif (this.dispatcher) {\n\t\t\t\t\tthis.dispatcher.stop();\n\t\t\t\t\tdelete this.dispatcher;\n\t\t\t\t}\n\t\t\t\tthis.box.innerHTML = '';\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"graph\",\n\t\t\tget: function get() {\n\t\t\t\treturn this._graph;\n\t\t\t},\n\t\t\tset: function set(graph) {\n\t\t\t\tthis._graph = graph;\n\t\t\t\tvar root = graph.currentRoot;\n\t\t\t\tif (root) {\n\t\t\t\t\tthis._translate = [root.viewProp(this.id, 'x') || 0, root.viewProp(this.id, 'y') || 0];\n\t\t\t\t\tthis._scale = root.viewProp(this.id, 'scale') || 1.0;\n\t\t\t\t}\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"translate\",\n\t\t\tget: function get() {\n\t\t\t\treturn this._translate;\n\t\t\t},\n\t\t\tset: function set(t) {\n\t\t\t\tthis.transform(t[0], t[1]);\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"scale\",\n\t\t\tget: function get() {\n\t\t\t\treturn this._scale;\n\t\t\t},\n\t\t\tset: function set(k) {\n\t\t\t\tswitch (k) {\n\t\t\t\t\tcase \"in\":\n\t\t\t\t\t\tk = this.scale * this.prop(\"zoomFactor\");\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase \"out\":\n\t\t\t\t\t\tk = this.scale / this.prop(\"zoomFactor\");\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase \"actual\":\n\t\t\t\t\t\tk = 1.0;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase \"fit\":\n\t\t\t\t\t\tvar gridSize = this.prop(\"gridSize\") * 2;\n\t\n\t\t\t\t\t\tvar gBounds = this.getBounds();\n\t\t\t\t\t\tvar vBounds = this.viewport();\n\t\n\t\t\t\t\t\tvBounds.width -= gridSize;\n\t\t\t\t\t\tvBounds.height -= gridSize;\n\t\n\t\t\t\t\t\t/* Do not zoom more than actual if graph already fits into the bounds */\n\t\t\t\t\t\tk = Math.min(vBounds.width / gBounds.width, vBounds.height / gBounds.height, 1.0);\n\t\n\t\t\t\t\t\t//TODO: Add centering code here or trigger an event for that\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tdefault:\n\t\t\t\t\t\tif (_lodash2.default.isString(k)) k = parseFloat(k);\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tthis.transform(null, null, k);\n\t\t\t}\n\t\t}]);\n\t\n\t\treturn Renderer;\n\t}();\n\t\n\tRenderer.DEFAULTS = {\n\t\tdefaultClickMode: \"pan\",\n\t\thideOutline: false,\n\t\tsingleSelect: true,\n\t\tdraggable: true,\n\t\tgridEnabled: false,\n\t\tguidesEnabled: true,\n\t\tgridSize: 30,\n\t\tmaxZoom: 4.0,\n\t\tminZoom: 0.2,\n\t\tzoomFactor: 1.2,\n\t\tmaskOpacity: 0.5,\n\t\tgraphBehavior: _GraphBehavior2.default,\n\t\tselectionBehavior: _SelectionBehavior2.default\n\t};\n\t\n\texports.default = Renderer;\n\n/***/ },\n/* 25 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t\tvalue: true\n\t});\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tvar _Behavior2 = __webpack_require__(26);\n\t\n\tvar _Behavior3 = _interopRequireDefault(_Behavior2);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\t\n\tfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; } /**\n\t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * Created by tong on 6/28/2016.\n\t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                */\n\t\n\t\n\t/**\n\t * Graph handler handles Panning and Zoom and rubber band selection\n\t */\n\t\n\tvar GraphBehavior = function (_Behavior) {\n\t\t_inherits(GraphBehavior, _Behavior);\n\t\n\t\tfunction GraphBehavior(renderer) {\n\t\t\t_classCallCheck(this, GraphBehavior);\n\t\n\t\t\tvar _this = _possibleConstructorReturn(this, Object.getPrototypeOf(GraphBehavior).call(this, renderer));\n\t\n\t\t\tvar dispatcher = renderer.dispatcher;\n\t\t\tvar f = function f(type, ns, graph, pos, event) {\n\t\t\t\t//Cursor.updateCursor(type, ns, graph, event);\n\t\t\t};\n\t\t\tdispatcher.register(/^drag.*\\.graph$/, _this.handleDrag, _this);\n\t\t\tdispatcher.register(/^zoom/, _this.handleZoom, _this);\n\t\t\t//dispatcher.register(['mousedown.graph', 'mouseenter.graph', 'mouseleave.graph'], f);\n\t\t\t_this.offset = null;\n\t\t\treturn _this;\n\t\t}\n\t\n\t\t_createClass(GraphBehavior, [{\n\t\t\tkey: \"handleZoom\",\n\t\t\tvalue: function handleZoom(type, ns, graph, pos, event) {\n\t\t\t\tthis.renderer.transform(null, null, event.scale);\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"handleDrag\",\n\t\t\tvalue: function handleDrag(type, ns, graph, pos, event) {\n\t\t\t\tif (type == 'dragstart') {\n\t\t\t\t\tvar pan = this.renderer.prop(\"defaultClickMode\") == \"pan\" ^ (event.ctrlKey || event.shiftKey);\n\t\t\t\t\tif (!pan) return;\n\t\t\t\t\tvar t = this.renderer.translate;\n\t\t\t\t\tthis.offset = [t[0] - pos[0], t[1] - pos[1]];\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tif (!this.offset) return;\n\t\t\t\tthis.renderer.transform(pos[0] + this.offset[0], pos[1] + this.offset[1]);\n\t\t\t\tif (type == 'dragend') {\n\t\t\t\t\t//Cursor.updateCursor('mouseup', ns, graph, event);\n\t\t\t\t\tdelete this.offset;\n\t\t\t\t}\n\t\t\t}\n\t\t}]);\n\t\n\t\treturn GraphBehavior;\n\t}(_Behavior3.default);\n\t\n\texports.default = GraphBehavior;\n\n/***/ },\n/* 26 */\n/***/ function(module, exports) {\n\n\t\"use strict\";\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t\tvalue: true\n\t});\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tvar Behavior = function () {\n\t\tfunction Behavior(renderer) {\n\t\t\t_classCallCheck(this, Behavior);\n\t\n\t\t\tthis.renderer = renderer;\n\t\t}\n\t\n\t\t_createClass(Behavior, [{\n\t\t\tkey: \"destroy\",\n\t\t\tvalue: function destroy() {\n\t\t\t\tdelete this.renderer;\n\t\t\t}\n\t\t}]);\n\t\n\t\treturn Behavior;\n\t}();\n\t\n\texports.default = Behavior;\n\n/***/ },\n/* 27 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t\tvalue: true\n\t});\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tvar _get = function get(object, property, receiver) { if (object === null) object = Function.prototype; var desc = Object.getOwnPropertyDescriptor(object, property); if (desc === undefined) { var parent = Object.getPrototypeOf(object); if (parent === null) { return undefined; } else { return get(parent, property, receiver); } } else if (\"value\" in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } };\n\t\n\tvar _Rectangle = __webpack_require__(4);\n\t\n\tvar _Rectangle2 = _interopRequireDefault(_Rectangle);\n\t\n\tvar _Cell = __webpack_require__(17);\n\t\n\tvar _Cell2 = _interopRequireDefault(_Cell);\n\t\n\tvar _Behavior2 = __webpack_require__(26);\n\t\n\tvar _Behavior3 = _interopRequireDefault(_Behavior2);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\t\n\tfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\t\n\tvar SelectionBehavior = function (_Behavior) {\n\t\t_inherits(SelectionBehavior, _Behavior);\n\t\n\t\tfunction SelectionBehavior(renderer) {\n\t\t\t_classCallCheck(this, SelectionBehavior);\n\t\n\t\t\tvar _this = _possibleConstructorReturn(this, Object.getPrototypeOf(SelectionBehavior).call(this, renderer));\n\t\n\t\t\tvar dispatcher = renderer.dispatcher;\n\t\t\tdispatcher.register('mousedown.*', _this.selectCell, _this);\n\t\t\tdispatcher.register('mouseup.*', _this.unselectCell, _this);\n\t\t\tdispatcher.register('drag*.graph', _this.handleMultiSelect, _this);\n\t\t\t//graph.on(Graph.EVENT_TYPES.SELECTION_CHANGE, this.updateSelections, this);\n\t\t\t_this.selectedNodes = null;\n\t\t\t_this.selectedLinks = null;\n\t\t\t_this.attachedLinks = null;\n\t\t\treturn _this;\n\t\t}\n\t\n\t\t_createClass(SelectionBehavior, [{\n\t\t\tkey: \"updateSelections\",\n\t\t\tvalue: function updateSelections() {\n\t\t\t\tif (this.selectedNodes) this.selectedNodes.classed('selected', false);\n\t\t\t\tif (this.selectedLinks) this.selectedLinks.classed('selected', false);\n\t\n\t\t\t\tthis.selectedNodes = null;\n\t\t\t\tthis.selectedLinks = null;\n\t\t\t\tthis.attachedLinks = null;\n\t\n\t\t\t\tif (this.graph.selectedVertices && this.graph.selectedVertices.length > 0) {\n\t\t\t\t\tthis.selectedNodes = this.graph.renderer.getShapes(this.graph.selectedVertices);\n\t\t\t\t\tthis.attachedLinks = this.graph.renderer.getShapes(this.graph.getAttachedEdges());\n\t\t\t\t\tthis.selectedNodes.classed('selected', true);\n\t\t\t\t}\n\t\n\t\t\t\tif (this.graph.selectedEdges && this.graph.selectedEdges.length > 0) {\n\t\t\t\t\tthis.selectedLinks = this.graph.renderer.getShapes(this.graph.selectedEdges);\n\t\t\t\t\tthis.selectedLinks.classed('selected', true);\n\t\t\t\t}\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"selectCell\",\n\t\t\tvalue: function selectCell(type, ns, data, pos, event) {\n\t\t\t\tvar cell = data == this.graph ? null : data;\n\t\t\t\tif (cell && !(cell instanceof _Cell2.default)) return;\n\t\t\t\tvar toggle = event.ctrlKey || event.shiftKey;\n\t\t\t\tif (cell && cell instanceof _Cell2.default) {\n\t\t\t\t\tif (!this.graph.isSelected(cell)) delete cell._firstSelection;else cell._firstSelection = true;\n\t\n\t\t\t\t\td3.select(event.dataTarget).moveToFront();\n\t\t\t\t\tthis.graph.setSelection(cell, toggle);\n\t\t\t\t}\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"unselectCell\",\n\t\t\tvalue: function unselectCell(type, ns, data, pos, event) {\n\t\t\t\tvar cell = data == this.graph ? null : data;\n\t\t\t\tif (cell && !(cell instanceof _Cell2.default)) return;\n\t\t\t\tvar ctrlKey = event.ctrlKey || event.shiftKey;\n\t\t\t\tif (!cell) {\n\t\t\t\t\tthis.graph.setSelection(cell, ctrlKey);\n\t\t\t\t}\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"handleMultiSelect\",\n\t\t\tvalue: function handleMultiSelect(type, ns, data, pos, event) {\n\t\t\t\tpos = util.scale(this.graph, pos);\n\t\n\t\t\t\tif (type == 'dragstart') {\n\t\t\t\t\tvar select = this.graph.getProperty(\"defaultClickMode\") == \"select\" ^ (event.ctrlKey || event.shiftKey);\n\t\t\t\t\tif (!select) return;\n\t\t\t\t\tthis.startPt = new Point(pos[0], pos[1]);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tif (!this.startPt) return;\n\t\t\t\tvar rect = _Rectangle2.default.getBoundingRectangle([new Point(pos[0], pos[1]), this.startPt]);\n\t\t\t\tvar renderer = this.graph.renderer;\n\t\t\t\tif (!this.rubberband) {\n\t\t\t\t\tthis.rubberband = d3.select(renderer.appendNode(renderer.getCellLayer(), {\n\t\t\t\t\t\ttemplate: _.template('<g><rect x=\"0\" y=\"0\" width=\"100\" height=\"100\" stroke=\"#000000\" fill=\"none\" stroke-dasharray=\"3 3\"/></g>')\n\t\t\t\t\t}, false));\n\t\t\t\t}\n\t\t\t\tif (type == 'dragend') {\n\t\t\t\t\tvar cells = this.graph.getCurrentRoot().children;\n\t\t\t\t\t// TODO: Define if we want to select vertexes / edges or both\n\t\t\t\t\tcells = _.filter(cells, function (cell) {\n\t\t\t\t\t\tvar box = cell.getBounds();\n\t\t\t\t\t\tif (rect.contains(box)) {\n\t\t\t\t\t\t\treturn true;\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t});\n\t\t\t\t\t// TODO: Set selection\n\t\t\t\t\tthis.graph.setSelection(cells, event.ctrlKey);\n\t\n\t\t\t\t\tthis.rubberband.remove();\n\t\t\t\t\tdelete this.startPt;\n\t\t\t\t\tdelete this.rubberband;\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tthis.rubberband.select(\"rect\").attr({ x: rect.x, y: rect.y, width: rect.width, height: rect.height });\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"destroy\",\n\t\t\tvalue: function destroy() {\n\t\t\t\t_get(Object.getPrototypeOf(SelectionBehavior.prototype), \"destroy\", this).call(this);\n\t\t\t\tdelete this.selectedNodes;\n\t\t\t\tdelete this.selectedLinks;\n\t\t\t\tdelete this.attachedLinks;\n\t\t\t}\n\t\t}]);\n\t\n\t\treturn SelectionBehavior;\n\t}(_Behavior3.default);\n\t\n\texports.default = SelectionBehavior;\n\n/***/ },\n/* 28 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t\tvalue: true\n\t});\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tvar _get = function get(object, property, receiver) { if (object === null) object = Function.prototype; var desc = Object.getOwnPropertyDescriptor(object, property); if (desc === undefined) { var parent = Object.getPrototypeOf(object); if (parent === null) { return undefined; } else { return get(parent, property, receiver); } } else if (\"value\" in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } };\n\t\n\tvar _lodash = __webpack_require__(5);\n\t\n\tvar _lodash2 = _interopRequireDefault(_lodash);\n\t\n\tvar _base = __webpack_require__(1);\n\t\n\tvar _base2 = _interopRequireDefault(_base);\n\t\n\tvar _DomUtils = __webpack_require__(7);\n\t\n\tvar _DomUtils2 = _interopRequireDefault(_DomUtils);\n\t\n\tvar _Renderer2 = __webpack_require__(24);\n\t\n\tvar _Renderer3 = _interopRequireDefault(_Renderer2);\n\t\n\tvar _StringBuffer = __webpack_require__(8);\n\t\n\tvar _StringBuffer2 = _interopRequireDefault(_StringBuffer);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\t\n\tfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\t\n\tvar NS = 'http://www.w3.org/2000/svg';\n\tif (typeof SVGElement != \"undefined\") {\n\t\tvar svg = document.createElementNS(NS, \"svg\");\n\t\tsvg.innerHTML = '<circle/>';\n\t\tif (svg.firstChild !== \"[object SVGCircleElement]\") {\n\t\t\tObject.defineProperties(SVGElement.prototype, {\n\t\t\t\t\"outerHTML\": {\n\t\t\t\t\tenumerable: false,\n\t\t\t\t\tconfigurable: true,\n\t\t\t\t\tget: function get() {\n\t\t\t\t\t\tvar $node, $temp;\n\t\t\t\t\t\t$temp = document.createElement('div');\n\t\t\t\t\t\t$node = this.cloneNode(true);\n\t\t\t\t\t\t$temp.appendChild($node);\n\t\t\t\t\t\treturn $temp.innerHTML;\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t\"innerHTML\": {\n\t\t\t\t\tenumerable: false,\n\t\t\t\t\tconfigurable: true,\n\t\t\t\t\tget: function get() {\n\t\t\t\t\t\tvar s = this.outerHTML;\n\t\t\t\t\t\tvar ropen = new RegExp(\"<\" + this.nodeName + '\\\\b(?:([\"\\'])[^\"]*?(\\\\1)|[^>])*>', \"i\");\n\t\t\t\t\t\tvar rclose = new RegExp(\"<\\/\" + this.nodeName + \">$\", \"i\");\n\t\t\t\t\t\treturn s.replace(ropen, \"\").replace(rclose, \"\");\n\t\t\t\t\t},\n\t\t\t\t\tset: function set(markup) {\n\t\t\t\t\t\t// empty el first.\n\t\t\t\t\t\tvar child = void 0;\n\t\t\t\t\t\twhile (child = this.lastChild) {\n\t\t\t\t\t\t\tthis.removeChild(child);\n\t\t\t\t\t\t}var buf = new _StringBuffer2.default();\n\t\t\t\t\t\tbuf.append('<svg>').append(markup).append('</svg');\n\t\t\t\t\t\tvar $temp = _DomUtils2.default.createElement('div', null, null, buf.toString()).firstElementChild;\n\t\t\t\t\t\twhile ($temp.firstChild) {\n\t\t\t\t\t\t\tthis.appendChild($temp.firstChild);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t\t// Define the toDataURL for SVG\n\t\tSVGElement.prototype.toDataURL = function (type) {\n\t\t\tvar options = arguments.length <= 1 || arguments[1] === undefined ? {} : arguments[1];\n\t\n\t\t\tvar _svg = this;\n\t\n\t\t\tvar debug = function debug(msg) {};\n\t\n\t\t\tif (options['debug'] == true && typeof console != 'undefined') debug = function debug(msg) {\n\t\t\t\tconsole.log(\"SVG.toDataURL:\", msg);\n\t\t\t};\n\t\n\t\t\tfunction exportSVG() {\n\t\t\t\tvar svg_xml = _svg.outerHTML;\n\t\t\t\tvar svg_dataurl = base64dataURLencode(svg_xml);\n\t\t\t\tdebug(type + \" length: \" + svg_dataurl.length);\n\t\n\t\t\t\t// NOTE double data carrier\n\t\t\t\tif (options.callback) options.callback(svg_dataurl);\n\t\t\t\treturn svg_dataurl;\n\t\t\t}\n\t\n\t\t\tfunction base64dataURLencode(s) {\n\t\t\t\tvar b64 = \"data:image/svg+xml;base64,\";\n\t\n\t\t\t\t// https://developer.mozilla.org/en/DOM/window.btoa\n\t\t\t\tif (window.btoa) {\n\t\t\t\t\tdebug(\"using window.btoa for base64 encoding\");\n\t\t\t\t\tb64 += btoa(s);\n\t\t\t\t} else {\n\t\t\t\t\tdebug(\"using custom base64 encoder\");\n\t\t\t\t\tb64 += _base2.default.encode(s);\n\t\t\t\t}\n\t\n\t\t\t\treturn b64;\n\t\t\t}\n\t\n\t\t\t// Native export doesn't work very well. should use canvg instead.\n\t\t\tfunction exportImage(type) {\n\t\t\t\tvar canvas = document.createElement(\"canvas\");\n\t\t\t\tvar ctx = canvas.getContext('2d');\n\t\n\t\t\t\t// TODO: if (options.keepOutsideViewport), do some translation magic?\n\t\n\t\t\t\tvar svg_img = new Image();\n\t\t\t\tvar svg_xml = _svg.outerHTML;\n\t\t\t\tsvg_img.src = base64dataURLencode(svg_xml);\n\t\n\t\t\t\tsvg_img.onload = function () {\n\t\t\t\t\tdebug(\"exported image size: \" + [svg_img.width, svg_img.height]);\n\t\t\t\t\tcanvas.width = svg_img.width;\n\t\t\t\t\tcanvas.height = svg_img.height;\n\t\t\t\t\tctx.drawImage(svg_img, 0, 0);\n\t\n\t\t\t\t\t// SECURITY_ERR WILL HAPPEN NOW\n\t\t\t\t\tvar image_dataurl = canvas.toDataURL(type);\n\t\t\t\t\tdebug(type + \" length: \" + image_dataurl.length);\n\t\n\t\t\t\t\tif (options.callback) options.callback(image_dataurl);else debug(\"WARNING: no callback set, so nothing happens.\");\n\t\t\t\t};\n\t\n\t\t\t\tsvg_img.onerror = function () {\n\t\t\t\t\tdebug(\"Can't export! Maybe your browser doesn't support \" + \"SVG in img element or SVG input for Canvas drawImage?\\n\" + \"http://en.wikipedia.org/wiki/SVG#Native_support\");\n\t\t\t\t};\n\t\n\t\t\t\t// NOTE: will not return anything\n\t\t\t}\n\t\n\t\t\tfunction exportImageCanvg(type) {\n\t\t\t\tif (!canvg) return null;\n\t\t\t\tvar canvas = _DomUtils2.default.createElement('canvas', null, { display: \"none\" });\n\t\t\t\tdocument.body.appendChild(canvas);\n\t\t\t\tif (type == 'javascript') {\n\t\t\t\t\tvar xcanvas = new jsCanvas('jscanvastest');\n\t\t\t\t\txcanvas.canvas.style.display = 'none';\n\t\t\t\t\t//xcanvas.canvas = canvas;\n\t\t\t\t}\n\t\n\t\t\t\tif (!options.keepOutsideViewport) {\n\t\t\t\t\tcanvg(canvas, _svg.outerHTML);\n\t\t\t\t} else {\n\t\t\t\t\tvar padding = options.padding || 0;\n\t\t\t\t\tvar scale = 1.0;\n\t\t\t\t\tvar translate = [0, 0];\n\t\t\t\t\tvar bbox = _svg.getBBox();\n\t\t\t\t\tdebug(\"detected svg dimensions \" + [bbox.x, bbox.y, bbox.width, bbox.height]);\n\t\t\t\t\tvar transform = _svg.firstElementChild.getAttribute('transform');\n\t\t\t\t\tif (transform) {\n\t\t\t\t\t\tdebug('detected svg transform ' + transform);\n\t\t\t\t\t\ttransform = SVGRenderer.transform(transform);\n\t\t\t\t\t\ttranslate = transform.translate;\n\t\t\t\t\t\tscale = transform.scale;\n\t\t\t\t\t}\n\t\t\t\t\tvar buf = new _StringBuffer2.default();\n\t\t\t\t\tbuf.append('<svg width=\"').append(bbox.width + 2 * padding).append('px\" height=\"').append(bbox.height + 2 * padding).append('px\"><g transform=\"translate(').append(-bbox.x + translate[0] + padding).append(',').append(-bbox.y + translate[1] + padding).append(')scale(').append(scale).append(')\">').append(_svg.firstElementChild.innerHTML).append('</g></svg>');\n\t\t\t\t\tif (type == 'javascript') {\n\t\t\t\t\t\txcanvas.compile(buf.toString(), function () {\n\t\t\t\t\t\t\tif (options.callback) options.callback(xcanvas.toString());\n\t\t\t\t\t\t});\n\t\t\t\t\t\treturn;\n\t\t\t\t\t} else canvg(canvas, buf.toString());\n\t\t\t\t}\n\t\t\t\tvar image_dataurl = canvas.toDataURL(type);\n\t\t\t\tif (options.callback) options.callback(image_dataurl);\n\t\t\t\tcanvas.parentNode.removeChild(canvas);\n\t\t\t\treturn image_dataurl;\n\t\t\t}\n\t\n\t\t\tif (!type) type = \"image/svg+xml\";\n\t\n\t\t\tif (options.keepNonSafe) debug(\"NOTE: keepNonSafe is NOT supported and will be ignored!\");\n\t\t\tif (options.keepOutsideViewport) debug(\"NOTE: keepOutsideViewport is only supported with canvg exporter.\");\n\t\n\t\t\tswitch (type) {\n\t\t\t\tcase \"image/svg+xml\":\n\t\t\t\t\treturn exportSVG();\n\t\t\t\tcase \"image/png\":\n\t\t\t\tcase \"image/jpeg\":\n\t\t\t\tcase \"javascript\":\n\t\t\t\t\tif (!options.renderer) {\n\t\t\t\t\t\tif (window.canvg) options.renderer = \"canvg\";else options.renderer = \"native\";\n\t\t\t\t\t}\n\t\t\t\t\tswitch (options.renderer) {\n\t\t\t\t\t\tcase \"canvg\":\n\t\t\t\t\t\t\tdebug(\"using canvg renderer for \" + type + \" image export\");\n\t\t\t\t\t\t\treturn exportImageCanvg(type);\n\t\t\t\t\t\tcase \"native\":\n\t\t\t\t\t\t\tdebug(\"using native renderer for \" + type + \" export. THIS MIGHT FAIL.\");\n\t\t\t\t\t\t\treturn exportImage(type);\n\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\tdebug(\"unknown image renderer given, doing noting (\" + options.renderer + \")\");\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\tdebug(\"Sorry! Exporting as '\" + type + \"' is not supported!\");\n\t\t\t}\n\t\t\treturn null;\n\t\t};\n\t}\n\t\n\tvar SVGRenderer = function (_Renderer) {\n\t\t_inherits(SVGRenderer, _Renderer);\n\t\n\t\tfunction SVGRenderer() {\n\t\t\t_classCallCheck(this, SVGRenderer);\n\t\n\t\t\treturn _possibleConstructorReturn(this, Object.getPrototypeOf(SVGRenderer).apply(this, arguments));\n\t\t}\n\t\n\t\t_createClass(SVGRenderer, [{\n\t\t\tkey: \"render\",\n\t\t\tvalue: function render() {\n\t\t\t\tvar result = _get(Object.getPrototypeOf(SVGRenderer.prototype), \"render\", this).call(this);\n\t\t\t\tif (result) {\n\t\t\t\t\tvar root = this.graph.currentRoot;\n\t\t\t\t\tvar buf = new _StringBuffer2.default('<svg width=\"100%\" height=\"100%\" xmlns=\"http://www.w3.org/2000/svg\">');\n\t\t\t\t\tvar t = this.translate;\n\t\t\t\t\tbuf.append('<g transform=\"translate(').append(t[0]).append(',').append(t[1]).append(')scale(').append(this.scale).append(')\">');\n\t\t\t\t\tbuf.append(this.renderDefs());\n\t\t\t\t\tbuf.append(root.render(this));\n\t\t\t\t\tbuf.append('</g></svg>');\n\t\t\t\t\tthis.box.innerHTML = buf.toString();\n\t\t\t\t\tthis.svg = this.box.firstElementChild;\n\t\t\t\t}\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"renderDefs\",\n\t\t\tvalue: function renderDefs() {\n\t\t\t\tvar buf = new _StringBuffer2.default('<defs>');\n\t\t\t\tbuf.append(this.getTemplate('Grid', this.prop(\"gridSize\")));\n\t\t\t\tvar markers = this.graph.markers;\n\t\t\t\tif (markers.length > 0) buf.append(SVGRenderer.renderMarkers(markers));\n\t\t\t\tbuf.append('</defs>');\n\t\t\t\treturn buf.toString();\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"refresh\",\n\t\t\tvalue: function refresh() {\n\t\t\t\tif (!this.svg) return;\n\t\t\t\tvar g = this.svg.querySelector('g');\n\t\t\t\tvar t = this.translate;\n\t\t\t\tg.setAttribute('transform', 'translate(' + t[0] + ',' + t[1] + ')scale(' + this.scale + ')');\n\t\t\t}\n\t\t}], [{\n\t\t\tkey: \"renderMarkers\",\n\t\t\tvalue: function renderMarkers(markers) {\n\t\t\t\tvar buf = new _StringBuffer2.default(),\n\t\t\t\t    str1 = void 0,\n\t\t\t\t    str2 = void 0;\n\t\t\t\tmarkers.forEach(function (marker) {\n\t\t\t\t\tstr1 = this.TEMPLATES['Marker'](marker);\n\t\t\t\t\tstr2 = marker.shape;\n\t\t\t\t\tif (!_lodash2.default.isString(str2)) str2 = this.renderShape(str2);\n\t\t\t\t\tstr1 = str1.replace(/\\#\\{shape\\}/, str2);\n\t\t\t\t\tbuf.append(str1);\n\t\t\t\t}, this);\n\t\t\t\treturn buf.toString();\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"renderLabel\",\n\t\t\tvalue: function renderLabel(box) {\n\t\t\t\treturn this.TEMPLATES['Label'](box);\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"renderShape\",\n\t\t\tvalue: function renderShape(shape) {\n\t\t\t\tvar template = this.TEMPLATES[shape.name];\n\t\t\t\tif (_lodash2.default.isString(template)) template = _lodash2.default.template(template);\n\t\t\t\treturn template(shape);\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"getPathData\",\n\t\t\tvalue: function getPathData(shape) {\n\t\t\t\tvar points = shape.points;\n\t\t\t\tvar controlPts = shape.controlPts;\n\t\t\t\tif (!points || points.length == 0) return '';\n\t\n\t\t\t\tif (!controlPts && shape.round) {\n\t\t\t\t\t// render rounded line joins.\n\t\t\t\t\tvar newPts = [];\n\t\t\t\t\tcontrolPts = [];\n\t\t\t\t\tvar prev = points[0],\n\t\t\t\t\t    next = void 0,\n\t\t\t\t\t    d1 = void 0,\n\t\t\t\t\t    d2 = void 0,\n\t\t\t\t\t    corner = void 0;\n\t\t\t\t\tnewPts.push(prev);\n\t\t\t\t\tfor (var i = 1; i < points.length - 1; i++) {\n\t\t\t\t\t\tnext = points[i];\n\t\t\t\t\t\t// set the control point first.\n\t\t\t\t\t\tcontrolPts[2 * i] = [next, next];\n\t\t\t\t\t\t// check the size of the corner.\n\t\t\t\t\t\td1 = prev.distance(next);\n\t\t\t\t\t\td2 = next.distance(points[i + 1]);\n\t\t\t\t\t\tcorner = Math.min(shape.round, d1 / 2, d2 / 2);\n\t\t\t\t\t\t// split the point into two.\n\t\t\t\t\t\tnewPts.push(next.getDirection(prev).scale(corner).translate(next));\n\t\t\t\t\t\tnewPts.push(next.getDirection(points[i + 1]).scale(corner).translate(next));\n\t\t\t\t\t\tprev = next;\n\t\t\t\t\t}\n\t\t\t\t\tnewPts.push(points[points.length - 1]);\n\t\t\t\t\tpoints = newPts;\n\t\t\t\t}\n\t\t\t\tvar buf = new _StringBuffer2.default('M'),\n\t\t\t\t    point = void 0;\n\t\t\t\tfor (var _i = 0; _i < points.length; _i++) {\n\t\t\t\t\tpoint = points[_i];\n\t\t\t\t\tif (_i == 0) buf.append(point);else {\n\t\t\t\t\t\tif (controlPts && controlPts[_i]) {\n\t\t\t\t\t\t\tbuf.append(' C ');\n\t\t\t\t\t\t\tfor (var j = 0; j < controlPts[_i].length; j++) {\n\t\t\t\t\t\t\t\tbuf.append(controlPts[_i][j]).append(' ');\n\t\t\t\t\t\t\t}buf.append(point);\n\t\t\t\t\t\t} else buf.append(' L ').append(point);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn buf.toString();\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"renderLink\",\n\t\t\tvalue: function renderLink(shape) {\n\t\t\t\tvar buf = new _StringBuffer2.default();\n\t\t\t\tvar d = SVGRenderer.getPathData(shape);\n\t\t\t\tif (shape.showGauge) buf.append('<path style=\"stroke: white; stroke-width: 9; visibility: hidden; pointer-events: stroke;\" d=\"').append(d).append('\"/>');\n\t\t\t\tbuf.append('<path d=\"').append(d).append('\"');\n\t\t\t\tif (shape.startMarker || shape.endMarker) {\n\t\t\t\t\tbuf.append(' style=\"');\n\t\t\t\t\tif (shape.startMarker) buf.append('marker-start: url(#').append(_lodash2.default.isString(shape.startMarker) ? shape.startMarker : shape.startMarker.id).append(');');\n\t\t\t\t\tif (shape.endMarker) buf.append('marker-end: url(#').append(_lodash2.default.isString(shape.endMarker) ? shape.endMarker : shape.endMarker.id).append(');');\n\t\t\t\t\tbuf.append('\"');\n\t\t\t\t}\n\t\t\t\tbuf.append('/>');\n\t\t\t\treturn buf.toString();\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"appendContent\",\n\t\t\tvalue: function appendContent(el, content) {\n\t\t\t\tvar buf = new _StringBuffer2.default();\n\t\t\t\tbuf.append('<svg>').append(content).append('</svg');\n\t\t\t\tvar temp = _DomUtils2.default.createElement('div', null, null, buf.toString()).firstElementChild;\n\t\n\t\t\t\twhile (temp.firstChild) {\n\t\t\t\t\tel.appendChild(temp.firstChild);\n\t\t\t\t}return el;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"transform\",\n\t\t\tvalue: function transform(_transform) {\n\t\t\t\tvar translate = [0, 0],\n\t\t\t\t    scale = 1.0;\n\t\t\t\t//\n\t\t\t\tvar parts = _transform.match(/translate\\(\\s*([^)]+)/);\n\t\t\t\tif (parts) {\n\t\t\t\t\tvar m = parts[1].trim().match(/([\\d.-]+)[ ,]([\\d.-]+)/);\n\t\t\t\t\tif (m) {\n\t\t\t\t\t\ttranslate[0] = parseFloat(m[1]) || 0;\n\t\t\t\t\t\ttranslate[1] = parseFloat(m[2]) || 0;\n\t\t\t\t\t} else translate[0] = translate[1] = parseFloat(parts[1]);\n\t\t\t\t}\n\t\t\t\tparts = _transform.match(/scale\\(\\s*([^)]+)/);\n\t\t\t\tif (parts) scale = parseFloat(parts[1]) || 1.0;\n\t\n\t\t\t\treturn { translate: translate, scale: scale };\n\t\t\t}\n\t\t}]);\n\t\n\t\treturn SVGRenderer;\n\t}(_Renderer3.default);\n\t\n\tSVGRenderer.TEMPLATES = {\n\t\t$root: '<g id=\"${id}\" class=\"${className}\">#{children}</g>',\n\t\t$node: '<g id=\"${id}\" class=\"${className}\" style=\"${style}\" ns=\"${namespace}\" transform=\"translate(${x},${y})\">#{shape}#{label}</g>',\n\t\t$edge: '<g id=\"${id}\" class=\"${className}\" style=\"${style}\" ns=\"${namespace}\">#{shape}#{label}</g>',\n\t\tEllipse: '<ellipse cx=\"0\" cy=\"0\" rx=\"${width/2}\" ry=\"${height/2}\"/>',\n\t\tRectangle: '<rect x=\"${-width/2}\" y=\"${-height/2}\" width=\"${width}\" height=\"${height}\" rx=\"9\" ry=\"9\"/>',\n\t\tTriangle: '<polygon points=\"${-width/2},${-height/2} ${width/2},${-height/2} 0,${height/2}\"/>',\n\t\tRhombus: '<polygon points=\"0,${-height/2} ${width/2},0 0,${height/2} ${-width/2},0\"/>',\n\t\tHexagon: function Hexagon(config) {\n\t\t\tvar vertical = config.direction == 'north' || config.direction == 'south';\n\t\t\tif (vertical) return '<polygon points=\"0,${-height/2} ${width/2},${-height/4} ${width/2},${height/4} 0,${height/2} ${-width/2},${height/4} ${-width/2},${-height/4}\"/>';else return '<polygon points=\"${-width/2},0 ${width/4},${-height/2} ${width/4},${-height/2} ${width/2},0 ${width/4},${height/2} ${-width/4},${height/2}\"/>';\n\t\t},\n\t\tPolygon: function Polygon(shape) {\n\t\t\tvar buf = new _StringBuffer2.default('<polygon points=\"');\n\t\t\tshape.points.forEach(function (pt) {\n\t\t\t\tbuf.append(pt[0]).append(',').append(pt[1]).append(' ');\n\t\t\t});\n\t\t\tbuf.removeLast();\n\t\t\tbuf.append('\"/>');\n\t\t\treturn buf.toString();\n\t\t},\n\t\tImage: function Image(config) {\n\t\t\treturn '<image x=\"${-width/2}\" y=\"${-height/2}\" width=\"${width}\" height=\"${height}\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" xlink:href=\"' + config.image + '\"/>';\n\t\t},\n\t\tMarker: function Marker(marker) {\n\t\t\treturn (\"\\n<marker id=\\\"\" + marker.id + \"\\\" markerWidth=\\\"\" + marker.size + \"\\\" markerHeight=\\\"\" + marker.size + \"\\\" refx=\\\"\" + marker.ref[0] + \"\\\" \\nrefy=\\\"\" + marker.ref[1] + \"\\\" orient=\\\"auto\\\" viewbox=\\\"\" + marker.viewBox.x + \" \" + marker.viewBox.y + \" \" + marker.viewBox.width + \" \" + marker.viewBox.height + \"\\\"\\nmarkerUnits=\\\"userSpaceOnUse\\\" \" + (marker.fill ? \"style=\\\"stroke: \" + marker.fill + \";fill:\" + marker.fill + \"\\\"\" : '') + \">#{shape}</marker>\\n\").trim();\n\t\t},\n\t\tGrid: function Grid(size) {\n\t\t\treturn (\"\\n<pattern id=\\\"GridPattern\\\" width=\\\"\" + size + \"\\\" height=\\\"\" + size + \"\\\" patternUnits=\\\"userSpaceOnUse\\\">\\n\\t<ellipse cx=\\\"0\\\" cy=\\\"0\\\" rx=\\\"1\\\" ry=\\\"1\\\" fill=\\\"#999999\\\"/>\\n\\t<ellipse cx=\\\"0\\\" cy=\\\"\" + size + \"\\\" rx=\\\"1\\\" ry=\\\"1\\\" fill=\\\"#999999\\\"/>\\n\\t<ellipse cx=\\\"\" + size + \"\\\" cy=\\\"0\\\" rx=\\\"1\\\" ry=\\\"1\\\" fill=\\\"#999999\\\"/>\\n\\t<ellipse cx=\\\"\" + size + \"\\\" cy=\\\"\" + size + \"\\\" rx=\\\"1\\\" ry=\\\"1\\\" fill=\\\"#999999\\\"/>\\n</pattern>\").trim();\n\t\t},\n\t\tLabel: _lodash2.default.template(\"\\n<% var box = _.has(data, \\\"dx\\\") ? data : (data.getLabelBox ? data.getLabelBox() : null); \\n   if (box) {%>\\n\\t<g <% if (box.config && box.config.class) {%>class=\\\"<%=box.config.class%>\\\"<%}%>\\t\\t<% if (box.config && box.config.ns) {%>ns=\\\"<%=box.config.ns%>\\\"<%}%>\\t\\t<% if (box.config && box.config.inlineStyle) {%>\\t\\t\\tfont-size=\\\"<%=box.config.fontSize%>\\\"\\t\\t\\tfont-family=\\\"<%=box.config.fontFamily%>\\\"\\t\\t\\tfont-weight=\\\"<% if (box.bold) {%>bold<%} else {%>normal<%}%>\\\"\\t\\t\\t<% if (box.underline) {%>text-decoration=\\\"underline\\\"<%}%>\\t\\t\\t<% if (box.italic) {%>font-style=\\\"italic\\\"<%}%>\\t\\t<%}%>\\t\\ttext-anchor=\\\"<%=box.anchor%>\\\"\\t\\ttransform=\\\"translate(<%=box.bounds.x%>,<%=box.bounds.y%>)<% if (box.config && box.config.rotation) {%>rotate(<%=box.config.rotation%> <%=box.pivot[0]%> <%=box.pivot[1]%>)<%}%>\\\">\\n\\t<% if (box.config.backgroundStyle) {%>\\n\\t\\t<rect x=\\\"<%=-box.bounds.width/2%>\\\" y=\\\"<%=-box.bounds.height/2%>\\\" width=\\\"<%=box.bounds.width%>\\\" height=\\\"<%=box.bounds.height%>\\\" style=\\\"<%=box.config.backgroundStyle%>\\\"/>\\n\\t<% } if (_.isArray(box.label)) { \\n\\t\\t_.each(box.label, function(value, line) {%>\\n\\t\\t\\t<text <% if (box.config && box.config.textStyle) {%>style=\\\"<%=box.config.textStyle%>\\\"<%}%>\\t\\t\\t\\tdx=\\\"<%=box.dx%>\\\" dy=\\\"<%=box.dy + box.lineHeight * line%>\\\"><%=value%></text>\\n\\t\\t<%});} else { %>\\n\\t\\t\\t<text><%=box.label%></text>\\n\\t\\t<%}%>\\n\\t</g>\\n<%}%>\\n\".trim(), { variable: \"data\" }) //TODO add more inline text styles.\n\t};\n\t\n\texports.default = SVGRenderer;\n\n/***/ }\n/******/ ])\n});\n;\n"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n/** WEBPACK FOOTER **\n ** webpack/bootstrap dc719c1ba2bfdf4ea9c0\n **/","import Base64 from \"./util/base64\";\nimport Cache from \"./util/Utils\";\nimport Utils from \"./util/Utils\";\nimport DomUtils from \"./util/DomUtils\";\nimport StringBuffer from \"./util/StringBuffer\";\nimport Point from \"./geometry/Point\";\nimport Line from \"./geometry/Line\";\nimport Shape from \"./geometry/Shape\";\nimport Rectangle from \"./geometry/Rectangle\";\nimport Ellipse from \"./geometry/Ellipse\";\nimport Link from \"./geometry/Link\";\nimport Events from \"bean\";\nimport EventDispatcher from \"./event/EventDispatcher\";\nimport Graph from \"./graph/Graph\";\nimport Cell from \"./graph/Cell\";\nimport Node from \"./graph/Node\";\nimport Edge from \"./graph/Edge\";\nimport Layout from \"./layout/Layout\";\nimport FlowLayout from \"./layout/FlowLayout\";\nimport Label from \"./view/Label\";\nimport Marker from \"./view/Marker\";\nimport Renderer from \"./view/Renderer\";\nimport SVGRenderer from \"./view/SVGRenderer\";\nimport GraphBehavior from \"./behavior/GraphBehavior\";\nimport SelectionBehavior from \"./behavior/SelectionBehavior\";\n\nShape.addShape(\"Rectangle\", Rectangle);\nShape.addShape(\"Ellipse\", Ellipse);\n\nexport default {\n\tEvents,\n\tBase64,\n\tCache,\n\tUtils,\n\tDomUtils,\n\tStringBuffer,\n\tPoint,\n\tLine,\n\tShape,\n\tRectangle,\n\tEllipse,\n\tLink,\n\tEventDispatcher,\n\tLabel,\n\tMarker,\n\tGraph,\n\tCell,\n\tNode,\n\tEdge,\n\tLayout,\n\tFlowLayout,\n\tRenderer,\n\tSVGRenderer,\n\tGraphBehavior,\n\tSelectionBehavior\n};\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/index.js\n **/","// http://www.webtoolkit.info/javascript-base64.html\n\nvar Base64 = {\n\n\t// private property\n\t_keyStr : \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=\",\n\n\t// public method for encoding\n\tencode : function (input) {\n\t\tvar output = \"\";\n\t\tvar chr1, chr2, chr3, enc1, enc2, enc3, enc4;\n\t\tvar i = 0;\n\n\t\tinput = Base64._utf8_encode(input);\n\n\t\twhile (i < input.length) {\n\n\t\t\tchr1 = input.charCodeAt(i++);\n\t\t\tchr2 = input.charCodeAt(i++);\n\t\t\tchr3 = input.charCodeAt(i++);\n\n\t\t\tenc1 = chr1 >> 2;\n\t\t\tenc2 = ((chr1 & 3) << 4) | (chr2 >> 4);\n\t\t\tenc3 = ((chr2 & 15) << 2) | (chr3 >> 6);\n\t\t\tenc4 = chr3 & 63;\n\n\t\t\tif (isNaN(chr2)) {\n\t\t\t\tenc3 = enc4 = 64;\n\t\t\t} else if (isNaN(chr3)) {\n\t\t\t\tenc4 = 64;\n\t\t\t}\n\n\t\t\toutput = output +\n\t\t\tthis._keyStr.charAt(enc1) + this._keyStr.charAt(enc2) +\n\t\t\tthis._keyStr.charAt(enc3) + this._keyStr.charAt(enc4);\n\n\t\t}\n\n\t\treturn output;\n\t},\n\n\t// public method for decoding\n\tdecode : function (input) {\n\t\tvar output = \"\";\n\t\tvar chr1, chr2, chr3;\n\t\tvar enc1, enc2, enc3, enc4;\n\t\tvar i = 0;\n\n\t\tinput = input.replace(/[^A-Za-z0-9\\+\\/\\=]/g, \"\");\n\n\t\twhile (i < input.length) {\n\n\t\t\tenc1 = this._keyStr.indexOf(input.charAt(i++));\n\t\t\tenc2 = this._keyStr.indexOf(input.charAt(i++));\n\t\t\tenc3 = this._keyStr.indexOf(input.charAt(i++));\n\t\t\tenc4 = this._keyStr.indexOf(input.charAt(i++));\n\n\t\t\tchr1 = (enc1 << 2) | (enc2 >> 4);\n\t\t\tchr2 = ((enc2 & 15) << 4) | (enc3 >> 2);\n\t\t\tchr3 = ((enc3 & 3) << 6) | enc4;\n\n\t\t\toutput = output + String.fromCharCode(chr1);\n\n\t\t\tif (enc3 != 64) {\n\t\t\t\toutput = output + String.fromCharCode(chr2);\n\t\t\t}\n\t\t\tif (enc4 != 64) {\n\t\t\t\toutput = output + String.fromCharCode(chr3);\n\t\t\t}\n\n\t\t}\n\n\t\toutput = Base64._utf8_decode(output);\n\n\t\treturn output;\n\n\t},\n\n\t// private method for UTF-8 encoding\n\t_utf8_encode : function (string) {\n\t\tstring = string.replace(/\\r\\n/g,\"\\n\");\n\t\tvar utftext = \"\";\n\n\t\tfor (var n = 0; n < string.length; n++) {\n\n\t\t\tvar c = string.charCodeAt(n);\n\n\t\t\tif (c < 128) {\n\t\t\t\tutftext += String.fromCharCode(c);\n\t\t\t}\n\t\t\telse if((c > 127) && (c < 2048)) {\n\t\t\t\tutftext += String.fromCharCode((c >> 6) | 192);\n\t\t\t\tutftext += String.fromCharCode((c & 63) | 128);\n\t\t\t}\n\t\t\telse {\n\t\t\t\tutftext += String.fromCharCode((c >> 12) | 224);\n\t\t\t\tutftext += String.fromCharCode(((c >> 6) & 63) | 128);\n\t\t\t\tutftext += String.fromCharCode((c & 63) | 128);\n\t\t\t}\n\n\t\t}\n\n\t\treturn utftext;\n\t},\n\n\t// private method for UTF-8 decoding\n\t_utf8_decode : function (utftext) {\n\t\tvar string = \"\";\n\t\tvar i = 0;\n\t\tvar c = c1 = c2 = 0;\n\n\t\twhile ( i < utftext.length ) {\n\n\t\t\tc = utftext.charCodeAt(i);\n\n\t\t\tif (c < 128) {\n\t\t\t\tstring += String.fromCharCode(c);\n\t\t\t\ti++;\n\t\t\t}\n\t\t\telse if((c > 191) && (c < 224)) {\n\t\t\t\tc2 = utftext.charCodeAt(i+1);\n\t\t\t\tstring += String.fromCharCode(((c & 31) << 6) | (c2 & 63));\n\t\t\t\ti += 2;\n\t\t\t}\n\t\t\telse {\n\t\t\t\tc2 = utftext.charCodeAt(i+1);\n\t\t\t\tc3 = utftext.charCodeAt(i+2);\n\t\t\t\tstring += String.fromCharCode(((c & 15) << 12) | ((c2 & 63) << 6) | (c3 & 63));\n\t\t\t\ti += 3;\n\t\t\t}\n\n\t\t}\n\n\t\treturn string;\n\t}\n\n};\n\nexport default Base64;\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/util/base64.js\n **/","import Point from \"../geometry/Point\";\nimport Rectangle from \"../geometry/Rectangle\";\n\n// bean requires the existence of window\nif (typeof window === 'undefined' && typeof global !== 'undefined') {\n\tglobal.window = { addEventHandler: function() {} };\n\tglobal.document = {};\n\tglobal.navigator = {};\n}\n\n// util variables\nlet _debugging = [], _debugAll = false, typeRegistry = {}, splice = Array.splice;\n\n/**\n * Utility functions\n */\nexport default {\n\ttype: function (namespace, name, type) {\n\t\tif (!typeRegistry[namespace])\n\t\t\ttypeRegistry[namespace] = new Map();\n\t\tif (!name)\n\t\t\treturn typeRegistry[namespace];\n\t\tif (!type)\n\t\t\treturn typeRegistry[namespace].get(name);\n\t\ttypeRegistry[namespace].set(name, type);\n\t},\n\n\tcreateType: function (namespace, props, defaultType) {\n\t\tlet name = props.name;\n\n\t\t// first check if type exists\n\t\tlet type = this.type(namespace, name);\n\t\tif (!type) {\n\t\t\tlet extend = props.extends ? this.type(namespace, props.extends) : null;\n\t\t\tif (!extend && defaultType)\n\t\t\t\textend = defaultType;\n\t\t\tif (extend)\n\t\t\t\ttype = class extends extend {\n\t\t\t\t};\n\t\t\telse {\n\t\t\t\ttype = class {\n\t\t\t\t\tconstructor(config) {\n\t\t\t\t\t\t_.assign(this, config);\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t}\n\t\t\tdelete props.name;\n\t\t\tdelete props.extends;\n\t\t\t_.assign(type.prototype, props);\n\t\t\ttype.typeName = name;\n\t\t\tthis.type(namespace, name, type);\n\t\t\tthis.log('Utils', 'Utils.createType - ' + namespace + '.' + name);\n\t\t}\n\t\treturn type;\n\t},\n\n\tbuildTypes: function (types, namespace, defaultType) {\n\t\tthis.log('Utils', 'Utils.buildTypes - ' + namespace);\n\n\t\tif (!types && defaultType) {\n\t\t\tthis.createType(namespace, defaultType);\n\t\t\tthis.log('Utils', 'Utils.buildTypes end');\n\t\t\treturn;\n\t\t}\n\t\tif (defaultType) {\n\t\t\tlet type = _.remove(types, {name: defaultType.name});\n\t\t\ttype = type.length > 0 ? type[0] : null;\n\t\t\tif (type)\n\t\t\t\tdefaultType = this.createType(namespace, _.defaultsDeep(type, defaultType));\n\t\t\telse\n\t\t\t\tdefaultType = this.createType(namespace, defaultType);\n\t\t}\n\n\t\t_.forEach(types, (type) => {\n\t\t\tthis.createType(namespace, type, defaultType);\n\t\t});\n\t\tthis.log('Utils', 'Utils.buildTypes end');\n\t},\n\n\t// Helper function to correctly set up the prototype chain, for subclasses.\n\t// Similar to `goog.inherits`, but uses a hash of prototype properties and\n\t// class properties to be extended.\n\textend: function (child, parent, protoProps, staticProps) {\n\t\t// Add static properties to the constructor function, if supplied.\n\t\t_.extend(child, parent, staticProps);\n\n\t\t// Set the prototype chain to inherit from `parent`, without calling\n\t\t// `parent`'s constructor function.\n\t\tvar Surrogate = function () {\n\t\t\tthis.constructor = child;\n\t\t};\n\t\tSurrogate.prototype = parent.prototype;\n\t\tchild.prototype = new Surrogate;\n\n\t\t// Add prototype properties (instance properties) to the subclass,\n\t\t// if supplied.\n\t\tif (protoProps) _.extend(child.prototype, protoProps);\n\n\t\t// Set a convenience property in case the parent's prototype is needed later.\n\t\tchild.superclass = parent.prototype;\n\n\t\treturn child;\n\t},\n\n\tinitConfig: function (obj, config) {\n\t\tlet props = {}, c = obj.constructor, cArr = [c];\n\t\twhile (c) {\n\t\t\tif (c.super) {\n\t\t\t\tc = c.super.constructor;\n\t\t\t\tsplice.apply(cArr, [0, 0, c]);\n\t\t\t} else\n\t\t\t\tc = null;\n\t\t}\n\n\t\tfor (let i = 0; i < cArr.length; i++) {\n\t\t\tc = cArr[i];\n\t\t\tif (c.DEFAULTS)\n\t\t\t\t_.assign(props, c.DEFAULTS);\n\t\t}\n\t\tobj.props = _.assign(props, config);\n\t\tc.prototype.prop = function (name, value) {\n\t\t\tif (!value)\n\t\t\t\treturn this.props[name];\n\t\t\tthis.props[name] = value;\n\t\t};\n\t},\n\n\t/**\n\t * Gets the JS class constructor.\n\t * @param {Object} jsClass\n\t * @param {Object} defaultClass\n\t */\n\tgetConstructor: function (jsClass, defaultClass) {\n\t\tif (!jsClass)\n\t\t\tjsClass = defaultClass;\n\n\t\tif (_.isString(jsClass))\n\t\t\tjsClass = eval(jsClass);\n\t\treturn jsClass;\n\t},\n\n\tdebug: function (moduleName) {\n\t\tif (moduleName) {\n\t\t\t_debugging.push(moduleName);\n\t\t} else {\n\t\t\t_debugAll = true;\n\t\t}\n\t},\n\n\tlog: function (name, message) {\n\t\tif (!window.console) {\n\t\t\treturn;\n\t\t}\n\t\tvar debug = _debugAll;\n\t\tif (!_debugAll) {\n\t\t\tdebug = false;\n\t\t\tfor (var i = 0; i < _debugging.length; i++) {\n\t\t\t\tif (_debugging[i] == name) debug = true;\n\t\t\t}\n\t\t}\n\t\tif (!debug) {\n\t\t\treturn;\n\t\t}\n\t\twhile (name.length < 10) {\n\t\t\tname = name + ' ';\n\t\t}\n\t\tname = name.substring(0, 10) + \" - \";\n\t\tconsole.info(name, message);\n\t},\n\n\t/**\n\t * Get the relative position of sub shapes within a parent share.\n\t * @param bounds\n\t * @param geometry The geometry information, the format of Geometry is:\n\t * {\n\t *      x: \"x coordinate of ref point, if less than 1, will be treated as the percentage of the parent width.\",\n\t *      y: \"y coordinate of ref point.\",\n\t *      anchorX: \"x pos of child relative to the ref point\",\n\t *      anchorY: \"y pos of child relative to the ref point\",\n\t *      offsetX: \"the offset in the x direction.\",\n\t *      offsetY: \"the offset in the y direction.\",\n\t *      width: \"the width of the child element\",\n\t *      height: \"the height of the child element\"\n\t * }\n\t * @returns {*[]}\n\t */\n\tgetRelativePosition: function (bounds, geometry) {\n\t\tlet x = Math.abs(geometry.x) <= 1 ? bounds.width * geometry.x : geometry.x;\n\t\tlet y = Math.abs(geometry.y) <= 1 ? bounds.height * geometry.y : geometry.y;\n\t\treturn this.offsetPosition([x, y], geometry);\n\t},\n\n\toffsetPosition: function (pos, geometry) {\n\t\treturn [pos[0] + geometry.width * geometry.anchorX + geometry.offsetX, pos[1] + geometry.height * geometry.anchorY + geometry.offsetY];\n\t},\n\n\t/**\n\t * Get the position relative to the graph that's unscaled, i.e., absolute position without considering translation and scale.\n\t * @param t the current translate\n\t * @param scale the current scale\n\t * @param o can be either a Point or a Rectangle or a Point array.\n\t */\n\tunscale: function (t, scale, o) {\n\t\tif (o instanceof Rectangle)\n\t\t\treturn new Rectangle(o.x * scale + t[0], o.y * scale + t[1], o.width * scale, o.height * scale);\n\t\telse if (o instanceof Point)\n\t\t\treturn new Point(o.x * scale + t[0], o.y * scale + t[1]);\n\t\telse\n\t\t\treturn [o[0] * scale + t[0], o[1] * scale + t[1]];\n\t},\n\n\t/**\n\t * Get the position relative to the graph that's scaled, i.e., relative position considering translation and scale.\n\t * @param t the current translation\n\t * @param scale the current scale\n\t * @param o can be either a Point or a Rectangle or a Point array.\n\t */\n\tscale: function (t, scale, o) {\n\t\tif (o instanceof Rectangle)\n\t\t\treturn new Rectangle((o.x - t[0]) / scale, (o.y - t[1]) / scale, o.width / scale, o.height / scale);\n\t\telse if (o instanceof Point)\n\t\t\treturn new Point((o.x - t[0]) / scale, (o.y - t[1]) / scale);\n\t\telse\n\t\t\treturn [(o[0] - t[0]) / scale, (o[1] - t[1]) / scale];\n\t},\n\n\t/**\n\t * Convenience method.\n\t */\n\tgetProperty: function (obj, prop) {\n\t\tif (!obj)\n\t\t\treturn null;\n\t\tif (_.has(obj, prop))\n\t\t\treturn obj[prop];\n\t\tif (obj.prop && _.isFunction(obj.prop))\n\t\t\treturn obj.prop(prop);\n\t\treturn null;\n\t}\n};\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/util/Utils.js\n **/","class Point {\n\tconstructor(x, y) {\n\t\tthis.x = x;\n\t\tthis.y = y;\n\t}\n\n\t/**\n\t * Make a clone of this point\n\t */\n\tclone() {\n\t\treturn new Point(this.x, this.y);\n\t}\n\n\t/**\n\t * Calculate the distance from this pt to the other pt.\n\t * @param aPt\n\t * @returns {number}\n\t */\n\tdistance(aPt) {\n\t\treturn Math.sqrt((this.x - aPt.x) * (this.x - aPt.x) + (this.y - aPt.y) * (this.y - aPt.y));\n\t}\n\n\t/**\n\t * Translate this point\n \t */\n\ttranslate(p2) {\n\t\tthis.x += p2.x;\n\t\tthis.y += p2.y;\n\t\treturn this;\n\t}\n\n\t/**\n\t * Scale this vector\n \t */\n\tscale(scale) {\n\t\tthis.x *= scale;\n\t\tthis.y *= scale;\n\t\treturn this;\n\t}\n\n\tgetScaled(scale) {\n\t\treturn new Point(this.x * scale, this.y * scale);\n\t}\n\n\tgetTranslated(p2) {\n\t\treturn new Point(this.x + p2.x, this.y + p2.y);\n\t}\n\n\t/**\n\t * Get the direction vector from this point to p2.\n\t * @param p2\n\t * @returns {Point}\n\t */\n\tgetDirection(p2) {\n\t\tvar dist = this.distance(p2);\n\t\treturn new Point((p2.x - this.x) / dist, (p2.y - this.y) / dist);\n\t}\n\n\t/**\n\t * rotate the point about the origin. With the specified angle.\n\t * @param angle the angle to rotate\n\t */\n\trotate(angle) {\n\t\tvar cos = Math.cos(angle * Math.PI / 180);\n\t\tvar sin = Math.sin(angle * Math.PI / 180);\n\t\tvar x = this.x, y = this.y;\n\t\tthis.x = x * cos - y * sin;\n\t\tthis.y = x * sin + y * cos;\n\t\treturn this;\n\t}\n\n\tgetRotated(angle) {\n\t\treturn this.clone().rotate(angle);\n\t}\n\n\t/**\n\t * Calculate the dot product, treating this and p2 as vectors.\n\t */\n\tdotProduct(p2) {\n\t\treturn this.x * p2.x + this.y * p2.y;\n\t}\n\n\t/**\n\t * Get the mid point between this and p2.\n \t */\n\tgetMidPoint(p2) {\n\t\treturn new Point((this.x + p2.x) / 2, (this.y + p2.y) / 2);\n\t}\n\n\treverse() {\n\t\tthis.x = -this.x;\n\t\tthis.y = -this.y;\n\t\treturn this;\n\t}\n\n\tequals(p2) {\n\t\tif (!p2 || p2.constructor != Point) return false;\n\n\t\treturn (this.x == p2.x && this.y == p2.y);\n\t}\n\n\t/**\n\t * Reflect this point w.r.t. the rectangle.\n\t * If vertical is true, it will reflect the point cross the vertical\n\t * central line of the rectangle, otherwise reflect cross the horizontal\n\t * central line.\n\t *\n\t * @param rect the rectangle\n\t * @param vertical whether is vertical reflection or horizontal reflection.\n\t */\n\treflect(rect, vertical) {\n\t\tif (vertical)\n\t\t\tthis.x = 2 * rect.x - this.x;\n\t\telse\n\t\t\tthis.y = 2 * rect.y - this.y;\n\t\treturn this;\n\t}\n\n\ttoString() {\n\t\treturn this.x + \",\" + this.y;\n\t}\n}\n\nPoint.W = new Point(-1, 0);\nPoint.N = new Point(0, -1);\nPoint.S = new Point(0, 1);\nPoint.E = new Point(1, 0);\nPoint.NE = new Point(1, -1);\nPoint.NW = new Point(-1, -1);\nPoint.SE = new Point(1, 1);\nPoint.SW = new Point(-1, 1);\n\nexport default Point;\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/geometry/Point.js\n **/","import _ from \"lodash\";\r\nimport Point from \"./Point\";\r\nimport Shape from \"./Shape\";\r\n\r\nexport default class Rectangle extends Shape {\r\n\t/**\r\n\t * Checks whether this rectangle contains a given point of a given rectangle\r\n\t */\r\n\tcontains(el) {\r\n\t\tlet w = el.width || 0;\r\n\t\tlet h = el.height || 0;\r\n\t\tlet left = el.x - w/2;\r\n\t\tlet right = el.x + w/2;\r\n\t\tlet top = el.y - h/2;\r\n\t\tlet bottom = el.y + h/2;\r\n\t\treturn (right <= this.right) && (left >= this.left) &&\r\n\t\t\t(top >= this.top) && (bottom <= this.bottom);\r\n\t}\r\n\r\n\t/**\r\n\t * Calcualte the distance to a point. 0 if this rectangle contains the point.\r\n\t */\r\n\tdistance(pt) {\r\n\t\tif (this.contains(pt)) return 0;\r\n\r\n\t\tif (pt.x < this.left) {\r\n\t\t\tif (pt.y < this.top)\r\n\t\t\t\treturn pt.distance(new Point(this.left, this.top));\r\n\t\t\tif (pt.y <= this.bottom)\r\n\t\t\t\treturn this.left - pt.x;\r\n\t\t\treturn pt.distance(new Point(this.left, this.bottom));\r\n\t\t}\r\n\t\tif (pt.x <= this.right) {\r\n\t\t\tif (pt.y <= this.top)\r\n\t\t\t\treturn this.top - pt.y;\r\n\t\t\treturn pt.y - this.bottom;\r\n\t\t}\r\n\t\tif (pt.y < this.top)\r\n\t\t\treturn pt.distance(new Point(this.right, this.top));\r\n\t\tif (pt.y <= this.bottom)\r\n\t\t\treturn pt.x - this.right;\r\n\t\treturn pt.distance(new Point(this.right, this.bottom));\r\n\t}\r\n\r\n\t/**\r\n\t * Given two points, we want to detect whether the line joining the pts intersect\r\n\t * with the rectangle or not. We assume only horizontal or vertical line segments.\r\n\t *\r\n\t * @return int the side of the intersection: -1: no intersection, 0: left, 1: top, 2: right, 3: bottom, 4: containment.\r\n\t */\r\n\tdetectIntersection(pt1, pt2) {\r\n\t\tlet horizontal = pt1.y == pt2.y;\r\n\t\tlet contains1 = this.contains(pt1);\r\n\t\tlet contains2 = this.contains(pt2);\r\n\t\tif (contains1 && contains2) return 4;\r\n\t\tif (!contains1 && !contains2) {\r\n\t\t\tif (horizontal && (pt1.y >= this.top && pt1.y <= this.bottom)) {\r\n\t\t\t\tif (pt1.x < this.left && pt2.x > this.right)\r\n\t\t\t\t\treturn 0;\r\n\t\t\t\tif (pt1.x > this.right && pt2.x < this.left)\r\n\t\t\t\t\treturn 2;\r\n\t\t\t}\r\n\t\t\tif (!horizontal && (pt1.x >= this.left && pt1.x <= this.right)) {\r\n\t\t\t\tif (pt1.y < this.top && pt2.y > this.bottom)\r\n\t\t\t\t\treturn 1;\r\n\t\t\t\tif (pt1.y > this.bottom && pt2.y < this.top)\r\n\t\t\t\t\treturn 3;\r\n\t\t\t}\r\n\t\t\treturn -1;\r\n\t\t}\r\n\r\n\t\tlet outPt = contains1 ? pt2 : pt1;\r\n\t\tif (horizontal) {\r\n\t\t\tif (outPt.x > this.right)\r\n\t\t\t\treturn 2;\r\n\t\t\treturn 0;\r\n\t\t} else {\r\n\t\t\tif (outPt.y < this.top)\r\n\t\t\t\treturn 1;\r\n\t\t\treturn 3;\r\n\t\t}\r\n\t}\r\n\r\n\ttoString() {\r\n\t\treturn 'Rectangle:{x=' + this.x + ';y=' + this.y + ';width=' + this.width + ';height=' + this.height + '}';\r\n\t}\r\n\r\n\tstatic getPerimeter(rect, pt, orthogonal = false) {\r\n\t\tlet x = rect.x;\r\n\t\tlet y = rect.y;\r\n\t\tlet dx = pt.x - x;\r\n\t\tlet dy = pt.y - y;\r\n\t\tlet alpha = Math.atan2(dy, dx);\r\n\t\tlet p = new Point(0, 0);\r\n\t\tlet pi = Math.PI;\r\n\t\tlet pi2 = Math.PI/2;\r\n\t\tlet beta = pi2 - alpha;\r\n\t\tlet t = Math.atan2(rect.height, rect.width);\r\n\r\n\t\tif (alpha < -pi + t || alpha > pi - t) {\r\n\t\t\t// Left edge\r\n\t\t\tp.x = rect.left;\r\n\t\t\tp.y = y - rect.width * Math.tan(alpha) / 2;\r\n\t\t} else if (alpha < -t) {\r\n\t\t\t// Top Edge\r\n\t\t\tp.y = rect.top;\r\n\t\t\tp.x = x - rect.height * Math.tan(beta) / 2;\r\n\t\t} else if (alpha < t) {\r\n\t\t\t// Right Edge\r\n\t\t\tp.x = rect.right;\r\n\t\t\tp.y = y + rect.width * Math.tan(alpha) / 2;\r\n\t\t} else {\r\n\t\t\t// Bottom Edge\r\n\t\t\tp.y = rect.bottom;\r\n\t\t\tp.x = x + rect.height * Math.tan(beta) / 2;\r\n\t\t}\r\n\r\n\t\tif (orthogonal) {\r\n\t\t\tif (alpha < -pi + t || alpha > pi - t) {\r\n\t\t\t\t// Left edge\r\n\t\t\t\tp.x = rect.left;\r\n\t\t\t\tp.y = y;\r\n\t\t\t} else if (alpha < -t) {\r\n\t\t\t\t// Top Edge\r\n\t\t\t\tp.y = rect.top;\r\n\t\t\t\tp.x = x;\r\n\t\t\t} else if (alpha < t) {\r\n\t\t\t\t// Right Edge\r\n\t\t\t\tp.x = rect.right;\r\n\t\t\t\tp.y = y;\r\n\t\t\t} else {\r\n\t\t\t\t// Bottom Edge\r\n\t\t\t\tp.y = rect.bottom;\r\n\t\t\t\tp.x = x;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tlet dir = Rectangle.getDirection(rect, p, orthogonal);\r\n\t\treturn {point: p, direction: dir};\r\n\t}\r\n\r\n\t/**\r\n\t * Return the bounding rectangle that contains p1 and p2\r\n\t */\r\n\tstatic getBoundingRectangle(pts, margin) {\r\n\t\tif (!pts || pts.length == 0) return null;\r\n\t\tmargin = margin || [0, 0, 0, 0];\r\n\t\tif (!_.isArray(margin))\r\n\t\t\tmargin = [margin, margin, margin, margin];\r\n\t\tlet min = [pts[0].x, pts[0].y];\r\n\t\tlet max = [pts[0].x, pts[0].y];\r\n\t\tfor (let i = 1; i < pts.length; i++) {\r\n\t\t\tlet p = pts[i];\r\n\t\t\tif (p.x < min[0]) {\r\n\t\t\t\tmin[0] = p.x;\r\n\t\t\t}\r\n\t\t\tif (p.y < min[1]) {\r\n\t\t\t\tmin[1] = p.y;\r\n\t\t\t}\r\n\t\t\tif (p.x > max[0]) {\r\n\t\t\t\tmax[0] = p.x;\r\n\t\t\t}\r\n\t\t\tif (p.y > max[1]) {\r\n\t\t\t\tmax[1] = p.y;\r\n\t\t\t}\r\n\t\t}\r\n\t\tmin[0] = min[0] - margin[0];\r\n\t\tmin[1] = min[1] - margin[1];\r\n\t\tmax[0] = max[0] + margin[2];\r\n\t\tmax[1] = max[1] + margin[3];\r\n\t\tlet w = Math.abs(max[0] - min[0]);\r\n\t\tlet h = Math.abs(max[1] - min[1]);\r\n\t\treturn new Rectangle(min[0] + w/2, min[1] + h/2, w, h);\r\n\t}\r\n\r\n\t/**\r\n\t * Create a union of all the rectangles.\r\n\t * @param rects\r\n\t */\r\n\tstatic union(rects) {\r\n\t\tlet minx = null, miny = null, maxx = -Infinity, maxy = -Infinity;\r\n\t\t_.each(rects, function (rect) {\r\n\t\t\tminx = minx || rect.x;\r\n\t\t\tminy = miny || rect.y;\r\n\t\t\tminx = Math.min(minx, rect.x);\r\n\t\t\tminy = Math.min(miny, rect.y);\r\n\t\t\tmaxx = Math.max(maxx, rect.right());\r\n\t\t\tmaxy = Math.max(maxy, rect.bottom());\r\n\t\t});\r\n\t\tminx = minx || 0;\r\n\t\tminy = miny || 0;\r\n\t\treturn new Rectangle(minx, miny, maxx - minx, maxy - miny);\r\n\t}\r\n\r\n\t/**\r\n\t * Returns the direction the point <i>p</i> is in relation to the given rectangle.\r\n\t * Possible values are WEST (-1,0), EAST (1,0), NORTH (0,-1) and SOUTH (0,1) if orthogonal is true, otherwise return\r\n\t * the direction connection the center of r and p.\r\n\t * @param r\r\n\t * @param p\r\n\t * @param orthogonal\r\n\t * @returns {Point|*}\r\n\t */\r\n\tstatic getDirection(r, p, orthogonal = false) {\r\n\t\tif (!orthogonal)\r\n\t\t\treturn new Point(r.x, r.y).getDirection(new Point(p.x, p.y));\r\n\r\n\t\tlet i, distance = Math.abs(r.left - p.x), direction = Point.W;\r\n\r\n\t\ti = Math.abs(r.top - p.y);\r\n\t\tif (i <= distance) {\r\n\t\t\tdistance = i;\r\n\t\t\tdirection = Point.N;\r\n\t\t}\r\n\r\n\t\ti = Math.abs(r.bottom - p.y);\r\n\t\tif (i <= distance) {\r\n\t\t\tdistance = i;\r\n\t\t\tdirection = Point.S;\r\n\t\t}\r\n\r\n\t\ti = Math.abs(r.right - p.x);\r\n\t\tif (i < distance) {\r\n\t\t\tdirection = Point.E;\r\n\t\t}\r\n\r\n\t\treturn direction;\r\n\t}\r\n}\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/geometry/Rectangle.js\n **/","module.exports = __WEBPACK_EXTERNAL_MODULE_5__;\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external {\"root\":\"_\",\"commonjs\":\"lodash\",\"commonjs2\":\"lodash\",\"amd\":\"lodash\"}\n ** module id = 5\n ** module chunks = 0\n **/","import _ from \"lodash\";\nimport Point from \"./Point\";\nimport Rectangle from \"./Rectangle\";\n\nlet registry = {};\n\nclass Shape {\n\tconstructor(x, y, width, height, config) {\n\t\tthis.x = x;\n\t\tthis.y = y;\n\t\tthis.width = width;\n\t\tthis.height = height;\n\t\t_.defaults(this, config, {x: 0, y: 0, width: 0, height: 0});\n\t}\n\n\t/**\n\t * Return the y-coord of the top side of this rectangle\n\t */\n\tget top() { return this.y - this.height/2; }\n\n\t/**\n\t * Returns the y-coordinate of the bottom of this Rectangle.\n\t */\n\tget bottom() { return this.y + this.height/2; }\n\n\t/**\n\t * Return the x-coord of left side of this rectangle\n\t */\n\tget left() { return this.x - this.width/2; }\n\n\t/**\n\t * Returns the x-coordinate of the right side of this Rectangle.\n\t */\n\tget right() { return this.x + this.width/2; }\n\n\tget center() { return new Point(this.x, this.y); }\n\n\tget bounds() { return new Rectangle(this.x, this.y, this.width, this.height); }\n\n\tcontains(el) { return false; }\n\n\t/**\n\t * This will generate n ports on the shape.\n\t */\n\tgetRegularPoints(n) {return null;}\n\n\t/**\n\t * Get the intersection between boundary of this shape and the line connecting (x,y) with the refPt.\n\t * @param refPt\n\t * @returns {null}\n\t */\n\tgetPerimeter(refPt, orthogonal = false) {\n\t\treturn this.constructor.getPerimeter(this, refPt, orthogonal);\n\t}\n\n\trender(view) {\n\t\tlet template = _.template(view.getTemplate(this.name, this));\n\t\treturn template(this);\n\t}\n\n\tstatic getShape(name) {\n\t\treturn registry[name];\n\t}\n\n\tstatic addShape(name, c) {\n\t\tregistry[name] = c;\n\t}\n\n\tstatic removeShape(name) {\n\t\tdelete registry[name];\n\t}\n}\n\nexport default Shape;\n\n\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/geometry/Shape.js\n **/","import _ from \"lodash\";\n\n/**\n * dom Utility functions\n */\nexport default {\n\tisIE: (function () {\n\t\tif (!window || !window.navigator || !navigator) return false;\n\t\tvar sAgent = window.navigator.userAgent;\n\t\tvar Idx = sAgent.indexOf(\"MSIE\");\n\n\t\t// If IE, return version number.\n\t\tif (Idx > 0)\n\t\t\treturn parseInt(sAgent.substring(Idx + 5, sAgent.indexOf(\".\", Idx)));\n\n\t\t// If IE 11 then look for Updated user agent string.\n\t\telse if (!!navigator.userAgent.match(/Trident\\/7\\./))\n\t\t\treturn 11;\n\t\telse\n\t\t\treturn false;\n\t})(),\n\n\tisFireFox : (function(){\n\t\t// InstallTrigger: Firefox's API to install add-ons\n\t\treturn typeof InstallTrigger !== 'undefined';\n\t})(),\n\n\tcreateElement: function (tag, attribs, styles, html) {\n\t\tlet el = document.createElement(tag);\n\t\tthis.setElement(el, attribs, styles);\n\t\tif (html)\n\t\t\tel.innerHTML = html;\n\t\treturn el;\n\t},\n\n\tcreateElementByString: function(str) {\n\t\tlet temp = this.createElement('div', null, null, str);\n\t\treturn temp.childNodes;\n\t},\n\n\tsetElement: function (el, attribs, styles) {\n\t\tif (attribs) {\n\t\t\t_.forEach(attribs, function(value, key) {\n\t\t\t    el.setAttribute(key, value);\n\t\t\t });\n\t\t}\n\t\tif (styles) {\n\t\t\t_.forEach(styles, function(value, key) {\n\t\t\t\tel.style[key] = value;\n\t\t\t});\n\t\t}\n\t},\n\n\ttestElement: function(node, method) {\n\t\treturn node && node.nodeType == 1 && ( !method || method(node) );\n\t},\n\n\tgetAncestorBy: function(node, method) {\n\t\twhile (node = node.parentNode)\n\t\t\tif (this.testElement(node, method) )\n\t\t\t\treturn node;\n\n\t\treturn null;\n\t},\n\n\t/**\n\t * Get the position of element relative to the context.\n\t * @param el the element\n\t * @param context\n\t * @returns {*[]}\n\t */\n\tgetPosition(el, context) {\n\t\tif (!context) context = document.body;\n\t\tlet elRect = el.getBoundingClientRect();\n\t\tlet contextRect = context.getBoundingClientRect();\n\n\t\treturn [elRect.left - contextRect.left, elRect.top - contextRect.top];\n\t},\n\n\tgetCenterPosition(el, context) {\n\t\tif (!context) context = document.body;\n\t\tlet elRect = el.getBoundingClientRect();\n\t\tlet contextRect = context.getBoundingClientRect();\n\t\tlet w = elRect.right - elRect.left;\n\t\tlet h = elRect.bottom - elRect.top;\n\n\t\treturn [elRect.left - contextRect.left + w/2, elRect.top - contextRect.top + h/2];\n\t},\n\n\tmove: function(el, x, y) {\n\t\tif (x) el.style.left = x + 'px';\n\t\tif (y) el.style.top = y + 'px';\n\t},\n\n\tgetSize: function(el) {\n\t\tvar w = parseInt(el.style.offsetWidth, 10);\n\t\tvar h = parseInt(el.style.offsetHeight, 10);\n\t\treturn [w, h];\n\t},\n\n\tresize: function(el, w, h) {\n\t\tif (w) el.style.width = w + \"px\";\n\t\tif (h) el.style.height = h + 'px';\n\t},\n\n\tpreloadImages: function(array) {\n\t\tif (!this.preloadImages.list) this.preloadImages.list = [];\n\t\tif (!this.preloadImages.loaded) this.preloadImages.loaded = {};\n\n\t\tvar list = this.preloadImages.list;\n\t\tvar img, that = this;\n\t\tfor (var i = 0; i < array.length; i++) {\n\t\t\timg = new Image();\n\t\t\timg.onload = function() {\n\t\t\t\tvar index = list.indexOf(this);\n\t\t\t\tif (index !== -1) {\n\t\t\t\t\tthat.preloadImages.loaded[this.name] = {width: this.width, height: this.height};\n\t\t\t\t\t// remove image from the array once it's loaded\n\t\t\t\t\t// for memory consumption reasons\n\t\t\t\t\tlist.splice(index, 1);\n\t\t\t\t}\n\t\t\t};\n\t\t\tlist.push(img);\n\t\t\timg.src = array[i];\n\t\t\timg.name = array[i];\n\t\t}\n\t},\n\n\t/**\n\t * Get's the image's information given the url. Must be preloaded by calling the preloadImage function.\n\t * @param src\n\t */\n\tgetImageInfo: function(src) {\n\t\tif (this.preloadImages.loaded) {\n\t\t\treturn this.preloadImages.loaded[src];\n\t\t}\n\t\treturn null;\n\t},\n\n\tdownloadImage: function(name, image) {\n\t\tif (!image) return;\n\t\tlet mime = image.match(/^data:([^;]*)/)[1];\n\t\tlet type = mime.split('/')[1];\n\t\tif (type.indexOf('+') > 0) type = type.split('+')[0];\n\t\tif (this.isIE) {\n\t\t\timage = this.b64toBlob(image.replace('data:' + mime + ';base64,', ''), mime);\n\t\t\tnavigator.msSaveBlob(image, name + '.' + type);\n\t\t} else {\n\t\t\tlet link = this.createElement('a', {href: image, download: name + '.' + type}, {display: \"none\"});\n\t\t\tdocument.body.appendChild(link);\n\t\t\tlink.click();\n\t\t\tlink.parentNode.removeChild(link);\n\t\t}\n\t},\n\n\t/**\n\t * Convert b54 to blob. IE only\n\t */\n\tb64toBlob: function (b64Data, contentType, sliceSize) {\n\t\tcontentType = contentType || '';\n\t\tsliceSize = sliceSize || 512;\n\n\t\tvar byteCharacters = atob(b64Data);\n\t\tvar byteArrays = [];\n\n\t\tfor (var offset = 0; offset < byteCharacters.length; offset += sliceSize) {\n\t\t\tvar slice = byteCharacters.slice(offset, offset + sliceSize);\n\n\t\t\tvar byteNumbers = new Array(slice.length);\n\t\t\tfor (var i = 0; i < slice.length; i++) {\n\t\t\t\tbyteNumbers[i] = slice.charCodeAt(i);\n\t\t\t}\n\t\t\tvar byteArray = new Uint8Array(byteNumbers);\n\t\t\tbyteArrays.push(byteArray);\n\t\t}\n\t\treturn new Blob(byteArrays, {type: contentType});\n\t},\n\n\topenImage: function(name, image) {\n\t\tvar myWindow = window.open(\"\", \"_blank\", \"toolbar=yes, scrollbars=yes, resizable=yes, width=500, height=500\");\n\t\tvar myDocument = myWindow.document;\n\t\tvar img = myDocument.createElement(\"img\");\n\t\tthis.setElement(img, {src: image, name: name});\n\t\tmyDocument.body.appendChild(img);\n\t},\n\n\t/**\n\t * Check whether the key event is from input, textarea or select.\n\t * @param e  input event\n\t */\n\teventFromInput: function(e){\n\t\tvar tagName = e.target.tagName;\n\t\treturn (tagName == 'INPUT' || tagName == 'TEXTAREA' || tagName == 'SELECT');\n\t}\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/util/DomUtils.js\n **/","import _ from \"lodash\";\n\n/**\n * A string buffer for fast string manipulation\n */\nexport default class StringBuffer {\n\tconstructor(str) {\n\t\tthis.buffer = [];\n\t\tif (str)\n\t\t\tthis.buffer.push(str);\n\t}\n\n\tappend(stuff) {\n\t\tif (_.isString(stuff))\n\t\t\tthis.buffer.push(stuff);\n\t\telse if (_.isArray(stuff))\n\t\t\tthis.buffer = this.buffer.concat(stuff);\n\t\telse\n\t\t\tthis.buffer.push(\"\" + stuff);\n\t\treturn this;\n\t}\n\n\tprepend(stuff) {\n\t\tif (_.isString(stuff))\n\t\t\tthis.buffer.splice(0, 0, stuff);\n\t\telse if (_.isArray(stuff))\n\t\t\tthis.buffer = stuff.concat(this.buffer);\n\t\telse\n\t\t\tthis.buffer.splice(0, 0, \"\" + stuff);\n\t\treturn this;\n\t}\n\n\tclear() {\n\t\tthis.buffer = [];\n\t}\n\n\tremoveLast() {\n\t\tthis.buffer.pop();\n\t\treturn this;\n\t}\n\n\ttoString(sep) {\n\t\tif (!sep) sep = '';\n\t\treturn this.buffer.join(sep);\n\t}\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/util/StringBuffer.js\n **/","import Point from \"./Point\";\n\nexport default class Line {\n\tconstructor(start, end) {\n\t\tthis.start = start;\n\t\tthis.end = end;\n\t}\n\n\t/**\n\t * Calculate the length of this line\n\t */\n\tlength() {\n\t\treturn this.start.distance(this.end);\n\t}\n\n\t/**\n\t * Calculate the distance of this line to the point.\n\t */\n\tdistance(pt) {\n\t\tvar x = this.start.distance(pt);\n\t\tif (x == 0) return 0;\n\n\t\tvar l = this.length();\n\t\tvar cosa = new Point((this.end.x - this.start.x) / l, (this.end.y - this.start.y) / l).dotProduct(\n\t\t\tnew Point(pt.x / x, pt.y / x));\n\n\t\treturn x * Math.sqrt(1 - cosa * cosa);\n\t}\n\n\t/**\n\t * Function: intersection\n\t *\n\t * Returns the intersection of two lines as an <mxPoint>.\n\t *\n\t * Parameters:\n\t *\n\t * x0 - X-coordinate of the first line's startpoint.\n\t * y0 - X-coordinate of the first line's startpoint.\n\t * x1 - X-coordinate of the first line's endpoint.\n\t * y1 - Y-coordinate of the first line's endpoint.\n\t * x2 - X-coordinate of the second line's startpoint.\n\t * y2 - Y-coordinate of the second line's startpoint.\n\t * x3 - X-coordinate of the second line's endpoint.\n\t * y3 - Y-coordinate of the second line's endpoint.\n\t */\n\tstatic intersection(x0, y0, x1, y1, x2, y2, x3, y3) {\n\t\tvar denom = ((y3 - y2) * (x1 - x0)) - ((x3 - x2) * (y1 - y0));\n\t\tvar nume_a = ((x3 - x2) * (y0 - y2)) - ((y3 - y2) * (x0 - x2));\n\t\tvar nume_b = ((x1 - x0) * (y0 - y2)) - ((y1 - y0) * (x0 - x2));\n\n\t\tvar ua = nume_a / denom;\n\t\tvar ub = nume_b / denom;\n\n\t\tif (ua >= 0.0 && ua <= 1.0 && ub >= 0.0 && ub <= 1.0) {\n\t\t\t// Get the intersection point\n\t\t\tvar intersectionX = x0 + ua * (x1 - x0);\n\t\t\tvar intersectionY = y0 + ua * (y1 - y0);\n\n\t\t\treturn new Point(intersectionX, intersectionY);\n\t\t}\n\n\t\t// No intersection\n\t\treturn null;\n\t}\n\n\ttoString() {\n\t\treturn 'Line:{start=' + this.start + ';end=' + this.end + '}';\n\t}\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/geometry/Line.js\n **/","import Shape from \"./Shape\";\r\nimport Point from \"./Point\";\r\nimport Rectangle from \"./Rectangle\";\r\n\r\nexport default class Ellipse extends Shape {\r\n\ttoString() {\r\n\t\treturn 'Ellipse:{x=' + this.x + ';y=' + this.y + ';width=' + this.width + ';height=' + this.height + '}';\r\n\t}\r\n\r\n\tstatic getPerimeter(rect, pt, orthogonal = false) {\r\n\t\tvar a = rect.width / 2;\r\n\t\tvar b = rect.height / 2;\r\n\t\tvar cx = rect.x;\r\n\t\tvar cy = rect.y;\r\n\t\tvar px = pt.x;\r\n\t\tvar py = pt.y;\r\n\r\n\t\t// Calculates straight line equation through\r\n\t\t// point and ellipse center y = d * x + h\r\n\t\tvar dx = parseInt(px - cx);\r\n\t\tvar dy = parseInt(py - cy);\r\n\r\n\t\tvar tx, ty;\r\n\r\n\t\tif (dx == 0 && dy != 0) {\r\n\t\t\treturn new Point(cx, cy + b * dy / Math.abs(dy));\r\n\t\t} else if (dx == 0 && dy == 0) {\r\n\t\t\treturn new Point(px, py);\r\n\t\t}\r\n\r\n\t\t// Calculates intersection\r\n\t\tvar d = dy / dx;\r\n\t\tvar h = cy - d * cx;\r\n\t\tvar e = a * a * d * d + b * b;\r\n\t\tvar f = -2 * cx * e;\r\n\t\tvar g = a * a * d * d * cx * cx + b * b * cx * cx - a * a * b * b;\r\n\t\tvar det = Math.sqrt(f * f - 4 * e * g);\r\n\r\n\t\t// Two solutions (perimeter points)\r\n\t\tvar xout1 = (-f + det) / (2 * e);\r\n\t\tvar xout2 = (-f - det) / (2 * e);\r\n\t\tvar yout1 = d * xout1 + h;\r\n\t\tvar yout2 = d * xout2 + h;\r\n\t\tvar dist1 = Math.sqrt(Math.pow((xout1 - px), 2) + Math.pow((yout1 - py), 2));\r\n\t\tvar dist2 = Math.sqrt(Math.pow((xout2 - px), 2) + Math.pow((yout2 - py), 2));\r\n\r\n\t\t// Correct solution\r\n\t\tvar xout = 0;\r\n\t\tvar yout = 0;\r\n\r\n\t\tif (dist1 < dist2) {\r\n\t\t\txout = xout1;\r\n\t\t\tyout = yout1;\r\n\t\t} else {\r\n\t\t\txout = xout2;\r\n\t\t\tyout = yout2;\r\n\t\t}\r\n\r\n\t\tlet p = new Point(xout, yout);\r\n\t\tlet dir = Rectangle.getDirection(rect, p, orthogonal);\r\n\t\tif (orthogonal) {\r\n\t\t\tif (dir.x == -1) {\r\n\t\t\t\treturn {point: new Point(cx - a, cy), direction: dir};\r\n\t\t\t}\r\n\t\t\tif (dir.x == 1) {\r\n\t\t\t\treturn {point: new Point(cx + a, cy), direction: dir};\r\n\t\t\t}\r\n\t\t\tif (dir.y == -1) {\r\n\t\t\t\treturn {point: new Point(cx, cy - b), direction: dir};\r\n\t\t\t}\r\n\t\t\tif (dir.y == 1) {\r\n\t\t\t\treturn {point: new Point(cx, cy + b), direction: dir};\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn {point: p, direction: dir};\r\n\t}\r\n}\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/geometry/Ellipse.js\n **/","import _ from \"lodash\";\r\nimport Point from \"./Point\";\r\nimport Utils from \"../util/Utils\";\r\n\r\nlet defaultConfig = {\r\n\ttype: \"direct\",\r\n\tshowGauge: true,\r\n\torthogonal: false\r\n};\r\n\r\nlet defaultGeometry = {\r\n\twidth: 0,\r\n\theight: 0,\r\n\tanchorX: 0,\r\n\tanchorY: 0,\r\n\toffsetX: 0,\r\n\toffsetY: 0\r\n};\r\n\r\nlet linkTypes = {};\r\n\r\nclass Link {\r\n\tconstructor(terminalVisual, shapeConfig = {}, startMarker = null, endMarker = null) {\r\n\t\tthis.start = terminalVisual[0].point;\r\n\t\tthis.end = terminalVisual[1].point;\r\n\t\tthis.startNormal = terminalVisual[0].direction;\r\n\t\tthis.endNormal = terminalVisual[1].direction;\r\n\t\tthis.startMarker = startMarker;\r\n\t\tthis.endMarker = endMarker;\r\n\t\t_.assign(this, shapeConfig);\r\n\t}\r\n\r\n\trender(view) {\r\n\t\treturn view.renderLink(this);\r\n\t}\r\n\r\n\tget points() { return null; }\r\n\tget controlPts() { return null; }\r\n\tget length() {\r\n\t\tlet points = this.points;\r\n\t\tlet i, l = 0;\r\n\t\tfor (i = 0; i < points.length - 1; i++)\r\n\t\t\tl += points[i].distance(points[i+1]);\r\n\t\treturn l;\r\n\t}\r\n\r\n\t/**\r\n\t * Calculate the position where to put modifiers or label..\r\n\t *\r\n\t * @param geometry: defines how far along the edge should the point be placed.\r\n\t * @return *[] the relative position.\r\n\t */\r\n\tgetRelativePosition(geometry) {\r\n\t\tif (_.isNumber(geometry))\r\n\t\t\tgeometry = {x: geometry};\r\n\t\tgeometry = _.defaults(geometry, defaultGeometry);\r\n\t\tlet p = geometry.x, l = this.length;\r\n\t\tif (Math.abs(p) <= 1) p *= l;\r\n\t\tif (p < 0) p = l + p;\r\n\t\tif (p > l) p = l;\r\n\r\n\t\tlet points = this.points, d, point, dir;\r\n\t\tfor (let i = 0; i < points.length - 1; i++) {\r\n\t\t\td = points[i].distance(points[i+1]);\r\n\t\t\tif (p <= d) {\r\n\t\t\t\t// we've located the line segment.\r\n\t\t\t\tpoint = points[i].clone();\r\n\t\t\t\tdir = point.getDirection(points[i+1]);\r\n\t\t\t\tpoint.translate(dir.getScaled(p));\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t\tp -= d;\r\n\t\t}\r\n\r\n\t\t// return the last point.\r\n\t\tif (!point)\r\n\t\t\tpoint = points[points.length - 1];\r\n\t\treturn Utils.offsetPosition([point.x, point.y], geometry);\r\n\t}\r\n\r\n\ttoString() {\r\n\t\treturn 'Link';\r\n\t}\r\n\r\n\tstatic getLink(terminalVisual, shapeConfig = {}, startMarker = null, endMarker = null) {\r\n\t\tshapeConfig = _.defaultsDeep(shapeConfig, defaultConfig);\r\n\t\tlet linkClass = linkTypes[shapeConfig.type];\r\n\t\tif (linkClass)\r\n\t\t\treturn new linkClass(terminalVisual, shapeConfig, startMarker, endMarker);\r\n\t\tconsole.log('link type not supported: ' + shapeConfig.type);\r\n\t\treturn null;\r\n\t}\r\n}\r\n\r\nclass DirectLink extends Link {\r\n\tget points() {\r\n\t\treturn [this.start, this.end];\r\n\t}\r\n}\r\n\r\nclass BezierLink extends Link {\r\n\tget points() {\r\n\t\treturn [this.start, this.end];\r\n\t}\r\n\r\n\tget controlPts() {\r\n\t\tlet s = this.points[0], e = this.points[1];\r\n\t\tlet pts = [];\r\n\t\tpts[0] = null;\r\n\t\tpts[1] = [];\r\n\t\tif (this.startNormal.x == 0) {\r\n\t\t\tpts[1][0] = new Point(s.x, (s.y + e.y)/2);\r\n\t\t}\r\n\t\telse {\r\n\t\t\tpts[1][0] = new Point((s.x + e.x)/2, s.y);\r\n\t\t}\r\n\t\tif (this.endNormal.x == 0) {\r\n\t\t\tpts[1][1] = new Point(e.x, (s.y + e.y)/2);\r\n\t\t}\r\n\t\telse {\r\n\t\t\tpts[1][1] = new Point((s.x + e.x)/2, e.y);\r\n\t\t}\r\n\t\treturn pts;\r\n\t}\r\n\r\n\tgetRelativePosition(geometry) {\r\n\t\tif (_.isNumber(geometry))\r\n\t\t\tgeometry = {x: geometry};\r\n\t\tgeometry = _.defaults(geometry, defaultGeometry);\r\n\t\tlet p = geometry.x, l = this.length;\r\n\t\tif (Math.abs(p) > 1) p /= l;\r\n\t\tif (p < 0) p++;\r\n\t\tif (p > 1) p--;\r\n\r\n\t\tlet pts = this.points;\r\n\t\tlet ctrlpts = this.controlPts;\r\n\t\tlet p1 = pts[0];\r\n\t\tlet p2 = ctrlpts[1][0];\r\n\t\tlet p3 = ctrlpts[1][1];\r\n\t\tlet p4 = pts[1];\r\n\r\n\t\tlet point = [(1-p)*(1-p)*(1-p) * p1.x + 3*p*(1-p)*(1-p) * p2.x + 3*p*p*(1-p) * p3.x + p*p*p * p4.x, (1-p)*(1-p)*(1-p) * p1.y + 3*p*(1-p)*(1-p) * p2.y + 3*p*p*(1-p) * p3.y + p*p*p * p4.y];\r\n\t\treturn Utils.offsetPosition([point.x, point.y], geometry);\r\n\t}\r\n}\r\n\r\nclass EntityRelations extends Link {\r\n\tget points() {\r\n\t\tvar source = Port.getBounds(edge, true);\r\n\t\tvar target = Port.getBounds(edge, false);\r\n\t\tvar isSourceLeft = target.right() < source.x;\r\n\t\tvar isTargetLeft = source.right() < target.x;\r\n\t\tvar result = [];\r\n\r\n\t\tvar x0 = (isSourceLeft) ? source.x : source.x + source.width;\r\n\t\tvar y0 = source.getCenterY();\r\n\t\tresult.push(new Point(x0, y0));\r\n\r\n\t\tvar xe = (isTargetLeft) ? target.x : target.x + target.width;\r\n\t\tvar ye = target.getCenterY();\r\n\r\n\t\tvar seg = this.segment;\r\n\r\n\t\tvar dx = (isSourceLeft) ? -seg : seg;\r\n\t\tvar dep = new Point(x0 + dx, y0);\r\n\r\n\t\tdx = (isTargetLeft) ? -seg : seg;\r\n\t\tvar arr = new Point(xe + dx, ye);\r\n\r\n\t\t// Adds intermediate points if both go out on same side\r\n\t\tif (isSourceLeft == isTargetLeft)\r\n\t\t{\r\n\t\t\tvar x = (isSourceLeft) ?\r\n\t\t\tMath.min(x0, xe)-seg :\r\n\t\t\tMath.max(x0, xe)+seg;\r\n\r\n\t\t\tresult.push(new Point(x, y0));\r\n\t\t\tresult.push(new Point(x, ye));\r\n\t\t}\r\n\t\telse if ((dep.x < arr.x) == isSourceLeft)\r\n\t\t{\r\n\t\t\tvar midY = y0 + (ye - y0) / 2;\r\n\r\n\t\t\tresult.push(dep);\r\n\t\t\tresult.push(new Point(dep.x, midY));\r\n\t\t\tresult.push(new Point(arr.x, midY));\r\n\t\t\tresult.push(arr);\r\n\t\t}\r\n\t\telse\r\n\t\t{\r\n\t\t\tresult.push(dep);\r\n\t\t\tresult.push(arr);\r\n\t\t}\r\n\r\n\t\tresult.push(new Point(xe, ye));\r\n\t\treturn result;\r\n\t}\r\n}\r\n\r\n\r\nclass Manhattan extends Link {\r\n\tconstructor(terminalVisual, shapeConfig, startMarker, endMarker) {\r\n\t\tshapeConfig = _.defaults(shapeConfig, {\r\n\t\t\tMIN_BUFFER: 10,\r\n\t\t\tautoRoute: false,\r\n\t\t\tmaxChannelWidth: 100\r\n\t\t});\r\n\t\tsuper(terminalVisual, shapeConfig, startMarker, endMarker);\r\n\t}\r\n\r\n\tget points() {\r\n\t\t//let pos = Manhattan.routeInternal(this.start, this.end, this.startNormal, this.endNormal, this.MIN_BUFFER);\r\n\t\t//pos = Manhattan.processPositions(this.start, this.end, pos, this.startNormal.x!=0);\r\n\t\tlet pos = Manhattan.findPositions(this.start, this.end, this.startNormal, this.endNormal, this.MIN_BUFFER);\r\n\t\tif (this.autoRoute) {\r\n\t\t\tthis._mergeSegments(pos);\r\n\t\t\tvar boxes = [], node, startBox, endBox;\r\n\t\t\tvar container = edge.source.getCommonAncestor(edge.target);\r\n\t\t\tvar childNodes = container.getDescendants();\r\n\t\t\tvar index = 0;\r\n\t\t\tfor (var i = 0; i < childNodes.length; i++) {\r\n\t\t\t\tnode = childNodes[i];\r\n\t\t\t\t// Do not include source or target ancestors in routing.\r\n\t\t\t\tif (node.excludeFromRouting(edge) || node.isAncestor(edge.source) || node.isAncestor(edge.target)) continue;\r\n\t\t\t\tif (node == edge.source)\r\n\t\t\t\tstartBox = index;\r\n\t\t\t\tif (node == edge.target)\r\n\t\t\t\tendBox = index;\r\n\t\t\t\tboxes.push(node.getBounds(document));\r\n\t\t\t\tindex++;\r\n\t\t\t}\r\n\t\t\tif (boxes.length > 1)\r\n\t\t\t\tthis.autoRoute(pos, container.getBounds(document), boxes, startBox, endBox);\r\n\t\t}\r\n\t\tthis._mergeSegments(pos);\r\n\t\treturn pos;\r\n\t}\r\n\r\n\t//New function for finding route\r\n\tstatic findPositions(start, end, startNormal, endNormal, buffer) {\r\n\t\tvar startBuffer = new Point(start.x + startNormal.x * buffer, start.y + startNormal.y * buffer);\r\n\t\tvar endBuffer = new Point(end.x + endNormal.x * buffer, end.y + endNormal.y * buffer);\r\n\t\tvar startBufferNormal, endBufferNormal;\r\n\t\tvar pts;\r\n\t\tif (startNormal.x != 0) {\r\n\t\t\tif ((endBuffer.x - startBuffer.x) / startNormal.x > 0) {\r\n\t\t\t\tstartBufferNormal = startNormal;\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tstartBufferNormal = new Point(0, (endBuffer.y >= startBuffer.y) ? 1 : -1);\r\n\t\t\t}\r\n\t\t}\r\n\t\telse {\r\n\t\t\tif ((endBuffer.y - startBuffer.y) / startNormal.y > 0) {\r\n\t\t\t\tstartBufferNormal = startNormal;\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tstartBufferNormal = new Point((endBuffer.x >= startBuffer.x) ? 1 : -1, 0);\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (endNormal.x != 0) {\r\n\t\t\tif ((startBuffer.x - endBuffer.x) / endNormal.x > 0) {\r\n\t\t\t\tendBufferNormal = endNormal;\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tendBufferNormal = new Point(0, (startBuffer.y >= endBuffer.y) ? 1 : -1);\r\n\t\t\t}\r\n\t\t}\r\n\t\telse {\r\n\t\t\tif ((startBuffer.y - endBuffer.y) / endNormal.y > 0) {\r\n\t\t\t\tendBufferNormal = endNormal;\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tendBufferNormal = new Point((startBuffer.x >= endBuffer.x) ? 1 : -1, 0);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (startBufferNormal.dotProduct(endBufferNormal) == 0) {\r\n\t\t\tvar middle = (startBufferNormal.x == 0) ? new Point(startBuffer.x, endBuffer.y) : new Point(endBuffer.x, startBuffer.y);\r\n\t\t\tpts = [start, startBuffer, middle, endBuffer, end];\r\n\t\t}\r\n\t\telse if (startBufferNormal.dotProduct(endBufferNormal) < 0) {\r\n\t\t\tif (startBufferNormal.x == 0) {\r\n\t\t\t\tpts = [start, startBuffer, new Point(startBuffer.x, (start.y + end.y) / 2), new Point(endBuffer.x, (start.y + end.y) / 2), endBuffer, end];\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tpts = [start, startBuffer, new Point((start.x + end.x) / 2, startBuffer.y), new Point((start.x + end.x) / 2, endBuffer.y), endBuffer, end];\r\n\t\t\t}\r\n\t\t}\r\n\t\telse {\r\n\t\t\tpts = [start, startBuffer, new Point(startBuffer.x + startBufferNormal.x * buffer, startBuffer.y + startBufferNormal.y * buffer), new Point(endBuffer.x + endBufferNormal.x * buffer, endBuffer.y + endBufferNormal.y * buffer), endBuffer, end];\r\n\t\t}\r\n\r\n\t\tvar prunePts = [];\r\n\t\tprunePts[0] = pts[0];\r\n\t\tfor (var i = 1; i < pts.length - 1; i++) {\r\n\t\t\tif ((pts[i].x == pts[i-1].x && pts[i].x == pts[i+1].x) || (pts[i].y == pts[i-1].y && pts[i].y == pts[i+1].y)) {\r\n\t\t\t\tcontinue;\r\n\t\t\t}\r\n\t\t\tprunePts.push(pts[i]);\r\n\t\t}\r\n\t\tprunePts.push(pts[pts.length - 1]);\r\n\t\treturn prunePts;\r\n\t}\r\n\r\n\t/**\r\n\t * Make a route based on the start, end and startNormal and endNormal\r\n\t * None of the parameters can be null\r\n\t * TODO: This method could use some improvement...\r\n\t */\r\n\tstatic routeInternal(start, end, startNormal, endNormal, buffer) {\r\n\t\tvar direction = start.getDirection(end);\r\n\t\tvar average = start.getMidPoint(end);\r\n\t\tvar pos = [];\r\n\t\tvar startPositive = new Point(startNormal.x*startNormal.x, startNormal.y*startNormal.y);\r\n\t\tvar endPositive = new Point(endNormal.x*endNormal.x, endNormal.y*endNormal.y);\r\n\t\tvar horizontal = startNormal.x != 0;\r\n\t\tpos[0] = horizontal ? start.y : start.x;\r\n\r\n\t\thorizontal = !horizontal;\r\n\t\tvar i;\r\n\t\tif (startNormal.dotProduct(endNormal) == 0) {\r\n\t\t\tif ((startNormal.dotProduct(direction) >= 0)\r\n\t\t\t\t&& (endNormal.dotProduct(direction) <= 0)) {\r\n\t\t\t\t// 0\r\n\t\t\t} else {\r\n\t\t\t\t// 2\r\n\t\t\t\tif (startNormal.dotProduct(direction) < 0)\r\n\t\t\t\t\ti = startPositive.dotProduct(start.getTranslated(startNormal.getScaled(buffer)));\r\n\t\t\t\telse\r\n\t\t\t\t\ti = horizontal ? average.y : average.x;\r\n\r\n\t\t\t\tpos.push(i);\r\n\t\t\t\thorizontal = !horizontal;\r\n\r\n\t\t\t\tif (endNormal.dotProduct(direction) > 0)\r\n\t\t\t\t\ti = endPositive.dotProduct(end.getTranslated(endNormal.getScaled(buffer)));\r\n\t\t\t\telse\r\n\t\t\t\t\ti = horizontal ? average.y : average.x;\r\n\r\n\t\t\t\tpos.push(i);\r\n\t\t\t\thorizontal = !horizontal;\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tif (startNormal.dotProduct(endNormal) > 0) {\r\n\t\t\t\t//1\r\n\t\t\t\tif (startNormal.dotProduct(direction) >= 0)\r\n\t\t\t\t\ti = startPositive.dotProduct(start.getTranslated(startNormal.getScaled(buffer)));\r\n\t\t\t\telse\r\n\t\t\t\t\ti = endPositive.dotProduct(end.getTranslated(endNormal.getScaled(buffer)));\r\n\t\t\t\tpos.push(i);\r\n\t\t\t\thorizontal = !horizontal;\r\n\t\t\t} else {\r\n\t\t\t\t//3 or 1\r\n\t\t\t\tif (startNormal.dotProduct(direction) < 0) {\r\n\t\t\t\t\ti = startPositive.dotProduct(start.getTranslated(startNormal.getScaled(buffer)));\r\n\t\t\t\t\tpos.push(i);\r\n\t\t\t\t\thorizontal = !horizontal;\r\n\t\t\t\t}\r\n\r\n\t\t\t\ti = horizontal ? average.y : average.x;\r\n\t\t\t\tpos.push(i);\r\n\t\t\t\thorizontal = !horizontal;\r\n\r\n\t\t\t\tif (startNormal.dotProduct(direction) < 0) {\r\n\t\t\t\t\ti = endPositive.dotProduct(end.getTranslated(endNormal.getScaled(buffer)));\r\n\t\t\t\t\tpos.push(i);\r\n\t\t\t\t\thorizontal = !horizontal;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tpos.push(horizontal ? end.y : end.x);\r\n\r\n\t\treturn pos;\r\n\t}\r\n\r\n\t// Process the positions.\r\n\tstatic processPositions(start, end, positions, horizontal) {\r\n\t\tvar pos = [];\r\n\t\tpos[0] = horizontal ? start.x : start.y;\r\n\t\tvar i;\r\n\t\tfor (i = 0; i < positions.length; i++) {\r\n\t\t\tpos[i + 1] = positions[i];\r\n\t\t}\r\n\t\tpos.push((horizontal == (positions.length % 2 == 1)) ? end.x : end.y);\r\n\r\n\t\tvar pts = [];\r\n\t\tpts[0] = start;\r\n\t\tvar p;\r\n\t\tvar current, prev;\r\n\t\tfor (i = 2; i < pos.length - 1; i++) {\r\n\t\t\thorizontal = !horizontal;\r\n\t\t\tprev = pos[i - 1];\r\n\t\t\tcurrent = pos[i];\r\n\t\t\tp = horizontal ? new Point(prev, current) : new Point(current, prev);\r\n\t\t\tpts.push(p);\r\n\t\t}\r\n\t\tpts.push(end);\r\n\t\treturn pts;\r\n\t}\r\n\r\n\t/**\r\n\t * Automatically route the connection to avoid intersections with other vertices.\r\n\t */\r\n\tautoRoute(pts, container, boxes, startBox, endBox) {\r\n\t\tvar side, side2, d, box, intersect, j;\r\n\t\tvar channel, channel2, pt, dir;\r\n\r\n\t\tvar startPadding = 0, endPadding;\r\n\t\t// first get the start and end channel\r\n\t\tbox = boxes[endBox];\r\n\t\tpt = pts[pts.length - 2];\r\n\t\tif (pt.y < box.y)\r\n\t\t\tside = 1;\r\n\t\telse if (pt.y > box.y + box.height)\r\n\t\t\tside = 3;\r\n\t\telse if (pt.x < box.x)\r\n\t\t\tside = 0;\r\n\t\telse\r\n\t\t\tside = 2;\r\n\t\tchannel = _getChannel(container, endBox, boxes, side);\r\n\t\tendPadding = channel.horizontal ? (channel.right - channel.left)/2 : (channel.bottom - channel.top)/2;\r\n\r\n\t\tfor (var i = 0; i < pts.length - 1; i++) {\r\n\t\t\tif (pts[i+1].x == pts[i].x && pts[i+1].y == pts[i].y) continue;\r\n\t\t\tintersect = _getFirstIntersection(pts, i, boxes, startBox, endBox);\r\n\t\t\tif (!intersect) continue;\r\n\t\t\tj = intersect[0];\r\n\t\t\tside = intersect[1];\r\n\t\t\tbox = boxes[j];\r\n\t\t\tchannel = _getChannel(container, j, boxes, side);\r\n\t\t\tswitch(side) {\r\n\t\t\t\tcase 0:\r\n\t\t\t\tcase 2:\r\n\t\t\t\t\tpt = new Point((channel.right + channel.left)/2, pts[i].y);\r\n\t\t\t\t\tdir = _getRouteTendency(pts, i, pt, box, side);\r\n\t\t\t\t\tside2 = dir < 0 ? 1 : 3;\r\n\t\t\t\t\tchannel2 = _getChannel(container, j, boxes, side2);\r\n\t\t\t\t\t// if the previous point is in the channel2, use that point instead of center of the channel.\r\n\t\t\t\t\tif (i > 1 && (pts[i-2].y == pts[i-1].y) && (pts[i-1].y > channel2.top && pts[i-1].y < channel2.bottom))\r\n\t\t\t\t\t\td = pts[i-1].y - pt.y;\r\n\t\t\t\t\telse if (i < pts.length - 3 && (pts[i+2].y == pts[i+3].y) && (pts[i+2].y > channel2.top && pts[i+2].y < channel2.bottom))\r\n\t\t\t\t\t\td = pts[i+2].y - pt.y;\r\n\t\t\t\t\telse\r\n\t\t\t\t\t\td = (channel2.bottom + channel2.top)/2 - pt.y;\r\n\t\t\t\t\t// check if we need this pt.\r\n\t\t\t\t\tif ((side == 0 && pt.x <= pts[i].x) || (side == 2 && pt.x >= pts[i].x))\r\n\t\t\t\t\t\tpt = null;\r\n\t\t\t\t\telse if (i > 0) {\r\n\t\t\t\t\t\t// see if we can push the line out to where we started.\r\n\t\t\t\t\t\tif (!_hasIntersection(\r\n\t\t\t\t\t\t\t\t[new Point(pts[i].x, pts[i].y), new Point(pts[i].x, pts[i].y + d), new Point(pt.x, pt.y + d)],\r\n\t\t\t\t\t\t\t\tboxes))\r\n\t\t\t\t\t\t\tpt = null;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 1:\r\n\t\t\t\tcase 3:\r\n\t\t\t\t\tpt = new Point(pts[i].x, (channel.bottom + channel.top)/2);\r\n\t\t\t\t\tdir = _getRouteTendency(pts, i, pt, box, side);\r\n\t\t\t\t\tside2 = dir < 0 ? 0 : 2;\r\n\t\t\t\t\tchannel2 = _getChannel(container, j, boxes, side2);\r\n\t\t\t\t\t// if the previous point is in the channel2, use that point instead of center of the channel.\r\n\t\t\t\t\tif (i > 1 && (pts[i-2].x == pts[i-1].x) && (pts[i-1].x > channel2.left && pts[i-1].x < channel2.right))\r\n\t\t\t\t\t\td = pts[i-1].x - pt.x;\r\n\t\t\t\t\telse if (i < pts.length - 3 && (pts[i+2].x == pts[i+3].x) && (pts[i+2].x > channel2.left && pts[i+2].x < channel2.right))\r\n\t\t\t\t\t\td = pts[i+2].x - pt.x;\r\n\t\t\t\t\telse\r\n\t\t\t\t\t\td = (channel2.right + channel2.left)/2 - pt.x;\r\n\t\t\t\t\t// check if we need this pt.\r\n\t\t\t\t\tif ((side == 1 && pt.y <= pts[i].y) || (side == 3 && pt.y >= pts[i].y))\r\n\t\t\t\t\t\tpt = null;\r\n\t\t\t\t\telse if (i > 0) {\r\n\t\t\t\t\t\t// see if we can push the line out to where we started.\r\n\t\t\t\t\t\tif (!_hasIntersection(\r\n\t\t\t\t\t\t\t\t[new Point(pts[i].x, pts[i].y), new Point(pts[i].x + d, pts[i].y), new Point(pt.x + d, pt.y)],\r\n\t\t\t\t\t\t\t\tboxes))\r\n\t\t\t\t\t\t\tpt = null;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 4:\r\n\t\t\t\t\tcontinue;\r\n\t\t\t}\r\n\t\t\t// max points.\r\n\t\t\tif (i > 20) return;\r\n\t\t\tif (pt && (pt.x != pts[i].x || pt.y != pts[i].y)) {\r\n\t\t\t\tpts.splice(i+1, 0, pt);\r\n\t\t\t\t_moveSegment(pts, i+1, d, startPadding, endPadding);\r\n\t\t\t\ti++;\r\n\t\t\t} else\r\n\t\t\t\t_moveSegment(pts, i, d, startPadding, endPadding);\r\n\t\t}\r\n\t}\r\n\r\n\t_hasIntersection(pts, boxes) {\r\n\t\tfor (var i = 0; i < pts.length - 1; i++) {\r\n\t\t\tfor (var j = 0; j < boxes.length; j++) {\r\n\t\t\t\tif (boxes[j].detectIntersection(pts[i], pts[i+1]) >= 0)\r\n\t\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn false;\r\n\t}\r\n\r\n\t_getFirstIntersection(pts, i, boxes, startBox, endBox) {\r\n\t\tvar box, side, savedIndex = null, savedSide = null;\r\n\t\tfor (var j = 0; j < boxes.length; j++) {\r\n\t\t\tif ((i == 0 && j == startBox) || (i == pts.length - 2 && j == endBox))\r\n\t\t\t\tcontinue;\r\n\t\t\tbox = boxes[j];\r\n\t\t\tside = box.detectIntersection(pts[i], pts[i+1]);\r\n\t\t\tif (side >= 0) {\r\n\t\t\t\tif (savedIndex == null) {\r\n\t\t\t\t\tsavedIndex = j;\r\n\t\t\t\t\tsavedSide = side;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tif (boxes[savedIndex].distance(pts[i]) > box.distance(pts[i])) {\r\n\t\t\t\t\t\tsavedIndex = j;\r\n\t\t\t\t\t\tsavedSide = side;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (savedIndex != null)\r\n\t\t\treturn [savedIndex, savedSide];\r\n\t\treturn null;\r\n\t}\r\n\r\n\t_getRouteTendency(pts, i, breakPt, box, side) {\r\n\t\tvar dir;\r\n\t\tvar p;\r\n\t\tswitch (side) {\r\n\t\t\tcase 0:\r\n\t\t\tcase 2:\r\n\t\t\t\tp = \"y\";\r\n\t\t\t\tbreak;\r\n\t\t\tcase 1:\r\n\t\t\tcase 3:\r\n\t\t\t\tp = \"x\";\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\t\t//first try the breakpt.\r\n\t\tdir = _getRouteDirection(breakPt, pts[pts.length - 1])[p];\r\n\t\tif (dir == 0) {\r\n\t\t\tdir = -_getRouteDirection(pts[0], pts[pts.length - 1])[p];\r\n\t\t\tif (dir == 0) {\r\n\t\t\t\tif (breakPt[p] < box.getCenter()[p])\r\n\t\t\t\t\tdir = -1;\r\n\t\t\t\telse\r\n\t\t\t\t\tdir = 1;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn dir;\r\n\t}\r\n\r\n\t_getRouteDirection(pt1, pt2) {\r\n\t\tif (pt1.x == pt2.x) {\r\n\t\t\tif (pt1.y < pt2.y) return Point.S;\r\n\t\t\treturn Point.N;\r\n\t\t} else if (pt1.y == pt2.y) {\r\n\t\t\tif (pt1.x < pt2.x) return Point.E;\r\n\t\t\treturn Point.W;\r\n\t\t} else if (pt1.x < pt2.x) {\r\n\t\t\tif (pt1.y < pt2.y) return Point.SE;\r\n\t\t\treturn Point.NE;\r\n\t\t} else {\r\n\t\t\tif (pt1.y < pt2.y) return Point.SW;\r\n\t\t\treturn Point.NW;\r\n\t\t}\r\n\t}\r\n\r\n\t_getChannel(container, index, boxes, side) {\r\n\t\tvar maxChannelWidth = this.maxChannelWidth;\r\n\t\tvar box1 = boxes[index], box2;\r\n\t\tvar pt, i;\r\n\t\tvar channel = {}, l, t, b, r;\r\n\t\tswitch (side) {\r\n\t\t\tcase 0:\r\n\t\t\t\tpt = box1.getLeft();\r\n\t\t\t\tchannel.right = pt.x;\r\n\t\t\t\tchannel.horizontal = false;\r\n\t\t\t\tfor (i = 0; i < boxes.length; i++) {\r\n\t\t\t\t\tif (i == index) continue;\r\n\t\t\t\t\tr = boxes[i].getRight().x;\r\n\t\t\t\t\tif (r >= pt.x) continue;\r\n\t\t\t\t\tif (!channel.left || channel.left < r)\r\n\t\t\t\t\t\tchannel.left = r;\r\n\t\t\t\t}\r\n\t\t\t\tif (!channel.left) {\r\n\t\t\t\t\tchannel.left = container.getLeft().x;\r\n\t\t\t\t\tif (channel.right - channel.left > maxChannelWidth)\r\n\t\t\t\t\t\tchannel.left = channel.right - maxChannelWidth;\r\n\t\t\t\t}\r\n\t\t\t\tfor (i = 0; i < boxes.length; i++) {\r\n\t\t\t\t\tif (i == index) continue;\r\n\t\t\t\t\tbox2 = boxes[i];\r\n\t\t\t\t\tb = box2.getBottom().y;\r\n\t\t\t\t\tt = box2.getTop().y;\r\n\t\t\t\t\tif (b < pt.y && (box2.getRight() > channel.left && box2.getLeft() < channel.right)) {\r\n\t\t\t\t\t\tif (!channel.top || channel.top < b)\r\n\t\t\t\t\t\t\tchannel.top = b;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (t > pt.y && (box2.getRight() > channel.left && box2.getLeft() < channel.right)) {\r\n\t\t\t\t\t\tif (!channel.bottom || channel.bottom > t)\r\n\t\t\t\t\t\t\tchannel.bottom = t;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tif (!channel.top) channel.top = container.getTop().y;\r\n\t\t\t\tif (!channel.bottom) channel.bottom = container.getBottom().y;\r\n\t\t\t\tbreak;\r\n\t\t\tcase 1:\r\n\t\t\t\tpt = box1.getTop();\r\n\t\t\t\tchannel.horizontal = true;\r\n\t\t\t\tchannel.bottom = pt.y;\r\n\t\t\t\tfor (i = 0; i < boxes.length; i++) {\r\n\t\t\t\t\tif (i == index) continue;\r\n\t\t\t\t\tb = boxes[i].getBottom().y;\r\n\t\t\t\t\tif (b >= pt.y) continue;\r\n\t\t\t\t\tif (!channel.top || channel.top < b)\r\n\t\t\t\t\t\tchannel.top = b;\r\n\t\t\t\t}\r\n\t\t\t\tif (!channel.top) {\r\n\t\t\t\t\tchannel.top = container.getTop().y;\r\n\t\t\t\t\tif (channel.bottom - channel.top > maxChannelWidth)\r\n\t\t\t\t\t\tchannel.top = channel.bottom - maxChannelWidth;\r\n\t\t\t\t}\r\n\t\t\t\tfor (i = 0; i < boxes.length; i++) {\r\n\t\t\t\t\tif (i == index) continue;\r\n\t\t\t\t\tbox2 = boxes[i];\r\n\t\t\t\t\tl = box2.getLeft().x;\r\n\t\t\t\t\tr = box2.getRight().x;\r\n\t\t\t\t\tif (r < pt.x && (box2.getBottom() > channel.top && box2.getTop() < channel.bottom)) {\r\n\t\t\t\t\t\tif (!channel.left || channel.left < r)\r\n\t\t\t\t\t\t\tchannel.left = r;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (l > pt.x && (box2.getBottom() > channel.top && box2.getTop() < channel.bottom)) {\r\n\t\t\t\t\t\tif (!channel.right || channel.right > l)\r\n\t\t\t\t\t\t\tchannel.right = l;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tif (!channel.left) channel.left = container.getLeft().x;\r\n\t\t\t\tif (!channel.right) channel.right = container.getRight().x;\r\n\r\n\t\t\t\tbreak;\r\n\t\t\tcase 2:\r\n\t\t\t\tpt = box1.getRight();\r\n\t\t\t\tchannel.horizontal = false;\r\n\t\t\t\tchannel.left = pt.x;\r\n\t\t\t\tfor (i = 0; i < boxes.length; i++) {\r\n\t\t\t\t\tif (i == index) continue;\r\n\t\t\t\t\tl = boxes[i].getLeft().x;\r\n\t\t\t\t\tif (l <= pt.x) continue;\r\n\t\t\t\t\tif (!channel.right || channel.right > l)\r\n\t\t\t\t\t\tchannel.right = l;\r\n\t\t\t\t}\r\n\t\t\t\tif (!channel.right) {\r\n\t\t\t\t\tchannel.right = container.getRight().x;\r\n\t\t\t\t\tif (channel.right - channel.left > maxChannelWidth)\r\n\t\t\t\t\t\tchannel.right = channel.left + maxChannelWidth;\r\n\t\t\t\t}\r\n\t\t\t\tfor (i = 0; i < boxes.length; i++) {\r\n\t\t\t\t\tif (i == index) continue;\r\n\t\t\t\t\tbox2 = boxes[i];\r\n\t\t\t\t\tb = box2.getBottom().y;\r\n\t\t\t\t\tt = box2.getTop().y;\r\n\t\t\t\t\tif (b < pt.y && (box2.getRight() > channel.left && box2.getLeft() < channel.right)) {\r\n\t\t\t\t\t\tif (!channel.top || channel.top < b)\r\n\t\t\t\t\t\t\tchannel.top = b;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (t > pt.y && (box2.getRight() > channel.left && box2.getLeft() < channel.right)) {\r\n\t\t\t\t\t\tif (!channel.bottom || channel.bottom > t)\r\n\t\t\t\t\t\t\tchannel.bottom = t;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tif (!channel.top) channel.top = container.getTop().y;\r\n\t\t\t\tif (!channel.bottom) channel.bottom = container.getBottom().y;\r\n\t\t\t\tbreak;\r\n\t\t\tcase 3:\r\n\t\t\t\tpt = box1.getBottom();\r\n\t\t\t\tchannel.horizontal = true;\r\n\t\t\t\tchannel.top = pt.y;\r\n\t\t\t\tfor (i = 0; i < boxes.length; i++) {\r\n\t\t\t\t\tif (i == index) continue;\r\n\t\t\t\t\tbox2 = boxes[i];\r\n\t\t\t\t\tif (box2.getTop().y <= pt.y) continue;\r\n\t\t\t\t\tif (!channel.bottom || channel.bottom > box2.getTop().y)\r\n\t\t\t\t\t\tchannel.bottom = box2.getTop().y;\r\n\t\t\t\t}\r\n\t\t\t\tif (!channel.bottom) {\r\n\t\t\t\t\tchannel.bottom = container.getBottom().y;\r\n\t\t\t\t\tif (channel.bottom - channel.top > maxChannelWidth)\r\n\t\t\t\t\t\tchannel.bottom = channel.top + maxChannelWidth;\r\n\t\t\t\t}\r\n\t\t\t\tfor (i = 0; i < boxes.length; i++) {\r\n\t\t\t\t\tif (i == index) continue;\r\n\t\t\t\t\tbox2 = boxes[i];\r\n\t\t\t\t\tl = box2.getLeft().x;\r\n\t\t\t\t\tr = box2.getRight().x;\r\n\t\t\t\t\tif (r < pt.x && (box2.getBottom() > channel.top && box2.getTop() < channel.bottom)) {\r\n\t\t\t\t\t\tif (!channel.left || channel.left < r)\r\n\t\t\t\t\t\t\tchannel.left = r;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (l > pt.x && (box2.getBottom() > channel.top && box2.getTop() < channel.bottom)) {\r\n\t\t\t\t\t\tif (!channel.right || channel.right > l)\r\n\t\t\t\t\t\t\tchannel.right = l;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tif (!channel.left) channel.left = container.getLeft().x;\r\n\t\t\t\tif (!channel.right) channel.right = container.getRight().x;\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\t\treturn channel;\r\n\t}\r\n\r\n\t/**\r\n\t * Move a line segment by a specified distance.\r\n\t *\r\n\t * @param pts the list of points.\r\n\t * @param i the index of the segment.\r\n\t * @param d the distance to move.\r\n\t * @param startPadding\r\n\t * @param endPadding\r\n\t */\r\n\t_moveSegment(pts, i, d, startPadding, endPadding) {\r\n\t\t// first check if we need to add new line segments.\r\n\t\tvar dir, l, pt;\r\n\t\tif (i == 0) {\r\n\t\t\t// we need to break off the segment, since we can't change the starting point.\r\n\t\t\tdir = pts[0].getDirection(pts[1]);\r\n\t\t\tif (!startPadding)\r\n\t\t\t\tstartPadding = this.MIN_BUFFER;\r\n\t\t\tl = Math.min(startPadding, pts[0].distance(pts[1])/2);\r\n\t\t\tpt = pts[0].getTranslated(dir.scale(l));\r\n\t\t\tpts.splice(1, 0, pt);\r\n\t\t\t_moveSegment(pts, i+1, d);\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tif (i == pts.length - 2) {\r\n\t\t\t// we need to break off the segment, since we can't change the end point.\r\n\t\t\tdir = pts[pts.length-1].getDirection(pts[pts.length-2]);\r\n\t\t\tif (!endPadding)\r\n\t\t\t\tendPadding = this.MIN_BUFFER;\r\n\t\t\tl = Math.min(endPadding, pts[pts.length-1].distance(pts[pts.length-2])/2);\r\n\t\t\tpt = pts[pts.length - 1].getTranslated(dir.scale(l));\r\n\t\t\tpts.splice(pts.length - 1, 0, pt);\r\n\t\t\t_moveSegment(pts, i, d);\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tif (pts[i].y == pts[i+1].y) {\r\n\t\t\tif (i > 0 && pts[i - 1].y == pts[i].y) {\r\n\t\t\t\tpts.splice(i + 1, 0, pts[i].clone());\r\n\t\t\t\ti++;\r\n\t\t\t}\r\n\t\t\tif (i < pts.length - 2 && pts[i+1].y == pts[i+2].y)\r\n\t\t\t\tpts.splice(i + 1, 0, pts[i+1].clone());\r\n\t\t\tpts[i].y += d;\r\n\t\t\tpts[i+1].y += d;\r\n\t\t} else {\r\n\t\t\tif (i > 0 && pts[i - 1].x == pts[i].x) {\r\n\t\t\t\tpts.splice(i + 1, 0, pts[i].clone());\r\n\t\t\t\ti++;\r\n\t\t\t}\r\n\t\t\tif (i < pts.length - 2 && pts[i+1].x == pts[i+2].x)\r\n\t\t\t\tpts.splice(i + 1, 0, pts[i+1].clone());\r\n\t\t\tpts[i].x += d;\r\n\t\t\tpts[i+1].x += d;\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * This method will merge the redundant segments.\r\n\t */\r\n\t_mergeSegments(pts) {\r\n\t\tvar h1 = pts[pts.length-1].y == pts[pts.length-2].y;\r\n\t\tvar h2;\r\n\t\tfor (var i = pts.length - 2; i >= 1; i--) {\r\n\t\t\th2 = pts[i].y == pts[i-1].y;\r\n\t\t\tif (h2 == h1 || (pts[i].equals(pts[i-1])))\r\n\t\t\t\tpts.splice(i, 1);\r\n\t\t\telse\r\n\t\t\t\th1 = !h1;\r\n\t\t}\r\n\t}\r\n}\r\n\r\nlinkTypes['direct'] = DirectLink;\r\nlinkTypes['bezier'] = BezierLink;\r\nlinkTypes['entityRelations'] = EntityRelations;\r\nlinkTypes['manhattan'] = Manhattan;\r\n\r\nexport default Link;\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/geometry/Link.js\n **/","/*!\n  * Bean - copyright (c) Jacob Thornton 2011-2012\n  * https://github.com/fat/bean\n  * MIT license\n  */\n(function (name, context, definition) {\n  if (typeof module != 'undefined' && module.exports) module.exports = definition()\n  else if (typeof define == 'function' && define.amd) define(definition)\n  else context[name] = definition()\n})('bean', this, function (name, context) {\n  name    = name    || 'bean'\n  context = context || this\n\n  var win            = window\n    , old            = context[name]\n    , namespaceRegex = /[^\\.]*(?=\\..*)\\.|.*/\n    , nameRegex      = /\\..*/\n    , addEvent       = 'addEventListener'\n    , removeEvent    = 'removeEventListener'\n    , doc            = document || {}\n    , root           = doc.documentElement || {}\n    , W3C_MODEL      = root[addEvent]\n    , eventSupport   = W3C_MODEL ? addEvent : 'attachEvent'\n    , ONE            = {} // singleton for quick matching making add() do one()\n\n    , slice          = Array.prototype.slice\n    , str2arr        = function (s, d) { return s.split(d || ' ') }\n    , isString       = function (o) { return typeof o == 'string' }\n    , isFunction     = function (o) { return typeof o == 'function' }\n\n      // events that we consider to be 'native', anything not in this list will\n      // be treated as a custom event\n    , standardNativeEvents =\n        'click dblclick mouseup mousedown contextmenu '                  + // mouse buttons\n        'mousewheel mousemultiwheel DOMMouseScroll '                     + // mouse wheel\n        'mouseover mouseout mousemove selectstart selectend '            + // mouse movement\n        'keydown keypress keyup '                                        + // keyboard\n        'orientationchange '                                             + // mobile\n        'focus blur change reset select submit '                         + // form elements\n        'load unload beforeunload resize move DOMContentLoaded '         + // window\n        'readystatechange message '                                      + // window\n        'error abort scroll '                                              // misc\n      // element.fireEvent('onXYZ'... is not forgiving if we try to fire an event\n      // that doesn't actually exist, so make sure we only do these on newer browsers\n    , w3cNativeEvents =\n        'show '                                                          + // mouse buttons\n        'input invalid '                                                 + // form elements\n        'touchstart touchmove touchend touchcancel '                     + // touch\n        'gesturestart gesturechange gestureend '                         + // gesture\n        'textinput '                                                     + // TextEvent\n        'readystatechange pageshow pagehide popstate '                   + // window\n        'hashchange offline online '                                     + // window\n        'afterprint beforeprint '                                        + // printing\n        'dragstart dragenter dragover dragleave drag drop dragend '      + // dnd\n        'loadstart progress suspend emptied stalled loadmetadata '       + // media\n        'loadeddata canplay canplaythrough playing waiting seeking '     + // media\n        'seeked ended durationchange timeupdate play pause ratechange '  + // media\n        'volumechange cuechange '                                        + // media\n        'checking noupdate downloading cached updateready obsolete '       // appcache\n\n      // convert to a hash for quick lookups\n    , nativeEvents = (function (hash, events, i) {\n        for (i = 0; i < events.length; i++) events[i] && (hash[events[i]] = 1)\n        return hash\n      }({}, str2arr(standardNativeEvents + (W3C_MODEL ? w3cNativeEvents : ''))))\n\n      // custom events are events that we *fake*, they are not provided natively but\n      // we can use native events to generate them\n    , customEvents = (function () {\n        var isAncestor = 'compareDocumentPosition' in root\n              ? function (element, container) {\n                  return container.compareDocumentPosition && (container.compareDocumentPosition(element) & 16) === 16\n                }\n              : 'contains' in root\n                ? function (element, container) {\n                    container = container.nodeType === 9 || container === window ? root : container\n                    return container !== element && container.contains(element)\n                  }\n                : function (element, container) {\n                    while (element = element.parentNode) if (element === container) return 1\n                    return 0\n                  }\n          , check = function (event) {\n              var related = event.relatedTarget\n              return !related\n                ? related == null\n                : (related !== this && related.prefix !== 'xul' && !/document/.test(this.toString())\n                    && !isAncestor(related, this))\n            }\n\n        return {\n            mouseenter: { base: 'mouseover', condition: check }\n          , mouseleave: { base: 'mouseout', condition: check }\n          , mousewheel: { base: /Firefox/.test(navigator.userAgent) ? 'DOMMouseScroll' : 'mousewheel' }\n        }\n      }())\n\n      // we provide a consistent Event object across browsers by taking the actual DOM\n      // event object and generating a new one from its properties.\n    , Event = (function () {\n            // a whitelist of properties (for different event types) tells us what to check for and copy\n        var commonProps  = str2arr('altKey attrChange attrName bubbles cancelable ctrlKey currentTarget ' +\n              'detail eventPhase getModifierState isTrusted metaKey relatedNode relatedTarget shiftKey '  +\n              'srcElement target timeStamp type view which propertyName')\n          , mouseProps   = commonProps.concat(str2arr('button buttons clientX clientY dataTransfer '      +\n              'fromElement offsetX offsetY pageX pageY screenX screenY toElement'))\n          , mouseWheelProps = mouseProps.concat(str2arr('wheelDelta wheelDeltaX wheelDeltaY wheelDeltaZ ' +\n              'axis')) // 'axis' is FF specific\n          , keyProps     = commonProps.concat(str2arr('char charCode key keyCode keyIdentifier '          +\n              'keyLocation location'))\n          , textProps    = commonProps.concat(str2arr('data'))\n          , touchProps   = commonProps.concat(str2arr('touches targetTouches changedTouches scale rotation'))\n          , messageProps = commonProps.concat(str2arr('data origin source'))\n          , stateProps   = commonProps.concat(str2arr('state'))\n          , overOutRegex = /over|out/\n            // some event types need special handling and some need special properties, do that all here\n          , typeFixers   = [\n                { // key events\n                    reg: /key/i\n                  , fix: function (event, newEvent) {\n                      newEvent.keyCode = event.keyCode || event.which\n                      return keyProps\n                    }\n                }\n              , { // mouse events\n                    reg: /click|mouse(?!(.*wheel|scroll))|menu|drag|drop/i\n                  , fix: function (event, newEvent, type) {\n                      newEvent.rightClick = event.which === 3 || event.button === 2\n                      newEvent.pos = { x: 0, y: 0 }\n                      if (event.pageX || event.pageY) {\n                        newEvent.clientX = event.pageX\n                        newEvent.clientY = event.pageY\n                      } else if (event.clientX || event.clientY) {\n                        newEvent.clientX = event.clientX + doc.body.scrollLeft + root.scrollLeft\n                        newEvent.clientY = event.clientY + doc.body.scrollTop + root.scrollTop\n                      }\n                      if (overOutRegex.test(type)) {\n                        newEvent.relatedTarget = event.relatedTarget\n                          || event[(type == 'mouseover' ? 'from' : 'to') + 'Element']\n                      }\n                      return mouseProps\n                    }\n                }\n              , { // mouse wheel events\n                    reg: /mouse.*(wheel|scroll)/i\n                  , fix: function () { return mouseWheelProps }\n                }\n              , { // TextEvent\n                    reg: /^text/i\n                  , fix: function () { return textProps }\n                }\n              , { // touch and gesture events\n                    reg: /^touch|^gesture/i\n                  , fix: function () { return touchProps }\n                }\n              , { // message events\n                    reg: /^message$/i\n                  , fix: function () { return messageProps }\n                }\n              , { // popstate events\n                    reg: /^popstate$/i\n                  , fix: function () { return stateProps }\n                }\n              , { // everything else\n                    reg: /.*/\n                  , fix: function () { return commonProps }\n                }\n            ]\n          , typeFixerMap = {} // used to map event types to fixer functions (above), a basic cache mechanism\n\n          , Event = function (event, element, isNative) {\n              if (!arguments.length) return\n              event = event || ((element.ownerDocument || element.document || element).parentWindow || win).event\n              this.originalEvent = event\n              this.isNative       = isNative\n              this.isBean         = true\n\n              if (!event) return\n\n              var type   = event.type\n                , target = event.target || event.srcElement\n                , i, l, p, props, fixer\n\n              this.target = target && target.nodeType === 3 ? target.parentNode : target\n\n              if (isNative) { // we only need basic augmentation on custom events, the rest expensive & pointless\n                fixer = typeFixerMap[type]\n                if (!fixer) { // haven't encountered this event type before, map a fixer function for it\n                  for (i = 0, l = typeFixers.length; i < l; i++) {\n                    if (typeFixers[i].reg.test(type)) { // guaranteed to match at least one, last is .*\n                      typeFixerMap[type] = fixer = typeFixers[i].fix\n                      break\n                    }\n                  }\n                }\n\n                props = fixer(event, this, type)\n                for (i = props.length; i--;) {\n                  if (!((p = props[i]) in this) && p in event) this[p] = event[p]\n                }\n              }\n            }\n\n        // preventDefault() and stopPropagation() are a consistent interface to those functions\n        // on the DOM, stop() is an alias for both of them together\n        Event.prototype.preventDefault = function () {\n          if (this.originalEvent.preventDefault) this.originalEvent.preventDefault()\n          else this.originalEvent.returnValue = false\n        }\n        Event.prototype.stopPropagation = function () {\n          if (this.originalEvent.stopPropagation) this.originalEvent.stopPropagation()\n          else this.originalEvent.cancelBubble = true\n        }\n        Event.prototype.stop = function () {\n          this.preventDefault()\n          this.stopPropagation()\n          this.stopped = true\n        }\n        // stopImmediatePropagation() has to be handled internally because we manage the event list for\n        // each element\n        // note that originalElement may be a Bean#Event object in some situations\n        Event.prototype.stopImmediatePropagation = function () {\n          if (this.originalEvent.stopImmediatePropagation) this.originalEvent.stopImmediatePropagation()\n          this.isImmediatePropagationStopped = function () { return true }\n        }\n        Event.prototype.isImmediatePropagationStopped = function () {\n          return this.originalEvent.isImmediatePropagationStopped && this.originalEvent.isImmediatePropagationStopped()\n        }\n        Event.prototype.clone = function (currentTarget) {\n          //TODO: this is ripe for optimisation, new events are *expensive*\n          // improving this will speed up delegated events\n          var ne = new Event(this, this.element, this.isNative)\n          ne.currentTarget = currentTarget\n          return ne\n        }\n\n        return Event\n      }())\n\n      // if we're in old IE we can't do onpropertychange on doc or win so we use doc.documentElement for both\n    , targetElement = function (element, isNative) {\n        return !W3C_MODEL && !isNative && (element === doc || element === win) ? root : element\n      }\n\n      /**\n        * Bean maintains an internal registry for event listeners. We don't touch elements, objects\n        * or functions to identify them, instead we store everything in the registry.\n        * Each event listener has a RegEntry object, we have one 'registry' for the whole instance.\n        */\n    , RegEntry = (function () {\n        // each handler is wrapped so we can handle delegation and custom events\n        var wrappedHandler = function (element, fn, condition, args) {\n            var call = function (event, eargs) {\n                  return fn.apply(element, args ? slice.call(eargs, event ? 0 : 1).concat(args) : eargs)\n                }\n              , findTarget = function (event, eventElement) {\n                  return fn.__beanDel ? fn.__beanDel.ft(event.target, element) : eventElement\n                }\n              , handler = condition\n                  ? function (event) {\n                      var target = findTarget(event, this) // deleated event\n                      if (condition.apply(target, arguments)) {\n                        if (event) event.currentTarget = target\n                        return call(event, arguments)\n                      }\n                    }\n                  : function (event) {\n                      if (fn.__beanDel) event = event.clone(findTarget(event)) // delegated event, fix the fix\n                      return call(event, arguments)\n                    }\n            handler.__beanDel = fn.__beanDel\n            return handler\n          }\n\n        , RegEntry = function (element, type, handler, original, namespaces, args, root) {\n            var customType     = customEvents[type]\n              , isNative\n\n            if (type == 'unload') {\n              // self clean-up\n              handler = once(removeListener, element, type, handler, original)\n            }\n\n            if (customType) {\n              if (customType.condition) {\n                handler = wrappedHandler(element, handler, customType.condition, args)\n              }\n              type = customType.base || type\n            }\n\n            this.isNative      = isNative = nativeEvents[type] && !!element[eventSupport]\n            this.customType    = !W3C_MODEL && !isNative && type\n            this.element       = element\n            this.type          = type\n            this.original      = original\n            this.namespaces    = namespaces\n            this.eventType     = W3C_MODEL || isNative ? type : 'propertychange'\n            this.target        = targetElement(element, isNative)\n            this[eventSupport] = !!this.target[eventSupport]\n            this.root          = root\n            this.handler       = wrappedHandler(element, handler, null, args)\n          }\n\n        // given a list of namespaces, is our entry in any of them?\n        RegEntry.prototype.inNamespaces = function (checkNamespaces) {\n          var i, j, c = 0\n          if (!checkNamespaces) return true\n          if (!this.namespaces) return false\n          for (i = checkNamespaces.length; i--;) {\n            for (j = this.namespaces.length; j--;) {\n              if (checkNamespaces[i] == this.namespaces[j]) c++\n            }\n          }\n          return checkNamespaces.length === c\n        }\n\n        // match by element, original fn (opt), handler fn (opt)\n        RegEntry.prototype.matches = function (checkElement, checkOriginal, checkHandler) {\n          return this.element === checkElement &&\n            (!checkOriginal || this.original === checkOriginal) &&\n            (!checkHandler || this.handler === checkHandler)\n        }\n\n        return RegEntry\n      }())\n\n    , registry = (function () {\n        // our map stores arrays by event type, just because it's better than storing\n        // everything in a single array.\n        // uses '$' as a prefix for the keys for safety and 'r' as a special prefix for\n        // rootListeners so we can look them up fast\n        var map = {}\n\n          // generic functional search of our registry for matching listeners,\n          // `fn` returns false to break out of the loop\n          , forAll = function (element, type, original, handler, root, fn) {\n              var pfx = root ? 'r' : '$'\n              if (!type || type == '*') {\n                // search the whole registry\n                for (var t in map) {\n                  if (t.charAt(0) == pfx) {\n                    forAll(element, t.substr(1), original, handler, root, fn)\n                  }\n                }\n              } else {\n                var i = 0, l, list = map[pfx + type], all = element == '*'\n                if (!list) return\n                for (l = list.length; i < l; i++) {\n                  if ((all || list[i].matches(element, original, handler)) && !fn(list[i], list, i, type)) return\n                }\n              }\n            }\n\n          , has = function (element, type, original, root) {\n              // we're not using forAll here simply because it's a bit slower and this\n              // needs to be fast\n              var i, list = map[(root ? 'r' : '$') + type]\n              if (list) {\n                for (i = list.length; i--;) {\n                  if (!list[i].root && list[i].matches(element, original, null)) return true\n                }\n              }\n              return false\n            }\n\n          , get = function (element, type, original, root) {\n              var entries = []\n              forAll(element, type, original, null, root, function (entry) {\n                return entries.push(entry)\n              })\n              return entries\n            }\n\n          , put = function (entry) {\n              var has = !entry.root && !this.has(entry.element, entry.type, null, false)\n                , key = (entry.root ? 'r' : '$') + entry.type\n              ;(map[key] || (map[key] = [])).push(entry)\n              return has\n            }\n\n          , del = function (entry) {\n              forAll(entry.element, entry.type, null, entry.handler, entry.root, function (entry, list, i) {\n                list.splice(i, 1)\n                entry.removed = true\n                if (list.length === 0) delete map[(entry.root ? 'r' : '$') + entry.type]\n                return false\n              })\n            }\n\n            // dump all entries, used for onunload\n          , entries = function () {\n              var t, entries = []\n              for (t in map) {\n                if (t.charAt(0) == '$') entries = entries.concat(map[t])\n              }\n              return entries\n            }\n\n        return { has: has, get: get, put: put, del: del, entries: entries }\n      }())\n\n      // we need a selector engine for delegated events, use querySelectorAll if it exists\n      // but for older browsers we need Qwery, Sizzle or similar\n    , selectorEngine\n    , setSelectorEngine = function (e) {\n        if (!arguments.length) {\n          selectorEngine = doc.querySelectorAll\n            ? function (s, r) {\n                return r.querySelectorAll(s)\n              }\n            : function () {\n                throw new Error('Bean: No selector engine installed') // eeek\n              }\n        } else {\n          selectorEngine = e\n        }\n      }\n\n      // we attach this listener to each DOM event that we need to listen to, only once\n      // per event type per DOM element\n    , rootListener = function (event, type) {\n        if (!W3C_MODEL && type && event && event.propertyName != '_on' + type) return\n\n        var listeners = registry.get(this, type || event.type, null, false)\n          , l = listeners.length\n          , i = 0\n\n        event = new Event(event, this, true)\n        if (type) event.type = type\n\n        // iterate through all handlers registered for this type, calling them unless they have\n        // been removed by a previous handler or stopImmediatePropagation() has been called\n        for (; i < l && !event.isImmediatePropagationStopped(); i++) {\n          if (!listeners[i].removed) listeners[i].handler.call(this, event)\n        }\n      }\n\n      // add and remove listeners to DOM elements\n    , listener = W3C_MODEL\n        ? function (element, type, add) {\n            // new browsers\n            element[add ? addEvent : removeEvent](type, rootListener, false)\n          }\n        : function (element, type, add, custom) {\n            // IE8 and below, use attachEvent/detachEvent and we have to piggy-back propertychange events\n            // to simulate event bubbling etc.\n            var entry\n            if (add) {\n              registry.put(entry = new RegEntry(\n                  element\n                , custom || type\n                , function (event) { // handler\n                    rootListener.call(element, event, custom)\n                  }\n                , rootListener\n                , null\n                , null\n                , true // is root\n              ))\n              if (custom && element['_on' + custom] == null) element['_on' + custom] = 0\n              entry.target.attachEvent('on' + entry.eventType, entry.handler)\n            } else {\n              entry = registry.get(element, custom || type, rootListener, true)[0]\n              if (entry) {\n                entry.target.detachEvent('on' + entry.eventType, entry.handler)\n                registry.del(entry)\n              }\n            }\n          }\n\n    , once = function (rm, element, type, fn, originalFn) {\n        // wrap the handler in a handler that does a remove as well\n        return function () {\n          fn.apply(this, arguments)\n          rm(element, type, originalFn)\n        }\n      }\n\n    , removeListener = function (element, orgType, handler, namespaces) {\n        var type     = orgType && orgType.replace(nameRegex, '')\n          , handlers = registry.get(element, type, null, false)\n          , removed  = {}\n          , i, l\n\n        for (i = 0, l = handlers.length; i < l; i++) {\n          if ((!handler || handlers[i].original === handler) && handlers[i].inNamespaces(namespaces)) {\n            // TODO: this is problematic, we have a registry.get() and registry.del() that\n            // both do registry searches so we waste cycles doing this. Needs to be rolled into\n            // a single registry.forAll(fn) that removes while finding, but the catch is that\n            // we'll be splicing the arrays that we're iterating over. Needs extra tests to\n            // make sure we don't screw it up. @rvagg\n            registry.del(handlers[i])\n            if (!removed[handlers[i].eventType] && handlers[i][eventSupport])\n              removed[handlers[i].eventType] = { t: handlers[i].eventType, c: handlers[i].type }\n          }\n        }\n        // check each type/element for removed listeners and remove the rootListener where it's no longer needed\n        for (i in removed) {\n          if (!registry.has(element, removed[i].t, null, false)) {\n            // last listener of this type, remove the rootListener\n            listener(element, removed[i].t, false, removed[i].c)\n          }\n        }\n      }\n\n      // set up a delegate helper using the given selector, wrap the handler function\n    , delegate = function (selector, fn) {\n        //TODO: findTarget (therefore $) is called twice, once for match and once for\n        // setting e.currentTarget, fix this so it's only needed once\n        var findTarget = function (target, root) {\n              var i, array = isString(selector) ? selectorEngine(selector, root) : selector\n              for (; target && target !== root; target = target.parentNode) {\n                for (i = array.length; i--;) {\n                  if (array[i] === target) return target\n                }\n              }\n            }\n          , handler = function (e) {\n              var match = findTarget(e.target, this)\n              if (match) fn.apply(match, arguments)\n            }\n\n        // __beanDel isn't pleasant but it's a private function, not exposed outside of Bean\n        handler.__beanDel = {\n            ft       : findTarget // attach it here for customEvents to use too\n          , selector : selector\n        }\n        return handler\n      }\n\n    , fireListener = W3C_MODEL ? function (isNative, type, element) {\n        // modern browsers, do a proper dispatchEvent()\n        var evt = doc.createEvent(isNative ? 'HTMLEvents' : 'UIEvents')\n        evt[isNative ? 'initEvent' : 'initUIEvent'](type, true, true, win, 1)\n        element.dispatchEvent(evt)\n      } : function (isNative, type, element) {\n        // old browser use onpropertychange, just increment a custom property to trigger the event\n        element = targetElement(element, isNative)\n        isNative ? element.fireEvent('on' + type, doc.createEventObject()) : element['_on' + type]++\n      }\n\n      /**\n        * Public API: off(), on(), add(), (remove()), one(), fire(), clone()\n        */\n\n      /**\n        * off(element[, eventType(s)[, handler ]])\n        */\n    , off = function (element, typeSpec, fn) {\n        var isTypeStr = isString(typeSpec)\n          , k, type, namespaces, i\n\n        if (isTypeStr && typeSpec.indexOf(' ') > 0) {\n          // off(el, 't1 t2 t3', fn) or off(el, 't1 t2 t3')\n          typeSpec = str2arr(typeSpec)\n          for (i = typeSpec.length; i--;)\n            off(element, typeSpec[i], fn)\n          return element\n        }\n\n        type = isTypeStr && typeSpec.replace(nameRegex, '')\n        if (type && customEvents[type]) type = customEvents[type].base\n\n        if (!typeSpec || isTypeStr) {\n          // off(el) or off(el, t1.ns) or off(el, .ns) or off(el, .ns1.ns2.ns3)\n          if (namespaces = isTypeStr && typeSpec.replace(namespaceRegex, '')) namespaces = str2arr(namespaces, '.')\n          removeListener(element, type, fn, namespaces)\n        } else if (isFunction(typeSpec)) {\n          // off(el, fn)\n          removeListener(element, null, typeSpec)\n        } else {\n          // off(el, { t1: fn1, t2, fn2 })\n          for (k in typeSpec) {\n            if (typeSpec.hasOwnProperty(k)) off(element, k, typeSpec[k])\n          }\n        }\n\n        return element\n      }\n\n      /**\n        * on(element, eventType(s)[, selector], handler[, args ])\n        */\n    , on = function(element, events, selector, fn) {\n        var originalFn, type, types, i, args, entry, first\n\n        //TODO: the undefined check means you can't pass an 'args' argument, fix this perhaps?\n        if (selector === undefined && typeof events == 'object') {\n          //TODO: this can't handle delegated events\n          for (type in events) {\n            if (events.hasOwnProperty(type)) {\n              on.call(this, element, type, events[type])\n            }\n          }\n          return\n        }\n\n        if (!isFunction(selector)) {\n          // delegated event\n          originalFn = fn\n          args       = slice.call(arguments, 4)\n          fn         = delegate(selector, originalFn, selectorEngine)\n        } else {\n          args       = slice.call(arguments, 3)\n          fn         = originalFn = selector\n        }\n\n        types = str2arr(events)\n\n        // special case for one(), wrap in a self-removing handler\n        if (this === ONE) {\n          fn = once(off, element, events, fn, originalFn)\n        }\n\n        for (i = types.length; i--;) {\n          // add new handler to the registry and check if it's the first for this element/type\n          first = registry.put(entry = new RegEntry(\n              element\n            , types[i].replace(nameRegex, '') // event type\n            , fn\n            , originalFn\n            , str2arr(types[i].replace(namespaceRegex, ''), '.') // namespaces\n            , args\n            , false // not root\n          ))\n          if (entry[eventSupport] && first) {\n            // first event of this type on this element, add root listener\n            listener(element, entry.eventType, true, entry.customType)\n          }\n        }\n\n        return element\n      }\n\n      /**\n        * add(element[, selector], eventType(s), handler[, args ])\n        *\n        * Deprecated: kept (for now) for backward-compatibility\n        */\n    , add = function (element, events, fn, delfn) {\n        return on.apply(\n            null\n          , !isString(fn)\n              ? slice.call(arguments)\n              : [ element, fn, events, delfn ].concat(arguments.length > 3 ? slice.call(arguments, 5) : [])\n        )\n      }\n\n      /**\n        * one(element, eventType(s)[, selector], handler[, args ])\n        */\n    , one = function () {\n        return on.apply(ONE, arguments)\n      }\n\n      /**\n        * fire(element, eventType(s)[, args ])\n        *\n        * The optional 'args' argument must be an array, if no 'args' argument is provided\n        * then we can use the browser's DOM event system, otherwise we trigger handlers manually\n        */\n    , fire = function (element, type, args) {\n        var types = str2arr(type)\n          , i, j, l, names, handlers\n\n        for (i = types.length; i--;) {\n          type = types[i].replace(nameRegex, '')\n          if (names = types[i].replace(namespaceRegex, '')) names = str2arr(names, '.')\n          if (!names && !args && element[eventSupport]) {\n            fireListener(nativeEvents[type], type, element)\n          } else {\n            // non-native event, either because of a namespace, arguments or a non DOM element\n            // iterate over all listeners and manually 'fire'\n            handlers = registry.get(element, type, null, false)\n            args = [false].concat(args)\n            for (j = 0, l = handlers.length; j < l; j++) {\n              if (handlers[j].inNamespaces(names)) {\n                handlers[j].handler.apply(element, args)\n              }\n            }\n          }\n        }\n        return element\n      }\n\n      /**\n        * clone(dstElement, srcElement[, eventType ])\n        *\n        * TODO: perhaps for consistency we should allow the same flexibility in type specifiers?\n        */\n    , clone = function (element, from, type) {\n        var handlers = registry.get(from, type, null, false)\n          , l = handlers.length\n          , i = 0\n          , args, beanDel\n\n        for (; i < l; i++) {\n          if (handlers[i].original) {\n            args = [ element, handlers[i].type ]\n            if (beanDel = handlers[i].handler.__beanDel) args.push(beanDel.selector)\n            args.push(handlers[i].original)\n            on.apply(null, args)\n          }\n        }\n        return element\n      }\n\n    , bean = {\n          'on'                : on\n        , 'add'               : add\n        , 'one'               : one\n        , 'off'               : off\n        , 'remove'            : off\n        , 'clone'             : clone\n        , 'fire'              : fire\n        , 'Event'             : Event\n        , 'setSelectorEngine' : setSelectorEngine\n        , 'noConflict'        : function () {\n            context[name] = old\n            return this\n          }\n      }\n\n  // for IE, clean up on unload to avoid leaks\n  if (win.attachEvent) {\n    var cleanup = function () {\n      var i, entries = registry.entries()\n      for (i in entries) {\n        if (entries[i].type && entries[i].type !== 'unload') off(entries[i].element, entries[i].type)\n      }\n      win.detachEvent('onunload', cleanup)\n      win.CollectGarbage && win.CollectGarbage()\n    }\n    win.attachEvent('onunload', cleanup)\n  }\n\n  // initialize selector engine to internal default (qSA or throw Error)\n  setSelectorEngine()\n\n  return bean\n});\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/bean/bean.js\n ** module id = 12\n ** module chunks = 0\n **/","import _ from \"lodash\";\nimport Events from \"bean\";\nimport * as KeyUtils from \"./KeyUtils\";\nimport Utils from \"../util/Utils\";\nimport DomUtils from \"../util/DomUtils\";\nimport StringBuffer from \"./../util/StringBuffer\";\n\nconst DEFAULTS = {\n\tstopPropagation: false\n};\n\nexport default class EventDispatcher {\n\t/**\n\t * Constructor\n\t * @param root the root element that the manager will listen to.\n\t * @param zoomScale\n\t * @param config the configuraton for the event dispatcher.\n\t */\n\tconstructor(root, zoomScale = [0, Infinity], config = {}) {\n\t\tthis.root = root;\n\t\tthis.rootNS = root.getAttribute('ns') || 'root';\n\t\tthis.zoomScale = zoomScale;\n\t\t_.assign(this, DEFAULTS, config);\n\t\tthis.scale = 1.0;\n\t\tthis.listeners = {};\n\t\tthis.dragging = false;\n\t\tthis.handler = _.bind(this.handleEvent, this);\n\t\tthis.started = false;\n\n\t\t// Simulate mouseenter/mouseleave events\n\t\tthis.enterStack = [];\n\t}\n\n\t/**\n\t * Start listening for events.\n\t */\n\tstart() {\n\t\tif (this.started) return;\n\t\tEvents.on(this.root, 'mousedown mouseover mouseout mouseenter mouseleave dblclick click contextmenu mousewheel', this.handler);\n\t\tthis.startKeys();\n\t\tthis.started = true;\n\t}\n\n\t/**\n\t * Stop listening for events.\n\t */\n\tstop() {\n\t\tif (!this.started) return;\n\t\tEvents.off(this.root, 'mousedown mouseover mouseout mouseenter mouseleave dblclick click contextmenu mousewheel', this.handler);\n\t\tthis.stopKeys();\n\t\tthis.started = false;\n\t}\n\n\tstartKeys() {\n\t\tEvents.on(document, 'keydown keyup', this.handler);\n\t}\n\n\tstopKeys() {\n\t\tEvents.off(document, 'keydown keyup', this.handler);\n\t}\n\n\tzoomIn() {\n\t\tthis.scale *= 1.25;\n\t\tthis.scale = Math.max(Math.min(this.zoomScale[1], this.scale), this.zoomScale[0]);\n\t\treturn this.scale;\n\t}\n\n\tzoomOut() {\n\t\tthis.scale *= 0.8;\n\t\tthis.scale = Math.max(Math.min(this.zoomScale[1], this.scale), this.zoomScale[0]);\n\t\treturn this.scale;\n\t}\n\n\tgetEventInfo(event) {\n\t\tlet target = event.target;\n\t\tlet buf = new StringBuffer(), ns, stack = [], isRoot = false;\n\t\twhile (!isRoot && target && target != document) {\n\t\t\tns = target.getAttribute('ns');\n\t\t\tif (ns) {\n\t\t\t\tisRoot = _.startsWith(ns, \"root.\");\n\t\t\t\tif (isRoot) {\n\t\t\t\t\tns = ns.substring(5);\n\t\t\t\t\tevent.rootTarget = target;\n\t\t\t\t}\n\t\t\t\tif (!event.nsTarget) event.nsTarget = target;\n\t\t\t\tstack.splice(0, 0, target);\n\t\t\t\tbuf.prepend(ns);\n\t\t\t}\n\t\t\ttarget = target.parentNode;\n\t\t}\n\t\tif (!isRoot)\n\t\t\tevent.rootTarget = event.nsTarget;\n\n\t\t// target stack is a stack of all the ns targets up to the one with the data binding.\n\t\tevent.targetStack = stack;\n\t\tns = buf.toString('.');\n\t\tif (ns == '') ns = this.rootNS;\n\t\treturn {data: event.rootTarget, ns: ns};\n\t}\n\n\t/**\n\t * The main event handler method, it processes event and generate relevant events to dispatch.\n\t */\n\thandleEvent(event) {\n\t\tlet type = event.type;\n\n\t\t// Do not dispatch other events if we are dragging.\n\t\tif (this.dragging || DomUtils.eventFromInput(event)) return;\n\n\t\tlet data, ns, pos = this.getPosition(event), info, isKeyEvent = (type == 'keydown' || type =='keyup');\n\t\tif (isKeyEvent) {\n\t\t\tdata = this.root;\n\t\t\tns = KeyUtils.getKeyEvent(event);\n\t\t} else {\n\t\t\tinfo = this.getEventInfo(event);\n\t\t\tif (!info) return;\n\t\t\tdata = info.data;\n\t\t\tns = info.ns;\n\t\t}\n\n\t\t//Utils.log('EventDispatcher', \"handleEvent - \" + type + ';ns=' + ns);\n\n\t\tif (type == 'mousewheel') {\n\t\t\tthis.scale *= Math.pow(2, event.wheelDelta * 0.002);\n\t\t\tthis.scale = Math.max(Math.min(this.zoomScale[1], this.scale), this.zoomScale[0]);\n\t\t\tevent.scale = this.scale;\n\t\t\ttype = 'zoom';\n\t\t}\n\n\t\t// See if we should create drag events\n\t\tif (type == 'mousedown' && event.button == 0 /*only drag on left click*/) {\n\t\t\t// Create drag object.\n\t\t\tconst dragObject = {data: data, pos: ns == 'root' ? EventDispatcher.mouse(this.root, event) : pos};\n\t\t\tthis.dragging = false;\n\t\t\t// Start listening for mouse move.\n\t\t\tlet dragPos;\n\n\t\t\tconst mousemove = (event) => {\n\t\t\t\tlet currentPos = this.getPosition(event);\n\t\t\t\tif (!this.dragging) {\n\t\t\t\t\t// check if the mouse has moved. IE always fire mousemove after mousedown even if the mouse hasn't moved yet.\n\t\t\t\t\tif (dragObject.pos[0] == currentPos[0] && dragObject.pos[1] == currentPos[1]) return;\n\n\t\t\t\t\t// start dragging\n\t\t\t\t\tthis.dragging = true;\n\t\t\t\t\tevent.rootTarget = dragObject.data;\n\t\t\t\t\tthis.dispatch(event, 'dragstart', ns, dragObject.data, dragObject.pos);\n\t\t\t\t}\n\t\t\t\tif (ns == \"root\")\n\t\t\t\t\tdragPos = EventDispatcher.mouse(this.root, event);\n\t\t\t\telse\n\t\t\t\t\tdragPos = currentPos;\n\t\t\t\tthis.getEventInfo(event);\n\t\t\t\tthis.dispatch(event, 'drag', ns, dragObject.data, dragPos);\n\t\t\t};\n\t\t\tconst mouseup = (event) => {\n\t\t\t\tif (ns == \"root\")\n\t\t\t\t\tdragPos = EventDispatcher.mouse(this.root, event);\n\t\t\t\telse\n\t\t\t\t\tdragPos = this.getPosition(event);\n\n\t\t\t\tlet info = this.getEventInfo(event);\n\t\t\t\tif (this.dragging) {\n\t\t\t\t\tthis.dragging = false;\n\t\t\t\t\tthis.dispatch(event, 'dragend', ns, dragObject.data, dragPos);\n\t\t\t\t} else {\n\t\t\t\t\tthis.dispatch(event, 'mouseup', ns, info.data, dragPos);\n\t\t\t\t}\n\n\t\t\t\tEvents.off(window, 'mousemove', mousemove);\n\t\t\t\tEvents.off(window, 'mouseup', mouseup);\n\t\t\t};\n\t\t\tevent.preventDefault();\n\t\t\tEvents.on(window, 'mousemove', mousemove);\n\t\t\tEvents.on(window, 'mouseup', mouseup);\n\t\t}\n\n\t\tif (!isKeyEvent)\n\t\t\tthis.simulateEnterLeave(event, type, ns, data, pos);\n\t\tthis.dispatch(event, type, ns, data, pos);\n\n\t\t// disable the default context menu\n\t\t//if (type == 'contextmenu')\n\t\t//\tevent.preventDefault();\n\t}\n\n\t/**\n\t * try to simulate mouseenter/mouseleave events.\n\t */\n\tsimulateEnterLeave(event, type, ns, data, pos) {\n\t\tlet last, stack;\n\t\tconst clearEnterStack = (k) => {\n\t\t\tk = k || 0;\n\t\t\t// Clear off the enter stack.\n\t\t\twhile (this.enterStack.length >= k + 1) {\n\t\t\t\tlast = this.enterStack.pop();\n\t\t\t\tthis.dispatch(event, 'mouseleave', last.ns, last.data, pos);\n\t\t\t}\n\t\t};\n\t\tconst getNS = function(index) {\n\t\t\tlet buf = new StringBuffer();\n\t\t\tfor (let i = 0; i <= index; i++) {\n\t\t\t\tvar val = stack[i].getAttribute(\"ns\");\n\t\t\t\tif (_.startsWith(val, \"root.\"))\n\t\t\t\t\tval = val.substring(5);\n\t\t\t\tbuf.append(val);\n\t\t\t}\n\t\t\treturn buf.toString('.');\n\t\t};\n\n\t\tif (ns && ns != this.rootNS) {\n\t\t\tif (type == 'mouseover') {\n\t\t\t\tstack = event.targetStack;\n\t\t\t\tlet item;\n\t\t\t\tfor (let i = 0; i < stack.length; i++) {\n\t\t\t\t\tif (i < this.enterStack.length) {\n\t\t\t\t\t\tif (this.enterStack[i].target != stack[i]) {\n\t\t\t\t\t\t\tclearEnterStack(i);\n\t\t\t\t\t\t} else\n\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\t\t\t\t\titem = {data: data, ns: getNS(i), target: stack[i]};\n\t\t\t\t\tthis.enterStack.push(item);\n\t\t\t\t\tthis.dispatch(event, 'mouseenter', item.ns, data, pos);\n\t\t\t\t}\n\t\t\t\tif (stack.length < this.enterStack.length)\n\t\t\t\t\tclearEnterStack(stack.length);\n\t\t\t}\n\t\t}\n\t\tif (ns == this.rootNS && this.enterStack.length > 0)\n\t\t\tclearEnterStack();\n\t}\n\n\tdispatch(event, type, ns, data, pos) {\n\t\t//if (type != 'mouseover' && type != 'mouseout')\n\t\t//\tUtils.log('EventDispatcher', \"dispatch - \" + type + '.' + ns + ';' + pos + ';rootTarget=' + event.rootTarget + ';data=' + data);\n\t\tif (!this.started) return;\n\t\tconst nsType = ns ? type + '.' + ns : type;\n\t\t_.forEach(this.listeners, (listeners, key) => {\n\t\t\tif (EventDispatcher.match(nsType, listeners.regexp ? listeners.regexp : key)) {\n\t\t\t\t_.forEach(listeners, (listener) => {\n\t\t\t\t\tif (!listener.context)\n\t\t\t\t\t\tlistener.callback.apply(window, [type, ns, data, pos, event]);\n\t\t\t\t\telse\n\t\t\t\t\t\tlistener.callback.apply(listener.context, [type, ns, data, pos, event]);\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\n\t\t// after dispatching, do not propagate.\n\t\tif (this.stopPropagation && event.stopPropagation)\n\t\t\tevent.stopPropagation();\n\t}\n\n\tgetPosition(event) {\n\t\tconst pos = EventDispatcher.mouse(this.root, event);\n\t\tif(! _.isNaN(pos[0]) && ! _.isNaN(pos[1]))\n\t\t\tthis.lastPosition = pos;\n\t\treturn this.lastPosition;\n\t}\n\n\t/**\n\t * Registers a key event handler\n\t * // Key is object {ctrl, alt, shift, meta, code}\n\t */\n\tregisterKey(type, key, callback, context) {\n\t\tif (_.isArray(key)) {\n\t\t\t_.forEach(key, (k) => {\n\t\t\t\tthis.registerKey(type, k, callback, context);\n\t\t\t});\n\t\t\treturn;\n\t\t}\n\t\tkey = KeyUtils.getKeyData(key.ctrl, key.alt, key.shift, key.meta, key.code);\n\t\tif(!key.length) return;\n\t\tkey = new StringBuffer(type).append(key).toString('.');\n\n\t\tconst listener = {callback: callback, context: context};\n\t\tthis.listeners[key] || (this.listeners[key] = []);\n\t\tthis.listeners[key].push(listener);\n\t}\n\n\tunregisterKey(type, key, callback, context) {\n\t\tif (_.isArray(key)) {\n\t\t\t_.forEach(key, (k) => {\n\t\t\t\tthis.unregisterKey(type, k, callback, context);\n\t\t\t});\n\t\t\treturn;\n\t\t}\n\t\tkey = KeyUtils.getKeyData(key.ctrl, key.alt, key.shift, key.meta, key.code);\n\t\tif(!key.length) return;\n\t\tkey = new StringBuffer(type).append(key).toString('.');\n\n\t\tlet listeners = this.listeners[key], listener;\n\t\tif (!listeners) return;\n\t\tfor (let i = 0; i < listeners.length; i++) {\n\t\t\tlistener = listeners[i];\n\t\t\tif (listener.callback === callback && (!context || context === listener.context)) {\n\t\t\t\tlisteners.splice(i, 1);\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * Registers an event handler\n\t */\n\tregister(type, callback, context, zIndex) {\n\t\tif (_.isArray(type)) {\n\t\t\t_.forEach(type, (t) => {\n\t\t\t\tthis.register(t, callback, context, zIndex);\n\t\t\t});\n\t\t\treturn;\n\t\t}\n\t\tconst listener = {callback: callback, context: context, zIndex: zIndex};\n\t\tvar regexp = null;\n\t\tif (type instanceof RegExp) {\n\t\t\tregexp = type;\n\t\t\ttype = type + '';\n\t\t}\n\t\tthis.listeners[type] || (this.listeners[type] = []);\n\t\tif (regexp && !this.listeners[type].regexp)\n\t\t\tthis.listeners[type].regexp = regexp;\n\t\tthis.listeners[type].push(listener);\n\t}\n\n\tunregister(type, callback, context) {\n\t\tif (type instanceof RegExp)\n\t\t\ttype = type + '';\n\t\tlet listeners = this.listeners[type], listener;\n\t\tif (!listeners) return;\n\t\tfor (let i = 0; i < listeners.length; i++) {\n\t\t\tlistener = listeners[i];\n\t\t\tif (listener.callback === callback && (!context || context === listener.context)) {\n\t\t\t\tlisteners.splice(i, 1);\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t}\n\n\tdestroy() {\n\t\tthis.stop();\n\t\tdelete this.root;\n\t\tdelete this.listeners;\n\t\tdelete this.enterStack;\n\t}\n\n\t/**\n\t * Check if the registered event type matches the real event type. \"*\" is allowed as a wild card.\n\t */\n\tstatic match(nsType, registeredType) {\n\t\tif (registeredType instanceof RegExp)\n\t\t\treturn nsType.match(registeredType);\n\n\t\treturn nsType == registeredType;\n\t\t/*const arr = registeredType.split('*');\n\t\tif (arr.length == 1)\n\t\t\treturn nsType == registeredType;\n\n\t\tlet substr, index = 0;\n\t\tfor (let i = 0; i < arr.length; i++) {\n\t\t\tif (arr[i].length == 0) continue;\n\t\t\tsubstr = nsType.slice(index);\n\t\t\tindex = substr.indexOf(arr[i]);\n\t\t\tif (index < 0)\n\t\t\t\treturn false;\n\t\t\tindex += arr[i].length;\n\t\t}\n\t\treturn true;*/\n\t}\n\n\tstatic mouse(container, e) {\n\t\tif (e.changedTouches) e = e.changedTouches[0];\n\t\tvar svg = container.ownerSVGElement || container;\n\t\tif (svg.createSVGPoint) {\n\t\t\tvar point = svg.createSVGPoint();\n\t\t\tpoint.x = e.clientX; point.y = e.clientY;\n\t\t\tpoint = point.matrixTransform(container.getScreenCTM().inverse());\n\t\t\treturn [point.x, point.y];\n\t\t}\n\t\tvar rect = container.getBoundingClientRect();\n\t\treturn [e.clientX - rect.left - container.clientLeft, e.clientY - rect.top - container.clientTop];\n\t}\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/event/EventDispatcher.js\n **/","///////////////////////////////////////////////////////////////////////////////\n//                                                                           //\n//           The Key Utility CLass for the Event Dispatcher          \t     //\n//                                                                           //\n///////////////////////////////////////////////////////////////////////////////\n\nimport StringBuffer from \"./../util/StringBuffer\";\n\n/**\n * KEY constant\n */\nconst KEY = {\n\tALT          : 18,\n\tBACK_SPACE   : 8,\n\tCAPS_LOCK    : 20,\n\tCONTROL      : 17,\n\tDELETE       : 46,\n\tDOWN         : 40,\n\tEND          : 35,\n\tENTER        : 13,\n\tESCAPE       : 220,\n\tHOME         : 36,\n\tLEFT         : 37,\n\tMETA         : 224,\n\tNUM_LOCK     : 144,\n\tPAGE_DOWN    : 34,\n\tPAGE_UP      : 33,\n\tPAUSE        : 19,\n\tPRINTSCREEN  : 44,\n\tRIGHT        : 39,\n\tSCROLL_LOCK  : 145,\n\tSHIFT        : 16,\n\tSPACE        : 32,\n\tTAB          : 9,\n\tUP           : 38\n\t//ADD          : DomUtils.isFireFox ? 61  : 187,\n\t//SUBTRACT     : DomUtils.isFireFox ? 173 : 189\n};\n\nexport function getKeyEvent(event) {\n\tif (!event || !event instanceof KeyboardEvent) {\n\t\treturn null;\n\t}\n\n\tvar key = event.keyCode || event.which;\n\n\t// Need to find a way to avoid this\n\tif (key >= 16 && key <= 18) {\n\t\tkey = null;\n\t}\n\n\treturn getKeyData(event.ctrlKey, event.altKey, event.shiftKey, event.metaKey, key);\n}\n\nexport function getKeyData(ctrl, alt, shift, meta, key) {\n\tvar buf = new StringBuffer();\n\n\tif (ctrl) buf.append(\"CTRL\");\n\tif (alt) buf.append(\"ALT\");\n\tif (shift) buf.append(\"SHIFT\");\n\tif (meta) buf.append(\"META\");\n\tif (key) buf.append(key);\n\n\treturn buf.toString(\".\");\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/event/KeyUtils.js\n **/","import _ from \"lodash\";\nimport Utils from \"../util/Utils\";\nimport Node from \"./Node\";\nimport Edge from \"./Edge\";\nimport Marker from \"../view/Marker\";\n\nconst nodeDefaults = {\n\tname: 'Default',\n\trole: 'node',\n\tdraggable: true,\n\tselectable: true,\n\teditable: true,\n\tresizable: false,\n\tsourceable: true,\n\ttargetable: true,\n\tvisible: true\n};\n\nconst edgeDefaults = {\n\tname: 'Default',\n\trole: 'edge',\n\tselectable: true,\n\tvisible: true,\n\tstartMarker: null,\n\tendMarker: {\n\t\tid: 'Default_EndMarker',\n\t\ttype: 'arrow',\n\t\tsize: 10,\n\t\tcolor: '#0ea117'\n\t},\n\t/* start and end is only used if the edge is not connected to a node */\n\tstart: [0, 0],\n\tend: [400, 200]\n};\n\nclass Graph {\n\tconstructor(id = _.uniqueId(\"G\"), config = {}, model) {\n\t\tthis.id = id;\n\n\t\tthis.nodes = {};\n\t\tthis.edges = {};\n\n\t\tthis.selection = null;\n\t\tthis.destroyed = false;\n\n\t\tUtils.buildTypes(config.nodeTypes, \"Nodes\", nodeDefaults);\n\t\tUtils.buildTypes(config.edgeTypes, \"Edges\", edgeDefaults);\n\t\t// check for markers.\n\t\tthis.markers = [];\n\t\tlet edgeTypes = Utils.type(Edge.namespace), marker, markerConfig;\n\t\tedgeTypes.forEach(function(type) {\n\t\t\tmarkerConfig = type.prototype.startMarker;\n\t\t\tif (markerConfig) {\n\t\t\t\tmarker = Marker.getMarker(markerConfig, true);\n\t\t\t\tthis.markers.push(marker);\n\t\t\t}\n\t\t\tmarkerConfig = type.prototype.endMarker;\n\t\t\tif (markerConfig) {\n\t\t\t\tmarker = Marker.getMarker(markerConfig, false);\n\t\t\t\tthis.markers.push(marker);\n\t\t\t}\n\t\t}, this);\n\n\t\tdelete config.nodeTypes;\n\t\tdelete config.edgeTypes;\n\t\tUtils.initConfig(this, config);\n\t\tthis.root = null;\n\t\tif (model)\n\t\t\tthis.loadModel(model);\n\t}\n\n\tstatic getJSClass(config, defaultClass) {\n\t\tvar jsClass = null;\n\t\tif (config && config.type) {\n\t\t\t// See if we can get the js class from config.\n\t\t\tvar type = Utils.type(defaultClass.namespace, config.type);\n\t\t\tif (type)\n\t\t\t\tjsClass = type.jsClass;\n\t\t}\n\n\t\treturn Utils.getConstructor(jsClass, defaultClass);\n\t}\n\n\t/**\n\t * Create a new Node\n\t */\n\taddNode(config, parent = this.currentRoot, pos) {\n\t\tlet NodeClass = Graph.getJSClass(config, Node);\n\t\tlet node = new NodeClass(this, config);\n\n\t\tif (parent)\n\t\t\tGraph.addChild(parent, node, pos);\n\t\telse {\n\t\t\tthis.root = node;\n\t\t\tthis.root.prop('role', 'root');\n\t\t}\n\n\t\tthis.nodes[node.id] = node;\n\t\treturn node;\n\t}\n\n\taddEdge(config, parent = this.currentRoot, from, to) {\n\t\tlet EdgeClass = Graph.getJSClass(config, Edge);\n\t\tlet edge = new EdgeClass(this, config, from, to);\n\n\t\tGraph.addChild(parent, edge);\n\t\tthis.edges[edge.id] = edge;\n\t\treturn edge;\n\t}\n\n\tstatic addChild(parent, child) {\n\t\tif (!parent.children)\n\t\t\tparent.children = [];\n\n\t\tif (child.parent != parent) {\n\t\t\tparent.children.push(child);\n\n\t\t\tif (child.parent && child.parent.children)\n\t\t\t\tchild.parent.children = _.without(child.parent.children, child);\n\t\t}\n\t\tchild.parent = parent;\n\t}\n\n\tloadModel(model, parent = this.currentRoot) {\n\t\tvar nodes = model.nodes;\n\t\tvar edges = model.edges;\n\t\tdelete model.nodes;\n\t\tdelete model.edges;\n\n\t\tvar node = this.addNode(model, parent);\n\t\tif (nodes) {\n\t\t\t_.forEach(nodes, (child) => {\n\t\t\t\tthis.loadModel(child, node);\n\t\t\t});\n\t\t}\n\t\tif (edges) {\n\t\t\t_.forEach(edges, (edge) => {\n\t\t\t\tlet from, to;\n\t\t\t\tif (edge.from)\n\t\t\t\t\tfrom = this.nodes[edge.from];\n\t\t\t\tif (edge.to)\n\t\t\t\t\tto = this.nodes[edge.to];\n\t\t\t\tthis.addEdge(edge, node, from, to);\n\t\t\t});\n\t\t}\n\t}\n\n\tget currentRoot() {\n\t\treturn this.root;\n\t}\n\n\treset() {}\n\tdestroy() {}\n}\n\nGraph.DEFAULTS = {\n\tallowDanglingEdges: true,\n\tmultiConnect: false,\n\treadOnly: false,\n\tviewOnly: false\n};\n\nexport default Graph;\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/graph/Graph.js\n **/","import _ from \"lodash\";\nimport StringBuffer from \"../util/StringBuffer\";\nimport Cell from \"./Cell\";\n\nclass Node extends Cell {\n\tconstructor(graph, config = {}) {\n\t\tif (!config.id) config.id = _.uniqueId('N');\n\t\tsuper(graph, config);\n\n\t\tthis.inEdges = [];\n\t\tthis.outEdges = [];\n\t\tthis.ports = null;\n\t\tthis.parent = null;\n\t}\n\n\tisAncestor(n) {\n\t\t// TODO: should we move this to graph class ?\n\t\tvar node = n.parent;\n\t\twhile (node) {\n\t\t\tif (this == node) { return true; }\n\t\t\tnode = node.parent;\n\t\t}\n\t\treturn false;\n\t}\n\n\tremoveEdge(edge) {\n\t\tvar edges = edge.source == this ? this.outEdges : this.inEdges;\n\t\tfor (var i = 0; i < edges.length; i++) {\n\t\t\tif (edge == edges[i]) {\n\t\t\t\tedges.splice(i, 1);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\n\t// Add a new incoming edge\n\taddInEdge(edge, pos) {\n\t\tif (pos == null || pos === undefined)\n\t\t\tthis.inEdges.push(edge);\n\t\telse\n\t\t\tthis.inEdges.splice(pos, 0, edge);\n\t}\n\n\t// Add a new outgoing edge\n\taddOutEdge(edge, pos) {\n\t\tif (pos == null || pos === undefined || pos > edge.length - 1)\n\t\t\tthis.outEdges.push(edge);\n\t\telse\n\t\t\tthis.outEdges.splice(pos, 0, edge);\n\t}\n\n\trenderChildren(view) {\n\t\tif (this.children) {\n\t\t\tlet buf = new StringBuffer();\n\t\t\t_.forEach(this.children, (child) => {\n\t\t\t\tbuf.append(child.render(view));\n\t\t\t});\n\t\t\treturn buf.toString();\n\t\t}\n\t\treturn '';\n\t}\n\n\tgetPort(key, portName = 'auto', endPt, orthogonal) {\n\t\tlet shape = this.getShape(key);\n\t\tif (portName == 'auto') {\n\t\t\treturn shape.getPerimeter(endPt, orthogonal);\n\t\t}\n\t\treturn null;\n\t}\n\n\ttoString() {\n\t\tvar label = this.prop(\"label\") ? this.prop(\"label\") : \"undefined\";\n\t\tif (_.isArray(label))\n\t\t\tlabel = label[0];\n\t\treturn 'Node:{id:' + this.id + ';label:' + label + ';type:' + this.props.constructor.typeName + '}';\n\t}\n}\nNode.namespace = \"Nodes\";\n\nexport default Node;\n\n/*\n\n/**\n * The DrillDownParent is the parent that displays the vertex when drilled down.\n *\nVertex.prototype.getDrillDownParent = function() {\n\treturn this.parent;\n};\n\nVertex.prototype.isLocked = function() {\n\tvar mode = this.getProperty(\"mode\") || 3;\n\treturn !(mode & Graph.ALLOW_INTERACTIONS);\n};\n\nVertex.prototype.getCrumbText = function() {\n\tif (this.isLocked())\n\t\treturn '<span><img src=\"webwb/pzreadonly.png\" /></span><span>&nbsp;' + this.getProperty(\"label\") + '</span>';\n\treturn this.getProperty(\"label\");\n};\n\nVertex.prototype.canEdit = function() {\n\treturn (!this.parent || !this.parent.isLocked()) && Vertex.superclass.canEdit.call(this);\n};\n\nVertex.prototype.isContainer = function() {\n\treturn this.getProperty(\"container\");\n};\n\n*/\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/graph/Node.js\n **/","import _ from \"lodash\";\nimport Utils from \"../util/Utils\";\nimport Cache from \"../util/Cache\";\nimport StringBuffer from \"../util/StringBuffer\";\nimport Shape from \"../geometry/Shape\";\nimport Rectangle from \"../geometry/Rectangle\";\nimport Label from \"../view/Label\";\n\n/**\n * The Cell is the common parent for Node and Edge.\n */\nexport default class Cell {\n\tconstructor(graph, config = {id: _.uniqueId()}) {\n\t\tthis.graph = graph;\n\t\tthis.id = config.id;\n\t\tdelete config.id;\n\n\t\t// Initialize decorators\n\t\tif (config.decorators) {\n\t\t\tthis.createDecorators(config.decorators);\n\t\t\tdelete config.decorators;\n\t\t}\n\n\t\t// Initialize View Properties\n\t\tif (config.views) {\n\t\t\tthis.viewProps = config.views;\n\t\t\tdelete config.views;\n\t\t}\n\n\t\t// Initialize type\n\t\tvar type = config.type || \"Default\";\n\t\ttype = Utils.type(this.constructor.namespace, type);\n\t\tif (!type)\n\t\t\tthrow new Error(\"Type not found \" + config.type);\n\t\tdelete config.type;\n\t\tthis.props = new type(config);\n\t}\n\n\tprop(name, value) {\n\t\tif (_.isUndefined(value))\n\t\t\treturn this.props[name];\n\t\tthis.props[name] = value;\n\t}\n\n\t/**\n\t * Get/Set property stored by views.\n\t * @param key\n\t * @param name\n\t * @param value\n\t * @returns {*}\n\t */\n\tviewProp(key = 'default', name, value) {\n\t\tif (_.isUndefined(value)) {\n\t\t\tif (key == 'default')\n\t\t\t\treturn this.prop(name, value);\n\t\t\treturn this.viewProps[key][name];\n\t\t}\n\t\tif (key == 'default') {\n\t\t\tthis.prop(name, value);\n\t\t} else {\n\t\t\tif (!this.viewProps[key])\n\t\t\t\tthis.viewProps[key] = {};\n\t\t\tthis.viewProps[key][name] = value;\n\t\t}\n\t}\n\n\tcreateDecorators(decorators) {}\n\n\t/**\n\t * Get properties needed for rendering this element\n\t * @returns {{key: (string|*), className: *, namespace: *, bounds: *}}\n\t */\n\tgetView(key) {\n\t\tlet shape = this.getShape(key);\n\t\treturn _.assign({\n\t\t\tid: this.id,\n\t\t\tkey: key,\n\t\t\tclassName: this.computedClassName,\n\t\t\tstyle: this.viewProp(key, 'style'),\n\t\t\tnamespace: this.namespace\n\t\t}, shape);\n\t}\n\n\tgetShape(key) {\n\t\tlet shape = Cache.get(this.id + \".shape\", key);\n\t\tif (shape) return shape;\n\n\t\tlet shapeConfig = this.viewProp(key, 'shape');\n\t\tlet shapeClass = shapeConfig ? Shape.getShape(shapeConfig.name) : Shape.getShape('Rectangle');\n\t\tlet x = this.viewProp(key, \"x\");\n\t\tlet y = this.viewProp(key, \"y\");\n\t\tlet width = this.viewProp(key, \"width\");\n\t\tlet height = this.viewProp(key, \"height\");\n\t\tshape = new shapeClass(x, y, width, height, shapeConfig);\n\t\tCache.set(this.id + '.shape', shape, key);\n\t\treturn shape;\n\t}\n\n\trender(view) {\n\t\tlet template = Cache.get(this.id + '.template', view.id);\n\t\tif (!template) {\n\t\t\t//create the template\n\t\t\tlet role = this.prop('role');\n\t\t\ttemplate = view.getTemplate('$' + role, null, this);\n\t\t\tif (_.isString(template))\n\t\t\t\ttemplate = _.template(template);\n\t\t\tCache.set(this.id + '.template', template, view.id);\n\t\t}\n\t\treturn template(this.getView(view.id));\n\t}\n\n\trenderShape(view) {\n\t\tlet shape = this.getShape(view.id);\n\t\tif (shape)\n\t\t\treturn shape.render(view);\n\t\treturn '';\n\t}\n\n\trenderLabel(view) {\n\t\tif (this == this.graph.currentRoot)\n\t\t\treturn null;\n\t\tlet box = this.getLabelBox(view.id);\n\t\tif (box)\n\t\t\treturn view.renderLabel(box);\n\t\treturn '';\n\t}\n\n\tgetLabelBox(key) {\n\t\tlet box = Cache.get(this.id + '.labelBox', key);\n\t\tif (box) return box;\n\t\tlet shape = this.getShape(key);\n\t\t// Just get the config will have a positive performance boost for IE11 and IE10.\n\t\tbox = Label.getLabelBox(this.prop('label'), this.viewProp(key, 'labelConfig'), shape.width, shape.height);\n\t\tCache.set(this.id + '.labelBox', box, key);\n\t\treturn box;\n\t}\n\n\tget computedClassName() {\n\t\tif (!this._computedClassName) {\n\t\t\tvar buf = new StringBuffer(this.prop(\"role\"));\n\t\t\tlet props = this.props;\n\t\t\tif (props.hasOwnProperty(\"className\"))\n\t\t\t\tbuf.append(props[\"className\"]);\n\t\t\tprops = props.constructor.prototype;\n\t\t\twhile (props) {\n\t\t\t\tif (props.hasOwnProperty(\"className\"))\n\t\t\t\t\tbuf.append(props[\"className\"]);\n\t\t\t\tprops = Object.getPrototypeOf(props);\n\t\t\t}\n\t\t\tthis._computedClassName = buf.toString(' ');\n\t\t}\n\t\treturn this._computedClassName;\n\t}\n\n\tget namespace() {\n\t\tif (this == this.graph.currentRoot) return '';\n\t\treturn \"root.\" + this.prop(\"role\");\n\t}\n\n\tdestroy() {\n\t\tdelete this.graph;\n\t\tdelete this.decorators;\n\t\tdelete this.props;\n\t\tdelete this.viewProps;\n\t\tthis.destroyed = true;\n\t}\n}\n\n/*\n\nCell.prototype.move = function(x, y) {\n\tthis.setProperty(\"x\", Math.round(x));\n\tthis.setProperty(\"y\", Math.round(y));\n\tdelete this.bounds;\n};\n\nCell.prototype.resize = function(w, h) {\n\tthis.setProperty(\"width\", w);\n\tthis.setProperty(\"height\", h);\n\tdelete this.bounds;\n};\n\nCell.prototype.canEdit = function() {\n\treturn (this.graph ? this.graph.canEdit() : true) && this.getProperty(\"editable\");\n};\n\nCell.prototype.canSelect = function() {\n\treturn (this.graph ? this.graph.canSelect() : true) && this.getProperty(\"selectable\");\n};\n\nCell.prototype.canMove = function() {\n\treturn (this.graph ? this.graph.canEdit() : true) && this.getProperty(\"draggable\");\n};\n\nCell.prototype.canResize = function() {\n\treturn (this.graph ? this.graph.canEdit() : true) && this.getProperty(\"resizable\");\n};\n\nCell.prototype.getTypeFromString = function(typeStr) {\n\treturn this.graph.getType(typeStr);\n};\n\nCell.prototype.createModifiers = function(modifiers) {\n\tthis.modifiers = null;\n\tvar modifierSettings = this.getProperty(\"modifierSettings\");\n\tif (modifierSettings) {\n\t\t_.each(modifiers, function(config) {\n\t\t\tconfig.type = this.graph.getModifierType(config.className);\n\t\t\tconfig.setting = modifierSettings[config.className];\n\t\t\tif (!config.type || !config.setting) return;\n\n\t\t\tthis.addModifier(config.className, new Modifier(this, config));\n\t\t}, this);\n\n\t\t// Check for showAlways settings\n\t\t_.each(modifierSettings, function(setting, name) {\n\t\t\tif (setting.showAlways && (!this.modifiers || !this.modifiers[name])) {\n\t\t\t\tvar config = {type: this.graph.getModifierType(name), setting: setting};\n\t\t\t\tif (!config.type) return;\n\t\t\t\tthis.addModifier(name, new Modifier(this, config));\n\t\t\t}\n\t\t}, this);\n\t}\n};\n\nCell.prototype.addModifier = function(name, modifier) {\n\tif (!this.modifiers)\n\t\tthis.modifiers = {};\n\n\tif (!modifier.hasOwnProperty(\"showHeader\"))\n\t\tmodifier.showHeader = true;\n\n\t// @hack preferably set it in configurations.\n\tif (modifier.name == \"HoverProcessModifier\" || modifier.name == \"HoverResults\")\n\t\tmodifier.showHeader = false;\n\n\tthis.modifiers[name] = modifier;\n};\n\nCell.prototype.getModifiers = function() {\n\tif (_.isUndefined(this.modifiers))\n\t\tthis.createModifiers();\n\treturn this.modifiers;\n};\n\nCell.prototype.getModifier = function(name) {\n\tvar modifiers = this.getModifiers();\n\tif (modifiers)\n\t\treturn modifiers[name];\n\treturn null;\n};\n\nCell.prototype.isVisible = function() {\n\treturn this.getProperty('visible');\n};\n\nCell.prototype.isContainer = function() {\n\treturn false;\n};\n*/\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/graph/Cell.js\n **/","/**\n * Created by tong on 6/7/2016.\n */\n\nlet caches = {};\n\nlet Cache = {\n\tget: function(key, namespace) {\n\t\treturn this.getCache(namespace)[key];\n\t},\n\n\tset: function(key, value, namespace) {\n\t\tthis.getCache(namespace)[key] = value;\n\t},\n\n\tcontains: function(key, namespace) {\n\t\treturn key in this.getCache(namespace);\n\t},\n\n\tremove: function(key, namespace) {\n\t\tdelete this.getCache(namespace)[key];\n\t},\n\n\tclear: function(namesapce) {\n\t\tif (!namespace)\n\t\t\tcaches = {};\n\t\telse if (caches[namespace])\n\t\t\tcaches[namespace] = {};\n\t},\n\n\tgetCache: function(namespace = 'default') {\n\t\tif (!caches[namespace])\n\t\t\tcaches[namespace] = {};\n\t\treturn caches[namespace];\n\t}\n};\n\nexport default Cache;\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/util/Cache.js\n **/","import _ from \"lodash\";\nimport Events from \"bean\";\nimport Utils from \"../util/Utils\";\nimport DomUtils from \"../util/DomUtils\";\nimport StringBuffer from \"../util/StringBuffer\";\nimport Rectangle from \"../geometry/Rectangle\";\n\nconst FONT_BOLD = 1, FONT_ITALIC = 2, FONT_UNDERLINE = 4, FONT_SHADOW = 8;\n\nlet defaultConfig = {\n\tfontSize: 11,\n\tfontFamily: \"Arial\",\n\tfontStyle: 0,\n\tfontColor: 'black',\n\tpadding: 0,\n\tlinePadding: 0,\n\talign: \"left\",\n\twidth: 0,\n\theight: 0,\n\trotation: null,\n\tgeometry: {x: 0, y: 0, anchorY: 0, offsetX: 0, offsetY: 0}\n};\n\n/**\n * The label object handles label sizing/positioning\n */\nexport default (function() {\n\tlet stringMeasureEl = null, measureDiv, baselineDiv;\n\n\t/**\n\t * Calculate the size of the string.\n\t */\n\tlet getStringSize = _.memoize(function(str, fontSize, fontFamily, bold) {\n\t\tfontSize = fontSize || 11;\n\t\tfontFamily = fontFamily || 'Arial,Helvetica';\n\t\tbold = !_.isUndefined(bold) ? bold: false;\n\n\t\t// first check if there is a string-measuring div available, if not, create now.\n\t\tif (!stringMeasureEl) {\n\t\t\tstringMeasureEl = DomUtils.createElement('iframe', {id:\"_ComputeStylesIframe\"}, {position:\"absolute\", visibility:\"hidden\", width:\"auto\"});\n\t\t\tdocument.body.appendChild(stringMeasureEl);\n\t\t\tvar doc = stringMeasureEl.contentWindow.document;\n\t\t\tdoc.open();\n\t\t\tdoc.write('<html><body>\\\n\t\t\t\t<div id=\"baselineDiv\" style=\"height:100px;\"><span style=\"line-height:0\">T</span><span style=\"height:100%;display:inline-block;\"></span></div>\\\n\t\t\t\t<div id=\"measureDiv\" style=\"position:absolute;width:auto;height:auto;padding:0;white-space:pre-wrap;word-wrap:break-word;display:inline-block;\"></div>\\\n\t\t\t\t</body></html>');\n\t\t\tdoc.close();\n\t\t\tmeasureDiv = doc.getElementById(\"measureDiv\");\n\t\t\tbaselineDiv = doc.getElementById(\"baselineDiv\");\n\t\t}\n\t\tbaselineDiv.style.fontSize = measureDiv.style.fontSize = fontSize;\n\t\tbaselineDiv.style.fontFamily = measureDiv.style.fontFamily = fontFamily;\n\t\tbaselineDiv.style.fontWeight = measureDiv.style.fontWeight = bold ? 'bold' : 'normal';\n\t\tmeasureDiv.innerHTML = str;\n\n\t\tlet strut = baselineDiv.firstChild;\n\t\tlet baselineHeight = strut.offsetTop + strut.offsetHeight - baselineDiv.offsetHeight - baselineDiv.offsetTop;\n\n\t\treturn {width: measureDiv.offsetWidth, height: measureDiv.offsetHeight, baseline: baselineHeight};\n\t}, function(str, fontSize, fontFamily, bold) { return str + ';' + fontSize + ';' + fontFamily + ';' + bold; });\n\n\t/**\n\t * Create a wrapped text.\n\t * @param {String} string the string to wrap.\n\t * @param {maxWidth} the maximum width this string can take.\n\t * @param {fontSize}\n\t * @param {fontFamily}\n\t * @param {bold}\n\t */\n\tlet wrap = _.memoize(function(string, maxWidth, fontSize, fontFamily, bold) {\n\t\tmaxWidth = maxWidth || 0;\n\t\tfontSize = fontSize || 11;\n\t\tfontFamily = fontFamily || 'Arial,Helvetica';\n\t\tbold = !_.isUndefined(bold) ? bold: false;\n\n\t\tlet arr = [];\n\t\tlet spaceSize = getStringSize(\"&nbsp;\", fontSize, fontFamily, bold), space = spaceSize.width;\n\t\tarr.lineHeight = spaceSize.height;\n\t\tarr.baseline = spaceSize.baseline;\n\n\t\tif (!maxWidth || !string || string == \"\") {\n\t\t\tarr.push(string);\n\t\t\tarr.width = (!string || string == \"\") ? space : getStringSize(string, fontSize, fontFamily, bold).width;\n\t\t\tarr.height = arr.lineHeight;\n\t\t\treturn arr;\n\t\t}\n\n\t\tvar width = 0;\n\t\t//split the text by lines\n\t\tvar lines = string.split('\\n');\n\n\t\tvar buf = new StringBuffer();\n\n\t\tfor (var j = 0; j < lines.length; j++) {\n\t\t\t//split each line by word\n\t\t\tvar words = lines[j].split(/\\s/);\n\t\t\tvar line = \"\", currentWidth = 0, wordWidth = 0, newLine = true, word;\n\n\t\t\tfor (var i = 0; i < words.length; i++) {\n\t\t\t\tword = words[i];\n\t\t\t\twordWidth = getStringSize(word, fontSize, fontFamily, bold).width;\n\n\t\t\t\tif ((newLine ? wordWidth : currentWidth + space + wordWidth) > maxWidth) {\n\t\t\t\t\tif (newLine) {\n\t\t\t\t\t\tbuf.append(word);\n\t\t\t\t\t\twidth = Math.max(width, wordWidth);\n\t\t\t\t\t\tif (i < words.length - 1) {\n\t\t\t\t\t\t\tarr.push(buf.toString());\n\t\t\t\t\t\t\tbuf.clear();\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tarr.push(buf.append(line).toString());\n\t\t\t\t\t\twidth = Math.max(width, currentWidth + space + wordWidth);\n\t\t\t\t\t\tbuf.clear();\n\t\t\t\t\t}\n\t\t\t\t\tline = \"\";\n\t\t\t\t\tcurrentWidth = 0;\n\t\t\t\t\tif (!newLine)\n\t\t\t\t\t\ti--; // move back one word.\n\t\t\t\t\tnewLine = true;\n\t\t\t\t} else {\n\t\t\t\t\tline = newLine ? word : line + \" \" + word;\n\t\t\t\t\tcurrentWidth = newLine ? wordWidth : currentWidth + space + wordWidth;\n\t\t\t\t\twidth = Math.max(width, currentWidth);\n\t\t\t\t\tnewLine = false;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (line != \"\")\n\t\t\t\tbuf.append(line);\n\t\t\tif (j < lines.length - 1) {\n\t\t\t\tarr.push(buf.toString());\n\t\t\t\tbuf.clear();\n\t\t\t}\n\t\t}\n\n\t\tarr.push(buf.toString());\n\t\tarr.width = width;\n\t\tarr.height = arr.lineHeight * arr.length;\n\t\treturn arr;\n\t}, function(str, maxWidth, fontSize, fontFamily, bold) { return str + ';' + maxWidth + ';' + fontSize + ';' + fontFamily + ';' + bold; });\n\n\t/**\n\t *  Get the view information for how to display the label.\n\t * @param label The string that needs to be displayed\n\t * @param containerWidth The width of the parent container.\n\t * @param containerHeight The height of the parent container.\n\t * @param labelConfig The configuration on how to display label. It should be an object with the following parameters:\n\t * {\n\t *      fontSize, fontFamily, fontStyle, padding,\n\t *      align: can be either \"left\", \"center\" or \"right\",\n\t *      width: the maximum width of the label. if less than 1, then is treated as percentage. If 0, no wrapping will occur,\n\t *      height,\n\t *      geometry\n\t * }\n\t * @returns {*}\n\t */\n\tfunction getLabelBox(label, labelConfig, containerWidth, containerHeight) {\n\t\treturn _getLabelBox.call(this, label, labelConfig, {width: containerWidth, height: containerHeight});\n\t}\n\n\tfunction getLabelBoxForLink(label, labelConfig, link) {\n\t\treturn _getLabelBox.call(this, label, labelConfig, link);\n\t}\n\n\tfunction _getLabelBox(label, labelConfig = {}, context) {\n\t\tlabelConfig = _.defaultsDeep(labelConfig, defaultConfig);\n\t\tlet fontSize = labelConfig.fontSize;\n\t\tlet fontFamily = labelConfig.fontFamily;\n\t\tlet fontStyle = labelConfig.fontStyle;\n\t\tlet bold = (fontStyle & FONT_BOLD) == FONT_BOLD;\n\t\tlet padding = labelConfig.padding;\n\t\tlet linePadding = labelConfig.linePadding;\n\t\tlet align = labelConfig.align;\n\n\t\tlet w = labelConfig.width, h = labelConfig.height;\n\t\tif (context.width) {\n\t\t\tw = w <= 5 ? context.width * w : w;\n\t\t\th = h <= 5 ? context.height * h : h;\n\t\t}\n\t\tw -= 2 * padding;\n\t\th -= 2 * padding;\n\t\tw = Math.max(0, w);\n\t\th = Math.max(0, h);\n\n\t\tlet geometry = _.clone(labelConfig.geometry);\n\t\tlet wrappedLabel = this.wrap(label, w, fontSize, fontFamily, bold);\n\t\tgeometry.width = wrappedLabel.width + 2 * padding;\n\t\tgeometry.height = wrappedLabel.height + 2 * padding + (wrappedLabel.length - 1) * linePadding;\n\t\tlet anchor = \"start\", dx = 0, setAnchorX = !_.has(geometry, \"anchorX\");\n\t\tswitch (align) {\n\t\t\tcase \"center\":\n\t\t\t\tanchor = \"middle\";\n\t\t\t\tif (setAnchorX) geometry.anchorX = 0;\n\t\t\t\tbreak;\n\t\t\tcase \"right\":\n\t\t\t\tanchor = \"end\";\n\t\t\t\tdx = wrappedLabel.width/2;\n\t\t\t\tif (setAnchorX) geometry.anchorX = -0.5;\n\t\t\t\tbreak;\n\t\t\tcase \"left\":\n\t\t\t\tdx = -wrappedLabel.width/2;\n\t\t\t\tif (setAnchorX) geometry.anchorX = 0.5;\n\t\t\t\tbreak;\n\t\t}\n\t\tlet pos;\n\t\tif (context.getRelativePosition)\n\t\t\tpos = context.getRelativePosition(geometry);\n\t\telse\n\t\t\tpos = Utils.getRelativePosition({width: context.width, height: context.height}, geometry);\n\n\t\tlet bounds = new Rectangle(pos[0], pos[1], geometry.width, geometry.height);\n\t\t// the pivot is the center of rotation when the label has a rotation specified.\n\t\tlet pivot = align == 'center' ? [0, 0] : (align == 'left' ? [-wrappedLabel.width/2, 0] : [wrappedLabel.width/2, 0]);\n\n\t\t// the maximum bounds for the label, used to position inline editor\n\t\tgeometry.width = Math.max(w + 2 * padding, geometry.width);\n\t\tgeometry.height = Math.max(h + 2 * padding, geometry.height);\n\n\t\tif (context.getRelativePosition)\n\t\t\tpos = context.getRelativePosition(geometry);\n\t\telse\n\t\t\tpos = Utils.getRelativePosition({width: context.width, height: context.height}, geometry);\n\n\t\tlet maxBounds = new Rectangle(pos[0], pos[1], geometry.width, geometry.height);\n\t\treturn {\n\t\t\tconfig: labelConfig, label: wrappedLabel, _label: label,\n\t\t\tbold, underline: fontStyle & FONT_UNDERLINE, italic: fontStyle & FONT_ITALIC, shadow: fontStyle & FONT_SHADOW,\n\t\t\tdx, dy: -geometry.height/2 + padding + wrappedLabel.lineHeight - wrappedLabel.baseline, anchor, lineHeight: wrappedLabel.lineHeight + linePadding,\n\t\t\tpivot, bounds, maxBounds\n\t\t};\n\t}\n\n\tfunction render(view, box) {\n\t\treturn view.renderLabel(box);\n\t}\n\n\tlet editor = {\n\t\tstart: function(key, container, box, refEl, textEl, scale = 1.0, singleLine = true) {\n\t\t\tif (this.input) {\n\t\t\t\tif (this.key != key) {\n\t\t\t\t\t// need to close the existing editor first\n\t\t\t\t\tthis.stop();\n\t\t\t\t} else\n\t\t\t\t\treturn;\n\t\t\t}\n\t\t\tvar tag = singleLine ? 'input' : 'textarea';\n\t\t\tthis.input = DomUtils.createElement(tag, {id:\"inlineEditor\", unselectable:\"off\"}, {position:\"absolute\", overflow:\"hidden\", padding:\"0px\", margin:\"0px\", border:\"transparent\"});\n\t\t\tif (singleLine) {\n\t\t\t\tEvents.on(this.input, 'keydown keyup', (event) => {\n\t\t\t\t\tif (event.keyCode == 13) {\n\t\t\t\t\t\tEvents.off(this.input, 'keydown keyup');\n\t\t\t\t\t\tthis.stop();\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t\tcontainer.appendChild(this.input);\n\n\t\t\tthis.key = key;\n\t\t\tthis.box = box;\n\t\t\tthis.refEl = refEl;\n\t\t\tthis.textEl = textEl;\n\n\t\t\tlet labelConfig = box.config;\n\t\t\tlet maxBounds = new Rectangle(box.maxBounds.x, box.maxBounds.y, box.maxBounds.width * scale, box.maxBounds.height * scale);\n\t\t\tlet pos = DomUtils.getCenterPosition(refEl, container);\n\t\t\tpos = [pos[0] + maxBounds.left, pos[1] + maxBounds.top];\n\n\t\t\tif (textEl)\n\t\t\t\ttextEl.style.visibility = 'hidden';\n\n\t\t\tDomUtils.setElement(this.input, null, {\n\t\t\t\tvisibility: 'visible',\n\t\t\t\tleft: pos[0] + \"px\",\n\t\t\t\ttop: pos[1] + \"px\",\n\t\t\t\twidth: maxBounds.width + 'px',\n\t\t\t\theight: maxBounds.height + 'px',\n\t\t\t\t\"font-family\": labelConfig.fontFamily,\n\t\t\t\t\"font-size\": (labelConfig.fontSize * scale) + 'px',\n\t\t\t\t\"font-weight\": (labelConfig.fontStyle & FONT_BOLD) == FONT_BOLD ? 'bold' : 'normal'\n\t\t\t\t/*\"color\": labelConfig.fontColor*/\n\t\t\t});\n\n\t\t\tthis.input.value = box._label;\n\t\t\tthis.input.focus();\n\t\t\tthis.input.select();\n\t\t\tEvents.fire(this, 'editor.start', [this.key]);\n\t\t},\n\n\t\tstop: function(cancel) {\n\t\t\tif (!this.input) return;\n\n\t\t\tcancel = cancel || false;\n\t\t\tif (this.textEl)\n\t\t\t\tthis.textEl.style.visibility = null;\n\n\t\t\tif (!cancel)\n\t\t\t\tEvents.fire(this, 'editor.update', [this.key, this.input.value]);\n\n\t\t\tEvents.fire(this, 'editor.stop', [this.key]);\n\n\t\t\t// remove the input\n\t\t\tthis.input.parentNode.removeChild(this.input);\n\t\t\tdelete this.input;\n\t\t\tdelete this.key;\n\t\t\tdelete this.box;\n\t\t\tdelete this.refEl;\n\t\t\tdelete this.textEl;\n\t\t}\n\t};\n\n\treturn {\n\t\tFONT_BOLD,\n\t\tFONT_ITALIC,\n\t\tFONT_UNDERLINE,\n\t\tFONT_SHADOW,\n\t\tgetStringSize,\n\t\twrap,\n\t\tgetLabelBox,\n\t\tgetLabelBoxForLink,\n\t\trender,\n\t\teditor\n\t};\n})();\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/view/Label.js\n **/","import _ from \"lodash\";\nimport Cell from \"./Cell\";\nimport Rectangle from \"../geometry/Rectangle\";\nimport Link from \"../geometry/Link\";\nimport Label from \"../view/Label\";\nimport Cache from \"../util/Cache\";\n\nclass Edge extends Cell {\n\tconstructor(graph, config = {}, source, target) {\n\t\tif (!config.id) config.id = _.uniqueId('E');\n\t\tsuper(graph, config);\n\n\t\tthis.source = this.target = null;\n\t\tthis.setSource(source, config.sourcePos);\n\t\tthis.setTarget(target, config.targetPos);\n\t}\n\n\tsetSource(node, pos) {\n\t\tthis.setTerminal(node, pos, 'source');\n\t}\n\n\tsetTarget(node, pos) {\n\t\tthis.setTerminal(node, pos, 'target');\n\t}\n\n\t/**\n\t * Internal methods to set either the source or target\n\t */\n\t setTerminal(node, pos, dir) {\n\t\tvar end = dir == 'source' ? this.source : this.target;\n\t\tif (end == node) {\n\t\t\t// simply change the position of the edge.\n\t\t\tif (node)\n\t\t\t\tnode.setEdgeAt(this, pos);\n\t\t} else {\n\t\t\tif (end) {\n\t\t\t\t// first remove the edge from the current end\n\t\t\t\tend.removeEdge(this);\n\t\t\t}\n\n\t\t\tif (node) {\n\t\t\t\tif (dir == 'source')\n\t\t\t\t\tnode.addOutEdge(this, pos);\n\t\t\t\telse\n\t\t\t\t\tnode.addInEdge(this, pos);\n\t\t\t}\n\t\t\tif (dir == 'source')\n\t\t\t\tthis.source = node;\n\t\t\telse\n\t\t\t\tthis.target = node;\n\t\t\t//this.clearPoints();\n\t\t}\n\t}\n\n\tgetLabelBox(key) {\n\t\tvar label = this.prop('label');\n\t\tif (label)\n\t\t\treturn Label.getLabelBoxForLink(label, this.viewProp(key, 'labelConfig'), this.getShape(key));\n\t\treturn null;\n\t}\n\n\t/**\n\t * Return a pair of points as reference to the calculation of start and end points.\n\t */\n\tgetReferencePoints(key) {\n\t\tlet pts = [];\n\t\tif (this.source)\n\t\t\tpts.push(this.source.getShape(key).center);\n\t\telse\n\t\t\tpts.push(this.viewProp(key, 'start'));\n\n\t\tif (this.target)\n\t\t\tpts.push(this.target.getShape(key).center);\n\t\telse\n\t\t\tpts.push(this.viewProp(key, 'end'));\n\n\t\treturn pts;\n\t}\n\n\tgetTerminalVisual(key, orthogonal) {\n\t\tlet refPts = this.getReferencePoints(key);\n\t\tlet terminals = [];\n\n\t\tlet getBound = function(pt) {\n\t\t\treturn new Rectangle(pt.x, pt.y, 3, 3);\n\t\t};\n\n\t\tif (this.source) {\n\t\t\tterminals.push(this.source.getPort(key, this.prop('sourcePort'), refPts[1], orthogonal));\n\t\t} else\n\t\t\tterminals.push({point: refPts[0], direction: Rectangle.getDirection(getBound(refPts[0]), refPts[1], true)});\n\n\t\tif (this.target) {\n\t\t\tterminals.push(this.target.getPort(key, this.prop('targetPort'), refPts[0], orthogonal));\n\t\t} else\n\t\t\tterminals.push({point: refPts[1], direction: Rectangle.getDirection(getBound(refPts[1]), refPts[0], true)});\n\t\treturn terminals;\n\t}\n\n\tgetShape(key) {\n\t\tlet shape = Cache.get(this.id + \".shape\", key);\n\t\tif (shape) return shape;\n\n\t\tlet config = this.viewProp(key, 'shape');\n\t\tshape = Link.getLink(this.getTerminalVisual(key, config.orthogonal), config, this.prop('startMarker'), this.prop('endMarker'));\n\t\tCache.set(this.id + '.shape', shape, key);\n\t\treturn shape;\n\t}\n\n\ttoString() {\n\t\treturn 'Edge:{' + (!this.source ? 'null' : this.source.id) + '--' + (!this.target ? 'null' : this.target.id) + '}';\n\t}\n\n\tdestroy() {\n\t\tsuper.destroy();\n\t\tthis.setSource(null);\n\t\tthis.setTarget(null);\n\t}\n}\nEdge.namespace = \"Edges\";\n\nexport default Edge;\n\n/*\n\nEdge.prototype.isVisible = function() {\n\tif (this.graph.getProperty(\"allowDanglingEdges\")) {\n\t\treturn (this.source ? this.source.isVisible() : true) && (this.target ? this.target.isVisible() : true) && this.getProperty(\"visible\");\n\t} else\n\t\treturn this.source && this.target && this.getProperty('visible') && this.source.isVisible() && this.target.isVisible();\n};\n\n*/\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/graph/Edge.js\n **/","import Rectangle from \"../geometry/Rectangle\";\n\nlet registry = {};\n\nlet Marker = (function() {\n\n\t/** Begin Standard Marker Type **/\n\tfunction arrow(size, source, styles) {\n\t\tvar sign = source ? -1 : 1;\n\t\tvar marker = {\n\t\t\tviewBox: new Rectangle(-5, -5, 10, 10),\n\t\t\tsize: size,\n\t\t\tref: [4*sign, 0],\n\t\t\tfill: styles.color\n\t\t};\n\t\tmarker.shape = {\n\t\t\tname: 'Polygon',\n\t\t\tpoints: [[-2*sign, 0], [-4*sign, 4], [4*sign, 0], [-4*sign, -4]]\n\t\t};\n\t\treturn marker;\n\t}\n\n\tfunction triangle(size, source, styles) {\n\t\tvar sign = source ? -1 : 1;\n\t\tvar marker = {\n\t\t\tviewBox: new Rectangle(-5, -5, 10, 10),\n\t\t\tsize: size,\n\t\t\tref: [4*sign, 0],\n\t\t\tfill: styles.color\n\t\t};\n\t\tmarker.shape = {\n\t\t\tname: 'Polygon',\n\t\t\tpoints: [[-5*sign, -5], [-5*sign, 5], [4*sign, 0]]\n\t\t};\n\t\treturn marker;\n\t}\n\n\tfunction oval(size, source, styles) {\n\t\tvar r = size / 2;\n\t\tvar marker = {\n\t\t\tviewBox: new Rectangle(-r, -r, size, size),\n\t\t\tsize: size,\n\t\t\tref: [0, 0],\n\t\t\tfill: styles.color\n\t\t};\n\t\tmarker.shape = '<ellipse cx=\"0\" cy=\"0\" rx=\"' + r + '\" ry=\"' + r + '\"></ellipse>';\n\t\treturn marker;\n\t}\n\n\tfunction diamond(size, source, styles) {\n\t\tvar sign = source ? -1 : 1;\n\t\tvar marker = {\n\t\t\tviewBox: new Rectangle(-5, -5, 10, 10),\n\t\t\tsize: size,\n\t\t\tref: [4*sign, 0],\n\t\t\tfill: styles.color\n\t\t};\n\t\tmarker.shape = '';\n\t\treturn marker;\n\t}\n\t/** End Standard Marker Type **/\n\tfunction getMarker(config, source) {\n\t\tvar factory = registry[config.type];\n\t\tvar marker = factory(config.size, source, config);\n\t\tmarker.id = config.id;\n\t\treturn marker;\n\t}\n\n\tregistry['arrow'] = arrow;\n\tregistry['triangle'] = triangle;\n\tregistry['oval'] = oval;\n\tregistry['diamond'] = diamond;\n\n\treturn {\n\t\tregistry: registry,\n\t\tgetMarker: getMarker\n\t};\n})();\n\nexport default Marker;\n\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/view/Marker.js\n **/","import _ from \"lodash\";\nimport Utils from \"../util/Utils\";\n\nclass Layout {\n\tconstructor(config={}) {\n\t\tif (config.hasOwnProperty(\"orientation\") && _.isString(config.orientation)) {\n\t\t\tif (config.orientation.toUpperCase() == \"HORIZONTAL\")\n\t\t\t\tconfig.orientation = Layout.HORIZONTAL;\n\t\t\telse\n\t\t\t\tdelete config.orientation;\n\t\t}\n\t\tUtils.initConfig(this, config);\n\t}\n\n\tlayout(root, bounds) {}\n\treset() {}\n\tdestroy() {}\n}\nLayout.VERTICAL = 0;\nLayout.HORIZONTAL = 1;\n\nLayout.DEFAULTS = {\n\torientation: Layout.VERTICAL\n};\n\nexport default Layout;\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/layout/Layout.js\n **/","import Layout from \"./Layout\";\n\nclass FlowLayout extends Layout {\n\tlayout(root, bounds) {\n\t\tvar items;\n\t\tif (!root)\n\t\t\titems = this.owner.childNodes;\n\t\telse if (_.isArray(root))\n\t\t\titems = root;\n\t\telse\n\t\t\titems = root.getLinkedNodes('target');\n\t\tif (!items || items.length == 0) return;\n\n\t\tvar x = 0, y = 0, h = 0, node;\n\t\tvar p1 = 0, p2 = 0;\n\t\tfor (var i = 0; i < items.length; i++) {\n\t\t\tnode = items[i];\n\t\t\tif (x > 0 && x + this.hgap + node.getProperty(\"width\") > bounds.width) {\n\t\t\t\t// create new line\n\t\t\t\ty += h + this.vgap;\n\t\t\t\tx = 0;h = 0;p1 = 0;p2++;\n\t\t\t}\n\t\t\tnode._flPos = [p1, p2];\n\t\t\tnode.moveTo([bounds.x + x, bounds.y + y]);\n\t\t\tx += this.hgap + node.getProperty(\"width\");\n\t\t\tp1++;\n\t\t\th = h < node.getProperty(\"height\") ? node.getProperty(\"height\") : h;\n\t\t}\n\t\tthis.trigger(new Rectangle(bounds.x, bounds.y, bounds.width, y + h));\n\t}\n}\n\nFlowLayout.DEFAULTS = {\n\thgap: 10,\n\tvgap: 10\n};\n\nexport default FlowLayout;\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/layout/FlowLayout.js\n **/","import _ from \"lodash\";\nimport Events from \"bean\";\nimport Utils from \"../util/Utils\";\nimport DomUtils from \"../util/DomUtils\";\nimport Layout from \"../layout/Layout\";\nimport Rectangle from \"../geometry/Rectangle\";\nimport EventDispatcher from \"../event/EventDispatcher\";\nimport GraphBehavior from \"../behavior/GraphBehavior\";\nimport SelectionBehavior from \"../behavior/SelectionBehavior\";\nimport Label from \"./Label\";\n\nclass Renderer {\n\tconstructor(id, container, config = {}, graph = null) {\n\t\tthis.id = id;\n\t\tthis.box = DomUtils.createElement('div', {id: this.id, tabindex: 0, ns: 'graph'}, {overflow: \"hidden\", width: \"100%\", height: \"100%\", position: 'relative'});\n\t\tcontainer.appendChild(this.box);\n\t\tif (config.layout) {\n\t\t\tlet layoutClass = Utils.getConstructor(config.layout.jsClass, Layout);\n\t\t\tthis.layout = new layoutClass(config.layout.config);\n\t\t\tdelete config.layout;\n\t\t}\n\t\tthis.clear = true;\n\t\tthis._translate = [0, 0];\n\t\tthis._scale = 1.0;\n\t\tthis.graph = graph;\n\t\tthis.dispatcher = null;\n\t\tthis.graphBehavior = null;\n\t\tthis.selectionBehavior = null;\n\t\tthis.nodeBehavior = null;\n\t\tthis.edgeBehavior = null;\n\t\tthis.connectionBehavior = null;\n\t\tUtils.initConfig(this, config);\n\n\t\tEvents.on(Label.editor, 'editor.update.*', function(key, value) {\n\t\t\tconsole.log(key + '=' + value);\n\t\t});\n\t}\n\n\tget graph() {\n\t\treturn this._graph;\n\t}\n\n\tset graph(graph) {\n\t\tthis._graph = graph;\n\t\tlet root = graph.currentRoot;\n\t\tif (root) {\n\t\t\tthis._translate = [root.viewProp(this.id, 'x') || 0, root.viewProp(this.id, 'y') || 0];\n\t\t\tthis._scale = root.viewProp(this.id, 'scale') || 1.0;\n\t\t}\n\t}\n\n\tviewport(scaled, viewport) {\n\t\tif (_.isUndefined(scaled) || _.isNull(scaled)) scaled = false;\n\t\tif (!viewport) {\n\t\t\tvar vp = new Rectangle(0, 0, this.box.offsetWidth, this.box.offsetHeight);\n\t\t\tif (scaled)\n\t\t\t\treturn Utils.scale(this.translate, this.scale, vp);\n\t\t\treturn vp;\n\t\t}\n\t\tif (!scaled) viewport = Utils.scale(this.translate, this.scale, viewport);\n\t\tvar w = this.box.offsetWidth;\n\t\tvar scale = w / viewport.width;\n\t\tthis.transform(-viewport.x*scale, -viewport.y*scale, scale);\n\t}\n\n\tget translate() { return this._translate; }\n\tset translate(t) { this.transform(t[0], t[1]); }\n\tget scale() { return this._scale; }\n\tset scale(k) {\n\t\tswitch (k) {\n\t\t\tcase \"in\":\n\t\t\t\tk = this.scale * this.prop(\"zoomFactor\");\n\t\t\t\tbreak;\n\t\t\tcase \"out\":\n\t\t\t\tk = this.scale / this.prop(\"zoomFactor\");\n\t\t\t\tbreak;\n\t\t\tcase \"actual\":\n\t\t\t\tk = 1.0;\n\t\t\t\tbreak;\n\t\t\tcase \"fit\":\n\t\t\t\tvar gridSize = this.prop(\"gridSize\") * 2;\n\n\t\t\t\tvar gBounds = this.getBounds();\n\t\t\t\tvar vBounds = this.viewport();\n\n\t\t\t\tvBounds.width -= gridSize;\n\t\t\t\tvBounds.height -= gridSize;\n\n\t\t\t\t/* Do not zoom more than actual if graph already fits into the bounds */\n\t\t\t\tk = Math.min((vBounds.width / gBounds.width), (vBounds.height /gBounds.height), 1.0);\n\n\t\t\t\t//TODO: Add centering code here or trigger an event for that\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tif (_.isString(k)) k = parseFloat(k);\n\t\t\t\tbreak;\n\t\t}\n\t\tthis.transform(null, null, k);\n\t}\n\n\ttransform(x = null, y = null, scale = null) {\n\t\tlet graph = this.graph;\n\t\tlet root = graph ? graph.currentRoot : null;\n\t\tif (!_.isNull(x)) {\n\t\t\tthis._translate[0] = x;\n\t\t\tif (root)\n\t\t\t\troot.viewProp(this.id, 'x', x);\n\t\t}\n\t\tif (!_.isNull(y)) {\n\t\t\tthis._translate[1] = y;\n\t\t\tif (root)\n\t\t\t\troot.viewProp(this.id, 'y', y);\n\t\t}\n\t\tif (!_.isNull(scale)) {\n\t\t\tthis._scale = scale;\n\t\t\tif (root)\n\t\t\t\troot.viewProp(this.id, 'scale', scale);\n\t\t\t// sync the scale between the dispatcher and the graph\n\t\t\tlet s = this.dispatcher.scale;\n\t\t\tif (s != scale)\n\t\t\t\tthis.dispatcher.scale = scale;\n\t\t}\n\t\tthis.refresh();\n\t}\n\n\trender() {\n\t\tif (!this._graph) return false;\n\t\tif (this.layout)\n\t\t\tthis.layout.layout(this._graph.currentRoot, this.viewport());\n\n\t\tthis.initializeBehaviors();\n\t\treturn true;\n\t}\n\n\trenderLabel(box) {\n\t\treturn this.constructor.renderLabel(box);\n\t}\n\n\trenderLink(shape) {\n\t\treturn this.constructor.renderLink(shape);\n\t}\n\n\trenderMarkers(markers) {\n\t\treturn this.constructor.renderMarkers(markers);\n\t}\n\n\tinitializeBehaviors() {\n\t\t// create the event dispatcher if necessary.\n\t\tif (!this.dispatcher) {\n\t\t\tthis.dispatcher = new EventDispatcher(this.box, [this.prop('minZoom'), this.prop('maxZoom')]);\n\t\t\tlet jsClass;\n\t\t\tif (this.prop('graphBehavior')) {\n\t\t\t\tjsClass = Utils.getConstructor(this.prop('graphBehavior'));\n\t\t\t\tthis.graphBehavior = new jsClass(this);\n\t\t\t}\n\t\t\tif (this.prop('selectionBehavior')) {\n\t\t\t\tjsClass = Utils.getConstructor(this.prop('selectionBehavior'));\n\t\t\t\tthis.selectionBehavior = new jsClass(this);\n\t\t\t}\n\t\t\t/*this.dispatcher.register('mouseup.node.label', function(type, ns, target, pos, event) {\n\t\t\t\tlet node = this._graph.nodes[target.getAttribute('id')];\n\t\t\t\tif (!this.dispatcher.dragging && !node._firstSelection) {\n\t\t\t\t\tLabel._delayEdit = _.delay(() => {\n\t\t\t\t\t\tif (Label._delayEdit) {\n\t\t\t\t\t\t\tdelete Label._delayEdit;\n\t\t\t\t\t\t\tLabel.editor.start(node.id, this.box, node.getLabelBox(this.id), target, event.nsTarget, this.scale);\n\t\t\t\t\t\t}\n\t\t\t\t\t}, 250);\n\t\t\t\t}\n\t\t\t}, this);\n\t\t\tthis.dispatcher.register([/^mousedown/, /^zoom/], function(type, ns, target, pos, event) {\n\t\t\t\tif (!DomUtils.eventFromInput(event)) {\n\t\t\t\t\tLabel.editor.stop();\n\t\t\t\t}\n\t\t\t}, this);*/\n\t\t}\n\t\tthis.dispatcher.start();\n\t}\n\n\trefresh() {}\n\n\t/**\n\t * Get the template for the specified key.\n\t * @param key\n\t * @param config if the template is a function, this config will be passed as the argument.\n\t * @param preprocessor if the template contains preprossing elements, such as #{shape}, the preprocessor will be\n\t * used to render them.\n\t * @returns {*}\n\t */\n\tgetTemplate(key, config, preprocessor) {\n\t\tvar t = this.constructor.TEMPLATES[key];\n\t\tif (t && _.isFunction(t)) {\n\t\t\tt = t(config);\n\t\t}\n\t\t// check if there are any preprocessing tags.\n\t\tif (preprocessor) {\n\t\t\tvar parts = t.match(/(#{[^#]*})/g);\n\t\t\tvar obj = {};\n\t\t\tfor (let part in parts) {\n\t\t\t\tpart = parts[part];\n\t\t\t\tpart = part.substring(2, part.length -1).trim();\n\t\t\t\tobj[part] = preprocessor[_.camelCase('render ' + part)](this);\n\t\t\t}\n\t\t\tt = _.template(t, {interpolate: /#{([\\s\\S]+?)}/g})(obj);\n\t\t}\n\t\treturn t;\n\t}\n\n\treset() {}\n\n\tdestroy() {\n\t\tdelete this._graph;\n\t\tdelete this.layout;\n\t\tif (this.dispatcher) {\n\t\t\tthis.dispatcher.stop();\n\t\t\tdelete this.dispatcher;\n\t\t}\n\t\tthis.box.innerHTML = '';\n\t}\n}\nRenderer.DEFAULTS = {\n\tdefaultClickMode: \"pan\",\n\thideOutline: false,\n\tsingleSelect: true,\n\tdraggable: true,\n\tgridEnabled: false,\n\tguidesEnabled: true,\n\tgridSize: 30,\n\tmaxZoom: 4.0,\n\tminZoom: 0.2,\n\tzoomFactor: 1.2,\n\tmaskOpacity: 0.5,\n\tgraphBehavior: GraphBehavior,\n\tselectionBehavior: SelectionBehavior\n};\n\nexport default Renderer;\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/view/Renderer.js\n **/","/**\n * Created by tong on 6/28/2016.\n */\nimport Behavior from \"./Behavior\";\n\n/**\n * Graph handler handles Panning and Zoom and rubber band selection\n */\nclass GraphBehavior extends Behavior {\n\tconstructor(renderer) {\n\t\tsuper(renderer);\n\t\tlet dispatcher = renderer.dispatcher;\n\t\tlet f = function(type, ns, graph, pos, event) {\n\t\t\t//Cursor.updateCursor(type, ns, graph, event);\n\t\t};\n\t\tdispatcher.register(/^drag.*\\.graph$/, this.handleDrag, this);\n\t\tdispatcher.register(/^zoom/, this.handleZoom, this);\n\t\t//dispatcher.register(['mousedown.graph', 'mouseenter.graph', 'mouseleave.graph'], f);\n\t\tthis.offset = null;\n\t}\n\n\thandleZoom(type, ns, graph, pos, event) {\n\t\tthis.renderer.transform(null, null, event.scale);\n\t}\n\n\thandleDrag(type, ns, graph, pos, event) {\n\t\tif (type == 'dragstart') {\n\t\t\tlet pan = (this.renderer.prop(\"defaultClickMode\") == \"pan\") ^ (event.ctrlKey || event.shiftKey);\n\t\t\tif (!pan) return;\n\t\t\tlet t = this.renderer.translate;\n\t\t\tthis.offset = [t[0] - pos[0], t[1] - pos[1]];\n\t\t\treturn;\n\t\t}\n\t\tif (!this.offset) return;\n\t\tthis.renderer.transform(pos[0] + this.offset[0], pos[1] + this.offset[1]);\n\t\tif (type == 'dragend') {\n\t\t\t//Cursor.updateCursor('mouseup', ns, graph, event);\n\t\t\tdelete this.offset;\n\t\t}\n\t}\n}\n\nexport default GraphBehavior;\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/behavior/GraphBehavior.js\n **/","export default class Behavior {\n\tconstructor(renderer) {\n\t\tthis.renderer = renderer;\n\t}\n\n\tdestroy() {\n\t\tdelete this.renderer;\n\t}\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/behavior/Behavior.js\n **/","import Rectangle from \"../geometry/Rectangle\";\nimport Cell from \"../graph/Cell\";\nimport Behavior from \"./Behavior\";\n\nclass SelectionBehavior extends Behavior {\n\tconstructor(renderer) {\n\t\tsuper(renderer);\n\t\tlet dispatcher = renderer.dispatcher;\n\t\tdispatcher.register('mousedown.*', this.selectCell, this);\n\t\tdispatcher.register('mouseup.*', this.unselectCell, this);\n\t\tdispatcher.register('drag*.graph', this.handleMultiSelect, this);\n\t\t//graph.on(Graph.EVENT_TYPES.SELECTION_CHANGE, this.updateSelections, this);\n\t\tthis.selectedNodes = null;\n\t\tthis.selectedLinks = null;\n\t\tthis.attachedLinks = null;\n\t}\n\n\tupdateSelections() {\n\t\tif (this.selectedNodes)\n\t\t\tthis.selectedNodes.classed('selected', false);\n\t\tif (this.selectedLinks)\n\t\t\tthis.selectedLinks.classed('selected', false);\n\n\t\tthis.selectedNodes = null;\n\t\tthis.selectedLinks = null;\n\t\tthis.attachedLinks = null;\n\n\t\tif (this.graph.selectedVertices && this.graph.selectedVertices.length > 0) {\n\t\t\tthis.selectedNodes = this.graph.renderer.getShapes(this.graph.selectedVertices);\n\t\t\tthis.attachedLinks = this.graph.renderer.getShapes(this.graph.getAttachedEdges());\n\t\t\tthis.selectedNodes.classed('selected', true);\n\t\t}\n\n\t\tif (this.graph.selectedEdges && this.graph.selectedEdges.length > 0) {\n\t\t\tthis.selectedLinks = this.graph.renderer.getShapes(this.graph.selectedEdges);\n\t\t\tthis.selectedLinks.classed('selected', true);\n\t\t}\n\t}\n\n\tselectCell(type, ns, data, pos, event) {\n\t\tvar cell = data == this.graph ? null : data;\n\t\tif (cell && !(cell instanceof Cell)) return;\n\t\tvar toggle = event.ctrlKey || event.shiftKey;\n\t\tif (cell && (cell instanceof Cell)) {\n\t\t\tif (!this.graph.isSelected(cell))\n\t\t\t\tdelete cell._firstSelection;\n\t\t\telse\n\t\t\t\tcell._firstSelection = true;\n\n\t\t\td3.select(event.dataTarget).moveToFront();\n\t\t\tthis.graph.setSelection(cell, toggle);\n\t\t}\n\t}\n\n\tunselectCell(type, ns, data, pos, event) {\n\t\tvar cell = data == this.graph ? null : data;\n\t\tif (cell && !(cell instanceof Cell)) return;\n\t\tvar ctrlKey = event.ctrlKey || event.shiftKey;\n\t\tif (!cell) {\n\t\t\tthis.graph.setSelection(cell, ctrlKey);\n\t\t}\n\t}\n\n\thandleMultiSelect(type, ns, data, pos, event) {\n\t\tpos = util.scale(this.graph, pos);\n\n\t\tif (type == 'dragstart') {\n\t\t\tvar select = (this.graph.getProperty(\"defaultClickMode\") == \"select\") ^ (event.ctrlKey || event.shiftKey);\n\t\t\tif (!select) return;\n\t\t\tthis.startPt = new Point(pos[0], pos[1]);\n\t\t\treturn;\n\t\t}\n\t\tif (!this.startPt) return;\n\t\tvar rect = Rectangle.getBoundingRectangle([new Point(pos[0], pos[1]), this.startPt]);\n\t\tvar renderer = this.graph.renderer;\n\t\tif (!this.rubberband) {\n\t\t\tthis.rubberband = d3.select(renderer.appendNode(renderer.getCellLayer(), {\n\t\t\t\ttemplate: _.template('<g><rect x=\"0\" y=\"0\" width=\"100\" height=\"100\" stroke=\"#000000\" fill=\"none\" stroke-dasharray=\"3 3\"/></g>')\n\t\t\t}, false));\n\t\t}\n\t\tif (type == 'dragend') {\n\t\t\tvar cells = this.graph.getCurrentRoot().children;\n\t\t\t// TODO: Define if we want to select vertexes / edges or both\n\t\t\tcells = _.filter(cells, function (cell) {\n\t\t\t\tvar box = cell.getBounds();\n\t\t\t\tif (rect.contains(box)) {\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t\treturn false;\n\t\t\t});\n\t\t\t// TODO: Set selection\n\t\t\tthis.graph.setSelection(cells, event.ctrlKey);\n\n\t\t\tthis.rubberband.remove();\n\t\t\tdelete this.startPt;\n\t\t\tdelete this.rubberband;\n\t\t\treturn;\n\t\t}\n\t\tthis.rubberband.select(\"rect\").attr({x: rect.x, y: rect.y, width: rect.width, height: rect.height});\n\t}\n\n\tdestroy() {\n\t\tsuper.destroy();\n\t\tdelete this.selectedNodes;\n\t\tdelete this.selectedLinks;\n\t\tdelete this.attachedLinks;\n\t}\n}\n\nexport default SelectionBehavior;\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/behavior/SelectionBehavior.js\n **/","import _ from \"lodash\";\nimport Base64 from \"../util/base64\";\nimport DomUtils from \"../util/DomUtils\";\nimport Renderer from \"./Renderer\";\nimport StringBuffer from \"../util/StringBuffer\";\n\nconst NS = 'http://www.w3.org/2000/svg';\nif (typeof (SVGElement) != \"undefined\") {\n\tvar svg = document.createElementNS(NS, \"svg\");\n\tsvg.innerHTML = '<circle/>';\n\tif (svg.firstChild !== \"[object SVGCircleElement]\") {\n\t\tObject.defineProperties(SVGElement.prototype, {\n\t\t\t\"outerHTML\": {\n\t\t\t\tenumerable: false,\n\t\t\t\tconfigurable: true,\n\t\t\t\tget: function() {\n\t\t\t\t\tvar $node, $temp;\n\t\t\t\t\t$temp = document.createElement('div');\n\t\t\t\t\t$node = this.cloneNode(true);\n\t\t\t\t\t$temp.appendChild($node);\n\t\t\t\t\treturn $temp.innerHTML;\n\t\t\t\t}\n\t\t\t},\n\t\t\t\"innerHTML\": {\n\t\t\t\tenumerable: false,\n\t\t\t\tconfigurable: true,\n\t\t\t\tget: function() {\n\t\t\t\t\tvar s = this.outerHTML;\n\t\t\t\t\tvar ropen = new RegExp(\"<\" + this.nodeName + '\\\\b(?:([\"\\'])[^\"]*?(\\\\1)|[^>])*>', \"i\");\n\t\t\t\t\tvar rclose = new RegExp(\"<\\/\" + this.nodeName + \">$\", \"i\");\n\t\t\t\t\treturn  s.replace(ropen, \"\").replace(rclose, \"\");\n\t\t\t\t},\n\t\t\t\tset: function(markup) {\n\t\t\t\t\t// empty el first.\n\t\t\t\t\tlet child;\n\t\t\t\t\twhile (child = this.lastChild)\n\t\t\t\t\t\tthis.removeChild(child);\n\t\t\t\t\tlet buf = new StringBuffer();\n\t\t\t\t\tbuf.append('<svg>').append(markup).append('</svg');\n\t\t\t\t\tlet $temp = DomUtils.createElement('div', null, null, buf.toString()).firstElementChild;\n\t\t\t\t\twhile ($temp.firstChild)\n\t\t\t\t\t\tthis.appendChild($temp.firstChild);\n\t\t\t\t}\n\t\t\t}\n\t\t})\n\t}\n\t// Define the toDataURL for SVG\n\tSVGElement.prototype.toDataURL = function(type, options = {}) {\n\t\tlet _svg = this;\n\n\t\tlet debug = function(msg) {};\n\n\t\tif (options['debug'] == true && typeof(console) != 'undefined')\n\t\t\tdebug = function(msg) { console.log(\"SVG.toDataURL:\", msg); };\n\n\t\tfunction exportSVG() {\n\t\t\tvar svg_xml = _svg.outerHTML;\n\t\t\tvar svg_dataurl = base64dataURLencode(svg_xml);\n\t\t\tdebug(type + \" length: \" + svg_dataurl.length);\n\n\t\t\t// NOTE double data carrier\n\t\t\tif (options.callback) options.callback(svg_dataurl);\n\t\t\treturn svg_dataurl;\n\t\t}\n\n\t\tfunction base64dataURLencode(s) {\n\t\t\tvar b64 = \"data:image/svg+xml;base64,\";\n\n\t\t\t// https://developer.mozilla.org/en/DOM/window.btoa\n\t\t\tif (window.btoa) {\n\t\t\t\tdebug(\"using window.btoa for base64 encoding\");\n\t\t\t\tb64 += btoa(s);\n\t\t\t} else {\n\t\t\t\tdebug(\"using custom base64 encoder\");\n\t\t\t\tb64 += Base64.encode(s);\n\t\t\t}\n\n\t\t\treturn b64;\n\t\t}\n\n\t\t// Native export doesn't work very well. should use canvg instead.\n\t\tfunction exportImage(type) {\n\t\t\tvar canvas = document.createElement(\"canvas\");\n\t\t\tvar ctx = canvas.getContext('2d');\n\n\t\t\t// TODO: if (options.keepOutsideViewport), do some translation magic?\n\n\t\t\tvar svg_img = new Image();\n\t\t\tvar svg_xml = _svg.outerHTML;\n\t\t\tsvg_img.src = base64dataURLencode(svg_xml);\n\n\t\t\tsvg_img.onload = function() {\n\t\t\t\tdebug(\"exported image size: \" + [svg_img.width, svg_img.height]);\n\t\t\t\tcanvas.width = svg_img.width;\n\t\t\t\tcanvas.height = svg_img.height;\n\t\t\t\tctx.drawImage(svg_img, 0, 0);\n\n\t\t\t\t// SECURITY_ERR WILL HAPPEN NOW\n\t\t\t\tvar image_dataurl = canvas.toDataURL(type);\n\t\t\t\tdebug(type + \" length: \" + image_dataurl.length);\n\n\t\t\t\tif (options.callback) options.callback( image_dataurl );\n\t\t\t\telse debug(\"WARNING: no callback set, so nothing happens.\");\n\t\t\t};\n\n\t\t\tsvg_img.onerror = function() {\n\t\t\t\tdebug(\n\t\t\t\t\t\"Can't export! Maybe your browser doesn't support \" +\n\t\t\t\t\t\"SVG in img element or SVG input for Canvas drawImage?\\n\" +\n\t\t\t\t\t\"http://en.wikipedia.org/wiki/SVG#Native_support\"\n\t\t\t\t);\n\t\t\t};\n\n\t\t\t// NOTE: will not return anything\n\t\t}\n\n\t\tfunction exportImageCanvg(type) {\n\t\t\tif (!canvg) return null;\n\t\t\tlet canvas = DomUtils.createElement('canvas', null, {display: \"none\"});\n\t\t\tdocument.body.appendChild(canvas);\n\t\t\tif (type == 'javascript') {\n\t\t\t\tvar xcanvas = new jsCanvas ('jscanvastest');\n\t\t\t\txcanvas.canvas.style.display = 'none';\n\t\t\t\t//xcanvas.canvas = canvas;\n\t\t\t}\n\n\t\t\tif (!options.keepOutsideViewport) {\n\t\t\t\tcanvg(canvas, _svg.outerHTML);\n\t\t\t} else {\n\t\t\t\tlet padding = options.padding || 0;\n\t\t\t\tlet scale = 1.0;\n\t\t\t\tlet translate = [0, 0];\n\t\t\t\tlet bbox = _svg.getBBox();\n\t\t\t\tdebug(\"detected svg dimensions \" + [bbox.x, bbox.y, bbox.width, bbox.height]);\n\t\t\t\tlet transform = _svg.firstElementChild.getAttribute('transform');\n\t\t\t\tif (transform) {\n\t\t\t\t\tdebug('detected svg transform ' + transform);\n\t\t\t\t\ttransform = SVGRenderer.transform(transform);\n\t\t\t\t\ttranslate = transform.translate;\n\t\t\t\t\tscale = transform.scale;\n\t\t\t\t}\n\t\t\t\tlet buf = new StringBuffer();\n\t\t\t\tbuf.append('<svg width=\"').append(bbox.width + 2*padding).append('px\" height=\"').append(bbox.height + 2*padding).append('px\"><g transform=\"translate(')\n\t\t\t\t\t.append(-bbox.x+translate[0]+padding).append(',').append(-bbox.y+translate[1]+padding).append(')scale(').append(scale).append(')\">')\n\t\t\t\t\t.append(_svg.firstElementChild.innerHTML).append('</g></svg>');\n\t\t\t\tif (type == 'javascript') {\n\t\t\t\t\txcanvas.compile(buf.toString(), function () {\n\t\t\t\t\t\tif (options.callback) options.callback(xcanvas.toString());\n\t\t\t\t\t});\n\t\t\t\t\treturn;\n\t\t\t\t} else\n\t\t\t\t\tcanvg(canvas, buf.toString());\n\t\t\t}\n\t\t\tvar image_dataurl = canvas.toDataURL(type);\n\t\t\tif (options.callback) options.callback( image_dataurl );\n\t\t\tcanvas.parentNode.removeChild(canvas);\n\t\t\treturn image_dataurl;\n\t\t}\n\n\t\tif (!type) type = \"image/svg+xml\";\n\n\t\tif (options.keepNonSafe) debug(\"NOTE: keepNonSafe is NOT supported and will be ignored!\");\n\t\tif (options.keepOutsideViewport) debug(\"NOTE: keepOutsideViewport is only supported with canvg exporter.\");\n\n\t\tswitch (type) {\n\t\t\tcase \"image/svg+xml\":\n\t\t\t\treturn exportSVG();\n\t\t\tcase \"image/png\":\n\t\t\tcase \"image/jpeg\":\n\t\t\tcase \"javascript\":\n\t\t\t\tif (!options.renderer) {\n\t\t\t\t\tif (window.canvg) options.renderer = \"canvg\";\n\t\t\t\t\telse options.renderer=\"native\";\n\t\t\t\t}\n\t\t\t\tswitch (options.renderer) {\n\t\t\t\t\tcase \"canvg\":\n\t\t\t\t\t\tdebug(\"using canvg renderer for \" + type + \" image export\");\n\t\t\t\t\t\treturn exportImageCanvg(type);\n\t\t\t\t\tcase \"native\":\n\t\t\t\t\t\tdebug(\"using native renderer for \" + type + \" export. THIS MIGHT FAIL.\");\n\t\t\t\t\t\treturn exportImage(type);\n\t\t\t\t\tdefault:\n\t\t\t\t\t\tdebug(\"unknown image renderer given, doing noting (\" + options.renderer + \")\");\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tdebug(\"Sorry! Exporting as '\" + type + \"' is not supported!\");\n\t\t}\n\t\treturn null;\n\t}\n}\n\nclass SVGRenderer extends Renderer {\n\trender() {\n\t\tlet result = super.render();\n\t\tif (result) {\n\t\t\tlet root = this.graph.currentRoot;\n\t\t\tlet buf = new StringBuffer('<svg width=\"100%\" height=\"100%\" xmlns=\"http://www.w3.org/2000/svg\">');\n\t\t\tlet t = this.translate;\n\t\t\tbuf.append('<g transform=\"translate(').append(t[0]).append(',').append(t[1]).append(')scale(').append(this.scale).append(')\">');\n\t\t\tbuf.append(this.renderDefs());\n\t\t\tbuf.append(root.render(this));\n\t\t\tbuf.append('</g></svg>');\n\t\t\tthis.box.innerHTML = buf.toString();\n\t\t\tthis.svg = this.box.firstElementChild;\n\t\t}\n\t}\n\n\trenderDefs() {\n\t\tlet buf = new StringBuffer('<defs>');\n\t\tbuf.append(this.getTemplate('Grid', this.prop(\"gridSize\")));\n\t\tlet markers = this.graph.markers;\n\t\tif (markers.length > 0)\n\t\t\tbuf.append(SVGRenderer.renderMarkers(markers));\n\t\tbuf.append('</defs>');\n\t\treturn buf.toString();\n\t}\n\n\trefresh() {\n\t\tif (!this.svg) return;\n\t\tlet g = this.svg.querySelector('g');\n\t\tlet t = this.translate;\n\t\tg.setAttribute('transform', 'translate(' + t[0] + ',' + t[1] + ')scale(' + this.scale + ')');\n\t}\n\n\tstatic renderMarkers(markers) {\n\t\tlet buf = new StringBuffer(), str1, str2;\n\t\tmarkers.forEach(function(marker) {\n\t\t\tstr1 = this.TEMPLATES['Marker'](marker);\n\t\t\tstr2 = marker.shape;\n\t\t\tif (!_.isString(str2))\n\t\t\t\tstr2 = this.renderShape(str2);\n\t\t\tstr1 = str1.replace(/\\#\\{shape\\}/, str2);\n\t\t\tbuf.append(str1);\n\t\t}, this);\n\t\treturn buf.toString();\n\t}\n\n\tstatic renderLabel(box) {\n\t\treturn this.TEMPLATES['Label'](box);\n\t}\n\n\tstatic renderShape(shape) {\n\t\tlet template = this.TEMPLATES[shape.name];\n\t\tif (_.isString(template))\n\t\t\ttemplate = _.template(template);\n\t\treturn template(shape);\n\t}\n\n\tstatic getPathData(shape) {\n\t\tlet points = shape.points;\n\t\tlet controlPts = shape.controlPts;\n\t\tif (!points || points.length == 0) return '';\n\n\t\tif (!controlPts && shape.round) {\n\t\t\t// render rounded line joins.\n\t\t\tlet newPts = [];\n\t\t\tcontrolPts = [];\n\t\t\tlet prev = points[0], next, d1, d2, corner;\n\t\t\tnewPts.push(prev);\n\t\t\tfor (let i = 1; i < points.length - 1; i++) {\n\t\t\t\tnext = points[i];\n\t\t\t\t// set the control point first.\n\t\t\t\tcontrolPts[2*i] = [next, next];\n\t\t\t\t// check the size of the corner.\n\t\t\t\td1 = prev.distance(next);\n\t\t\t\td2 = next.distance(points[i+1]);\n\t\t\t\tcorner = Math.min(shape.round, d1/2, d2/2);\n\t\t\t\t// split the point into two.\n\t\t\t\tnewPts.push(next.getDirection(prev).scale(corner).translate(next));\n\t\t\t\tnewPts.push(next.getDirection(points[i+1]).scale(corner).translate(next));\n\t\t\t\tprev = next;\n\t\t\t}\n\t\t\tnewPts.push(points[points.length - 1]);\n\t\t\tpoints = newPts;\n\t\t}\n\t\tlet buf = new StringBuffer('M'), point;\n\t\tfor (let i = 0; i < points.length; i++) {\n\t\t\tpoint = points[i];\n\t\t\tif (i == 0)\n\t\t\t\tbuf.append(point);\n\t\t\telse {\n\t\t\t\tif (controlPts && controlPts[i]) {\n\t\t\t\t\tbuf.append(' C ');\n\t\t\t\t\tfor (let j = 0; j < controlPts[i].length; j++)\n\t\t\t\t\t\tbuf.append(controlPts[i][j]).append(' ');\n\t\t\t\t\tbuf.append(point);\n\t\t\t\t} else\n\t\t\t\t\tbuf.append(' L ').append(point);\n\t\t\t}\n\t\t}\n\t\treturn buf.toString();\n\t}\n\n\tstatic renderLink(shape) {\n\t\tlet buf = new StringBuffer();\n\t\tlet d = SVGRenderer.getPathData(shape);\n\t\tif (shape.showGauge)\n\t\t\tbuf.append('<path style=\"stroke: white; stroke-width: 9; visibility: hidden; pointer-events: stroke;\" d=\"')\n\t\t\t\t.append(d).append('\"/>');\n\t\tbuf.append('<path d=\"').append(d).append('\"');\n\t\tif (shape.startMarker || shape.endMarker) {\n\t\t\tbuf.append(' style=\"');\n\t\t\tif (shape.startMarker)\n\t\t\t\tbuf.append('marker-start: url(#').append(_.isString(shape.startMarker) ? shape.startMarker : shape.startMarker.id).append(');');\n\t\t\tif (shape.endMarker)\n\t\t\t\tbuf.append('marker-end: url(#').append(_.isString(shape.endMarker) ? shape.endMarker : shape.endMarker.id).append(');');\n\t\t\tbuf.append('\"');\n\t\t}\n\t\tbuf.append('/>');\n\t\treturn buf.toString();\n\t}\n\n\tstatic appendContent(el, content) {\n\t\tlet buf = new StringBuffer();\n\t\tbuf.append('<svg>').append(content).append('</svg');\n\t\tlet temp = DomUtils.createElement('div', null, null, buf.toString()).firstElementChild;\n\n\t\twhile (temp.firstChild)\n\t\t\tel.appendChild(temp.firstChild);\n\t\treturn el;\n\t}\n\n\tstatic transform(transform) {\n\t\tlet translate = [0, 0], scale = 1.0;\n\t\t//\n\t\tlet parts = transform.match(/translate\\(\\s*([^)]+)/);\n\t\tif (parts) {\n\t\t\tlet m = parts[1].trim().match(/([\\d.-]+)[ ,]([\\d.-]+)/);\n\t\t\tif (m) {\n\t\t\t\ttranslate[0] = parseFloat(m[1]) || 0;\n\t\t\t\ttranslate[1] = parseFloat(m[2]) || 0;\n\t\t\t} else\n\t\t\t\ttranslate[0] = translate[1] = parseFloat(parts[1]);\n\t\t}\n\t\tparts = transform.match(/scale\\(\\s*([^)]+)/);\n\t\tif (parts)\n\t\t\tscale = parseFloat(parts[1]) || 1.0;\n\n\t\treturn {translate, scale};\n\t}\n}\nSVGRenderer.TEMPLATES = {\n\t$root: '<g id=\"${id}\" class=\"${className}\">#{children}</g>',\n\t$node: '<g id=\"${id}\" class=\"${className}\" style=\"${style}\" ns=\"${namespace}\" transform=\"translate(${x},${y})\">#{shape}#{label}</g>',\n\t$edge: '<g id=\"${id}\" class=\"${className}\" style=\"${style}\" ns=\"${namespace}\">#{shape}#{label}</g>',\n\tEllipse: '<ellipse cx=\"0\" cy=\"0\" rx=\"${width/2}\" ry=\"${height/2}\"/>',\n\tRectangle: '<rect x=\"${-width/2}\" y=\"${-height/2}\" width=\"${width}\" height=\"${height}\" rx=\"9\" ry=\"9\"/>',\n\tTriangle: '<polygon points=\"${-width/2},${-height/2} ${width/2},${-height/2} 0,${height/2}\"/>',\n\tRhombus: '<polygon points=\"0,${-height/2} ${width/2},0 0,${height/2} ${-width/2},0\"/>',\n\tHexagon: function(config) {\n\t\tvar vertical = config.direction == 'north' || config.direction == 'south';\n\t\tif (vertical)\n\t\t\treturn '<polygon points=\"0,${-height/2} ${width/2},${-height/4} ${width/2},${height/4} 0,${height/2} ${-width/2},${height/4} ${-width/2},${-height/4}\"/>';\n\t\telse\n\t\t\treturn '<polygon points=\"${-width/2},0 ${width/4},${-height/2} ${width/4},${-height/2} ${width/2},0 ${width/4},${height/2} ${-width/4},${height/2}\"/>';\n\t},\n\tPolygon: function(shape) {\n\t\tlet buf = new StringBuffer('<polygon points=\"');\n\t\tshape.points.forEach(function(pt){\n\t\t\tbuf.append(pt[0]).append(',').append(pt[1]).append(' ');\n\t\t});\n\t\tbuf.removeLast();\n\t\tbuf.append('\"/>');\n\t\treturn buf.toString();\n\t},\n\tImage: function(config) {\n\t\treturn '<image x=\"${-width/2}\" y=\"${-height/2}\" width=\"${width}\" height=\"${height}\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" xlink:href=\"' + config.image + '\"/>';\n\t},\n\tMarker: function(marker) {\n\t\treturn `\n<marker id=\"${marker.id}\" markerWidth=\"${marker.size}\" markerHeight=\"${marker.size}\" refx=\"${marker.ref[0]}\" \nrefy=\"${marker.ref[1]}\" orient=\"auto\" viewbox=\"${marker.viewBox.x} ${marker.viewBox.y} ${marker.viewBox.width} ${marker.viewBox.height}\"\nmarkerUnits=\"userSpaceOnUse\" ${marker.fill ? `style=\"stroke: ${marker.fill};fill:${marker.fill}\"` : ''}>#{shape}</marker>\n`.trim();\n\t},\n\tGrid: function(size) {\n\t\treturn `\n<pattern id=\"GridPattern\" width=\"${size}\" height=\"${size}\" patternUnits=\"userSpaceOnUse\">\n\t<ellipse cx=\"0\" cy=\"0\" rx=\"1\" ry=\"1\" fill=\"#999999\"/>\n\t<ellipse cx=\"0\" cy=\"${size}\" rx=\"1\" ry=\"1\" fill=\"#999999\"/>\n\t<ellipse cx=\"${size}\" cy=\"0\" rx=\"1\" ry=\"1\" fill=\"#999999\"/>\n\t<ellipse cx=\"${size}\" cy=\"${size}\" rx=\"1\" ry=\"1\" fill=\"#999999\"/>\n</pattern>`.trim();\n\t},\n\tLabel: _.template(`\n<% var box = _.has(data, \"dx\") ? data : (data.getLabelBox ? data.getLabelBox() : null); \n   if (box) {%>\n\t<g <% if (box.config && box.config.class) {%>class=\"<%=box.config.class%>\"<%}%>\\\n\t\t<% if (box.config && box.config.ns) {%>ns=\"<%=box.config.ns%>\"<%}%>\\\n\t\t<% if (box.config && box.config.inlineStyle) {%>\\\n\t\t\tfont-size=\"<%=box.config.fontSize%>\"\\\n\t\t\tfont-family=\"<%=box.config.fontFamily%>\"\\\n\t\t\tfont-weight=\"<% if (box.bold) {%>bold<%} else {%>normal<%}%>\"\\\n\t\t\t<% if (box.underline) {%>text-decoration=\"underline\"<%}%>\\\n\t\t\t<% if (box.italic) {%>font-style=\"italic\"<%}%>\\\n\t\t<%}%>\\\n\t\ttext-anchor=\"<%=box.anchor%>\"\\\n\t\ttransform=\"translate(<%=box.bounds.x%>,<%=box.bounds.y%>)<% if (box.config && box.config.rotation) {%>rotate(<%=box.config.rotation%> <%=box.pivot[0]%> <%=box.pivot[1]%>)<%}%>\">\n\t<% if (box.config.backgroundStyle) {%>\n\t\t<rect x=\"<%=-box.bounds.width/2%>\" y=\"<%=-box.bounds.height/2%>\" width=\"<%=box.bounds.width%>\" height=\"<%=box.bounds.height%>\" style=\"<%=box.config.backgroundStyle%>\"/>\n\t<% } if (_.isArray(box.label)) { \n\t\t_.each(box.label, function(value, line) {%>\n\t\t\t<text <% if (box.config && box.config.textStyle) {%>style=\"<%=box.config.textStyle%>\"<%}%>\\\n\t\t\t\tdx=\"<%=box.dx%>\" dy=\"<%=box.dy + box.lineHeight * line%>\"><%=value%></text>\n\t\t<%});} else { %>\n\t\t\t<text><%=box.label%></text>\n\t\t<%}%>\n\t</g>\n<%}%>\n`.trim(), {variable: \"data\"})   //TODO add more inline text styles.\n};\n\nexport default SVGRenderer;\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/view/SVGRenderer.js\n **/"],"sourceRoot":"/source/"}