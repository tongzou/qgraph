{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","qgraph.js","webpack:/webpack/bootstrap 8111cfb5237890631cf8","webpack:///src/index.js","webpack:///src/util/base64.js","webpack:///src/util/Utils.js","webpack:///src/geometry/Point.js","webpack:///src/geometry/Rectangle.js","webpack:/external {\"root\":\"_\",\"commonjs\":\"lodash\",\"commonjs2\":\"lodash\",\"amd\":\"lodash\"}","webpack:///src/geometry/Shape.js","webpack:///src/util/DomUtils.js","webpack:///src/util/StringBuffer.js","webpack:///src/geometry/Line.js","webpack:///src/geometry/Ellipse.js","webpack:///src/geometry/Link.js","webpack:///~/bean/bean.js","webpack:///src/event/EventDispatcher.js","webpack:///src/event/KeyUtils.js","webpack:///src/graph/Graph.js","webpack:///src/graph/Node.js","webpack:///src/graph/Cell.js","webpack:///src/util/Cache.js","webpack:///src/view/Label.js","webpack:///src/graph/Edge.js","webpack:///src/view/Marker.js","webpack:///src/layout/Layout.js","webpack:///src/layout/FlowLayout.js","webpack:///src/view/Renderer.js","webpack:///src/behavior/GraphBehavior.js","webpack:///src/behavior/Behavior.js","webpack:///src/behavior/SelectionBehavior.js","webpack:///src/view/SVGRenderer.js"],"names":["root","factory","exports","module","require","define","amd","this","__WEBPACK_EXTERNAL_MODULE_5__","modules","__webpack_require__","moduleId","installedModules","id","loaded","call","m","c","p","_interopRequireDefault","obj","__esModule","default","Object","defineProperty","value","_base","_base2","_Utils","_Utils2","_DomUtils","_DomUtils2","_StringBuffer","_StringBuffer2","_Point","_Point2","_Line","_Line2","_Shape","_Shape2","_Rectangle","_Rectangle2","_Ellipse","_Ellipse2","_Link","_Link2","_bean","_bean2","_EventDispatcher","_EventDispatcher2","_Graph","_Graph2","_Cell","_Cell2","_Node","_Node2","_Edge","_Edge2","_Layout","_Layout2","_FlowLayout","_FlowLayout2","_Label","_Label2","_Marker","_Marker2","_Renderer","_Renderer2","_SVGRenderer","_SVGRenderer2","_GraphBehavior","_GraphBehavior2","_SelectionBehavior","_SelectionBehavior2","addShape","Events","Base64","Cache","Utils","DomUtils","StringBuffer","Point","Line","Shape","Rectangle","Ellipse","Link","EventDispatcher","Label","Marker","Graph","Cell","Node","Edge","Layout","FlowLayout","Renderer","SVGRenderer","GraphBehavior","SelectionBehavior","_keyStr","encode","input","chr1","chr2","chr3","enc1","enc2","enc3","enc4","output","i","_utf8_encode","length","charCodeAt","isNaN","charAt","decode","replace","indexOf","String","fromCharCode","_utf8_decode","string","utftext","n","c1","c2","c3","global","_classCallCheck","instance","Constructor","TypeError","_possibleConstructorReturn","self","ReferenceError","_inherits","subClass","superClass","prototype","create","constructor","enumerable","writable","configurable","setPrototypeOf","__proto__","window","addEventHandler","document","navigator","_debugging","_debugAll","typeRegistry","splice","Array","type","namespace","name","_type","Map","set","get","createType","props","defaultType","extend","_extend","getPrototypeOf","apply","arguments","config","_","assign","typeName","log","buildTypes","types","_this2","remove","defaultsDeep","forEach","child","parent","protoProps","staticProps","Surrogate","superclass","initConfig","cArr","DEFAULTS","prop","getConstructor","jsClass","defaultClass","isString","eval","debug","moduleName","push","message","console","substring","info","getRelativePosition","bounds","geometry","x","Math","abs","width","y","height","offsetPosition","pos","anchorX","offsetX","anchorY","offsetY","unscale","t","scale","o","_scale","getProperty","has","isFunction","_createClass","defineProperties","target","descriptor","key","aPt","sqrt","p2","dist","distance","angle","cos","PI","sin","clone","rotate","rect","vertical","W","N","S","E","NE","NW","SE","SW","_lodash","_lodash2","_Shape3","el","w","h","left","right","top","bottom","pt","contains","pt1","pt2","horizontal","contains1","contains2","outPt","orthogonal","undefined","dx","dy","alpha","atan2","pi","pi2","beta","tan","dir","getDirection","point","direction","pts","margin","isArray","min","max","rects","minx","miny","maxx","Infinity","maxy","each","r","registry","defaults","refPt","getPerimeter","view","template","getTemplate","isIE","sAgent","userAgent","Idx","parseInt","match","isFireFox","InstallTrigger","isChrome","raw","createElement","tag","attribs","styles","html","setElement","innerHTML","createElementByString","str","temp","childNodes","setAttribute","style","testElement","node","method","nodeType","getAncestorBy","parentNode","getPosition","context","body","elRect","getBoundingClientRect","contextRect","getCenterPosition","move","getSize","offsetWidth","offsetHeight","resize","preloadImages","array","list","img","that","Image","onload","index","src","getImageInfo","downloadFile","data","mime","split","encoded","atob","decodeURI","GetBlob","msSaveBlob","link","href","download","display","appendChild","click","removeChild","contentType","sliceSize","byteArrays","offset","slice","byteNumbers","byteArray","Uint8Array","Blob","openImage","image","myWindow","open","myDocument","eventFromInput","e","tagName","buffer","stuff","concat","pop","sep","join","start","end","l","cosa","dotProduct","x0","y0","x1","y1","x2","y2","x3","y3","denom","nume_a","nume_b","ua","ub","intersectionX","intersectionY","a","b","cx","cy","px","py","d","f","g","det","xout1","xout2","yout1","yout2","dist1","pow","dist2","xout","yout","defaultConfig","showGauge","defaultGeometry","linkTypes","terminalVisual","shapeConfig","startMarker","endMarker","startNormal","endNormal","renderLink","isNumber","points","translate","getScaled","linkClass","DirectLink","BezierLink","ctrlpts","controlPts","p1","p3","p4","s","EntityRelations","_Link3","source","Port","getBounds","edge","isSourceLeft","isTargetLeft","result","getCenterY","xe","ye","seg","segment","dep","arr","midY","Manhattan","_Link4","MIN_BUFFER","autoRoute","maxChannelWidth","container","boxes","startBox","endBox","side","side2","box","intersect","j","channel","channel2","endPadding","startPadding","_getChannel","_getFirstIntersection","_getRouteTendency","_hasIntersection","_moveSegment","detectIntersection","savedIndex","savedSide","breakPt","_getRouteDirection","getCenter","box2","box1","getLeft","getRight","getBottom","getTop","_moveSegment2","_x7","_x8","_x9","_x10","_x11","toString","getTranslated","h2","h1","equals","findPositions","_mergeSegments","getCommonAncestor","getDescendants","excludeFromRouting","isAncestor","startBufferNormal","endBufferNormal","startBuffer","endBuffer","middle","prunePts","average","getMidPoint","startPositive","endPositive","positions","current","prev","__WEBPACK_AMD_DEFINE_FACTORY__","__WEBPACK_AMD_DEFINE_RESULT__","definition","selectorEngine","win","old","namespaceRegex","nameRegex","addEvent","removeEvent","doc","documentElement","W3C_MODEL","eventSupport","ONE","str2arr","standardNativeEvents","w3cNativeEvents","nativeEvents","hash","events","customEvents","element","compareDocumentPosition","check","event","related","relatedTarget","prefix","test","mouseenter","base","condition","mouseleave","mousewheel","Event","commonProps","mouseProps","mouseWheelProps","keyProps","textProps","touchProps","messageProps","stateProps","overOutRegex","typeFixers","reg","fix","newEvent","keyCode","which","rightClick","button","pageX","pageY","clientX","clientY","scrollLeft","scrollTop","typeFixerMap","isNative","ownerDocument","parentWindow","originalEvent","isBean","fixer","srcElement","preventDefault","returnValue","stopPropagation","cancelBubble","stop","stopped","stopImmediatePropagation","isImmediatePropagationStopped","currentTarget","ne","targetElement","RegEntry","wrappedHandler","fn","args","eargs","findTarget","eventElement","__beanDel","ft","handler","original","namespaces","customType","once","removeListener","eventType","inNamespaces","checkNamespaces","matches","checkElement","checkOriginal","checkHandler","map","forAll","pfx","all","substr","entries","entry","put","del","removed","setSelectorEngine","querySelectorAll","Error","rootListener","propertyName","listeners","listener","add","custom","attachEvent","detachEvent","rm","originalFn","orgType","handlers","delegate","selector","fireListener","evt","createEvent","dispatchEvent","fireEvent","createEventObject","off","typeSpec","k","isTypeStr","hasOwnProperty","on","first","delfn","one","fire","names","from","beanDel","bean","noConflict","cleanup","CollectGarbage","_interopRequireWildcard","newObj","_KeyUtils","KeyUtils","zoomScale","rootNS","getAttribute","dragging","bind","handleEvent","started","enterStack","startKeys","stopKeys","buf","ns","stack","isRoot","startsWith","rootTarget","nsTarget","prepend","targetStack","_this","isKeyEvent","getKeyEvent","getEventInfo","wheelDelta","dragObject","mouse","dragPos","mousemove","currentPos","dispatch","mouseup","simulateEnterLeave","last","clearEnterStack","getNS","val","append","item","nsType","regexp","callback","lastPosition","_this3","registerKey","getKeyData","ctrl","alt","shift","meta","code","_this4","unregisterKey","zIndex","_this5","register","RegExp","registeredType","changedTouches","svg","ownerSVGElement","createSVGPoint","matrixTransform","getScreenCTM","inverse","clientLeft","clientTop","KeyboardEvent","ctrlKey","altKey","shiftKey","metaKey","nodeDefaults","role","draggable","selectable","editable","resizable","sourceable","targetable","visible","edgeDefaults","size","color","uniqueId","model","nodes","edges","selection","destroyed","nodeTypes","edgeTypes","markers","marker","markerConfig","getMarker","loadModel","currentRoot","NodeClass","getJSClass","addChild","to","EdgeClass","addNode","addEdge","children","without","allowDanglingEdges","multiConnect","readOnly","viewOnly","_typeof","Symbol","iterator","_Cell3","graph","inEdges","outEdges","ports","_ret","render","v","portName","endPt","shape","getShape","label","_Cache","_Cache2","decorators","createDecorators","views","viewProps","isUndefined","className","computedClassName","viewProp","shapeClass","getView","getLabelBox","renderLabel","_computedClassName","caches","getCache","clear","namesapce","FONT_BOLD","FONT_ITALIC","FONT_UNDERLINE","FONT_SHADOW","fontSize","fontFamily","fontStyle","fontColor","padding","linePadding","align","rotation","labelConfig","containerWidth","containerHeight","_getLabelBox","getLabelBoxForLink","bold","wrappedLabel","wrap","anchor","setAnchorX","pivot","maxBounds","_label","underline","italic","shadow","lineHeight","baseline","stringMeasureEl","measureDiv","baselineDiv","getStringSize","memoize","position","visibility","contentWindow","write","close","getElementById","fontWeight","strut","firstChild","baselineHeight","offsetTop","maxWidth","spaceSize","space","lines","word","words","line","currentWidth","wordWidth","newLine","editor","refEl","textEl","singleLine","unselectable","overflow","border","font-family","font-size","font-weight","focus","select","cancel","_get","object","property","receiver","Function","desc","getOwnPropertyDescriptor","getter","setSource","sourcePos","setTarget","targetPos","setTerminal","setEdgeAt","removeEdge","addOutEdge","addInEdge","center","refPts","getReferencePoints","terminals","getBound","getPort","getLink","getTerminalVisual","arrow","sign","viewBox","ref","fill","triangle","oval","diamond","orientation","toUpperCase","HORIZONTAL","VERTICAL","_Layout3","items","getLinkedNodes","owner","hgap","vgap","_flPos","moveTo","trigger","tabindex","layout","layoutClass","_translate","dispatcher","graphBehavior","selectionBehavior","nodeBehavior","edgeBehavior","connectionBehavior","scaled","_viewport","isNull","vp","transform","refresh","_graph","viewport","initializeBehaviors","renderMarkers","preprocessor","TEMPLATES","parts","part","trim","camelCase","interpolate","gridSize","gBounds","vBounds","parseFloat","defaultClickMode","hideOutline","singleSelect","gridEnabled","guidesEnabled","maxZoom","minZoom","zoomFactor","maskOpacity","_Behavior2","_Behavior3","_Behavior","renderer","handleDrag","handleZoom","pan","Behavior","selectCell","unselectCell","handleMultiSelect","selectedNodes","selectedLinks","attachedLinks","classed","selectedVertices","getShapes","getAttachedEdges","selectedEdges","cell","toggle","isSelected","_firstSelection","d3","dataTarget","moveToFront","setSelection","util","startPt","getBoundingRectangle","rubberband","appendNode","getCellLayer","cells","getCurrentRoot","filter","attr","_Renderer3","NS","SVGElement","createElementNS","outerHTML","$node","$temp","cloneNode","ropen","nodeName","rclose","markup","lastChild","firstElementChild","toDataURL","exportSVG","svg_xml","_svg","svg_dataurl","base64dataURLencode","options","b64","btoa","exportImage","canvas","ctx","getContext","svg_img","drawImage","image_dataurl","onerror","exportImageCanvg","canvg","xcanvas","jsCanvas","keepOutsideViewport","bbox","getBBox","compile","msg","keepNonSafe","renderDefs","querySelector","str1","str2","renderShape","round","newPts","next","d1","d2","corner","_i","getPathData","content","_transform","$root","$edge","Triangle","Rhombus","Hexagon","Polygon","removeLast","Grid","variable"],"mappings":"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","file":"qgraph.min.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory(require(\"lodash\"));\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([\"lodash\"], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"qgraph\"] = factory(require(\"lodash\"));\n\telse\n\t\troot[\"qgraph\"] = factory(root[\"_\"]);\n})(this, function(__WEBPACK_EXTERNAL_MODULE_5__) {\nreturn \n\n\n/** WEBPACK FOOTER **\n ** webpack/universalModuleDefinition\n **/","/*!\n * \n * \tqgraph - A Graph Manipulation and Visualization Library\n * \tAuthor: Tong Zou\n * \tVersion: v0.1.3\n * \tUrl: https://github.com/tongzou/qgraph\n * \tLicense(s): MIT\n * \n */\n(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory(require(\"lodash\"));\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([\"lodash\"], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"qgraph\"] = factory(require(\"lodash\"));\n\telse\n\t\troot[\"qgraph\"] = factory(root[\"_\"]);\n})(this, function(__WEBPACK_EXTERNAL_MODULE_5__) {\nreturn /******/ (function(modules) { // webpackBootstrap\n/******/ \t// The module cache\n/******/ \tvar installedModules = {};\n/******/\n/******/ \t// The require function\n/******/ \tfunction __webpack_require__(moduleId) {\n/******/\n/******/ \t\t// Check if module is in cache\n/******/ \t\tif(installedModules[moduleId])\n/******/ \t\t\treturn installedModules[moduleId].exports;\n/******/\n/******/ \t\t// Create a new module (and put it into the cache)\n/******/ \t\tvar module = installedModules[moduleId] = {\n/******/ \t\t\texports: {},\n/******/ \t\t\tid: moduleId,\n/******/ \t\t\tloaded: false\n/******/ \t\t};\n/******/\n/******/ \t\t// Execute the module function\n/******/ \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n/******/\n/******/ \t\t// Flag the module as loaded\n/******/ \t\tmodule.loaded = true;\n/******/\n/******/ \t\t// Return the exports of the module\n/******/ \t\treturn module.exports;\n/******/ \t}\n/******/\n/******/\n/******/ \t// expose the modules object (__webpack_modules__)\n/******/ \t__webpack_require__.m = modules;\n/******/\n/******/ \t// expose the module cache\n/******/ \t__webpack_require__.c = installedModules;\n/******/\n/******/ \t// __webpack_public_path__\n/******/ \t__webpack_require__.p = \"\";\n/******/\n/******/ \t// Load entry module and return exports\n/******/ \treturn __webpack_require__(0);\n/******/ })\n/************************************************************************/\n/******/ ([\n/* 0 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t\tvalue: true\n\t});\n\t\n\tvar _base = __webpack_require__(1);\n\t\n\tvar _base2 = _interopRequireDefault(_base);\n\t\n\tvar _Utils = __webpack_require__(2);\n\t\n\tvar _Utils2 = _interopRequireDefault(_Utils);\n\t\n\tvar _DomUtils = __webpack_require__(7);\n\t\n\tvar _DomUtils2 = _interopRequireDefault(_DomUtils);\n\t\n\tvar _StringBuffer = __webpack_require__(8);\n\t\n\tvar _StringBuffer2 = _interopRequireDefault(_StringBuffer);\n\t\n\tvar _Point = __webpack_require__(3);\n\t\n\tvar _Point2 = _interopRequireDefault(_Point);\n\t\n\tvar _Line = __webpack_require__(9);\n\t\n\tvar _Line2 = _interopRequireDefault(_Line);\n\t\n\tvar _Shape = __webpack_require__(6);\n\t\n\tvar _Shape2 = _interopRequireDefault(_Shape);\n\t\n\tvar _Rectangle = __webpack_require__(4);\n\t\n\tvar _Rectangle2 = _interopRequireDefault(_Rectangle);\n\t\n\tvar _Ellipse = __webpack_require__(10);\n\t\n\tvar _Ellipse2 = _interopRequireDefault(_Ellipse);\n\t\n\tvar _Link = __webpack_require__(11);\n\t\n\tvar _Link2 = _interopRequireDefault(_Link);\n\t\n\tvar _bean = __webpack_require__(12);\n\t\n\tvar _bean2 = _interopRequireDefault(_bean);\n\t\n\tvar _EventDispatcher = __webpack_require__(13);\n\t\n\tvar _EventDispatcher2 = _interopRequireDefault(_EventDispatcher);\n\t\n\tvar _Graph = __webpack_require__(15);\n\t\n\tvar _Graph2 = _interopRequireDefault(_Graph);\n\t\n\tvar _Cell = __webpack_require__(17);\n\t\n\tvar _Cell2 = _interopRequireDefault(_Cell);\n\t\n\tvar _Node = __webpack_require__(16);\n\t\n\tvar _Node2 = _interopRequireDefault(_Node);\n\t\n\tvar _Edge = __webpack_require__(20);\n\t\n\tvar _Edge2 = _interopRequireDefault(_Edge);\n\t\n\tvar _Layout = __webpack_require__(22);\n\t\n\tvar _Layout2 = _interopRequireDefault(_Layout);\n\t\n\tvar _FlowLayout = __webpack_require__(23);\n\t\n\tvar _FlowLayout2 = _interopRequireDefault(_FlowLayout);\n\t\n\tvar _Label = __webpack_require__(19);\n\t\n\tvar _Label2 = _interopRequireDefault(_Label);\n\t\n\tvar _Marker = __webpack_require__(21);\n\t\n\tvar _Marker2 = _interopRequireDefault(_Marker);\n\t\n\tvar _Renderer = __webpack_require__(24);\n\t\n\tvar _Renderer2 = _interopRequireDefault(_Renderer);\n\t\n\tvar _SVGRenderer = __webpack_require__(28);\n\t\n\tvar _SVGRenderer2 = _interopRequireDefault(_SVGRenderer);\n\t\n\tvar _GraphBehavior = __webpack_require__(25);\n\t\n\tvar _GraphBehavior2 = _interopRequireDefault(_GraphBehavior);\n\t\n\tvar _SelectionBehavior = __webpack_require__(27);\n\t\n\tvar _SelectionBehavior2 = _interopRequireDefault(_SelectionBehavior);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\t_Shape2.default.addShape(\"Rectangle\", _Rectangle2.default);\n\t_Shape2.default.addShape(\"Ellipse\", _Ellipse2.default);\n\t\n\texports.default = {\n\t\tEvents: _bean2.default,\n\t\tBase64: _base2.default,\n\t\tCache: _Utils2.default,\n\t\tUtils: _Utils2.default,\n\t\tDomUtils: _DomUtils2.default,\n\t\tStringBuffer: _StringBuffer2.default,\n\t\tPoint: _Point2.default,\n\t\tLine: _Line2.default,\n\t\tShape: _Shape2.default,\n\t\tRectangle: _Rectangle2.default,\n\t\tEllipse: _Ellipse2.default,\n\t\tLink: _Link2.default,\n\t\tEventDispatcher: _EventDispatcher2.default,\n\t\tLabel: _Label2.default,\n\t\tMarker: _Marker2.default,\n\t\tGraph: _Graph2.default,\n\t\tCell: _Cell2.default,\n\t\tNode: _Node2.default,\n\t\tEdge: _Edge2.default,\n\t\tLayout: _Layout2.default,\n\t\tFlowLayout: _FlowLayout2.default,\n\t\tRenderer: _Renderer2.default,\n\t\tSVGRenderer: _SVGRenderer2.default,\n\t\tGraphBehavior: _GraphBehavior2.default,\n\t\tSelectionBehavior: _SelectionBehavior2.default\n\t};\n\n/***/ },\n/* 1 */\n/***/ function(module, exports) {\n\n\t\"use strict\";\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t\tvalue: true\n\t});\n\t// http://www.webtoolkit.info/javascript-base64.html\n\t\n\tvar Base64 = {\n\t\n\t\t// private property\n\t\t_keyStr: \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=\",\n\t\n\t\t// public method for encoding\n\t\tencode: function encode(input) {\n\t\t\tvar output = \"\";\n\t\t\tvar chr1, chr2, chr3, enc1, enc2, enc3, enc4;\n\t\t\tvar i = 0;\n\t\n\t\t\tinput = Base64._utf8_encode(input);\n\t\n\t\t\twhile (i < input.length) {\n\t\n\t\t\t\tchr1 = input.charCodeAt(i++);\n\t\t\t\tchr2 = input.charCodeAt(i++);\n\t\t\t\tchr3 = input.charCodeAt(i++);\n\t\n\t\t\t\tenc1 = chr1 >> 2;\n\t\t\t\tenc2 = (chr1 & 3) << 4 | chr2 >> 4;\n\t\t\t\tenc3 = (chr2 & 15) << 2 | chr3 >> 6;\n\t\t\t\tenc4 = chr3 & 63;\n\t\n\t\t\t\tif (isNaN(chr2)) {\n\t\t\t\t\tenc3 = enc4 = 64;\n\t\t\t\t} else if (isNaN(chr3)) {\n\t\t\t\t\tenc4 = 64;\n\t\t\t\t}\n\t\n\t\t\t\toutput = output + this._keyStr.charAt(enc1) + this._keyStr.charAt(enc2) + this._keyStr.charAt(enc3) + this._keyStr.charAt(enc4);\n\t\t\t}\n\t\n\t\t\treturn output;\n\t\t},\n\t\n\t\t// public method for decoding\n\t\tdecode: function decode(input) {\n\t\t\tvar output = \"\";\n\t\t\tvar chr1, chr2, chr3;\n\t\t\tvar enc1, enc2, enc3, enc4;\n\t\t\tvar i = 0;\n\t\n\t\t\tinput = input.replace(/[^A-Za-z0-9\\+\\/\\=]/g, \"\");\n\t\n\t\t\twhile (i < input.length) {\n\t\n\t\t\t\tenc1 = this._keyStr.indexOf(input.charAt(i++));\n\t\t\t\tenc2 = this._keyStr.indexOf(input.charAt(i++));\n\t\t\t\tenc3 = this._keyStr.indexOf(input.charAt(i++));\n\t\t\t\tenc4 = this._keyStr.indexOf(input.charAt(i++));\n\t\n\t\t\t\tchr1 = enc1 << 2 | enc2 >> 4;\n\t\t\t\tchr2 = (enc2 & 15) << 4 | enc3 >> 2;\n\t\t\t\tchr3 = (enc3 & 3) << 6 | enc4;\n\t\n\t\t\t\toutput = output + String.fromCharCode(chr1);\n\t\n\t\t\t\tif (enc3 != 64) {\n\t\t\t\t\toutput = output + String.fromCharCode(chr2);\n\t\t\t\t}\n\t\t\t\tif (enc4 != 64) {\n\t\t\t\t\toutput = output + String.fromCharCode(chr3);\n\t\t\t\t}\n\t\t\t}\n\t\n\t\t\toutput = Base64._utf8_decode(output);\n\t\n\t\t\treturn output;\n\t\t},\n\t\n\t\t// private method for UTF-8 encoding\n\t\t_utf8_encode: function _utf8_encode(string) {\n\t\t\tstring = string.replace(/\\r\\n/g, \"\\n\");\n\t\t\tvar utftext = \"\";\n\t\n\t\t\tfor (var n = 0; n < string.length; n++) {\n\t\n\t\t\t\tvar c = string.charCodeAt(n);\n\t\n\t\t\t\tif (c < 128) {\n\t\t\t\t\tutftext += String.fromCharCode(c);\n\t\t\t\t} else if (c > 127 && c < 2048) {\n\t\t\t\t\tutftext += String.fromCharCode(c >> 6 | 192);\n\t\t\t\t\tutftext += String.fromCharCode(c & 63 | 128);\n\t\t\t\t} else {\n\t\t\t\t\tutftext += String.fromCharCode(c >> 12 | 224);\n\t\t\t\t\tutftext += String.fromCharCode(c >> 6 & 63 | 128);\n\t\t\t\t\tutftext += String.fromCharCode(c & 63 | 128);\n\t\t\t\t}\n\t\t\t}\n\t\n\t\t\treturn utftext;\n\t\t},\n\t\n\t\t// private method for UTF-8 decoding\n\t\t_utf8_decode: function _utf8_decode(utftext) {\n\t\t\tvar string = \"\";\n\t\t\tvar i = 0;\n\t\t\tvar c = c1 = c2 = 0;\n\t\n\t\t\twhile (i < utftext.length) {\n\t\n\t\t\t\tc = utftext.charCodeAt(i);\n\t\n\t\t\t\tif (c < 128) {\n\t\t\t\t\tstring += String.fromCharCode(c);\n\t\t\t\t\ti++;\n\t\t\t\t} else if (c > 191 && c < 224) {\n\t\t\t\t\tc2 = utftext.charCodeAt(i + 1);\n\t\t\t\t\tstring += String.fromCharCode((c & 31) << 6 | c2 & 63);\n\t\t\t\t\ti += 2;\n\t\t\t\t} else {\n\t\t\t\t\tc2 = utftext.charCodeAt(i + 1);\n\t\t\t\t\tc3 = utftext.charCodeAt(i + 2);\n\t\t\t\t\tstring += String.fromCharCode((c & 15) << 12 | (c2 & 63) << 6 | c3 & 63);\n\t\t\t\t\ti += 3;\n\t\t\t\t}\n\t\t\t}\n\t\n\t\t\treturn string;\n\t\t}\n\t\n\t};\n\t\n\texports.default = Base64;\n\n/***/ },\n/* 2 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t/* WEBPACK VAR INJECTION */(function(global) {\"use strict\";\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t\tvalue: true\n\t});\n\t\n\tvar _Point = __webpack_require__(3);\n\t\n\tvar _Point2 = _interopRequireDefault(_Point);\n\t\n\tvar _Rectangle = __webpack_require__(4);\n\t\n\tvar _Rectangle2 = _interopRequireDefault(_Rectangle);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\t\n\tfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\t\n\t// bean requires the existence of window\n\tif (typeof window === 'undefined' && typeof global !== 'undefined') {\n\t\tglobal.window = { addEventHandler: function addEventHandler() {} };\n\t\tglobal.document = {};\n\t\tglobal.navigator = {};\n\t}\n\t\n\t// util variables\n\tvar _debugging = [],\n\t    _debugAll = false,\n\t    typeRegistry = {},\n\t    splice = Array.splice;\n\t\n\t/**\n\t * Utility functions\n\t */\n\texports.default = {\n\t\ttype: function type(namespace, name, _type) {\n\t\t\tif (!typeRegistry[namespace]) typeRegistry[namespace] = new Map();\n\t\t\tif (!name) return typeRegistry[namespace];\n\t\t\tif (!_type) return typeRegistry[namespace].get(name);\n\t\t\ttypeRegistry[namespace].set(name, _type);\n\t\t},\n\t\n\t\tcreateType: function createType(namespace, props, defaultType) {\n\t\t\tvar name = props.name;\n\t\n\t\t\t// first check if type exists\n\t\t\tvar type = this.type(namespace, name);\n\t\t\tif (!type) {\n\t\t\t\tvar extend = props.extends ? this.type(namespace, props.extends) : null;\n\t\t\t\tif (!extend && defaultType) extend = defaultType;\n\t\t\t\tif (extend) type = function (_extend) {\n\t\t\t\t\t_inherits(type, _extend);\n\t\n\t\t\t\t\tfunction type() {\n\t\t\t\t\t\t_classCallCheck(this, type);\n\t\n\t\t\t\t\t\treturn _possibleConstructorReturn(this, Object.getPrototypeOf(type).apply(this, arguments));\n\t\t\t\t\t}\n\t\n\t\t\t\t\treturn type;\n\t\t\t\t}(extend);else {\n\t\t\t\t\ttype = function type(config) {\n\t\t\t\t\t\t_classCallCheck(this, type);\n\t\n\t\t\t\t\t\t_.assign(this, config);\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t\tdelete props.name;\n\t\t\t\tdelete props.extends;\n\t\t\t\t_.assign(type.prototype, props);\n\t\t\t\ttype.typeName = name;\n\t\t\t\tthis.type(namespace, name, type);\n\t\t\t\tthis.log('Utils', 'Utils.createType - ' + namespace + '.' + name);\n\t\t\t}\n\t\t\treturn type;\n\t\t},\n\t\n\t\tbuildTypes: function buildTypes(types, namespace, defaultType) {\n\t\t\tvar _this2 = this;\n\t\n\t\t\tthis.log('Utils', 'Utils.buildTypes - ' + namespace);\n\t\n\t\t\tif (!types && defaultType) {\n\t\t\t\tthis.createType(namespace, defaultType);\n\t\t\t\tthis.log('Utils', 'Utils.buildTypes end');\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tif (defaultType) {\n\t\t\t\tvar type = _.remove(types, { name: defaultType.name });\n\t\t\t\ttype = type.length > 0 ? type[0] : null;\n\t\t\t\tif (type) defaultType = this.createType(namespace, _.defaultsDeep(type, defaultType));else defaultType = this.createType(namespace, defaultType);\n\t\t\t}\n\t\n\t\t\t_.forEach(types, function (type) {\n\t\t\t\t_this2.createType(namespace, type, defaultType);\n\t\t\t});\n\t\t\tthis.log('Utils', 'Utils.buildTypes end');\n\t\t},\n\t\n\t\t// Helper function to correctly set up the prototype chain, for subclasses.\n\t\t// Similar to `goog.inherits`, but uses a hash of prototype properties and\n\t\t// class properties to be extended.\n\t\textend: function extend(child, parent, protoProps, staticProps) {\n\t\t\t// Add static properties to the constructor function, if supplied.\n\t\t\t_.extend(child, parent, staticProps);\n\t\n\t\t\t// Set the prototype chain to inherit from `parent`, without calling\n\t\t\t// `parent`'s constructor function.\n\t\t\tvar Surrogate = function Surrogate() {\n\t\t\t\tthis.constructor = child;\n\t\t\t};\n\t\t\tSurrogate.prototype = parent.prototype;\n\t\t\tchild.prototype = new Surrogate();\n\t\n\t\t\t// Add prototype properties (instance properties) to the subclass,\n\t\t\t// if supplied.\n\t\t\tif (protoProps) _.extend(child.prototype, protoProps);\n\t\n\t\t\t// Set a convenience property in case the parent's prototype is needed later.\n\t\t\tchild.superclass = parent.prototype;\n\t\n\t\t\treturn child;\n\t\t},\n\t\n\t\tinitConfig: function initConfig(obj, config) {\n\t\t\tvar props = {},\n\t\t\t    c = obj.constructor,\n\t\t\t    cArr = [c];\n\t\t\twhile (c) {\n\t\t\t\tif (c.super) {\n\t\t\t\t\tc = c.super.constructor;\n\t\t\t\t\tsplice.apply(cArr, [0, 0, c]);\n\t\t\t\t} else c = null;\n\t\t\t}\n\t\n\t\t\tfor (var i = 0; i < cArr.length; i++) {\n\t\t\t\tc = cArr[i];\n\t\t\t\tif (c.DEFAULTS) _.assign(props, c.DEFAULTS);\n\t\t\t}\n\t\t\tobj.props = _.assign(props, config);\n\t\t\tc.prototype.prop = function (name, value) {\n\t\t\t\tif (!value) return this.props[name];\n\t\t\t\tthis.props[name] = value;\n\t\t\t};\n\t\t},\n\t\n\t\t/**\n\t  * Gets the JS class constructor.\n\t  * @param {Object} jsClass\n\t  * @param {Object} defaultClass\n\t  */\n\t\tgetConstructor: function getConstructor(jsClass, defaultClass) {\n\t\t\tif (!jsClass) jsClass = defaultClass;\n\t\n\t\t\tif (_.isString(jsClass)) jsClass = eval(jsClass);\n\t\t\treturn jsClass;\n\t\t},\n\t\n\t\tdebug: function debug(moduleName) {\n\t\t\tif (moduleName) {\n\t\t\t\t_debugging.push(moduleName);\n\t\t\t} else {\n\t\t\t\t_debugAll = true;\n\t\t\t}\n\t\t},\n\t\n\t\tlog: function log(name, message) {\n\t\t\tif (!window.console) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tvar debug = _debugAll;\n\t\t\tif (!_debugAll) {\n\t\t\t\tdebug = false;\n\t\t\t\tfor (var i = 0; i < _debugging.length; i++) {\n\t\t\t\t\tif (_debugging[i] == name) debug = true;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (!debug) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\twhile (name.length < 10) {\n\t\t\t\tname = name + ' ';\n\t\t\t}\n\t\t\tname = name.substring(0, 10) + \" - \";\n\t\t\tconsole.info(name, message);\n\t\t},\n\t\n\t\t/**\n\t  * Get the relative position of sub shapes within a parent share.\n\t  * @param bounds\n\t  * @param geometry The geometry information, the format of Geometry is:\n\t  * {\n\t  *      x: \"x coordinate of ref point, if less than 1, will be treated as the percentage of the parent width.\",\n\t  *      y: \"y coordinate of ref point.\",\n\t  *      anchorX: \"x pos of child relative to the ref point\",\n\t  *      anchorY: \"y pos of child relative to the ref point\",\n\t  *      offsetX: \"the offset in the x direction.\",\n\t  *      offsetY: \"the offset in the y direction.\",\n\t  *      width: \"the width of the child element\",\n\t  *      height: \"the height of the child element\"\n\t  * }\n\t  * @returns {*[]}\n\t  */\n\t\tgetRelativePosition: function getRelativePosition(bounds, geometry) {\n\t\t\tvar x = Math.abs(geometry.x) <= 1 ? bounds.width * geometry.x : geometry.x;\n\t\t\tvar y = Math.abs(geometry.y) <= 1 ? bounds.height * geometry.y : geometry.y;\n\t\t\treturn this.offsetPosition([x, y], geometry);\n\t\t},\n\t\n\t\toffsetPosition: function offsetPosition(pos, geometry) {\n\t\t\treturn [pos[0] + geometry.width * geometry.anchorX + geometry.offsetX, pos[1] + geometry.height * geometry.anchorY + geometry.offsetY];\n\t\t},\n\t\n\t\t/**\n\t  * Get the position relative to the graph that's unscaled, i.e., absolute position without considering translation and scale.\n\t  * @param t the current translate\n\t  * @param scale the current scale\n\t  * @param o can be either a Point or a Rectangle or a Point array.\n\t  */\n\t\tunscale: function unscale(t, scale, o) {\n\t\t\tif (o instanceof _Rectangle2.default) return new _Rectangle2.default(o.x * scale + t[0], o.y * scale + t[1], o.width * scale, o.height * scale);else if (o instanceof _Point2.default) return new _Point2.default(o.x * scale + t[0], o.y * scale + t[1]);else return [o[0] * scale + t[0], o[1] * scale + t[1]];\n\t\t},\n\t\n\t\t/**\n\t  * Get the position relative to the graph that's scaled, i.e., relative position considering translation and scale.\n\t  * @param t the current translation\n\t  * @param scale the current scale\n\t  * @param o can be either a Point or a Rectangle or a Point array.\n\t  */\n\t\tscale: function scale(t, _scale, o) {\n\t\t\tif (o instanceof _Rectangle2.default) return new _Rectangle2.default((o.x - t[0]) / _scale, (o.y - t[1]) / _scale, o.width / _scale, o.height / _scale);else if (o instanceof _Point2.default) return new _Point2.default((o.x - t[0]) / _scale, (o.y - t[1]) / _scale);else return [(o[0] - t[0]) / _scale, (o[1] - t[1]) / _scale];\n\t\t},\n\t\n\t\t/**\n\t  * Convenience method.\n\t  */\n\t\tgetProperty: function getProperty(obj, prop) {\n\t\t\tif (!obj) return null;\n\t\t\tif (_.has(obj, prop)) return obj[prop];\n\t\t\tif (obj.prop && _.isFunction(obj.prop)) return obj.prop(prop);\n\t\t\treturn null;\n\t\t}\n\t};\n\t/* WEBPACK VAR INJECTION */}.call(exports, (function() { return this; }())))\n\n/***/ },\n/* 3 */\n/***/ function(module, exports) {\n\n\t\"use strict\";\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t\tvalue: true\n\t});\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tvar Point = function () {\n\t\tfunction Point(x, y) {\n\t\t\t_classCallCheck(this, Point);\n\t\n\t\t\tthis.x = x;\n\t\t\tthis.y = y;\n\t\t}\n\t\n\t\t/**\n\t  * Make a clone of this point\n\t  */\n\t\n\t\n\t\t_createClass(Point, [{\n\t\t\tkey: \"clone\",\n\t\t\tvalue: function clone() {\n\t\t\t\treturn new Point(this.x, this.y);\n\t\t\t}\n\t\n\t\t\t/**\n\t   * Calculate the distance from this pt to the other pt.\n\t   * @param aPt\n\t   * @returns {number}\n\t   */\n\t\n\t\t}, {\n\t\t\tkey: \"distance\",\n\t\t\tvalue: function distance(aPt) {\n\t\t\t\treturn Math.sqrt((this.x - aPt.x) * (this.x - aPt.x) + (this.y - aPt.y) * (this.y - aPt.y));\n\t\t\t}\n\t\n\t\t\t/**\n\t   * Translate this point\n\t  \t */\n\t\n\t\t}, {\n\t\t\tkey: \"translate\",\n\t\t\tvalue: function translate(p2) {\n\t\t\t\tthis.x += p2.x;\n\t\t\t\tthis.y += p2.y;\n\t\t\t\treturn this;\n\t\t\t}\n\t\n\t\t\t/**\n\t   * Scale this vector\n\t  \t */\n\t\n\t\t}, {\n\t\t\tkey: \"scale\",\n\t\t\tvalue: function scale(_scale) {\n\t\t\t\tthis.x *= _scale;\n\t\t\t\tthis.y *= _scale;\n\t\t\t\treturn this;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"getScaled\",\n\t\t\tvalue: function getScaled(scale) {\n\t\t\t\treturn new Point(this.x * scale, this.y * scale);\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"getTranslated\",\n\t\t\tvalue: function getTranslated(p2) {\n\t\t\t\treturn new Point(this.x + p2.x, this.y + p2.y);\n\t\t\t}\n\t\n\t\t\t/**\n\t   * Get the direction vector from this point to p2.\n\t   * @param p2\n\t   * @returns {Point}\n\t   */\n\t\n\t\t}, {\n\t\t\tkey: \"getDirection\",\n\t\t\tvalue: function getDirection(p2) {\n\t\t\t\tvar dist = this.distance(p2);\n\t\t\t\treturn new Point((p2.x - this.x) / dist, (p2.y - this.y) / dist);\n\t\t\t}\n\t\n\t\t\t/**\n\t   * rotate the point about the origin. With the specified angle.\n\t   * @param angle the angle to rotate\n\t   */\n\t\n\t\t}, {\n\t\t\tkey: \"rotate\",\n\t\t\tvalue: function rotate(angle) {\n\t\t\t\tvar cos = Math.cos(angle * Math.PI / 180);\n\t\t\t\tvar sin = Math.sin(angle * Math.PI / 180);\n\t\t\t\tvar x = this.x,\n\t\t\t\t    y = this.y;\n\t\t\t\tthis.x = x * cos - y * sin;\n\t\t\t\tthis.y = x * sin + y * cos;\n\t\t\t\treturn this;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"getRotated\",\n\t\t\tvalue: function getRotated(angle) {\n\t\t\t\treturn this.clone().rotate(angle);\n\t\t\t}\n\t\n\t\t\t/**\n\t   * Calculate the dot product, treating this and p2 as vectors.\n\t   */\n\t\n\t\t}, {\n\t\t\tkey: \"dotProduct\",\n\t\t\tvalue: function dotProduct(p2) {\n\t\t\t\treturn this.x * p2.x + this.y * p2.y;\n\t\t\t}\n\t\n\t\t\t/**\n\t   * Get the mid point between this and p2.\n\t  \t */\n\t\n\t\t}, {\n\t\t\tkey: \"getMidPoint\",\n\t\t\tvalue: function getMidPoint(p2) {\n\t\t\t\treturn new Point((this.x + p2.x) / 2, (this.y + p2.y) / 2);\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"reverse\",\n\t\t\tvalue: function reverse() {\n\t\t\t\tthis.x = -this.x;\n\t\t\t\tthis.y = -this.y;\n\t\t\t\treturn this;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"equals\",\n\t\t\tvalue: function equals(p2) {\n\t\t\t\tif (!p2 || p2.constructor != Point) return false;\n\t\n\t\t\t\treturn this.x == p2.x && this.y == p2.y;\n\t\t\t}\n\t\n\t\t\t/**\n\t   * Reflect this point w.r.t. the rectangle.\n\t   * If vertical is true, it will reflect the point cross the vertical\n\t   * central line of the rectangle, otherwise reflect cross the horizontal\n\t   * central line.\n\t   *\n\t   * @param rect the rectangle\n\t   * @param vertical whether is vertical reflection or horizontal reflection.\n\t   */\n\t\n\t\t}, {\n\t\t\tkey: \"reflect\",\n\t\t\tvalue: function reflect(rect, vertical) {\n\t\t\t\tif (vertical) this.x = 2 * rect.x - this.x;else this.y = 2 * rect.y - this.y;\n\t\t\t\treturn this;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"toString\",\n\t\t\tvalue: function toString() {\n\t\t\t\treturn this.x + \",\" + this.y;\n\t\t\t}\n\t\t}]);\n\t\n\t\treturn Point;\n\t}();\n\t\n\tPoint.W = new Point(-1, 0);\n\tPoint.N = new Point(0, -1);\n\tPoint.S = new Point(0, 1);\n\tPoint.E = new Point(1, 0);\n\tPoint.NE = new Point(1, -1);\n\tPoint.NW = new Point(-1, -1);\n\tPoint.SE = new Point(1, 1);\n\tPoint.SW = new Point(-1, 1);\n\t\n\texports.default = Point;\n\n/***/ },\n/* 4 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t\tvalue: true\n\t});\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tvar _lodash = __webpack_require__(5);\n\t\n\tvar _lodash2 = _interopRequireDefault(_lodash);\n\t\n\tvar _Point = __webpack_require__(3);\n\t\n\tvar _Point2 = _interopRequireDefault(_Point);\n\t\n\tvar _Shape2 = __webpack_require__(6);\n\t\n\tvar _Shape3 = _interopRequireDefault(_Shape2);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\t\n\tfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\t\n\tvar Rectangle = function (_Shape) {\n\t\t_inherits(Rectangle, _Shape);\n\t\n\t\tfunction Rectangle() {\n\t\t\t_classCallCheck(this, Rectangle);\n\t\n\t\t\treturn _possibleConstructorReturn(this, Object.getPrototypeOf(Rectangle).apply(this, arguments));\n\t\t}\n\t\n\t\t_createClass(Rectangle, [{\n\t\t\tkey: \"contains\",\n\t\n\t\t\t/**\r\n\t   * Checks whether this rectangle contains a given point of a given rectangle\r\n\t   */\n\t\t\tvalue: function contains(el) {\n\t\t\t\tvar w = el.width || 0;\n\t\t\t\tvar h = el.height || 0;\n\t\t\t\tvar left = el.x - w / 2;\n\t\t\t\tvar right = el.x + w / 2;\n\t\t\t\tvar top = el.y - h / 2;\n\t\t\t\tvar bottom = el.y + h / 2;\n\t\t\t\treturn right <= this.right && left >= this.left && top >= this.top && bottom <= this.bottom;\n\t\t\t}\n\t\n\t\t\t/**\r\n\t   * Calcualte the distance to a point. 0 if this rectangle contains the point.\r\n\t   */\n\t\n\t\t}, {\n\t\t\tkey: \"distance\",\n\t\t\tvalue: function distance(pt) {\n\t\t\t\tif (this.contains(pt)) return 0;\n\t\n\t\t\t\tif (pt.x < this.left) {\n\t\t\t\t\tif (pt.y < this.top) return pt.distance(new _Point2.default(this.left, this.top));\n\t\t\t\t\tif (pt.y <= this.bottom) return this.left - pt.x;\n\t\t\t\t\treturn pt.distance(new _Point2.default(this.left, this.bottom));\n\t\t\t\t}\n\t\t\t\tif (pt.x <= this.right) {\n\t\t\t\t\tif (pt.y <= this.top) return this.top - pt.y;\n\t\t\t\t\treturn pt.y - this.bottom;\n\t\t\t\t}\n\t\t\t\tif (pt.y < this.top) return pt.distance(new _Point2.default(this.right, this.top));\n\t\t\t\tif (pt.y <= this.bottom) return pt.x - this.right;\n\t\t\t\treturn pt.distance(new _Point2.default(this.right, this.bottom));\n\t\t\t}\n\t\n\t\t\t/**\r\n\t   * Given two points, we want to detect whether the line joining the pts intersect\r\n\t   * with the rectangle or not. We assume only horizontal or vertical line segments.\r\n\t   *\r\n\t   * @return int the side of the intersection: -1: no intersection, 0: left, 1: top, 2: right, 3: bottom, 4: containment.\r\n\t   */\n\t\n\t\t}, {\n\t\t\tkey: \"detectIntersection\",\n\t\t\tvalue: function detectIntersection(pt1, pt2) {\n\t\t\t\tvar horizontal = pt1.y == pt2.y;\n\t\t\t\tvar contains1 = this.contains(pt1);\n\t\t\t\tvar contains2 = this.contains(pt2);\n\t\t\t\tif (contains1 && contains2) return 4;\n\t\t\t\tif (!contains1 && !contains2) {\n\t\t\t\t\tif (horizontal && pt1.y >= this.top && pt1.y <= this.bottom) {\n\t\t\t\t\t\tif (pt1.x < this.left && pt2.x > this.right) return 0;\n\t\t\t\t\t\tif (pt1.x > this.right && pt2.x < this.left) return 2;\n\t\t\t\t\t}\n\t\t\t\t\tif (!horizontal && pt1.x >= this.left && pt1.x <= this.right) {\n\t\t\t\t\t\tif (pt1.y < this.top && pt2.y > this.bottom) return 1;\n\t\t\t\t\t\tif (pt1.y > this.bottom && pt2.y < this.top) return 3;\n\t\t\t\t\t}\n\t\t\t\t\treturn -1;\n\t\t\t\t}\n\t\n\t\t\t\tvar outPt = contains1 ? pt2 : pt1;\n\t\t\t\tif (horizontal) {\n\t\t\t\t\tif (outPt.x > this.right) return 2;\n\t\t\t\t\treturn 0;\n\t\t\t\t} else {\n\t\t\t\t\tif (outPt.y < this.top) return 1;\n\t\t\t\t\treturn 3;\n\t\t\t\t}\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"toString\",\n\t\t\tvalue: function toString() {\n\t\t\t\treturn 'Rectangle:{x=' + this.x + ';y=' + this.y + ';width=' + this.width + ';height=' + this.height + '}';\n\t\t\t}\n\t\t}], [{\n\t\t\tkey: \"getPerimeter\",\n\t\t\tvalue: function getPerimeter(rect, pt) {\n\t\t\t\tvar orthogonal = arguments.length <= 2 || arguments[2] === undefined ? false : arguments[2];\n\t\n\t\t\t\tvar x = rect.x;\n\t\t\t\tvar y = rect.y;\n\t\t\t\tvar dx = pt.x - x;\n\t\t\t\tvar dy = pt.y - y;\n\t\t\t\tvar alpha = Math.atan2(dy, dx);\n\t\t\t\tvar p = new _Point2.default(0, 0);\n\t\t\t\tvar pi = Math.PI;\n\t\t\t\tvar pi2 = Math.PI / 2;\n\t\t\t\tvar beta = pi2 - alpha;\n\t\t\t\tvar t = Math.atan2(rect.height, rect.width);\n\t\n\t\t\t\tif (alpha < -pi + t || alpha > pi - t) {\n\t\t\t\t\t// Left edge\n\t\t\t\t\tp.x = rect.left;\n\t\t\t\t\tp.y = y - rect.width * Math.tan(alpha) / 2;\n\t\t\t\t} else if (alpha < -t) {\n\t\t\t\t\t// Top Edge\n\t\t\t\t\tp.y = rect.top;\n\t\t\t\t\tp.x = x - rect.height * Math.tan(beta) / 2;\n\t\t\t\t} else if (alpha < t) {\n\t\t\t\t\t// Right Edge\n\t\t\t\t\tp.x = rect.right;\n\t\t\t\t\tp.y = y + rect.width * Math.tan(alpha) / 2;\n\t\t\t\t} else {\n\t\t\t\t\t// Bottom Edge\n\t\t\t\t\tp.y = rect.bottom;\n\t\t\t\t\tp.x = x + rect.height * Math.tan(beta) / 2;\n\t\t\t\t}\n\t\n\t\t\t\tif (orthogonal) {\n\t\t\t\t\tif (alpha < -pi + t || alpha > pi - t) {\n\t\t\t\t\t\t// Left edge\n\t\t\t\t\t\tp.x = rect.left;\n\t\t\t\t\t\tp.y = y;\n\t\t\t\t\t} else if (alpha < -t) {\n\t\t\t\t\t\t// Top Edge\n\t\t\t\t\t\tp.y = rect.top;\n\t\t\t\t\t\tp.x = x;\n\t\t\t\t\t} else if (alpha < t) {\n\t\t\t\t\t\t// Right Edge\n\t\t\t\t\t\tp.x = rect.right;\n\t\t\t\t\t\tp.y = y;\n\t\t\t\t\t} else {\n\t\t\t\t\t\t// Bottom Edge\n\t\t\t\t\t\tp.y = rect.bottom;\n\t\t\t\t\t\tp.x = x;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\n\t\t\t\tvar dir = Rectangle.getDirection(rect, p, orthogonal);\n\t\t\t\treturn { point: p, direction: dir };\n\t\t\t}\n\t\n\t\t\t/**\r\n\t   * Return the bounding rectangle that contains p1 and p2\r\n\t   */\n\t\n\t\t}, {\n\t\t\tkey: \"getBoundingRectangle\",\n\t\t\tvalue: function getBoundingRectangle(pts, margin) {\n\t\t\t\tif (!pts || pts.length == 0) return null;\n\t\t\t\tmargin = margin || [0, 0, 0, 0];\n\t\t\t\tif (!_lodash2.default.isArray(margin)) margin = [margin, margin, margin, margin];\n\t\t\t\tvar min = [pts[0].x, pts[0].y];\n\t\t\t\tvar max = [pts[0].x, pts[0].y];\n\t\t\t\tfor (var i = 1; i < pts.length; i++) {\n\t\t\t\t\tvar p = pts[i];\n\t\t\t\t\tif (p.x < min[0]) {\n\t\t\t\t\t\tmin[0] = p.x;\n\t\t\t\t\t}\n\t\t\t\t\tif (p.y < min[1]) {\n\t\t\t\t\t\tmin[1] = p.y;\n\t\t\t\t\t}\n\t\t\t\t\tif (p.x > max[0]) {\n\t\t\t\t\t\tmax[0] = p.x;\n\t\t\t\t\t}\n\t\t\t\t\tif (p.y > max[1]) {\n\t\t\t\t\t\tmax[1] = p.y;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tmin[0] = min[0] - margin[0];\n\t\t\t\tmin[1] = min[1] - margin[1];\n\t\t\t\tmax[0] = max[0] + margin[2];\n\t\t\t\tmax[1] = max[1] + margin[3];\n\t\t\t\tvar w = Math.abs(max[0] - min[0]);\n\t\t\t\tvar h = Math.abs(max[1] - min[1]);\n\t\t\t\treturn new Rectangle(min[0] + w / 2, min[1] + h / 2, w, h);\n\t\t\t}\n\t\n\t\t\t/**\r\n\t   * Create a union of all the rectangles.\r\n\t   * @param rects\r\n\t   */\n\t\n\t\t}, {\n\t\t\tkey: \"union\",\n\t\t\tvalue: function union(rects) {\n\t\t\t\tvar minx = null,\n\t\t\t\t    miny = null,\n\t\t\t\t    maxx = -Infinity,\n\t\t\t\t    maxy = -Infinity;\n\t\t\t\t_lodash2.default.each(rects, function (rect) {\n\t\t\t\t\tminx = minx || rect.x;\n\t\t\t\t\tminy = miny || rect.y;\n\t\t\t\t\tminx = Math.min(minx, rect.x);\n\t\t\t\t\tminy = Math.min(miny, rect.y);\n\t\t\t\t\tmaxx = Math.max(maxx, rect.right());\n\t\t\t\t\tmaxy = Math.max(maxy, rect.bottom());\n\t\t\t\t});\n\t\t\t\tminx = minx || 0;\n\t\t\t\tminy = miny || 0;\n\t\t\t\treturn new Rectangle(minx, miny, maxx - minx, maxy - miny);\n\t\t\t}\n\t\n\t\t\t/**\r\n\t   * Returns the direction the point <i>p</i> is in relation to the given rectangle.\r\n\t   * Possible values are WEST (-1,0), EAST (1,0), NORTH (0,-1) and SOUTH (0,1) if orthogonal is true, otherwise return\r\n\t   * the direction connection the center of r and p.\r\n\t   * @param r\r\n\t   * @param p\r\n\t   * @param orthogonal\r\n\t   * @returns {Point|*}\r\n\t   */\n\t\n\t\t}, {\n\t\t\tkey: \"getDirection\",\n\t\t\tvalue: function getDirection(r, p) {\n\t\t\t\tvar orthogonal = arguments.length <= 2 || arguments[2] === undefined ? false : arguments[2];\n\t\n\t\t\t\tif (!orthogonal) return new _Point2.default(r.x, r.y).getDirection(new _Point2.default(p.x, p.y));\n\t\n\t\t\t\tvar i = void 0,\n\t\t\t\t    distance = Math.abs(r.left - p.x),\n\t\t\t\t    direction = _Point2.default.W;\n\t\n\t\t\t\ti = Math.abs(r.top - p.y);\n\t\t\t\tif (i <= distance) {\n\t\t\t\t\tdistance = i;\n\t\t\t\t\tdirection = _Point2.default.N;\n\t\t\t\t}\n\t\n\t\t\t\ti = Math.abs(r.bottom - p.y);\n\t\t\t\tif (i <= distance) {\n\t\t\t\t\tdistance = i;\n\t\t\t\t\tdirection = _Point2.default.S;\n\t\t\t\t}\n\t\n\t\t\t\ti = Math.abs(r.right - p.x);\n\t\t\t\tif (i < distance) {\n\t\t\t\t\tdirection = _Point2.default.E;\n\t\t\t\t}\n\t\n\t\t\t\treturn direction;\n\t\t\t}\n\t\t}]);\n\t\n\t\treturn Rectangle;\n\t}(_Shape3.default);\n\t\n\texports.default = Rectangle;\n\n/***/ },\n/* 5 */\n/***/ function(module, exports) {\n\n\tmodule.exports = __WEBPACK_EXTERNAL_MODULE_5__;\n\n/***/ },\n/* 6 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t\tvalue: true\n\t});\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tvar _lodash = __webpack_require__(5);\n\t\n\tvar _lodash2 = _interopRequireDefault(_lodash);\n\t\n\tvar _Point = __webpack_require__(3);\n\t\n\tvar _Point2 = _interopRequireDefault(_Point);\n\t\n\tvar _Rectangle = __webpack_require__(4);\n\t\n\tvar _Rectangle2 = _interopRequireDefault(_Rectangle);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tvar registry = {};\n\t\n\tvar Shape = function () {\n\t\tfunction Shape(x, y, width, height, config) {\n\t\t\t_classCallCheck(this, Shape);\n\t\n\t\t\tthis.x = x;\n\t\t\tthis.y = y;\n\t\t\tthis.width = width;\n\t\t\tthis.height = height;\n\t\t\t_lodash2.default.defaults(this, config, { x: 0, y: 0, width: 0, height: 0 });\n\t\t}\n\t\n\t\t/**\n\t  * Return the y-coord of the top side of this rectangle\n\t  */\n\t\n\t\n\t\t_createClass(Shape, [{\n\t\t\tkey: \"contains\",\n\t\t\tvalue: function contains(el) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\n\t\t\t/**\n\t   * This will generate n ports on the shape.\n\t   */\n\t\n\t\t}, {\n\t\t\tkey: \"getRegularPoints\",\n\t\t\tvalue: function getRegularPoints(n) {\n\t\t\t\treturn null;\n\t\t\t}\n\t\n\t\t\t/**\n\t   * Get the intersection between boundary of this shape and the line connecting (x,y) with the refPt.\n\t   * @param refPt\n\t   * @returns {null}\n\t   */\n\t\n\t\t}, {\n\t\t\tkey: \"getPerimeter\",\n\t\t\tvalue: function getPerimeter(refPt) {\n\t\t\t\tvar orthogonal = arguments.length <= 1 || arguments[1] === undefined ? false : arguments[1];\n\t\n\t\t\t\treturn this.constructor.getPerimeter(this, refPt, orthogonal);\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"render\",\n\t\t\tvalue: function render(view) {\n\t\t\t\tvar template = _lodash2.default.template(view.getTemplate(this.name, this));\n\t\t\t\treturn template(this);\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"top\",\n\t\t\tget: function get() {\n\t\t\t\treturn this.y - this.height / 2;\n\t\t\t}\n\t\n\t\t\t/**\n\t   * Returns the y-coordinate of the bottom of this Rectangle.\n\t   */\n\t\n\t\t}, {\n\t\t\tkey: \"bottom\",\n\t\t\tget: function get() {\n\t\t\t\treturn this.y + this.height / 2;\n\t\t\t}\n\t\n\t\t\t/**\n\t   * Return the x-coord of left side of this rectangle\n\t   */\n\t\n\t\t}, {\n\t\t\tkey: \"left\",\n\t\t\tget: function get() {\n\t\t\t\treturn this.x - this.width / 2;\n\t\t\t}\n\t\n\t\t\t/**\n\t   * Returns the x-coordinate of the right side of this Rectangle.\n\t   */\n\t\n\t\t}, {\n\t\t\tkey: \"right\",\n\t\t\tget: function get() {\n\t\t\t\treturn this.x + this.width / 2;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"center\",\n\t\t\tget: function get() {\n\t\t\t\treturn new _Point2.default(this.x, this.y);\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"bounds\",\n\t\t\tget: function get() {\n\t\t\t\treturn new _Rectangle2.default(this.x, this.y, this.width, this.height);\n\t\t\t}\n\t\t}], [{\n\t\t\tkey: \"getShape\",\n\t\t\tvalue: function getShape(name) {\n\t\t\t\treturn registry[name];\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"addShape\",\n\t\t\tvalue: function addShape(name, c) {\n\t\t\t\tregistry[name] = c;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"removeShape\",\n\t\t\tvalue: function removeShape(name) {\n\t\t\t\tdelete registry[name];\n\t\t\t}\n\t\t}]);\n\t\n\t\treturn Shape;\n\t}();\n\t\n\texports.default = Shape;\n\n/***/ },\n/* 7 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t\tvalue: true\n\t});\n\t\n\tvar _lodash = __webpack_require__(5);\n\t\n\tvar _lodash2 = _interopRequireDefault(_lodash);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\t/**\n\t * dom Utility functions\n\t */\n\texports.default = {\n\t\tisIE: function () {\n\t\t\tif (!window || !window.navigator || !navigator) return false;\n\t\t\tvar sAgent = window.navigator.userAgent;\n\t\t\tvar Idx = sAgent.indexOf(\"MSIE\");\n\t\n\t\t\t// If IE, return version number.\n\t\t\tif (Idx > 0) return parseInt(sAgent.substring(Idx + 5, sAgent.indexOf(\".\", Idx)));\n\t\n\t\t\t// If IE 11 then look for Updated user agent string.\n\t\t\telse if (!!navigator.userAgent.match(/Trident\\/7\\./)) return 11;else if (!!navigator.userAgent.match(/Edge\\//)) return \"Edge\";else return false;\n\t\t}(),\n\t\n\t\tisFireFox: function () {\n\t\t\t// InstallTrigger: Firefox's API to install add-ons\n\t\t\treturn typeof InstallTrigger !== 'undefined';\n\t\t}(),\n\t\n\t\tisChrome: function () {\n\t\t\tif (!window || !window.navigator || !navigator || navigator.userAgent.indexOf('Edge') >= 0) return false;\n\t\t\tvar raw = navigator.userAgent.match(/Chrom(e|ium)\\/([0-9]+)\\./);\n\t\t\treturn raw ? parseInt(raw[2], 10) : false;\n\t\t}(),\n\t\n\t\tcreateElement: function createElement(tag, attribs, styles, html) {\n\t\t\tvar el = document.createElement(tag);\n\t\t\tthis.setElement(el, attribs, styles);\n\t\t\tif (html) el.innerHTML = html;\n\t\t\treturn el;\n\t\t},\n\t\n\t\tcreateElementByString: function createElementByString(str) {\n\t\t\tvar temp = this.createElement('div', null, null, str);\n\t\t\treturn temp.childNodes;\n\t\t},\n\t\n\t\tsetElement: function setElement(el, attribs, styles) {\n\t\t\tif (attribs) {\n\t\t\t\t_lodash2.default.forEach(attribs, function (value, key) {\n\t\t\t\t\tel.setAttribute(key, value);\n\t\t\t\t});\n\t\t\t}\n\t\t\tif (styles) {\n\t\t\t\t_lodash2.default.forEach(styles, function (value, key) {\n\t\t\t\t\tel.style[key] = value;\n\t\t\t\t});\n\t\t\t}\n\t\t},\n\t\n\t\ttestElement: function testElement(node, method) {\n\t\t\treturn node && node.nodeType == 1 && (!method || method(node));\n\t\t},\n\t\n\t\tgetAncestorBy: function getAncestorBy(node, method) {\n\t\t\twhile (node = node.parentNode) {\n\t\t\t\tif (this.testElement(node, method)) return node;\n\t\t\t}return null;\n\t\t},\n\t\n\t\t/**\n\t  * Get the position of element relative to the context.\n\t  * @param el the element\n\t  * @param context\n\t  * @returns {*[]}\n\t  */\n\t\tgetPosition: function getPosition(el, context) {\n\t\t\tif (!context) context = document.body;\n\t\t\tvar elRect = el.getBoundingClientRect();\n\t\t\tvar contextRect = context.getBoundingClientRect();\n\t\n\t\t\treturn [elRect.left - contextRect.left, elRect.top - contextRect.top];\n\t\t},\n\t\tgetCenterPosition: function getCenterPosition(el, context) {\n\t\t\tif (!context) context = document.body;\n\t\t\tvar elRect = el.getBoundingClientRect();\n\t\t\tvar contextRect = context.getBoundingClientRect();\n\t\t\tvar w = elRect.right - elRect.left;\n\t\t\tvar h = elRect.bottom - elRect.top;\n\t\n\t\t\treturn [elRect.left - contextRect.left + w / 2, elRect.top - contextRect.top + h / 2];\n\t\t},\n\t\n\t\n\t\tmove: function move(el, x, y) {\n\t\t\tif (x) el.style.left = x + 'px';\n\t\t\tif (y) el.style.top = y + 'px';\n\t\t},\n\t\n\t\tgetSize: function getSize(el) {\n\t\t\tvar w = parseInt(el.style.offsetWidth, 10);\n\t\t\tvar h = parseInt(el.style.offsetHeight, 10);\n\t\t\treturn [w, h];\n\t\t},\n\t\n\t\tresize: function resize(el, w, h) {\n\t\t\tif (w) el.style.width = w + \"px\";\n\t\t\tif (h) el.style.height = h + 'px';\n\t\t},\n\t\n\t\tpreloadImages: function preloadImages(array) {\n\t\t\tif (!this.preloadImages.list) this.preloadImages.list = [];\n\t\t\tif (!this.preloadImages.loaded) this.preloadImages.loaded = {};\n\t\n\t\t\tvar list = this.preloadImages.list;\n\t\t\tvar img,\n\t\t\t    that = this;\n\t\t\tfor (var i = 0; i < array.length; i++) {\n\t\t\t\timg = new Image();\n\t\t\t\timg.onload = function () {\n\t\t\t\t\tvar index = list.indexOf(this);\n\t\t\t\t\tif (index !== -1) {\n\t\t\t\t\t\tthat.preloadImages.loaded[this.name] = { width: this.width, height: this.height };\n\t\t\t\t\t\t// remove image from the array once it's loaded\n\t\t\t\t\t\t// for memory consumption reasons\n\t\t\t\t\t\tlist.splice(index, 1);\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t\tlist.push(img);\n\t\t\t\timg.src = array[i];\n\t\t\t\timg.name = array[i];\n\t\t\t}\n\t\t},\n\t\n\t\t/**\n\t  * Get's the image's information given the url. Must be preloaded by calling the preloadImage function.\n\t  * @param src\n\t  */\n\t\tgetImageInfo: function getImageInfo(src) {\n\t\t\tif (this.preloadImages.loaded) {\n\t\t\t\treturn this.preloadImages.loaded[src];\n\t\t\t}\n\t\t\treturn null;\n\t\t},\n\t\n\t\tdownloadFile: function downloadFile(name, data) {\n\t\t\tif (!data) return;\n\t\t\tvar mime = data.match(/^data:([^;,]*)/)[1];\n\t\t\tif (name.indexOf('.') < 0) {\n\t\t\t\tif (!mime) mime = 'text/plain';\n\t\t\t\tif (mime == 'text/plain') name = name + '.txt';else {\n\t\t\t\t\tvar type = mime.split('/')[1];\n\t\t\t\t\tif (type.indexOf('+') > 0) type = type.split('+')[0];\n\t\t\t\t\tname = name + '.' + type;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (this.isIE) {\n\t\t\t\tvar encoded = data.indexOf(';base64') >= 0;\n\t\t\t\tif (encoded) data = atob(data.replace('data:' + mime + ';base64,', ''));else data = decodeURI(data.replace('data:' + mime + ',', ''));\n\t\t\t\tdata = this.GetBlob(data, mime);\n\t\t\t\tnavigator.msSaveBlob(data, name);\n\t\t\t} else {\n\t\t\t\tvar link = this.createElement('a', { href: data, download: name }, { display: \"none\" });\n\t\t\t\tdocument.body.appendChild(link);\n\t\t\t\tlink.click();\n\t\t\t\tlink.parentNode.removeChild(link);\n\t\t\t}\n\t\t},\n\t\n\t\t/**\n\t  * Convert b54 to blob. IE only\n\t  */\n\t\tGetBlob: function GetBlob(data, contentType, sliceSize) {\n\t\t\tcontentType = contentType || '';\n\t\t\tsliceSize = sliceSize || 512;\n\t\n\t\t\tvar byteArrays = [];\n\t\n\t\t\tfor (var offset = 0; offset < data.length; offset += sliceSize) {\n\t\t\t\tvar slice = data.slice(offset, offset + sliceSize);\n\t\n\t\t\t\tvar byteNumbers = new Array(slice.length);\n\t\t\t\tfor (var i = 0; i < slice.length; i++) {\n\t\t\t\t\tbyteNumbers[i] = slice.charCodeAt(i);\n\t\t\t\t}\n\t\t\t\tvar byteArray = new Uint8Array(byteNumbers);\n\t\t\t\tbyteArrays.push(byteArray);\n\t\t\t}\n\t\t\treturn new Blob(byteArrays, { type: contentType });\n\t\t},\n\t\n\t\topenImage: function openImage(name, image) {\n\t\t\tvar myWindow = window.open(\"\", \"_blank\", \"toolbar=yes, scrollbars=yes, resizable=yes, width=500, height=500\");\n\t\t\tvar myDocument = myWindow.document;\n\t\t\tvar img = myDocument.createElement(\"img\");\n\t\t\tthis.setElement(img, { src: image, name: name });\n\t\t\tmyDocument.body.appendChild(img);\n\t\t},\n\t\n\t\t/**\n\t  * Check whether the key event is from input, textarea or select.\n\t  * @param e  input event\n\t  */\n\t\teventFromInput: function eventFromInput(e) {\n\t\t\tvar tagName = e.target.tagName;\n\t\t\treturn tagName == 'INPUT' || tagName == 'TEXTAREA' || tagName == 'SELECT';\n\t\t}\n\t};\n\n/***/ },\n/* 8 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t\tvalue: true\n\t});\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tvar _lodash = __webpack_require__(5);\n\t\n\tvar _lodash2 = _interopRequireDefault(_lodash);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\t/**\n\t * A string buffer for fast string manipulation\n\t */\n\t\n\tvar StringBuffer = function () {\n\t\tfunction StringBuffer(str) {\n\t\t\t_classCallCheck(this, StringBuffer);\n\t\n\t\t\tthis.buffer = [];\n\t\t\tif (str) this.buffer.push(str);\n\t\t}\n\t\n\t\t_createClass(StringBuffer, [{\n\t\t\tkey: \"append\",\n\t\t\tvalue: function append(stuff) {\n\t\t\t\tif (_lodash2.default.isString(stuff)) this.buffer.push(stuff);else if (_lodash2.default.isArray(stuff)) this.buffer = this.buffer.concat(stuff);else this.buffer.push(\"\" + stuff);\n\t\t\t\treturn this;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"prepend\",\n\t\t\tvalue: function prepend(stuff) {\n\t\t\t\tif (_lodash2.default.isString(stuff)) this.buffer.splice(0, 0, stuff);else if (_lodash2.default.isArray(stuff)) this.buffer = stuff.concat(this.buffer);else this.buffer.splice(0, 0, \"\" + stuff);\n\t\t\t\treturn this;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"clear\",\n\t\t\tvalue: function clear() {\n\t\t\t\tthis.buffer = [];\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"removeLast\",\n\t\t\tvalue: function removeLast() {\n\t\t\t\tthis.buffer.pop();\n\t\t\t\treturn this;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"toString\",\n\t\t\tvalue: function toString(sep) {\n\t\t\t\tif (!sep) sep = '';\n\t\t\t\treturn this.buffer.join(sep);\n\t\t\t}\n\t\t}]);\n\t\n\t\treturn StringBuffer;\n\t}();\n\t\n\texports.default = StringBuffer;\n\n/***/ },\n/* 9 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t\tvalue: true\n\t});\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tvar _Point = __webpack_require__(3);\n\t\n\tvar _Point2 = _interopRequireDefault(_Point);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tvar Line = function () {\n\t\tfunction Line(start, end) {\n\t\t\t_classCallCheck(this, Line);\n\t\n\t\t\tthis.start = start;\n\t\t\tthis.end = end;\n\t\t}\n\t\n\t\t/**\n\t  * Calculate the length of this line\n\t  */\n\t\n\t\n\t\t_createClass(Line, [{\n\t\t\tkey: 'length',\n\t\t\tvalue: function length() {\n\t\t\t\treturn this.start.distance(this.end);\n\t\t\t}\n\t\n\t\t\t/**\n\t   * Calculate the distance of this line to the point.\n\t   */\n\t\n\t\t}, {\n\t\t\tkey: 'distance',\n\t\t\tvalue: function distance(pt) {\n\t\t\t\tvar x = this.start.distance(pt);\n\t\t\t\tif (x == 0) return 0;\n\t\n\t\t\t\tvar l = this.length();\n\t\t\t\tvar cosa = new _Point2.default((this.end.x - this.start.x) / l, (this.end.y - this.start.y) / l).dotProduct(new _Point2.default(pt.x / x, pt.y / x));\n\t\n\t\t\t\treturn x * Math.sqrt(1 - cosa * cosa);\n\t\t\t}\n\t\n\t\t\t/**\n\t   * Function: intersection\n\t   *\n\t   * Returns the intersection of two lines as an <mxPoint>.\n\t   *\n\t   * Parameters:\n\t   *\n\t   * x0 - X-coordinate of the first line's startpoint.\n\t   * y0 - X-coordinate of the first line's startpoint.\n\t   * x1 - X-coordinate of the first line's endpoint.\n\t   * y1 - Y-coordinate of the first line's endpoint.\n\t   * x2 - X-coordinate of the second line's startpoint.\n\t   * y2 - Y-coordinate of the second line's startpoint.\n\t   * x3 - X-coordinate of the second line's endpoint.\n\t   * y3 - Y-coordinate of the second line's endpoint.\n\t   */\n\t\n\t\t}, {\n\t\t\tkey: 'toString',\n\t\t\tvalue: function toString() {\n\t\t\t\treturn 'Line:{start=' + this.start + ';end=' + this.end + '}';\n\t\t\t}\n\t\t}], [{\n\t\t\tkey: 'intersection',\n\t\t\tvalue: function intersection(x0, y0, x1, y1, x2, y2, x3, y3) {\n\t\t\t\tvar denom = (y3 - y2) * (x1 - x0) - (x3 - x2) * (y1 - y0);\n\t\t\t\tvar nume_a = (x3 - x2) * (y0 - y2) - (y3 - y2) * (x0 - x2);\n\t\t\t\tvar nume_b = (x1 - x0) * (y0 - y2) - (y1 - y0) * (x0 - x2);\n\t\n\t\t\t\tvar ua = nume_a / denom;\n\t\t\t\tvar ub = nume_b / denom;\n\t\n\t\t\t\tif (ua >= 0.0 && ua <= 1.0 && ub >= 0.0 && ub <= 1.0) {\n\t\t\t\t\t// Get the intersection point\n\t\t\t\t\tvar intersectionX = x0 + ua * (x1 - x0);\n\t\t\t\t\tvar intersectionY = y0 + ua * (y1 - y0);\n\t\n\t\t\t\t\treturn new _Point2.default(intersectionX, intersectionY);\n\t\t\t\t}\n\t\n\t\t\t\t// No intersection\n\t\t\t\treturn null;\n\t\t\t}\n\t\t}]);\n\t\n\t\treturn Line;\n\t}();\n\t\n\texports.default = Line;\n\n/***/ },\n/* 10 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t\tvalue: true\n\t});\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tvar _Shape2 = __webpack_require__(6);\n\t\n\tvar _Shape3 = _interopRequireDefault(_Shape2);\n\t\n\tvar _Point = __webpack_require__(3);\n\t\n\tvar _Point2 = _interopRequireDefault(_Point);\n\t\n\tvar _Rectangle = __webpack_require__(4);\n\t\n\tvar _Rectangle2 = _interopRequireDefault(_Rectangle);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\t\n\tfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\t\n\tvar Ellipse = function (_Shape) {\n\t\t_inherits(Ellipse, _Shape);\n\t\n\t\tfunction Ellipse() {\n\t\t\t_classCallCheck(this, Ellipse);\n\t\n\t\t\treturn _possibleConstructorReturn(this, Object.getPrototypeOf(Ellipse).apply(this, arguments));\n\t\t}\n\t\n\t\t_createClass(Ellipse, [{\n\t\t\tkey: \"toString\",\n\t\t\tvalue: function toString() {\n\t\t\t\treturn 'Ellipse:{x=' + this.x + ';y=' + this.y + ';width=' + this.width + ';height=' + this.height + '}';\n\t\t\t}\n\t\t}], [{\n\t\t\tkey: \"getPerimeter\",\n\t\t\tvalue: function getPerimeter(rect, pt) {\n\t\t\t\tvar orthogonal = arguments.length <= 2 || arguments[2] === undefined ? false : arguments[2];\n\t\n\t\t\t\tvar a = rect.width / 2;\n\t\t\t\tvar b = rect.height / 2;\n\t\t\t\tvar cx = rect.x;\n\t\t\t\tvar cy = rect.y;\n\t\t\t\tvar px = pt.x;\n\t\t\t\tvar py = pt.y;\n\t\n\t\t\t\t// Calculates straight line equation through\n\t\t\t\t// point and ellipse center y = d * x + h\n\t\t\t\tvar dx = parseInt(px - cx);\n\t\t\t\tvar dy = parseInt(py - cy);\n\t\n\t\t\t\tvar tx, ty;\n\t\n\t\t\t\tif (dx == 0 && dy != 0) {\n\t\t\t\t\treturn new _Point2.default(cx, cy + b * dy / Math.abs(dy));\n\t\t\t\t} else if (dx == 0 && dy == 0) {\n\t\t\t\t\treturn new _Point2.default(px, py);\n\t\t\t\t}\n\t\n\t\t\t\t// Calculates intersection\n\t\t\t\tvar d = dy / dx;\n\t\t\t\tvar h = cy - d * cx;\n\t\t\t\tvar e = a * a * d * d + b * b;\n\t\t\t\tvar f = -2 * cx * e;\n\t\t\t\tvar g = a * a * d * d * cx * cx + b * b * cx * cx - a * a * b * b;\n\t\t\t\tvar det = Math.sqrt(f * f - 4 * e * g);\n\t\n\t\t\t\t// Two solutions (perimeter points)\n\t\t\t\tvar xout1 = (-f + det) / (2 * e);\n\t\t\t\tvar xout2 = (-f - det) / (2 * e);\n\t\t\t\tvar yout1 = d * xout1 + h;\n\t\t\t\tvar yout2 = d * xout2 + h;\n\t\t\t\tvar dist1 = Math.sqrt(Math.pow(xout1 - px, 2) + Math.pow(yout1 - py, 2));\n\t\t\t\tvar dist2 = Math.sqrt(Math.pow(xout2 - px, 2) + Math.pow(yout2 - py, 2));\n\t\n\t\t\t\t// Correct solution\n\t\t\t\tvar xout = 0;\n\t\t\t\tvar yout = 0;\n\t\n\t\t\t\tif (dist1 < dist2) {\n\t\t\t\t\txout = xout1;\n\t\t\t\t\tyout = yout1;\n\t\t\t\t} else {\n\t\t\t\t\txout = xout2;\n\t\t\t\t\tyout = yout2;\n\t\t\t\t}\n\t\n\t\t\t\tvar p = new _Point2.default(xout, yout);\n\t\t\t\tvar dir = _Rectangle2.default.getDirection(rect, p, orthogonal);\n\t\t\t\tif (orthogonal) {\n\t\t\t\t\tif (dir.x == -1) {\n\t\t\t\t\t\treturn { point: new _Point2.default(cx - a, cy), direction: dir };\n\t\t\t\t\t}\n\t\t\t\t\tif (dir.x == 1) {\n\t\t\t\t\t\treturn { point: new _Point2.default(cx + a, cy), direction: dir };\n\t\t\t\t\t}\n\t\t\t\t\tif (dir.y == -1) {\n\t\t\t\t\t\treturn { point: new _Point2.default(cx, cy - b), direction: dir };\n\t\t\t\t\t}\n\t\t\t\t\tif (dir.y == 1) {\n\t\t\t\t\t\treturn { point: new _Point2.default(cx, cy + b), direction: dir };\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn { point: p, direction: dir };\n\t\t\t}\n\t\t}]);\n\t\n\t\treturn Ellipse;\n\t}(_Shape3.default);\n\t\n\texports.default = Ellipse;\n\n/***/ },\n/* 11 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t\tvalue: true\n\t});\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tvar _lodash = __webpack_require__(5);\n\t\n\tvar _lodash2 = _interopRequireDefault(_lodash);\n\t\n\tvar _Point = __webpack_require__(3);\n\t\n\tvar _Point2 = _interopRequireDefault(_Point);\n\t\n\tvar _Utils = __webpack_require__(2);\n\t\n\tvar _Utils2 = _interopRequireDefault(_Utils);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\t\n\tfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tvar defaultConfig = {\n\t\ttype: \"direct\",\n\t\tshowGauge: true,\n\t\torthogonal: false\n\t};\n\t\n\tvar defaultGeometry = {\n\t\twidth: 0,\n\t\theight: 0,\n\t\tanchorX: 0,\n\t\tanchorY: 0,\n\t\toffsetX: 0,\n\t\toffsetY: 0\n\t};\n\t\n\tvar linkTypes = {};\n\t\n\tvar Link = function () {\n\t\tfunction Link(terminalVisual) {\n\t\t\tvar shapeConfig = arguments.length <= 1 || arguments[1] === undefined ? {} : arguments[1];\n\t\t\tvar startMarker = arguments.length <= 2 || arguments[2] === undefined ? null : arguments[2];\n\t\t\tvar endMarker = arguments.length <= 3 || arguments[3] === undefined ? null : arguments[3];\n\t\n\t\t\t_classCallCheck(this, Link);\n\t\n\t\t\tthis.start = terminalVisual[0].point;\n\t\t\tthis.end = terminalVisual[1].point;\n\t\t\tthis.startNormal = terminalVisual[0].direction;\n\t\t\tthis.endNormal = terminalVisual[1].direction;\n\t\t\tthis.startMarker = startMarker;\n\t\t\tthis.endMarker = endMarker;\n\t\t\t_lodash2.default.assign(this, shapeConfig);\n\t\t}\n\t\n\t\t_createClass(Link, [{\n\t\t\tkey: \"render\",\n\t\t\tvalue: function render(view) {\n\t\t\t\treturn view.renderLink(this);\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"getRelativePosition\",\n\t\n\t\n\t\t\t/**\r\n\t   * Calculate the position where to put modifiers or label..\r\n\t   *\r\n\t   * @param geometry: defines how far along the edge should the point be placed.\r\n\t   * @return *[] the relative position.\r\n\t   */\n\t\t\tvalue: function getRelativePosition(geometry) {\n\t\t\t\tif (_lodash2.default.isNumber(geometry)) geometry = { x: geometry };\n\t\t\t\tgeometry = _lodash2.default.defaults(geometry, defaultGeometry);\n\t\t\t\tvar p = geometry.x,\n\t\t\t\t    l = this.length;\n\t\t\t\tif (Math.abs(p) <= 1) p *= l;\n\t\t\t\tif (p < 0) p = l + p;\n\t\t\t\tif (p > l) p = l;\n\t\n\t\t\t\tvar points = this.points,\n\t\t\t\t    d = void 0,\n\t\t\t\t    point = void 0,\n\t\t\t\t    dir = void 0;\n\t\t\t\tfor (var i = 0; i < points.length - 1; i++) {\n\t\t\t\t\td = points[i].distance(points[i + 1]);\n\t\t\t\t\tif (p <= d) {\n\t\t\t\t\t\t// we've located the line segment.\n\t\t\t\t\t\tpoint = points[i].clone();\n\t\t\t\t\t\tdir = point.getDirection(points[i + 1]);\n\t\t\t\t\t\tpoint.translate(dir.getScaled(p));\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\tp -= d;\n\t\t\t\t}\n\t\n\t\t\t\t// return the last point.\n\t\t\t\tif (!point) point = points[points.length - 1];\n\t\t\t\treturn _Utils2.default.offsetPosition([point.x, point.y], geometry);\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"toString\",\n\t\t\tvalue: function toString() {\n\t\t\t\treturn 'Link';\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"points\",\n\t\t\tget: function get() {\n\t\t\t\treturn null;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"controlPts\",\n\t\t\tget: function get() {\n\t\t\t\treturn null;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"length\",\n\t\t\tget: function get() {\n\t\t\t\tvar points = this.points;\n\t\t\t\tvar i = void 0,\n\t\t\t\t    l = 0;\n\t\t\t\tfor (i = 0; i < points.length - 1; i++) {\n\t\t\t\t\tl += points[i].distance(points[i + 1]);\n\t\t\t\t}return l;\n\t\t\t}\n\t\t}], [{\n\t\t\tkey: \"getLink\",\n\t\t\tvalue: function getLink(terminalVisual) {\n\t\t\t\tvar shapeConfig = arguments.length <= 1 || arguments[1] === undefined ? {} : arguments[1];\n\t\t\t\tvar startMarker = arguments.length <= 2 || arguments[2] === undefined ? null : arguments[2];\n\t\t\t\tvar endMarker = arguments.length <= 3 || arguments[3] === undefined ? null : arguments[3];\n\t\n\t\t\t\tshapeConfig = _lodash2.default.defaultsDeep(shapeConfig, defaultConfig);\n\t\t\t\tvar linkClass = linkTypes[shapeConfig.type];\n\t\t\t\tif (linkClass) return new linkClass(terminalVisual, shapeConfig, startMarker, endMarker);\n\t\t\t\tconsole.log('link type not supported: ' + shapeConfig.type);\n\t\t\t\treturn null;\n\t\t\t}\n\t\t}]);\n\t\n\t\treturn Link;\n\t}();\n\t\n\tvar DirectLink = function (_Link) {\n\t\t_inherits(DirectLink, _Link);\n\t\n\t\tfunction DirectLink() {\n\t\t\t_classCallCheck(this, DirectLink);\n\t\n\t\t\treturn _possibleConstructorReturn(this, Object.getPrototypeOf(DirectLink).apply(this, arguments));\n\t\t}\n\t\n\t\t_createClass(DirectLink, [{\n\t\t\tkey: \"points\",\n\t\t\tget: function get() {\n\t\t\t\treturn [this.start, this.end];\n\t\t\t}\n\t\t}]);\n\t\n\t\treturn DirectLink;\n\t}(Link);\n\t\n\tvar BezierLink = function (_Link2) {\n\t\t_inherits(BezierLink, _Link2);\n\t\n\t\tfunction BezierLink() {\n\t\t\t_classCallCheck(this, BezierLink);\n\t\n\t\t\treturn _possibleConstructorReturn(this, Object.getPrototypeOf(BezierLink).apply(this, arguments));\n\t\t}\n\t\n\t\t_createClass(BezierLink, [{\n\t\t\tkey: \"getRelativePosition\",\n\t\t\tvalue: function getRelativePosition(geometry) {\n\t\t\t\tif (_lodash2.default.isNumber(geometry)) geometry = { x: geometry };\n\t\t\t\tgeometry = _lodash2.default.defaults(geometry, defaultGeometry);\n\t\t\t\tvar p = geometry.x,\n\t\t\t\t    l = this.length;\n\t\t\t\tif (Math.abs(p) > 1) p /= l;\n\t\t\t\tif (p < 0) p++;\n\t\t\t\tif (p > 1) p--;\n\t\n\t\t\t\tvar pts = this.points;\n\t\t\t\tvar ctrlpts = this.controlPts;\n\t\t\t\tvar p1 = pts[0];\n\t\t\t\tvar p2 = ctrlpts[1][0];\n\t\t\t\tvar p3 = ctrlpts[1][1];\n\t\t\t\tvar p4 = pts[1];\n\t\n\t\t\t\tvar point = [(1 - p) * (1 - p) * (1 - p) * p1.x + 3 * p * (1 - p) * (1 - p) * p2.x + 3 * p * p * (1 - p) * p3.x + p * p * p * p4.x, (1 - p) * (1 - p) * (1 - p) * p1.y + 3 * p * (1 - p) * (1 - p) * p2.y + 3 * p * p * (1 - p) * p3.y + p * p * p * p4.y];\n\t\t\t\treturn _Utils2.default.offsetPosition([point.x, point.y], geometry);\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"points\",\n\t\t\tget: function get() {\n\t\t\t\treturn [this.start, this.end];\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"controlPts\",\n\t\t\tget: function get() {\n\t\t\t\tvar s = this.points[0],\n\t\t\t\t    e = this.points[1];\n\t\t\t\tvar pts = [];\n\t\t\t\tpts[0] = null;\n\t\t\t\tpts[1] = [];\n\t\t\t\tif (this.startNormal.x == 0) {\n\t\t\t\t\tpts[1][0] = new _Point2.default(s.x, (s.y + e.y) / 2);\n\t\t\t\t} else {\n\t\t\t\t\tpts[1][0] = new _Point2.default((s.x + e.x) / 2, s.y);\n\t\t\t\t}\n\t\t\t\tif (this.endNormal.x == 0) {\n\t\t\t\t\tpts[1][1] = new _Point2.default(e.x, (s.y + e.y) / 2);\n\t\t\t\t} else {\n\t\t\t\t\tpts[1][1] = new _Point2.default((s.x + e.x) / 2, e.y);\n\t\t\t\t}\n\t\t\t\treturn pts;\n\t\t\t}\n\t\t}]);\n\t\n\t\treturn BezierLink;\n\t}(Link);\n\t\n\tvar EntityRelations = function (_Link3) {\n\t\t_inherits(EntityRelations, _Link3);\n\t\n\t\tfunction EntityRelations() {\n\t\t\t_classCallCheck(this, EntityRelations);\n\t\n\t\t\treturn _possibleConstructorReturn(this, Object.getPrototypeOf(EntityRelations).apply(this, arguments));\n\t\t}\n\t\n\t\t_createClass(EntityRelations, [{\n\t\t\tkey: \"points\",\n\t\t\tget: function get() {\n\t\t\t\tvar source = Port.getBounds(edge, true);\n\t\t\t\tvar target = Port.getBounds(edge, false);\n\t\t\t\tvar isSourceLeft = target.right() < source.x;\n\t\t\t\tvar isTargetLeft = source.right() < target.x;\n\t\t\t\tvar result = [];\n\t\n\t\t\t\tvar x0 = isSourceLeft ? source.x : source.x + source.width;\n\t\t\t\tvar y0 = source.getCenterY();\n\t\t\t\tresult.push(new _Point2.default(x0, y0));\n\t\n\t\t\t\tvar xe = isTargetLeft ? target.x : target.x + target.width;\n\t\t\t\tvar ye = target.getCenterY();\n\t\n\t\t\t\tvar seg = this.segment;\n\t\n\t\t\t\tvar dx = isSourceLeft ? -seg : seg;\n\t\t\t\tvar dep = new _Point2.default(x0 + dx, y0);\n\t\n\t\t\t\tdx = isTargetLeft ? -seg : seg;\n\t\t\t\tvar arr = new _Point2.default(xe + dx, ye);\n\t\n\t\t\t\t// Adds intermediate points if both go out on same side\n\t\t\t\tif (isSourceLeft == isTargetLeft) {\n\t\t\t\t\tvar x = isSourceLeft ? Math.min(x0, xe) - seg : Math.max(x0, xe) + seg;\n\t\n\t\t\t\t\tresult.push(new _Point2.default(x, y0));\n\t\t\t\t\tresult.push(new _Point2.default(x, ye));\n\t\t\t\t} else if (dep.x < arr.x == isSourceLeft) {\n\t\t\t\t\tvar midY = y0 + (ye - y0) / 2;\n\t\n\t\t\t\t\tresult.push(dep);\n\t\t\t\t\tresult.push(new _Point2.default(dep.x, midY));\n\t\t\t\t\tresult.push(new _Point2.default(arr.x, midY));\n\t\t\t\t\tresult.push(arr);\n\t\t\t\t} else {\n\t\t\t\t\tresult.push(dep);\n\t\t\t\t\tresult.push(arr);\n\t\t\t\t}\n\t\n\t\t\t\tresult.push(new _Point2.default(xe, ye));\n\t\t\t\treturn result;\n\t\t\t}\n\t\t}]);\n\t\n\t\treturn EntityRelations;\n\t}(Link);\n\t\n\tvar Manhattan = function (_Link4) {\n\t\t_inherits(Manhattan, _Link4);\n\t\n\t\tfunction Manhattan(terminalVisual, shapeConfig, startMarker, endMarker) {\n\t\t\t_classCallCheck(this, Manhattan);\n\t\n\t\t\tshapeConfig = _lodash2.default.defaults(shapeConfig, {\n\t\t\t\tMIN_BUFFER: 10,\n\t\t\t\tautoRoute: false,\n\t\t\t\tmaxChannelWidth: 100\n\t\t\t});\n\t\t\treturn _possibleConstructorReturn(this, Object.getPrototypeOf(Manhattan).call(this, terminalVisual, shapeConfig, startMarker, endMarker));\n\t\t}\n\t\n\t\t_createClass(Manhattan, [{\n\t\t\tkey: \"autoRoute\",\n\t\n\t\n\t\t\t/**\r\n\t   * Automatically route the connection to avoid intersections with other vertices.\r\n\t   */\n\t\t\tvalue: function autoRoute(pts, container, boxes, startBox, endBox) {\n\t\t\t\tvar side, side2, d, box, intersect, j;\n\t\t\t\tvar channel, channel2, pt, dir;\n\t\n\t\t\t\tvar startPadding = 0,\n\t\t\t\t    endPadding;\n\t\t\t\t// first get the start and end channel\n\t\t\t\tbox = boxes[endBox];\n\t\t\t\tpt = pts[pts.length - 2];\n\t\t\t\tif (pt.y < box.y) side = 1;else if (pt.y > box.y + box.height) side = 3;else if (pt.x < box.x) side = 0;else side = 2;\n\t\t\t\tchannel = _getChannel(container, endBox, boxes, side);\n\t\t\t\tendPadding = channel.horizontal ? (channel.right - channel.left) / 2 : (channel.bottom - channel.top) / 2;\n\t\n\t\t\t\tfor (var i = 0; i < pts.length - 1; i++) {\n\t\t\t\t\tif (pts[i + 1].x == pts[i].x && pts[i + 1].y == pts[i].y) continue;\n\t\t\t\t\tintersect = _getFirstIntersection(pts, i, boxes, startBox, endBox);\n\t\t\t\t\tif (!intersect) continue;\n\t\t\t\t\tj = intersect[0];\n\t\t\t\t\tside = intersect[1];\n\t\t\t\t\tbox = boxes[j];\n\t\t\t\t\tchannel = _getChannel(container, j, boxes, side);\n\t\t\t\t\tswitch (side) {\n\t\t\t\t\t\tcase 0:\n\t\t\t\t\t\tcase 2:\n\t\t\t\t\t\t\tpt = new _Point2.default((channel.right + channel.left) / 2, pts[i].y);\n\t\t\t\t\t\t\tdir = _getRouteTendency(pts, i, pt, box, side);\n\t\t\t\t\t\t\tside2 = dir < 0 ? 1 : 3;\n\t\t\t\t\t\t\tchannel2 = _getChannel(container, j, boxes, side2);\n\t\t\t\t\t\t\t// if the previous point is in the channel2, use that point instead of center of the channel.\n\t\t\t\t\t\t\tif (i > 1 && pts[i - 2].y == pts[i - 1].y && pts[i - 1].y > channel2.top && pts[i - 1].y < channel2.bottom) d = pts[i - 1].y - pt.y;else if (i < pts.length - 3 && pts[i + 2].y == pts[i + 3].y && pts[i + 2].y > channel2.top && pts[i + 2].y < channel2.bottom) d = pts[i + 2].y - pt.y;else d = (channel2.bottom + channel2.top) / 2 - pt.y;\n\t\t\t\t\t\t\t// check if we need this pt.\n\t\t\t\t\t\t\tif (side == 0 && pt.x <= pts[i].x || side == 2 && pt.x >= pts[i].x) pt = null;else if (i > 0) {\n\t\t\t\t\t\t\t\t// see if we can push the line out to where we started.\n\t\t\t\t\t\t\t\tif (!_hasIntersection([new _Point2.default(pts[i].x, pts[i].y), new _Point2.default(pts[i].x, pts[i].y + d), new _Point2.default(pt.x, pt.y + d)], boxes)) pt = null;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 1:\n\t\t\t\t\t\tcase 3:\n\t\t\t\t\t\t\tpt = new _Point2.default(pts[i].x, (channel.bottom + channel.top) / 2);\n\t\t\t\t\t\t\tdir = _getRouteTendency(pts, i, pt, box, side);\n\t\t\t\t\t\t\tside2 = dir < 0 ? 0 : 2;\n\t\t\t\t\t\t\tchannel2 = _getChannel(container, j, boxes, side2);\n\t\t\t\t\t\t\t// if the previous point is in the channel2, use that point instead of center of the channel.\n\t\t\t\t\t\t\tif (i > 1 && pts[i - 2].x == pts[i - 1].x && pts[i - 1].x > channel2.left && pts[i - 1].x < channel2.right) d = pts[i - 1].x - pt.x;else if (i < pts.length - 3 && pts[i + 2].x == pts[i + 3].x && pts[i + 2].x > channel2.left && pts[i + 2].x < channel2.right) d = pts[i + 2].x - pt.x;else d = (channel2.right + channel2.left) / 2 - pt.x;\n\t\t\t\t\t\t\t// check if we need this pt.\n\t\t\t\t\t\t\tif (side == 1 && pt.y <= pts[i].y || side == 3 && pt.y >= pts[i].y) pt = null;else if (i > 0) {\n\t\t\t\t\t\t\t\t// see if we can push the line out to where we started.\n\t\t\t\t\t\t\t\tif (!_hasIntersection([new _Point2.default(pts[i].x, pts[i].y), new _Point2.default(pts[i].x + d, pts[i].y), new _Point2.default(pt.x + d, pt.y)], boxes)) pt = null;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 4:\n\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\t\t\t\t\t// max points.\n\t\t\t\t\tif (i > 20) return;\n\t\t\t\t\tif (pt && (pt.x != pts[i].x || pt.y != pts[i].y)) {\n\t\t\t\t\t\tpts.splice(i + 1, 0, pt);\n\t\t\t\t\t\t_moveSegment(pts, i + 1, d, startPadding, endPadding);\n\t\t\t\t\t\ti++;\n\t\t\t\t\t} else _moveSegment(pts, i, d, startPadding, endPadding);\n\t\t\t\t}\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"_hasIntersection\",\n\t\t\tvalue: function _hasIntersection(pts, boxes) {\n\t\t\t\tfor (var i = 0; i < pts.length - 1; i++) {\n\t\t\t\t\tfor (var j = 0; j < boxes.length; j++) {\n\t\t\t\t\t\tif (boxes[j].detectIntersection(pts[i], pts[i + 1]) >= 0) return true;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"_getFirstIntersection\",\n\t\t\tvalue: function _getFirstIntersection(pts, i, boxes, startBox, endBox) {\n\t\t\t\tvar box,\n\t\t\t\t    side,\n\t\t\t\t    savedIndex = null,\n\t\t\t\t    savedSide = null;\n\t\t\t\tfor (var j = 0; j < boxes.length; j++) {\n\t\t\t\t\tif (i == 0 && j == startBox || i == pts.length - 2 && j == endBox) continue;\n\t\t\t\t\tbox = boxes[j];\n\t\t\t\t\tside = box.detectIntersection(pts[i], pts[i + 1]);\n\t\t\t\t\tif (side >= 0) {\n\t\t\t\t\t\tif (savedIndex == null) {\n\t\t\t\t\t\t\tsavedIndex = j;\n\t\t\t\t\t\t\tsavedSide = side;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tif (boxes[savedIndex].distance(pts[i]) > box.distance(pts[i])) {\n\t\t\t\t\t\t\t\tsavedIndex = j;\n\t\t\t\t\t\t\t\tsavedSide = side;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (savedIndex != null) return [savedIndex, savedSide];\n\t\t\t\treturn null;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"_getRouteTendency\",\n\t\t\tvalue: function _getRouteTendency(pts, i, breakPt, box, side) {\n\t\t\t\tvar dir;\n\t\t\t\tvar p;\n\t\t\t\tswitch (side) {\n\t\t\t\t\tcase 0:\n\t\t\t\t\tcase 2:\n\t\t\t\t\t\tp = \"y\";\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 1:\n\t\t\t\t\tcase 3:\n\t\t\t\t\t\tp = \"x\";\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\t//first try the breakpt.\n\t\t\t\tdir = _getRouteDirection(breakPt, pts[pts.length - 1])[p];\n\t\t\t\tif (dir == 0) {\n\t\t\t\t\tdir = -_getRouteDirection(pts[0], pts[pts.length - 1])[p];\n\t\t\t\t\tif (dir == 0) {\n\t\t\t\t\t\tif (breakPt[p] < box.getCenter()[p]) dir = -1;else dir = 1;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn dir;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"_getRouteDirection\",\n\t\t\tvalue: function _getRouteDirection(pt1, pt2) {\n\t\t\t\tif (pt1.x == pt2.x) {\n\t\t\t\t\tif (pt1.y < pt2.y) return _Point2.default.S;\n\t\t\t\t\treturn _Point2.default.N;\n\t\t\t\t} else if (pt1.y == pt2.y) {\n\t\t\t\t\tif (pt1.x < pt2.x) return _Point2.default.E;\n\t\t\t\t\treturn _Point2.default.W;\n\t\t\t\t} else if (pt1.x < pt2.x) {\n\t\t\t\t\tif (pt1.y < pt2.y) return _Point2.default.SE;\n\t\t\t\t\treturn _Point2.default.NE;\n\t\t\t\t} else {\n\t\t\t\t\tif (pt1.y < pt2.y) return _Point2.default.SW;\n\t\t\t\t\treturn _Point2.default.NW;\n\t\t\t\t}\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"_getChannel\",\n\t\t\tvalue: function _getChannel(container, index, boxes, side) {\n\t\t\t\tvar maxChannelWidth = this.maxChannelWidth;\n\t\t\t\tvar box1 = boxes[index],\n\t\t\t\t    box2;\n\t\t\t\tvar pt, i;\n\t\t\t\tvar channel = {},\n\t\t\t\t    l,\n\t\t\t\t    t,\n\t\t\t\t    b,\n\t\t\t\t    r;\n\t\t\t\tswitch (side) {\n\t\t\t\t\tcase 0:\n\t\t\t\t\t\tpt = box1.getLeft();\n\t\t\t\t\t\tchannel.right = pt.x;\n\t\t\t\t\t\tchannel.horizontal = false;\n\t\t\t\t\t\tfor (i = 0; i < boxes.length; i++) {\n\t\t\t\t\t\t\tif (i == index) continue;\n\t\t\t\t\t\t\tr = boxes[i].getRight().x;\n\t\t\t\t\t\t\tif (r >= pt.x) continue;\n\t\t\t\t\t\t\tif (!channel.left || channel.left < r) channel.left = r;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (!channel.left) {\n\t\t\t\t\t\t\tchannel.left = container.getLeft().x;\n\t\t\t\t\t\t\tif (channel.right - channel.left > maxChannelWidth) channel.left = channel.right - maxChannelWidth;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tfor (i = 0; i < boxes.length; i++) {\n\t\t\t\t\t\t\tif (i == index) continue;\n\t\t\t\t\t\t\tbox2 = boxes[i];\n\t\t\t\t\t\t\tb = box2.getBottom().y;\n\t\t\t\t\t\t\tt = box2.getTop().y;\n\t\t\t\t\t\t\tif (b < pt.y && box2.getRight() > channel.left && box2.getLeft() < channel.right) {\n\t\t\t\t\t\t\t\tif (!channel.top || channel.top < b) channel.top = b;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (t > pt.y && box2.getRight() > channel.left && box2.getLeft() < channel.right) {\n\t\t\t\t\t\t\t\tif (!channel.bottom || channel.bottom > t) channel.bottom = t;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (!channel.top) channel.top = container.getTop().y;\n\t\t\t\t\t\tif (!channel.bottom) channel.bottom = container.getBottom().y;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 1:\n\t\t\t\t\t\tpt = box1.getTop();\n\t\t\t\t\t\tchannel.horizontal = true;\n\t\t\t\t\t\tchannel.bottom = pt.y;\n\t\t\t\t\t\tfor (i = 0; i < boxes.length; i++) {\n\t\t\t\t\t\t\tif (i == index) continue;\n\t\t\t\t\t\t\tb = boxes[i].getBottom().y;\n\t\t\t\t\t\t\tif (b >= pt.y) continue;\n\t\t\t\t\t\t\tif (!channel.top || channel.top < b) channel.top = b;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (!channel.top) {\n\t\t\t\t\t\t\tchannel.top = container.getTop().y;\n\t\t\t\t\t\t\tif (channel.bottom - channel.top > maxChannelWidth) channel.top = channel.bottom - maxChannelWidth;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tfor (i = 0; i < boxes.length; i++) {\n\t\t\t\t\t\t\tif (i == index) continue;\n\t\t\t\t\t\t\tbox2 = boxes[i];\n\t\t\t\t\t\t\tl = box2.getLeft().x;\n\t\t\t\t\t\t\tr = box2.getRight().x;\n\t\t\t\t\t\t\tif (r < pt.x && box2.getBottom() > channel.top && box2.getTop() < channel.bottom) {\n\t\t\t\t\t\t\t\tif (!channel.left || channel.left < r) channel.left = r;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (l > pt.x && box2.getBottom() > channel.top && box2.getTop() < channel.bottom) {\n\t\t\t\t\t\t\t\tif (!channel.right || channel.right > l) channel.right = l;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (!channel.left) channel.left = container.getLeft().x;\n\t\t\t\t\t\tif (!channel.right) channel.right = container.getRight().x;\n\t\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 2:\n\t\t\t\t\t\tpt = box1.getRight();\n\t\t\t\t\t\tchannel.horizontal = false;\n\t\t\t\t\t\tchannel.left = pt.x;\n\t\t\t\t\t\tfor (i = 0; i < boxes.length; i++) {\n\t\t\t\t\t\t\tif (i == index) continue;\n\t\t\t\t\t\t\tl = boxes[i].getLeft().x;\n\t\t\t\t\t\t\tif (l <= pt.x) continue;\n\t\t\t\t\t\t\tif (!channel.right || channel.right > l) channel.right = l;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (!channel.right) {\n\t\t\t\t\t\t\tchannel.right = container.getRight().x;\n\t\t\t\t\t\t\tif (channel.right - channel.left > maxChannelWidth) channel.right = channel.left + maxChannelWidth;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tfor (i = 0; i < boxes.length; i++) {\n\t\t\t\t\t\t\tif (i == index) continue;\n\t\t\t\t\t\t\tbox2 = boxes[i];\n\t\t\t\t\t\t\tb = box2.getBottom().y;\n\t\t\t\t\t\t\tt = box2.getTop().y;\n\t\t\t\t\t\t\tif (b < pt.y && box2.getRight() > channel.left && box2.getLeft() < channel.right) {\n\t\t\t\t\t\t\t\tif (!channel.top || channel.top < b) channel.top = b;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (t > pt.y && box2.getRight() > channel.left && box2.getLeft() < channel.right) {\n\t\t\t\t\t\t\t\tif (!channel.bottom || channel.bottom > t) channel.bottom = t;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (!channel.top) channel.top = container.getTop().y;\n\t\t\t\t\t\tif (!channel.bottom) channel.bottom = container.getBottom().y;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 3:\n\t\t\t\t\t\tpt = box1.getBottom();\n\t\t\t\t\t\tchannel.horizontal = true;\n\t\t\t\t\t\tchannel.top = pt.y;\n\t\t\t\t\t\tfor (i = 0; i < boxes.length; i++) {\n\t\t\t\t\t\t\tif (i == index) continue;\n\t\t\t\t\t\t\tbox2 = boxes[i];\n\t\t\t\t\t\t\tif (box2.getTop().y <= pt.y) continue;\n\t\t\t\t\t\t\tif (!channel.bottom || channel.bottom > box2.getTop().y) channel.bottom = box2.getTop().y;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (!channel.bottom) {\n\t\t\t\t\t\t\tchannel.bottom = container.getBottom().y;\n\t\t\t\t\t\t\tif (channel.bottom - channel.top > maxChannelWidth) channel.bottom = channel.top + maxChannelWidth;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tfor (i = 0; i < boxes.length; i++) {\n\t\t\t\t\t\t\tif (i == index) continue;\n\t\t\t\t\t\t\tbox2 = boxes[i];\n\t\t\t\t\t\t\tl = box2.getLeft().x;\n\t\t\t\t\t\t\tr = box2.getRight().x;\n\t\t\t\t\t\t\tif (r < pt.x && box2.getBottom() > channel.top && box2.getTop() < channel.bottom) {\n\t\t\t\t\t\t\t\tif (!channel.left || channel.left < r) channel.left = r;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (l > pt.x && box2.getBottom() > channel.top && box2.getTop() < channel.bottom) {\n\t\t\t\t\t\t\t\tif (!channel.right || channel.right > l) channel.right = l;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (!channel.left) channel.left = container.getLeft().x;\n\t\t\t\t\t\tif (!channel.right) channel.right = container.getRight().x;\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\treturn channel;\n\t\t\t}\n\t\n\t\t\t/**\r\n\t   * Move a line segment by a specified distance.\r\n\t   *\r\n\t   * @param pts the list of points.\r\n\t   * @param i the index of the segment.\r\n\t   * @param d the distance to move.\r\n\t   * @param startPadding\r\n\t   * @param endPadding\r\n\t   */\n\t\n\t\t}, {\n\t\t\tkey: \"_moveSegment\",\n\t\t\tvalue: function (_moveSegment2) {\n\t\t\t\tfunction _moveSegment(_x7, _x8, _x9, _x10, _x11) {\n\t\t\t\t\treturn _moveSegment2.apply(this, arguments);\n\t\t\t\t}\n\t\n\t\t\t\t_moveSegment.toString = function () {\n\t\t\t\t\treturn _moveSegment2.toString();\n\t\t\t\t};\n\t\n\t\t\t\treturn _moveSegment;\n\t\t\t}(function (pts, i, d, startPadding, endPadding) {\n\t\t\t\t// first check if we need to add new line segments.\n\t\t\t\tvar dir, l, pt;\n\t\t\t\tif (i == 0) {\n\t\t\t\t\t// we need to break off the segment, since we can't change the starting point.\n\t\t\t\t\tdir = pts[0].getDirection(pts[1]);\n\t\t\t\t\tif (!startPadding) startPadding = this.MIN_BUFFER;\n\t\t\t\t\tl = Math.min(startPadding, pts[0].distance(pts[1]) / 2);\n\t\t\t\t\tpt = pts[0].getTranslated(dir.scale(l));\n\t\t\t\t\tpts.splice(1, 0, pt);\n\t\t\t\t\t_moveSegment(pts, i + 1, d);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tif (i == pts.length - 2) {\n\t\t\t\t\t// we need to break off the segment, since we can't change the end point.\n\t\t\t\t\tdir = pts[pts.length - 1].getDirection(pts[pts.length - 2]);\n\t\t\t\t\tif (!endPadding) endPadding = this.MIN_BUFFER;\n\t\t\t\t\tl = Math.min(endPadding, pts[pts.length - 1].distance(pts[pts.length - 2]) / 2);\n\t\t\t\t\tpt = pts[pts.length - 1].getTranslated(dir.scale(l));\n\t\t\t\t\tpts.splice(pts.length - 1, 0, pt);\n\t\t\t\t\t_moveSegment(pts, i, d);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\n\t\t\t\tif (pts[i].y == pts[i + 1].y) {\n\t\t\t\t\tif (i > 0 && pts[i - 1].y == pts[i].y) {\n\t\t\t\t\t\tpts.splice(i + 1, 0, pts[i].clone());\n\t\t\t\t\t\ti++;\n\t\t\t\t\t}\n\t\t\t\t\tif (i < pts.length - 2 && pts[i + 1].y == pts[i + 2].y) pts.splice(i + 1, 0, pts[i + 1].clone());\n\t\t\t\t\tpts[i].y += d;\n\t\t\t\t\tpts[i + 1].y += d;\n\t\t\t\t} else {\n\t\t\t\t\tif (i > 0 && pts[i - 1].x == pts[i].x) {\n\t\t\t\t\t\tpts.splice(i + 1, 0, pts[i].clone());\n\t\t\t\t\t\ti++;\n\t\t\t\t\t}\n\t\t\t\t\tif (i < pts.length - 2 && pts[i + 1].x == pts[i + 2].x) pts.splice(i + 1, 0, pts[i + 1].clone());\n\t\t\t\t\tpts[i].x += d;\n\t\t\t\t\tpts[i + 1].x += d;\n\t\t\t\t}\n\t\t\t})\n\t\n\t\t\t/**\r\n\t   * This method will merge the redundant segments.\r\n\t   */\n\t\n\t\t}, {\n\t\t\tkey: \"_mergeSegments\",\n\t\t\tvalue: function _mergeSegments(pts) {\n\t\t\t\tvar h1 = pts[pts.length - 1].y == pts[pts.length - 2].y;\n\t\t\t\tvar h2;\n\t\t\t\tfor (var i = pts.length - 2; i >= 1; i--) {\n\t\t\t\t\th2 = pts[i].y == pts[i - 1].y;\n\t\t\t\t\tif (h2 == h1 || pts[i].equals(pts[i - 1])) pts.splice(i, 1);else h1 = !h1;\n\t\t\t\t}\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"points\",\n\t\t\tget: function get() {\n\t\t\t\t//let pos = Manhattan.routeInternal(this.start, this.end, this.startNormal, this.endNormal, this.MIN_BUFFER);\n\t\t\t\t//pos = Manhattan.processPositions(this.start, this.end, pos, this.startNormal.x!=0);\n\t\t\t\tvar pos = Manhattan.findPositions(this.start, this.end, this.startNormal, this.endNormal, this.MIN_BUFFER);\n\t\t\t\tif (this.autoRoute) {\n\t\t\t\t\tthis._mergeSegments(pos);\n\t\t\t\t\tvar boxes = [],\n\t\t\t\t\t    node,\n\t\t\t\t\t    startBox,\n\t\t\t\t\t    endBox;\n\t\t\t\t\tvar container = edge.source.getCommonAncestor(edge.target);\n\t\t\t\t\tvar childNodes = container.getDescendants();\n\t\t\t\t\tvar index = 0;\n\t\t\t\t\tfor (var i = 0; i < childNodes.length; i++) {\n\t\t\t\t\t\tnode = childNodes[i];\n\t\t\t\t\t\t// Do not include source or target ancestors in routing.\n\t\t\t\t\t\tif (node.excludeFromRouting(edge) || node.isAncestor(edge.source) || node.isAncestor(edge.target)) continue;\n\t\t\t\t\t\tif (node == edge.source) startBox = index;\n\t\t\t\t\t\tif (node == edge.target) endBox = index;\n\t\t\t\t\t\tboxes.push(node.getBounds(document));\n\t\t\t\t\t\tindex++;\n\t\t\t\t\t}\n\t\t\t\t\tif (boxes.length > 1) this.autoRoute(pos, container.getBounds(document), boxes, startBox, endBox);\n\t\t\t\t}\n\t\t\t\tthis._mergeSegments(pos);\n\t\t\t\treturn pos;\n\t\t\t}\n\t\n\t\t\t//New function for finding route\n\t\n\t\t}], [{\n\t\t\tkey: \"findPositions\",\n\t\t\tvalue: function findPositions(start, end, startNormal, endNormal, buffer) {\n\t\t\t\tvar startBuffer = new _Point2.default(start.x + startNormal.x * buffer, start.y + startNormal.y * buffer);\n\t\t\t\tvar endBuffer = new _Point2.default(end.x + endNormal.x * buffer, end.y + endNormal.y * buffer);\n\t\t\t\tvar startBufferNormal, endBufferNormal;\n\t\t\t\tvar pts;\n\t\t\t\tif (startNormal.x != 0) {\n\t\t\t\t\tif ((endBuffer.x - startBuffer.x) / startNormal.x > 0) {\n\t\t\t\t\t\tstartBufferNormal = startNormal;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tstartBufferNormal = new _Point2.default(0, endBuffer.y >= startBuffer.y ? 1 : -1);\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tif ((endBuffer.y - startBuffer.y) / startNormal.y > 0) {\n\t\t\t\t\t\tstartBufferNormal = startNormal;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tstartBufferNormal = new _Point2.default(endBuffer.x >= startBuffer.x ? 1 : -1, 0);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (endNormal.x != 0) {\n\t\t\t\t\tif ((startBuffer.x - endBuffer.x) / endNormal.x > 0) {\n\t\t\t\t\t\tendBufferNormal = endNormal;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tendBufferNormal = new _Point2.default(0, startBuffer.y >= endBuffer.y ? 1 : -1);\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tif ((startBuffer.y - endBuffer.y) / endNormal.y > 0) {\n\t\t\t\t\t\tendBufferNormal = endNormal;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tendBufferNormal = new _Point2.default(startBuffer.x >= endBuffer.x ? 1 : -1, 0);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\n\t\t\t\tif (startBufferNormal.dotProduct(endBufferNormal) == 0) {\n\t\t\t\t\tvar middle = startBufferNormal.x == 0 ? new _Point2.default(startBuffer.x, endBuffer.y) : new _Point2.default(endBuffer.x, startBuffer.y);\n\t\t\t\t\tpts = [start, startBuffer, middle, endBuffer, end];\n\t\t\t\t} else if (startBufferNormal.dotProduct(endBufferNormal) < 0) {\n\t\t\t\t\tif (startBufferNormal.x == 0) {\n\t\t\t\t\t\tpts = [start, startBuffer, new _Point2.default(startBuffer.x, (start.y + end.y) / 2), new _Point2.default(endBuffer.x, (start.y + end.y) / 2), endBuffer, end];\n\t\t\t\t\t} else {\n\t\t\t\t\t\tpts = [start, startBuffer, new _Point2.default((start.x + end.x) / 2, startBuffer.y), new _Point2.default((start.x + end.x) / 2, endBuffer.y), endBuffer, end];\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tpts = [start, startBuffer, new _Point2.default(startBuffer.x + startBufferNormal.x * buffer, startBuffer.y + startBufferNormal.y * buffer), new _Point2.default(endBuffer.x + endBufferNormal.x * buffer, endBuffer.y + endBufferNormal.y * buffer), endBuffer, end];\n\t\t\t\t}\n\t\n\t\t\t\tvar prunePts = [];\n\t\t\t\tprunePts[0] = pts[0];\n\t\t\t\tfor (var i = 1; i < pts.length - 1; i++) {\n\t\t\t\t\tif (pts[i].x == pts[i - 1].x && pts[i].x == pts[i + 1].x || pts[i].y == pts[i - 1].y && pts[i].y == pts[i + 1].y) {\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\t\t\t\t\tprunePts.push(pts[i]);\n\t\t\t\t}\n\t\t\t\tprunePts.push(pts[pts.length - 1]);\n\t\t\t\treturn prunePts;\n\t\t\t}\n\t\n\t\t\t/**\r\n\t   * Make a route based on the start, end and startNormal and endNormal\r\n\t   * None of the parameters can be null\r\n\t   * TODO: This method could use some improvement...\r\n\t   */\n\t\n\t\t}, {\n\t\t\tkey: \"routeInternal\",\n\t\t\tvalue: function routeInternal(start, end, startNormal, endNormal, buffer) {\n\t\t\t\tvar direction = start.getDirection(end);\n\t\t\t\tvar average = start.getMidPoint(end);\n\t\t\t\tvar pos = [];\n\t\t\t\tvar startPositive = new _Point2.default(startNormal.x * startNormal.x, startNormal.y * startNormal.y);\n\t\t\t\tvar endPositive = new _Point2.default(endNormal.x * endNormal.x, endNormal.y * endNormal.y);\n\t\t\t\tvar horizontal = startNormal.x != 0;\n\t\t\t\tpos[0] = horizontal ? start.y : start.x;\n\t\n\t\t\t\thorizontal = !horizontal;\n\t\t\t\tvar i;\n\t\t\t\tif (startNormal.dotProduct(endNormal) == 0) {\n\t\t\t\t\tif (startNormal.dotProduct(direction) >= 0 && endNormal.dotProduct(direction) <= 0) {\n\t\t\t\t\t\t// 0\n\t\t\t\t\t} else {\n\t\t\t\t\t\t// 2\n\t\t\t\t\t\tif (startNormal.dotProduct(direction) < 0) i = startPositive.dotProduct(start.getTranslated(startNormal.getScaled(buffer)));else i = horizontal ? average.y : average.x;\n\t\n\t\t\t\t\t\tpos.push(i);\n\t\t\t\t\t\thorizontal = !horizontal;\n\t\n\t\t\t\t\t\tif (endNormal.dotProduct(direction) > 0) i = endPositive.dotProduct(end.getTranslated(endNormal.getScaled(buffer)));else i = horizontal ? average.y : average.x;\n\t\n\t\t\t\t\t\tpos.push(i);\n\t\t\t\t\t\thorizontal = !horizontal;\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tif (startNormal.dotProduct(endNormal) > 0) {\n\t\t\t\t\t\t//1\n\t\t\t\t\t\tif (startNormal.dotProduct(direction) >= 0) i = startPositive.dotProduct(start.getTranslated(startNormal.getScaled(buffer)));else i = endPositive.dotProduct(end.getTranslated(endNormal.getScaled(buffer)));\n\t\t\t\t\t\tpos.push(i);\n\t\t\t\t\t\thorizontal = !horizontal;\n\t\t\t\t\t} else {\n\t\t\t\t\t\t//3 or 1\n\t\t\t\t\t\tif (startNormal.dotProduct(direction) < 0) {\n\t\t\t\t\t\t\ti = startPositive.dotProduct(start.getTranslated(startNormal.getScaled(buffer)));\n\t\t\t\t\t\t\tpos.push(i);\n\t\t\t\t\t\t\thorizontal = !horizontal;\n\t\t\t\t\t\t}\n\t\n\t\t\t\t\t\ti = horizontal ? average.y : average.x;\n\t\t\t\t\t\tpos.push(i);\n\t\t\t\t\t\thorizontal = !horizontal;\n\t\n\t\t\t\t\t\tif (startNormal.dotProduct(direction) < 0) {\n\t\t\t\t\t\t\ti = endPositive.dotProduct(end.getTranslated(endNormal.getScaled(buffer)));\n\t\t\t\t\t\t\tpos.push(i);\n\t\t\t\t\t\t\thorizontal = !horizontal;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tpos.push(horizontal ? end.y : end.x);\n\t\n\t\t\t\treturn pos;\n\t\t\t}\n\t\n\t\t\t// Process the positions.\n\t\n\t\t}, {\n\t\t\tkey: \"processPositions\",\n\t\t\tvalue: function processPositions(start, end, positions, horizontal) {\n\t\t\t\tvar pos = [];\n\t\t\t\tpos[0] = horizontal ? start.x : start.y;\n\t\t\t\tvar i;\n\t\t\t\tfor (i = 0; i < positions.length; i++) {\n\t\t\t\t\tpos[i + 1] = positions[i];\n\t\t\t\t}\n\t\t\t\tpos.push(horizontal == (positions.length % 2 == 1) ? end.x : end.y);\n\t\n\t\t\t\tvar pts = [];\n\t\t\t\tpts[0] = start;\n\t\t\t\tvar p;\n\t\t\t\tvar current, prev;\n\t\t\t\tfor (i = 2; i < pos.length - 1; i++) {\n\t\t\t\t\thorizontal = !horizontal;\n\t\t\t\t\tprev = pos[i - 1];\n\t\t\t\t\tcurrent = pos[i];\n\t\t\t\t\tp = horizontal ? new _Point2.default(prev, current) : new _Point2.default(current, prev);\n\t\t\t\t\tpts.push(p);\n\t\t\t\t}\n\t\t\t\tpts.push(end);\n\t\t\t\treturn pts;\n\t\t\t}\n\t\t}]);\n\t\n\t\treturn Manhattan;\n\t}(Link);\n\t\n\tlinkTypes['direct'] = DirectLink;\n\tlinkTypes['bezier'] = BezierLink;\n\tlinkTypes['entityRelations'] = EntityRelations;\n\tlinkTypes['manhattan'] = Manhattan;\n\t\n\texports.default = Link;\n\n/***/ },\n/* 12 */\n/***/ function(module, exports, __webpack_require__) {\n\n\tvar __WEBPACK_AMD_DEFINE_FACTORY__, __WEBPACK_AMD_DEFINE_RESULT__;/*!\n\t  * Bean - copyright (c) Jacob Thornton 2011-2012\n\t  * https://github.com/fat/bean\n\t  * MIT license\n\t  */\n\t(function (name, context, definition) {\n\t  if (typeof module != 'undefined' && module.exports) module.exports = definition()\n\t  else if (true) !(__WEBPACK_AMD_DEFINE_FACTORY__ = (definition), __WEBPACK_AMD_DEFINE_RESULT__ = (typeof __WEBPACK_AMD_DEFINE_FACTORY__ === 'function' ? (__WEBPACK_AMD_DEFINE_FACTORY__.call(exports, __webpack_require__, exports, module)) : __WEBPACK_AMD_DEFINE_FACTORY__), __WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__))\n\t  else context[name] = definition()\n\t})('bean', this, function (name, context) {\n\t  name    = name    || 'bean'\n\t  context = context || this\n\t\n\t  var win            = window\n\t    , old            = context[name]\n\t    , namespaceRegex = /[^\\.]*(?=\\..*)\\.|.*/\n\t    , nameRegex      = /\\..*/\n\t    , addEvent       = 'addEventListener'\n\t    , removeEvent    = 'removeEventListener'\n\t    , doc            = document || {}\n\t    , root           = doc.documentElement || {}\n\t    , W3C_MODEL      = root[addEvent]\n\t    , eventSupport   = W3C_MODEL ? addEvent : 'attachEvent'\n\t    , ONE            = {} // singleton for quick matching making add() do one()\n\t\n\t    , slice          = Array.prototype.slice\n\t    , str2arr        = function (s, d) { return s.split(d || ' ') }\n\t    , isString       = function (o) { return typeof o == 'string' }\n\t    , isFunction     = function (o) { return typeof o == 'function' }\n\t\n\t      // events that we consider to be 'native', anything not in this list will\n\t      // be treated as a custom event\n\t    , standardNativeEvents =\n\t        'click dblclick mouseup mousedown contextmenu '                  + // mouse buttons\n\t        'mousewheel mousemultiwheel DOMMouseScroll '                     + // mouse wheel\n\t        'mouseover mouseout mousemove selectstart selectend '            + // mouse movement\n\t        'keydown keypress keyup '                                        + // keyboard\n\t        'orientationchange '                                             + // mobile\n\t        'focus blur change reset select submit '                         + // form elements\n\t        'load unload beforeunload resize move DOMContentLoaded '         + // window\n\t        'readystatechange message '                                      + // window\n\t        'error abort scroll '                                              // misc\n\t      // element.fireEvent('onXYZ'... is not forgiving if we try to fire an event\n\t      // that doesn't actually exist, so make sure we only do these on newer browsers\n\t    , w3cNativeEvents =\n\t        'show '                                                          + // mouse buttons\n\t        'input invalid '                                                 + // form elements\n\t        'touchstart touchmove touchend touchcancel '                     + // touch\n\t        'gesturestart gesturechange gestureend '                         + // gesture\n\t        'textinput '                                                     + // TextEvent\n\t        'readystatechange pageshow pagehide popstate '                   + // window\n\t        'hashchange offline online '                                     + // window\n\t        'afterprint beforeprint '                                        + // printing\n\t        'dragstart dragenter dragover dragleave drag drop dragend '      + // dnd\n\t        'loadstart progress suspend emptied stalled loadmetadata '       + // media\n\t        'loadeddata canplay canplaythrough playing waiting seeking '     + // media\n\t        'seeked ended durationchange timeupdate play pause ratechange '  + // media\n\t        'volumechange cuechange '                                        + // media\n\t        'checking noupdate downloading cached updateready obsolete '       // appcache\n\t\n\t      // convert to a hash for quick lookups\n\t    , nativeEvents = (function (hash, events, i) {\n\t        for (i = 0; i < events.length; i++) events[i] && (hash[events[i]] = 1)\n\t        return hash\n\t      }({}, str2arr(standardNativeEvents + (W3C_MODEL ? w3cNativeEvents : ''))))\n\t\n\t      // custom events are events that we *fake*, they are not provided natively but\n\t      // we can use native events to generate them\n\t    , customEvents = (function () {\n\t        var isAncestor = 'compareDocumentPosition' in root\n\t              ? function (element, container) {\n\t                  return container.compareDocumentPosition && (container.compareDocumentPosition(element) & 16) === 16\n\t                }\n\t              : 'contains' in root\n\t                ? function (element, container) {\n\t                    container = container.nodeType === 9 || container === window ? root : container\n\t                    return container !== element && container.contains(element)\n\t                  }\n\t                : function (element, container) {\n\t                    while (element = element.parentNode) if (element === container) return 1\n\t                    return 0\n\t                  }\n\t          , check = function (event) {\n\t              var related = event.relatedTarget\n\t              return !related\n\t                ? related == null\n\t                : (related !== this && related.prefix !== 'xul' && !/document/.test(this.toString())\n\t                    && !isAncestor(related, this))\n\t            }\n\t\n\t        return {\n\t            mouseenter: { base: 'mouseover', condition: check }\n\t          , mouseleave: { base: 'mouseout', condition: check }\n\t          , mousewheel: { base: /Firefox/.test(navigator.userAgent) ? 'DOMMouseScroll' : 'mousewheel' }\n\t        }\n\t      }())\n\t\n\t      // we provide a consistent Event object across browsers by taking the actual DOM\n\t      // event object and generating a new one from its properties.\n\t    , Event = (function () {\n\t            // a whitelist of properties (for different event types) tells us what to check for and copy\n\t        var commonProps  = str2arr('altKey attrChange attrName bubbles cancelable ctrlKey currentTarget ' +\n\t              'detail eventPhase getModifierState isTrusted metaKey relatedNode relatedTarget shiftKey '  +\n\t              'srcElement target timeStamp type view which propertyName')\n\t          , mouseProps   = commonProps.concat(str2arr('button buttons clientX clientY dataTransfer '      +\n\t              'fromElement offsetX offsetY pageX pageY screenX screenY toElement'))\n\t          , mouseWheelProps = mouseProps.concat(str2arr('wheelDelta wheelDeltaX wheelDeltaY wheelDeltaZ ' +\n\t              'axis')) // 'axis' is FF specific\n\t          , keyProps     = commonProps.concat(str2arr('char charCode key keyCode keyIdentifier '          +\n\t              'keyLocation location'))\n\t          , textProps    = commonProps.concat(str2arr('data'))\n\t          , touchProps   = commonProps.concat(str2arr('touches targetTouches changedTouches scale rotation'))\n\t          , messageProps = commonProps.concat(str2arr('data origin source'))\n\t          , stateProps   = commonProps.concat(str2arr('state'))\n\t          , overOutRegex = /over|out/\n\t            // some event types need special handling and some need special properties, do that all here\n\t          , typeFixers   = [\n\t                { // key events\n\t                    reg: /key/i\n\t                  , fix: function (event, newEvent) {\n\t                      newEvent.keyCode = event.keyCode || event.which\n\t                      return keyProps\n\t                    }\n\t                }\n\t              , { // mouse events\n\t                    reg: /click|mouse(?!(.*wheel|scroll))|menu|drag|drop/i\n\t                  , fix: function (event, newEvent, type) {\n\t                      newEvent.rightClick = event.which === 3 || event.button === 2\n\t                      newEvent.pos = { x: 0, y: 0 }\n\t                      if (event.pageX || event.pageY) {\n\t                        newEvent.clientX = event.pageX\n\t                        newEvent.clientY = event.pageY\n\t                      } else if (event.clientX || event.clientY) {\n\t                        newEvent.clientX = event.clientX + doc.body.scrollLeft + root.scrollLeft\n\t                        newEvent.clientY = event.clientY + doc.body.scrollTop + root.scrollTop\n\t                      }\n\t                      if (overOutRegex.test(type)) {\n\t                        newEvent.relatedTarget = event.relatedTarget\n\t                          || event[(type == 'mouseover' ? 'from' : 'to') + 'Element']\n\t                      }\n\t                      return mouseProps\n\t                    }\n\t                }\n\t              , { // mouse wheel events\n\t                    reg: /mouse.*(wheel|scroll)/i\n\t                  , fix: function () { return mouseWheelProps }\n\t                }\n\t              , { // TextEvent\n\t                    reg: /^text/i\n\t                  , fix: function () { return textProps }\n\t                }\n\t              , { // touch and gesture events\n\t                    reg: /^touch|^gesture/i\n\t                  , fix: function () { return touchProps }\n\t                }\n\t              , { // message events\n\t                    reg: /^message$/i\n\t                  , fix: function () { return messageProps }\n\t                }\n\t              , { // popstate events\n\t                    reg: /^popstate$/i\n\t                  , fix: function () { return stateProps }\n\t                }\n\t              , { // everything else\n\t                    reg: /.*/\n\t                  , fix: function () { return commonProps }\n\t                }\n\t            ]\n\t          , typeFixerMap = {} // used to map event types to fixer functions (above), a basic cache mechanism\n\t\n\t          , Event = function (event, element, isNative) {\n\t              if (!arguments.length) return\n\t              event = event || ((element.ownerDocument || element.document || element).parentWindow || win).event\n\t              this.originalEvent = event\n\t              this.isNative       = isNative\n\t              this.isBean         = true\n\t\n\t              if (!event) return\n\t\n\t              var type   = event.type\n\t                , target = event.target || event.srcElement\n\t                , i, l, p, props, fixer\n\t\n\t              this.target = target && target.nodeType === 3 ? target.parentNode : target\n\t\n\t              if (isNative) { // we only need basic augmentation on custom events, the rest expensive & pointless\n\t                fixer = typeFixerMap[type]\n\t                if (!fixer) { // haven't encountered this event type before, map a fixer function for it\n\t                  for (i = 0, l = typeFixers.length; i < l; i++) {\n\t                    if (typeFixers[i].reg.test(type)) { // guaranteed to match at least one, last is .*\n\t                      typeFixerMap[type] = fixer = typeFixers[i].fix\n\t                      break\n\t                    }\n\t                  }\n\t                }\n\t\n\t                props = fixer(event, this, type)\n\t                for (i = props.length; i--;) {\n\t                  if (!((p = props[i]) in this) && p in event) this[p] = event[p]\n\t                }\n\t              }\n\t            }\n\t\n\t        // preventDefault() and stopPropagation() are a consistent interface to those functions\n\t        // on the DOM, stop() is an alias for both of them together\n\t        Event.prototype.preventDefault = function () {\n\t          if (this.originalEvent.preventDefault) this.originalEvent.preventDefault()\n\t          else this.originalEvent.returnValue = false\n\t        }\n\t        Event.prototype.stopPropagation = function () {\n\t          if (this.originalEvent.stopPropagation) this.originalEvent.stopPropagation()\n\t          else this.originalEvent.cancelBubble = true\n\t        }\n\t        Event.prototype.stop = function () {\n\t          this.preventDefault()\n\t          this.stopPropagation()\n\t          this.stopped = true\n\t        }\n\t        // stopImmediatePropagation() has to be handled internally because we manage the event list for\n\t        // each element\n\t        // note that originalElement may be a Bean#Event object in some situations\n\t        Event.prototype.stopImmediatePropagation = function () {\n\t          if (this.originalEvent.stopImmediatePropagation) this.originalEvent.stopImmediatePropagation()\n\t          this.isImmediatePropagationStopped = function () { return true }\n\t        }\n\t        Event.prototype.isImmediatePropagationStopped = function () {\n\t          return this.originalEvent.isImmediatePropagationStopped && this.originalEvent.isImmediatePropagationStopped()\n\t        }\n\t        Event.prototype.clone = function (currentTarget) {\n\t          //TODO: this is ripe for optimisation, new events are *expensive*\n\t          // improving this will speed up delegated events\n\t          var ne = new Event(this, this.element, this.isNative)\n\t          ne.currentTarget = currentTarget\n\t          return ne\n\t        }\n\t\n\t        return Event\n\t      }())\n\t\n\t      // if we're in old IE we can't do onpropertychange on doc or win so we use doc.documentElement for both\n\t    , targetElement = function (element, isNative) {\n\t        return !W3C_MODEL && !isNative && (element === doc || element === win) ? root : element\n\t      }\n\t\n\t      /**\n\t        * Bean maintains an internal registry for event listeners. We don't touch elements, objects\n\t        * or functions to identify them, instead we store everything in the registry.\n\t        * Each event listener has a RegEntry object, we have one 'registry' for the whole instance.\n\t        */\n\t    , RegEntry = (function () {\n\t        // each handler is wrapped so we can handle delegation and custom events\n\t        var wrappedHandler = function (element, fn, condition, args) {\n\t            var call = function (event, eargs) {\n\t                  return fn.apply(element, args ? slice.call(eargs, event ? 0 : 1).concat(args) : eargs)\n\t                }\n\t              , findTarget = function (event, eventElement) {\n\t                  return fn.__beanDel ? fn.__beanDel.ft(event.target, element) : eventElement\n\t                }\n\t              , handler = condition\n\t                  ? function (event) {\n\t                      var target = findTarget(event, this) // deleated event\n\t                      if (condition.apply(target, arguments)) {\n\t                        if (event) event.currentTarget = target\n\t                        return call(event, arguments)\n\t                      }\n\t                    }\n\t                  : function (event) {\n\t                      if (fn.__beanDel) event = event.clone(findTarget(event)) // delegated event, fix the fix\n\t                      return call(event, arguments)\n\t                    }\n\t            handler.__beanDel = fn.__beanDel\n\t            return handler\n\t          }\n\t\n\t        , RegEntry = function (element, type, handler, original, namespaces, args, root) {\n\t            var customType     = customEvents[type]\n\t              , isNative\n\t\n\t            if (type == 'unload') {\n\t              // self clean-up\n\t              handler = once(removeListener, element, type, handler, original)\n\t            }\n\t\n\t            if (customType) {\n\t              if (customType.condition) {\n\t                handler = wrappedHandler(element, handler, customType.condition, args)\n\t              }\n\t              type = customType.base || type\n\t            }\n\t\n\t            this.isNative      = isNative = nativeEvents[type] && !!element[eventSupport]\n\t            this.customType    = !W3C_MODEL && !isNative && type\n\t            this.element       = element\n\t            this.type          = type\n\t            this.original      = original\n\t            this.namespaces    = namespaces\n\t            this.eventType     = W3C_MODEL || isNative ? type : 'propertychange'\n\t            this.target        = targetElement(element, isNative)\n\t            this[eventSupport] = !!this.target[eventSupport]\n\t            this.root          = root\n\t            this.handler       = wrappedHandler(element, handler, null, args)\n\t          }\n\t\n\t        // given a list of namespaces, is our entry in any of them?\n\t        RegEntry.prototype.inNamespaces = function (checkNamespaces) {\n\t          var i, j, c = 0\n\t          if (!checkNamespaces) return true\n\t          if (!this.namespaces) return false\n\t          for (i = checkNamespaces.length; i--;) {\n\t            for (j = this.namespaces.length; j--;) {\n\t              if (checkNamespaces[i] == this.namespaces[j]) c++\n\t            }\n\t          }\n\t          return checkNamespaces.length === c\n\t        }\n\t\n\t        // match by element, original fn (opt), handler fn (opt)\n\t        RegEntry.prototype.matches = function (checkElement, checkOriginal, checkHandler) {\n\t          return this.element === checkElement &&\n\t            (!checkOriginal || this.original === checkOriginal) &&\n\t            (!checkHandler || this.handler === checkHandler)\n\t        }\n\t\n\t        return RegEntry\n\t      }())\n\t\n\t    , registry = (function () {\n\t        // our map stores arrays by event type, just because it's better than storing\n\t        // everything in a single array.\n\t        // uses '$' as a prefix for the keys for safety and 'r' as a special prefix for\n\t        // rootListeners so we can look them up fast\n\t        var map = {}\n\t\n\t          // generic functional search of our registry for matching listeners,\n\t          // `fn` returns false to break out of the loop\n\t          , forAll = function (element, type, original, handler, root, fn) {\n\t              var pfx = root ? 'r' : '$'\n\t              if (!type || type == '*') {\n\t                // search the whole registry\n\t                for (var t in map) {\n\t                  if (t.charAt(0) == pfx) {\n\t                    forAll(element, t.substr(1), original, handler, root, fn)\n\t                  }\n\t                }\n\t              } else {\n\t                var i = 0, l, list = map[pfx + type], all = element == '*'\n\t                if (!list) return\n\t                for (l = list.length; i < l; i++) {\n\t                  if ((all || list[i].matches(element, original, handler)) && !fn(list[i], list, i, type)) return\n\t                }\n\t              }\n\t            }\n\t\n\t          , has = function (element, type, original, root) {\n\t              // we're not using forAll here simply because it's a bit slower and this\n\t              // needs to be fast\n\t              var i, list = map[(root ? 'r' : '$') + type]\n\t              if (list) {\n\t                for (i = list.length; i--;) {\n\t                  if (!list[i].root && list[i].matches(element, original, null)) return true\n\t                }\n\t              }\n\t              return false\n\t            }\n\t\n\t          , get = function (element, type, original, root) {\n\t              var entries = []\n\t              forAll(element, type, original, null, root, function (entry) {\n\t                return entries.push(entry)\n\t              })\n\t              return entries\n\t            }\n\t\n\t          , put = function (entry) {\n\t              var has = !entry.root && !this.has(entry.element, entry.type, null, false)\n\t                , key = (entry.root ? 'r' : '$') + entry.type\n\t              ;(map[key] || (map[key] = [])).push(entry)\n\t              return has\n\t            }\n\t\n\t          , del = function (entry) {\n\t              forAll(entry.element, entry.type, null, entry.handler, entry.root, function (entry, list, i) {\n\t                list.splice(i, 1)\n\t                entry.removed = true\n\t                if (list.length === 0) delete map[(entry.root ? 'r' : '$') + entry.type]\n\t                return false\n\t              })\n\t            }\n\t\n\t            // dump all entries, used for onunload\n\t          , entries = function () {\n\t              var t, entries = []\n\t              for (t in map) {\n\t                if (t.charAt(0) == '$') entries = entries.concat(map[t])\n\t              }\n\t              return entries\n\t            }\n\t\n\t        return { has: has, get: get, put: put, del: del, entries: entries }\n\t      }())\n\t\n\t      // we need a selector engine for delegated events, use querySelectorAll if it exists\n\t      // but for older browsers we need Qwery, Sizzle or similar\n\t    , selectorEngine\n\t    , setSelectorEngine = function (e) {\n\t        if (!arguments.length) {\n\t          selectorEngine = doc.querySelectorAll\n\t            ? function (s, r) {\n\t                return r.querySelectorAll(s)\n\t              }\n\t            : function () {\n\t                throw new Error('Bean: No selector engine installed') // eeek\n\t              }\n\t        } else {\n\t          selectorEngine = e\n\t        }\n\t      }\n\t\n\t      // we attach this listener to each DOM event that we need to listen to, only once\n\t      // per event type per DOM element\n\t    , rootListener = function (event, type) {\n\t        if (!W3C_MODEL && type && event && event.propertyName != '_on' + type) return\n\t\n\t        var listeners = registry.get(this, type || event.type, null, false)\n\t          , l = listeners.length\n\t          , i = 0\n\t\n\t        event = new Event(event, this, true)\n\t        if (type) event.type = type\n\t\n\t        // iterate through all handlers registered for this type, calling them unless they have\n\t        // been removed by a previous handler or stopImmediatePropagation() has been called\n\t        for (; i < l && !event.isImmediatePropagationStopped(); i++) {\n\t          if (!listeners[i].removed) listeners[i].handler.call(this, event)\n\t        }\n\t      }\n\t\n\t      // add and remove listeners to DOM elements\n\t    , listener = W3C_MODEL\n\t        ? function (element, type, add) {\n\t            // new browsers\n\t            element[add ? addEvent : removeEvent](type, rootListener, false)\n\t          }\n\t        : function (element, type, add, custom) {\n\t            // IE8 and below, use attachEvent/detachEvent and we have to piggy-back propertychange events\n\t            // to simulate event bubbling etc.\n\t            var entry\n\t            if (add) {\n\t              registry.put(entry = new RegEntry(\n\t                  element\n\t                , custom || type\n\t                , function (event) { // handler\n\t                    rootListener.call(element, event, custom)\n\t                  }\n\t                , rootListener\n\t                , null\n\t                , null\n\t                , true // is root\n\t              ))\n\t              if (custom && element['_on' + custom] == null) element['_on' + custom] = 0\n\t              entry.target.attachEvent('on' + entry.eventType, entry.handler)\n\t            } else {\n\t              entry = registry.get(element, custom || type, rootListener, true)[0]\n\t              if (entry) {\n\t                entry.target.detachEvent('on' + entry.eventType, entry.handler)\n\t                registry.del(entry)\n\t              }\n\t            }\n\t          }\n\t\n\t    , once = function (rm, element, type, fn, originalFn) {\n\t        // wrap the handler in a handler that does a remove as well\n\t        return function () {\n\t          fn.apply(this, arguments)\n\t          rm(element, type, originalFn)\n\t        }\n\t      }\n\t\n\t    , removeListener = function (element, orgType, handler, namespaces) {\n\t        var type     = orgType && orgType.replace(nameRegex, '')\n\t          , handlers = registry.get(element, type, null, false)\n\t          , removed  = {}\n\t          , i, l\n\t\n\t        for (i = 0, l = handlers.length; i < l; i++) {\n\t          if ((!handler || handlers[i].original === handler) && handlers[i].inNamespaces(namespaces)) {\n\t            // TODO: this is problematic, we have a registry.get() and registry.del() that\n\t            // both do registry searches so we waste cycles doing this. Needs to be rolled into\n\t            // a single registry.forAll(fn) that removes while finding, but the catch is that\n\t            // we'll be splicing the arrays that we're iterating over. Needs extra tests to\n\t            // make sure we don't screw it up. @rvagg\n\t            registry.del(handlers[i])\n\t            if (!removed[handlers[i].eventType] && handlers[i][eventSupport])\n\t              removed[handlers[i].eventType] = { t: handlers[i].eventType, c: handlers[i].type }\n\t          }\n\t        }\n\t        // check each type/element for removed listeners and remove the rootListener where it's no longer needed\n\t        for (i in removed) {\n\t          if (!registry.has(element, removed[i].t, null, false)) {\n\t            // last listener of this type, remove the rootListener\n\t            listener(element, removed[i].t, false, removed[i].c)\n\t          }\n\t        }\n\t      }\n\t\n\t      // set up a delegate helper using the given selector, wrap the handler function\n\t    , delegate = function (selector, fn) {\n\t        //TODO: findTarget (therefore $) is called twice, once for match and once for\n\t        // setting e.currentTarget, fix this so it's only needed once\n\t        var findTarget = function (target, root) {\n\t              var i, array = isString(selector) ? selectorEngine(selector, root) : selector\n\t              for (; target && target !== root; target = target.parentNode) {\n\t                for (i = array.length; i--;) {\n\t                  if (array[i] === target) return target\n\t                }\n\t              }\n\t            }\n\t          , handler = function (e) {\n\t              var match = findTarget(e.target, this)\n\t              if (match) fn.apply(match, arguments)\n\t            }\n\t\n\t        // __beanDel isn't pleasant but it's a private function, not exposed outside of Bean\n\t        handler.__beanDel = {\n\t            ft       : findTarget // attach it here for customEvents to use too\n\t          , selector : selector\n\t        }\n\t        return handler\n\t      }\n\t\n\t    , fireListener = W3C_MODEL ? function (isNative, type, element) {\n\t        // modern browsers, do a proper dispatchEvent()\n\t        var evt = doc.createEvent(isNative ? 'HTMLEvents' : 'UIEvents')\n\t        evt[isNative ? 'initEvent' : 'initUIEvent'](type, true, true, win, 1)\n\t        element.dispatchEvent(evt)\n\t      } : function (isNative, type, element) {\n\t        // old browser use onpropertychange, just increment a custom property to trigger the event\n\t        element = targetElement(element, isNative)\n\t        isNative ? element.fireEvent('on' + type, doc.createEventObject()) : element['_on' + type]++\n\t      }\n\t\n\t      /**\n\t        * Public API: off(), on(), add(), (remove()), one(), fire(), clone()\n\t        */\n\t\n\t      /**\n\t        * off(element[, eventType(s)[, handler ]])\n\t        */\n\t    , off = function (element, typeSpec, fn) {\n\t        var isTypeStr = isString(typeSpec)\n\t          , k, type, namespaces, i\n\t\n\t        if (isTypeStr && typeSpec.indexOf(' ') > 0) {\n\t          // off(el, 't1 t2 t3', fn) or off(el, 't1 t2 t3')\n\t          typeSpec = str2arr(typeSpec)\n\t          for (i = typeSpec.length; i--;)\n\t            off(element, typeSpec[i], fn)\n\t          return element\n\t        }\n\t\n\t        type = isTypeStr && typeSpec.replace(nameRegex, '')\n\t        if (type && customEvents[type]) type = customEvents[type].base\n\t\n\t        if (!typeSpec || isTypeStr) {\n\t          // off(el) or off(el, t1.ns) or off(el, .ns) or off(el, .ns1.ns2.ns3)\n\t          if (namespaces = isTypeStr && typeSpec.replace(namespaceRegex, '')) namespaces = str2arr(namespaces, '.')\n\t          removeListener(element, type, fn, namespaces)\n\t        } else if (isFunction(typeSpec)) {\n\t          // off(el, fn)\n\t          removeListener(element, null, typeSpec)\n\t        } else {\n\t          // off(el, { t1: fn1, t2, fn2 })\n\t          for (k in typeSpec) {\n\t            if (typeSpec.hasOwnProperty(k)) off(element, k, typeSpec[k])\n\t          }\n\t        }\n\t\n\t        return element\n\t      }\n\t\n\t      /**\n\t        * on(element, eventType(s)[, selector], handler[, args ])\n\t        */\n\t    , on = function(element, events, selector, fn) {\n\t        var originalFn, type, types, i, args, entry, first\n\t\n\t        //TODO: the undefined check means you can't pass an 'args' argument, fix this perhaps?\n\t        if (selector === undefined && typeof events == 'object') {\n\t          //TODO: this can't handle delegated events\n\t          for (type in events) {\n\t            if (events.hasOwnProperty(type)) {\n\t              on.call(this, element, type, events[type])\n\t            }\n\t          }\n\t          return\n\t        }\n\t\n\t        if (!isFunction(selector)) {\n\t          // delegated event\n\t          originalFn = fn\n\t          args       = slice.call(arguments, 4)\n\t          fn         = delegate(selector, originalFn, selectorEngine)\n\t        } else {\n\t          args       = slice.call(arguments, 3)\n\t          fn         = originalFn = selector\n\t        }\n\t\n\t        types = str2arr(events)\n\t\n\t        // special case for one(), wrap in a self-removing handler\n\t        if (this === ONE) {\n\t          fn = once(off, element, events, fn, originalFn)\n\t        }\n\t\n\t        for (i = types.length; i--;) {\n\t          // add new handler to the registry and check if it's the first for this element/type\n\t          first = registry.put(entry = new RegEntry(\n\t              element\n\t            , types[i].replace(nameRegex, '') // event type\n\t            , fn\n\t            , originalFn\n\t            , str2arr(types[i].replace(namespaceRegex, ''), '.') // namespaces\n\t            , args\n\t            , false // not root\n\t          ))\n\t          if (entry[eventSupport] && first) {\n\t            // first event of this type on this element, add root listener\n\t            listener(element, entry.eventType, true, entry.customType)\n\t          }\n\t        }\n\t\n\t        return element\n\t      }\n\t\n\t      /**\n\t        * add(element[, selector], eventType(s), handler[, args ])\n\t        *\n\t        * Deprecated: kept (for now) for backward-compatibility\n\t        */\n\t    , add = function (element, events, fn, delfn) {\n\t        return on.apply(\n\t            null\n\t          , !isString(fn)\n\t              ? slice.call(arguments)\n\t              : [ element, fn, events, delfn ].concat(arguments.length > 3 ? slice.call(arguments, 5) : [])\n\t        )\n\t      }\n\t\n\t      /**\n\t        * one(element, eventType(s)[, selector], handler[, args ])\n\t        */\n\t    , one = function () {\n\t        return on.apply(ONE, arguments)\n\t      }\n\t\n\t      /**\n\t        * fire(element, eventType(s)[, args ])\n\t        *\n\t        * The optional 'args' argument must be an array, if no 'args' argument is provided\n\t        * then we can use the browser's DOM event system, otherwise we trigger handlers manually\n\t        */\n\t    , fire = function (element, type, args) {\n\t        var types = str2arr(type)\n\t          , i, j, l, names, handlers\n\t\n\t        for (i = types.length; i--;) {\n\t          type = types[i].replace(nameRegex, '')\n\t          if (names = types[i].replace(namespaceRegex, '')) names = str2arr(names, '.')\n\t          if (!names && !args && element[eventSupport]) {\n\t            fireListener(nativeEvents[type], type, element)\n\t          } else {\n\t            // non-native event, either because of a namespace, arguments or a non DOM element\n\t            // iterate over all listeners and manually 'fire'\n\t            handlers = registry.get(element, type, null, false)\n\t            args = [false].concat(args)\n\t            for (j = 0, l = handlers.length; j < l; j++) {\n\t              if (handlers[j].inNamespaces(names)) {\n\t                handlers[j].handler.apply(element, args)\n\t              }\n\t            }\n\t          }\n\t        }\n\t        return element\n\t      }\n\t\n\t      /**\n\t        * clone(dstElement, srcElement[, eventType ])\n\t        *\n\t        * TODO: perhaps for consistency we should allow the same flexibility in type specifiers?\n\t        */\n\t    , clone = function (element, from, type) {\n\t        var handlers = registry.get(from, type, null, false)\n\t          , l = handlers.length\n\t          , i = 0\n\t          , args, beanDel\n\t\n\t        for (; i < l; i++) {\n\t          if (handlers[i].original) {\n\t            args = [ element, handlers[i].type ]\n\t            if (beanDel = handlers[i].handler.__beanDel) args.push(beanDel.selector)\n\t            args.push(handlers[i].original)\n\t            on.apply(null, args)\n\t          }\n\t        }\n\t        return element\n\t      }\n\t\n\t    , bean = {\n\t          'on'                : on\n\t        , 'add'               : add\n\t        , 'one'               : one\n\t        , 'off'               : off\n\t        , 'remove'            : off\n\t        , 'clone'             : clone\n\t        , 'fire'              : fire\n\t        , 'Event'             : Event\n\t        , 'setSelectorEngine' : setSelectorEngine\n\t        , 'noConflict'        : function () {\n\t            context[name] = old\n\t            return this\n\t          }\n\t      }\n\t\n\t  // for IE, clean up on unload to avoid leaks\n\t  if (win.attachEvent) {\n\t    var cleanup = function () {\n\t      var i, entries = registry.entries()\n\t      for (i in entries) {\n\t        if (entries[i].type && entries[i].type !== 'unload') off(entries[i].element, entries[i].type)\n\t      }\n\t      win.detachEvent('onunload', cleanup)\n\t      win.CollectGarbage && win.CollectGarbage()\n\t    }\n\t    win.attachEvent('onunload', cleanup)\n\t  }\n\t\n\t  // initialize selector engine to internal default (qSA or throw Error)\n\t  setSelectorEngine()\n\t\n\t  return bean\n\t});\n\n\n/***/ },\n/* 13 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t\tvalue: true\n\t});\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tvar _lodash = __webpack_require__(5);\n\t\n\tvar _lodash2 = _interopRequireDefault(_lodash);\n\t\n\tvar _bean = __webpack_require__(12);\n\t\n\tvar _bean2 = _interopRequireDefault(_bean);\n\t\n\tvar _KeyUtils = __webpack_require__(14);\n\t\n\tvar KeyUtils = _interopRequireWildcard(_KeyUtils);\n\t\n\tvar _Utils = __webpack_require__(2);\n\t\n\tvar _Utils2 = _interopRequireDefault(_Utils);\n\t\n\tvar _DomUtils = __webpack_require__(7);\n\t\n\tvar _DomUtils2 = _interopRequireDefault(_DomUtils);\n\t\n\tvar _StringBuffer = __webpack_require__(8);\n\t\n\tvar _StringBuffer2 = _interopRequireDefault(_StringBuffer);\n\t\n\tfunction _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj.default = obj; return newObj; } }\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tvar DEFAULTS = {\n\t\tstopPropagation: false\n\t};\n\t\n\tvar EventDispatcher = function () {\n\t\t/**\n\t  * Constructor\n\t  * @param root the root element that the manager will listen to.\n\t  * @param zoomScale\n\t  * @param config the configuraton for the event dispatcher.\n\t  */\n\t\n\t\tfunction EventDispatcher(root) {\n\t\t\tvar zoomScale = arguments.length <= 1 || arguments[1] === undefined ? [0, Infinity] : arguments[1];\n\t\t\tvar config = arguments.length <= 2 || arguments[2] === undefined ? {} : arguments[2];\n\t\n\t\t\t_classCallCheck(this, EventDispatcher);\n\t\n\t\t\tthis.root = root;\n\t\t\tthis.rootNS = root.getAttribute('ns') || 'root';\n\t\t\tthis.zoomScale = zoomScale;\n\t\t\t_lodash2.default.assign(this, DEFAULTS, config);\n\t\t\tthis.scale = 1.0;\n\t\t\tthis.listeners = {};\n\t\t\tthis.dragging = false;\n\t\t\tthis.handler = _lodash2.default.bind(this.handleEvent, this);\n\t\t\tthis.started = false;\n\t\n\t\t\t// Simulate mouseenter/mouseleave events\n\t\t\tthis.enterStack = [];\n\t\t}\n\t\n\t\t/**\n\t  * Start listening for events.\n\t  */\n\t\n\t\n\t\t_createClass(EventDispatcher, [{\n\t\t\tkey: \"start\",\n\t\t\tvalue: function start() {\n\t\t\t\tif (this.started) return;\n\t\t\t\t_bean2.default.on(this.root, 'mousedown mouseover mouseout mouseenter mouseleave dblclick click contextmenu mousewheel', this.handler);\n\t\t\t\tthis.startKeys();\n\t\t\t\tthis.started = true;\n\t\t\t}\n\t\n\t\t\t/**\n\t   * Stop listening for events.\n\t   */\n\t\n\t\t}, {\n\t\t\tkey: \"stop\",\n\t\t\tvalue: function stop() {\n\t\t\t\tif (!this.started) return;\n\t\t\t\t_bean2.default.off(this.root, 'mousedown mouseover mouseout mouseenter mouseleave dblclick click contextmenu mousewheel', this.handler);\n\t\t\t\tthis.stopKeys();\n\t\t\t\tthis.started = false;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"startKeys\",\n\t\t\tvalue: function startKeys() {\n\t\t\t\t_bean2.default.on(document, 'keydown keyup', this.handler);\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"stopKeys\",\n\t\t\tvalue: function stopKeys() {\n\t\t\t\t_bean2.default.off(document, 'keydown keyup', this.handler);\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"zoomIn\",\n\t\t\tvalue: function zoomIn() {\n\t\t\t\tthis.scale *= 1.25;\n\t\t\t\tthis.scale = Math.max(Math.min(this.zoomScale[1], this.scale), this.zoomScale[0]);\n\t\t\t\treturn this.scale;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"zoomOut\",\n\t\t\tvalue: function zoomOut() {\n\t\t\t\tthis.scale *= 0.8;\n\t\t\t\tthis.scale = Math.max(Math.min(this.zoomScale[1], this.scale), this.zoomScale[0]);\n\t\t\t\treturn this.scale;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"getEventInfo\",\n\t\t\tvalue: function getEventInfo(event) {\n\t\t\t\tvar target = event.target;\n\t\t\t\tvar buf = new _StringBuffer2.default(),\n\t\t\t\t    ns = void 0,\n\t\t\t\t    stack = [],\n\t\t\t\t    isRoot = false;\n\t\t\t\twhile (!isRoot && target && target != document) {\n\t\t\t\t\tns = target.getAttribute('ns');\n\t\t\t\t\tif (ns) {\n\t\t\t\t\t\tisRoot = _lodash2.default.startsWith(ns, \"root.\");\n\t\t\t\t\t\tif (isRoot) {\n\t\t\t\t\t\t\tns = ns.substring(5);\n\t\t\t\t\t\t\tevent.rootTarget = target;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (!event.nsTarget) event.nsTarget = target;\n\t\t\t\t\t\tstack.splice(0, 0, target);\n\t\t\t\t\t\tbuf.prepend(ns);\n\t\t\t\t\t}\n\t\t\t\t\ttarget = target.parentNode;\n\t\t\t\t}\n\t\t\t\tif (!isRoot) event.rootTarget = event.nsTarget;\n\t\n\t\t\t\t// target stack is a stack of all the ns targets up to the one with the data binding.\n\t\t\t\tevent.targetStack = stack;\n\t\t\t\tns = buf.toString('.');\n\t\t\t\tif (ns == '') ns = this.rootNS;\n\t\t\t\treturn { data: event.rootTarget, ns: ns };\n\t\t\t}\n\t\n\t\t\t/**\n\t   * The main event handler method, it processes event and generate relevant events to dispatch.\n\t   */\n\t\n\t\t}, {\n\t\t\tkey: \"handleEvent\",\n\t\t\tvalue: function handleEvent(event) {\n\t\t\t\tvar _this = this;\n\t\n\t\t\t\tvar type = event.type;\n\t\n\t\t\t\t// Do not dispatch other events if we are dragging.\n\t\t\t\tif (this.dragging || _DomUtils2.default.eventFromInput(event)) return;\n\t\n\t\t\t\tvar data = void 0,\n\t\t\t\t    ns = void 0,\n\t\t\t\t    pos = this.getPosition(event),\n\t\t\t\t    info = void 0,\n\t\t\t\t    isKeyEvent = type == 'keydown' || type == 'keyup';\n\t\t\t\tif (isKeyEvent) {\n\t\t\t\t\tdata = this.root;\n\t\t\t\t\tns = KeyUtils.getKeyEvent(event);\n\t\t\t\t} else {\n\t\t\t\t\tinfo = this.getEventInfo(event);\n\t\t\t\t\tif (!info) return;\n\t\t\t\t\tdata = info.data;\n\t\t\t\t\tns = info.ns;\n\t\t\t\t}\n\t\n\t\t\t\t//Utils.log('EventDispatcher', \"handleEvent - \" + type + ';ns=' + ns);\n\t\n\t\t\t\tif (type == 'mousewheel') {\n\t\t\t\t\tthis.scale *= Math.pow(2, event.wheelDelta * 0.002);\n\t\t\t\t\tthis.scale = Math.max(Math.min(this.zoomScale[1], this.scale), this.zoomScale[0]);\n\t\t\t\t\tevent.scale = this.scale;\n\t\t\t\t\ttype = 'zoom';\n\t\t\t\t}\n\t\n\t\t\t\t// See if we should create drag events\n\t\t\t\tif (type == 'mousedown' && event.button == 0 /*only drag on left click*/) {\n\t\t\t\t\t\t(function () {\n\t\t\t\t\t\t\t// Create drag object.\n\t\t\t\t\t\t\tvar dragObject = { data: data, pos: ns == 'root' ? EventDispatcher.mouse(_this.root, event) : pos };\n\t\t\t\t\t\t\t_this.dragging = false;\n\t\t\t\t\t\t\t// Start listening for mouse move.\n\t\t\t\t\t\t\tvar dragPos = void 0;\n\t\n\t\t\t\t\t\t\tvar mousemove = function mousemove(event) {\n\t\t\t\t\t\t\t\tvar currentPos = _this.getPosition(event);\n\t\t\t\t\t\t\t\tif (!_this.dragging) {\n\t\t\t\t\t\t\t\t\t// check if the mouse has moved. IE always fire mousemove after mousedown even if the mouse hasn't moved yet.\n\t\t\t\t\t\t\t\t\tif (dragObject.pos[0] == currentPos[0] && dragObject.pos[1] == currentPos[1]) return;\n\t\n\t\t\t\t\t\t\t\t\t// start dragging\n\t\t\t\t\t\t\t\t\t_this.dragging = true;\n\t\t\t\t\t\t\t\t\tevent.rootTarget = dragObject.data;\n\t\t\t\t\t\t\t\t\t_this.dispatch(event, 'dragstart', ns, dragObject.data, dragObject.pos);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tif (ns == \"root\") dragPos = EventDispatcher.mouse(_this.root, event);else dragPos = currentPos;\n\t\t\t\t\t\t\t\t_this.getEventInfo(event);\n\t\t\t\t\t\t\t\t_this.dispatch(event, 'drag', ns, dragObject.data, dragPos);\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\tvar mouseup = function mouseup(event) {\n\t\t\t\t\t\t\t\tif (ns == \"root\") dragPos = EventDispatcher.mouse(_this.root, event);else dragPos = _this.getPosition(event);\n\t\n\t\t\t\t\t\t\t\tvar info = _this.getEventInfo(event);\n\t\t\t\t\t\t\t\tif (_this.dragging) {\n\t\t\t\t\t\t\t\t\t_this.dragging = false;\n\t\t\t\t\t\t\t\t\t_this.dispatch(event, 'dragend', ns, dragObject.data, dragPos);\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t_this.dispatch(event, 'mouseup', ns, info.data, dragPos);\n\t\t\t\t\t\t\t\t}\n\t\n\t\t\t\t\t\t\t\t_bean2.default.off(window, 'mousemove', mousemove);\n\t\t\t\t\t\t\t\t_bean2.default.off(window, 'mouseup', mouseup);\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\tevent.preventDefault();\n\t\t\t\t\t\t\t_bean2.default.on(window, 'mousemove', mousemove);\n\t\t\t\t\t\t\t_bean2.default.on(window, 'mouseup', mouseup);\n\t\t\t\t\t\t})();\n\t\t\t\t\t}\n\t\n\t\t\t\tif (!isKeyEvent) this.simulateEnterLeave(event, type, ns, data, pos);\n\t\t\t\tthis.dispatch(event, type, ns, data, pos);\n\t\n\t\t\t\t// disable the default context menu\n\t\t\t\t//if (type == 'contextmenu')\n\t\t\t\t//\tevent.preventDefault();\n\t\t\t}\n\t\n\t\t\t/**\n\t   * try to simulate mouseenter/mouseleave events.\n\t   */\n\t\n\t\t}, {\n\t\t\tkey: \"simulateEnterLeave\",\n\t\t\tvalue: function simulateEnterLeave(event, type, ns, data, pos) {\n\t\t\t\tvar _this2 = this;\n\t\n\t\t\t\tvar last = void 0,\n\t\t\t\t    stack = void 0;\n\t\t\t\tvar clearEnterStack = function clearEnterStack(k) {\n\t\t\t\t\tk = k || 0;\n\t\t\t\t\t// Clear off the enter stack.\n\t\t\t\t\twhile (_this2.enterStack.length >= k + 1) {\n\t\t\t\t\t\tlast = _this2.enterStack.pop();\n\t\t\t\t\t\t_this2.dispatch(event, 'mouseleave', last.ns, last.data, pos);\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t\tvar getNS = function getNS(index) {\n\t\t\t\t\tvar buf = new _StringBuffer2.default();\n\t\t\t\t\tfor (var i = 0; i <= index; i++) {\n\t\t\t\t\t\tvar val = stack[i].getAttribute(\"ns\");\n\t\t\t\t\t\tif (_lodash2.default.startsWith(val, \"root.\")) val = val.substring(5);\n\t\t\t\t\t\tbuf.append(val);\n\t\t\t\t\t}\n\t\t\t\t\treturn buf.toString('.');\n\t\t\t\t};\n\t\n\t\t\t\tif (ns && ns != this.rootNS) {\n\t\t\t\t\tif (type == 'mouseover') {\n\t\t\t\t\t\tstack = event.targetStack;\n\t\t\t\t\t\tvar item = void 0;\n\t\t\t\t\t\tfor (var i = 0; i < stack.length; i++) {\n\t\t\t\t\t\t\tif (i < this.enterStack.length) {\n\t\t\t\t\t\t\t\tif (this.enterStack[i].target != stack[i]) {\n\t\t\t\t\t\t\t\t\tclearEnterStack(i);\n\t\t\t\t\t\t\t\t} else continue;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\titem = { data: data, ns: getNS(i), target: stack[i] };\n\t\t\t\t\t\t\tthis.enterStack.push(item);\n\t\t\t\t\t\t\tthis.dispatch(event, 'mouseenter', item.ns, data, pos);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (stack.length < this.enterStack.length) clearEnterStack(stack.length);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (ns == this.rootNS && this.enterStack.length > 0) clearEnterStack();\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"dispatch\",\n\t\t\tvalue: function dispatch(event, type, ns, data, pos) {\n\t\t\t\t//if (type != 'mouseover' && type != 'mouseout')\n\t\t\t\t//\tUtils.log('EventDispatcher', \"dispatch - \" + type + '.' + ns + ';' + pos + ';rootTarget=' + event.rootTarget + ';data=' + data);\n\t\t\t\tif (!this.started) return;\n\t\t\t\tvar nsType = ns ? type + '.' + ns : type;\n\t\t\t\t_lodash2.default.forEach(this.listeners, function (listeners, key) {\n\t\t\t\t\tif (EventDispatcher.match(nsType, listeners.regexp ? listeners.regexp : key)) {\n\t\t\t\t\t\t_lodash2.default.forEach(listeners, function (listener) {\n\t\t\t\t\t\t\tif (!listener.context) listener.callback.apply(window, [type, ns, data, pos, event]);else listener.callback.apply(listener.context, [type, ns, data, pos, event]);\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t});\n\t\n\t\t\t\t// after dispatching, do not propagate.\n\t\t\t\tif (this.stopPropagation && event.stopPropagation) event.stopPropagation();\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"getPosition\",\n\t\t\tvalue: function getPosition(event) {\n\t\t\t\tvar pos = EventDispatcher.mouse(this.root, event);\n\t\t\t\tif (!_lodash2.default.isNaN(pos[0]) && !_lodash2.default.isNaN(pos[1])) this.lastPosition = pos;\n\t\t\t\treturn this.lastPosition;\n\t\t\t}\n\t\n\t\t\t/**\n\t   * Registers a key event handler\n\t   * // Key is object {ctrl, alt, shift, meta, code}\n\t   */\n\t\n\t\t}, {\n\t\t\tkey: \"registerKey\",\n\t\t\tvalue: function registerKey(type, key, callback, context) {\n\t\t\t\tvar _this3 = this;\n\t\n\t\t\t\tif (_lodash2.default.isArray(key)) {\n\t\t\t\t\t_lodash2.default.forEach(key, function (k) {\n\t\t\t\t\t\t_this3.registerKey(type, k, callback, context);\n\t\t\t\t\t});\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tkey = KeyUtils.getKeyData(key.ctrl, key.alt, key.shift, key.meta, key.code);\n\t\t\t\tif (!key.length) return;\n\t\t\t\tkey = new _StringBuffer2.default(type).append(key).toString('.');\n\t\n\t\t\t\tvar listener = { callback: callback, context: context };\n\t\t\t\tthis.listeners[key] || (this.listeners[key] = []);\n\t\t\t\tthis.listeners[key].push(listener);\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"unregisterKey\",\n\t\t\tvalue: function unregisterKey(type, key, callback, context) {\n\t\t\t\tvar _this4 = this;\n\t\n\t\t\t\tif (_lodash2.default.isArray(key)) {\n\t\t\t\t\t_lodash2.default.forEach(key, function (k) {\n\t\t\t\t\t\t_this4.unregisterKey(type, k, callback, context);\n\t\t\t\t\t});\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tkey = KeyUtils.getKeyData(key.ctrl, key.alt, key.shift, key.meta, key.code);\n\t\t\t\tif (!key.length) return;\n\t\t\t\tkey = new _StringBuffer2.default(type).append(key).toString('.');\n\t\n\t\t\t\tvar listeners = this.listeners[key],\n\t\t\t\t    listener = void 0;\n\t\t\t\tif (!listeners) return;\n\t\t\t\tfor (var i = 0; i < listeners.length; i++) {\n\t\t\t\t\tlistener = listeners[i];\n\t\t\t\t\tif (listener.callback === callback && (!context || context === listener.context)) {\n\t\t\t\t\t\tlisteners.splice(i, 1);\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\n\t\t\t/**\n\t   * Registers an event handler\n\t   */\n\t\n\t\t}, {\n\t\t\tkey: \"register\",\n\t\t\tvalue: function register(type, callback, context, zIndex) {\n\t\t\t\tvar _this5 = this;\n\t\n\t\t\t\tif (_lodash2.default.isArray(type)) {\n\t\t\t\t\t_lodash2.default.forEach(type, function (t) {\n\t\t\t\t\t\t_this5.register(t, callback, context, zIndex);\n\t\t\t\t\t});\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tvar listener = { callback: callback, context: context, zIndex: zIndex };\n\t\t\t\tvar regexp = null;\n\t\t\t\tif (type instanceof RegExp) {\n\t\t\t\t\tregexp = type;\n\t\t\t\t\ttype = type + '';\n\t\t\t\t}\n\t\t\t\tthis.listeners[type] || (this.listeners[type] = []);\n\t\t\t\tif (regexp && !this.listeners[type].regexp) this.listeners[type].regexp = regexp;\n\t\t\t\tthis.listeners[type].push(listener);\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"unregister\",\n\t\t\tvalue: function unregister(type, callback, context) {\n\t\t\t\tif (type instanceof RegExp) type = type + '';\n\t\t\t\tvar listeners = this.listeners[type],\n\t\t\t\t    listener = void 0;\n\t\t\t\tif (!listeners) return;\n\t\t\t\tfor (var i = 0; i < listeners.length; i++) {\n\t\t\t\t\tlistener = listeners[i];\n\t\t\t\t\tif (listener.callback === callback && (!context || context === listener.context)) {\n\t\t\t\t\t\tlisteners.splice(i, 1);\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"destroy\",\n\t\t\tvalue: function destroy() {\n\t\t\t\tthis.stop();\n\t\t\t\tdelete this.root;\n\t\t\t\tdelete this.listeners;\n\t\t\t\tdelete this.enterStack;\n\t\t\t}\n\t\n\t\t\t/**\n\t   * Check if the registered event type matches the real event type. \"*\" is allowed as a wild card.\n\t   */\n\t\n\t\t}], [{\n\t\t\tkey: \"match\",\n\t\t\tvalue: function match(nsType, registeredType) {\n\t\t\t\tif (registeredType instanceof RegExp) return nsType.match(registeredType);\n\t\n\t\t\t\treturn nsType == registeredType;\n\t\t\t\t/*const arr = registeredType.split('*');\n\t   if (arr.length == 1)\n\t   \treturn nsType == registeredType;\n\t   \tlet substr, index = 0;\n\t   for (let i = 0; i < arr.length; i++) {\n\t   \tif (arr[i].length == 0) continue;\n\t   \tsubstr = nsType.slice(index);\n\t   \tindex = substr.indexOf(arr[i]);\n\t   \tif (index < 0)\n\t   \t\treturn false;\n\t   \tindex += arr[i].length;\n\t   }\n\t   return true;*/\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"mouse\",\n\t\t\tvalue: function mouse(container, e) {\n\t\t\t\tif (e.changedTouches) e = e.changedTouches[0];\n\t\t\t\tvar svg = container.ownerSVGElement || container;\n\t\t\t\tif (svg.createSVGPoint) {\n\t\t\t\t\tvar point = svg.createSVGPoint();\n\t\t\t\t\tpoint.x = e.clientX;point.y = e.clientY;\n\t\t\t\t\tpoint = point.matrixTransform(container.getScreenCTM().inverse());\n\t\t\t\t\treturn [point.x, point.y];\n\t\t\t\t}\n\t\t\t\tvar rect = container.getBoundingClientRect();\n\t\t\t\treturn [e.clientX - rect.left - container.clientLeft, e.clientY - rect.top - container.clientTop];\n\t\t\t}\n\t\t}]);\n\t\n\t\treturn EventDispatcher;\n\t}();\n\t\n\texports.default = EventDispatcher;\n\n/***/ },\n/* 14 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t\tvalue: true\n\t});\n\texports.getKeyEvent = getKeyEvent;\n\texports.getKeyData = getKeyData;\n\t\n\tvar _StringBuffer = __webpack_require__(8);\n\t\n\tvar _StringBuffer2 = _interopRequireDefault(_StringBuffer);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\t/**\n\t * KEY constant\n\t */\n\tvar KEY = {\n\t\tALT: 18,\n\t\tBACK_SPACE: 8,\n\t\tCAPS_LOCK: 20,\n\t\tCONTROL: 17,\n\t\tDELETE: 46,\n\t\tDOWN: 40,\n\t\tEND: 35,\n\t\tENTER: 13,\n\t\tESCAPE: 220,\n\t\tHOME: 36,\n\t\tLEFT: 37,\n\t\tMETA: 224,\n\t\tNUM_LOCK: 144,\n\t\tPAGE_DOWN: 34,\n\t\tPAGE_UP: 33,\n\t\tPAUSE: 19,\n\t\tPRINTSCREEN: 44,\n\t\tRIGHT: 39,\n\t\tSCROLL_LOCK: 145,\n\t\tSHIFT: 16,\n\t\tSPACE: 32,\n\t\tTAB: 9,\n\t\tUP: 38\n\t\t//ADD          : DomUtils.isFireFox ? 61  : 187,\n\t\t//SUBTRACT     : DomUtils.isFireFox ? 173 : 189\n\t}; ///////////////////////////////////////////////////////////////////////////////\n\t//                                                                           //\n\t//           The Key Utility CLass for the Event Dispatcher          \t     //\n\t//                                                                           //\n\t///////////////////////////////////////////////////////////////////////////////\n\t\n\tfunction getKeyEvent(event) {\n\t\tif (!event || !event instanceof KeyboardEvent) {\n\t\t\treturn null;\n\t\t}\n\t\n\t\tvar key = event.keyCode || event.which;\n\t\n\t\t// Need to find a way to avoid this\n\t\tif (key >= 16 && key <= 18) {\n\t\t\tkey = null;\n\t\t}\n\t\n\t\treturn getKeyData(event.ctrlKey, event.altKey, event.shiftKey, event.metaKey, key);\n\t}\n\t\n\tfunction getKeyData(ctrl, alt, shift, meta, key) {\n\t\tvar buf = new _StringBuffer2.default();\n\t\n\t\tif (ctrl) buf.append(\"CTRL\");\n\t\tif (alt) buf.append(\"ALT\");\n\t\tif (shift) buf.append(\"SHIFT\");\n\t\tif (meta) buf.append(\"META\");\n\t\tif (key) buf.append(key);\n\t\n\t\treturn buf.toString(\".\");\n\t}\n\n/***/ },\n/* 15 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t\tvalue: true\n\t});\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tvar _lodash = __webpack_require__(5);\n\t\n\tvar _lodash2 = _interopRequireDefault(_lodash);\n\t\n\tvar _Utils = __webpack_require__(2);\n\t\n\tvar _Utils2 = _interopRequireDefault(_Utils);\n\t\n\tvar _Node = __webpack_require__(16);\n\t\n\tvar _Node2 = _interopRequireDefault(_Node);\n\t\n\tvar _Edge = __webpack_require__(20);\n\t\n\tvar _Edge2 = _interopRequireDefault(_Edge);\n\t\n\tvar _Marker = __webpack_require__(21);\n\t\n\tvar _Marker2 = _interopRequireDefault(_Marker);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tvar nodeDefaults = {\n\t\tname: 'Default',\n\t\trole: 'node',\n\t\tdraggable: true,\n\t\tselectable: true,\n\t\teditable: true,\n\t\tresizable: false,\n\t\tsourceable: true,\n\t\ttargetable: true,\n\t\tvisible: true\n\t};\n\t\n\tvar edgeDefaults = {\n\t\tname: 'Default',\n\t\trole: 'edge',\n\t\tselectable: true,\n\t\tvisible: true,\n\t\tstartMarker: null,\n\t\tendMarker: {\n\t\t\tid: 'Default_EndMarker',\n\t\t\ttype: 'arrow',\n\t\t\tsize: 10,\n\t\t\tcolor: '#0ea117'\n\t\t},\n\t\t/* start and end is only used if the edge is not connected to a node */\n\t\tstart: [0, 0],\n\t\tend: [400, 200]\n\t};\n\t\n\tvar Graph = function () {\n\t\tfunction Graph() {\n\t\t\tvar id = arguments.length <= 0 || arguments[0] === undefined ? _lodash2.default.uniqueId(\"G\") : arguments[0];\n\t\t\tvar config = arguments.length <= 1 || arguments[1] === undefined ? {} : arguments[1];\n\t\t\tvar model = arguments[2];\n\t\n\t\t\t_classCallCheck(this, Graph);\n\t\n\t\t\tthis.id = id;\n\t\n\t\t\tthis.nodes = {};\n\t\t\tthis.edges = {};\n\t\n\t\t\tthis.selection = null;\n\t\t\tthis.destroyed = false;\n\t\n\t\t\t_Utils2.default.buildTypes(config.nodeTypes, \"Nodes\", nodeDefaults);\n\t\t\t_Utils2.default.buildTypes(config.edgeTypes, \"Edges\", edgeDefaults);\n\t\t\t// check for markers.\n\t\t\tthis.markers = [];\n\t\t\tvar edgeTypes = _Utils2.default.type(_Edge2.default.namespace),\n\t\t\t    marker = void 0,\n\t\t\t    markerConfig = void 0;\n\t\t\tedgeTypes.forEach(function (type) {\n\t\t\t\tmarkerConfig = type.prototype.startMarker;\n\t\t\t\tif (markerConfig) {\n\t\t\t\t\tmarker = _Marker2.default.getMarker(markerConfig, true);\n\t\t\t\t\tthis.markers.push(marker);\n\t\t\t\t}\n\t\t\t\tmarkerConfig = type.prototype.endMarker;\n\t\t\t\tif (markerConfig) {\n\t\t\t\t\tmarker = _Marker2.default.getMarker(markerConfig, false);\n\t\t\t\t\tthis.markers.push(marker);\n\t\t\t\t}\n\t\t\t}, this);\n\t\n\t\t\tdelete config.nodeTypes;\n\t\t\tdelete config.edgeTypes;\n\t\t\t_Utils2.default.initConfig(this, config);\n\t\t\tthis.root = null;\n\t\t\tif (model) this.loadModel(model);\n\t\t}\n\t\n\t\t_createClass(Graph, [{\n\t\t\tkey: \"addNode\",\n\t\n\t\n\t\t\t/**\n\t   * Create a new Node\n\t   */\n\t\t\tvalue: function addNode(config) {\n\t\t\t\tvar parent = arguments.length <= 1 || arguments[1] === undefined ? this.currentRoot : arguments[1];\n\t\t\t\tvar pos = arguments[2];\n\t\n\t\t\t\tvar NodeClass = Graph.getJSClass(config, _Node2.default);\n\t\t\t\tvar node = new NodeClass(this, config);\n\t\n\t\t\t\tif (parent) Graph.addChild(parent, node, pos);else {\n\t\t\t\t\tthis.root = node;\n\t\t\t\t\tthis.root.prop('role', 'root');\n\t\t\t\t}\n\t\n\t\t\t\tthis.nodes[node.id] = node;\n\t\t\t\treturn node;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"addEdge\",\n\t\t\tvalue: function addEdge(config) {\n\t\t\t\tvar parent = arguments.length <= 1 || arguments[1] === undefined ? this.currentRoot : arguments[1];\n\t\t\t\tvar from = arguments[2];\n\t\t\t\tvar to = arguments[3];\n\t\n\t\t\t\tvar EdgeClass = Graph.getJSClass(config, _Edge2.default);\n\t\t\t\tvar edge = new EdgeClass(this, config, from, to);\n\t\n\t\t\t\tGraph.addChild(parent, edge);\n\t\t\t\tthis.edges[edge.id] = edge;\n\t\t\t\treturn edge;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"loadModel\",\n\t\t\tvalue: function loadModel(model) {\n\t\t\t\tvar _this = this;\n\t\n\t\t\t\tvar parent = arguments.length <= 1 || arguments[1] === undefined ? this.currentRoot : arguments[1];\n\t\n\t\t\t\tvar nodes = model.nodes;\n\t\t\t\tvar edges = model.edges;\n\t\t\t\tdelete model.nodes;\n\t\t\t\tdelete model.edges;\n\t\n\t\t\t\tvar node = this.addNode(model, parent);\n\t\t\t\tif (nodes) {\n\t\t\t\t\t_lodash2.default.forEach(nodes, function (child) {\n\t\t\t\t\t\t_this.loadModel(child, node);\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\tif (edges) {\n\t\t\t\t\t_lodash2.default.forEach(edges, function (edge) {\n\t\t\t\t\t\tvar from = void 0,\n\t\t\t\t\t\t    to = void 0;\n\t\t\t\t\t\tif (edge.from) from = _this.nodes[edge.from];\n\t\t\t\t\t\tif (edge.to) to = _this.nodes[edge.to];\n\t\t\t\t\t\t_this.addEdge(edge, node, from, to);\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"reset\",\n\t\t\tvalue: function reset() {}\n\t\t}, {\n\t\t\tkey: \"destroy\",\n\t\t\tvalue: function destroy() {}\n\t\t}, {\n\t\t\tkey: \"currentRoot\",\n\t\t\tget: function get() {\n\t\t\t\treturn this.root;\n\t\t\t}\n\t\t}], [{\n\t\t\tkey: \"getJSClass\",\n\t\t\tvalue: function getJSClass(config, defaultClass) {\n\t\t\t\tvar jsClass = null;\n\t\t\t\tif (config && config.type) {\n\t\t\t\t\t// See if we can get the js class from config.\n\t\t\t\t\tvar type = _Utils2.default.type(defaultClass.namespace, config.type);\n\t\t\t\t\tif (type) jsClass = type.jsClass;\n\t\t\t\t}\n\t\n\t\t\t\treturn _Utils2.default.getConstructor(jsClass, defaultClass);\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"addChild\",\n\t\t\tvalue: function addChild(parent, child) {\n\t\t\t\tif (!parent.children) parent.children = [];\n\t\n\t\t\t\tif (child.parent != parent) {\n\t\t\t\t\tparent.children.push(child);\n\t\n\t\t\t\t\tif (child.parent && child.parent.children) child.parent.children = _lodash2.default.without(child.parent.children, child);\n\t\t\t\t}\n\t\t\t\tchild.parent = parent;\n\t\t\t}\n\t\t}]);\n\t\n\t\treturn Graph;\n\t}();\n\t\n\tGraph.DEFAULTS = {\n\t\tallowDanglingEdges: true,\n\t\tmultiConnect: false,\n\t\treadOnly: false,\n\t\tviewOnly: false\n\t};\n\t\n\texports.default = Graph;\n\n/***/ },\n/* 16 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t\tvalue: true\n\t});\n\t\n\tvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol ? \"symbol\" : typeof obj; };\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tvar _lodash = __webpack_require__(5);\n\t\n\tvar _lodash2 = _interopRequireDefault(_lodash);\n\t\n\tvar _StringBuffer = __webpack_require__(8);\n\t\n\tvar _StringBuffer2 = _interopRequireDefault(_StringBuffer);\n\t\n\tvar _Cell2 = __webpack_require__(17);\n\t\n\tvar _Cell3 = _interopRequireDefault(_Cell2);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\t\n\tfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\t\n\tvar Node = function (_Cell) {\n\t\t_inherits(Node, _Cell);\n\t\n\t\tfunction Node(graph) {\n\t\t\tvar config = arguments.length <= 1 || arguments[1] === undefined ? {} : arguments[1];\n\t\n\t\t\t_classCallCheck(this, Node);\n\t\n\t\t\tif (!config.id) config.id = _lodash2.default.uniqueId('N');\n\t\n\t\t\tvar _this = _possibleConstructorReturn(this, Object.getPrototypeOf(Node).call(this, graph, config));\n\t\n\t\t\t_this.inEdges = [];\n\t\t\t_this.outEdges = [];\n\t\t\t_this.ports = null;\n\t\t\t_this.parent = null;\n\t\t\treturn _this;\n\t\t}\n\t\n\t\t_createClass(Node, [{\n\t\t\tkey: \"isAncestor\",\n\t\t\tvalue: function isAncestor(n) {\n\t\t\t\t// TODO: should we move this to graph class ?\n\t\t\t\tvar node = n.parent;\n\t\t\t\twhile (node) {\n\t\t\t\t\tif (this == node) {\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t}\n\t\t\t\t\tnode = node.parent;\n\t\t\t\t}\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"removeEdge\",\n\t\t\tvalue: function removeEdge(edge) {\n\t\t\t\tvar edges = edge.source == this ? this.outEdges : this.inEdges;\n\t\t\t\tfor (var i = 0; i < edges.length; i++) {\n\t\t\t\t\tif (edge == edges[i]) {\n\t\t\t\t\t\tedges.splice(i, 1);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\n\t\t\t// Add a new incoming edge\n\t\n\t\t}, {\n\t\t\tkey: \"addInEdge\",\n\t\t\tvalue: function addInEdge(edge, pos) {\n\t\t\t\tif (pos == null || pos === undefined) this.inEdges.push(edge);else this.inEdges.splice(pos, 0, edge);\n\t\t\t}\n\t\n\t\t\t// Add a new outgoing edge\n\t\n\t\t}, {\n\t\t\tkey: \"addOutEdge\",\n\t\t\tvalue: function addOutEdge(edge, pos) {\n\t\t\t\tif (pos == null || pos === undefined || pos > edge.length - 1) this.outEdges.push(edge);else this.outEdges.splice(pos, 0, edge);\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"renderChildren\",\n\t\t\tvalue: function renderChildren(view) {\n\t\t\t\tvar _this2 = this;\n\t\n\t\t\t\tif (this.children) {\n\t\t\t\t\tvar _ret = function () {\n\t\t\t\t\t\tvar buf = new _StringBuffer2.default();\n\t\t\t\t\t\t_lodash2.default.forEach(_this2.children, function (child) {\n\t\t\t\t\t\t\tbuf.append(child.render(view));\n\t\t\t\t\t\t});\n\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\tv: buf.toString()\n\t\t\t\t\t\t};\n\t\t\t\t\t}();\n\t\n\t\t\t\t\tif ((typeof _ret === \"undefined\" ? \"undefined\" : _typeof(_ret)) === \"object\") return _ret.v;\n\t\t\t\t}\n\t\t\t\treturn '';\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"getPort\",\n\t\t\tvalue: function getPort(key) {\n\t\t\t\tvar portName = arguments.length <= 1 || arguments[1] === undefined ? 'auto' : arguments[1];\n\t\t\t\tvar endPt = arguments[2];\n\t\t\t\tvar orthogonal = arguments[3];\n\t\n\t\t\t\tvar shape = this.getShape(key);\n\t\t\t\tif (portName == 'auto') {\n\t\t\t\t\treturn shape.getPerimeter(endPt, orthogonal);\n\t\t\t\t}\n\t\t\t\treturn null;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"toString\",\n\t\t\tvalue: function toString() {\n\t\t\t\tvar label = this.prop(\"label\") ? this.prop(\"label\") : \"undefined\";\n\t\t\t\tif (_lodash2.default.isArray(label)) label = label[0];\n\t\t\t\treturn 'Node:{id:' + this.id + ';label:' + label + ';type:' + this.props.constructor.typeName + '}';\n\t\t\t}\n\t\t}]);\n\t\n\t\treturn Node;\n\t}(_Cell3.default);\n\t\n\tNode.namespace = \"Nodes\";\n\t\n\texports.default = Node;\n\t\n\t/*\n\n\t/**\n\t * The DrillDownParent is the parent that displays the vertex when drilled down.\n\t *\n\tVertex.prototype.getDrillDownParent = function() {\n\t\treturn this.parent;\n\t};\n\n\tVertex.prototype.isLocked = function() {\n\t\tvar mode = this.getProperty(\"mode\") || 3;\n\t\treturn !(mode & Graph.ALLOW_INTERACTIONS);\n\t};\n\n\tVertex.prototype.getCrumbText = function() {\n\t\tif (this.isLocked())\n\t\t\treturn '<span><img src=\"webwb/pzreadonly.png\" /></span><span>&nbsp;' + this.getProperty(\"label\") + '</span>';\n\t\treturn this.getProperty(\"label\");\n\t};\n\n\tVertex.prototype.canEdit = function() {\n\t\treturn (!this.parent || !this.parent.isLocked()) && Vertex.superclass.canEdit.call(this);\n\t};\n\n\tVertex.prototype.isContainer = function() {\n\t\treturn this.getProperty(\"container\");\n\t};\n\n\t*/\n\n/***/ },\n/* 17 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t\tvalue: true\n\t});\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tvar _lodash = __webpack_require__(5);\n\t\n\tvar _lodash2 = _interopRequireDefault(_lodash);\n\t\n\tvar _Utils = __webpack_require__(2);\n\t\n\tvar _Utils2 = _interopRequireDefault(_Utils);\n\t\n\tvar _Cache = __webpack_require__(18);\n\t\n\tvar _Cache2 = _interopRequireDefault(_Cache);\n\t\n\tvar _StringBuffer = __webpack_require__(8);\n\t\n\tvar _StringBuffer2 = _interopRequireDefault(_StringBuffer);\n\t\n\tvar _Shape = __webpack_require__(6);\n\t\n\tvar _Shape2 = _interopRequireDefault(_Shape);\n\t\n\tvar _Rectangle = __webpack_require__(4);\n\t\n\tvar _Rectangle2 = _interopRequireDefault(_Rectangle);\n\t\n\tvar _Label = __webpack_require__(19);\n\t\n\tvar _Label2 = _interopRequireDefault(_Label);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\t/**\n\t * The Cell is the common parent for Node and Edge.\n\t */\n\t\n\tvar Cell = function () {\n\t\tfunction Cell(graph) {\n\t\t\tvar config = arguments.length <= 1 || arguments[1] === undefined ? { id: _lodash2.default.uniqueId() } : arguments[1];\n\t\n\t\t\t_classCallCheck(this, Cell);\n\t\n\t\t\tthis.graph = graph;\n\t\t\tthis.id = config.id;\n\t\t\tdelete config.id;\n\t\n\t\t\t// Initialize decorators\n\t\t\tif (config.decorators) {\n\t\t\t\tthis.createDecorators(config.decorators);\n\t\t\t\tdelete config.decorators;\n\t\t\t}\n\t\n\t\t\t// Initialize View Properties\n\t\t\tif (config.views) {\n\t\t\t\tthis.viewProps = config.views;\n\t\t\t\tdelete config.views;\n\t\t\t}\n\t\n\t\t\t// Initialize type\n\t\t\tvar type = config.type || \"Default\";\n\t\t\ttype = _Utils2.default.type(this.constructor.namespace, type);\n\t\t\tif (!type) throw new Error(\"Type not found \" + config.type);\n\t\t\tdelete config.type;\n\t\t\tthis.props = new type(config);\n\t\t}\n\t\n\t\t_createClass(Cell, [{\n\t\t\tkey: \"prop\",\n\t\t\tvalue: function prop(name, value) {\n\t\t\t\tif (_lodash2.default.isUndefined(value)) return this.props[name];\n\t\t\t\tthis.props[name] = value;\n\t\t\t}\n\t\n\t\t\t/**\n\t   * Get/Set property stored by views.\n\t   * @param key\n\t   * @param name\n\t   * @param value\n\t   * @returns {*}\n\t   */\n\t\n\t\t}, {\n\t\t\tkey: \"viewProp\",\n\t\t\tvalue: function viewProp() {\n\t\t\t\tvar key = arguments.length <= 0 || arguments[0] === undefined ? 'default' : arguments[0];\n\t\t\t\tvar name = arguments[1];\n\t\t\t\tvar value = arguments[2];\n\t\n\t\t\t\tif (_lodash2.default.isUndefined(value)) {\n\t\t\t\t\tif (key == 'default') return this.prop(name, value);\n\t\t\t\t\treturn this.viewProps[key][name];\n\t\t\t\t}\n\t\t\t\tif (key == 'default') {\n\t\t\t\t\tthis.prop(name, value);\n\t\t\t\t} else {\n\t\t\t\t\tif (!this.viewProps[key]) this.viewProps[key] = {};\n\t\t\t\t\tthis.viewProps[key][name] = value;\n\t\t\t\t}\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"createDecorators\",\n\t\t\tvalue: function createDecorators(decorators) {}\n\t\n\t\t\t/**\n\t   * Get properties needed for rendering this element\n\t   * @returns {{key: (string|*), className: *, namespace: *, bounds: *}}\n\t   */\n\t\n\t\t}, {\n\t\t\tkey: \"getView\",\n\t\t\tvalue: function getView(key) {\n\t\t\t\tvar shape = this.getShape(key);\n\t\t\t\treturn _lodash2.default.assign({\n\t\t\t\t\tid: this.id,\n\t\t\t\t\tkey: key,\n\t\t\t\t\tclassName: this.computedClassName,\n\t\t\t\t\tstyle: this.viewProp(key, 'style'),\n\t\t\t\t\tnamespace: this.namespace\n\t\t\t\t}, shape);\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"getShape\",\n\t\t\tvalue: function getShape(key) {\n\t\t\t\tvar shape = _Cache2.default.get(this.id + \".shape\", key);\n\t\t\t\tif (shape) return shape;\n\t\n\t\t\t\tvar shapeConfig = this.viewProp(key, 'shape');\n\t\t\t\tvar shapeClass = shapeConfig ? _Shape2.default.getShape(shapeConfig.name) : _Shape2.default.getShape('Rectangle');\n\t\t\t\tvar x = this.viewProp(key, \"x\");\n\t\t\t\tvar y = this.viewProp(key, \"y\");\n\t\t\t\tvar width = this.viewProp(key, \"width\");\n\t\t\t\tvar height = this.viewProp(key, \"height\");\n\t\t\t\tshape = new shapeClass(x, y, width, height, shapeConfig);\n\t\t\t\t_Cache2.default.set(this.id + '.shape', shape, key);\n\t\t\t\treturn shape;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"render\",\n\t\t\tvalue: function render(view) {\n\t\t\t\tvar template = _Cache2.default.get(this.id + '.template', view.id);\n\t\t\t\tif (!template) {\n\t\t\t\t\t//create the template\n\t\t\t\t\tvar role = this.prop('role');\n\t\t\t\t\ttemplate = view.getTemplate('$' + role, null, this);\n\t\t\t\t\tif (_lodash2.default.isString(template)) template = _lodash2.default.template(template);\n\t\t\t\t\t_Cache2.default.set(this.id + '.template', template, view.id);\n\t\t\t\t}\n\t\t\t\treturn template(this.getView(view.id));\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"renderShape\",\n\t\t\tvalue: function renderShape(view) {\n\t\t\t\tvar shape = this.getShape(view.id);\n\t\t\t\tif (shape) return shape.render(view);\n\t\t\t\treturn '';\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"renderLabel\",\n\t\t\tvalue: function renderLabel(view) {\n\t\t\t\tif (this == this.graph.currentRoot) return null;\n\t\t\t\tvar box = this.getLabelBox(view.id);\n\t\t\t\tif (box) return view.renderLabel(box);\n\t\t\t\treturn '';\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"getLabelBox\",\n\t\t\tvalue: function getLabelBox(key) {\n\t\t\t\tvar box = _Cache2.default.get(this.id + '.labelBox', key);\n\t\t\t\tif (box) return box;\n\t\t\t\tvar shape = this.getShape(key);\n\t\t\t\t// Just get the config will have a positive performance boost for IE11 and IE10.\n\t\t\t\tbox = _Label2.default.getLabelBox(this.prop('label'), this.viewProp(key, 'labelConfig'), shape.width, shape.height);\n\t\t\t\t_Cache2.default.set(this.id + '.labelBox', box, key);\n\t\t\t\treturn box;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"destroy\",\n\t\t\tvalue: function destroy() {\n\t\t\t\tdelete this.graph;\n\t\t\t\tdelete this.decorators;\n\t\t\t\tdelete this.props;\n\t\t\t\tdelete this.viewProps;\n\t\t\t\tthis.destroyed = true;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"computedClassName\",\n\t\t\tget: function get() {\n\t\t\t\tif (!this._computedClassName) {\n\t\t\t\t\tvar buf = new _StringBuffer2.default(this.prop(\"role\"));\n\t\t\t\t\tvar props = this.props;\n\t\t\t\t\tif (props.hasOwnProperty(\"className\")) buf.append(props[\"className\"]);\n\t\t\t\t\tprops = props.constructor.prototype;\n\t\t\t\t\twhile (props) {\n\t\t\t\t\t\tif (props.hasOwnProperty(\"className\")) buf.append(props[\"className\"]);\n\t\t\t\t\t\tprops = Object.getPrototypeOf(props);\n\t\t\t\t\t}\n\t\t\t\t\tthis._computedClassName = buf.toString(' ');\n\t\t\t\t}\n\t\t\t\treturn this._computedClassName;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"namespace\",\n\t\t\tget: function get() {\n\t\t\t\tif (this == this.graph.currentRoot) return '';\n\t\t\t\treturn \"root.\" + this.prop(\"role\");\n\t\t\t}\n\t\t}]);\n\t\n\t\treturn Cell;\n\t}();\n\t\n\t/*\n\t\n\tCell.prototype.move = function(x, y) {\n\t\tthis.setProperty(\"x\", Math.round(x));\n\t\tthis.setProperty(\"y\", Math.round(y));\n\t\tdelete this.bounds;\n\t};\n\t\n\tCell.prototype.resize = function(w, h) {\n\t\tthis.setProperty(\"width\", w);\n\t\tthis.setProperty(\"height\", h);\n\t\tdelete this.bounds;\n\t};\n\t\n\tCell.prototype.canEdit = function() {\n\t\treturn (this.graph ? this.graph.canEdit() : true) && this.getProperty(\"editable\");\n\t};\n\t\n\tCell.prototype.canSelect = function() {\n\t\treturn (this.graph ? this.graph.canSelect() : true) && this.getProperty(\"selectable\");\n\t};\n\t\n\tCell.prototype.canMove = function() {\n\t\treturn (this.graph ? this.graph.canEdit() : true) && this.getProperty(\"draggable\");\n\t};\n\t\n\tCell.prototype.canResize = function() {\n\t\treturn (this.graph ? this.graph.canEdit() : true) && this.getProperty(\"resizable\");\n\t};\n\t\n\tCell.prototype.getTypeFromString = function(typeStr) {\n\t\treturn this.graph.getType(typeStr);\n\t};\n\t\n\tCell.prototype.createModifiers = function(modifiers) {\n\t\tthis.modifiers = null;\n\t\tvar modifierSettings = this.getProperty(\"modifierSettings\");\n\t\tif (modifierSettings) {\n\t\t\t_.each(modifiers, function(config) {\n\t\t\t\tconfig.type = this.graph.getModifierType(config.className);\n\t\t\t\tconfig.setting = modifierSettings[config.className];\n\t\t\t\tif (!config.type || !config.setting) return;\n\t\n\t\t\t\tthis.addModifier(config.className, new Modifier(this, config));\n\t\t\t}, this);\n\t\n\t\t\t// Check for showAlways settings\n\t\t\t_.each(modifierSettings, function(setting, name) {\n\t\t\t\tif (setting.showAlways && (!this.modifiers || !this.modifiers[name])) {\n\t\t\t\t\tvar config = {type: this.graph.getModifierType(name), setting: setting};\n\t\t\t\t\tif (!config.type) return;\n\t\t\t\t\tthis.addModifier(name, new Modifier(this, config));\n\t\t\t\t}\n\t\t\t}, this);\n\t\t}\n\t};\n\t\n\tCell.prototype.addModifier = function(name, modifier) {\n\t\tif (!this.modifiers)\n\t\t\tthis.modifiers = {};\n\t\n\t\tif (!modifier.hasOwnProperty(\"showHeader\"))\n\t\t\tmodifier.showHeader = true;\n\t\n\t\t// @hack preferably set it in configurations.\n\t\tif (modifier.name == \"HoverProcessModifier\" || modifier.name == \"HoverResults\")\n\t\t\tmodifier.showHeader = false;\n\t\n\t\tthis.modifiers[name] = modifier;\n\t};\n\t\n\tCell.prototype.getModifiers = function() {\n\t\tif (_.isUndefined(this.modifiers))\n\t\t\tthis.createModifiers();\n\t\treturn this.modifiers;\n\t};\n\t\n\tCell.prototype.getModifier = function(name) {\n\t\tvar modifiers = this.getModifiers();\n\t\tif (modifiers)\n\t\t\treturn modifiers[name];\n\t\treturn null;\n\t};\n\t\n\tCell.prototype.isVisible = function() {\n\t\treturn this.getProperty('visible');\n\t};\n\t\n\tCell.prototype.isContainer = function() {\n\t\treturn false;\n\t};\n\t*/\n\t\n\t\n\texports.default = Cell;\n\n/***/ },\n/* 18 */\n/***/ function(module, exports) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t\tvalue: true\n\t});\n\t/**\n\t * Created by tong on 6/7/2016.\n\t */\n\t\n\tvar caches = {};\n\t\n\tvar Cache = {\n\t\tget: function get(key, namespace) {\n\t\t\treturn this.getCache(namespace)[key];\n\t\t},\n\t\n\t\tset: function set(key, value, namespace) {\n\t\t\tthis.getCache(namespace)[key] = value;\n\t\t},\n\t\n\t\tcontains: function contains(key, namespace) {\n\t\t\treturn key in this.getCache(namespace);\n\t\t},\n\t\n\t\tremove: function remove(key, namespace) {\n\t\t\tdelete this.getCache(namespace)[key];\n\t\t},\n\t\n\t\tclear: function clear(namesapce) {\n\t\t\tif (!namespace) caches = {};else if (caches[namespace]) caches[namespace] = {};\n\t\t},\n\t\n\t\tgetCache: function getCache() {\n\t\t\tvar namespace = arguments.length <= 0 || arguments[0] === undefined ? 'default' : arguments[0];\n\t\n\t\t\tif (!caches[namespace]) caches[namespace] = {};\n\t\t\treturn caches[namespace];\n\t\t}\n\t};\n\t\n\texports.default = Cache;\n\n/***/ },\n/* 19 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t\tvalue: true\n\t});\n\t\n\tvar _lodash = __webpack_require__(5);\n\t\n\tvar _lodash2 = _interopRequireDefault(_lodash);\n\t\n\tvar _bean = __webpack_require__(12);\n\t\n\tvar _bean2 = _interopRequireDefault(_bean);\n\t\n\tvar _Utils = __webpack_require__(2);\n\t\n\tvar _Utils2 = _interopRequireDefault(_Utils);\n\t\n\tvar _DomUtils = __webpack_require__(7);\n\t\n\tvar _DomUtils2 = _interopRequireDefault(_DomUtils);\n\t\n\tvar _StringBuffer = __webpack_require__(8);\n\t\n\tvar _StringBuffer2 = _interopRequireDefault(_StringBuffer);\n\t\n\tvar _Rectangle = __webpack_require__(4);\n\t\n\tvar _Rectangle2 = _interopRequireDefault(_Rectangle);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tvar FONT_BOLD = 1,\n\t    FONT_ITALIC = 2,\n\t    FONT_UNDERLINE = 4,\n\t    FONT_SHADOW = 8;\n\t\n\tvar defaultConfig = {\n\t\tfontSize: 11,\n\t\tfontFamily: \"Arial\",\n\t\tfontStyle: 0,\n\t\tfontColor: 'black',\n\t\tpadding: 0,\n\t\tlinePadding: 0,\n\t\talign: \"left\",\n\t\twidth: 0,\n\t\theight: 0,\n\t\trotation: null,\n\t\tgeometry: { x: 0, y: 0, anchorY: 0, offsetX: 0, offsetY: 0 }\n\t};\n\t\n\t/**\n\t * The label object handles label sizing/positioning\n\t */\n\t\n\texports.default = function () {\n\t\tvar stringMeasureEl = null,\n\t\t    measureDiv = void 0,\n\t\t    baselineDiv = void 0;\n\t\n\t\t/**\n\t  * Calculate the size of the string.\n\t  */\n\t\tvar getStringSize = _lodash2.default.memoize(function (str, fontSize, fontFamily, bold) {\n\t\t\tfontSize = fontSize || 11;\n\t\t\tfontFamily = fontFamily || 'Arial,Helvetica';\n\t\t\tbold = !_lodash2.default.isUndefined(bold) ? bold : false;\n\t\n\t\t\t// first check if there is a string-measuring div available, if not, create now.\n\t\t\tif (!stringMeasureEl) {\n\t\t\t\tstringMeasureEl = _DomUtils2.default.createElement('iframe', { id: \"_ComputeStylesIframe\" }, { position: \"absolute\", visibility: \"hidden\", width: \"auto\" });\n\t\t\t\tdocument.body.appendChild(stringMeasureEl);\n\t\t\t\tvar doc = stringMeasureEl.contentWindow.document;\n\t\t\t\tdoc.open();\n\t\t\t\tdoc.write('<html><body>\\\n\t\t\t\t\t<div id=\"baselineDiv\" style=\"height:100px;\"><span style=\"line-height:0\">T</span><span style=\"height:100%;display:inline-block;\"></span></div>\\\n\t\t\t\t\t<div id=\"measureDiv\" style=\"position:absolute;width:auto;height:auto;padding:0;white-space:pre-wrap;word-wrap:break-word;display:inline-block;\"></div>\\\n\t\t\t\t\t</body></html>');\n\t\t\t\tdoc.close();\n\t\t\t\tmeasureDiv = doc.getElementById(\"measureDiv\");\n\t\t\t\tbaselineDiv = doc.getElementById(\"baselineDiv\");\n\t\t\t}\n\t\t\tbaselineDiv.style.fontSize = measureDiv.style.fontSize = fontSize;\n\t\t\tbaselineDiv.style.fontFamily = measureDiv.style.fontFamily = fontFamily;\n\t\t\tbaselineDiv.style.fontWeight = measureDiv.style.fontWeight = bold ? 'bold' : 'normal';\n\t\t\tmeasureDiv.innerHTML = str;\n\t\n\t\t\tvar strut = baselineDiv.firstChild;\n\t\t\tvar baselineHeight = strut.offsetTop + strut.offsetHeight - baselineDiv.offsetHeight - baselineDiv.offsetTop;\n\t\n\t\t\treturn { width: measureDiv.offsetWidth, height: measureDiv.offsetHeight, baseline: baselineHeight };\n\t\t}, function (str, fontSize, fontFamily, bold) {\n\t\t\treturn str + ';' + fontSize + ';' + fontFamily + ';' + bold;\n\t\t});\n\t\n\t\t/**\n\t  * Create a wrapped text.\n\t  * @param {String} string the string to wrap.\n\t  * @param {maxWidth} the maximum width this string can take.\n\t  * @param {fontSize}\n\t  * @param {fontFamily}\n\t  * @param {bold}\n\t  */\n\t\tvar wrap = _lodash2.default.memoize(function (string, maxWidth, fontSize, fontFamily, bold) {\n\t\t\tmaxWidth = maxWidth || 0;\n\t\t\tfontSize = fontSize || 11;\n\t\t\tfontFamily = fontFamily || 'Arial,Helvetica';\n\t\t\tbold = !_lodash2.default.isUndefined(bold) ? bold : false;\n\t\n\t\t\tvar arr = [];\n\t\t\tvar spaceSize = getStringSize(\"&nbsp;\", fontSize, fontFamily, bold),\n\t\t\t    space = spaceSize.width;\n\t\t\tarr.lineHeight = spaceSize.height;\n\t\t\tarr.baseline = spaceSize.baseline;\n\t\n\t\t\tif (!maxWidth || !string || string == \"\") {\n\t\t\t\tarr.push(string);\n\t\t\t\tarr.width = !string || string == \"\" ? space : getStringSize(string, fontSize, fontFamily, bold).width;\n\t\t\t\tarr.height = arr.lineHeight;\n\t\t\t\treturn arr;\n\t\t\t}\n\t\n\t\t\tvar width = 0;\n\t\t\t//split the text by lines\n\t\t\tvar lines = string.split('\\n');\n\t\n\t\t\tvar buf = new _StringBuffer2.default();\n\t\n\t\t\tfor (var j = 0; j < lines.length; j++) {\n\t\t\t\t//split each line by word\n\t\t\t\tvar words = lines[j].split(/\\s/);\n\t\t\t\tvar line = \"\",\n\t\t\t\t    currentWidth = 0,\n\t\t\t\t    wordWidth = 0,\n\t\t\t\t    newLine = true,\n\t\t\t\t    word;\n\t\n\t\t\t\tfor (var i = 0; i < words.length; i++) {\n\t\t\t\t\tword = words[i];\n\t\t\t\t\twordWidth = getStringSize(word, fontSize, fontFamily, bold).width;\n\t\n\t\t\t\t\tif ((newLine ? wordWidth : currentWidth + space + wordWidth) > maxWidth) {\n\t\t\t\t\t\tif (newLine) {\n\t\t\t\t\t\t\tbuf.append(word);\n\t\t\t\t\t\t\twidth = Math.max(width, wordWidth);\n\t\t\t\t\t\t\tif (i < words.length - 1) {\n\t\t\t\t\t\t\t\tarr.push(buf.toString());\n\t\t\t\t\t\t\t\tbuf.clear();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tarr.push(buf.append(line).toString());\n\t\t\t\t\t\t\twidth = Math.max(width, currentWidth + space + wordWidth);\n\t\t\t\t\t\t\tbuf.clear();\n\t\t\t\t\t\t}\n\t\t\t\t\t\tline = \"\";\n\t\t\t\t\t\tcurrentWidth = 0;\n\t\t\t\t\t\tif (!newLine) i--; // move back one word.\n\t\t\t\t\t\tnewLine = true;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tline = newLine ? word : line + \" \" + word;\n\t\t\t\t\t\tcurrentWidth = newLine ? wordWidth : currentWidth + space + wordWidth;\n\t\t\t\t\t\twidth = Math.max(width, currentWidth);\n\t\t\t\t\t\tnewLine = false;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (line != \"\") buf.append(line);\n\t\t\t\tif (j < lines.length - 1) {\n\t\t\t\t\tarr.push(buf.toString());\n\t\t\t\t\tbuf.clear();\n\t\t\t\t}\n\t\t\t}\n\t\n\t\t\tarr.push(buf.toString());\n\t\t\tarr.width = width;\n\t\t\tarr.height = arr.lineHeight * arr.length;\n\t\t\treturn arr;\n\t\t}, function (str, maxWidth, fontSize, fontFamily, bold) {\n\t\t\treturn str + ';' + maxWidth + ';' + fontSize + ';' + fontFamily + ';' + bold;\n\t\t});\n\t\n\t\t/**\n\t  *  Get the view information for how to display the label.\n\t  * @param label The string that needs to be displayed\n\t  * @param containerWidth The width of the parent container.\n\t  * @param containerHeight The height of the parent container.\n\t  * @param labelConfig The configuration on how to display label. It should be an object with the following parameters:\n\t  * {\n\t  *      fontSize, fontFamily, fontStyle, padding,\n\t  *      align: can be either \"left\", \"center\" or \"right\",\n\t  *      width: the maximum width of the label. if less than 1, then is treated as percentage. If 0, no wrapping will occur,\n\t  *      height,\n\t  *      geometry\n\t  * }\n\t  * @returns {*}\n\t  */\n\t\tfunction getLabelBox(label, labelConfig, containerWidth, containerHeight) {\n\t\t\treturn _getLabelBox.call(this, label, labelConfig, { width: containerWidth, height: containerHeight });\n\t\t}\n\t\n\t\tfunction getLabelBoxForLink(label, labelConfig, link) {\n\t\t\treturn _getLabelBox.call(this, label, labelConfig, link);\n\t\t}\n\t\n\t\tfunction _getLabelBox(label) {\n\t\t\tvar labelConfig = arguments.length <= 1 || arguments[1] === undefined ? {} : arguments[1];\n\t\t\tvar context = arguments[2];\n\t\n\t\t\tlabelConfig = _lodash2.default.defaultsDeep(labelConfig, defaultConfig);\n\t\t\tvar fontSize = labelConfig.fontSize;\n\t\t\tvar fontFamily = labelConfig.fontFamily;\n\t\t\tvar fontStyle = labelConfig.fontStyle;\n\t\t\tvar bold = (fontStyle & FONT_BOLD) == FONT_BOLD;\n\t\t\tvar padding = labelConfig.padding;\n\t\t\tvar linePadding = labelConfig.linePadding;\n\t\t\tvar align = labelConfig.align;\n\t\n\t\t\tvar w = labelConfig.width,\n\t\t\t    h = labelConfig.height;\n\t\t\tif (context.width) {\n\t\t\t\tw = w <= 5 ? context.width * w : w;\n\t\t\t\th = h <= 5 ? context.height * h : h;\n\t\t\t}\n\t\t\tw -= 2 * padding;\n\t\t\th -= 2 * padding;\n\t\t\tw = Math.max(0, w);\n\t\t\th = Math.max(0, h);\n\t\n\t\t\tvar geometry = _lodash2.default.clone(labelConfig.geometry);\n\t\t\tvar wrappedLabel = this.wrap(label, w, fontSize, fontFamily, bold);\n\t\t\tgeometry.width = wrappedLabel.width + 2 * padding;\n\t\t\tgeometry.height = wrappedLabel.height + 2 * padding + (wrappedLabel.length - 1) * linePadding;\n\t\t\tvar anchor = \"start\",\n\t\t\t    dx = 0,\n\t\t\t    setAnchorX = !_lodash2.default.has(geometry, \"anchorX\");\n\t\t\tswitch (align) {\n\t\t\t\tcase \"center\":\n\t\t\t\t\tanchor = \"middle\";\n\t\t\t\t\tif (setAnchorX) geometry.anchorX = 0;\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"right\":\n\t\t\t\t\tanchor = \"end\";\n\t\t\t\t\tdx = wrappedLabel.width / 2;\n\t\t\t\t\tif (setAnchorX) geometry.anchorX = -0.5;\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"left\":\n\t\t\t\t\tdx = -wrappedLabel.width / 2;\n\t\t\t\t\tif (setAnchorX) geometry.anchorX = 0.5;\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t\tvar pos = void 0;\n\t\t\tif (context.getRelativePosition) pos = context.getRelativePosition(geometry);else pos = _Utils2.default.getRelativePosition({ width: context.width, height: context.height }, geometry);\n\t\n\t\t\tvar bounds = new _Rectangle2.default(pos[0], pos[1], geometry.width, geometry.height);\n\t\t\t// the pivot is the center of rotation when the label has a rotation specified.\n\t\t\tvar pivot = align == 'center' ? [0, 0] : align == 'left' ? [-wrappedLabel.width / 2, 0] : [wrappedLabel.width / 2, 0];\n\t\n\t\t\t// the maximum bounds for the label, used to position inline editor\n\t\t\tgeometry.width = Math.max(w + 2 * padding, geometry.width);\n\t\t\tgeometry.height = Math.max(h + 2 * padding, geometry.height);\n\t\n\t\t\tif (context.getRelativePosition) pos = context.getRelativePosition(geometry);else pos = _Utils2.default.getRelativePosition({ width: context.width, height: context.height }, geometry);\n\t\n\t\t\tvar maxBounds = new _Rectangle2.default(pos[0], pos[1], geometry.width, geometry.height);\n\t\t\treturn {\n\t\t\t\tconfig: labelConfig, label: wrappedLabel, _label: label,\n\t\t\t\tbold: bold, underline: fontStyle & FONT_UNDERLINE, italic: fontStyle & FONT_ITALIC, shadow: fontStyle & FONT_SHADOW,\n\t\t\t\tdx: dx, dy: -geometry.height / 2 + padding + wrappedLabel.lineHeight - wrappedLabel.baseline, anchor: anchor, lineHeight: wrappedLabel.lineHeight + linePadding,\n\t\t\t\tpivot: pivot, bounds: bounds, maxBounds: maxBounds\n\t\t\t};\n\t\t}\n\t\n\t\tfunction render(view, box) {\n\t\t\treturn view.renderLabel(box);\n\t\t}\n\t\n\t\tvar editor = {\n\t\t\tstart: function start(key, container, box, refEl, textEl) {\n\t\t\t\tvar _this = this;\n\t\n\t\t\t\tvar scale = arguments.length <= 5 || arguments[5] === undefined ? 1.0 : arguments[5];\n\t\t\t\tvar singleLine = arguments.length <= 6 || arguments[6] === undefined ? true : arguments[6];\n\t\n\t\t\t\tif (this.input) {\n\t\t\t\t\tif (this.key != key) {\n\t\t\t\t\t\t// need to close the existing editor first\n\t\t\t\t\t\tthis.stop();\n\t\t\t\t\t} else return;\n\t\t\t\t}\n\t\t\t\tvar tag = singleLine ? 'input' : 'textarea';\n\t\t\t\tthis.input = _DomUtils2.default.createElement(tag, { id: \"inlineEditor\", unselectable: \"off\" }, { position: \"absolute\", overflow: \"hidden\", padding: \"0px\", margin: \"0px\", border: \"transparent\" });\n\t\t\t\tif (singleLine) {\n\t\t\t\t\t_bean2.default.on(this.input, 'keydown keyup', function (event) {\n\t\t\t\t\t\tif (event.keyCode == 13) {\n\t\t\t\t\t\t\t_bean2.default.off(_this.input, 'keydown keyup');\n\t\t\t\t\t\t\t_this.stop();\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\tcontainer.appendChild(this.input);\n\t\n\t\t\t\tthis.key = key;\n\t\t\t\tthis.box = box;\n\t\t\t\tthis.refEl = refEl;\n\t\t\t\tthis.textEl = textEl;\n\t\n\t\t\t\tvar labelConfig = box.config;\n\t\t\t\tvar maxBounds = new _Rectangle2.default(box.maxBounds.x, box.maxBounds.y, box.maxBounds.width * scale, box.maxBounds.height * scale);\n\t\t\t\tvar pos = _DomUtils2.default.getCenterPosition(refEl, container);\n\t\t\t\tpos = [pos[0] + maxBounds.left, pos[1] + maxBounds.top];\n\t\n\t\t\t\tif (textEl) textEl.style.visibility = 'hidden';\n\t\n\t\t\t\t_DomUtils2.default.setElement(this.input, null, {\n\t\t\t\t\tvisibility: 'visible',\n\t\t\t\t\tleft: pos[0] + \"px\",\n\t\t\t\t\ttop: pos[1] + \"px\",\n\t\t\t\t\twidth: maxBounds.width + 'px',\n\t\t\t\t\theight: maxBounds.height + 'px',\n\t\t\t\t\t\"font-family\": labelConfig.fontFamily,\n\t\t\t\t\t\"font-size\": labelConfig.fontSize * scale + 'px',\n\t\t\t\t\t\"font-weight\": (labelConfig.fontStyle & FONT_BOLD) == FONT_BOLD ? 'bold' : 'normal'\n\t\t\t\t\t/*\"color\": labelConfig.fontColor*/\n\t\t\t\t});\n\t\n\t\t\t\tthis.input.value = box._label;\n\t\t\t\tthis.input.focus();\n\t\t\t\tthis.input.select();\n\t\t\t\t_bean2.default.fire(this, 'editor.start', [this.key]);\n\t\t\t},\n\t\n\t\t\tstop: function stop(cancel) {\n\t\t\t\tif (!this.input) return;\n\t\n\t\t\t\tcancel = cancel || false;\n\t\t\t\tif (this.textEl) this.textEl.style.visibility = null;\n\t\n\t\t\t\tif (!cancel) _bean2.default.fire(this, 'editor.update', [this.key, this.input.value]);\n\t\n\t\t\t\t_bean2.default.fire(this, 'editor.stop', [this.key]);\n\t\n\t\t\t\t// remove the input\n\t\t\t\tthis.input.parentNode.removeChild(this.input);\n\t\t\t\tdelete this.input;\n\t\t\t\tdelete this.key;\n\t\t\t\tdelete this.box;\n\t\t\t\tdelete this.refEl;\n\t\t\t\tdelete this.textEl;\n\t\t\t}\n\t\t};\n\t\n\t\treturn {\n\t\t\tFONT_BOLD: FONT_BOLD,\n\t\t\tFONT_ITALIC: FONT_ITALIC,\n\t\t\tFONT_UNDERLINE: FONT_UNDERLINE,\n\t\t\tFONT_SHADOW: FONT_SHADOW,\n\t\t\tgetStringSize: getStringSize,\n\t\t\twrap: wrap,\n\t\t\tgetLabelBox: getLabelBox,\n\t\t\tgetLabelBoxForLink: getLabelBoxForLink,\n\t\t\trender: render,\n\t\t\teditor: editor\n\t\t};\n\t}();\n\n/***/ },\n/* 20 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t\tvalue: true\n\t});\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tvar _get = function get(object, property, receiver) { if (object === null) object = Function.prototype; var desc = Object.getOwnPropertyDescriptor(object, property); if (desc === undefined) { var parent = Object.getPrototypeOf(object); if (parent === null) { return undefined; } else { return get(parent, property, receiver); } } else if (\"value\" in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } };\n\t\n\tvar _lodash = __webpack_require__(5);\n\t\n\tvar _lodash2 = _interopRequireDefault(_lodash);\n\t\n\tvar _Cell2 = __webpack_require__(17);\n\t\n\tvar _Cell3 = _interopRequireDefault(_Cell2);\n\t\n\tvar _Rectangle = __webpack_require__(4);\n\t\n\tvar _Rectangle2 = _interopRequireDefault(_Rectangle);\n\t\n\tvar _Link = __webpack_require__(11);\n\t\n\tvar _Link2 = _interopRequireDefault(_Link);\n\t\n\tvar _Label = __webpack_require__(19);\n\t\n\tvar _Label2 = _interopRequireDefault(_Label);\n\t\n\tvar _Cache = __webpack_require__(18);\n\t\n\tvar _Cache2 = _interopRequireDefault(_Cache);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\t\n\tfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\t\n\tvar Edge = function (_Cell) {\n\t\t_inherits(Edge, _Cell);\n\t\n\t\tfunction Edge(graph) {\n\t\t\tvar config = arguments.length <= 1 || arguments[1] === undefined ? {} : arguments[1];\n\t\t\tvar source = arguments[2];\n\t\t\tvar target = arguments[3];\n\t\n\t\t\t_classCallCheck(this, Edge);\n\t\n\t\t\tif (!config.id) config.id = _lodash2.default.uniqueId('E');\n\t\n\t\t\tvar _this = _possibleConstructorReturn(this, Object.getPrototypeOf(Edge).call(this, graph, config));\n\t\n\t\t\t_this.source = _this.target = null;\n\t\t\t_this.setSource(source, config.sourcePos);\n\t\t\t_this.setTarget(target, config.targetPos);\n\t\t\treturn _this;\n\t\t}\n\t\n\t\t_createClass(Edge, [{\n\t\t\tkey: \"setSource\",\n\t\t\tvalue: function setSource(node, pos) {\n\t\t\t\tthis.setTerminal(node, pos, 'source');\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"setTarget\",\n\t\t\tvalue: function setTarget(node, pos) {\n\t\t\t\tthis.setTerminal(node, pos, 'target');\n\t\t\t}\n\t\n\t\t\t/**\n\t   * Internal methods to set either the source or target\n\t   */\n\t\n\t\t}, {\n\t\t\tkey: \"setTerminal\",\n\t\t\tvalue: function setTerminal(node, pos, dir) {\n\t\t\t\tvar end = dir == 'source' ? this.source : this.target;\n\t\t\t\tif (end == node) {\n\t\t\t\t\t// simply change the position of the edge.\n\t\t\t\t\tif (node) node.setEdgeAt(this, pos);\n\t\t\t\t} else {\n\t\t\t\t\tif (end) {\n\t\t\t\t\t\t// first remove the edge from the current end\n\t\t\t\t\t\tend.removeEdge(this);\n\t\t\t\t\t}\n\t\n\t\t\t\t\tif (node) {\n\t\t\t\t\t\tif (dir == 'source') node.addOutEdge(this, pos);else node.addInEdge(this, pos);\n\t\t\t\t\t}\n\t\t\t\t\tif (dir == 'source') this.source = node;else this.target = node;\n\t\t\t\t\t//this.clearPoints();\n\t\t\t\t}\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"getLabelBox\",\n\t\t\tvalue: function getLabelBox(key) {\n\t\t\t\tvar label = this.prop('label');\n\t\t\t\tif (label) return _Label2.default.getLabelBoxForLink(label, this.viewProp(key, 'labelConfig'), this.getShape(key));\n\t\t\t\treturn null;\n\t\t\t}\n\t\n\t\t\t/**\n\t   * Return a pair of points as reference to the calculation of start and end points.\n\t   */\n\t\n\t\t}, {\n\t\t\tkey: \"getReferencePoints\",\n\t\t\tvalue: function getReferencePoints(key) {\n\t\t\t\tvar pts = [];\n\t\t\t\tif (this.source) pts.push(this.source.getShape(key).center);else pts.push(this.viewProp(key, 'start'));\n\t\n\t\t\t\tif (this.target) pts.push(this.target.getShape(key).center);else pts.push(this.viewProp(key, 'end'));\n\t\n\t\t\t\treturn pts;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"getTerminalVisual\",\n\t\t\tvalue: function getTerminalVisual(key, orthogonal) {\n\t\t\t\tvar refPts = this.getReferencePoints(key);\n\t\t\t\tvar terminals = [];\n\t\n\t\t\t\tvar getBound = function getBound(pt) {\n\t\t\t\t\treturn new _Rectangle2.default(pt.x, pt.y, 3, 3);\n\t\t\t\t};\n\t\n\t\t\t\tif (this.source) {\n\t\t\t\t\tterminals.push(this.source.getPort(key, this.prop('sourcePort'), refPts[1], orthogonal));\n\t\t\t\t} else terminals.push({ point: refPts[0], direction: _Rectangle2.default.getDirection(getBound(refPts[0]), refPts[1], true) });\n\t\n\t\t\t\tif (this.target) {\n\t\t\t\t\tterminals.push(this.target.getPort(key, this.prop('targetPort'), refPts[0], orthogonal));\n\t\t\t\t} else terminals.push({ point: refPts[1], direction: _Rectangle2.default.getDirection(getBound(refPts[1]), refPts[0], true) });\n\t\t\t\treturn terminals;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"getShape\",\n\t\t\tvalue: function getShape(key) {\n\t\t\t\tvar shape = _Cache2.default.get(this.id + \".shape\", key);\n\t\t\t\tif (shape) return shape;\n\t\n\t\t\t\tvar config = this.viewProp(key, 'shape');\n\t\t\t\tshape = _Link2.default.getLink(this.getTerminalVisual(key, config.orthogonal), config, this.prop('startMarker'), this.prop('endMarker'));\n\t\t\t\t_Cache2.default.set(this.id + '.shape', shape, key);\n\t\t\t\treturn shape;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"toString\",\n\t\t\tvalue: function toString() {\n\t\t\t\treturn 'Edge:{' + (!this.source ? 'null' : this.source.id) + '--' + (!this.target ? 'null' : this.target.id) + '}';\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"destroy\",\n\t\t\tvalue: function destroy() {\n\t\t\t\t_get(Object.getPrototypeOf(Edge.prototype), \"destroy\", this).call(this);\n\t\t\t\tthis.setSource(null);\n\t\t\t\tthis.setTarget(null);\n\t\t\t}\n\t\t}]);\n\t\n\t\treturn Edge;\n\t}(_Cell3.default);\n\t\n\tEdge.namespace = \"Edges\";\n\t\n\texports.default = Edge;\n\t\n\t/*\n\n\tEdge.prototype.isVisible = function() {\n\t\tif (this.graph.getProperty(\"allowDanglingEdges\")) {\n\t\t\treturn (this.source ? this.source.isVisible() : true) && (this.target ? this.target.isVisible() : true) && this.getProperty(\"visible\");\n\t\t} else\n\t\t\treturn this.source && this.target && this.getProperty('visible') && this.source.isVisible() && this.target.isVisible();\n\t};\n\n\t*/\n\n/***/ },\n/* 21 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t\tvalue: true\n\t});\n\t\n\tvar _Rectangle = __webpack_require__(4);\n\t\n\tvar _Rectangle2 = _interopRequireDefault(_Rectangle);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tvar registry = {};\n\t\n\tvar Marker = function () {\n\t\n\t\t/** Begin Standard Marker Type **/\n\t\tfunction arrow(size, source, styles) {\n\t\t\tvar sign = source ? -1 : 1;\n\t\t\tvar marker = {\n\t\t\t\tviewBox: new _Rectangle2.default(-5, -5, 10, 10),\n\t\t\t\tsize: size,\n\t\t\t\tref: [4 * sign, 0],\n\t\t\t\tfill: styles.color\n\t\t\t};\n\t\t\tmarker.shape = {\n\t\t\t\tname: 'Polygon',\n\t\t\t\tpoints: [[-2 * sign, 0], [-4 * sign, 4], [4 * sign, 0], [-4 * sign, -4]]\n\t\t\t};\n\t\t\treturn marker;\n\t\t}\n\t\n\t\tfunction triangle(size, source, styles) {\n\t\t\tvar sign = source ? -1 : 1;\n\t\t\tvar marker = {\n\t\t\t\tviewBox: new _Rectangle2.default(-5, -5, 10, 10),\n\t\t\t\tsize: size,\n\t\t\t\tref: [4 * sign, 0],\n\t\t\t\tfill: styles.color\n\t\t\t};\n\t\t\tmarker.shape = {\n\t\t\t\tname: 'Polygon',\n\t\t\t\tpoints: [[-5 * sign, -5], [-5 * sign, 5], [4 * sign, 0]]\n\t\t\t};\n\t\t\treturn marker;\n\t\t}\n\t\n\t\tfunction oval(size, source, styles) {\n\t\t\tvar r = size / 2;\n\t\t\tvar marker = {\n\t\t\t\tviewBox: new _Rectangle2.default(-r, -r, size, size),\n\t\t\t\tsize: size,\n\t\t\t\tref: [0, 0],\n\t\t\t\tfill: styles.color\n\t\t\t};\n\t\t\tmarker.shape = '<ellipse cx=\"0\" cy=\"0\" rx=\"' + r + '\" ry=\"' + r + '\"></ellipse>';\n\t\t\treturn marker;\n\t\t}\n\t\n\t\tfunction diamond(size, source, styles) {\n\t\t\tvar sign = source ? -1 : 1;\n\t\t\tvar marker = {\n\t\t\t\tviewBox: new _Rectangle2.default(-5, -5, 10, 10),\n\t\t\t\tsize: size,\n\t\t\t\tref: [4 * sign, 0],\n\t\t\t\tfill: styles.color\n\t\t\t};\n\t\t\tmarker.shape = '';\n\t\t\treturn marker;\n\t\t}\n\t\t/** End Standard Marker Type **/\n\t\tfunction getMarker(config, source) {\n\t\t\tvar factory = registry[config.type];\n\t\t\tvar marker = factory(config.size, source, config);\n\t\t\tmarker.id = config.id;\n\t\t\treturn marker;\n\t\t}\n\t\n\t\tregistry['arrow'] = arrow;\n\t\tregistry['triangle'] = triangle;\n\t\tregistry['oval'] = oval;\n\t\tregistry['diamond'] = diamond;\n\t\n\t\treturn {\n\t\t\tregistry: registry,\n\t\t\tgetMarker: getMarker\n\t\t};\n\t}();\n\t\n\texports.default = Marker;\n\n/***/ },\n/* 22 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t\tvalue: true\n\t});\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tvar _lodash = __webpack_require__(5);\n\t\n\tvar _lodash2 = _interopRequireDefault(_lodash);\n\t\n\tvar _Utils = __webpack_require__(2);\n\t\n\tvar _Utils2 = _interopRequireDefault(_Utils);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tvar Layout = function () {\n\t\tfunction Layout() {\n\t\t\tvar config = arguments.length <= 0 || arguments[0] === undefined ? {} : arguments[0];\n\t\n\t\t\t_classCallCheck(this, Layout);\n\t\n\t\t\tif (config.hasOwnProperty(\"orientation\") && _lodash2.default.isString(config.orientation)) {\n\t\t\t\tif (config.orientation.toUpperCase() == \"HORIZONTAL\") config.orientation = Layout.HORIZONTAL;else delete config.orientation;\n\t\t\t}\n\t\t\t_Utils2.default.initConfig(this, config);\n\t\t}\n\t\n\t\t_createClass(Layout, [{\n\t\t\tkey: \"layout\",\n\t\t\tvalue: function layout(root, bounds) {}\n\t\t}, {\n\t\t\tkey: \"reset\",\n\t\t\tvalue: function reset() {}\n\t\t}, {\n\t\t\tkey: \"destroy\",\n\t\t\tvalue: function destroy() {}\n\t\t}]);\n\t\n\t\treturn Layout;\n\t}();\n\t\n\tLayout.VERTICAL = 0;\n\tLayout.HORIZONTAL = 1;\n\t\n\tLayout.DEFAULTS = {\n\t\torientation: Layout.VERTICAL\n\t};\n\t\n\texports.default = Layout;\n\n/***/ },\n/* 23 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t\tvalue: true\n\t});\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tvar _Layout2 = __webpack_require__(22);\n\t\n\tvar _Layout3 = _interopRequireDefault(_Layout2);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\t\n\tfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\t\n\tvar FlowLayout = function (_Layout) {\n\t\t_inherits(FlowLayout, _Layout);\n\t\n\t\tfunction FlowLayout() {\n\t\t\t_classCallCheck(this, FlowLayout);\n\t\n\t\t\treturn _possibleConstructorReturn(this, Object.getPrototypeOf(FlowLayout).apply(this, arguments));\n\t\t}\n\t\n\t\t_createClass(FlowLayout, [{\n\t\t\tkey: \"layout\",\n\t\t\tvalue: function layout(root, bounds) {\n\t\t\t\tvar items;\n\t\t\t\tif (!root) items = this.owner.childNodes;else if (_.isArray(root)) items = root;else items = root.getLinkedNodes('target');\n\t\t\t\tif (!items || items.length == 0) return;\n\t\n\t\t\t\tvar x = 0,\n\t\t\t\t    y = 0,\n\t\t\t\t    h = 0,\n\t\t\t\t    node;\n\t\t\t\tvar p1 = 0,\n\t\t\t\t    p2 = 0;\n\t\t\t\tfor (var i = 0; i < items.length; i++) {\n\t\t\t\t\tnode = items[i];\n\t\t\t\t\tif (x > 0 && x + this.hgap + node.getProperty(\"width\") > bounds.width) {\n\t\t\t\t\t\t// create new line\n\t\t\t\t\t\ty += h + this.vgap;\n\t\t\t\t\t\tx = 0;h = 0;p1 = 0;p2++;\n\t\t\t\t\t}\n\t\t\t\t\tnode._flPos = [p1, p2];\n\t\t\t\t\tnode.moveTo([bounds.x + x, bounds.y + y]);\n\t\t\t\t\tx += this.hgap + node.getProperty(\"width\");\n\t\t\t\t\tp1++;\n\t\t\t\t\th = h < node.getProperty(\"height\") ? node.getProperty(\"height\") : h;\n\t\t\t\t}\n\t\t\t\tthis.trigger(new Rectangle(bounds.x, bounds.y, bounds.width, y + h));\n\t\t\t}\n\t\t}]);\n\t\n\t\treturn FlowLayout;\n\t}(_Layout3.default);\n\t\n\tFlowLayout.DEFAULTS = {\n\t\thgap: 10,\n\t\tvgap: 10\n\t};\n\t\n\texports.default = FlowLayout;\n\n/***/ },\n/* 24 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t\tvalue: true\n\t});\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tvar _lodash = __webpack_require__(5);\n\t\n\tvar _lodash2 = _interopRequireDefault(_lodash);\n\t\n\tvar _bean = __webpack_require__(12);\n\t\n\tvar _bean2 = _interopRequireDefault(_bean);\n\t\n\tvar _Utils = __webpack_require__(2);\n\t\n\tvar _Utils2 = _interopRequireDefault(_Utils);\n\t\n\tvar _DomUtils = __webpack_require__(7);\n\t\n\tvar _DomUtils2 = _interopRequireDefault(_DomUtils);\n\t\n\tvar _Layout = __webpack_require__(22);\n\t\n\tvar _Layout2 = _interopRequireDefault(_Layout);\n\t\n\tvar _Rectangle = __webpack_require__(4);\n\t\n\tvar _Rectangle2 = _interopRequireDefault(_Rectangle);\n\t\n\tvar _EventDispatcher = __webpack_require__(13);\n\t\n\tvar _EventDispatcher2 = _interopRequireDefault(_EventDispatcher);\n\t\n\tvar _GraphBehavior = __webpack_require__(25);\n\t\n\tvar _GraphBehavior2 = _interopRequireDefault(_GraphBehavior);\n\t\n\tvar _SelectionBehavior = __webpack_require__(27);\n\t\n\tvar _SelectionBehavior2 = _interopRequireDefault(_SelectionBehavior);\n\t\n\tvar _Label = __webpack_require__(19);\n\t\n\tvar _Label2 = _interopRequireDefault(_Label);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tvar Renderer = function () {\n\t\tfunction Renderer(id, container) {\n\t\t\tvar config = arguments.length <= 2 || arguments[2] === undefined ? {} : arguments[2];\n\t\t\tvar graph = arguments.length <= 3 || arguments[3] === undefined ? null : arguments[3];\n\t\n\t\t\t_classCallCheck(this, Renderer);\n\t\n\t\t\tthis.id = id;\n\t\t\tthis.box = _DomUtils2.default.createElement('div', { id: this.id, tabindex: 0, ns: 'graph' }, { overflow: \"hidden\", width: \"100%\", height: \"100%\", position: 'relative' });\n\t\t\tcontainer.appendChild(this.box);\n\t\t\tif (config.layout) {\n\t\t\t\tvar layoutClass = _Utils2.default.getConstructor(config.layout.jsClass, _Layout2.default);\n\t\t\t\tthis.layout = new layoutClass(config.layout.config);\n\t\t\t\tdelete config.layout;\n\t\t\t}\n\t\t\tthis.clear = true;\n\t\t\tthis._translate = [0, 0];\n\t\t\tthis._scale = 1.0;\n\t\t\tthis.graph = graph;\n\t\t\tthis.dispatcher = null;\n\t\t\tthis.graphBehavior = null;\n\t\t\tthis.selectionBehavior = null;\n\t\t\tthis.nodeBehavior = null;\n\t\t\tthis.edgeBehavior = null;\n\t\t\tthis.connectionBehavior = null;\n\t\t\t_Utils2.default.initConfig(this, config);\n\t\n\t\t\t_bean2.default.on(_Label2.default.editor, 'editor.update.*', function (key, value) {\n\t\t\t\tconsole.log(key + '=' + value);\n\t\t\t});\n\t\t}\n\t\n\t\t_createClass(Renderer, [{\n\t\t\tkey: \"viewport\",\n\t\t\tvalue: function viewport(scaled, _viewport) {\n\t\t\t\tif (_lodash2.default.isUndefined(scaled) || _lodash2.default.isNull(scaled)) scaled = false;\n\t\t\t\tif (!_viewport) {\n\t\t\t\t\tvar vp = new _Rectangle2.default(0, 0, this.box.offsetWidth, this.box.offsetHeight);\n\t\t\t\t\tif (scaled) return _Utils2.default.scale(this.translate, this.scale, vp);\n\t\t\t\t\treturn vp;\n\t\t\t\t}\n\t\t\t\tif (!scaled) _viewport = _Utils2.default.scale(this.translate, this.scale, _viewport);\n\t\t\t\tvar w = this.box.offsetWidth;\n\t\t\t\tvar scale = w / _viewport.width;\n\t\t\t\tthis.transform(-_viewport.x * scale, -_viewport.y * scale, scale);\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"transform\",\n\t\t\tvalue: function transform() {\n\t\t\t\tvar x = arguments.length <= 0 || arguments[0] === undefined ? null : arguments[0];\n\t\t\t\tvar y = arguments.length <= 1 || arguments[1] === undefined ? null : arguments[1];\n\t\t\t\tvar scale = arguments.length <= 2 || arguments[2] === undefined ? null : arguments[2];\n\t\n\t\t\t\tvar graph = this.graph;\n\t\t\t\tvar root = graph ? graph.currentRoot : null;\n\t\t\t\tif (!_lodash2.default.isNull(x)) {\n\t\t\t\t\tthis._translate[0] = x;\n\t\t\t\t\tif (root) root.viewProp(this.id, 'x', x);\n\t\t\t\t}\n\t\t\t\tif (!_lodash2.default.isNull(y)) {\n\t\t\t\t\tthis._translate[1] = y;\n\t\t\t\t\tif (root) root.viewProp(this.id, 'y', y);\n\t\t\t\t}\n\t\t\t\tif (!_lodash2.default.isNull(scale)) {\n\t\t\t\t\tthis._scale = scale;\n\t\t\t\t\tif (root) root.viewProp(this.id, 'scale', scale);\n\t\t\t\t\t// sync the scale between the dispatcher and the graph\n\t\t\t\t\tvar s = this.dispatcher.scale;\n\t\t\t\t\tif (s != scale) this.dispatcher.scale = scale;\n\t\t\t\t}\n\t\t\t\tthis.refresh();\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"render\",\n\t\t\tvalue: function render() {\n\t\t\t\tif (!this._graph) return false;\n\t\t\t\tif (this.layout) this.layout.layout(this._graph.currentRoot, this.viewport());\n\t\n\t\t\t\tthis.initializeBehaviors();\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"renderLabel\",\n\t\t\tvalue: function renderLabel(box) {\n\t\t\t\treturn this.constructor.renderLabel(box);\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"renderLink\",\n\t\t\tvalue: function renderLink(shape) {\n\t\t\t\treturn this.constructor.renderLink(shape);\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"renderMarkers\",\n\t\t\tvalue: function renderMarkers(markers) {\n\t\t\t\treturn this.constructor.renderMarkers(markers);\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"initializeBehaviors\",\n\t\t\tvalue: function initializeBehaviors() {\n\t\t\t\t// create the event dispatcher if necessary.\n\t\t\t\tif (!this.dispatcher) {\n\t\t\t\t\tthis.dispatcher = new _EventDispatcher2.default(this.box, [this.prop('minZoom'), this.prop('maxZoom')]);\n\t\t\t\t\tvar jsClass = void 0;\n\t\t\t\t\tif (this.prop('graphBehavior')) {\n\t\t\t\t\t\tjsClass = _Utils2.default.getConstructor(this.prop('graphBehavior'));\n\t\t\t\t\t\tthis.graphBehavior = new jsClass(this);\n\t\t\t\t\t}\n\t\t\t\t\tif (this.prop('selectionBehavior')) {\n\t\t\t\t\t\tjsClass = _Utils2.default.getConstructor(this.prop('selectionBehavior'));\n\t\t\t\t\t\tthis.selectionBehavior = new jsClass(this);\n\t\t\t\t\t}\n\t\t\t\t\t/*this.dispatcher.register('mouseup.node.label', function(type, ns, target, pos, event) {\n\t    \tlet node = this._graph.nodes[target.getAttribute('id')];\n\t    \tif (!this.dispatcher.dragging && !node._firstSelection) {\n\t    \t\tLabel._delayEdit = _.delay(() => {\n\t    \t\t\tif (Label._delayEdit) {\n\t    \t\t\t\tdelete Label._delayEdit;\n\t    \t\t\t\tLabel.editor.start(node.id, this.box, node.getLabelBox(this.id), target, event.nsTarget, this.scale);\n\t    \t\t\t}\n\t    \t\t}, 250);\n\t    \t}\n\t    }, this);\n\t    this.dispatcher.register([/^mousedown/, /^zoom/], function(type, ns, target, pos, event) {\n\t    \tif (!DomUtils.eventFromInput(event)) {\n\t    \t\tLabel.editor.stop();\n\t    \t}\n\t    }, this);*/\n\t\t\t\t}\n\t\t\t\tthis.dispatcher.start();\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"refresh\",\n\t\t\tvalue: function refresh() {}\n\t\n\t\t\t/**\n\t   * Get the template for the specified key.\n\t   * @param key\n\t   * @param config if the template is a function, this config will be passed as the argument.\n\t   * @param preprocessor if the template contains preprossing elements, such as #{shape}, the preprocessor will be\n\t   * used to render them.\n\t   * @returns {*}\n\t   */\n\t\n\t\t}, {\n\t\t\tkey: \"getTemplate\",\n\t\t\tvalue: function getTemplate(key, config, preprocessor) {\n\t\t\t\tvar t = this.constructor.TEMPLATES[key];\n\t\t\t\tif (t && _lodash2.default.isFunction(t)) {\n\t\t\t\t\tt = t(config);\n\t\t\t\t}\n\t\t\t\t// check if there are any preprocessing tags.\n\t\t\t\tif (preprocessor) {\n\t\t\t\t\tvar parts = t.match(/(#{[^#]*})/g);\n\t\t\t\t\tvar obj = {};\n\t\t\t\t\tfor (var part in parts) {\n\t\t\t\t\t\tpart = parts[part];\n\t\t\t\t\t\tpart = part.substring(2, part.length - 1).trim();\n\t\t\t\t\t\tobj[part] = preprocessor[_lodash2.default.camelCase('render ' + part)](this);\n\t\t\t\t\t}\n\t\t\t\t\tt = _lodash2.default.template(t, { interpolate: /#{([\\s\\S]+?)}/g })(obj);\n\t\t\t\t}\n\t\t\t\treturn t;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"reset\",\n\t\t\tvalue: function reset() {}\n\t\t}, {\n\t\t\tkey: \"destroy\",\n\t\t\tvalue: function destroy() {\n\t\t\t\tdelete this._graph;\n\t\t\t\tdelete this.layout;\n\t\t\t\tif (this.dispatcher) {\n\t\t\t\t\tthis.dispatcher.stop();\n\t\t\t\t\tdelete this.dispatcher;\n\t\t\t\t}\n\t\t\t\tthis.box.innerHTML = '';\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"graph\",\n\t\t\tget: function get() {\n\t\t\t\treturn this._graph;\n\t\t\t},\n\t\t\tset: function set(graph) {\n\t\t\t\tthis._graph = graph;\n\t\t\t\tvar root = graph.currentRoot;\n\t\t\t\tif (root) {\n\t\t\t\t\tthis._translate = [root.viewProp(this.id, 'x') || 0, root.viewProp(this.id, 'y') || 0];\n\t\t\t\t\tthis._scale = root.viewProp(this.id, 'scale') || 1.0;\n\t\t\t\t}\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"translate\",\n\t\t\tget: function get() {\n\t\t\t\treturn this._translate;\n\t\t\t},\n\t\t\tset: function set(t) {\n\t\t\t\tthis.transform(t[0], t[1]);\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"scale\",\n\t\t\tget: function get() {\n\t\t\t\treturn this._scale;\n\t\t\t},\n\t\t\tset: function set(k) {\n\t\t\t\tswitch (k) {\n\t\t\t\t\tcase \"in\":\n\t\t\t\t\t\tk = this.scale * this.prop(\"zoomFactor\");\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase \"out\":\n\t\t\t\t\t\tk = this.scale / this.prop(\"zoomFactor\");\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase \"actual\":\n\t\t\t\t\t\tk = 1.0;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase \"fit\":\n\t\t\t\t\t\tvar gridSize = this.prop(\"gridSize\") * 2;\n\t\n\t\t\t\t\t\tvar gBounds = this.getBounds();\n\t\t\t\t\t\tvar vBounds = this.viewport();\n\t\n\t\t\t\t\t\tvBounds.width -= gridSize;\n\t\t\t\t\t\tvBounds.height -= gridSize;\n\t\n\t\t\t\t\t\t/* Do not zoom more than actual if graph already fits into the bounds */\n\t\t\t\t\t\tk = Math.min(vBounds.width / gBounds.width, vBounds.height / gBounds.height, 1.0);\n\t\n\t\t\t\t\t\t//TODO: Add centering code here or trigger an event for that\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tdefault:\n\t\t\t\t\t\tif (_lodash2.default.isString(k)) k = parseFloat(k);\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tthis.transform(null, null, k);\n\t\t\t}\n\t\t}]);\n\t\n\t\treturn Renderer;\n\t}();\n\t\n\tRenderer.DEFAULTS = {\n\t\tdefaultClickMode: \"pan\",\n\t\thideOutline: false,\n\t\tsingleSelect: true,\n\t\tdraggable: true,\n\t\tgridEnabled: false,\n\t\tguidesEnabled: true,\n\t\tgridSize: 30,\n\t\tmaxZoom: 4.0,\n\t\tminZoom: 0.2,\n\t\tzoomFactor: 1.2,\n\t\tmaskOpacity: 0.5,\n\t\tgraphBehavior: _GraphBehavior2.default,\n\t\tselectionBehavior: _SelectionBehavior2.default\n\t};\n\t\n\texports.default = Renderer;\n\n/***/ },\n/* 25 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t\tvalue: true\n\t});\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tvar _Behavior2 = __webpack_require__(26);\n\t\n\tvar _Behavior3 = _interopRequireDefault(_Behavior2);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\t\n\tfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; } /**\n\t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * Created by tong on 6/28/2016.\n\t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                */\n\t\n\t\n\t/**\n\t * Graph handler handles Panning and Zoom and rubber band selection\n\t */\n\t\n\tvar GraphBehavior = function (_Behavior) {\n\t\t_inherits(GraphBehavior, _Behavior);\n\t\n\t\tfunction GraphBehavior(renderer) {\n\t\t\t_classCallCheck(this, GraphBehavior);\n\t\n\t\t\tvar _this = _possibleConstructorReturn(this, Object.getPrototypeOf(GraphBehavior).call(this, renderer));\n\t\n\t\t\tvar dispatcher = renderer.dispatcher;\n\t\t\tvar f = function f(type, ns, graph, pos, event) {\n\t\t\t\t//Cursor.updateCursor(type, ns, graph, event);\n\t\t\t};\n\t\t\tdispatcher.register(/^drag.*\\.graph$/, _this.handleDrag, _this);\n\t\t\tdispatcher.register(/^zoom/, _this.handleZoom, _this);\n\t\t\t//dispatcher.register(['mousedown.graph', 'mouseenter.graph', 'mouseleave.graph'], f);\n\t\t\t_this.offset = null;\n\t\t\treturn _this;\n\t\t}\n\t\n\t\t_createClass(GraphBehavior, [{\n\t\t\tkey: \"handleZoom\",\n\t\t\tvalue: function handleZoom(type, ns, graph, pos, event) {\n\t\t\t\tthis.renderer.transform(null, null, event.scale);\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"handleDrag\",\n\t\t\tvalue: function handleDrag(type, ns, graph, pos, event) {\n\t\t\t\tif (type == 'dragstart') {\n\t\t\t\t\tvar pan = this.renderer.prop(\"defaultClickMode\") == \"pan\" ^ (event.ctrlKey || event.shiftKey);\n\t\t\t\t\tif (!pan) return;\n\t\t\t\t\tvar t = this.renderer.translate;\n\t\t\t\t\tthis.offset = [t[0] - pos[0], t[1] - pos[1]];\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tif (!this.offset) return;\n\t\t\t\tthis.renderer.transform(pos[0] + this.offset[0], pos[1] + this.offset[1]);\n\t\t\t\tif (type == 'dragend') {\n\t\t\t\t\t//Cursor.updateCursor('mouseup', ns, graph, event);\n\t\t\t\t\tdelete this.offset;\n\t\t\t\t}\n\t\t\t}\n\t\t}]);\n\t\n\t\treturn GraphBehavior;\n\t}(_Behavior3.default);\n\t\n\texports.default = GraphBehavior;\n\n/***/ },\n/* 26 */\n/***/ function(module, exports) {\n\n\t\"use strict\";\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t\tvalue: true\n\t});\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tvar Behavior = function () {\n\t\tfunction Behavior(renderer) {\n\t\t\t_classCallCheck(this, Behavior);\n\t\n\t\t\tthis.renderer = renderer;\n\t\t}\n\t\n\t\t_createClass(Behavior, [{\n\t\t\tkey: \"destroy\",\n\t\t\tvalue: function destroy() {\n\t\t\t\tdelete this.renderer;\n\t\t\t}\n\t\t}]);\n\t\n\t\treturn Behavior;\n\t}();\n\t\n\texports.default = Behavior;\n\n/***/ },\n/* 27 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t\tvalue: true\n\t});\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tvar _get = function get(object, property, receiver) { if (object === null) object = Function.prototype; var desc = Object.getOwnPropertyDescriptor(object, property); if (desc === undefined) { var parent = Object.getPrototypeOf(object); if (parent === null) { return undefined; } else { return get(parent, property, receiver); } } else if (\"value\" in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } };\n\t\n\tvar _Rectangle = __webpack_require__(4);\n\t\n\tvar _Rectangle2 = _interopRequireDefault(_Rectangle);\n\t\n\tvar _Cell = __webpack_require__(17);\n\t\n\tvar _Cell2 = _interopRequireDefault(_Cell);\n\t\n\tvar _Behavior2 = __webpack_require__(26);\n\t\n\tvar _Behavior3 = _interopRequireDefault(_Behavior2);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\t\n\tfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\t\n\tvar SelectionBehavior = function (_Behavior) {\n\t\t_inherits(SelectionBehavior, _Behavior);\n\t\n\t\tfunction SelectionBehavior(renderer) {\n\t\t\t_classCallCheck(this, SelectionBehavior);\n\t\n\t\t\tvar _this = _possibleConstructorReturn(this, Object.getPrototypeOf(SelectionBehavior).call(this, renderer));\n\t\n\t\t\tvar dispatcher = renderer.dispatcher;\n\t\t\tdispatcher.register('mousedown.*', _this.selectCell, _this);\n\t\t\tdispatcher.register('mouseup.*', _this.unselectCell, _this);\n\t\t\tdispatcher.register('drag*.graph', _this.handleMultiSelect, _this);\n\t\t\t//graph.on(Graph.EVENT_TYPES.SELECTION_CHANGE, this.updateSelections, this);\n\t\t\t_this.selectedNodes = null;\n\t\t\t_this.selectedLinks = null;\n\t\t\t_this.attachedLinks = null;\n\t\t\treturn _this;\n\t\t}\n\t\n\t\t_createClass(SelectionBehavior, [{\n\t\t\tkey: \"updateSelections\",\n\t\t\tvalue: function updateSelections() {\n\t\t\t\tif (this.selectedNodes) this.selectedNodes.classed('selected', false);\n\t\t\t\tif (this.selectedLinks) this.selectedLinks.classed('selected', false);\n\t\n\t\t\t\tthis.selectedNodes = null;\n\t\t\t\tthis.selectedLinks = null;\n\t\t\t\tthis.attachedLinks = null;\n\t\n\t\t\t\tif (this.graph.selectedVertices && this.graph.selectedVertices.length > 0) {\n\t\t\t\t\tthis.selectedNodes = this.graph.renderer.getShapes(this.graph.selectedVertices);\n\t\t\t\t\tthis.attachedLinks = this.graph.renderer.getShapes(this.graph.getAttachedEdges());\n\t\t\t\t\tthis.selectedNodes.classed('selected', true);\n\t\t\t\t}\n\t\n\t\t\t\tif (this.graph.selectedEdges && this.graph.selectedEdges.length > 0) {\n\t\t\t\t\tthis.selectedLinks = this.graph.renderer.getShapes(this.graph.selectedEdges);\n\t\t\t\t\tthis.selectedLinks.classed('selected', true);\n\t\t\t\t}\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"selectCell\",\n\t\t\tvalue: function selectCell(type, ns, data, pos, event) {\n\t\t\t\tvar cell = data == this.graph ? null : data;\n\t\t\t\tif (cell && !(cell instanceof _Cell2.default)) return;\n\t\t\t\tvar toggle = event.ctrlKey || event.shiftKey;\n\t\t\t\tif (cell && cell instanceof _Cell2.default) {\n\t\t\t\t\tif (!this.graph.isSelected(cell)) delete cell._firstSelection;else cell._firstSelection = true;\n\t\n\t\t\t\t\td3.select(event.dataTarget).moveToFront();\n\t\t\t\t\tthis.graph.setSelection(cell, toggle);\n\t\t\t\t}\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"unselectCell\",\n\t\t\tvalue: function unselectCell(type, ns, data, pos, event) {\n\t\t\t\tvar cell = data == this.graph ? null : data;\n\t\t\t\tif (cell && !(cell instanceof _Cell2.default)) return;\n\t\t\t\tvar ctrlKey = event.ctrlKey || event.shiftKey;\n\t\t\t\tif (!cell) {\n\t\t\t\t\tthis.graph.setSelection(cell, ctrlKey);\n\t\t\t\t}\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"handleMultiSelect\",\n\t\t\tvalue: function handleMultiSelect(type, ns, data, pos, event) {\n\t\t\t\tpos = util.scale(this.graph, pos);\n\t\n\t\t\t\tif (type == 'dragstart') {\n\t\t\t\t\tvar select = this.graph.getProperty(\"defaultClickMode\") == \"select\" ^ (event.ctrlKey || event.shiftKey);\n\t\t\t\t\tif (!select) return;\n\t\t\t\t\tthis.startPt = new Point(pos[0], pos[1]);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tif (!this.startPt) return;\n\t\t\t\tvar rect = _Rectangle2.default.getBoundingRectangle([new Point(pos[0], pos[1]), this.startPt]);\n\t\t\t\tvar renderer = this.graph.renderer;\n\t\t\t\tif (!this.rubberband) {\n\t\t\t\t\tthis.rubberband = d3.select(renderer.appendNode(renderer.getCellLayer(), {\n\t\t\t\t\t\ttemplate: _.template('<g><rect x=\"0\" y=\"0\" width=\"100\" height=\"100\" stroke=\"#000000\" fill=\"none\" stroke-dasharray=\"3 3\"/></g>')\n\t\t\t\t\t}, false));\n\t\t\t\t}\n\t\t\t\tif (type == 'dragend') {\n\t\t\t\t\tvar cells = this.graph.getCurrentRoot().children;\n\t\t\t\t\t// TODO: Define if we want to select vertexes / edges or both\n\t\t\t\t\tcells = _.filter(cells, function (cell) {\n\t\t\t\t\t\tvar box = cell.getBounds();\n\t\t\t\t\t\tif (rect.contains(box)) {\n\t\t\t\t\t\t\treturn true;\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t});\n\t\t\t\t\t// TODO: Set selection\n\t\t\t\t\tthis.graph.setSelection(cells, event.ctrlKey);\n\t\n\t\t\t\t\tthis.rubberband.remove();\n\t\t\t\t\tdelete this.startPt;\n\t\t\t\t\tdelete this.rubberband;\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tthis.rubberband.select(\"rect\").attr({ x: rect.x, y: rect.y, width: rect.width, height: rect.height });\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"destroy\",\n\t\t\tvalue: function destroy() {\n\t\t\t\t_get(Object.getPrototypeOf(SelectionBehavior.prototype), \"destroy\", this).call(this);\n\t\t\t\tdelete this.selectedNodes;\n\t\t\t\tdelete this.selectedLinks;\n\t\t\t\tdelete this.attachedLinks;\n\t\t\t}\n\t\t}]);\n\t\n\t\treturn SelectionBehavior;\n\t}(_Behavior3.default);\n\t\n\texports.default = SelectionBehavior;\n\n/***/ },\n/* 28 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t\tvalue: true\n\t});\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tvar _get = function get(object, property, receiver) { if (object === null) object = Function.prototype; var desc = Object.getOwnPropertyDescriptor(object, property); if (desc === undefined) { var parent = Object.getPrototypeOf(object); if (parent === null) { return undefined; } else { return get(parent, property, receiver); } } else if (\"value\" in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } };\n\t\n\tvar _lodash = __webpack_require__(5);\n\t\n\tvar _lodash2 = _interopRequireDefault(_lodash);\n\t\n\tvar _base = __webpack_require__(1);\n\t\n\tvar _base2 = _interopRequireDefault(_base);\n\t\n\tvar _DomUtils = __webpack_require__(7);\n\t\n\tvar _DomUtils2 = _interopRequireDefault(_DomUtils);\n\t\n\tvar _Renderer2 = __webpack_require__(24);\n\t\n\tvar _Renderer3 = _interopRequireDefault(_Renderer2);\n\t\n\tvar _StringBuffer = __webpack_require__(8);\n\t\n\tvar _StringBuffer2 = _interopRequireDefault(_StringBuffer);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\t\n\tfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\t\n\tvar NS = 'http://www.w3.org/2000/svg';\n\tif (typeof SVGElement != \"undefined\") {\n\t\tvar svg = document.createElementNS(NS, \"svg\");\n\t\tsvg.innerHTML = '<circle/>';\n\t\tif (svg.firstChild !== \"[object SVGCircleElement]\") {\n\t\t\tObject.defineProperties(SVGElement.prototype, {\n\t\t\t\t\"outerHTML\": {\n\t\t\t\t\tenumerable: false,\n\t\t\t\t\tconfigurable: true,\n\t\t\t\t\tget: function get() {\n\t\t\t\t\t\tvar $node, $temp;\n\t\t\t\t\t\t$temp = document.createElement('div');\n\t\t\t\t\t\t$node = this.cloneNode(true);\n\t\t\t\t\t\t$temp.appendChild($node);\n\t\t\t\t\t\treturn $temp.innerHTML;\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t\"innerHTML\": {\n\t\t\t\t\tenumerable: false,\n\t\t\t\t\tconfigurable: true,\n\t\t\t\t\tget: function get() {\n\t\t\t\t\t\tvar s = this.outerHTML;\n\t\t\t\t\t\tvar ropen = new RegExp(\"<\" + this.nodeName + '\\\\b(?:([\"\\'])[^\"]*?(\\\\1)|[^>])*>', \"i\");\n\t\t\t\t\t\tvar rclose = new RegExp(\"<\\/\" + this.nodeName + \">$\", \"i\");\n\t\t\t\t\t\treturn s.replace(ropen, \"\").replace(rclose, \"\");\n\t\t\t\t\t},\n\t\t\t\t\tset: function set(markup) {\n\t\t\t\t\t\t// empty el first.\n\t\t\t\t\t\tvar child = void 0;\n\t\t\t\t\t\twhile (child = this.lastChild) {\n\t\t\t\t\t\t\tthis.removeChild(child);\n\t\t\t\t\t\t}var buf = new _StringBuffer2.default();\n\t\t\t\t\t\tbuf.append('<svg>').append(markup).append('</svg');\n\t\t\t\t\t\tvar $temp = _DomUtils2.default.createElement('div', null, null, buf.toString()).firstElementChild;\n\t\t\t\t\t\twhile ($temp.firstChild) {\n\t\t\t\t\t\t\tthis.appendChild($temp.firstChild);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t\t// Define the toDataURL for SVG\n\t\tSVGElement.prototype.toDataURL = function (type) {\n\t\t\tvar options = arguments.length <= 1 || arguments[1] === undefined ? {} : arguments[1];\n\t\n\t\t\tvar _svg = this;\n\t\n\t\t\tvar debug = function debug(msg) {};\n\t\n\t\t\tif (options['debug'] == true && typeof console != 'undefined') debug = function debug(msg) {\n\t\t\t\tconsole.log(\"SVG.toDataURL:\", msg);\n\t\t\t};\n\t\n\t\t\tfunction exportSVG() {\n\t\t\t\tvar svg_xml = _svg.outerHTML;\n\t\t\t\tvar svg_dataurl = base64dataURLencode(svg_xml);\n\t\t\t\tdebug(type + \" length: \" + svg_dataurl.length);\n\t\n\t\t\t\t// NOTE double data carrier\n\t\t\t\tif (options.callback) options.callback(svg_dataurl);\n\t\t\t\treturn svg_dataurl;\n\t\t\t}\n\t\n\t\t\tfunction base64dataURLencode(s) {\n\t\t\t\tvar b64 = \"data:image/svg+xml;base64,\";\n\t\n\t\t\t\t// https://developer.mozilla.org/en/DOM/window.btoa\n\t\t\t\tif (window.btoa) {\n\t\t\t\t\tdebug(\"using window.btoa for base64 encoding\");\n\t\t\t\t\tb64 += btoa(s);\n\t\t\t\t} else {\n\t\t\t\t\tdebug(\"using custom base64 encoder\");\n\t\t\t\t\tb64 += _base2.default.encode(s);\n\t\t\t\t}\n\t\n\t\t\t\treturn b64;\n\t\t\t}\n\t\n\t\t\t// Native export doesn't work very well. should use canvg instead.\n\t\t\tfunction exportImage(type) {\n\t\t\t\tvar canvas = document.createElement(\"canvas\");\n\t\t\t\tvar ctx = canvas.getContext('2d');\n\t\n\t\t\t\t// TODO: if (options.keepOutsideViewport), do some translation magic?\n\t\n\t\t\t\tvar svg_img = new Image();\n\t\t\t\tvar svg_xml = _svg.outerHTML;\n\t\t\t\tsvg_img.src = base64dataURLencode(svg_xml);\n\t\n\t\t\t\tsvg_img.onload = function () {\n\t\t\t\t\tdebug(\"exported image size: \" + [svg_img.width, svg_img.height]);\n\t\t\t\t\tcanvas.width = svg_img.width;\n\t\t\t\t\tcanvas.height = svg_img.height;\n\t\t\t\t\tctx.drawImage(svg_img, 0, 0);\n\t\n\t\t\t\t\t// SECURITY_ERR WILL HAPPEN NOW\n\t\t\t\t\tvar image_dataurl = canvas.toDataURL(type);\n\t\t\t\t\tdebug(type + \" length: \" + image_dataurl.length);\n\t\n\t\t\t\t\tif (options.callback) options.callback(image_dataurl);else debug(\"WARNING: no callback set, so nothing happens.\");\n\t\t\t\t};\n\t\n\t\t\t\tsvg_img.onerror = function () {\n\t\t\t\t\tdebug(\"Can't export! Maybe your browser doesn't support \" + \"SVG in img element or SVG input for Canvas drawImage?\\n\" + \"http://en.wikipedia.org/wiki/SVG#Native_support\");\n\t\t\t\t};\n\t\n\t\t\t\t// NOTE: will not return anything\n\t\t\t}\n\t\n\t\t\tfunction exportImageCanvg(type) {\n\t\t\t\tif (!canvg) return null;\n\t\t\t\tvar canvas = _DomUtils2.default.createElement('canvas', null, { display: \"none\" });\n\t\t\t\tdocument.body.appendChild(canvas);\n\t\t\t\tif (type == 'javascript') {\n\t\t\t\t\tvar xcanvas = new jsCanvas('jscanvastest');\n\t\t\t\t\txcanvas.canvas.style.display = 'none';\n\t\t\t\t\t//xcanvas.canvas = canvas;\n\t\t\t\t}\n\t\n\t\t\t\tif (!options.keepOutsideViewport) {\n\t\t\t\t\tcanvg(canvas, _svg.outerHTML);\n\t\t\t\t} else {\n\t\t\t\t\tvar padding = options.padding || 0;\n\t\t\t\t\tvar scale = 1.0;\n\t\t\t\t\tvar translate = [0, 0];\n\t\t\t\t\tvar bbox = _svg.getBBox();\n\t\t\t\t\tdebug(\"detected svg dimensions \" + [bbox.x, bbox.y, bbox.width, bbox.height]);\n\t\t\t\t\tvar transform = _svg.firstElementChild.getAttribute('transform');\n\t\t\t\t\tif (transform) {\n\t\t\t\t\t\tdebug('detected svg transform ' + transform);\n\t\t\t\t\t\ttransform = SVGRenderer.transform(transform);\n\t\t\t\t\t\ttranslate = transform.translate;\n\t\t\t\t\t\tscale = transform.scale;\n\t\t\t\t\t}\n\t\t\t\t\tvar buf = new _StringBuffer2.default();\n\t\t\t\t\tbuf.append('<svg width=\"').append(bbox.width + 2 * padding).append('px\" height=\"').append(bbox.height + 2 * padding).append('px\"><g transform=\"translate(').append(-bbox.x + translate[0] + padding).append(',').append(-bbox.y + translate[1] + padding).append(')scale(').append(scale).append(')\">').append(_svg.firstElementChild.innerHTML).append('</g></svg>');\n\t\t\t\t\tif (type == 'javascript') {\n\t\t\t\t\t\txcanvas.compile(buf.toString(), function () {\n\t\t\t\t\t\t\tif (options.callback) options.callback(xcanvas.toString());\n\t\t\t\t\t\t});\n\t\t\t\t\t\treturn;\n\t\t\t\t\t} else canvg(canvas, buf.toString());\n\t\t\t\t}\n\t\t\t\tvar image_dataurl = canvas.toDataURL(type);\n\t\t\t\tif (options.callback) options.callback(image_dataurl);\n\t\t\t\tcanvas.parentNode.removeChild(canvas);\n\t\t\t\treturn image_dataurl;\n\t\t\t}\n\t\n\t\t\tif (!type) type = \"image/svg+xml\";\n\t\n\t\t\tif (options.keepNonSafe) debug(\"NOTE: keepNonSafe is NOT supported and will be ignored!\");\n\t\t\tif (options.keepOutsideViewport) debug(\"NOTE: keepOutsideViewport is only supported with canvg exporter.\");\n\t\n\t\t\tswitch (type) {\n\t\t\t\tcase \"image/svg+xml\":\n\t\t\t\t\treturn exportSVG();\n\t\t\t\tcase \"image/png\":\n\t\t\t\tcase \"image/jpeg\":\n\t\t\t\tcase \"javascript\":\n\t\t\t\t\tif (!options.renderer) {\n\t\t\t\t\t\tif (window.canvg) options.renderer = \"canvg\";else options.renderer = \"native\";\n\t\t\t\t\t}\n\t\t\t\t\tswitch (options.renderer) {\n\t\t\t\t\t\tcase \"canvg\":\n\t\t\t\t\t\t\tdebug(\"using canvg renderer for \" + type + \" image export\");\n\t\t\t\t\t\t\treturn exportImageCanvg(type);\n\t\t\t\t\t\tcase \"native\":\n\t\t\t\t\t\t\tdebug(\"using native renderer for \" + type + \" export. THIS MIGHT FAIL.\");\n\t\t\t\t\t\t\treturn exportImage(type);\n\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\tdebug(\"unknown image renderer given, doing noting (\" + options.renderer + \")\");\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\tdebug(\"Sorry! Exporting as '\" + type + \"' is not supported!\");\n\t\t\t}\n\t\t\treturn null;\n\t\t};\n\t}\n\t\n\tvar SVGRenderer = function (_Renderer) {\n\t\t_inherits(SVGRenderer, _Renderer);\n\t\n\t\tfunction SVGRenderer() {\n\t\t\t_classCallCheck(this, SVGRenderer);\n\t\n\t\t\treturn _possibleConstructorReturn(this, Object.getPrototypeOf(SVGRenderer).apply(this, arguments));\n\t\t}\n\t\n\t\t_createClass(SVGRenderer, [{\n\t\t\tkey: \"render\",\n\t\t\tvalue: function render() {\n\t\t\t\tvar result = _get(Object.getPrototypeOf(SVGRenderer.prototype), \"render\", this).call(this);\n\t\t\t\tif (result) {\n\t\t\t\t\tvar root = this.graph.currentRoot;\n\t\t\t\t\tvar buf = new _StringBuffer2.default('<svg width=\"100%\" height=\"100%\" xmlns=\"http://www.w3.org/2000/svg\">');\n\t\t\t\t\tvar t = this.translate;\n\t\t\t\t\tbuf.append('<g transform=\"translate(').append(t[0]).append(',').append(t[1]).append(')scale(').append(this.scale).append(')\">');\n\t\t\t\t\tbuf.append(this.renderDefs());\n\t\t\t\t\tbuf.append(root.render(this));\n\t\t\t\t\tbuf.append('</g></svg>');\n\t\t\t\t\tthis.box.innerHTML = buf.toString();\n\t\t\t\t\tthis.svg = this.box.firstElementChild;\n\t\t\t\t}\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"renderDefs\",\n\t\t\tvalue: function renderDefs() {\n\t\t\t\tvar buf = new _StringBuffer2.default('<defs>');\n\t\t\t\tbuf.append(this.getTemplate('Grid', this.prop(\"gridSize\")));\n\t\t\t\tvar markers = this.graph.markers;\n\t\t\t\tif (markers.length > 0) buf.append(SVGRenderer.renderMarkers(markers));\n\t\t\t\tbuf.append('</defs>');\n\t\t\t\treturn buf.toString();\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"refresh\",\n\t\t\tvalue: function refresh() {\n\t\t\t\tif (!this.svg) return;\n\t\t\t\tvar g = this.svg.querySelector('g');\n\t\t\t\tvar t = this.translate;\n\t\t\t\tg.setAttribute('transform', 'translate(' + t[0] + ',' + t[1] + ')scale(' + this.scale + ')');\n\t\t\t}\n\t\t}], [{\n\t\t\tkey: \"renderMarkers\",\n\t\t\tvalue: function renderMarkers(markers) {\n\t\t\t\tvar buf = new _StringBuffer2.default(),\n\t\t\t\t    str1 = void 0,\n\t\t\t\t    str2 = void 0;\n\t\t\t\tmarkers.forEach(function (marker) {\n\t\t\t\t\tstr1 = this.TEMPLATES['Marker'](marker);\n\t\t\t\t\tstr2 = marker.shape;\n\t\t\t\t\tif (!_lodash2.default.isString(str2)) str2 = this.renderShape(str2);\n\t\t\t\t\tstr1 = str1.replace(/\\#\\{shape\\}/, str2);\n\t\t\t\t\tbuf.append(str1);\n\t\t\t\t}, this);\n\t\t\t\treturn buf.toString();\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"renderLabel\",\n\t\t\tvalue: function renderLabel(box) {\n\t\t\t\treturn this.TEMPLATES['Label'](box);\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"renderShape\",\n\t\t\tvalue: function renderShape(shape) {\n\t\t\t\tvar template = this.TEMPLATES[shape.name];\n\t\t\t\tif (_lodash2.default.isString(template)) template = _lodash2.default.template(template);\n\t\t\t\treturn template(shape);\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"getPathData\",\n\t\t\tvalue: function getPathData(shape) {\n\t\t\t\tvar points = shape.points;\n\t\t\t\tvar controlPts = shape.controlPts;\n\t\t\t\tif (!points || points.length == 0) return '';\n\t\n\t\t\t\tif (!controlPts && shape.round) {\n\t\t\t\t\t// render rounded line joins.\n\t\t\t\t\tvar newPts = [];\n\t\t\t\t\tcontrolPts = [];\n\t\t\t\t\tvar prev = points[0],\n\t\t\t\t\t    next = void 0,\n\t\t\t\t\t    d1 = void 0,\n\t\t\t\t\t    d2 = void 0,\n\t\t\t\t\t    corner = void 0;\n\t\t\t\t\tnewPts.push(prev);\n\t\t\t\t\tfor (var i = 1; i < points.length - 1; i++) {\n\t\t\t\t\t\tnext = points[i];\n\t\t\t\t\t\t// set the control point first.\n\t\t\t\t\t\tcontrolPts[2 * i] = [next, next];\n\t\t\t\t\t\t// check the size of the corner.\n\t\t\t\t\t\td1 = prev.distance(next);\n\t\t\t\t\t\td2 = next.distance(points[i + 1]);\n\t\t\t\t\t\tcorner = Math.min(shape.round, d1 / 2, d2 / 2);\n\t\t\t\t\t\t// split the point into two.\n\t\t\t\t\t\tnewPts.push(next.getDirection(prev).scale(corner).translate(next));\n\t\t\t\t\t\tnewPts.push(next.getDirection(points[i + 1]).scale(corner).translate(next));\n\t\t\t\t\t\tprev = next;\n\t\t\t\t\t}\n\t\t\t\t\tnewPts.push(points[points.length - 1]);\n\t\t\t\t\tpoints = newPts;\n\t\t\t\t}\n\t\t\t\tvar buf = new _StringBuffer2.default('M'),\n\t\t\t\t    point = void 0;\n\t\t\t\tfor (var _i = 0; _i < points.length; _i++) {\n\t\t\t\t\tpoint = points[_i];\n\t\t\t\t\tif (_i == 0) buf.append(point);else {\n\t\t\t\t\t\tif (controlPts && controlPts[_i]) {\n\t\t\t\t\t\t\tbuf.append(' C ');\n\t\t\t\t\t\t\tfor (var j = 0; j < controlPts[_i].length; j++) {\n\t\t\t\t\t\t\t\tbuf.append(controlPts[_i][j]).append(' ');\n\t\t\t\t\t\t\t}buf.append(point);\n\t\t\t\t\t\t} else buf.append(' L ').append(point);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn buf.toString();\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"renderLink\",\n\t\t\tvalue: function renderLink(shape) {\n\t\t\t\tvar buf = new _StringBuffer2.default();\n\t\t\t\tvar d = SVGRenderer.getPathData(shape);\n\t\t\t\tif (shape.showGauge) buf.append('<path style=\"stroke: white; stroke-width: 9; visibility: hidden; pointer-events: stroke;\" d=\"').append(d).append('\"/>');\n\t\t\t\tbuf.append('<path d=\"').append(d).append('\"');\n\t\t\t\tif (shape.startMarker || shape.endMarker) {\n\t\t\t\t\tbuf.append(' style=\"');\n\t\t\t\t\tif (shape.startMarker) buf.append('marker-start: url(#').append(_lodash2.default.isString(shape.startMarker) ? shape.startMarker : shape.startMarker.id).append(');');\n\t\t\t\t\tif (shape.endMarker) buf.append('marker-end: url(#').append(_lodash2.default.isString(shape.endMarker) ? shape.endMarker : shape.endMarker.id).append(');');\n\t\t\t\t\tbuf.append('\"');\n\t\t\t\t}\n\t\t\t\tbuf.append('/>');\n\t\t\t\treturn buf.toString();\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"appendContent\",\n\t\t\tvalue: function appendContent(el, content) {\n\t\t\t\tvar buf = new _StringBuffer2.default();\n\t\t\t\tbuf.append('<svg>').append(content).append('</svg');\n\t\t\t\tvar temp = _DomUtils2.default.createElement('div', null, null, buf.toString()).firstElementChild;\n\t\n\t\t\t\twhile (temp.firstChild) {\n\t\t\t\t\tel.appendChild(temp.firstChild);\n\t\t\t\t}return el;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"transform\",\n\t\t\tvalue: function transform(_transform) {\n\t\t\t\tvar translate = [0, 0],\n\t\t\t\t    scale = 1.0;\n\t\t\t\t//\n\t\t\t\tvar parts = _transform.match(/translate\\(\\s*([^)]+)/);\n\t\t\t\tif (parts) {\n\t\t\t\t\tvar m = parts[1].trim().match(/([\\d.-]+)[ ,]([\\d.-]+)/);\n\t\t\t\t\tif (m) {\n\t\t\t\t\t\ttranslate[0] = parseFloat(m[1]) || 0;\n\t\t\t\t\t\ttranslate[1] = parseFloat(m[2]) || 0;\n\t\t\t\t\t} else translate[0] = translate[1] = parseFloat(parts[1]);\n\t\t\t\t}\n\t\t\t\tparts = _transform.match(/scale\\(\\s*([^)]+)/);\n\t\t\t\tif (parts) scale = parseFloat(parts[1]) || 1.0;\n\t\n\t\t\t\treturn { translate: translate, scale: scale };\n\t\t\t}\n\t\t}]);\n\t\n\t\treturn SVGRenderer;\n\t}(_Renderer3.default);\n\t\n\tSVGRenderer.TEMPLATES = {\n\t\t$root: '<g id=\"${id}\" class=\"${className}\">#{children}</g>',\n\t\t$node: '<g id=\"${id}\" class=\"${className}\" style=\"${style}\" ns=\"${namespace}\" transform=\"translate(${x},${y})\">#{shape}#{label}</g>',\n\t\t$edge: '<g id=\"${id}\" class=\"${className}\" style=\"${style}\" ns=\"${namespace}\">#{shape}#{label}</g>',\n\t\tEllipse: '<ellipse cx=\"0\" cy=\"0\" rx=\"${width/2}\" ry=\"${height/2}\"/>',\n\t\tRectangle: '<rect x=\"${-width/2}\" y=\"${-height/2}\" width=\"${width}\" height=\"${height}\" rx=\"9\" ry=\"9\"/>',\n\t\tTriangle: '<polygon points=\"${-width/2},${-height/2} ${width/2},${-height/2} 0,${height/2}\"/>',\n\t\tRhombus: '<polygon points=\"0,${-height/2} ${width/2},0 0,${height/2} ${-width/2},0\"/>',\n\t\tHexagon: function Hexagon(config) {\n\t\t\tvar vertical = config.direction == 'north' || config.direction == 'south';\n\t\t\tif (vertical) return '<polygon points=\"0,${-height/2} ${width/2},${-height/4} ${width/2},${height/4} 0,${height/2} ${-width/2},${height/4} ${-width/2},${-height/4}\"/>';else return '<polygon points=\"${-width/2},0 ${width/4},${-height/2} ${width/4},${-height/2} ${width/2},0 ${width/4},${height/2} ${-width/4},${height/2}\"/>';\n\t\t},\n\t\tPolygon: function Polygon(shape) {\n\t\t\tvar buf = new _StringBuffer2.default('<polygon points=\"');\n\t\t\tshape.points.forEach(function (pt) {\n\t\t\t\tbuf.append(pt[0]).append(',').append(pt[1]).append(' ');\n\t\t\t});\n\t\t\tbuf.removeLast();\n\t\t\tbuf.append('\"/>');\n\t\t\treturn buf.toString();\n\t\t},\n\t\tImage: function Image(config) {\n\t\t\treturn '<image x=\"${-width/2}\" y=\"${-height/2}\" width=\"${width}\" height=\"${height}\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" xlink:href=\"' + config.image + '\"/>';\n\t\t},\n\t\tMarker: function Marker(marker) {\n\t\t\treturn (\"\\n<marker id=\\\"\" + marker.id + \"\\\" markerWidth=\\\"\" + marker.size + \"\\\" markerHeight=\\\"\" + marker.size + \"\\\" refx=\\\"\" + marker.ref[0] + \"\\\" \\nrefy=\\\"\" + marker.ref[1] + \"\\\" orient=\\\"auto\\\" viewbox=\\\"\" + marker.viewBox.x + \" \" + marker.viewBox.y + \" \" + marker.viewBox.width + \" \" + marker.viewBox.height + \"\\\"\\nmarkerUnits=\\\"userSpaceOnUse\\\" \" + (marker.fill ? \"style=\\\"stroke: \" + marker.fill + \";fill:\" + marker.fill + \"\\\"\" : '') + \">#{shape}</marker>\\n\").trim();\n\t\t},\n\t\tGrid: function Grid(size) {\n\t\t\treturn (\"\\n<pattern id=\\\"GridPattern\\\" width=\\\"\" + size + \"\\\" height=\\\"\" + size + \"\\\" patternUnits=\\\"userSpaceOnUse\\\">\\n\\t<ellipse cx=\\\"0\\\" cy=\\\"0\\\" rx=\\\"1\\\" ry=\\\"1\\\" fill=\\\"#999999\\\"/>\\n\\t<ellipse cx=\\\"0\\\" cy=\\\"\" + size + \"\\\" rx=\\\"1\\\" ry=\\\"1\\\" fill=\\\"#999999\\\"/>\\n\\t<ellipse cx=\\\"\" + size + \"\\\" cy=\\\"0\\\" rx=\\\"1\\\" ry=\\\"1\\\" fill=\\\"#999999\\\"/>\\n\\t<ellipse cx=\\\"\" + size + \"\\\" cy=\\\"\" + size + \"\\\" rx=\\\"1\\\" ry=\\\"1\\\" fill=\\\"#999999\\\"/>\\n</pattern>\").trim();\n\t\t},\n\t\tLabel: _lodash2.default.template(\"\\n<% var box = _.has(data, \\\"dx\\\") ? data : (data.getLabelBox ? data.getLabelBox() : null); \\n   if (box) {%>\\n\\t<g <% if (box.config && box.config.class) {%>class=\\\"<%=box.config.class%>\\\"<%}%>\\t\\t<% if (box.config && box.config.ns) {%>ns=\\\"<%=box.config.ns%>\\\"<%}%>\\t\\t<% if (box.config && box.config.inlineStyle) {%>\\t\\t\\tfont-size=\\\"<%=box.config.fontSize%>\\\"\\t\\t\\tfont-family=\\\"<%=box.config.fontFamily%>\\\"\\t\\t\\tfont-weight=\\\"<% if (box.bold) {%>bold<%} else {%>normal<%}%>\\\"\\t\\t\\t<% if (box.underline) {%>text-decoration=\\\"underline\\\"<%}%>\\t\\t\\t<% if (box.italic) {%>font-style=\\\"italic\\\"<%}%>\\t\\t<%}%>\\t\\ttext-anchor=\\\"<%=box.anchor%>\\\"\\t\\ttransform=\\\"translate(<%=box.bounds.x%>,<%=box.bounds.y%>)<% if (box.config && box.config.rotation) {%>rotate(<%=box.config.rotation%> <%=box.pivot[0]%> <%=box.pivot[1]%>)<%}%>\\\">\\n\\t<% if (box.config.backgroundStyle) {%>\\n\\t\\t<rect x=\\\"<%=-box.bounds.width/2%>\\\" y=\\\"<%=-box.bounds.height/2%>\\\" width=\\\"<%=box.bounds.width%>\\\" height=\\\"<%=box.bounds.height%>\\\" style=\\\"<%=box.config.backgroundStyle%>\\\"/>\\n\\t<% } if (_.isArray(box.label)) { \\n\\t\\t_.each(box.label, function(value, line) {%>\\n\\t\\t\\t<text <% if (box.config && box.config.textStyle) {%>style=\\\"<%=box.config.textStyle%>\\\"<%}%>\\t\\t\\t\\tdx=\\\"<%=box.dx%>\\\" dy=\\\"<%=box.dy + box.lineHeight * line%>\\\"><%=value%></text>\\n\\t\\t<%});} else { %>\\n\\t\\t\\t<text><%=box.label%></text>\\n\\t\\t<%}%>\\n\\t</g>\\n<%}%>\\n\".trim(), { variable: \"data\" }) //TODO add more inline text styles.\n\t};\n\t\n\texports.default = SVGRenderer;\n\n/***/ }\n/******/ ])\n});\n;\n"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n/** WEBPACK FOOTER **\n ** webpack/bootstrap 8111cfb5237890631cf8\n **/","import Base64 from \"./util/base64\";\nimport Cache from \"./util/Utils\";\nimport Utils from \"./util/Utils\";\nimport DomUtils from \"./util/DomUtils\";\nimport StringBuffer from \"./util/StringBuffer\";\nimport Point from \"./geometry/Point\";\nimport Line from \"./geometry/Line\";\nimport Shape from \"./geometry/Shape\";\nimport Rectangle from \"./geometry/Rectangle\";\nimport Ellipse from \"./geometry/Ellipse\";\nimport Link from \"./geometry/Link\";\nimport Events from \"bean\";\nimport EventDispatcher from \"./event/EventDispatcher\";\nimport Graph from \"./graph/Graph\";\nimport Cell from \"./graph/Cell\";\nimport Node from \"./graph/Node\";\nimport Edge from \"./graph/Edge\";\nimport Layout from \"./layout/Layout\";\nimport FlowLayout from \"./layout/FlowLayout\";\nimport Label from \"./view/Label\";\nimport Marker from \"./view/Marker\";\nimport Renderer from \"./view/Renderer\";\nimport SVGRenderer from \"./view/SVGRenderer\";\nimport GraphBehavior from \"./behavior/GraphBehavior\";\nimport SelectionBehavior from \"./behavior/SelectionBehavior\";\n\nShape.addShape(\"Rectangle\", Rectangle);\nShape.addShape(\"Ellipse\", Ellipse);\n\nexport default {\n\tEvents,\n\tBase64,\n\tCache,\n\tUtils,\n\tDomUtils,\n\tStringBuffer,\n\tPoint,\n\tLine,\n\tShape,\n\tRectangle,\n\tEllipse,\n\tLink,\n\tEventDispatcher,\n\tLabel,\n\tMarker,\n\tGraph,\n\tCell,\n\tNode,\n\tEdge,\n\tLayout,\n\tFlowLayout,\n\tRenderer,\n\tSVGRenderer,\n\tGraphBehavior,\n\tSelectionBehavior\n};\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/index.js\n **/","// http://www.webtoolkit.info/javascript-base64.html\n\nvar Base64 = {\n\n\t// private property\n\t_keyStr : \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=\",\n\n\t// public method for encoding\n\tencode : function (input) {\n\t\tvar output = \"\";\n\t\tvar chr1, chr2, chr3, enc1, enc2, enc3, enc4;\n\t\tvar i = 0;\n\n\t\tinput = Base64._utf8_encode(input);\n\n\t\twhile (i < input.length) {\n\n\t\t\tchr1 = input.charCodeAt(i++);\n\t\t\tchr2 = input.charCodeAt(i++);\n\t\t\tchr3 = input.charCodeAt(i++);\n\n\t\t\tenc1 = chr1 >> 2;\n\t\t\tenc2 = ((chr1 & 3) << 4) | (chr2 >> 4);\n\t\t\tenc3 = ((chr2 & 15) << 2) | (chr3 >> 6);\n\t\t\tenc4 = chr3 & 63;\n\n\t\t\tif (isNaN(chr2)) {\n\t\t\t\tenc3 = enc4 = 64;\n\t\t\t} else if (isNaN(chr3)) {\n\t\t\t\tenc4 = 64;\n\t\t\t}\n\n\t\t\toutput = output +\n\t\t\tthis._keyStr.charAt(enc1) + this._keyStr.charAt(enc2) +\n\t\t\tthis._keyStr.charAt(enc3) + this._keyStr.charAt(enc4);\n\n\t\t}\n\n\t\treturn output;\n\t},\n\n\t// public method for decoding\n\tdecode : function (input) {\n\t\tvar output = \"\";\n\t\tvar chr1, chr2, chr3;\n\t\tvar enc1, enc2, enc3, enc4;\n\t\tvar i = 0;\n\n\t\tinput = input.replace(/[^A-Za-z0-9\\+\\/\\=]/g, \"\");\n\n\t\twhile (i < input.length) {\n\n\t\t\tenc1 = this._keyStr.indexOf(input.charAt(i++));\n\t\t\tenc2 = this._keyStr.indexOf(input.charAt(i++));\n\t\t\tenc3 = this._keyStr.indexOf(input.charAt(i++));\n\t\t\tenc4 = this._keyStr.indexOf(input.charAt(i++));\n\n\t\t\tchr1 = (enc1 << 2) | (enc2 >> 4);\n\t\t\tchr2 = ((enc2 & 15) << 4) | (enc3 >> 2);\n\t\t\tchr3 = ((enc3 & 3) << 6) | enc4;\n\n\t\t\toutput = output + String.fromCharCode(chr1);\n\n\t\t\tif (enc3 != 64) {\n\t\t\t\toutput = output + String.fromCharCode(chr2);\n\t\t\t}\n\t\t\tif (enc4 != 64) {\n\t\t\t\toutput = output + String.fromCharCode(chr3);\n\t\t\t}\n\n\t\t}\n\n\t\toutput = Base64._utf8_decode(output);\n\n\t\treturn output;\n\n\t},\n\n\t// private method for UTF-8 encoding\n\t_utf8_encode : function (string) {\n\t\tstring = string.replace(/\\r\\n/g,\"\\n\");\n\t\tvar utftext = \"\";\n\n\t\tfor (var n = 0; n < string.length; n++) {\n\n\t\t\tvar c = string.charCodeAt(n);\n\n\t\t\tif (c < 128) {\n\t\t\t\tutftext += String.fromCharCode(c);\n\t\t\t}\n\t\t\telse if((c > 127) && (c < 2048)) {\n\t\t\t\tutftext += String.fromCharCode((c >> 6) | 192);\n\t\t\t\tutftext += String.fromCharCode((c & 63) | 128);\n\t\t\t}\n\t\t\telse {\n\t\t\t\tutftext += String.fromCharCode((c >> 12) | 224);\n\t\t\t\tutftext += String.fromCharCode(((c >> 6) & 63) | 128);\n\t\t\t\tutftext += String.fromCharCode((c & 63) | 128);\n\t\t\t}\n\n\t\t}\n\n\t\treturn utftext;\n\t},\n\n\t// private method for UTF-8 decoding\n\t_utf8_decode : function (utftext) {\n\t\tvar string = \"\";\n\t\tvar i = 0;\n\t\tvar c = c1 = c2 = 0;\n\n\t\twhile ( i < utftext.length ) {\n\n\t\t\tc = utftext.charCodeAt(i);\n\n\t\t\tif (c < 128) {\n\t\t\t\tstring += String.fromCharCode(c);\n\t\t\t\ti++;\n\t\t\t}\n\t\t\telse if((c > 191) && (c < 224)) {\n\t\t\t\tc2 = utftext.charCodeAt(i+1);\n\t\t\t\tstring += String.fromCharCode(((c & 31) << 6) | (c2 & 63));\n\t\t\t\ti += 2;\n\t\t\t}\n\t\t\telse {\n\t\t\t\tc2 = utftext.charCodeAt(i+1);\n\t\t\t\tc3 = utftext.charCodeAt(i+2);\n\t\t\t\tstring += String.fromCharCode(((c & 15) << 12) | ((c2 & 63) << 6) | (c3 & 63));\n\t\t\t\ti += 3;\n\t\t\t}\n\n\t\t}\n\n\t\treturn string;\n\t}\n\n};\n\nexport default Base64;\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/util/base64.js\n **/","import Point from \"../geometry/Point\";\nimport Rectangle from \"../geometry/Rectangle\";\n\n// bean requires the existence of window\nif (typeof window === 'undefined' && typeof global !== 'undefined') {\n\tglobal.window = { addEventHandler: function() {} };\n\tglobal.document = {};\n\tglobal.navigator = {};\n}\n\n// util variables\nlet _debugging = [], _debugAll = false, typeRegistry = {}, splice = Array.splice;\n\n/**\n * Utility functions\n */\nexport default {\n\ttype: function (namespace, name, type) {\n\t\tif (!typeRegistry[namespace])\n\t\t\ttypeRegistry[namespace] = new Map();\n\t\tif (!name)\n\t\t\treturn typeRegistry[namespace];\n\t\tif (!type)\n\t\t\treturn typeRegistry[namespace].get(name);\n\t\ttypeRegistry[namespace].set(name, type);\n\t},\n\n\tcreateType: function (namespace, props, defaultType) {\n\t\tlet name = props.name;\n\n\t\t// first check if type exists\n\t\tlet type = this.type(namespace, name);\n\t\tif (!type) {\n\t\t\tlet extend = props.extends ? this.type(namespace, props.extends) : null;\n\t\t\tif (!extend && defaultType)\n\t\t\t\textend = defaultType;\n\t\t\tif (extend)\n\t\t\t\ttype = class extends extend {\n\t\t\t\t};\n\t\t\telse {\n\t\t\t\ttype = class {\n\t\t\t\t\tconstructor(config) {\n\t\t\t\t\t\t_.assign(this, config);\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t}\n\t\t\tdelete props.name;\n\t\t\tdelete props.extends;\n\t\t\t_.assign(type.prototype, props);\n\t\t\ttype.typeName = name;\n\t\t\tthis.type(namespace, name, type);\n\t\t\tthis.log('Utils', 'Utils.createType - ' + namespace + '.' + name);\n\t\t}\n\t\treturn type;\n\t},\n\n\tbuildTypes: function (types, namespace, defaultType) {\n\t\tthis.log('Utils', 'Utils.buildTypes - ' + namespace);\n\n\t\tif (!types && defaultType) {\n\t\t\tthis.createType(namespace, defaultType);\n\t\t\tthis.log('Utils', 'Utils.buildTypes end');\n\t\t\treturn;\n\t\t}\n\t\tif (defaultType) {\n\t\t\tlet type = _.remove(types, {name: defaultType.name});\n\t\t\ttype = type.length > 0 ? type[0] : null;\n\t\t\tif (type)\n\t\t\t\tdefaultType = this.createType(namespace, _.defaultsDeep(type, defaultType));\n\t\t\telse\n\t\t\t\tdefaultType = this.createType(namespace, defaultType);\n\t\t}\n\n\t\t_.forEach(types, (type) => {\n\t\t\tthis.createType(namespace, type, defaultType);\n\t\t});\n\t\tthis.log('Utils', 'Utils.buildTypes end');\n\t},\n\n\t// Helper function to correctly set up the prototype chain, for subclasses.\n\t// Similar to `goog.inherits`, but uses a hash of prototype properties and\n\t// class properties to be extended.\n\textend: function (child, parent, protoProps, staticProps) {\n\t\t// Add static properties to the constructor function, if supplied.\n\t\t_.extend(child, parent, staticProps);\n\n\t\t// Set the prototype chain to inherit from `parent`, without calling\n\t\t// `parent`'s constructor function.\n\t\tvar Surrogate = function () {\n\t\t\tthis.constructor = child;\n\t\t};\n\t\tSurrogate.prototype = parent.prototype;\n\t\tchild.prototype = new Surrogate;\n\n\t\t// Add prototype properties (instance properties) to the subclass,\n\t\t// if supplied.\n\t\tif (protoProps) _.extend(child.prototype, protoProps);\n\n\t\t// Set a convenience property in case the parent's prototype is needed later.\n\t\tchild.superclass = parent.prototype;\n\n\t\treturn child;\n\t},\n\n\tinitConfig: function (obj, config) {\n\t\tlet props = {}, c = obj.constructor, cArr = [c];\n\t\twhile (c) {\n\t\t\tif (c.super) {\n\t\t\t\tc = c.super.constructor;\n\t\t\t\tsplice.apply(cArr, [0, 0, c]);\n\t\t\t} else\n\t\t\t\tc = null;\n\t\t}\n\n\t\tfor (let i = 0; i < cArr.length; i++) {\n\t\t\tc = cArr[i];\n\t\t\tif (c.DEFAULTS)\n\t\t\t\t_.assign(props, c.DEFAULTS);\n\t\t}\n\t\tobj.props = _.assign(props, config);\n\t\tc.prototype.prop = function (name, value) {\n\t\t\tif (!value)\n\t\t\t\treturn this.props[name];\n\t\t\tthis.props[name] = value;\n\t\t};\n\t},\n\n\t/**\n\t * Gets the JS class constructor.\n\t * @param {Object} jsClass\n\t * @param {Object} defaultClass\n\t */\n\tgetConstructor: function (jsClass, defaultClass) {\n\t\tif (!jsClass)\n\t\t\tjsClass = defaultClass;\n\n\t\tif (_.isString(jsClass))\n\t\t\tjsClass = eval(jsClass);\n\t\treturn jsClass;\n\t},\n\n\tdebug: function (moduleName) {\n\t\tif (moduleName) {\n\t\t\t_debugging.push(moduleName);\n\t\t} else {\n\t\t\t_debugAll = true;\n\t\t}\n\t},\n\n\tlog: function (name, message) {\n\t\tif (!window.console) {\n\t\t\treturn;\n\t\t}\n\t\tvar debug = _debugAll;\n\t\tif (!_debugAll) {\n\t\t\tdebug = false;\n\t\t\tfor (var i = 0; i < _debugging.length; i++) {\n\t\t\t\tif (_debugging[i] == name) debug = true;\n\t\t\t}\n\t\t}\n\t\tif (!debug) {\n\t\t\treturn;\n\t\t}\n\t\twhile (name.length < 10) {\n\t\t\tname = name + ' ';\n\t\t}\n\t\tname = name.substring(0, 10) + \" - \";\n\t\tconsole.info(name, message);\n\t},\n\n\t/**\n\t * Get the relative position of sub shapes within a parent share.\n\t * @param bounds\n\t * @param geometry The geometry information, the format of Geometry is:\n\t * {\n\t *      x: \"x coordinate of ref point, if less than 1, will be treated as the percentage of the parent width.\",\n\t *      y: \"y coordinate of ref point.\",\n\t *      anchorX: \"x pos of child relative to the ref point\",\n\t *      anchorY: \"y pos of child relative to the ref point\",\n\t *      offsetX: \"the offset in the x direction.\",\n\t *      offsetY: \"the offset in the y direction.\",\n\t *      width: \"the width of the child element\",\n\t *      height: \"the height of the child element\"\n\t * }\n\t * @returns {*[]}\n\t */\n\tgetRelativePosition: function (bounds, geometry) {\n\t\tlet x = Math.abs(geometry.x) <= 1 ? bounds.width * geometry.x : geometry.x;\n\t\tlet y = Math.abs(geometry.y) <= 1 ? bounds.height * geometry.y : geometry.y;\n\t\treturn this.offsetPosition([x, y], geometry);\n\t},\n\n\toffsetPosition: function (pos, geometry) {\n\t\treturn [pos[0] + geometry.width * geometry.anchorX + geometry.offsetX, pos[1] + geometry.height * geometry.anchorY + geometry.offsetY];\n\t},\n\n\t/**\n\t * Get the position relative to the graph that's unscaled, i.e., absolute position without considering translation and scale.\n\t * @param t the current translate\n\t * @param scale the current scale\n\t * @param o can be either a Point or a Rectangle or a Point array.\n\t */\n\tunscale: function (t, scale, o) {\n\t\tif (o instanceof Rectangle)\n\t\t\treturn new Rectangle(o.x * scale + t[0], o.y * scale + t[1], o.width * scale, o.height * scale);\n\t\telse if (o instanceof Point)\n\t\t\treturn new Point(o.x * scale + t[0], o.y * scale + t[1]);\n\t\telse\n\t\t\treturn [o[0] * scale + t[0], o[1] * scale + t[1]];\n\t},\n\n\t/**\n\t * Get the position relative to the graph that's scaled, i.e., relative position considering translation and scale.\n\t * @param t the current translation\n\t * @param scale the current scale\n\t * @param o can be either a Point or a Rectangle or a Point array.\n\t */\n\tscale: function (t, scale, o) {\n\t\tif (o instanceof Rectangle)\n\t\t\treturn new Rectangle((o.x - t[0]) / scale, (o.y - t[1]) / scale, o.width / scale, o.height / scale);\n\t\telse if (o instanceof Point)\n\t\t\treturn new Point((o.x - t[0]) / scale, (o.y - t[1]) / scale);\n\t\telse\n\t\t\treturn [(o[0] - t[0]) / scale, (o[1] - t[1]) / scale];\n\t},\n\n\t/**\n\t * Convenience method.\n\t */\n\tgetProperty: function (obj, prop) {\n\t\tif (!obj)\n\t\t\treturn null;\n\t\tif (_.has(obj, prop))\n\t\t\treturn obj[prop];\n\t\tif (obj.prop && _.isFunction(obj.prop))\n\t\t\treturn obj.prop(prop);\n\t\treturn null;\n\t}\n};\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/util/Utils.js\n **/","class Point {\n\tconstructor(x, y) {\n\t\tthis.x = x;\n\t\tthis.y = y;\n\t}\n\n\t/**\n\t * Make a clone of this point\n\t */\n\tclone() {\n\t\treturn new Point(this.x, this.y);\n\t}\n\n\t/**\n\t * Calculate the distance from this pt to the other pt.\n\t * @param aPt\n\t * @returns {number}\n\t */\n\tdistance(aPt) {\n\t\treturn Math.sqrt((this.x - aPt.x) * (this.x - aPt.x) + (this.y - aPt.y) * (this.y - aPt.y));\n\t}\n\n\t/**\n\t * Translate this point\n \t */\n\ttranslate(p2) {\n\t\tthis.x += p2.x;\n\t\tthis.y += p2.y;\n\t\treturn this;\n\t}\n\n\t/**\n\t * Scale this vector\n \t */\n\tscale(scale) {\n\t\tthis.x *= scale;\n\t\tthis.y *= scale;\n\t\treturn this;\n\t}\n\n\tgetScaled(scale) {\n\t\treturn new Point(this.x * scale, this.y * scale);\n\t}\n\n\tgetTranslated(p2) {\n\t\treturn new Point(this.x + p2.x, this.y + p2.y);\n\t}\n\n\t/**\n\t * Get the direction vector from this point to p2.\n\t * @param p2\n\t * @returns {Point}\n\t */\n\tgetDirection(p2) {\n\t\tvar dist = this.distance(p2);\n\t\treturn new Point((p2.x - this.x) / dist, (p2.y - this.y) / dist);\n\t}\n\n\t/**\n\t * rotate the point about the origin. With the specified angle.\n\t * @param angle the angle to rotate\n\t */\n\trotate(angle) {\n\t\tvar cos = Math.cos(angle * Math.PI / 180);\n\t\tvar sin = Math.sin(angle * Math.PI / 180);\n\t\tvar x = this.x, y = this.y;\n\t\tthis.x = x * cos - y * sin;\n\t\tthis.y = x * sin + y * cos;\n\t\treturn this;\n\t}\n\n\tgetRotated(angle) {\n\t\treturn this.clone().rotate(angle);\n\t}\n\n\t/**\n\t * Calculate the dot product, treating this and p2 as vectors.\n\t */\n\tdotProduct(p2) {\n\t\treturn this.x * p2.x + this.y * p2.y;\n\t}\n\n\t/**\n\t * Get the mid point between this and p2.\n \t */\n\tgetMidPoint(p2) {\n\t\treturn new Point((this.x + p2.x) / 2, (this.y + p2.y) / 2);\n\t}\n\n\treverse() {\n\t\tthis.x = -this.x;\n\t\tthis.y = -this.y;\n\t\treturn this;\n\t}\n\n\tequals(p2) {\n\t\tif (!p2 || p2.constructor != Point) return false;\n\n\t\treturn (this.x == p2.x && this.y == p2.y);\n\t}\n\n\t/**\n\t * Reflect this point w.r.t. the rectangle.\n\t * If vertical is true, it will reflect the point cross the vertical\n\t * central line of the rectangle, otherwise reflect cross the horizontal\n\t * central line.\n\t *\n\t * @param rect the rectangle\n\t * @param vertical whether is vertical reflection or horizontal reflection.\n\t */\n\treflect(rect, vertical) {\n\t\tif (vertical)\n\t\t\tthis.x = 2 * rect.x - this.x;\n\t\telse\n\t\t\tthis.y = 2 * rect.y - this.y;\n\t\treturn this;\n\t}\n\n\ttoString() {\n\t\treturn this.x + \",\" + this.y;\n\t}\n}\n\nPoint.W = new Point(-1, 0);\nPoint.N = new Point(0, -1);\nPoint.S = new Point(0, 1);\nPoint.E = new Point(1, 0);\nPoint.NE = new Point(1, -1);\nPoint.NW = new Point(-1, -1);\nPoint.SE = new Point(1, 1);\nPoint.SW = new Point(-1, 1);\n\nexport default Point;\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/geometry/Point.js\n **/","import _ from \"lodash\";\r\nimport Point from \"./Point\";\r\nimport Shape from \"./Shape\";\r\n\r\nexport default class Rectangle extends Shape {\r\n\t/**\r\n\t * Checks whether this rectangle contains a given point of a given rectangle\r\n\t */\r\n\tcontains(el) {\r\n\t\tlet w = el.width || 0;\r\n\t\tlet h = el.height || 0;\r\n\t\tlet left = el.x - w/2;\r\n\t\tlet right = el.x + w/2;\r\n\t\tlet top = el.y - h/2;\r\n\t\tlet bottom = el.y + h/2;\r\n\t\treturn (right <= this.right) && (left >= this.left) &&\r\n\t\t\t(top >= this.top) && (bottom <= this.bottom);\r\n\t}\r\n\r\n\t/**\r\n\t * Calcualte the distance to a point. 0 if this rectangle contains the point.\r\n\t */\r\n\tdistance(pt) {\r\n\t\tif (this.contains(pt)) return 0;\r\n\r\n\t\tif (pt.x < this.left) {\r\n\t\t\tif (pt.y < this.top)\r\n\t\t\t\treturn pt.distance(new Point(this.left, this.top));\r\n\t\t\tif (pt.y <= this.bottom)\r\n\t\t\t\treturn this.left - pt.x;\r\n\t\t\treturn pt.distance(new Point(this.left, this.bottom));\r\n\t\t}\r\n\t\tif (pt.x <= this.right) {\r\n\t\t\tif (pt.y <= this.top)\r\n\t\t\t\treturn this.top - pt.y;\r\n\t\t\treturn pt.y - this.bottom;\r\n\t\t}\r\n\t\tif (pt.y < this.top)\r\n\t\t\treturn pt.distance(new Point(this.right, this.top));\r\n\t\tif (pt.y <= this.bottom)\r\n\t\t\treturn pt.x - this.right;\r\n\t\treturn pt.distance(new Point(this.right, this.bottom));\r\n\t}\r\n\r\n\t/**\r\n\t * Given two points, we want to detect whether the line joining the pts intersect\r\n\t * with the rectangle or not. We assume only horizontal or vertical line segments.\r\n\t *\r\n\t * @return int the side of the intersection: -1: no intersection, 0: left, 1: top, 2: right, 3: bottom, 4: containment.\r\n\t */\r\n\tdetectIntersection(pt1, pt2) {\r\n\t\tlet horizontal = pt1.y == pt2.y;\r\n\t\tlet contains1 = this.contains(pt1);\r\n\t\tlet contains2 = this.contains(pt2);\r\n\t\tif (contains1 && contains2) return 4;\r\n\t\tif (!contains1 && !contains2) {\r\n\t\t\tif (horizontal && (pt1.y >= this.top && pt1.y <= this.bottom)) {\r\n\t\t\t\tif (pt1.x < this.left && pt2.x > this.right)\r\n\t\t\t\t\treturn 0;\r\n\t\t\t\tif (pt1.x > this.right && pt2.x < this.left)\r\n\t\t\t\t\treturn 2;\r\n\t\t\t}\r\n\t\t\tif (!horizontal && (pt1.x >= this.left && pt1.x <= this.right)) {\r\n\t\t\t\tif (pt1.y < this.top && pt2.y > this.bottom)\r\n\t\t\t\t\treturn 1;\r\n\t\t\t\tif (pt1.y > this.bottom && pt2.y < this.top)\r\n\t\t\t\t\treturn 3;\r\n\t\t\t}\r\n\t\t\treturn -1;\r\n\t\t}\r\n\r\n\t\tlet outPt = contains1 ? pt2 : pt1;\r\n\t\tif (horizontal) {\r\n\t\t\tif (outPt.x > this.right)\r\n\t\t\t\treturn 2;\r\n\t\t\treturn 0;\r\n\t\t} else {\r\n\t\t\tif (outPt.y < this.top)\r\n\t\t\t\treturn 1;\r\n\t\t\treturn 3;\r\n\t\t}\r\n\t}\r\n\r\n\ttoString() {\r\n\t\treturn 'Rectangle:{x=' + this.x + ';y=' + this.y + ';width=' + this.width + ';height=' + this.height + '}';\r\n\t}\r\n\r\n\tstatic getPerimeter(rect, pt, orthogonal = false) {\r\n\t\tlet x = rect.x;\r\n\t\tlet y = rect.y;\r\n\t\tlet dx = pt.x - x;\r\n\t\tlet dy = pt.y - y;\r\n\t\tlet alpha = Math.atan2(dy, dx);\r\n\t\tlet p = new Point(0, 0);\r\n\t\tlet pi = Math.PI;\r\n\t\tlet pi2 = Math.PI/2;\r\n\t\tlet beta = pi2 - alpha;\r\n\t\tlet t = Math.atan2(rect.height, rect.width);\r\n\r\n\t\tif (alpha < -pi + t || alpha > pi - t) {\r\n\t\t\t// Left edge\r\n\t\t\tp.x = rect.left;\r\n\t\t\tp.y = y - rect.width * Math.tan(alpha) / 2;\r\n\t\t} else if (alpha < -t) {\r\n\t\t\t// Top Edge\r\n\t\t\tp.y = rect.top;\r\n\t\t\tp.x = x - rect.height * Math.tan(beta) / 2;\r\n\t\t} else if (alpha < t) {\r\n\t\t\t// Right Edge\r\n\t\t\tp.x = rect.right;\r\n\t\t\tp.y = y + rect.width * Math.tan(alpha) / 2;\r\n\t\t} else {\r\n\t\t\t// Bottom Edge\r\n\t\t\tp.y = rect.bottom;\r\n\t\t\tp.x = x + rect.height * Math.tan(beta) / 2;\r\n\t\t}\r\n\r\n\t\tif (orthogonal) {\r\n\t\t\tif (alpha < -pi + t || alpha > pi - t) {\r\n\t\t\t\t// Left edge\r\n\t\t\t\tp.x = rect.left;\r\n\t\t\t\tp.y = y;\r\n\t\t\t} else if (alpha < -t) {\r\n\t\t\t\t// Top Edge\r\n\t\t\t\tp.y = rect.top;\r\n\t\t\t\tp.x = x;\r\n\t\t\t} else if (alpha < t) {\r\n\t\t\t\t// Right Edge\r\n\t\t\t\tp.x = rect.right;\r\n\t\t\t\tp.y = y;\r\n\t\t\t} else {\r\n\t\t\t\t// Bottom Edge\r\n\t\t\t\tp.y = rect.bottom;\r\n\t\t\t\tp.x = x;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tlet dir = Rectangle.getDirection(rect, p, orthogonal);\r\n\t\treturn {point: p, direction: dir};\r\n\t}\r\n\r\n\t/**\r\n\t * Return the bounding rectangle that contains p1 and p2\r\n\t */\r\n\tstatic getBoundingRectangle(pts, margin) {\r\n\t\tif (!pts || pts.length == 0) return null;\r\n\t\tmargin = margin || [0, 0, 0, 0];\r\n\t\tif (!_.isArray(margin))\r\n\t\t\tmargin = [margin, margin, margin, margin];\r\n\t\tlet min = [pts[0].x, pts[0].y];\r\n\t\tlet max = [pts[0].x, pts[0].y];\r\n\t\tfor (let i = 1; i < pts.length; i++) {\r\n\t\t\tlet p = pts[i];\r\n\t\t\tif (p.x < min[0]) {\r\n\t\t\t\tmin[0] = p.x;\r\n\t\t\t}\r\n\t\t\tif (p.y < min[1]) {\r\n\t\t\t\tmin[1] = p.y;\r\n\t\t\t}\r\n\t\t\tif (p.x > max[0]) {\r\n\t\t\t\tmax[0] = p.x;\r\n\t\t\t}\r\n\t\t\tif (p.y > max[1]) {\r\n\t\t\t\tmax[1] = p.y;\r\n\t\t\t}\r\n\t\t}\r\n\t\tmin[0] = min[0] - margin[0];\r\n\t\tmin[1] = min[1] - margin[1];\r\n\t\tmax[0] = max[0] + margin[2];\r\n\t\tmax[1] = max[1] + margin[3];\r\n\t\tlet w = Math.abs(max[0] - min[0]);\r\n\t\tlet h = Math.abs(max[1] - min[1]);\r\n\t\treturn new Rectangle(min[0] + w/2, min[1] + h/2, w, h);\r\n\t}\r\n\r\n\t/**\r\n\t * Create a union of all the rectangles.\r\n\t * @param rects\r\n\t */\r\n\tstatic union(rects) {\r\n\t\tlet minx = null, miny = null, maxx = -Infinity, maxy = -Infinity;\r\n\t\t_.each(rects, function (rect) {\r\n\t\t\tminx = minx || rect.x;\r\n\t\t\tminy = miny || rect.y;\r\n\t\t\tminx = Math.min(minx, rect.x);\r\n\t\t\tminy = Math.min(miny, rect.y);\r\n\t\t\tmaxx = Math.max(maxx, rect.right());\r\n\t\t\tmaxy = Math.max(maxy, rect.bottom());\r\n\t\t});\r\n\t\tminx = minx || 0;\r\n\t\tminy = miny || 0;\r\n\t\treturn new Rectangle(minx, miny, maxx - minx, maxy - miny);\r\n\t}\r\n\r\n\t/**\r\n\t * Returns the direction the point <i>p</i> is in relation to the given rectangle.\r\n\t * Possible values are WEST (-1,0), EAST (1,0), NORTH (0,-1) and SOUTH (0,1) if orthogonal is true, otherwise return\r\n\t * the direction connection the center of r and p.\r\n\t * @param r\r\n\t * @param p\r\n\t * @param orthogonal\r\n\t * @returns {Point|*}\r\n\t */\r\n\tstatic getDirection(r, p, orthogonal = false) {\r\n\t\tif (!orthogonal)\r\n\t\t\treturn new Point(r.x, r.y).getDirection(new Point(p.x, p.y));\r\n\r\n\t\tlet i, distance = Math.abs(r.left - p.x), direction = Point.W;\r\n\r\n\t\ti = Math.abs(r.top - p.y);\r\n\t\tif (i <= distance) {\r\n\t\t\tdistance = i;\r\n\t\t\tdirection = Point.N;\r\n\t\t}\r\n\r\n\t\ti = Math.abs(r.bottom - p.y);\r\n\t\tif (i <= distance) {\r\n\t\t\tdistance = i;\r\n\t\t\tdirection = Point.S;\r\n\t\t}\r\n\r\n\t\ti = Math.abs(r.right - p.x);\r\n\t\tif (i < distance) {\r\n\t\t\tdirection = Point.E;\r\n\t\t}\r\n\r\n\t\treturn direction;\r\n\t}\r\n}\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/geometry/Rectangle.js\n **/","module.exports = __WEBPACK_EXTERNAL_MODULE_5__;\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external {\"root\":\"_\",\"commonjs\":\"lodash\",\"commonjs2\":\"lodash\",\"amd\":\"lodash\"}\n ** module id = 5\n ** module chunks = 0\n **/","import _ from \"lodash\";\nimport Point from \"./Point\";\nimport Rectangle from \"./Rectangle\";\n\nlet registry = {};\n\nclass Shape {\n\tconstructor(x, y, width, height, config) {\n\t\tthis.x = x;\n\t\tthis.y = y;\n\t\tthis.width = width;\n\t\tthis.height = height;\n\t\t_.defaults(this, config, {x: 0, y: 0, width: 0, height: 0});\n\t}\n\n\t/**\n\t * Return the y-coord of the top side of this rectangle\n\t */\n\tget top() { return this.y - this.height/2; }\n\n\t/**\n\t * Returns the y-coordinate of the bottom of this Rectangle.\n\t */\n\tget bottom() { return this.y + this.height/2; }\n\n\t/**\n\t * Return the x-coord of left side of this rectangle\n\t */\n\tget left() { return this.x - this.width/2; }\n\n\t/**\n\t * Returns the x-coordinate of the right side of this Rectangle.\n\t */\n\tget right() { return this.x + this.width/2; }\n\n\tget center() { return new Point(this.x, this.y); }\n\n\tget bounds() { return new Rectangle(this.x, this.y, this.width, this.height); }\n\n\tcontains(el) { return false; }\n\n\t/**\n\t * This will generate n ports on the shape.\n\t */\n\tgetRegularPoints(n) {return null;}\n\n\t/**\n\t * Get the intersection between boundary of this shape and the line connecting (x,y) with the refPt.\n\t * @param refPt\n\t * @returns {null}\n\t */\n\tgetPerimeter(refPt, orthogonal = false) {\n\t\treturn this.constructor.getPerimeter(this, refPt, orthogonal);\n\t}\n\n\trender(view) {\n\t\tlet template = _.template(view.getTemplate(this.name, this));\n\t\treturn template(this);\n\t}\n\n\tstatic getShape(name) {\n\t\treturn registry[name];\n\t}\n\n\tstatic addShape(name, c) {\n\t\tregistry[name] = c;\n\t}\n\n\tstatic removeShape(name) {\n\t\tdelete registry[name];\n\t}\n}\n\nexport default Shape;\n\n\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/geometry/Shape.js\n **/","import _ from \"lodash\";\n\n/**\n * dom Utility functions\n */\nexport default {\n\tisIE: (function () {\n\t\tif (!window || !window.navigator || !navigator) return false;\n\t\tvar sAgent = window.navigator.userAgent;\n\t\tvar Idx = sAgent.indexOf(\"MSIE\");\n\n\t\t// If IE, return version number.\n\t\tif (Idx > 0)\n\t\t\treturn parseInt(sAgent.substring(Idx + 5, sAgent.indexOf(\".\", Idx)));\n\n\t\t// If IE 11 then look for Updated user agent string.\n\t\telse if (!!navigator.userAgent.match(/Trident\\/7\\./))\n\t\t\treturn 11;\n\t\telse if (!!navigator.userAgent.match(/Edge\\//))\n\t\t\treturn \"Edge\";\n\t\telse\n\t\t\treturn false;\n\t})(),\n\n\tisFireFox : (function(){\n\t\t// InstallTrigger: Firefox's API to install add-ons\n\t\treturn typeof InstallTrigger !== 'undefined';\n\t})(),\n\n\tisChrome: (function() {\n\t\tif (!window || !window.navigator || !navigator || navigator.userAgent.indexOf('Edge') >= 0) return false;\n\t\tvar raw = navigator.userAgent.match(/Chrom(e|ium)\\/([0-9]+)\\./);\n\t\treturn raw ? parseInt(raw[2], 10) : false;\n\t})(),\n\n\tcreateElement: function (tag, attribs, styles, html) {\n\t\tlet el = document.createElement(tag);\n\t\tthis.setElement(el, attribs, styles);\n\t\tif (html)\n\t\t\tel.innerHTML = html;\n\t\treturn el;\n\t},\n\n\tcreateElementByString: function(str) {\n\t\tlet temp = this.createElement('div', null, null, str);\n\t\treturn temp.childNodes;\n\t},\n\n\tsetElement: function (el, attribs, styles) {\n\t\tif (attribs) {\n\t\t\t_.forEach(attribs, function(value, key) {\n\t\t\t    el.setAttribute(key, value);\n\t\t\t });\n\t\t}\n\t\tif (styles) {\n\t\t\t_.forEach(styles, function(value, key) {\n\t\t\t\tel.style[key] = value;\n\t\t\t});\n\t\t}\n\t},\n\n\ttestElement: function(node, method) {\n\t\treturn node && node.nodeType == 1 && ( !method || method(node) );\n\t},\n\n\tgetAncestorBy: function(node, method) {\n\t\twhile (node = node.parentNode)\n\t\t\tif (this.testElement(node, method) )\n\t\t\t\treturn node;\n\n\t\treturn null;\n\t},\n\n\t/**\n\t * Get the position of element relative to the context.\n\t * @param el the element\n\t * @param context\n\t * @returns {*[]}\n\t */\n\tgetPosition(el, context) {\n\t\tif (!context) context = document.body;\n\t\tlet elRect = el.getBoundingClientRect();\n\t\tlet contextRect = context.getBoundingClientRect();\n\n\t\treturn [elRect.left - contextRect.left, elRect.top - contextRect.top];\n\t},\n\n\tgetCenterPosition(el, context) {\n\t\tif (!context) context = document.body;\n\t\tlet elRect = el.getBoundingClientRect();\n\t\tlet contextRect = context.getBoundingClientRect();\n\t\tlet w = elRect.right - elRect.left;\n\t\tlet h = elRect.bottom - elRect.top;\n\n\t\treturn [elRect.left - contextRect.left + w/2, elRect.top - contextRect.top + h/2];\n\t},\n\n\tmove: function(el, x, y) {\n\t\tif (x) el.style.left = x + 'px';\n\t\tif (y) el.style.top = y + 'px';\n\t},\n\n\tgetSize: function(el) {\n\t\tvar w = parseInt(el.style.offsetWidth, 10);\n\t\tvar h = parseInt(el.style.offsetHeight, 10);\n\t\treturn [w, h];\n\t},\n\n\tresize: function(el, w, h) {\n\t\tif (w) el.style.width = w + \"px\";\n\t\tif (h) el.style.height = h + 'px';\n\t},\n\n\tpreloadImages: function(array) {\n\t\tif (!this.preloadImages.list) this.preloadImages.list = [];\n\t\tif (!this.preloadImages.loaded) this.preloadImages.loaded = {};\n\n\t\tvar list = this.preloadImages.list;\n\t\tvar img, that = this;\n\t\tfor (var i = 0; i < array.length; i++) {\n\t\t\timg = new Image();\n\t\t\timg.onload = function() {\n\t\t\t\tvar index = list.indexOf(this);\n\t\t\t\tif (index !== -1) {\n\t\t\t\t\tthat.preloadImages.loaded[this.name] = {width: this.width, height: this.height};\n\t\t\t\t\t// remove image from the array once it's loaded\n\t\t\t\t\t// for memory consumption reasons\n\t\t\t\t\tlist.splice(index, 1);\n\t\t\t\t}\n\t\t\t};\n\t\t\tlist.push(img);\n\t\t\timg.src = array[i];\n\t\t\timg.name = array[i];\n\t\t}\n\t},\n\n\t/**\n\t * Get's the image's information given the url. Must be preloaded by calling the preloadImage function.\n\t * @param src\n\t */\n\tgetImageInfo: function(src) {\n\t\tif (this.preloadImages.loaded) {\n\t\t\treturn this.preloadImages.loaded[src];\n\t\t}\n\t\treturn null;\n\t},\n\n\tdownloadFile: function(name, data) {\n\t\tif (!data) return;\n\t\tlet mime = data.match(/^data:([^;,]*)/)[1];\n\t\tif (name.indexOf('.') < 0) {\n\t\t\tif (!mime) mime = 'text/plain';\n\t\t\tif (mime == 'text/plain')\n\t\t\t\tname = name + '.txt';\n\t\t\telse {\n\t\t\t\tlet type = mime.split('/')[1];\n\t\t\t\tif (type.indexOf('+') > 0) type = type.split('+')[0];\n\t\t\t\tname = name + '.' + type;\n\t\t\t}\n\t\t}\n\t\tif (this.isIE) {\n\t\t\tlet encoded = data.indexOf(';base64') >= 0;\n\t\t\tif (encoded)\n\t\t\t\tdata = atob(data.replace('data:' + mime + ';base64,', ''));\n\t\t\telse\n\t\t\t\tdata = decodeURI(data.replace('data:' + mime + ',', ''));\n\t\t\tdata = this.GetBlob(data, mime);\n\t\t\tnavigator.msSaveBlob(data, name);\n\t\t} else {\n\t\t\tlet link = this.createElement('a', {href: data, download: name}, {display: \"none\"});\n\t\t\tdocument.body.appendChild(link);\n\t\t\tlink.click();\n\t\t\tlink.parentNode.removeChild(link);\n\t\t}\n\t},\n\n\t/**\n\t * Convert b54 to blob. IE only\n\t */\n\tGetBlob: function (data, contentType, sliceSize) {\n\t\tcontentType = contentType || '';\n\t\tsliceSize = sliceSize || 512;\n\n\t\tvar byteArrays = [];\n\n\t\tfor (var offset = 0; offset < data.length; offset += sliceSize) {\n\t\t\tvar slice = data.slice(offset, offset + sliceSize);\n\n\t\t\tvar byteNumbers = new Array(slice.length);\n\t\t\tfor (var i = 0; i < slice.length; i++) {\n\t\t\t\tbyteNumbers[i] = slice.charCodeAt(i);\n\t\t\t}\n\t\t\tvar byteArray = new Uint8Array(byteNumbers);\n\t\t\tbyteArrays.push(byteArray);\n\t\t}\n\t\treturn new Blob(byteArrays, {type: contentType});\n\t},\n\n\topenImage: function(name, image) {\n\t\tvar myWindow = window.open(\"\", \"_blank\", \"toolbar=yes, scrollbars=yes, resizable=yes, width=500, height=500\");\n\t\tvar myDocument = myWindow.document;\n\t\tvar img = myDocument.createElement(\"img\");\n\t\tthis.setElement(img, {src: image, name: name});\n\t\tmyDocument.body.appendChild(img);\n\t},\n\n\t/**\n\t * Check whether the key event is from input, textarea or select.\n\t * @param e  input event\n\t */\n\teventFromInput: function(e){\n\t\tvar tagName = e.target.tagName;\n\t\treturn (tagName == 'INPUT' || tagName == 'TEXTAREA' || tagName == 'SELECT');\n\t}\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/util/DomUtils.js\n **/","import _ from \"lodash\";\n\n/**\n * A string buffer for fast string manipulation\n */\nexport default class StringBuffer {\n\tconstructor(str) {\n\t\tthis.buffer = [];\n\t\tif (str)\n\t\t\tthis.buffer.push(str);\n\t}\n\n\tappend(stuff) {\n\t\tif (_.isString(stuff))\n\t\t\tthis.buffer.push(stuff);\n\t\telse if (_.isArray(stuff))\n\t\t\tthis.buffer = this.buffer.concat(stuff);\n\t\telse\n\t\t\tthis.buffer.push(\"\" + stuff);\n\t\treturn this;\n\t}\n\n\tprepend(stuff) {\n\t\tif (_.isString(stuff))\n\t\t\tthis.buffer.splice(0, 0, stuff);\n\t\telse if (_.isArray(stuff))\n\t\t\tthis.buffer = stuff.concat(this.buffer);\n\t\telse\n\t\t\tthis.buffer.splice(0, 0, \"\" + stuff);\n\t\treturn this;\n\t}\n\n\tclear() {\n\t\tthis.buffer = [];\n\t}\n\n\tremoveLast() {\n\t\tthis.buffer.pop();\n\t\treturn this;\n\t}\n\n\ttoString(sep) {\n\t\tif (!sep) sep = '';\n\t\treturn this.buffer.join(sep);\n\t}\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/util/StringBuffer.js\n **/","import Point from \"./Point\";\n\nexport default class Line {\n\tconstructor(start, end) {\n\t\tthis.start = start;\n\t\tthis.end = end;\n\t}\n\n\t/**\n\t * Calculate the length of this line\n\t */\n\tlength() {\n\t\treturn this.start.distance(this.end);\n\t}\n\n\t/**\n\t * Calculate the distance of this line to the point.\n\t */\n\tdistance(pt) {\n\t\tvar x = this.start.distance(pt);\n\t\tif (x == 0) return 0;\n\n\t\tvar l = this.length();\n\t\tvar cosa = new Point((this.end.x - this.start.x) / l, (this.end.y - this.start.y) / l).dotProduct(\n\t\t\tnew Point(pt.x / x, pt.y / x));\n\n\t\treturn x * Math.sqrt(1 - cosa * cosa);\n\t}\n\n\t/**\n\t * Function: intersection\n\t *\n\t * Returns the intersection of two lines as an <mxPoint>.\n\t *\n\t * Parameters:\n\t *\n\t * x0 - X-coordinate of the first line's startpoint.\n\t * y0 - X-coordinate of the first line's startpoint.\n\t * x1 - X-coordinate of the first line's endpoint.\n\t * y1 - Y-coordinate of the first line's endpoint.\n\t * x2 - X-coordinate of the second line's startpoint.\n\t * y2 - Y-coordinate of the second line's startpoint.\n\t * x3 - X-coordinate of the second line's endpoint.\n\t * y3 - Y-coordinate of the second line's endpoint.\n\t */\n\tstatic intersection(x0, y0, x1, y1, x2, y2, x3, y3) {\n\t\tvar denom = ((y3 - y2) * (x1 - x0)) - ((x3 - x2) * (y1 - y0));\n\t\tvar nume_a = ((x3 - x2) * (y0 - y2)) - ((y3 - y2) * (x0 - x2));\n\t\tvar nume_b = ((x1 - x0) * (y0 - y2)) - ((y1 - y0) * (x0 - x2));\n\n\t\tvar ua = nume_a / denom;\n\t\tvar ub = nume_b / denom;\n\n\t\tif (ua >= 0.0 && ua <= 1.0 && ub >= 0.0 && ub <= 1.0) {\n\t\t\t// Get the intersection point\n\t\t\tvar intersectionX = x0 + ua * (x1 - x0);\n\t\t\tvar intersectionY = y0 + ua * (y1 - y0);\n\n\t\t\treturn new Point(intersectionX, intersectionY);\n\t\t}\n\n\t\t// No intersection\n\t\treturn null;\n\t}\n\n\ttoString() {\n\t\treturn 'Line:{start=' + this.start + ';end=' + this.end + '}';\n\t}\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/geometry/Line.js\n **/","import Shape from \"./Shape\";\r\nimport Point from \"./Point\";\r\nimport Rectangle from \"./Rectangle\";\r\n\r\nexport default class Ellipse extends Shape {\r\n\ttoString() {\r\n\t\treturn 'Ellipse:{x=' + this.x + ';y=' + this.y + ';width=' + this.width + ';height=' + this.height + '}';\r\n\t}\r\n\r\n\tstatic getPerimeter(rect, pt, orthogonal = false) {\r\n\t\tvar a = rect.width / 2;\r\n\t\tvar b = rect.height / 2;\r\n\t\tvar cx = rect.x;\r\n\t\tvar cy = rect.y;\r\n\t\tvar px = pt.x;\r\n\t\tvar py = pt.y;\r\n\r\n\t\t// Calculates straight line equation through\r\n\t\t// point and ellipse center y = d * x + h\r\n\t\tvar dx = parseInt(px - cx);\r\n\t\tvar dy = parseInt(py - cy);\r\n\r\n\t\tvar tx, ty;\r\n\r\n\t\tif (dx == 0 && dy != 0) {\r\n\t\t\treturn new Point(cx, cy + b * dy / Math.abs(dy));\r\n\t\t} else if (dx == 0 && dy == 0) {\r\n\t\t\treturn new Point(px, py);\r\n\t\t}\r\n\r\n\t\t// Calculates intersection\r\n\t\tvar d = dy / dx;\r\n\t\tvar h = cy - d * cx;\r\n\t\tvar e = a * a * d * d + b * b;\r\n\t\tvar f = -2 * cx * e;\r\n\t\tvar g = a * a * d * d * cx * cx + b * b * cx * cx - a * a * b * b;\r\n\t\tvar det = Math.sqrt(f * f - 4 * e * g);\r\n\r\n\t\t// Two solutions (perimeter points)\r\n\t\tvar xout1 = (-f + det) / (2 * e);\r\n\t\tvar xout2 = (-f - det) / (2 * e);\r\n\t\tvar yout1 = d * xout1 + h;\r\n\t\tvar yout2 = d * xout2 + h;\r\n\t\tvar dist1 = Math.sqrt(Math.pow((xout1 - px), 2) + Math.pow((yout1 - py), 2));\r\n\t\tvar dist2 = Math.sqrt(Math.pow((xout2 - px), 2) + Math.pow((yout2 - py), 2));\r\n\r\n\t\t// Correct solution\r\n\t\tvar xout = 0;\r\n\t\tvar yout = 0;\r\n\r\n\t\tif (dist1 < dist2) {\r\n\t\t\txout = xout1;\r\n\t\t\tyout = yout1;\r\n\t\t} else {\r\n\t\t\txout = xout2;\r\n\t\t\tyout = yout2;\r\n\t\t}\r\n\r\n\t\tlet p = new Point(xout, yout);\r\n\t\tlet dir = Rectangle.getDirection(rect, p, orthogonal);\r\n\t\tif (orthogonal) {\r\n\t\t\tif (dir.x == -1) {\r\n\t\t\t\treturn {point: new Point(cx - a, cy), direction: dir};\r\n\t\t\t}\r\n\t\t\tif (dir.x == 1) {\r\n\t\t\t\treturn {point: new Point(cx + a, cy), direction: dir};\r\n\t\t\t}\r\n\t\t\tif (dir.y == -1) {\r\n\t\t\t\treturn {point: new Point(cx, cy - b), direction: dir};\r\n\t\t\t}\r\n\t\t\tif (dir.y == 1) {\r\n\t\t\t\treturn {point: new Point(cx, cy + b), direction: dir};\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn {point: p, direction: dir};\r\n\t}\r\n}\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/geometry/Ellipse.js\n **/","import _ from \"lodash\";\r\nimport Point from \"./Point\";\r\nimport Utils from \"../util/Utils\";\r\n\r\nlet defaultConfig = {\r\n\ttype: \"direct\",\r\n\tshowGauge: true,\r\n\torthogonal: false\r\n};\r\n\r\nlet defaultGeometry = {\r\n\twidth: 0,\r\n\theight: 0,\r\n\tanchorX: 0,\r\n\tanchorY: 0,\r\n\toffsetX: 0,\r\n\toffsetY: 0\r\n};\r\n\r\nlet linkTypes = {};\r\n\r\nclass Link {\r\n\tconstructor(terminalVisual, shapeConfig = {}, startMarker = null, endMarker = null) {\r\n\t\tthis.start = terminalVisual[0].point;\r\n\t\tthis.end = terminalVisual[1].point;\r\n\t\tthis.startNormal = terminalVisual[0].direction;\r\n\t\tthis.endNormal = terminalVisual[1].direction;\r\n\t\tthis.startMarker = startMarker;\r\n\t\tthis.endMarker = endMarker;\r\n\t\t_.assign(this, shapeConfig);\r\n\t}\r\n\r\n\trender(view) {\r\n\t\treturn view.renderLink(this);\r\n\t}\r\n\r\n\tget points() { return null; }\r\n\tget controlPts() { return null; }\r\n\tget length() {\r\n\t\tlet points = this.points;\r\n\t\tlet i, l = 0;\r\n\t\tfor (i = 0; i < points.length - 1; i++)\r\n\t\t\tl += points[i].distance(points[i+1]);\r\n\t\treturn l;\r\n\t}\r\n\r\n\t/**\r\n\t * Calculate the position where to put modifiers or label..\r\n\t *\r\n\t * @param geometry: defines how far along the edge should the point be placed.\r\n\t * @return *[] the relative position.\r\n\t */\r\n\tgetRelativePosition(geometry) {\r\n\t\tif (_.isNumber(geometry))\r\n\t\t\tgeometry = {x: geometry};\r\n\t\tgeometry = _.defaults(geometry, defaultGeometry);\r\n\t\tlet p = geometry.x, l = this.length;\r\n\t\tif (Math.abs(p) <= 1) p *= l;\r\n\t\tif (p < 0) p = l + p;\r\n\t\tif (p > l) p = l;\r\n\r\n\t\tlet points = this.points, d, point, dir;\r\n\t\tfor (let i = 0; i < points.length - 1; i++) {\r\n\t\t\td = points[i].distance(points[i+1]);\r\n\t\t\tif (p <= d) {\r\n\t\t\t\t// we've located the line segment.\r\n\t\t\t\tpoint = points[i].clone();\r\n\t\t\t\tdir = point.getDirection(points[i+1]);\r\n\t\t\t\tpoint.translate(dir.getScaled(p));\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t\tp -= d;\r\n\t\t}\r\n\r\n\t\t// return the last point.\r\n\t\tif (!point)\r\n\t\t\tpoint = points[points.length - 1];\r\n\t\treturn Utils.offsetPosition([point.x, point.y], geometry);\r\n\t}\r\n\r\n\ttoString() {\r\n\t\treturn 'Link';\r\n\t}\r\n\r\n\tstatic getLink(terminalVisual, shapeConfig = {}, startMarker = null, endMarker = null) {\r\n\t\tshapeConfig = _.defaultsDeep(shapeConfig, defaultConfig);\r\n\t\tlet linkClass = linkTypes[shapeConfig.type];\r\n\t\tif (linkClass)\r\n\t\t\treturn new linkClass(terminalVisual, shapeConfig, startMarker, endMarker);\r\n\t\tconsole.log('link type not supported: ' + shapeConfig.type);\r\n\t\treturn null;\r\n\t}\r\n}\r\n\r\nclass DirectLink extends Link {\r\n\tget points() {\r\n\t\treturn [this.start, this.end];\r\n\t}\r\n}\r\n\r\nclass BezierLink extends Link {\r\n\tget points() {\r\n\t\treturn [this.start, this.end];\r\n\t}\r\n\r\n\tget controlPts() {\r\n\t\tlet s = this.points[0], e = this.points[1];\r\n\t\tlet pts = [];\r\n\t\tpts[0] = null;\r\n\t\tpts[1] = [];\r\n\t\tif (this.startNormal.x == 0) {\r\n\t\t\tpts[1][0] = new Point(s.x, (s.y + e.y)/2);\r\n\t\t}\r\n\t\telse {\r\n\t\t\tpts[1][0] = new Point((s.x + e.x)/2, s.y);\r\n\t\t}\r\n\t\tif (this.endNormal.x == 0) {\r\n\t\t\tpts[1][1] = new Point(e.x, (s.y + e.y)/2);\r\n\t\t}\r\n\t\telse {\r\n\t\t\tpts[1][1] = new Point((s.x + e.x)/2, e.y);\r\n\t\t}\r\n\t\treturn pts;\r\n\t}\r\n\r\n\tgetRelativePosition(geometry) {\r\n\t\tif (_.isNumber(geometry))\r\n\t\t\tgeometry = {x: geometry};\r\n\t\tgeometry = _.defaults(geometry, defaultGeometry);\r\n\t\tlet p = geometry.x, l = this.length;\r\n\t\tif (Math.abs(p) > 1) p /= l;\r\n\t\tif (p < 0) p++;\r\n\t\tif (p > 1) p--;\r\n\r\n\t\tlet pts = this.points;\r\n\t\tlet ctrlpts = this.controlPts;\r\n\t\tlet p1 = pts[0];\r\n\t\tlet p2 = ctrlpts[1][0];\r\n\t\tlet p3 = ctrlpts[1][1];\r\n\t\tlet p4 = pts[1];\r\n\r\n\t\tlet point = [(1-p)*(1-p)*(1-p) * p1.x + 3*p*(1-p)*(1-p) * p2.x + 3*p*p*(1-p) * p3.x + p*p*p * p4.x, (1-p)*(1-p)*(1-p) * p1.y + 3*p*(1-p)*(1-p) * p2.y + 3*p*p*(1-p) * p3.y + p*p*p * p4.y];\r\n\t\treturn Utils.offsetPosition([point.x, point.y], geometry);\r\n\t}\r\n}\r\n\r\nclass EntityRelations extends Link {\r\n\tget points() {\r\n\t\tvar source = Port.getBounds(edge, true);\r\n\t\tvar target = Port.getBounds(edge, false);\r\n\t\tvar isSourceLeft = target.right() < source.x;\r\n\t\tvar isTargetLeft = source.right() < target.x;\r\n\t\tvar result = [];\r\n\r\n\t\tvar x0 = (isSourceLeft) ? source.x : source.x + source.width;\r\n\t\tvar y0 = source.getCenterY();\r\n\t\tresult.push(new Point(x0, y0));\r\n\r\n\t\tvar xe = (isTargetLeft) ? target.x : target.x + target.width;\r\n\t\tvar ye = target.getCenterY();\r\n\r\n\t\tvar seg = this.segment;\r\n\r\n\t\tvar dx = (isSourceLeft) ? -seg : seg;\r\n\t\tvar dep = new Point(x0 + dx, y0);\r\n\r\n\t\tdx = (isTargetLeft) ? -seg : seg;\r\n\t\tvar arr = new Point(xe + dx, ye);\r\n\r\n\t\t// Adds intermediate points if both go out on same side\r\n\t\tif (isSourceLeft == isTargetLeft)\r\n\t\t{\r\n\t\t\tvar x = (isSourceLeft) ?\r\n\t\t\tMath.min(x0, xe)-seg :\r\n\t\t\tMath.max(x0, xe)+seg;\r\n\r\n\t\t\tresult.push(new Point(x, y0));\r\n\t\t\tresult.push(new Point(x, ye));\r\n\t\t}\r\n\t\telse if ((dep.x < arr.x) == isSourceLeft)\r\n\t\t{\r\n\t\t\tvar midY = y0 + (ye - y0) / 2;\r\n\r\n\t\t\tresult.push(dep);\r\n\t\t\tresult.push(new Point(dep.x, midY));\r\n\t\t\tresult.push(new Point(arr.x, midY));\r\n\t\t\tresult.push(arr);\r\n\t\t}\r\n\t\telse\r\n\t\t{\r\n\t\t\tresult.push(dep);\r\n\t\t\tresult.push(arr);\r\n\t\t}\r\n\r\n\t\tresult.push(new Point(xe, ye));\r\n\t\treturn result;\r\n\t}\r\n}\r\n\r\n\r\nclass Manhattan extends Link {\r\n\tconstructor(terminalVisual, shapeConfig, startMarker, endMarker) {\r\n\t\tshapeConfig = _.defaults(shapeConfig, {\r\n\t\t\tMIN_BUFFER: 10,\r\n\t\t\tautoRoute: false,\r\n\t\t\tmaxChannelWidth: 100\r\n\t\t});\r\n\t\tsuper(terminalVisual, shapeConfig, startMarker, endMarker);\r\n\t}\r\n\r\n\tget points() {\r\n\t\t//let pos = Manhattan.routeInternal(this.start, this.end, this.startNormal, this.endNormal, this.MIN_BUFFER);\r\n\t\t//pos = Manhattan.processPositions(this.start, this.end, pos, this.startNormal.x!=0);\r\n\t\tlet pos = Manhattan.findPositions(this.start, this.end, this.startNormal, this.endNormal, this.MIN_BUFFER);\r\n\t\tif (this.autoRoute) {\r\n\t\t\tthis._mergeSegments(pos);\r\n\t\t\tvar boxes = [], node, startBox, endBox;\r\n\t\t\tvar container = edge.source.getCommonAncestor(edge.target);\r\n\t\t\tvar childNodes = container.getDescendants();\r\n\t\t\tvar index = 0;\r\n\t\t\tfor (var i = 0; i < childNodes.length; i++) {\r\n\t\t\t\tnode = childNodes[i];\r\n\t\t\t\t// Do not include source or target ancestors in routing.\r\n\t\t\t\tif (node.excludeFromRouting(edge) || node.isAncestor(edge.source) || node.isAncestor(edge.target)) continue;\r\n\t\t\t\tif (node == edge.source)\r\n\t\t\t\tstartBox = index;\r\n\t\t\t\tif (node == edge.target)\r\n\t\t\t\tendBox = index;\r\n\t\t\t\tboxes.push(node.getBounds(document));\r\n\t\t\t\tindex++;\r\n\t\t\t}\r\n\t\t\tif (boxes.length > 1)\r\n\t\t\t\tthis.autoRoute(pos, container.getBounds(document), boxes, startBox, endBox);\r\n\t\t}\r\n\t\tthis._mergeSegments(pos);\r\n\t\treturn pos;\r\n\t}\r\n\r\n\t//New function for finding route\r\n\tstatic findPositions(start, end, startNormal, endNormal, buffer) {\r\n\t\tvar startBuffer = new Point(start.x + startNormal.x * buffer, start.y + startNormal.y * buffer);\r\n\t\tvar endBuffer = new Point(end.x + endNormal.x * buffer, end.y + endNormal.y * buffer);\r\n\t\tvar startBufferNormal, endBufferNormal;\r\n\t\tvar pts;\r\n\t\tif (startNormal.x != 0) {\r\n\t\t\tif ((endBuffer.x - startBuffer.x) / startNormal.x > 0) {\r\n\t\t\t\tstartBufferNormal = startNormal;\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tstartBufferNormal = new Point(0, (endBuffer.y >= startBuffer.y) ? 1 : -1);\r\n\t\t\t}\r\n\t\t}\r\n\t\telse {\r\n\t\t\tif ((endBuffer.y - startBuffer.y) / startNormal.y > 0) {\r\n\t\t\t\tstartBufferNormal = startNormal;\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tstartBufferNormal = new Point((endBuffer.x >= startBuffer.x) ? 1 : -1, 0);\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (endNormal.x != 0) {\r\n\t\t\tif ((startBuffer.x - endBuffer.x) / endNormal.x > 0) {\r\n\t\t\t\tendBufferNormal = endNormal;\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tendBufferNormal = new Point(0, (startBuffer.y >= endBuffer.y) ? 1 : -1);\r\n\t\t\t}\r\n\t\t}\r\n\t\telse {\r\n\t\t\tif ((startBuffer.y - endBuffer.y) / endNormal.y > 0) {\r\n\t\t\t\tendBufferNormal = endNormal;\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tendBufferNormal = new Point((startBuffer.x >= endBuffer.x) ? 1 : -1, 0);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (startBufferNormal.dotProduct(endBufferNormal) == 0) {\r\n\t\t\tvar middle = (startBufferNormal.x == 0) ? new Point(startBuffer.x, endBuffer.y) : new Point(endBuffer.x, startBuffer.y);\r\n\t\t\tpts = [start, startBuffer, middle, endBuffer, end];\r\n\t\t}\r\n\t\telse if (startBufferNormal.dotProduct(endBufferNormal) < 0) {\r\n\t\t\tif (startBufferNormal.x == 0) {\r\n\t\t\t\tpts = [start, startBuffer, new Point(startBuffer.x, (start.y + end.y) / 2), new Point(endBuffer.x, (start.y + end.y) / 2), endBuffer, end];\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tpts = [start, startBuffer, new Point((start.x + end.x) / 2, startBuffer.y), new Point((start.x + end.x) / 2, endBuffer.y), endBuffer, end];\r\n\t\t\t}\r\n\t\t}\r\n\t\telse {\r\n\t\t\tpts = [start, startBuffer, new Point(startBuffer.x + startBufferNormal.x * buffer, startBuffer.y + startBufferNormal.y * buffer), new Point(endBuffer.x + endBufferNormal.x * buffer, endBuffer.y + endBufferNormal.y * buffer), endBuffer, end];\r\n\t\t}\r\n\r\n\t\tvar prunePts = [];\r\n\t\tprunePts[0] = pts[0];\r\n\t\tfor (var i = 1; i < pts.length - 1; i++) {\r\n\t\t\tif ((pts[i].x == pts[i-1].x && pts[i].x == pts[i+1].x) || (pts[i].y == pts[i-1].y && pts[i].y == pts[i+1].y)) {\r\n\t\t\t\tcontinue;\r\n\t\t\t}\r\n\t\t\tprunePts.push(pts[i]);\r\n\t\t}\r\n\t\tprunePts.push(pts[pts.length - 1]);\r\n\t\treturn prunePts;\r\n\t}\r\n\r\n\t/**\r\n\t * Make a route based on the start, end and startNormal and endNormal\r\n\t * None of the parameters can be null\r\n\t * TODO: This method could use some improvement...\r\n\t */\r\n\tstatic routeInternal(start, end, startNormal, endNormal, buffer) {\r\n\t\tvar direction = start.getDirection(end);\r\n\t\tvar average = start.getMidPoint(end);\r\n\t\tvar pos = [];\r\n\t\tvar startPositive = new Point(startNormal.x*startNormal.x, startNormal.y*startNormal.y);\r\n\t\tvar endPositive = new Point(endNormal.x*endNormal.x, endNormal.y*endNormal.y);\r\n\t\tvar horizontal = startNormal.x != 0;\r\n\t\tpos[0] = horizontal ? start.y : start.x;\r\n\r\n\t\thorizontal = !horizontal;\r\n\t\tvar i;\r\n\t\tif (startNormal.dotProduct(endNormal) == 0) {\r\n\t\t\tif ((startNormal.dotProduct(direction) >= 0)\r\n\t\t\t\t&& (endNormal.dotProduct(direction) <= 0)) {\r\n\t\t\t\t// 0\r\n\t\t\t} else {\r\n\t\t\t\t// 2\r\n\t\t\t\tif (startNormal.dotProduct(direction) < 0)\r\n\t\t\t\t\ti = startPositive.dotProduct(start.getTranslated(startNormal.getScaled(buffer)));\r\n\t\t\t\telse\r\n\t\t\t\t\ti = horizontal ? average.y : average.x;\r\n\r\n\t\t\t\tpos.push(i);\r\n\t\t\t\thorizontal = !horizontal;\r\n\r\n\t\t\t\tif (endNormal.dotProduct(direction) > 0)\r\n\t\t\t\t\ti = endPositive.dotProduct(end.getTranslated(endNormal.getScaled(buffer)));\r\n\t\t\t\telse\r\n\t\t\t\t\ti = horizontal ? average.y : average.x;\r\n\r\n\t\t\t\tpos.push(i);\r\n\t\t\t\thorizontal = !horizontal;\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tif (startNormal.dotProduct(endNormal) > 0) {\r\n\t\t\t\t//1\r\n\t\t\t\tif (startNormal.dotProduct(direction) >= 0)\r\n\t\t\t\t\ti = startPositive.dotProduct(start.getTranslated(startNormal.getScaled(buffer)));\r\n\t\t\t\telse\r\n\t\t\t\t\ti = endPositive.dotProduct(end.getTranslated(endNormal.getScaled(buffer)));\r\n\t\t\t\tpos.push(i);\r\n\t\t\t\thorizontal = !horizontal;\r\n\t\t\t} else {\r\n\t\t\t\t//3 or 1\r\n\t\t\t\tif (startNormal.dotProduct(direction) < 0) {\r\n\t\t\t\t\ti = startPositive.dotProduct(start.getTranslated(startNormal.getScaled(buffer)));\r\n\t\t\t\t\tpos.push(i);\r\n\t\t\t\t\thorizontal = !horizontal;\r\n\t\t\t\t}\r\n\r\n\t\t\t\ti = horizontal ? average.y : average.x;\r\n\t\t\t\tpos.push(i);\r\n\t\t\t\thorizontal = !horizontal;\r\n\r\n\t\t\t\tif (startNormal.dotProduct(direction) < 0) {\r\n\t\t\t\t\ti = endPositive.dotProduct(end.getTranslated(endNormal.getScaled(buffer)));\r\n\t\t\t\t\tpos.push(i);\r\n\t\t\t\t\thorizontal = !horizontal;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tpos.push(horizontal ? end.y : end.x);\r\n\r\n\t\treturn pos;\r\n\t}\r\n\r\n\t// Process the positions.\r\n\tstatic processPositions(start, end, positions, horizontal) {\r\n\t\tvar pos = [];\r\n\t\tpos[0] = horizontal ? start.x : start.y;\r\n\t\tvar i;\r\n\t\tfor (i = 0; i < positions.length; i++) {\r\n\t\t\tpos[i + 1] = positions[i];\r\n\t\t}\r\n\t\tpos.push((horizontal == (positions.length % 2 == 1)) ? end.x : end.y);\r\n\r\n\t\tvar pts = [];\r\n\t\tpts[0] = start;\r\n\t\tvar p;\r\n\t\tvar current, prev;\r\n\t\tfor (i = 2; i < pos.length - 1; i++) {\r\n\t\t\thorizontal = !horizontal;\r\n\t\t\tprev = pos[i - 1];\r\n\t\t\tcurrent = pos[i];\r\n\t\t\tp = horizontal ? new Point(prev, current) : new Point(current, prev);\r\n\t\t\tpts.push(p);\r\n\t\t}\r\n\t\tpts.push(end);\r\n\t\treturn pts;\r\n\t}\r\n\r\n\t/**\r\n\t * Automatically route the connection to avoid intersections with other vertices.\r\n\t */\r\n\tautoRoute(pts, container, boxes, startBox, endBox) {\r\n\t\tvar side, side2, d, box, intersect, j;\r\n\t\tvar channel, channel2, pt, dir;\r\n\r\n\t\tvar startPadding = 0, endPadding;\r\n\t\t// first get the start and end channel\r\n\t\tbox = boxes[endBox];\r\n\t\tpt = pts[pts.length - 2];\r\n\t\tif (pt.y < box.y)\r\n\t\t\tside = 1;\r\n\t\telse if (pt.y > box.y + box.height)\r\n\t\t\tside = 3;\r\n\t\telse if (pt.x < box.x)\r\n\t\t\tside = 0;\r\n\t\telse\r\n\t\t\tside = 2;\r\n\t\tchannel = _getChannel(container, endBox, boxes, side);\r\n\t\tendPadding = channel.horizontal ? (channel.right - channel.left)/2 : (channel.bottom - channel.top)/2;\r\n\r\n\t\tfor (var i = 0; i < pts.length - 1; i++) {\r\n\t\t\tif (pts[i+1].x == pts[i].x && pts[i+1].y == pts[i].y) continue;\r\n\t\t\tintersect = _getFirstIntersection(pts, i, boxes, startBox, endBox);\r\n\t\t\tif (!intersect) continue;\r\n\t\t\tj = intersect[0];\r\n\t\t\tside = intersect[1];\r\n\t\t\tbox = boxes[j];\r\n\t\t\tchannel = _getChannel(container, j, boxes, side);\r\n\t\t\tswitch(side) {\r\n\t\t\t\tcase 0:\r\n\t\t\t\tcase 2:\r\n\t\t\t\t\tpt = new Point((channel.right + channel.left)/2, pts[i].y);\r\n\t\t\t\t\tdir = _getRouteTendency(pts, i, pt, box, side);\r\n\t\t\t\t\tside2 = dir < 0 ? 1 : 3;\r\n\t\t\t\t\tchannel2 = _getChannel(container, j, boxes, side2);\r\n\t\t\t\t\t// if the previous point is in the channel2, use that point instead of center of the channel.\r\n\t\t\t\t\tif (i > 1 && (pts[i-2].y == pts[i-1].y) && (pts[i-1].y > channel2.top && pts[i-1].y < channel2.bottom))\r\n\t\t\t\t\t\td = pts[i-1].y - pt.y;\r\n\t\t\t\t\telse if (i < pts.length - 3 && (pts[i+2].y == pts[i+3].y) && (pts[i+2].y > channel2.top && pts[i+2].y < channel2.bottom))\r\n\t\t\t\t\t\td = pts[i+2].y - pt.y;\r\n\t\t\t\t\telse\r\n\t\t\t\t\t\td = (channel2.bottom + channel2.top)/2 - pt.y;\r\n\t\t\t\t\t// check if we need this pt.\r\n\t\t\t\t\tif ((side == 0 && pt.x <= pts[i].x) || (side == 2 && pt.x >= pts[i].x))\r\n\t\t\t\t\t\tpt = null;\r\n\t\t\t\t\telse if (i > 0) {\r\n\t\t\t\t\t\t// see if we can push the line out to where we started.\r\n\t\t\t\t\t\tif (!_hasIntersection(\r\n\t\t\t\t\t\t\t\t[new Point(pts[i].x, pts[i].y), new Point(pts[i].x, pts[i].y + d), new Point(pt.x, pt.y + d)],\r\n\t\t\t\t\t\t\t\tboxes))\r\n\t\t\t\t\t\t\tpt = null;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 1:\r\n\t\t\t\tcase 3:\r\n\t\t\t\t\tpt = new Point(pts[i].x, (channel.bottom + channel.top)/2);\r\n\t\t\t\t\tdir = _getRouteTendency(pts, i, pt, box, side);\r\n\t\t\t\t\tside2 = dir < 0 ? 0 : 2;\r\n\t\t\t\t\tchannel2 = _getChannel(container, j, boxes, side2);\r\n\t\t\t\t\t// if the previous point is in the channel2, use that point instead of center of the channel.\r\n\t\t\t\t\tif (i > 1 && (pts[i-2].x == pts[i-1].x) && (pts[i-1].x > channel2.left && pts[i-1].x < channel2.right))\r\n\t\t\t\t\t\td = pts[i-1].x - pt.x;\r\n\t\t\t\t\telse if (i < pts.length - 3 && (pts[i+2].x == pts[i+3].x) && (pts[i+2].x > channel2.left && pts[i+2].x < channel2.right))\r\n\t\t\t\t\t\td = pts[i+2].x - pt.x;\r\n\t\t\t\t\telse\r\n\t\t\t\t\t\td = (channel2.right + channel2.left)/2 - pt.x;\r\n\t\t\t\t\t// check if we need this pt.\r\n\t\t\t\t\tif ((side == 1 && pt.y <= pts[i].y) || (side == 3 && pt.y >= pts[i].y))\r\n\t\t\t\t\t\tpt = null;\r\n\t\t\t\t\telse if (i > 0) {\r\n\t\t\t\t\t\t// see if we can push the line out to where we started.\r\n\t\t\t\t\t\tif (!_hasIntersection(\r\n\t\t\t\t\t\t\t\t[new Point(pts[i].x, pts[i].y), new Point(pts[i].x + d, pts[i].y), new Point(pt.x + d, pt.y)],\r\n\t\t\t\t\t\t\t\tboxes))\r\n\t\t\t\t\t\t\tpt = null;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 4:\r\n\t\t\t\t\tcontinue;\r\n\t\t\t}\r\n\t\t\t// max points.\r\n\t\t\tif (i > 20) return;\r\n\t\t\tif (pt && (pt.x != pts[i].x || pt.y != pts[i].y)) {\r\n\t\t\t\tpts.splice(i+1, 0, pt);\r\n\t\t\t\t_moveSegment(pts, i+1, d, startPadding, endPadding);\r\n\t\t\t\ti++;\r\n\t\t\t} else\r\n\t\t\t\t_moveSegment(pts, i, d, startPadding, endPadding);\r\n\t\t}\r\n\t}\r\n\r\n\t_hasIntersection(pts, boxes) {\r\n\t\tfor (var i = 0; i < pts.length - 1; i++) {\r\n\t\t\tfor (var j = 0; j < boxes.length; j++) {\r\n\t\t\t\tif (boxes[j].detectIntersection(pts[i], pts[i+1]) >= 0)\r\n\t\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn false;\r\n\t}\r\n\r\n\t_getFirstIntersection(pts, i, boxes, startBox, endBox) {\r\n\t\tvar box, side, savedIndex = null, savedSide = null;\r\n\t\tfor (var j = 0; j < boxes.length; j++) {\r\n\t\t\tif ((i == 0 && j == startBox) || (i == pts.length - 2 && j == endBox))\r\n\t\t\t\tcontinue;\r\n\t\t\tbox = boxes[j];\r\n\t\t\tside = box.detectIntersection(pts[i], pts[i+1]);\r\n\t\t\tif (side >= 0) {\r\n\t\t\t\tif (savedIndex == null) {\r\n\t\t\t\t\tsavedIndex = j;\r\n\t\t\t\t\tsavedSide = side;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tif (boxes[savedIndex].distance(pts[i]) > box.distance(pts[i])) {\r\n\t\t\t\t\t\tsavedIndex = j;\r\n\t\t\t\t\t\tsavedSide = side;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (savedIndex != null)\r\n\t\t\treturn [savedIndex, savedSide];\r\n\t\treturn null;\r\n\t}\r\n\r\n\t_getRouteTendency(pts, i, breakPt, box, side) {\r\n\t\tvar dir;\r\n\t\tvar p;\r\n\t\tswitch (side) {\r\n\t\t\tcase 0:\r\n\t\t\tcase 2:\r\n\t\t\t\tp = \"y\";\r\n\t\t\t\tbreak;\r\n\t\t\tcase 1:\r\n\t\t\tcase 3:\r\n\t\t\t\tp = \"x\";\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\t\t//first try the breakpt.\r\n\t\tdir = _getRouteDirection(breakPt, pts[pts.length - 1])[p];\r\n\t\tif (dir == 0) {\r\n\t\t\tdir = -_getRouteDirection(pts[0], pts[pts.length - 1])[p];\r\n\t\t\tif (dir == 0) {\r\n\t\t\t\tif (breakPt[p] < box.getCenter()[p])\r\n\t\t\t\t\tdir = -1;\r\n\t\t\t\telse\r\n\t\t\t\t\tdir = 1;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn dir;\r\n\t}\r\n\r\n\t_getRouteDirection(pt1, pt2) {\r\n\t\tif (pt1.x == pt2.x) {\r\n\t\t\tif (pt1.y < pt2.y) return Point.S;\r\n\t\t\treturn Point.N;\r\n\t\t} else if (pt1.y == pt2.y) {\r\n\t\t\tif (pt1.x < pt2.x) return Point.E;\r\n\t\t\treturn Point.W;\r\n\t\t} else if (pt1.x < pt2.x) {\r\n\t\t\tif (pt1.y < pt2.y) return Point.SE;\r\n\t\t\treturn Point.NE;\r\n\t\t} else {\r\n\t\t\tif (pt1.y < pt2.y) return Point.SW;\r\n\t\t\treturn Point.NW;\r\n\t\t}\r\n\t}\r\n\r\n\t_getChannel(container, index, boxes, side) {\r\n\t\tvar maxChannelWidth = this.maxChannelWidth;\r\n\t\tvar box1 = boxes[index], box2;\r\n\t\tvar pt, i;\r\n\t\tvar channel = {}, l, t, b, r;\r\n\t\tswitch (side) {\r\n\t\t\tcase 0:\r\n\t\t\t\tpt = box1.getLeft();\r\n\t\t\t\tchannel.right = pt.x;\r\n\t\t\t\tchannel.horizontal = false;\r\n\t\t\t\tfor (i = 0; i < boxes.length; i++) {\r\n\t\t\t\t\tif (i == index) continue;\r\n\t\t\t\t\tr = boxes[i].getRight().x;\r\n\t\t\t\t\tif (r >= pt.x) continue;\r\n\t\t\t\t\tif (!channel.left || channel.left < r)\r\n\t\t\t\t\t\tchannel.left = r;\r\n\t\t\t\t}\r\n\t\t\t\tif (!channel.left) {\r\n\t\t\t\t\tchannel.left = container.getLeft().x;\r\n\t\t\t\t\tif (channel.right - channel.left > maxChannelWidth)\r\n\t\t\t\t\t\tchannel.left = channel.right - maxChannelWidth;\r\n\t\t\t\t}\r\n\t\t\t\tfor (i = 0; i < boxes.length; i++) {\r\n\t\t\t\t\tif (i == index) continue;\r\n\t\t\t\t\tbox2 = boxes[i];\r\n\t\t\t\t\tb = box2.getBottom().y;\r\n\t\t\t\t\tt = box2.getTop().y;\r\n\t\t\t\t\tif (b < pt.y && (box2.getRight() > channel.left && box2.getLeft() < channel.right)) {\r\n\t\t\t\t\t\tif (!channel.top || channel.top < b)\r\n\t\t\t\t\t\t\tchannel.top = b;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (t > pt.y && (box2.getRight() > channel.left && box2.getLeft() < channel.right)) {\r\n\t\t\t\t\t\tif (!channel.bottom || channel.bottom > t)\r\n\t\t\t\t\t\t\tchannel.bottom = t;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tif (!channel.top) channel.top = container.getTop().y;\r\n\t\t\t\tif (!channel.bottom) channel.bottom = container.getBottom().y;\r\n\t\t\t\tbreak;\r\n\t\t\tcase 1:\r\n\t\t\t\tpt = box1.getTop();\r\n\t\t\t\tchannel.horizontal = true;\r\n\t\t\t\tchannel.bottom = pt.y;\r\n\t\t\t\tfor (i = 0; i < boxes.length; i++) {\r\n\t\t\t\t\tif (i == index) continue;\r\n\t\t\t\t\tb = boxes[i].getBottom().y;\r\n\t\t\t\t\tif (b >= pt.y) continue;\r\n\t\t\t\t\tif (!channel.top || channel.top < b)\r\n\t\t\t\t\t\tchannel.top = b;\r\n\t\t\t\t}\r\n\t\t\t\tif (!channel.top) {\r\n\t\t\t\t\tchannel.top = container.getTop().y;\r\n\t\t\t\t\tif (channel.bottom - channel.top > maxChannelWidth)\r\n\t\t\t\t\t\tchannel.top = channel.bottom - maxChannelWidth;\r\n\t\t\t\t}\r\n\t\t\t\tfor (i = 0; i < boxes.length; i++) {\r\n\t\t\t\t\tif (i == index) continue;\r\n\t\t\t\t\tbox2 = boxes[i];\r\n\t\t\t\t\tl = box2.getLeft().x;\r\n\t\t\t\t\tr = box2.getRight().x;\r\n\t\t\t\t\tif (r < pt.x && (box2.getBottom() > channel.top && box2.getTop() < channel.bottom)) {\r\n\t\t\t\t\t\tif (!channel.left || channel.left < r)\r\n\t\t\t\t\t\t\tchannel.left = r;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (l > pt.x && (box2.getBottom() > channel.top && box2.getTop() < channel.bottom)) {\r\n\t\t\t\t\t\tif (!channel.right || channel.right > l)\r\n\t\t\t\t\t\t\tchannel.right = l;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tif (!channel.left) channel.left = container.getLeft().x;\r\n\t\t\t\tif (!channel.right) channel.right = container.getRight().x;\r\n\r\n\t\t\t\tbreak;\r\n\t\t\tcase 2:\r\n\t\t\t\tpt = box1.getRight();\r\n\t\t\t\tchannel.horizontal = false;\r\n\t\t\t\tchannel.left = pt.x;\r\n\t\t\t\tfor (i = 0; i < boxes.length; i++) {\r\n\t\t\t\t\tif (i == index) continue;\r\n\t\t\t\t\tl = boxes[i].getLeft().x;\r\n\t\t\t\t\tif (l <= pt.x) continue;\r\n\t\t\t\t\tif (!channel.right || channel.right > l)\r\n\t\t\t\t\t\tchannel.right = l;\r\n\t\t\t\t}\r\n\t\t\t\tif (!channel.right) {\r\n\t\t\t\t\tchannel.right = container.getRight().x;\r\n\t\t\t\t\tif (channel.right - channel.left > maxChannelWidth)\r\n\t\t\t\t\t\tchannel.right = channel.left + maxChannelWidth;\r\n\t\t\t\t}\r\n\t\t\t\tfor (i = 0; i < boxes.length; i++) {\r\n\t\t\t\t\tif (i == index) continue;\r\n\t\t\t\t\tbox2 = boxes[i];\r\n\t\t\t\t\tb = box2.getBottom().y;\r\n\t\t\t\t\tt = box2.getTop().y;\r\n\t\t\t\t\tif (b < pt.y && (box2.getRight() > channel.left && box2.getLeft() < channel.right)) {\r\n\t\t\t\t\t\tif (!channel.top || channel.top < b)\r\n\t\t\t\t\t\t\tchannel.top = b;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (t > pt.y && (box2.getRight() > channel.left && box2.getLeft() < channel.right)) {\r\n\t\t\t\t\t\tif (!channel.bottom || channel.bottom > t)\r\n\t\t\t\t\t\t\tchannel.bottom = t;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tif (!channel.top) channel.top = container.getTop().y;\r\n\t\t\t\tif (!channel.bottom) channel.bottom = container.getBottom().y;\r\n\t\t\t\tbreak;\r\n\t\t\tcase 3:\r\n\t\t\t\tpt = box1.getBottom();\r\n\t\t\t\tchannel.horizontal = true;\r\n\t\t\t\tchannel.top = pt.y;\r\n\t\t\t\tfor (i = 0; i < boxes.length; i++) {\r\n\t\t\t\t\tif (i == index) continue;\r\n\t\t\t\t\tbox2 = boxes[i];\r\n\t\t\t\t\tif (box2.getTop().y <= pt.y) continue;\r\n\t\t\t\t\tif (!channel.bottom || channel.bottom > box2.getTop().y)\r\n\t\t\t\t\t\tchannel.bottom = box2.getTop().y;\r\n\t\t\t\t}\r\n\t\t\t\tif (!channel.bottom) {\r\n\t\t\t\t\tchannel.bottom = container.getBottom().y;\r\n\t\t\t\t\tif (channel.bottom - channel.top > maxChannelWidth)\r\n\t\t\t\t\t\tchannel.bottom = channel.top + maxChannelWidth;\r\n\t\t\t\t}\r\n\t\t\t\tfor (i = 0; i < boxes.length; i++) {\r\n\t\t\t\t\tif (i == index) continue;\r\n\t\t\t\t\tbox2 = boxes[i];\r\n\t\t\t\t\tl = box2.getLeft().x;\r\n\t\t\t\t\tr = box2.getRight().x;\r\n\t\t\t\t\tif (r < pt.x && (box2.getBottom() > channel.top && box2.getTop() < channel.bottom)) {\r\n\t\t\t\t\t\tif (!channel.left || channel.left < r)\r\n\t\t\t\t\t\t\tchannel.left = r;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (l > pt.x && (box2.getBottom() > channel.top && box2.getTop() < channel.bottom)) {\r\n\t\t\t\t\t\tif (!channel.right || channel.right > l)\r\n\t\t\t\t\t\t\tchannel.right = l;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tif (!channel.left) channel.left = container.getLeft().x;\r\n\t\t\t\tif (!channel.right) channel.right = container.getRight().x;\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\t\treturn channel;\r\n\t}\r\n\r\n\t/**\r\n\t * Move a line segment by a specified distance.\r\n\t *\r\n\t * @param pts the list of points.\r\n\t * @param i the index of the segment.\r\n\t * @param d the distance to move.\r\n\t * @param startPadding\r\n\t * @param endPadding\r\n\t */\r\n\t_moveSegment(pts, i, d, startPadding, endPadding) {\r\n\t\t// first check if we need to add new line segments.\r\n\t\tvar dir, l, pt;\r\n\t\tif (i == 0) {\r\n\t\t\t// we need to break off the segment, since we can't change the starting point.\r\n\t\t\tdir = pts[0].getDirection(pts[1]);\r\n\t\t\tif (!startPadding)\r\n\t\t\t\tstartPadding = this.MIN_BUFFER;\r\n\t\t\tl = Math.min(startPadding, pts[0].distance(pts[1])/2);\r\n\t\t\tpt = pts[0].getTranslated(dir.scale(l));\r\n\t\t\tpts.splice(1, 0, pt);\r\n\t\t\t_moveSegment(pts, i+1, d);\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tif (i == pts.length - 2) {\r\n\t\t\t// we need to break off the segment, since we can't change the end point.\r\n\t\t\tdir = pts[pts.length-1].getDirection(pts[pts.length-2]);\r\n\t\t\tif (!endPadding)\r\n\t\t\t\tendPadding = this.MIN_BUFFER;\r\n\t\t\tl = Math.min(endPadding, pts[pts.length-1].distance(pts[pts.length-2])/2);\r\n\t\t\tpt = pts[pts.length - 1].getTranslated(dir.scale(l));\r\n\t\t\tpts.splice(pts.length - 1, 0, pt);\r\n\t\t\t_moveSegment(pts, i, d);\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tif (pts[i].y == pts[i+1].y) {\r\n\t\t\tif (i > 0 && pts[i - 1].y == pts[i].y) {\r\n\t\t\t\tpts.splice(i + 1, 0, pts[i].clone());\r\n\t\t\t\ti++;\r\n\t\t\t}\r\n\t\t\tif (i < pts.length - 2 && pts[i+1].y == pts[i+2].y)\r\n\t\t\t\tpts.splice(i + 1, 0, pts[i+1].clone());\r\n\t\t\tpts[i].y += d;\r\n\t\t\tpts[i+1].y += d;\r\n\t\t} else {\r\n\t\t\tif (i > 0 && pts[i - 1].x == pts[i].x) {\r\n\t\t\t\tpts.splice(i + 1, 0, pts[i].clone());\r\n\t\t\t\ti++;\r\n\t\t\t}\r\n\t\t\tif (i < pts.length - 2 && pts[i+1].x == pts[i+2].x)\r\n\t\t\t\tpts.splice(i + 1, 0, pts[i+1].clone());\r\n\t\t\tpts[i].x += d;\r\n\t\t\tpts[i+1].x += d;\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * This method will merge the redundant segments.\r\n\t */\r\n\t_mergeSegments(pts) {\r\n\t\tvar h1 = pts[pts.length-1].y == pts[pts.length-2].y;\r\n\t\tvar h2;\r\n\t\tfor (var i = pts.length - 2; i >= 1; i--) {\r\n\t\t\th2 = pts[i].y == pts[i-1].y;\r\n\t\t\tif (h2 == h1 || (pts[i].equals(pts[i-1])))\r\n\t\t\t\tpts.splice(i, 1);\r\n\t\t\telse\r\n\t\t\t\th1 = !h1;\r\n\t\t}\r\n\t}\r\n}\r\n\r\nlinkTypes['direct'] = DirectLink;\r\nlinkTypes['bezier'] = BezierLink;\r\nlinkTypes['entityRelations'] = EntityRelations;\r\nlinkTypes['manhattan'] = Manhattan;\r\n\r\nexport default Link;\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/geometry/Link.js\n **/","/*!\n  * Bean - copyright (c) Jacob Thornton 2011-2012\n  * https://github.com/fat/bean\n  * MIT license\n  */\n(function (name, context, definition) {\n  if (typeof module != 'undefined' && module.exports) module.exports = definition()\n  else if (typeof define == 'function' && define.amd) define(definition)\n  else context[name] = definition()\n})('bean', this, function (name, context) {\n  name    = name    || 'bean'\n  context = context || this\n\n  var win            = window\n    , old            = context[name]\n    , namespaceRegex = /[^\\.]*(?=\\..*)\\.|.*/\n    , nameRegex      = /\\..*/\n    , addEvent       = 'addEventListener'\n    , removeEvent    = 'removeEventListener'\n    , doc            = document || {}\n    , root           = doc.documentElement || {}\n    , W3C_MODEL      = root[addEvent]\n    , eventSupport   = W3C_MODEL ? addEvent : 'attachEvent'\n    , ONE            = {} // singleton for quick matching making add() do one()\n\n    , slice          = Array.prototype.slice\n    , str2arr        = function (s, d) { return s.split(d || ' ') }\n    , isString       = function (o) { return typeof o == 'string' }\n    , isFunction     = function (o) { return typeof o == 'function' }\n\n      // events that we consider to be 'native', anything not in this list will\n      // be treated as a custom event\n    , standardNativeEvents =\n        'click dblclick mouseup mousedown contextmenu '                  + // mouse buttons\n        'mousewheel mousemultiwheel DOMMouseScroll '                     + // mouse wheel\n        'mouseover mouseout mousemove selectstart selectend '            + // mouse movement\n        'keydown keypress keyup '                                        + // keyboard\n        'orientationchange '                                             + // mobile\n        'focus blur change reset select submit '                         + // form elements\n        'load unload beforeunload resize move DOMContentLoaded '         + // window\n        'readystatechange message '                                      + // window\n        'error abort scroll '                                              // misc\n      // element.fireEvent('onXYZ'... is not forgiving if we try to fire an event\n      // that doesn't actually exist, so make sure we only do these on newer browsers\n    , w3cNativeEvents =\n        'show '                                                          + // mouse buttons\n        'input invalid '                                                 + // form elements\n        'touchstart touchmove touchend touchcancel '                     + // touch\n        'gesturestart gesturechange gestureend '                         + // gesture\n        'textinput '                                                     + // TextEvent\n        'readystatechange pageshow pagehide popstate '                   + // window\n        'hashchange offline online '                                     + // window\n        'afterprint beforeprint '                                        + // printing\n        'dragstart dragenter dragover dragleave drag drop dragend '      + // dnd\n        'loadstart progress suspend emptied stalled loadmetadata '       + // media\n        'loadeddata canplay canplaythrough playing waiting seeking '     + // media\n        'seeked ended durationchange timeupdate play pause ratechange '  + // media\n        'volumechange cuechange '                                        + // media\n        'checking noupdate downloading cached updateready obsolete '       // appcache\n\n      // convert to a hash for quick lookups\n    , nativeEvents = (function (hash, events, i) {\n        for (i = 0; i < events.length; i++) events[i] && (hash[events[i]] = 1)\n        return hash\n      }({}, str2arr(standardNativeEvents + (W3C_MODEL ? w3cNativeEvents : ''))))\n\n      // custom events are events that we *fake*, they are not provided natively but\n      // we can use native events to generate them\n    , customEvents = (function () {\n        var isAncestor = 'compareDocumentPosition' in root\n              ? function (element, container) {\n                  return container.compareDocumentPosition && (container.compareDocumentPosition(element) & 16) === 16\n                }\n              : 'contains' in root\n                ? function (element, container) {\n                    container = container.nodeType === 9 || container === window ? root : container\n                    return container !== element && container.contains(element)\n                  }\n                : function (element, container) {\n                    while (element = element.parentNode) if (element === container) return 1\n                    return 0\n                  }\n          , check = function (event) {\n              var related = event.relatedTarget\n              return !related\n                ? related == null\n                : (related !== this && related.prefix !== 'xul' && !/document/.test(this.toString())\n                    && !isAncestor(related, this))\n            }\n\n        return {\n            mouseenter: { base: 'mouseover', condition: check }\n          , mouseleave: { base: 'mouseout', condition: check }\n          , mousewheel: { base: /Firefox/.test(navigator.userAgent) ? 'DOMMouseScroll' : 'mousewheel' }\n        }\n      }())\n\n      // we provide a consistent Event object across browsers by taking the actual DOM\n      // event object and generating a new one from its properties.\n    , Event = (function () {\n            // a whitelist of properties (for different event types) tells us what to check for and copy\n        var commonProps  = str2arr('altKey attrChange attrName bubbles cancelable ctrlKey currentTarget ' +\n              'detail eventPhase getModifierState isTrusted metaKey relatedNode relatedTarget shiftKey '  +\n              'srcElement target timeStamp type view which propertyName')\n          , mouseProps   = commonProps.concat(str2arr('button buttons clientX clientY dataTransfer '      +\n              'fromElement offsetX offsetY pageX pageY screenX screenY toElement'))\n          , mouseWheelProps = mouseProps.concat(str2arr('wheelDelta wheelDeltaX wheelDeltaY wheelDeltaZ ' +\n              'axis')) // 'axis' is FF specific\n          , keyProps     = commonProps.concat(str2arr('char charCode key keyCode keyIdentifier '          +\n              'keyLocation location'))\n          , textProps    = commonProps.concat(str2arr('data'))\n          , touchProps   = commonProps.concat(str2arr('touches targetTouches changedTouches scale rotation'))\n          , messageProps = commonProps.concat(str2arr('data origin source'))\n          , stateProps   = commonProps.concat(str2arr('state'))\n          , overOutRegex = /over|out/\n            // some event types need special handling and some need special properties, do that all here\n          , typeFixers   = [\n                { // key events\n                    reg: /key/i\n                  , fix: function (event, newEvent) {\n                      newEvent.keyCode = event.keyCode || event.which\n                      return keyProps\n                    }\n                }\n              , { // mouse events\n                    reg: /click|mouse(?!(.*wheel|scroll))|menu|drag|drop/i\n                  , fix: function (event, newEvent, type) {\n                      newEvent.rightClick = event.which === 3 || event.button === 2\n                      newEvent.pos = { x: 0, y: 0 }\n                      if (event.pageX || event.pageY) {\n                        newEvent.clientX = event.pageX\n                        newEvent.clientY = event.pageY\n                      } else if (event.clientX || event.clientY) {\n                        newEvent.clientX = event.clientX + doc.body.scrollLeft + root.scrollLeft\n                        newEvent.clientY = event.clientY + doc.body.scrollTop + root.scrollTop\n                      }\n                      if (overOutRegex.test(type)) {\n                        newEvent.relatedTarget = event.relatedTarget\n                          || event[(type == 'mouseover' ? 'from' : 'to') + 'Element']\n                      }\n                      return mouseProps\n                    }\n                }\n              , { // mouse wheel events\n                    reg: /mouse.*(wheel|scroll)/i\n                  , fix: function () { return mouseWheelProps }\n                }\n              , { // TextEvent\n                    reg: /^text/i\n                  , fix: function () { return textProps }\n                }\n              , { // touch and gesture events\n                    reg: /^touch|^gesture/i\n                  , fix: function () { return touchProps }\n                }\n              , { // message events\n                    reg: /^message$/i\n                  , fix: function () { return messageProps }\n                }\n              , { // popstate events\n                    reg: /^popstate$/i\n                  , fix: function () { return stateProps }\n                }\n              , { // everything else\n                    reg: /.*/\n                  , fix: function () { return commonProps }\n                }\n            ]\n          , typeFixerMap = {} // used to map event types to fixer functions (above), a basic cache mechanism\n\n          , Event = function (event, element, isNative) {\n              if (!arguments.length) return\n              event = event || ((element.ownerDocument || element.document || element).parentWindow || win).event\n              this.originalEvent = event\n              this.isNative       = isNative\n              this.isBean         = true\n\n              if (!event) return\n\n              var type   = event.type\n                , target = event.target || event.srcElement\n                , i, l, p, props, fixer\n\n              this.target = target && target.nodeType === 3 ? target.parentNode : target\n\n              if (isNative) { // we only need basic augmentation on custom events, the rest expensive & pointless\n                fixer = typeFixerMap[type]\n                if (!fixer) { // haven't encountered this event type before, map a fixer function for it\n                  for (i = 0, l = typeFixers.length; i < l; i++) {\n                    if (typeFixers[i].reg.test(type)) { // guaranteed to match at least one, last is .*\n                      typeFixerMap[type] = fixer = typeFixers[i].fix\n                      break\n                    }\n                  }\n                }\n\n                props = fixer(event, this, type)\n                for (i = props.length; i--;) {\n                  if (!((p = props[i]) in this) && p in event) this[p] = event[p]\n                }\n              }\n            }\n\n        // preventDefault() and stopPropagation() are a consistent interface to those functions\n        // on the DOM, stop() is an alias for both of them together\n        Event.prototype.preventDefault = function () {\n          if (this.originalEvent.preventDefault) this.originalEvent.preventDefault()\n          else this.originalEvent.returnValue = false\n        }\n        Event.prototype.stopPropagation = function () {\n          if (this.originalEvent.stopPropagation) this.originalEvent.stopPropagation()\n          else this.originalEvent.cancelBubble = true\n        }\n        Event.prototype.stop = function () {\n          this.preventDefault()\n          this.stopPropagation()\n          this.stopped = true\n        }\n        // stopImmediatePropagation() has to be handled internally because we manage the event list for\n        // each element\n        // note that originalElement may be a Bean#Event object in some situations\n        Event.prototype.stopImmediatePropagation = function () {\n          if (this.originalEvent.stopImmediatePropagation) this.originalEvent.stopImmediatePropagation()\n          this.isImmediatePropagationStopped = function () { return true }\n        }\n        Event.prototype.isImmediatePropagationStopped = function () {\n          return this.originalEvent.isImmediatePropagationStopped && this.originalEvent.isImmediatePropagationStopped()\n        }\n        Event.prototype.clone = function (currentTarget) {\n          //TODO: this is ripe for optimisation, new events are *expensive*\n          // improving this will speed up delegated events\n          var ne = new Event(this, this.element, this.isNative)\n          ne.currentTarget = currentTarget\n          return ne\n        }\n\n        return Event\n      }())\n\n      // if we're in old IE we can't do onpropertychange on doc or win so we use doc.documentElement for both\n    , targetElement = function (element, isNative) {\n        return !W3C_MODEL && !isNative && (element === doc || element === win) ? root : element\n      }\n\n      /**\n        * Bean maintains an internal registry for event listeners. We don't touch elements, objects\n        * or functions to identify them, instead we store everything in the registry.\n        * Each event listener has a RegEntry object, we have one 'registry' for the whole instance.\n        */\n    , RegEntry = (function () {\n        // each handler is wrapped so we can handle delegation and custom events\n        var wrappedHandler = function (element, fn, condition, args) {\n            var call = function (event, eargs) {\n                  return fn.apply(element, args ? slice.call(eargs, event ? 0 : 1).concat(args) : eargs)\n                }\n              , findTarget = function (event, eventElement) {\n                  return fn.__beanDel ? fn.__beanDel.ft(event.target, element) : eventElement\n                }\n              , handler = condition\n                  ? function (event) {\n                      var target = findTarget(event, this) // deleated event\n                      if (condition.apply(target, arguments)) {\n                        if (event) event.currentTarget = target\n                        return call(event, arguments)\n                      }\n                    }\n                  : function (event) {\n                      if (fn.__beanDel) event = event.clone(findTarget(event)) // delegated event, fix the fix\n                      return call(event, arguments)\n                    }\n            handler.__beanDel = fn.__beanDel\n            return handler\n          }\n\n        , RegEntry = function (element, type, handler, original, namespaces, args, root) {\n            var customType     = customEvents[type]\n              , isNative\n\n            if (type == 'unload') {\n              // self clean-up\n              handler = once(removeListener, element, type, handler, original)\n            }\n\n            if (customType) {\n              if (customType.condition) {\n                handler = wrappedHandler(element, handler, customType.condition, args)\n              }\n              type = customType.base || type\n            }\n\n            this.isNative      = isNative = nativeEvents[type] && !!element[eventSupport]\n            this.customType    = !W3C_MODEL && !isNative && type\n            this.element       = element\n            this.type          = type\n            this.original      = original\n            this.namespaces    = namespaces\n            this.eventType     = W3C_MODEL || isNative ? type : 'propertychange'\n            this.target        = targetElement(element, isNative)\n            this[eventSupport] = !!this.target[eventSupport]\n            this.root          = root\n            this.handler       = wrappedHandler(element, handler, null, args)\n          }\n\n        // given a list of namespaces, is our entry in any of them?\n        RegEntry.prototype.inNamespaces = function (checkNamespaces) {\n          var i, j, c = 0\n          if (!checkNamespaces) return true\n          if (!this.namespaces) return false\n          for (i = checkNamespaces.length; i--;) {\n            for (j = this.namespaces.length; j--;) {\n              if (checkNamespaces[i] == this.namespaces[j]) c++\n            }\n          }\n          return checkNamespaces.length === c\n        }\n\n        // match by element, original fn (opt), handler fn (opt)\n        RegEntry.prototype.matches = function (checkElement, checkOriginal, checkHandler) {\n          return this.element === checkElement &&\n            (!checkOriginal || this.original === checkOriginal) &&\n            (!checkHandler || this.handler === checkHandler)\n        }\n\n        return RegEntry\n      }())\n\n    , registry = (function () {\n        // our map stores arrays by event type, just because it's better than storing\n        // everything in a single array.\n        // uses '$' as a prefix for the keys for safety and 'r' as a special prefix for\n        // rootListeners so we can look them up fast\n        var map = {}\n\n          // generic functional search of our registry for matching listeners,\n          // `fn` returns false to break out of the loop\n          , forAll = function (element, type, original, handler, root, fn) {\n              var pfx = root ? 'r' : '$'\n              if (!type || type == '*') {\n                // search the whole registry\n                for (var t in map) {\n                  if (t.charAt(0) == pfx) {\n                    forAll(element, t.substr(1), original, handler, root, fn)\n                  }\n                }\n              } else {\n                var i = 0, l, list = map[pfx + type], all = element == '*'\n                if (!list) return\n                for (l = list.length; i < l; i++) {\n                  if ((all || list[i].matches(element, original, handler)) && !fn(list[i], list, i, type)) return\n                }\n              }\n            }\n\n          , has = function (element, type, original, root) {\n              // we're not using forAll here simply because it's a bit slower and this\n              // needs to be fast\n              var i, list = map[(root ? 'r' : '$') + type]\n              if (list) {\n                for (i = list.length; i--;) {\n                  if (!list[i].root && list[i].matches(element, original, null)) return true\n                }\n              }\n              return false\n            }\n\n          , get = function (element, type, original, root) {\n              var entries = []\n              forAll(element, type, original, null, root, function (entry) {\n                return entries.push(entry)\n              })\n              return entries\n            }\n\n          , put = function (entry) {\n              var has = !entry.root && !this.has(entry.element, entry.type, null, false)\n                , key = (entry.root ? 'r' : '$') + entry.type\n              ;(map[key] || (map[key] = [])).push(entry)\n              return has\n            }\n\n          , del = function (entry) {\n              forAll(entry.element, entry.type, null, entry.handler, entry.root, function (entry, list, i) {\n                list.splice(i, 1)\n                entry.removed = true\n                if (list.length === 0) delete map[(entry.root ? 'r' : '$') + entry.type]\n                return false\n              })\n            }\n\n            // dump all entries, used for onunload\n          , entries = function () {\n              var t, entries = []\n              for (t in map) {\n                if (t.charAt(0) == '$') entries = entries.concat(map[t])\n              }\n              return entries\n            }\n\n        return { has: has, get: get, put: put, del: del, entries: entries }\n      }())\n\n      // we need a selector engine for delegated events, use querySelectorAll if it exists\n      // but for older browsers we need Qwery, Sizzle or similar\n    , selectorEngine\n    , setSelectorEngine = function (e) {\n        if (!arguments.length) {\n          selectorEngine = doc.querySelectorAll\n            ? function (s, r) {\n                return r.querySelectorAll(s)\n              }\n            : function () {\n                throw new Error('Bean: No selector engine installed') // eeek\n              }\n        } else {\n          selectorEngine = e\n        }\n      }\n\n      // we attach this listener to each DOM event that we need to listen to, only once\n      // per event type per DOM element\n    , rootListener = function (event, type) {\n        if (!W3C_MODEL && type && event && event.propertyName != '_on' + type) return\n\n        var listeners = registry.get(this, type || event.type, null, false)\n          , l = listeners.length\n          , i = 0\n\n        event = new Event(event, this, true)\n        if (type) event.type = type\n\n        // iterate through all handlers registered for this type, calling them unless they have\n        // been removed by a previous handler or stopImmediatePropagation() has been called\n        for (; i < l && !event.isImmediatePropagationStopped(); i++) {\n          if (!listeners[i].removed) listeners[i].handler.call(this, event)\n        }\n      }\n\n      // add and remove listeners to DOM elements\n    , listener = W3C_MODEL\n        ? function (element, type, add) {\n            // new browsers\n            element[add ? addEvent : removeEvent](type, rootListener, false)\n          }\n        : function (element, type, add, custom) {\n            // IE8 and below, use attachEvent/detachEvent and we have to piggy-back propertychange events\n            // to simulate event bubbling etc.\n            var entry\n            if (add) {\n              registry.put(entry = new RegEntry(\n                  element\n                , custom || type\n                , function (event) { // handler\n                    rootListener.call(element, event, custom)\n                  }\n                , rootListener\n                , null\n                , null\n                , true // is root\n              ))\n              if (custom && element['_on' + custom] == null) element['_on' + custom] = 0\n              entry.target.attachEvent('on' + entry.eventType, entry.handler)\n            } else {\n              entry = registry.get(element, custom || type, rootListener, true)[0]\n              if (entry) {\n                entry.target.detachEvent('on' + entry.eventType, entry.handler)\n                registry.del(entry)\n              }\n            }\n          }\n\n    , once = function (rm, element, type, fn, originalFn) {\n        // wrap the handler in a handler that does a remove as well\n        return function () {\n          fn.apply(this, arguments)\n          rm(element, type, originalFn)\n        }\n      }\n\n    , removeListener = function (element, orgType, handler, namespaces) {\n        var type     = orgType && orgType.replace(nameRegex, '')\n          , handlers = registry.get(element, type, null, false)\n          , removed  = {}\n          , i, l\n\n        for (i = 0, l = handlers.length; i < l; i++) {\n          if ((!handler || handlers[i].original === handler) && handlers[i].inNamespaces(namespaces)) {\n            // TODO: this is problematic, we have a registry.get() and registry.del() that\n            // both do registry searches so we waste cycles doing this. Needs to be rolled into\n            // a single registry.forAll(fn) that removes while finding, but the catch is that\n            // we'll be splicing the arrays that we're iterating over. Needs extra tests to\n            // make sure we don't screw it up. @rvagg\n            registry.del(handlers[i])\n            if (!removed[handlers[i].eventType] && handlers[i][eventSupport])\n              removed[handlers[i].eventType] = { t: handlers[i].eventType, c: handlers[i].type }\n          }\n        }\n        // check each type/element for removed listeners and remove the rootListener where it's no longer needed\n        for (i in removed) {\n          if (!registry.has(element, removed[i].t, null, false)) {\n            // last listener of this type, remove the rootListener\n            listener(element, removed[i].t, false, removed[i].c)\n          }\n        }\n      }\n\n      // set up a delegate helper using the given selector, wrap the handler function\n    , delegate = function (selector, fn) {\n        //TODO: findTarget (therefore $) is called twice, once for match and once for\n        // setting e.currentTarget, fix this so it's only needed once\n        var findTarget = function (target, root) {\n              var i, array = isString(selector) ? selectorEngine(selector, root) : selector\n              for (; target && target !== root; target = target.parentNode) {\n                for (i = array.length; i--;) {\n                  if (array[i] === target) return target\n                }\n              }\n            }\n          , handler = function (e) {\n              var match = findTarget(e.target, this)\n              if (match) fn.apply(match, arguments)\n            }\n\n        // __beanDel isn't pleasant but it's a private function, not exposed outside of Bean\n        handler.__beanDel = {\n            ft       : findTarget // attach it here for customEvents to use too\n          , selector : selector\n        }\n        return handler\n      }\n\n    , fireListener = W3C_MODEL ? function (isNative, type, element) {\n        // modern browsers, do a proper dispatchEvent()\n        var evt = doc.createEvent(isNative ? 'HTMLEvents' : 'UIEvents')\n        evt[isNative ? 'initEvent' : 'initUIEvent'](type, true, true, win, 1)\n        element.dispatchEvent(evt)\n      } : function (isNative, type, element) {\n        // old browser use onpropertychange, just increment a custom property to trigger the event\n        element = targetElement(element, isNative)\n        isNative ? element.fireEvent('on' + type, doc.createEventObject()) : element['_on' + type]++\n      }\n\n      /**\n        * Public API: off(), on(), add(), (remove()), one(), fire(), clone()\n        */\n\n      /**\n        * off(element[, eventType(s)[, handler ]])\n        */\n    , off = function (element, typeSpec, fn) {\n        var isTypeStr = isString(typeSpec)\n          , k, type, namespaces, i\n\n        if (isTypeStr && typeSpec.indexOf(' ') > 0) {\n          // off(el, 't1 t2 t3', fn) or off(el, 't1 t2 t3')\n          typeSpec = str2arr(typeSpec)\n          for (i = typeSpec.length; i--;)\n            off(element, typeSpec[i], fn)\n          return element\n        }\n\n        type = isTypeStr && typeSpec.replace(nameRegex, '')\n        if (type && customEvents[type]) type = customEvents[type].base\n\n        if (!typeSpec || isTypeStr) {\n          // off(el) or off(el, t1.ns) or off(el, .ns) or off(el, .ns1.ns2.ns3)\n          if (namespaces = isTypeStr && typeSpec.replace(namespaceRegex, '')) namespaces = str2arr(namespaces, '.')\n          removeListener(element, type, fn, namespaces)\n        } else if (isFunction(typeSpec)) {\n          // off(el, fn)\n          removeListener(element, null, typeSpec)\n        } else {\n          // off(el, { t1: fn1, t2, fn2 })\n          for (k in typeSpec) {\n            if (typeSpec.hasOwnProperty(k)) off(element, k, typeSpec[k])\n          }\n        }\n\n        return element\n      }\n\n      /**\n        * on(element, eventType(s)[, selector], handler[, args ])\n        */\n    , on = function(element, events, selector, fn) {\n        var originalFn, type, types, i, args, entry, first\n\n        //TODO: the undefined check means you can't pass an 'args' argument, fix this perhaps?\n        if (selector === undefined && typeof events == 'object') {\n          //TODO: this can't handle delegated events\n          for (type in events) {\n            if (events.hasOwnProperty(type)) {\n              on.call(this, element, type, events[type])\n            }\n          }\n          return\n        }\n\n        if (!isFunction(selector)) {\n          // delegated event\n          originalFn = fn\n          args       = slice.call(arguments, 4)\n          fn         = delegate(selector, originalFn, selectorEngine)\n        } else {\n          args       = slice.call(arguments, 3)\n          fn         = originalFn = selector\n        }\n\n        types = str2arr(events)\n\n        // special case for one(), wrap in a self-removing handler\n        if (this === ONE) {\n          fn = once(off, element, events, fn, originalFn)\n        }\n\n        for (i = types.length; i--;) {\n          // add new handler to the registry and check if it's the first for this element/type\n          first = registry.put(entry = new RegEntry(\n              element\n            , types[i].replace(nameRegex, '') // event type\n            , fn\n            , originalFn\n            , str2arr(types[i].replace(namespaceRegex, ''), '.') // namespaces\n            , args\n            , false // not root\n          ))\n          if (entry[eventSupport] && first) {\n            // first event of this type on this element, add root listener\n            listener(element, entry.eventType, true, entry.customType)\n          }\n        }\n\n        return element\n      }\n\n      /**\n        * add(element[, selector], eventType(s), handler[, args ])\n        *\n        * Deprecated: kept (for now) for backward-compatibility\n        */\n    , add = function (element, events, fn, delfn) {\n        return on.apply(\n            null\n          , !isString(fn)\n              ? slice.call(arguments)\n              : [ element, fn, events, delfn ].concat(arguments.length > 3 ? slice.call(arguments, 5) : [])\n        )\n      }\n\n      /**\n        * one(element, eventType(s)[, selector], handler[, args ])\n        */\n    , one = function () {\n        return on.apply(ONE, arguments)\n      }\n\n      /**\n        * fire(element, eventType(s)[, args ])\n        *\n        * The optional 'args' argument must be an array, if no 'args' argument is provided\n        * then we can use the browser's DOM event system, otherwise we trigger handlers manually\n        */\n    , fire = function (element, type, args) {\n        var types = str2arr(type)\n          , i, j, l, names, handlers\n\n        for (i = types.length; i--;) {\n          type = types[i].replace(nameRegex, '')\n          if (names = types[i].replace(namespaceRegex, '')) names = str2arr(names, '.')\n          if (!names && !args && element[eventSupport]) {\n            fireListener(nativeEvents[type], type, element)\n          } else {\n            // non-native event, either because of a namespace, arguments or a non DOM element\n            // iterate over all listeners and manually 'fire'\n            handlers = registry.get(element, type, null, false)\n            args = [false].concat(args)\n            for (j = 0, l = handlers.length; j < l; j++) {\n              if (handlers[j].inNamespaces(names)) {\n                handlers[j].handler.apply(element, args)\n              }\n            }\n          }\n        }\n        return element\n      }\n\n      /**\n        * clone(dstElement, srcElement[, eventType ])\n        *\n        * TODO: perhaps for consistency we should allow the same flexibility in type specifiers?\n        */\n    , clone = function (element, from, type) {\n        var handlers = registry.get(from, type, null, false)\n          , l = handlers.length\n          , i = 0\n          , args, beanDel\n\n        for (; i < l; i++) {\n          if (handlers[i].original) {\n            args = [ element, handlers[i].type ]\n            if (beanDel = handlers[i].handler.__beanDel) args.push(beanDel.selector)\n            args.push(handlers[i].original)\n            on.apply(null, args)\n          }\n        }\n        return element\n      }\n\n    , bean = {\n          'on'                : on\n        , 'add'               : add\n        , 'one'               : one\n        , 'off'               : off\n        , 'remove'            : off\n        , 'clone'             : clone\n        , 'fire'              : fire\n        , 'Event'             : Event\n        , 'setSelectorEngine' : setSelectorEngine\n        , 'noConflict'        : function () {\n            context[name] = old\n            return this\n          }\n      }\n\n  // for IE, clean up on unload to avoid leaks\n  if (win.attachEvent) {\n    var cleanup = function () {\n      var i, entries = registry.entries()\n      for (i in entries) {\n        if (entries[i].type && entries[i].type !== 'unload') off(entries[i].element, entries[i].type)\n      }\n      win.detachEvent('onunload', cleanup)\n      win.CollectGarbage && win.CollectGarbage()\n    }\n    win.attachEvent('onunload', cleanup)\n  }\n\n  // initialize selector engine to internal default (qSA or throw Error)\n  setSelectorEngine()\n\n  return bean\n});\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/bean/bean.js\n ** module id = 12\n ** module chunks = 0\n **/","import _ from \"lodash\";\nimport Events from \"bean\";\nimport * as KeyUtils from \"./KeyUtils\";\nimport Utils from \"../util/Utils\";\nimport DomUtils from \"../util/DomUtils\";\nimport StringBuffer from \"./../util/StringBuffer\";\n\nconst DEFAULTS = {\n\tstopPropagation: false\n};\n\nexport default class EventDispatcher {\n\t/**\n\t * Constructor\n\t * @param root the root element that the manager will listen to.\n\t * @param zoomScale\n\t * @param config the configuraton for the event dispatcher.\n\t */\n\tconstructor(root, zoomScale = [0, Infinity], config = {}) {\n\t\tthis.root = root;\n\t\tthis.rootNS = root.getAttribute('ns') || 'root';\n\t\tthis.zoomScale = zoomScale;\n\t\t_.assign(this, DEFAULTS, config);\n\t\tthis.scale = 1.0;\n\t\tthis.listeners = {};\n\t\tthis.dragging = false;\n\t\tthis.handler = _.bind(this.handleEvent, this);\n\t\tthis.started = false;\n\n\t\t// Simulate mouseenter/mouseleave events\n\t\tthis.enterStack = [];\n\t}\n\n\t/**\n\t * Start listening for events.\n\t */\n\tstart() {\n\t\tif (this.started) return;\n\t\tEvents.on(this.root, 'mousedown mouseover mouseout mouseenter mouseleave dblclick click contextmenu mousewheel', this.handler);\n\t\tthis.startKeys();\n\t\tthis.started = true;\n\t}\n\n\t/**\n\t * Stop listening for events.\n\t */\n\tstop() {\n\t\tif (!this.started) return;\n\t\tEvents.off(this.root, 'mousedown mouseover mouseout mouseenter mouseleave dblclick click contextmenu mousewheel', this.handler);\n\t\tthis.stopKeys();\n\t\tthis.started = false;\n\t}\n\n\tstartKeys() {\n\t\tEvents.on(document, 'keydown keyup', this.handler);\n\t}\n\n\tstopKeys() {\n\t\tEvents.off(document, 'keydown keyup', this.handler);\n\t}\n\n\tzoomIn() {\n\t\tthis.scale *= 1.25;\n\t\tthis.scale = Math.max(Math.min(this.zoomScale[1], this.scale), this.zoomScale[0]);\n\t\treturn this.scale;\n\t}\n\n\tzoomOut() {\n\t\tthis.scale *= 0.8;\n\t\tthis.scale = Math.max(Math.min(this.zoomScale[1], this.scale), this.zoomScale[0]);\n\t\treturn this.scale;\n\t}\n\n\tgetEventInfo(event) {\n\t\tlet target = event.target;\n\t\tlet buf = new StringBuffer(), ns, stack = [], isRoot = false;\n\t\twhile (!isRoot && target && target != document) {\n\t\t\tns = target.getAttribute('ns');\n\t\t\tif (ns) {\n\t\t\t\tisRoot = _.startsWith(ns, \"root.\");\n\t\t\t\tif (isRoot) {\n\t\t\t\t\tns = ns.substring(5);\n\t\t\t\t\tevent.rootTarget = target;\n\t\t\t\t}\n\t\t\t\tif (!event.nsTarget) event.nsTarget = target;\n\t\t\t\tstack.splice(0, 0, target);\n\t\t\t\tbuf.prepend(ns);\n\t\t\t}\n\t\t\ttarget = target.parentNode;\n\t\t}\n\t\tif (!isRoot)\n\t\t\tevent.rootTarget = event.nsTarget;\n\n\t\t// target stack is a stack of all the ns targets up to the one with the data binding.\n\t\tevent.targetStack = stack;\n\t\tns = buf.toString('.');\n\t\tif (ns == '') ns = this.rootNS;\n\t\treturn {data: event.rootTarget, ns: ns};\n\t}\n\n\t/**\n\t * The main event handler method, it processes event and generate relevant events to dispatch.\n\t */\n\thandleEvent(event) {\n\t\tlet type = event.type;\n\n\t\t// Do not dispatch other events if we are dragging.\n\t\tif (this.dragging || DomUtils.eventFromInput(event)) return;\n\n\t\tlet data, ns, pos = this.getPosition(event), info, isKeyEvent = (type == 'keydown' || type =='keyup');\n\t\tif (isKeyEvent) {\n\t\t\tdata = this.root;\n\t\t\tns = KeyUtils.getKeyEvent(event);\n\t\t} else {\n\t\t\tinfo = this.getEventInfo(event);\n\t\t\tif (!info) return;\n\t\t\tdata = info.data;\n\t\t\tns = info.ns;\n\t\t}\n\n\t\t//Utils.log('EventDispatcher', \"handleEvent - \" + type + ';ns=' + ns);\n\n\t\tif (type == 'mousewheel') {\n\t\t\tthis.scale *= Math.pow(2, event.wheelDelta * 0.002);\n\t\t\tthis.scale = Math.max(Math.min(this.zoomScale[1], this.scale), this.zoomScale[0]);\n\t\t\tevent.scale = this.scale;\n\t\t\ttype = 'zoom';\n\t\t}\n\n\t\t// See if we should create drag events\n\t\tif (type == 'mousedown' && event.button == 0 /*only drag on left click*/) {\n\t\t\t// Create drag object.\n\t\t\tconst dragObject = {data: data, pos: ns == 'root' ? EventDispatcher.mouse(this.root, event) : pos};\n\t\t\tthis.dragging = false;\n\t\t\t// Start listening for mouse move.\n\t\t\tlet dragPos;\n\n\t\t\tconst mousemove = (event) => {\n\t\t\t\tlet currentPos = this.getPosition(event);\n\t\t\t\tif (!this.dragging) {\n\t\t\t\t\t// check if the mouse has moved. IE always fire mousemove after mousedown even if the mouse hasn't moved yet.\n\t\t\t\t\tif (dragObject.pos[0] == currentPos[0] && dragObject.pos[1] == currentPos[1]) return;\n\n\t\t\t\t\t// start dragging\n\t\t\t\t\tthis.dragging = true;\n\t\t\t\t\tevent.rootTarget = dragObject.data;\n\t\t\t\t\tthis.dispatch(event, 'dragstart', ns, dragObject.data, dragObject.pos);\n\t\t\t\t}\n\t\t\t\tif (ns == \"root\")\n\t\t\t\t\tdragPos = EventDispatcher.mouse(this.root, event);\n\t\t\t\telse\n\t\t\t\t\tdragPos = currentPos;\n\t\t\t\tthis.getEventInfo(event);\n\t\t\t\tthis.dispatch(event, 'drag', ns, dragObject.data, dragPos);\n\t\t\t};\n\t\t\tconst mouseup = (event) => {\n\t\t\t\tif (ns == \"root\")\n\t\t\t\t\tdragPos = EventDispatcher.mouse(this.root, event);\n\t\t\t\telse\n\t\t\t\t\tdragPos = this.getPosition(event);\n\n\t\t\t\tlet info = this.getEventInfo(event);\n\t\t\t\tif (this.dragging) {\n\t\t\t\t\tthis.dragging = false;\n\t\t\t\t\tthis.dispatch(event, 'dragend', ns, dragObject.data, dragPos);\n\t\t\t\t} else {\n\t\t\t\t\tthis.dispatch(event, 'mouseup', ns, info.data, dragPos);\n\t\t\t\t}\n\n\t\t\t\tEvents.off(window, 'mousemove', mousemove);\n\t\t\t\tEvents.off(window, 'mouseup', mouseup);\n\t\t\t};\n\t\t\tevent.preventDefault();\n\t\t\tEvents.on(window, 'mousemove', mousemove);\n\t\t\tEvents.on(window, 'mouseup', mouseup);\n\t\t}\n\n\t\tif (!isKeyEvent)\n\t\t\tthis.simulateEnterLeave(event, type, ns, data, pos);\n\t\tthis.dispatch(event, type, ns, data, pos);\n\n\t\t// disable the default context menu\n\t\t//if (type == 'contextmenu')\n\t\t//\tevent.preventDefault();\n\t}\n\n\t/**\n\t * try to simulate mouseenter/mouseleave events.\n\t */\n\tsimulateEnterLeave(event, type, ns, data, pos) {\n\t\tlet last, stack;\n\t\tconst clearEnterStack = (k) => {\n\t\t\tk = k || 0;\n\t\t\t// Clear off the enter stack.\n\t\t\twhile (this.enterStack.length >= k + 1) {\n\t\t\t\tlast = this.enterStack.pop();\n\t\t\t\tthis.dispatch(event, 'mouseleave', last.ns, last.data, pos);\n\t\t\t}\n\t\t};\n\t\tconst getNS = function(index) {\n\t\t\tlet buf = new StringBuffer();\n\t\t\tfor (let i = 0; i <= index; i++) {\n\t\t\t\tvar val = stack[i].getAttribute(\"ns\");\n\t\t\t\tif (_.startsWith(val, \"root.\"))\n\t\t\t\t\tval = val.substring(5);\n\t\t\t\tbuf.append(val);\n\t\t\t}\n\t\t\treturn buf.toString('.');\n\t\t};\n\n\t\tif (ns && ns != this.rootNS) {\n\t\t\tif (type == 'mouseover') {\n\t\t\t\tstack = event.targetStack;\n\t\t\t\tlet item;\n\t\t\t\tfor (let i = 0; i < stack.length; i++) {\n\t\t\t\t\tif (i < this.enterStack.length) {\n\t\t\t\t\t\tif (this.enterStack[i].target != stack[i]) {\n\t\t\t\t\t\t\tclearEnterStack(i);\n\t\t\t\t\t\t} else\n\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\t\t\t\t\titem = {data: data, ns: getNS(i), target: stack[i]};\n\t\t\t\t\tthis.enterStack.push(item);\n\t\t\t\t\tthis.dispatch(event, 'mouseenter', item.ns, data, pos);\n\t\t\t\t}\n\t\t\t\tif (stack.length < this.enterStack.length)\n\t\t\t\t\tclearEnterStack(stack.length);\n\t\t\t}\n\t\t}\n\t\tif (ns == this.rootNS && this.enterStack.length > 0)\n\t\t\tclearEnterStack();\n\t}\n\n\tdispatch(event, type, ns, data, pos) {\n\t\t//if (type != 'mouseover' && type != 'mouseout')\n\t\t//\tUtils.log('EventDispatcher', \"dispatch - \" + type + '.' + ns + ';' + pos + ';rootTarget=' + event.rootTarget + ';data=' + data);\n\t\tif (!this.started) return;\n\t\tconst nsType = ns ? type + '.' + ns : type;\n\t\t_.forEach(this.listeners, (listeners, key) => {\n\t\t\tif (EventDispatcher.match(nsType, listeners.regexp ? listeners.regexp : key)) {\n\t\t\t\t_.forEach(listeners, (listener) => {\n\t\t\t\t\tif (!listener.context)\n\t\t\t\t\t\tlistener.callback.apply(window, [type, ns, data, pos, event]);\n\t\t\t\t\telse\n\t\t\t\t\t\tlistener.callback.apply(listener.context, [type, ns, data, pos, event]);\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\n\t\t// after dispatching, do not propagate.\n\t\tif (this.stopPropagation && event.stopPropagation)\n\t\t\tevent.stopPropagation();\n\t}\n\n\tgetPosition(event) {\n\t\tconst pos = EventDispatcher.mouse(this.root, event);\n\t\tif(! _.isNaN(pos[0]) && ! _.isNaN(pos[1]))\n\t\t\tthis.lastPosition = pos;\n\t\treturn this.lastPosition;\n\t}\n\n\t/**\n\t * Registers a key event handler\n\t * // Key is object {ctrl, alt, shift, meta, code}\n\t */\n\tregisterKey(type, key, callback, context) {\n\t\tif (_.isArray(key)) {\n\t\t\t_.forEach(key, (k) => {\n\t\t\t\tthis.registerKey(type, k, callback, context);\n\t\t\t});\n\t\t\treturn;\n\t\t}\n\t\tkey = KeyUtils.getKeyData(key.ctrl, key.alt, key.shift, key.meta, key.code);\n\t\tif(!key.length) return;\n\t\tkey = new StringBuffer(type).append(key).toString('.');\n\n\t\tconst listener = {callback: callback, context: context};\n\t\tthis.listeners[key] || (this.listeners[key] = []);\n\t\tthis.listeners[key].push(listener);\n\t}\n\n\tunregisterKey(type, key, callback, context) {\n\t\tif (_.isArray(key)) {\n\t\t\t_.forEach(key, (k) => {\n\t\t\t\tthis.unregisterKey(type, k, callback, context);\n\t\t\t});\n\t\t\treturn;\n\t\t}\n\t\tkey = KeyUtils.getKeyData(key.ctrl, key.alt, key.shift, key.meta, key.code);\n\t\tif(!key.length) return;\n\t\tkey = new StringBuffer(type).append(key).toString('.');\n\n\t\tlet listeners = this.listeners[key], listener;\n\t\tif (!listeners) return;\n\t\tfor (let i = 0; i < listeners.length; i++) {\n\t\t\tlistener = listeners[i];\n\t\t\tif (listener.callback === callback && (!context || context === listener.context)) {\n\t\t\t\tlisteners.splice(i, 1);\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * Registers an event handler\n\t */\n\tregister(type, callback, context, zIndex) {\n\t\tif (_.isArray(type)) {\n\t\t\t_.forEach(type, (t) => {\n\t\t\t\tthis.register(t, callback, context, zIndex);\n\t\t\t});\n\t\t\treturn;\n\t\t}\n\t\tconst listener = {callback: callback, context: context, zIndex: zIndex};\n\t\tvar regexp = null;\n\t\tif (type instanceof RegExp) {\n\t\t\tregexp = type;\n\t\t\ttype = type + '';\n\t\t}\n\t\tthis.listeners[type] || (this.listeners[type] = []);\n\t\tif (regexp && !this.listeners[type].regexp)\n\t\t\tthis.listeners[type].regexp = regexp;\n\t\tthis.listeners[type].push(listener);\n\t}\n\n\tunregister(type, callback, context) {\n\t\tif (type instanceof RegExp)\n\t\t\ttype = type + '';\n\t\tlet listeners = this.listeners[type], listener;\n\t\tif (!listeners) return;\n\t\tfor (let i = 0; i < listeners.length; i++) {\n\t\t\tlistener = listeners[i];\n\t\t\tif (listener.callback === callback && (!context || context === listener.context)) {\n\t\t\t\tlisteners.splice(i, 1);\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t}\n\n\tdestroy() {\n\t\tthis.stop();\n\t\tdelete this.root;\n\t\tdelete this.listeners;\n\t\tdelete this.enterStack;\n\t}\n\n\t/**\n\t * Check if the registered event type matches the real event type. \"*\" is allowed as a wild card.\n\t */\n\tstatic match(nsType, registeredType) {\n\t\tif (registeredType instanceof RegExp)\n\t\t\treturn nsType.match(registeredType);\n\n\t\treturn nsType == registeredType;\n\t\t/*const arr = registeredType.split('*');\n\t\tif (arr.length == 1)\n\t\t\treturn nsType == registeredType;\n\n\t\tlet substr, index = 0;\n\t\tfor (let i = 0; i < arr.length; i++) {\n\t\t\tif (arr[i].length == 0) continue;\n\t\t\tsubstr = nsType.slice(index);\n\t\t\tindex = substr.indexOf(arr[i]);\n\t\t\tif (index < 0)\n\t\t\t\treturn false;\n\t\t\tindex += arr[i].length;\n\t\t}\n\t\treturn true;*/\n\t}\n\n\tstatic mouse(container, e) {\n\t\tif (e.changedTouches) e = e.changedTouches[0];\n\t\tvar svg = container.ownerSVGElement || container;\n\t\tif (svg.createSVGPoint) {\n\t\t\tvar point = svg.createSVGPoint();\n\t\t\tpoint.x = e.clientX; point.y = e.clientY;\n\t\t\tpoint = point.matrixTransform(container.getScreenCTM().inverse());\n\t\t\treturn [point.x, point.y];\n\t\t}\n\t\tvar rect = container.getBoundingClientRect();\n\t\treturn [e.clientX - rect.left - container.clientLeft, e.clientY - rect.top - container.clientTop];\n\t}\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/event/EventDispatcher.js\n **/","///////////////////////////////////////////////////////////////////////////////\n//                                                                           //\n//           The Key Utility CLass for the Event Dispatcher          \t     //\n//                                                                           //\n///////////////////////////////////////////////////////////////////////////////\n\nimport StringBuffer from \"./../util/StringBuffer\";\n\n/**\n * KEY constant\n */\nconst KEY = {\n\tALT          : 18,\n\tBACK_SPACE   : 8,\n\tCAPS_LOCK    : 20,\n\tCONTROL      : 17,\n\tDELETE       : 46,\n\tDOWN         : 40,\n\tEND          : 35,\n\tENTER        : 13,\n\tESCAPE       : 220,\n\tHOME         : 36,\n\tLEFT         : 37,\n\tMETA         : 224,\n\tNUM_LOCK     : 144,\n\tPAGE_DOWN    : 34,\n\tPAGE_UP      : 33,\n\tPAUSE        : 19,\n\tPRINTSCREEN  : 44,\n\tRIGHT        : 39,\n\tSCROLL_LOCK  : 145,\n\tSHIFT        : 16,\n\tSPACE        : 32,\n\tTAB          : 9,\n\tUP           : 38\n\t//ADD          : DomUtils.isFireFox ? 61  : 187,\n\t//SUBTRACT     : DomUtils.isFireFox ? 173 : 189\n};\n\nexport function getKeyEvent(event) {\n\tif (!event || !event instanceof KeyboardEvent) {\n\t\treturn null;\n\t}\n\n\tvar key = event.keyCode || event.which;\n\n\t// Need to find a way to avoid this\n\tif (key >= 16 && key <= 18) {\n\t\tkey = null;\n\t}\n\n\treturn getKeyData(event.ctrlKey, event.altKey, event.shiftKey, event.metaKey, key);\n}\n\nexport function getKeyData(ctrl, alt, shift, meta, key) {\n\tvar buf = new StringBuffer();\n\n\tif (ctrl) buf.append(\"CTRL\");\n\tif (alt) buf.append(\"ALT\");\n\tif (shift) buf.append(\"SHIFT\");\n\tif (meta) buf.append(\"META\");\n\tif (key) buf.append(key);\n\n\treturn buf.toString(\".\");\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/event/KeyUtils.js\n **/","import _ from \"lodash\";\nimport Utils from \"../util/Utils\";\nimport Node from \"./Node\";\nimport Edge from \"./Edge\";\nimport Marker from \"../view/Marker\";\n\nconst nodeDefaults = {\n\tname: 'Default',\n\trole: 'node',\n\tdraggable: true,\n\tselectable: true,\n\teditable: true,\n\tresizable: false,\n\tsourceable: true,\n\ttargetable: true,\n\tvisible: true\n};\n\nconst edgeDefaults = {\n\tname: 'Default',\n\trole: 'edge',\n\tselectable: true,\n\tvisible: true,\n\tstartMarker: null,\n\tendMarker: {\n\t\tid: 'Default_EndMarker',\n\t\ttype: 'arrow',\n\t\tsize: 10,\n\t\tcolor: '#0ea117'\n\t},\n\t/* start and end is only used if the edge is not connected to a node */\n\tstart: [0, 0],\n\tend: [400, 200]\n};\n\nclass Graph {\n\tconstructor(id = _.uniqueId(\"G\"), config = {}, model) {\n\t\tthis.id = id;\n\n\t\tthis.nodes = {};\n\t\tthis.edges = {};\n\n\t\tthis.selection = null;\n\t\tthis.destroyed = false;\n\n\t\tUtils.buildTypes(config.nodeTypes, \"Nodes\", nodeDefaults);\n\t\tUtils.buildTypes(config.edgeTypes, \"Edges\", edgeDefaults);\n\t\t// check for markers.\n\t\tthis.markers = [];\n\t\tlet edgeTypes = Utils.type(Edge.namespace), marker, markerConfig;\n\t\tedgeTypes.forEach(function(type) {\n\t\t\tmarkerConfig = type.prototype.startMarker;\n\t\t\tif (markerConfig) {\n\t\t\t\tmarker = Marker.getMarker(markerConfig, true);\n\t\t\t\tthis.markers.push(marker);\n\t\t\t}\n\t\t\tmarkerConfig = type.prototype.endMarker;\n\t\t\tif (markerConfig) {\n\t\t\t\tmarker = Marker.getMarker(markerConfig, false);\n\t\t\t\tthis.markers.push(marker);\n\t\t\t}\n\t\t}, this);\n\n\t\tdelete config.nodeTypes;\n\t\tdelete config.edgeTypes;\n\t\tUtils.initConfig(this, config);\n\t\tthis.root = null;\n\t\tif (model)\n\t\t\tthis.loadModel(model);\n\t}\n\n\tstatic getJSClass(config, defaultClass) {\n\t\tvar jsClass = null;\n\t\tif (config && config.type) {\n\t\t\t// See if we can get the js class from config.\n\t\t\tvar type = Utils.type(defaultClass.namespace, config.type);\n\t\t\tif (type)\n\t\t\t\tjsClass = type.jsClass;\n\t\t}\n\n\t\treturn Utils.getConstructor(jsClass, defaultClass);\n\t}\n\n\t/**\n\t * Create a new Node\n\t */\n\taddNode(config, parent = this.currentRoot, pos) {\n\t\tlet NodeClass = Graph.getJSClass(config, Node);\n\t\tlet node = new NodeClass(this, config);\n\n\t\tif (parent)\n\t\t\tGraph.addChild(parent, node, pos);\n\t\telse {\n\t\t\tthis.root = node;\n\t\t\tthis.root.prop('role', 'root');\n\t\t}\n\n\t\tthis.nodes[node.id] = node;\n\t\treturn node;\n\t}\n\n\taddEdge(config, parent = this.currentRoot, from, to) {\n\t\tlet EdgeClass = Graph.getJSClass(config, Edge);\n\t\tlet edge = new EdgeClass(this, config, from, to);\n\n\t\tGraph.addChild(parent, edge);\n\t\tthis.edges[edge.id] = edge;\n\t\treturn edge;\n\t}\n\n\tstatic addChild(parent, child) {\n\t\tif (!parent.children)\n\t\t\tparent.children = [];\n\n\t\tif (child.parent != parent) {\n\t\t\tparent.children.push(child);\n\n\t\t\tif (child.parent && child.parent.children)\n\t\t\t\tchild.parent.children = _.without(child.parent.children, child);\n\t\t}\n\t\tchild.parent = parent;\n\t}\n\n\tloadModel(model, parent = this.currentRoot) {\n\t\tvar nodes = model.nodes;\n\t\tvar edges = model.edges;\n\t\tdelete model.nodes;\n\t\tdelete model.edges;\n\n\t\tvar node = this.addNode(model, parent);\n\t\tif (nodes) {\n\t\t\t_.forEach(nodes, (child) => {\n\t\t\t\tthis.loadModel(child, node);\n\t\t\t});\n\t\t}\n\t\tif (edges) {\n\t\t\t_.forEach(edges, (edge) => {\n\t\t\t\tlet from, to;\n\t\t\t\tif (edge.from)\n\t\t\t\t\tfrom = this.nodes[edge.from];\n\t\t\t\tif (edge.to)\n\t\t\t\t\tto = this.nodes[edge.to];\n\t\t\t\tthis.addEdge(edge, node, from, to);\n\t\t\t});\n\t\t}\n\t}\n\n\tget currentRoot() {\n\t\treturn this.root;\n\t}\n\n\treset() {}\n\tdestroy() {}\n}\n\nGraph.DEFAULTS = {\n\tallowDanglingEdges: true,\n\tmultiConnect: false,\n\treadOnly: false,\n\tviewOnly: false\n};\n\nexport default Graph;\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/graph/Graph.js\n **/","import _ from \"lodash\";\nimport StringBuffer from \"../util/StringBuffer\";\nimport Cell from \"./Cell\";\n\nclass Node extends Cell {\n\tconstructor(graph, config = {}) {\n\t\tif (!config.id) config.id = _.uniqueId('N');\n\t\tsuper(graph, config);\n\n\t\tthis.inEdges = [];\n\t\tthis.outEdges = [];\n\t\tthis.ports = null;\n\t\tthis.parent = null;\n\t}\n\n\tisAncestor(n) {\n\t\t// TODO: should we move this to graph class ?\n\t\tvar node = n.parent;\n\t\twhile (node) {\n\t\t\tif (this == node) { return true; }\n\t\t\tnode = node.parent;\n\t\t}\n\t\treturn false;\n\t}\n\n\tremoveEdge(edge) {\n\t\tvar edges = edge.source == this ? this.outEdges : this.inEdges;\n\t\tfor (var i = 0; i < edges.length; i++) {\n\t\t\tif (edge == edges[i]) {\n\t\t\t\tedges.splice(i, 1);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\n\t// Add a new incoming edge\n\taddInEdge(edge, pos) {\n\t\tif (pos == null || pos === undefined)\n\t\t\tthis.inEdges.push(edge);\n\t\telse\n\t\t\tthis.inEdges.splice(pos, 0, edge);\n\t}\n\n\t// Add a new outgoing edge\n\taddOutEdge(edge, pos) {\n\t\tif (pos == null || pos === undefined || pos > edge.length - 1)\n\t\t\tthis.outEdges.push(edge);\n\t\telse\n\t\t\tthis.outEdges.splice(pos, 0, edge);\n\t}\n\n\trenderChildren(view) {\n\t\tif (this.children) {\n\t\t\tlet buf = new StringBuffer();\n\t\t\t_.forEach(this.children, (child) => {\n\t\t\t\tbuf.append(child.render(view));\n\t\t\t});\n\t\t\treturn buf.toString();\n\t\t}\n\t\treturn '';\n\t}\n\n\tgetPort(key, portName = 'auto', endPt, orthogonal) {\n\t\tlet shape = this.getShape(key);\n\t\tif (portName == 'auto') {\n\t\t\treturn shape.getPerimeter(endPt, orthogonal);\n\t\t}\n\t\treturn null;\n\t}\n\n\ttoString() {\n\t\tvar label = this.prop(\"label\") ? this.prop(\"label\") : \"undefined\";\n\t\tif (_.isArray(label))\n\t\t\tlabel = label[0];\n\t\treturn 'Node:{id:' + this.id + ';label:' + label + ';type:' + this.props.constructor.typeName + '}';\n\t}\n}\nNode.namespace = \"Nodes\";\n\nexport default Node;\n\n/*\n\n/**\n * The DrillDownParent is the parent that displays the vertex when drilled down.\n *\nVertex.prototype.getDrillDownParent = function() {\n\treturn this.parent;\n};\n\nVertex.prototype.isLocked = function() {\n\tvar mode = this.getProperty(\"mode\") || 3;\n\treturn !(mode & Graph.ALLOW_INTERACTIONS);\n};\n\nVertex.prototype.getCrumbText = function() {\n\tif (this.isLocked())\n\t\treturn '<span><img src=\"webwb/pzreadonly.png\" /></span><span>&nbsp;' + this.getProperty(\"label\") + '</span>';\n\treturn this.getProperty(\"label\");\n};\n\nVertex.prototype.canEdit = function() {\n\treturn (!this.parent || !this.parent.isLocked()) && Vertex.superclass.canEdit.call(this);\n};\n\nVertex.prototype.isContainer = function() {\n\treturn this.getProperty(\"container\");\n};\n\n*/\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/graph/Node.js\n **/","import _ from \"lodash\";\nimport Utils from \"../util/Utils\";\nimport Cache from \"../util/Cache\";\nimport StringBuffer from \"../util/StringBuffer\";\nimport Shape from \"../geometry/Shape\";\nimport Rectangle from \"../geometry/Rectangle\";\nimport Label from \"../view/Label\";\n\n/**\n * The Cell is the common parent for Node and Edge.\n */\nexport default class Cell {\n\tconstructor(graph, config = {id: _.uniqueId()}) {\n\t\tthis.graph = graph;\n\t\tthis.id = config.id;\n\t\tdelete config.id;\n\n\t\t// Initialize decorators\n\t\tif (config.decorators) {\n\t\t\tthis.createDecorators(config.decorators);\n\t\t\tdelete config.decorators;\n\t\t}\n\n\t\t// Initialize View Properties\n\t\tif (config.views) {\n\t\t\tthis.viewProps = config.views;\n\t\t\tdelete config.views;\n\t\t}\n\n\t\t// Initialize type\n\t\tvar type = config.type || \"Default\";\n\t\ttype = Utils.type(this.constructor.namespace, type);\n\t\tif (!type)\n\t\t\tthrow new Error(\"Type not found \" + config.type);\n\t\tdelete config.type;\n\t\tthis.props = new type(config);\n\t}\n\n\tprop(name, value) {\n\t\tif (_.isUndefined(value))\n\t\t\treturn this.props[name];\n\t\tthis.props[name] = value;\n\t}\n\n\t/**\n\t * Get/Set property stored by views.\n\t * @param key\n\t * @param name\n\t * @param value\n\t * @returns {*}\n\t */\n\tviewProp(key = 'default', name, value) {\n\t\tif (_.isUndefined(value)) {\n\t\t\tif (key == 'default')\n\t\t\t\treturn this.prop(name, value);\n\t\t\treturn this.viewProps[key][name];\n\t\t}\n\t\tif (key == 'default') {\n\t\t\tthis.prop(name, value);\n\t\t} else {\n\t\t\tif (!this.viewProps[key])\n\t\t\t\tthis.viewProps[key] = {};\n\t\t\tthis.viewProps[key][name] = value;\n\t\t}\n\t}\n\n\tcreateDecorators(decorators) {}\n\n\t/**\n\t * Get properties needed for rendering this element\n\t * @returns {{key: (string|*), className: *, namespace: *, bounds: *}}\n\t */\n\tgetView(key) {\n\t\tlet shape = this.getShape(key);\n\t\treturn _.assign({\n\t\t\tid: this.id,\n\t\t\tkey: key,\n\t\t\tclassName: this.computedClassName,\n\t\t\tstyle: this.viewProp(key, 'style'),\n\t\t\tnamespace: this.namespace\n\t\t}, shape);\n\t}\n\n\tgetShape(key) {\n\t\tlet shape = Cache.get(this.id + \".shape\", key);\n\t\tif (shape) return shape;\n\n\t\tlet shapeConfig = this.viewProp(key, 'shape');\n\t\tlet shapeClass = shapeConfig ? Shape.getShape(shapeConfig.name) : Shape.getShape('Rectangle');\n\t\tlet x = this.viewProp(key, \"x\");\n\t\tlet y = this.viewProp(key, \"y\");\n\t\tlet width = this.viewProp(key, \"width\");\n\t\tlet height = this.viewProp(key, \"height\");\n\t\tshape = new shapeClass(x, y, width, height, shapeConfig);\n\t\tCache.set(this.id + '.shape', shape, key);\n\t\treturn shape;\n\t}\n\n\trender(view) {\n\t\tlet template = Cache.get(this.id + '.template', view.id);\n\t\tif (!template) {\n\t\t\t//create the template\n\t\t\tlet role = this.prop('role');\n\t\t\ttemplate = view.getTemplate('$' + role, null, this);\n\t\t\tif (_.isString(template))\n\t\t\t\ttemplate = _.template(template);\n\t\t\tCache.set(this.id + '.template', template, view.id);\n\t\t}\n\t\treturn template(this.getView(view.id));\n\t}\n\n\trenderShape(view) {\n\t\tlet shape = this.getShape(view.id);\n\t\tif (shape)\n\t\t\treturn shape.render(view);\n\t\treturn '';\n\t}\n\n\trenderLabel(view) {\n\t\tif (this == this.graph.currentRoot)\n\t\t\treturn null;\n\t\tlet box = this.getLabelBox(view.id);\n\t\tif (box)\n\t\t\treturn view.renderLabel(box);\n\t\treturn '';\n\t}\n\n\tgetLabelBox(key) {\n\t\tlet box = Cache.get(this.id + '.labelBox', key);\n\t\tif (box) return box;\n\t\tlet shape = this.getShape(key);\n\t\t// Just get the config will have a positive performance boost for IE11 and IE10.\n\t\tbox = Label.getLabelBox(this.prop('label'), this.viewProp(key, 'labelConfig'), shape.width, shape.height);\n\t\tCache.set(this.id + '.labelBox', box, key);\n\t\treturn box;\n\t}\n\n\tget computedClassName() {\n\t\tif (!this._computedClassName) {\n\t\t\tvar buf = new StringBuffer(this.prop(\"role\"));\n\t\t\tlet props = this.props;\n\t\t\tif (props.hasOwnProperty(\"className\"))\n\t\t\t\tbuf.append(props[\"className\"]);\n\t\t\tprops = props.constructor.prototype;\n\t\t\twhile (props) {\n\t\t\t\tif (props.hasOwnProperty(\"className\"))\n\t\t\t\t\tbuf.append(props[\"className\"]);\n\t\t\t\tprops = Object.getPrototypeOf(props);\n\t\t\t}\n\t\t\tthis._computedClassName = buf.toString(' ');\n\t\t}\n\t\treturn this._computedClassName;\n\t}\n\n\tget namespace() {\n\t\tif (this == this.graph.currentRoot) return '';\n\t\treturn \"root.\" + this.prop(\"role\");\n\t}\n\n\tdestroy() {\n\t\tdelete this.graph;\n\t\tdelete this.decorators;\n\t\tdelete this.props;\n\t\tdelete this.viewProps;\n\t\tthis.destroyed = true;\n\t}\n}\n\n/*\n\nCell.prototype.move = function(x, y) {\n\tthis.setProperty(\"x\", Math.round(x));\n\tthis.setProperty(\"y\", Math.round(y));\n\tdelete this.bounds;\n};\n\nCell.prototype.resize = function(w, h) {\n\tthis.setProperty(\"width\", w);\n\tthis.setProperty(\"height\", h);\n\tdelete this.bounds;\n};\n\nCell.prototype.canEdit = function() {\n\treturn (this.graph ? this.graph.canEdit() : true) && this.getProperty(\"editable\");\n};\n\nCell.prototype.canSelect = function() {\n\treturn (this.graph ? this.graph.canSelect() : true) && this.getProperty(\"selectable\");\n};\n\nCell.prototype.canMove = function() {\n\treturn (this.graph ? this.graph.canEdit() : true) && this.getProperty(\"draggable\");\n};\n\nCell.prototype.canResize = function() {\n\treturn (this.graph ? this.graph.canEdit() : true) && this.getProperty(\"resizable\");\n};\n\nCell.prototype.getTypeFromString = function(typeStr) {\n\treturn this.graph.getType(typeStr);\n};\n\nCell.prototype.createModifiers = function(modifiers) {\n\tthis.modifiers = null;\n\tvar modifierSettings = this.getProperty(\"modifierSettings\");\n\tif (modifierSettings) {\n\t\t_.each(modifiers, function(config) {\n\t\t\tconfig.type = this.graph.getModifierType(config.className);\n\t\t\tconfig.setting = modifierSettings[config.className];\n\t\t\tif (!config.type || !config.setting) return;\n\n\t\t\tthis.addModifier(config.className, new Modifier(this, config));\n\t\t}, this);\n\n\t\t// Check for showAlways settings\n\t\t_.each(modifierSettings, function(setting, name) {\n\t\t\tif (setting.showAlways && (!this.modifiers || !this.modifiers[name])) {\n\t\t\t\tvar config = {type: this.graph.getModifierType(name), setting: setting};\n\t\t\t\tif (!config.type) return;\n\t\t\t\tthis.addModifier(name, new Modifier(this, config));\n\t\t\t}\n\t\t}, this);\n\t}\n};\n\nCell.prototype.addModifier = function(name, modifier) {\n\tif (!this.modifiers)\n\t\tthis.modifiers = {};\n\n\tif (!modifier.hasOwnProperty(\"showHeader\"))\n\t\tmodifier.showHeader = true;\n\n\t// @hack preferably set it in configurations.\n\tif (modifier.name == \"HoverProcessModifier\" || modifier.name == \"HoverResults\")\n\t\tmodifier.showHeader = false;\n\n\tthis.modifiers[name] = modifier;\n};\n\nCell.prototype.getModifiers = function() {\n\tif (_.isUndefined(this.modifiers))\n\t\tthis.createModifiers();\n\treturn this.modifiers;\n};\n\nCell.prototype.getModifier = function(name) {\n\tvar modifiers = this.getModifiers();\n\tif (modifiers)\n\t\treturn modifiers[name];\n\treturn null;\n};\n\nCell.prototype.isVisible = function() {\n\treturn this.getProperty('visible');\n};\n\nCell.prototype.isContainer = function() {\n\treturn false;\n};\n*/\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/graph/Cell.js\n **/","/**\n * Created by tong on 6/7/2016.\n */\n\nlet caches = {};\n\nlet Cache = {\n\tget: function(key, namespace) {\n\t\treturn this.getCache(namespace)[key];\n\t},\n\n\tset: function(key, value, namespace) {\n\t\tthis.getCache(namespace)[key] = value;\n\t},\n\n\tcontains: function(key, namespace) {\n\t\treturn key in this.getCache(namespace);\n\t},\n\n\tremove: function(key, namespace) {\n\t\tdelete this.getCache(namespace)[key];\n\t},\n\n\tclear: function(namesapce) {\n\t\tif (!namespace)\n\t\t\tcaches = {};\n\t\telse if (caches[namespace])\n\t\t\tcaches[namespace] = {};\n\t},\n\n\tgetCache: function(namespace = 'default') {\n\t\tif (!caches[namespace])\n\t\t\tcaches[namespace] = {};\n\t\treturn caches[namespace];\n\t}\n};\n\nexport default Cache;\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/util/Cache.js\n **/","import _ from \"lodash\";\nimport Events from \"bean\";\nimport Utils from \"../util/Utils\";\nimport DomUtils from \"../util/DomUtils\";\nimport StringBuffer from \"../util/StringBuffer\";\nimport Rectangle from \"../geometry/Rectangle\";\n\nconst FONT_BOLD = 1, FONT_ITALIC = 2, FONT_UNDERLINE = 4, FONT_SHADOW = 8;\n\nlet defaultConfig = {\n\tfontSize: 11,\n\tfontFamily: \"Arial\",\n\tfontStyle: 0,\n\tfontColor: 'black',\n\tpadding: 0,\n\tlinePadding: 0,\n\talign: \"left\",\n\twidth: 0,\n\theight: 0,\n\trotation: null,\n\tgeometry: {x: 0, y: 0, anchorY: 0, offsetX: 0, offsetY: 0}\n};\n\n/**\n * The label object handles label sizing/positioning\n */\nexport default (function() {\n\tlet stringMeasureEl = null, measureDiv, baselineDiv;\n\n\t/**\n\t * Calculate the size of the string.\n\t */\n\tlet getStringSize = _.memoize(function(str, fontSize, fontFamily, bold) {\n\t\tfontSize = fontSize || 11;\n\t\tfontFamily = fontFamily || 'Arial,Helvetica';\n\t\tbold = !_.isUndefined(bold) ? bold: false;\n\n\t\t// first check if there is a string-measuring div available, if not, create now.\n\t\tif (!stringMeasureEl) {\n\t\t\tstringMeasureEl = DomUtils.createElement('iframe', {id:\"_ComputeStylesIframe\"}, {position:\"absolute\", visibility:\"hidden\", width:\"auto\"});\n\t\t\tdocument.body.appendChild(stringMeasureEl);\n\t\t\tvar doc = stringMeasureEl.contentWindow.document;\n\t\t\tdoc.open();\n\t\t\tdoc.write('<html><body>\\\n\t\t\t\t<div id=\"baselineDiv\" style=\"height:100px;\"><span style=\"line-height:0\">T</span><span style=\"height:100%;display:inline-block;\"></span></div>\\\n\t\t\t\t<div id=\"measureDiv\" style=\"position:absolute;width:auto;height:auto;padding:0;white-space:pre-wrap;word-wrap:break-word;display:inline-block;\"></div>\\\n\t\t\t\t</body></html>');\n\t\t\tdoc.close();\n\t\t\tmeasureDiv = doc.getElementById(\"measureDiv\");\n\t\t\tbaselineDiv = doc.getElementById(\"baselineDiv\");\n\t\t}\n\t\tbaselineDiv.style.fontSize = measureDiv.style.fontSize = fontSize;\n\t\tbaselineDiv.style.fontFamily = measureDiv.style.fontFamily = fontFamily;\n\t\tbaselineDiv.style.fontWeight = measureDiv.style.fontWeight = bold ? 'bold' : 'normal';\n\t\tmeasureDiv.innerHTML = str;\n\n\t\tlet strut = baselineDiv.firstChild;\n\t\tlet baselineHeight = strut.offsetTop + strut.offsetHeight - baselineDiv.offsetHeight - baselineDiv.offsetTop;\n\n\t\treturn {width: measureDiv.offsetWidth, height: measureDiv.offsetHeight, baseline: baselineHeight};\n\t}, function(str, fontSize, fontFamily, bold) { return str + ';' + fontSize + ';' + fontFamily + ';' + bold; });\n\n\t/**\n\t * Create a wrapped text.\n\t * @param {String} string the string to wrap.\n\t * @param {maxWidth} the maximum width this string can take.\n\t * @param {fontSize}\n\t * @param {fontFamily}\n\t * @param {bold}\n\t */\n\tlet wrap = _.memoize(function(string, maxWidth, fontSize, fontFamily, bold) {\n\t\tmaxWidth = maxWidth || 0;\n\t\tfontSize = fontSize || 11;\n\t\tfontFamily = fontFamily || 'Arial,Helvetica';\n\t\tbold = !_.isUndefined(bold) ? bold: false;\n\n\t\tlet arr = [];\n\t\tlet spaceSize = getStringSize(\"&nbsp;\", fontSize, fontFamily, bold), space = spaceSize.width;\n\t\tarr.lineHeight = spaceSize.height;\n\t\tarr.baseline = spaceSize.baseline;\n\n\t\tif (!maxWidth || !string || string == \"\") {\n\t\t\tarr.push(string);\n\t\t\tarr.width = (!string || string == \"\") ? space : getStringSize(string, fontSize, fontFamily, bold).width;\n\t\t\tarr.height = arr.lineHeight;\n\t\t\treturn arr;\n\t\t}\n\n\t\tvar width = 0;\n\t\t//split the text by lines\n\t\tvar lines = string.split('\\n');\n\n\t\tvar buf = new StringBuffer();\n\n\t\tfor (var j = 0; j < lines.length; j++) {\n\t\t\t//split each line by word\n\t\t\tvar words = lines[j].split(/\\s/);\n\t\t\tvar line = \"\", currentWidth = 0, wordWidth = 0, newLine = true, word;\n\n\t\t\tfor (var i = 0; i < words.length; i++) {\n\t\t\t\tword = words[i];\n\t\t\t\twordWidth = getStringSize(word, fontSize, fontFamily, bold).width;\n\n\t\t\t\tif ((newLine ? wordWidth : currentWidth + space + wordWidth) > maxWidth) {\n\t\t\t\t\tif (newLine) {\n\t\t\t\t\t\tbuf.append(word);\n\t\t\t\t\t\twidth = Math.max(width, wordWidth);\n\t\t\t\t\t\tif (i < words.length - 1) {\n\t\t\t\t\t\t\tarr.push(buf.toString());\n\t\t\t\t\t\t\tbuf.clear();\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tarr.push(buf.append(line).toString());\n\t\t\t\t\t\twidth = Math.max(width, currentWidth + space + wordWidth);\n\t\t\t\t\t\tbuf.clear();\n\t\t\t\t\t}\n\t\t\t\t\tline = \"\";\n\t\t\t\t\tcurrentWidth = 0;\n\t\t\t\t\tif (!newLine)\n\t\t\t\t\t\ti--; // move back one word.\n\t\t\t\t\tnewLine = true;\n\t\t\t\t} else {\n\t\t\t\t\tline = newLine ? word : line + \" \" + word;\n\t\t\t\t\tcurrentWidth = newLine ? wordWidth : currentWidth + space + wordWidth;\n\t\t\t\t\twidth = Math.max(width, currentWidth);\n\t\t\t\t\tnewLine = false;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (line != \"\")\n\t\t\t\tbuf.append(line);\n\t\t\tif (j < lines.length - 1) {\n\t\t\t\tarr.push(buf.toString());\n\t\t\t\tbuf.clear();\n\t\t\t}\n\t\t}\n\n\t\tarr.push(buf.toString());\n\t\tarr.width = width;\n\t\tarr.height = arr.lineHeight * arr.length;\n\t\treturn arr;\n\t}, function(str, maxWidth, fontSize, fontFamily, bold) { return str + ';' + maxWidth + ';' + fontSize + ';' + fontFamily + ';' + bold; });\n\n\t/**\n\t *  Get the view information for how to display the label.\n\t * @param label The string that needs to be displayed\n\t * @param containerWidth The width of the parent container.\n\t * @param containerHeight The height of the parent container.\n\t * @param labelConfig The configuration on how to display label. It should be an object with the following parameters:\n\t * {\n\t *      fontSize, fontFamily, fontStyle, padding,\n\t *      align: can be either \"left\", \"center\" or \"right\",\n\t *      width: the maximum width of the label. if less than 1, then is treated as percentage. If 0, no wrapping will occur,\n\t *      height,\n\t *      geometry\n\t * }\n\t * @returns {*}\n\t */\n\tfunction getLabelBox(label, labelConfig, containerWidth, containerHeight) {\n\t\treturn _getLabelBox.call(this, label, labelConfig, {width: containerWidth, height: containerHeight});\n\t}\n\n\tfunction getLabelBoxForLink(label, labelConfig, link) {\n\t\treturn _getLabelBox.call(this, label, labelConfig, link);\n\t}\n\n\tfunction _getLabelBox(label, labelConfig = {}, context) {\n\t\tlabelConfig = _.defaultsDeep(labelConfig, defaultConfig);\n\t\tlet fontSize = labelConfig.fontSize;\n\t\tlet fontFamily = labelConfig.fontFamily;\n\t\tlet fontStyle = labelConfig.fontStyle;\n\t\tlet bold = (fontStyle & FONT_BOLD) == FONT_BOLD;\n\t\tlet padding = labelConfig.padding;\n\t\tlet linePadding = labelConfig.linePadding;\n\t\tlet align = labelConfig.align;\n\n\t\tlet w = labelConfig.width, h = labelConfig.height;\n\t\tif (context.width) {\n\t\t\tw = w <= 5 ? context.width * w : w;\n\t\t\th = h <= 5 ? context.height * h : h;\n\t\t}\n\t\tw -= 2 * padding;\n\t\th -= 2 * padding;\n\t\tw = Math.max(0, w);\n\t\th = Math.max(0, h);\n\n\t\tlet geometry = _.clone(labelConfig.geometry);\n\t\tlet wrappedLabel = this.wrap(label, w, fontSize, fontFamily, bold);\n\t\tgeometry.width = wrappedLabel.width + 2 * padding;\n\t\tgeometry.height = wrappedLabel.height + 2 * padding + (wrappedLabel.length - 1) * linePadding;\n\t\tlet anchor = \"start\", dx = 0, setAnchorX = !_.has(geometry, \"anchorX\");\n\t\tswitch (align) {\n\t\t\tcase \"center\":\n\t\t\t\tanchor = \"middle\";\n\t\t\t\tif (setAnchorX) geometry.anchorX = 0;\n\t\t\t\tbreak;\n\t\t\tcase \"right\":\n\t\t\t\tanchor = \"end\";\n\t\t\t\tdx = wrappedLabel.width/2;\n\t\t\t\tif (setAnchorX) geometry.anchorX = -0.5;\n\t\t\t\tbreak;\n\t\t\tcase \"left\":\n\t\t\t\tdx = -wrappedLabel.width/2;\n\t\t\t\tif (setAnchorX) geometry.anchorX = 0.5;\n\t\t\t\tbreak;\n\t\t}\n\t\tlet pos;\n\t\tif (context.getRelativePosition)\n\t\t\tpos = context.getRelativePosition(geometry);\n\t\telse\n\t\t\tpos = Utils.getRelativePosition({width: context.width, height: context.height}, geometry);\n\n\t\tlet bounds = new Rectangle(pos[0], pos[1], geometry.width, geometry.height);\n\t\t// the pivot is the center of rotation when the label has a rotation specified.\n\t\tlet pivot = align == 'center' ? [0, 0] : (align == 'left' ? [-wrappedLabel.width/2, 0] : [wrappedLabel.width/2, 0]);\n\n\t\t// the maximum bounds for the label, used to position inline editor\n\t\tgeometry.width = Math.max(w + 2 * padding, geometry.width);\n\t\tgeometry.height = Math.max(h + 2 * padding, geometry.height);\n\n\t\tif (context.getRelativePosition)\n\t\t\tpos = context.getRelativePosition(geometry);\n\t\telse\n\t\t\tpos = Utils.getRelativePosition({width: context.width, height: context.height}, geometry);\n\n\t\tlet maxBounds = new Rectangle(pos[0], pos[1], geometry.width, geometry.height);\n\t\treturn {\n\t\t\tconfig: labelConfig, label: wrappedLabel, _label: label,\n\t\t\tbold, underline: fontStyle & FONT_UNDERLINE, italic: fontStyle & FONT_ITALIC, shadow: fontStyle & FONT_SHADOW,\n\t\t\tdx, dy: -geometry.height/2 + padding + wrappedLabel.lineHeight - wrappedLabel.baseline, anchor, lineHeight: wrappedLabel.lineHeight + linePadding,\n\t\t\tpivot, bounds, maxBounds\n\t\t};\n\t}\n\n\tfunction render(view, box) {\n\t\treturn view.renderLabel(box);\n\t}\n\n\tlet editor = {\n\t\tstart: function(key, container, box, refEl, textEl, scale = 1.0, singleLine = true) {\n\t\t\tif (this.input) {\n\t\t\t\tif (this.key != key) {\n\t\t\t\t\t// need to close the existing editor first\n\t\t\t\t\tthis.stop();\n\t\t\t\t} else\n\t\t\t\t\treturn;\n\t\t\t}\n\t\t\tvar tag = singleLine ? 'input' : 'textarea';\n\t\t\tthis.input = DomUtils.createElement(tag, {id:\"inlineEditor\", unselectable:\"off\"}, {position:\"absolute\", overflow:\"hidden\", padding:\"0px\", margin:\"0px\", border:\"transparent\"});\n\t\t\tif (singleLine) {\n\t\t\t\tEvents.on(this.input, 'keydown keyup', (event) => {\n\t\t\t\t\tif (event.keyCode == 13) {\n\t\t\t\t\t\tEvents.off(this.input, 'keydown keyup');\n\t\t\t\t\t\tthis.stop();\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t\tcontainer.appendChild(this.input);\n\n\t\t\tthis.key = key;\n\t\t\tthis.box = box;\n\t\t\tthis.refEl = refEl;\n\t\t\tthis.textEl = textEl;\n\n\t\t\tlet labelConfig = box.config;\n\t\t\tlet maxBounds = new Rectangle(box.maxBounds.x, box.maxBounds.y, box.maxBounds.width * scale, box.maxBounds.height * scale);\n\t\t\tlet pos = DomUtils.getCenterPosition(refEl, container);\n\t\t\tpos = [pos[0] + maxBounds.left, pos[1] + maxBounds.top];\n\n\t\t\tif (textEl)\n\t\t\t\ttextEl.style.visibility = 'hidden';\n\n\t\t\tDomUtils.setElement(this.input, null, {\n\t\t\t\tvisibility: 'visible',\n\t\t\t\tleft: pos[0] + \"px\",\n\t\t\t\ttop: pos[1] + \"px\",\n\t\t\t\twidth: maxBounds.width + 'px',\n\t\t\t\theight: maxBounds.height + 'px',\n\t\t\t\t\"font-family\": labelConfig.fontFamily,\n\t\t\t\t\"font-size\": (labelConfig.fontSize * scale) + 'px',\n\t\t\t\t\"font-weight\": (labelConfig.fontStyle & FONT_BOLD) == FONT_BOLD ? 'bold' : 'normal'\n\t\t\t\t/*\"color\": labelConfig.fontColor*/\n\t\t\t});\n\n\t\t\tthis.input.value = box._label;\n\t\t\tthis.input.focus();\n\t\t\tthis.input.select();\n\t\t\tEvents.fire(this, 'editor.start', [this.key]);\n\t\t},\n\n\t\tstop: function(cancel) {\n\t\t\tif (!this.input) return;\n\n\t\t\tcancel = cancel || false;\n\t\t\tif (this.textEl)\n\t\t\t\tthis.textEl.style.visibility = null;\n\n\t\t\tif (!cancel)\n\t\t\t\tEvents.fire(this, 'editor.update', [this.key, this.input.value]);\n\n\t\t\tEvents.fire(this, 'editor.stop', [this.key]);\n\n\t\t\t// remove the input\n\t\t\tthis.input.parentNode.removeChild(this.input);\n\t\t\tdelete this.input;\n\t\t\tdelete this.key;\n\t\t\tdelete this.box;\n\t\t\tdelete this.refEl;\n\t\t\tdelete this.textEl;\n\t\t}\n\t};\n\n\treturn {\n\t\tFONT_BOLD,\n\t\tFONT_ITALIC,\n\t\tFONT_UNDERLINE,\n\t\tFONT_SHADOW,\n\t\tgetStringSize,\n\t\twrap,\n\t\tgetLabelBox,\n\t\tgetLabelBoxForLink,\n\t\trender,\n\t\teditor\n\t};\n})();\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/view/Label.js\n **/","import _ from \"lodash\";\nimport Cell from \"./Cell\";\nimport Rectangle from \"../geometry/Rectangle\";\nimport Link from \"../geometry/Link\";\nimport Label from \"../view/Label\";\nimport Cache from \"../util/Cache\";\n\nclass Edge extends Cell {\n\tconstructor(graph, config = {}, source, target) {\n\t\tif (!config.id) config.id = _.uniqueId('E');\n\t\tsuper(graph, config);\n\n\t\tthis.source = this.target = null;\n\t\tthis.setSource(source, config.sourcePos);\n\t\tthis.setTarget(target, config.targetPos);\n\t}\n\n\tsetSource(node, pos) {\n\t\tthis.setTerminal(node, pos, 'source');\n\t}\n\n\tsetTarget(node, pos) {\n\t\tthis.setTerminal(node, pos, 'target');\n\t}\n\n\t/**\n\t * Internal methods to set either the source or target\n\t */\n\t setTerminal(node, pos, dir) {\n\t\tvar end = dir == 'source' ? this.source : this.target;\n\t\tif (end == node) {\n\t\t\t// simply change the position of the edge.\n\t\t\tif (node)\n\t\t\t\tnode.setEdgeAt(this, pos);\n\t\t} else {\n\t\t\tif (end) {\n\t\t\t\t// first remove the edge from the current end\n\t\t\t\tend.removeEdge(this);\n\t\t\t}\n\n\t\t\tif (node) {\n\t\t\t\tif (dir == 'source')\n\t\t\t\t\tnode.addOutEdge(this, pos);\n\t\t\t\telse\n\t\t\t\t\tnode.addInEdge(this, pos);\n\t\t\t}\n\t\t\tif (dir == 'source')\n\t\t\t\tthis.source = node;\n\t\t\telse\n\t\t\t\tthis.target = node;\n\t\t\t//this.clearPoints();\n\t\t}\n\t}\n\n\tgetLabelBox(key) {\n\t\tvar label = this.prop('label');\n\t\tif (label)\n\t\t\treturn Label.getLabelBoxForLink(label, this.viewProp(key, 'labelConfig'), this.getShape(key));\n\t\treturn null;\n\t}\n\n\t/**\n\t * Return a pair of points as reference to the calculation of start and end points.\n\t */\n\tgetReferencePoints(key) {\n\t\tlet pts = [];\n\t\tif (this.source)\n\t\t\tpts.push(this.source.getShape(key).center);\n\t\telse\n\t\t\tpts.push(this.viewProp(key, 'start'));\n\n\t\tif (this.target)\n\t\t\tpts.push(this.target.getShape(key).center);\n\t\telse\n\t\t\tpts.push(this.viewProp(key, 'end'));\n\n\t\treturn pts;\n\t}\n\n\tgetTerminalVisual(key, orthogonal) {\n\t\tlet refPts = this.getReferencePoints(key);\n\t\tlet terminals = [];\n\n\t\tlet getBound = function(pt) {\n\t\t\treturn new Rectangle(pt.x, pt.y, 3, 3);\n\t\t};\n\n\t\tif (this.source) {\n\t\t\tterminals.push(this.source.getPort(key, this.prop('sourcePort'), refPts[1], orthogonal));\n\t\t} else\n\t\t\tterminals.push({point: refPts[0], direction: Rectangle.getDirection(getBound(refPts[0]), refPts[1], true)});\n\n\t\tif (this.target) {\n\t\t\tterminals.push(this.target.getPort(key, this.prop('targetPort'), refPts[0], orthogonal));\n\t\t} else\n\t\t\tterminals.push({point: refPts[1], direction: Rectangle.getDirection(getBound(refPts[1]), refPts[0], true)});\n\t\treturn terminals;\n\t}\n\n\tgetShape(key) {\n\t\tlet shape = Cache.get(this.id + \".shape\", key);\n\t\tif (shape) return shape;\n\n\t\tlet config = this.viewProp(key, 'shape');\n\t\tshape = Link.getLink(this.getTerminalVisual(key, config.orthogonal), config, this.prop('startMarker'), this.prop('endMarker'));\n\t\tCache.set(this.id + '.shape', shape, key);\n\t\treturn shape;\n\t}\n\n\ttoString() {\n\t\treturn 'Edge:{' + (!this.source ? 'null' : this.source.id) + '--' + (!this.target ? 'null' : this.target.id) + '}';\n\t}\n\n\tdestroy() {\n\t\tsuper.destroy();\n\t\tthis.setSource(null);\n\t\tthis.setTarget(null);\n\t}\n}\nEdge.namespace = \"Edges\";\n\nexport default Edge;\n\n/*\n\nEdge.prototype.isVisible = function() {\n\tif (this.graph.getProperty(\"allowDanglingEdges\")) {\n\t\treturn (this.source ? this.source.isVisible() : true) && (this.target ? this.target.isVisible() : true) && this.getProperty(\"visible\");\n\t} else\n\t\treturn this.source && this.target && this.getProperty('visible') && this.source.isVisible() && this.target.isVisible();\n};\n\n*/\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/graph/Edge.js\n **/","import Rectangle from \"../geometry/Rectangle\";\n\nlet registry = {};\n\nlet Marker = (function() {\n\n\t/** Begin Standard Marker Type **/\n\tfunction arrow(size, source, styles) {\n\t\tvar sign = source ? -1 : 1;\n\t\tvar marker = {\n\t\t\tviewBox: new Rectangle(-5, -5, 10, 10),\n\t\t\tsize: size,\n\t\t\tref: [4*sign, 0],\n\t\t\tfill: styles.color\n\t\t};\n\t\tmarker.shape = {\n\t\t\tname: 'Polygon',\n\t\t\tpoints: [[-2*sign, 0], [-4*sign, 4], [4*sign, 0], [-4*sign, -4]]\n\t\t};\n\t\treturn marker;\n\t}\n\n\tfunction triangle(size, source, styles) {\n\t\tvar sign = source ? -1 : 1;\n\t\tvar marker = {\n\t\t\tviewBox: new Rectangle(-5, -5, 10, 10),\n\t\t\tsize: size,\n\t\t\tref: [4*sign, 0],\n\t\t\tfill: styles.color\n\t\t};\n\t\tmarker.shape = {\n\t\t\tname: 'Polygon',\n\t\t\tpoints: [[-5*sign, -5], [-5*sign, 5], [4*sign, 0]]\n\t\t};\n\t\treturn marker;\n\t}\n\n\tfunction oval(size, source, styles) {\n\t\tvar r = size / 2;\n\t\tvar marker = {\n\t\t\tviewBox: new Rectangle(-r, -r, size, size),\n\t\t\tsize: size,\n\t\t\tref: [0, 0],\n\t\t\tfill: styles.color\n\t\t};\n\t\tmarker.shape = '<ellipse cx=\"0\" cy=\"0\" rx=\"' + r + '\" ry=\"' + r + '\"></ellipse>';\n\t\treturn marker;\n\t}\n\n\tfunction diamond(size, source, styles) {\n\t\tvar sign = source ? -1 : 1;\n\t\tvar marker = {\n\t\t\tviewBox: new Rectangle(-5, -5, 10, 10),\n\t\t\tsize: size,\n\t\t\tref: [4*sign, 0],\n\t\t\tfill: styles.color\n\t\t};\n\t\tmarker.shape = '';\n\t\treturn marker;\n\t}\n\t/** End Standard Marker Type **/\n\tfunction getMarker(config, source) {\n\t\tvar factory = registry[config.type];\n\t\tvar marker = factory(config.size, source, config);\n\t\tmarker.id = config.id;\n\t\treturn marker;\n\t}\n\n\tregistry['arrow'] = arrow;\n\tregistry['triangle'] = triangle;\n\tregistry['oval'] = oval;\n\tregistry['diamond'] = diamond;\n\n\treturn {\n\t\tregistry: registry,\n\t\tgetMarker: getMarker\n\t};\n})();\n\nexport default Marker;\n\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/view/Marker.js\n **/","import _ from \"lodash\";\nimport Utils from \"../util/Utils\";\n\nclass Layout {\n\tconstructor(config={}) {\n\t\tif (config.hasOwnProperty(\"orientation\") && _.isString(config.orientation)) {\n\t\t\tif (config.orientation.toUpperCase() == \"HORIZONTAL\")\n\t\t\t\tconfig.orientation = Layout.HORIZONTAL;\n\t\t\telse\n\t\t\t\tdelete config.orientation;\n\t\t}\n\t\tUtils.initConfig(this, config);\n\t}\n\n\tlayout(root, bounds) {}\n\treset() {}\n\tdestroy() {}\n}\nLayout.VERTICAL = 0;\nLayout.HORIZONTAL = 1;\n\nLayout.DEFAULTS = {\n\torientation: Layout.VERTICAL\n};\n\nexport default Layout;\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/layout/Layout.js\n **/","import Layout from \"./Layout\";\n\nclass FlowLayout extends Layout {\n\tlayout(root, bounds) {\n\t\tvar items;\n\t\tif (!root)\n\t\t\titems = this.owner.childNodes;\n\t\telse if (_.isArray(root))\n\t\t\titems = root;\n\t\telse\n\t\t\titems = root.getLinkedNodes('target');\n\t\tif (!items || items.length == 0) return;\n\n\t\tvar x = 0, y = 0, h = 0, node;\n\t\tvar p1 = 0, p2 = 0;\n\t\tfor (var i = 0; i < items.length; i++) {\n\t\t\tnode = items[i];\n\t\t\tif (x > 0 && x + this.hgap + node.getProperty(\"width\") > bounds.width) {\n\t\t\t\t// create new line\n\t\t\t\ty += h + this.vgap;\n\t\t\t\tx = 0;h = 0;p1 = 0;p2++;\n\t\t\t}\n\t\t\tnode._flPos = [p1, p2];\n\t\t\tnode.moveTo([bounds.x + x, bounds.y + y]);\n\t\t\tx += this.hgap + node.getProperty(\"width\");\n\t\t\tp1++;\n\t\t\th = h < node.getProperty(\"height\") ? node.getProperty(\"height\") : h;\n\t\t}\n\t\tthis.trigger(new Rectangle(bounds.x, bounds.y, bounds.width, y + h));\n\t}\n}\n\nFlowLayout.DEFAULTS = {\n\thgap: 10,\n\tvgap: 10\n};\n\nexport default FlowLayout;\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/layout/FlowLayout.js\n **/","import _ from \"lodash\";\nimport Events from \"bean\";\nimport Utils from \"../util/Utils\";\nimport DomUtils from \"../util/DomUtils\";\nimport Layout from \"../layout/Layout\";\nimport Rectangle from \"../geometry/Rectangle\";\nimport EventDispatcher from \"../event/EventDispatcher\";\nimport GraphBehavior from \"../behavior/GraphBehavior\";\nimport SelectionBehavior from \"../behavior/SelectionBehavior\";\nimport Label from \"./Label\";\n\nclass Renderer {\n\tconstructor(id, container, config = {}, graph = null) {\n\t\tthis.id = id;\n\t\tthis.box = DomUtils.createElement('div', {id: this.id, tabindex: 0, ns: 'graph'}, {overflow: \"hidden\", width: \"100%\", height: \"100%\", position: 'relative'});\n\t\tcontainer.appendChild(this.box);\n\t\tif (config.layout) {\n\t\t\tlet layoutClass = Utils.getConstructor(config.layout.jsClass, Layout);\n\t\t\tthis.layout = new layoutClass(config.layout.config);\n\t\t\tdelete config.layout;\n\t\t}\n\t\tthis.clear = true;\n\t\tthis._translate = [0, 0];\n\t\tthis._scale = 1.0;\n\t\tthis.graph = graph;\n\t\tthis.dispatcher = null;\n\t\tthis.graphBehavior = null;\n\t\tthis.selectionBehavior = null;\n\t\tthis.nodeBehavior = null;\n\t\tthis.edgeBehavior = null;\n\t\tthis.connectionBehavior = null;\n\t\tUtils.initConfig(this, config);\n\n\t\tEvents.on(Label.editor, 'editor.update.*', function(key, value) {\n\t\t\tconsole.log(key + '=' + value);\n\t\t});\n\t}\n\n\tget graph() {\n\t\treturn this._graph;\n\t}\n\n\tset graph(graph) {\n\t\tthis._graph = graph;\n\t\tlet root = graph.currentRoot;\n\t\tif (root) {\n\t\t\tthis._translate = [root.viewProp(this.id, 'x') || 0, root.viewProp(this.id, 'y') || 0];\n\t\t\tthis._scale = root.viewProp(this.id, 'scale') || 1.0;\n\t\t}\n\t}\n\n\tviewport(scaled, viewport) {\n\t\tif (_.isUndefined(scaled) || _.isNull(scaled)) scaled = false;\n\t\tif (!viewport) {\n\t\t\tvar vp = new Rectangle(0, 0, this.box.offsetWidth, this.box.offsetHeight);\n\t\t\tif (scaled)\n\t\t\t\treturn Utils.scale(this.translate, this.scale, vp);\n\t\t\treturn vp;\n\t\t}\n\t\tif (!scaled) viewport = Utils.scale(this.translate, this.scale, viewport);\n\t\tvar w = this.box.offsetWidth;\n\t\tvar scale = w / viewport.width;\n\t\tthis.transform(-viewport.x*scale, -viewport.y*scale, scale);\n\t}\n\n\tget translate() { return this._translate; }\n\tset translate(t) { this.transform(t[0], t[1]); }\n\tget scale() { return this._scale; }\n\tset scale(k) {\n\t\tswitch (k) {\n\t\t\tcase \"in\":\n\t\t\t\tk = this.scale * this.prop(\"zoomFactor\");\n\t\t\t\tbreak;\n\t\t\tcase \"out\":\n\t\t\t\tk = this.scale / this.prop(\"zoomFactor\");\n\t\t\t\tbreak;\n\t\t\tcase \"actual\":\n\t\t\t\tk = 1.0;\n\t\t\t\tbreak;\n\t\t\tcase \"fit\":\n\t\t\t\tvar gridSize = this.prop(\"gridSize\") * 2;\n\n\t\t\t\tvar gBounds = this.getBounds();\n\t\t\t\tvar vBounds = this.viewport();\n\n\t\t\t\tvBounds.width -= gridSize;\n\t\t\t\tvBounds.height -= gridSize;\n\n\t\t\t\t/* Do not zoom more than actual if graph already fits into the bounds */\n\t\t\t\tk = Math.min((vBounds.width / gBounds.width), (vBounds.height /gBounds.height), 1.0);\n\n\t\t\t\t//TODO: Add centering code here or trigger an event for that\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tif (_.isString(k)) k = parseFloat(k);\n\t\t\t\tbreak;\n\t\t}\n\t\tthis.transform(null, null, k);\n\t}\n\n\ttransform(x = null, y = null, scale = null) {\n\t\tlet graph = this.graph;\n\t\tlet root = graph ? graph.currentRoot : null;\n\t\tif (!_.isNull(x)) {\n\t\t\tthis._translate[0] = x;\n\t\t\tif (root)\n\t\t\t\troot.viewProp(this.id, 'x', x);\n\t\t}\n\t\tif (!_.isNull(y)) {\n\t\t\tthis._translate[1] = y;\n\t\t\tif (root)\n\t\t\t\troot.viewProp(this.id, 'y', y);\n\t\t}\n\t\tif (!_.isNull(scale)) {\n\t\t\tthis._scale = scale;\n\t\t\tif (root)\n\t\t\t\troot.viewProp(this.id, 'scale', scale);\n\t\t\t// sync the scale between the dispatcher and the graph\n\t\t\tlet s = this.dispatcher.scale;\n\t\t\tif (s != scale)\n\t\t\t\tthis.dispatcher.scale = scale;\n\t\t}\n\t\tthis.refresh();\n\t}\n\n\trender() {\n\t\tif (!this._graph) return false;\n\t\tif (this.layout)\n\t\t\tthis.layout.layout(this._graph.currentRoot, this.viewport());\n\n\t\tthis.initializeBehaviors();\n\t\treturn true;\n\t}\n\n\trenderLabel(box) {\n\t\treturn this.constructor.renderLabel(box);\n\t}\n\n\trenderLink(shape) {\n\t\treturn this.constructor.renderLink(shape);\n\t}\n\n\trenderMarkers(markers) {\n\t\treturn this.constructor.renderMarkers(markers);\n\t}\n\n\tinitializeBehaviors() {\n\t\t// create the event dispatcher if necessary.\n\t\tif (!this.dispatcher) {\n\t\t\tthis.dispatcher = new EventDispatcher(this.box, [this.prop('minZoom'), this.prop('maxZoom')]);\n\t\t\tlet jsClass;\n\t\t\tif (this.prop('graphBehavior')) {\n\t\t\t\tjsClass = Utils.getConstructor(this.prop('graphBehavior'));\n\t\t\t\tthis.graphBehavior = new jsClass(this);\n\t\t\t}\n\t\t\tif (this.prop('selectionBehavior')) {\n\t\t\t\tjsClass = Utils.getConstructor(this.prop('selectionBehavior'));\n\t\t\t\tthis.selectionBehavior = new jsClass(this);\n\t\t\t}\n\t\t\t/*this.dispatcher.register('mouseup.node.label', function(type, ns, target, pos, event) {\n\t\t\t\tlet node = this._graph.nodes[target.getAttribute('id')];\n\t\t\t\tif (!this.dispatcher.dragging && !node._firstSelection) {\n\t\t\t\t\tLabel._delayEdit = _.delay(() => {\n\t\t\t\t\t\tif (Label._delayEdit) {\n\t\t\t\t\t\t\tdelete Label._delayEdit;\n\t\t\t\t\t\t\tLabel.editor.start(node.id, this.box, node.getLabelBox(this.id), target, event.nsTarget, this.scale);\n\t\t\t\t\t\t}\n\t\t\t\t\t}, 250);\n\t\t\t\t}\n\t\t\t}, this);\n\t\t\tthis.dispatcher.register([/^mousedown/, /^zoom/], function(type, ns, target, pos, event) {\n\t\t\t\tif (!DomUtils.eventFromInput(event)) {\n\t\t\t\t\tLabel.editor.stop();\n\t\t\t\t}\n\t\t\t}, this);*/\n\t\t}\n\t\tthis.dispatcher.start();\n\t}\n\n\trefresh() {}\n\n\t/**\n\t * Get the template for the specified key.\n\t * @param key\n\t * @param config if the template is a function, this config will be passed as the argument.\n\t * @param preprocessor if the template contains preprossing elements, such as #{shape}, the preprocessor will be\n\t * used to render them.\n\t * @returns {*}\n\t */\n\tgetTemplate(key, config, preprocessor) {\n\t\tvar t = this.constructor.TEMPLATES[key];\n\t\tif (t && _.isFunction(t)) {\n\t\t\tt = t(config);\n\t\t}\n\t\t// check if there are any preprocessing tags.\n\t\tif (preprocessor) {\n\t\t\tvar parts = t.match(/(#{[^#]*})/g);\n\t\t\tvar obj = {};\n\t\t\tfor (let part in parts) {\n\t\t\t\tpart = parts[part];\n\t\t\t\tpart = part.substring(2, part.length -1).trim();\n\t\t\t\tobj[part] = preprocessor[_.camelCase('render ' + part)](this);\n\t\t\t}\n\t\t\tt = _.template(t, {interpolate: /#{([\\s\\S]+?)}/g})(obj);\n\t\t}\n\t\treturn t;\n\t}\n\n\treset() {}\n\n\tdestroy() {\n\t\tdelete this._graph;\n\t\tdelete this.layout;\n\t\tif (this.dispatcher) {\n\t\t\tthis.dispatcher.stop();\n\t\t\tdelete this.dispatcher;\n\t\t}\n\t\tthis.box.innerHTML = '';\n\t}\n}\nRenderer.DEFAULTS = {\n\tdefaultClickMode: \"pan\",\n\thideOutline: false,\n\tsingleSelect: true,\n\tdraggable: true,\n\tgridEnabled: false,\n\tguidesEnabled: true,\n\tgridSize: 30,\n\tmaxZoom: 4.0,\n\tminZoom: 0.2,\n\tzoomFactor: 1.2,\n\tmaskOpacity: 0.5,\n\tgraphBehavior: GraphBehavior,\n\tselectionBehavior: SelectionBehavior\n};\n\nexport default Renderer;\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/view/Renderer.js\n **/","/**\n * Created by tong on 6/28/2016.\n */\nimport Behavior from \"./Behavior\";\n\n/**\n * Graph handler handles Panning and Zoom and rubber band selection\n */\nclass GraphBehavior extends Behavior {\n\tconstructor(renderer) {\n\t\tsuper(renderer);\n\t\tlet dispatcher = renderer.dispatcher;\n\t\tlet f = function(type, ns, graph, pos, event) {\n\t\t\t//Cursor.updateCursor(type, ns, graph, event);\n\t\t};\n\t\tdispatcher.register(/^drag.*\\.graph$/, this.handleDrag, this);\n\t\tdispatcher.register(/^zoom/, this.handleZoom, this);\n\t\t//dispatcher.register(['mousedown.graph', 'mouseenter.graph', 'mouseleave.graph'], f);\n\t\tthis.offset = null;\n\t}\n\n\thandleZoom(type, ns, graph, pos, event) {\n\t\tthis.renderer.transform(null, null, event.scale);\n\t}\n\n\thandleDrag(type, ns, graph, pos, event) {\n\t\tif (type == 'dragstart') {\n\t\t\tlet pan = (this.renderer.prop(\"defaultClickMode\") == \"pan\") ^ (event.ctrlKey || event.shiftKey);\n\t\t\tif (!pan) return;\n\t\t\tlet t = this.renderer.translate;\n\t\t\tthis.offset = [t[0] - pos[0], t[1] - pos[1]];\n\t\t\treturn;\n\t\t}\n\t\tif (!this.offset) return;\n\t\tthis.renderer.transform(pos[0] + this.offset[0], pos[1] + this.offset[1]);\n\t\tif (type == 'dragend') {\n\t\t\t//Cursor.updateCursor('mouseup', ns, graph, event);\n\t\t\tdelete this.offset;\n\t\t}\n\t}\n}\n\nexport default GraphBehavior;\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/behavior/GraphBehavior.js\n **/","export default class Behavior {\n\tconstructor(renderer) {\n\t\tthis.renderer = renderer;\n\t}\n\n\tdestroy() {\n\t\tdelete this.renderer;\n\t}\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/behavior/Behavior.js\n **/","import Rectangle from \"../geometry/Rectangle\";\nimport Cell from \"../graph/Cell\";\nimport Behavior from \"./Behavior\";\n\nclass SelectionBehavior extends Behavior {\n\tconstructor(renderer) {\n\t\tsuper(renderer);\n\t\tlet dispatcher = renderer.dispatcher;\n\t\tdispatcher.register('mousedown.*', this.selectCell, this);\n\t\tdispatcher.register('mouseup.*', this.unselectCell, this);\n\t\tdispatcher.register('drag*.graph', this.handleMultiSelect, this);\n\t\t//graph.on(Graph.EVENT_TYPES.SELECTION_CHANGE, this.updateSelections, this);\n\t\tthis.selectedNodes = null;\n\t\tthis.selectedLinks = null;\n\t\tthis.attachedLinks = null;\n\t}\n\n\tupdateSelections() {\n\t\tif (this.selectedNodes)\n\t\t\tthis.selectedNodes.classed('selected', false);\n\t\tif (this.selectedLinks)\n\t\t\tthis.selectedLinks.classed('selected', false);\n\n\t\tthis.selectedNodes = null;\n\t\tthis.selectedLinks = null;\n\t\tthis.attachedLinks = null;\n\n\t\tif (this.graph.selectedVertices && this.graph.selectedVertices.length > 0) {\n\t\t\tthis.selectedNodes = this.graph.renderer.getShapes(this.graph.selectedVertices);\n\t\t\tthis.attachedLinks = this.graph.renderer.getShapes(this.graph.getAttachedEdges());\n\t\t\tthis.selectedNodes.classed('selected', true);\n\t\t}\n\n\t\tif (this.graph.selectedEdges && this.graph.selectedEdges.length > 0) {\n\t\t\tthis.selectedLinks = this.graph.renderer.getShapes(this.graph.selectedEdges);\n\t\t\tthis.selectedLinks.classed('selected', true);\n\t\t}\n\t}\n\n\tselectCell(type, ns, data, pos, event) {\n\t\tvar cell = data == this.graph ? null : data;\n\t\tif (cell && !(cell instanceof Cell)) return;\n\t\tvar toggle = event.ctrlKey || event.shiftKey;\n\t\tif (cell && (cell instanceof Cell)) {\n\t\t\tif (!this.graph.isSelected(cell))\n\t\t\t\tdelete cell._firstSelection;\n\t\t\telse\n\t\t\t\tcell._firstSelection = true;\n\n\t\t\td3.select(event.dataTarget).moveToFront();\n\t\t\tthis.graph.setSelection(cell, toggle);\n\t\t}\n\t}\n\n\tunselectCell(type, ns, data, pos, event) {\n\t\tvar cell = data == this.graph ? null : data;\n\t\tif (cell && !(cell instanceof Cell)) return;\n\t\tvar ctrlKey = event.ctrlKey || event.shiftKey;\n\t\tif (!cell) {\n\t\t\tthis.graph.setSelection(cell, ctrlKey);\n\t\t}\n\t}\n\n\thandleMultiSelect(type, ns, data, pos, event) {\n\t\tpos = util.scale(this.graph, pos);\n\n\t\tif (type == 'dragstart') {\n\t\t\tvar select = (this.graph.getProperty(\"defaultClickMode\") == \"select\") ^ (event.ctrlKey || event.shiftKey);\n\t\t\tif (!select) return;\n\t\t\tthis.startPt = new Point(pos[0], pos[1]);\n\t\t\treturn;\n\t\t}\n\t\tif (!this.startPt) return;\n\t\tvar rect = Rectangle.getBoundingRectangle([new Point(pos[0], pos[1]), this.startPt]);\n\t\tvar renderer = this.graph.renderer;\n\t\tif (!this.rubberband) {\n\t\t\tthis.rubberband = d3.select(renderer.appendNode(renderer.getCellLayer(), {\n\t\t\t\ttemplate: _.template('<g><rect x=\"0\" y=\"0\" width=\"100\" height=\"100\" stroke=\"#000000\" fill=\"none\" stroke-dasharray=\"3 3\"/></g>')\n\t\t\t}, false));\n\t\t}\n\t\tif (type == 'dragend') {\n\t\t\tvar cells = this.graph.getCurrentRoot().children;\n\t\t\t// TODO: Define if we want to select vertexes / edges or both\n\t\t\tcells = _.filter(cells, function (cell) {\n\t\t\t\tvar box = cell.getBounds();\n\t\t\t\tif (rect.contains(box)) {\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t\treturn false;\n\t\t\t});\n\t\t\t// TODO: Set selection\n\t\t\tthis.graph.setSelection(cells, event.ctrlKey);\n\n\t\t\tthis.rubberband.remove();\n\t\t\tdelete this.startPt;\n\t\t\tdelete this.rubberband;\n\t\t\treturn;\n\t\t}\n\t\tthis.rubberband.select(\"rect\").attr({x: rect.x, y: rect.y, width: rect.width, height: rect.height});\n\t}\n\n\tdestroy() {\n\t\tsuper.destroy();\n\t\tdelete this.selectedNodes;\n\t\tdelete this.selectedLinks;\n\t\tdelete this.attachedLinks;\n\t}\n}\n\nexport default SelectionBehavior;\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/behavior/SelectionBehavior.js\n **/","import _ from \"lodash\";\nimport Base64 from \"../util/base64\";\nimport DomUtils from \"../util/DomUtils\";\nimport Renderer from \"./Renderer\";\nimport StringBuffer from \"../util/StringBuffer\";\n\nconst NS = 'http://www.w3.org/2000/svg';\nif (typeof (SVGElement) != \"undefined\") {\n\tvar svg = document.createElementNS(NS, \"svg\");\n\tsvg.innerHTML = '<circle/>';\n\tif (svg.firstChild !== \"[object SVGCircleElement]\") {\n\t\tObject.defineProperties(SVGElement.prototype, {\n\t\t\t\"outerHTML\": {\n\t\t\t\tenumerable: false,\n\t\t\t\tconfigurable: true,\n\t\t\t\tget: function() {\n\t\t\t\t\tvar $node, $temp;\n\t\t\t\t\t$temp = document.createElement('div');\n\t\t\t\t\t$node = this.cloneNode(true);\n\t\t\t\t\t$temp.appendChild($node);\n\t\t\t\t\treturn $temp.innerHTML;\n\t\t\t\t}\n\t\t\t},\n\t\t\t\"innerHTML\": {\n\t\t\t\tenumerable: false,\n\t\t\t\tconfigurable: true,\n\t\t\t\tget: function() {\n\t\t\t\t\tvar s = this.outerHTML;\n\t\t\t\t\tvar ropen = new RegExp(\"<\" + this.nodeName + '\\\\b(?:([\"\\'])[^\"]*?(\\\\1)|[^>])*>', \"i\");\n\t\t\t\t\tvar rclose = new RegExp(\"<\\/\" + this.nodeName + \">$\", \"i\");\n\t\t\t\t\treturn  s.replace(ropen, \"\").replace(rclose, \"\");\n\t\t\t\t},\n\t\t\t\tset: function(markup) {\n\t\t\t\t\t// empty el first.\n\t\t\t\t\tlet child;\n\t\t\t\t\twhile (child = this.lastChild)\n\t\t\t\t\t\tthis.removeChild(child);\n\t\t\t\t\tlet buf = new StringBuffer();\n\t\t\t\t\tbuf.append('<svg>').append(markup).append('</svg');\n\t\t\t\t\tlet $temp = DomUtils.createElement('div', null, null, buf.toString()).firstElementChild;\n\t\t\t\t\twhile ($temp.firstChild)\n\t\t\t\t\t\tthis.appendChild($temp.firstChild);\n\t\t\t\t}\n\t\t\t}\n\t\t})\n\t}\n\t// Define the toDataURL for SVG\n\tSVGElement.prototype.toDataURL = function(type, options = {}) {\n\t\tlet _svg = this;\n\n\t\tlet debug = function(msg) {};\n\n\t\tif (options['debug'] == true && typeof(console) != 'undefined')\n\t\t\tdebug = function(msg) { console.log(\"SVG.toDataURL:\", msg); };\n\n\t\tfunction exportSVG() {\n\t\t\tvar svg_xml = _svg.outerHTML;\n\t\t\tvar svg_dataurl = base64dataURLencode(svg_xml);\n\t\t\tdebug(type + \" length: \" + svg_dataurl.length);\n\n\t\t\t// NOTE double data carrier\n\t\t\tif (options.callback) options.callback(svg_dataurl);\n\t\t\treturn svg_dataurl;\n\t\t}\n\n\t\tfunction base64dataURLencode(s) {\n\t\t\tvar b64 = \"data:image/svg+xml;base64,\";\n\n\t\t\t// https://developer.mozilla.org/en/DOM/window.btoa\n\t\t\tif (window.btoa) {\n\t\t\t\tdebug(\"using window.btoa for base64 encoding\");\n\t\t\t\tb64 += btoa(s);\n\t\t\t} else {\n\t\t\t\tdebug(\"using custom base64 encoder\");\n\t\t\t\tb64 += Base64.encode(s);\n\t\t\t}\n\n\t\t\treturn b64;\n\t\t}\n\n\t\t// Native export doesn't work very well. should use canvg instead.\n\t\tfunction exportImage(type) {\n\t\t\tvar canvas = document.createElement(\"canvas\");\n\t\t\tvar ctx = canvas.getContext('2d');\n\n\t\t\t// TODO: if (options.keepOutsideViewport), do some translation magic?\n\n\t\t\tvar svg_img = new Image();\n\t\t\tvar svg_xml = _svg.outerHTML;\n\t\t\tsvg_img.src = base64dataURLencode(svg_xml);\n\n\t\t\tsvg_img.onload = function() {\n\t\t\t\tdebug(\"exported image size: \" + [svg_img.width, svg_img.height]);\n\t\t\t\tcanvas.width = svg_img.width;\n\t\t\t\tcanvas.height = svg_img.height;\n\t\t\t\tctx.drawImage(svg_img, 0, 0);\n\n\t\t\t\t// SECURITY_ERR WILL HAPPEN NOW\n\t\t\t\tvar image_dataurl = canvas.toDataURL(type);\n\t\t\t\tdebug(type + \" length: \" + image_dataurl.length);\n\n\t\t\t\tif (options.callback) options.callback( image_dataurl );\n\t\t\t\telse debug(\"WARNING: no callback set, so nothing happens.\");\n\t\t\t};\n\n\t\t\tsvg_img.onerror = function() {\n\t\t\t\tdebug(\n\t\t\t\t\t\"Can't export! Maybe your browser doesn't support \" +\n\t\t\t\t\t\"SVG in img element or SVG input for Canvas drawImage?\\n\" +\n\t\t\t\t\t\"http://en.wikipedia.org/wiki/SVG#Native_support\"\n\t\t\t\t);\n\t\t\t};\n\n\t\t\t// NOTE: will not return anything\n\t\t}\n\n\t\tfunction exportImageCanvg(type) {\n\t\t\tif (!canvg) return null;\n\t\t\tlet canvas = DomUtils.createElement('canvas', null, {display: \"none\"});\n\t\t\tdocument.body.appendChild(canvas);\n\t\t\tif (type == 'javascript') {\n\t\t\t\tvar xcanvas = new jsCanvas ('jscanvastest');\n\t\t\t\txcanvas.canvas.style.display = 'none';\n\t\t\t\t//xcanvas.canvas = canvas;\n\t\t\t}\n\n\t\t\tif (!options.keepOutsideViewport) {\n\t\t\t\tcanvg(canvas, _svg.outerHTML);\n\t\t\t} else {\n\t\t\t\tlet padding = options.padding || 0;\n\t\t\t\tlet scale = 1.0;\n\t\t\t\tlet translate = [0, 0];\n\t\t\t\tlet bbox = _svg.getBBox();\n\t\t\t\tdebug(\"detected svg dimensions \" + [bbox.x, bbox.y, bbox.width, bbox.height]);\n\t\t\t\tlet transform = _svg.firstElementChild.getAttribute('transform');\n\t\t\t\tif (transform) {\n\t\t\t\t\tdebug('detected svg transform ' + transform);\n\t\t\t\t\ttransform = SVGRenderer.transform(transform);\n\t\t\t\t\ttranslate = transform.translate;\n\t\t\t\t\tscale = transform.scale;\n\t\t\t\t}\n\t\t\t\tlet buf = new StringBuffer();\n\t\t\t\tbuf.append('<svg width=\"').append(bbox.width + 2*padding).append('px\" height=\"').append(bbox.height + 2*padding).append('px\"><g transform=\"translate(')\n\t\t\t\t\t.append(-bbox.x+translate[0]+padding).append(',').append(-bbox.y+translate[1]+padding).append(')scale(').append(scale).append(')\">')\n\t\t\t\t\t.append(_svg.firstElementChild.innerHTML).append('</g></svg>');\n\t\t\t\tif (type == 'javascript') {\n\t\t\t\t\txcanvas.compile(buf.toString(), function () {\n\t\t\t\t\t\tif (options.callback) options.callback(xcanvas.toString());\n\t\t\t\t\t});\n\t\t\t\t\treturn;\n\t\t\t\t} else\n\t\t\t\t\tcanvg(canvas, buf.toString());\n\t\t\t}\n\t\t\tvar image_dataurl = canvas.toDataURL(type);\n\t\t\tif (options.callback) options.callback( image_dataurl );\n\t\t\tcanvas.parentNode.removeChild(canvas);\n\t\t\treturn image_dataurl;\n\t\t}\n\n\t\tif (!type) type = \"image/svg+xml\";\n\n\t\tif (options.keepNonSafe) debug(\"NOTE: keepNonSafe is NOT supported and will be ignored!\");\n\t\tif (options.keepOutsideViewport) debug(\"NOTE: keepOutsideViewport is only supported with canvg exporter.\");\n\n\t\tswitch (type) {\n\t\t\tcase \"image/svg+xml\":\n\t\t\t\treturn exportSVG();\n\t\t\tcase \"image/png\":\n\t\t\tcase \"image/jpeg\":\n\t\t\tcase \"javascript\":\n\t\t\t\tif (!options.renderer) {\n\t\t\t\t\tif (window.canvg) options.renderer = \"canvg\";\n\t\t\t\t\telse options.renderer=\"native\";\n\t\t\t\t}\n\t\t\t\tswitch (options.renderer) {\n\t\t\t\t\tcase \"canvg\":\n\t\t\t\t\t\tdebug(\"using canvg renderer for \" + type + \" image export\");\n\t\t\t\t\t\treturn exportImageCanvg(type);\n\t\t\t\t\tcase \"native\":\n\t\t\t\t\t\tdebug(\"using native renderer for \" + type + \" export. THIS MIGHT FAIL.\");\n\t\t\t\t\t\treturn exportImage(type);\n\t\t\t\t\tdefault:\n\t\t\t\t\t\tdebug(\"unknown image renderer given, doing noting (\" + options.renderer + \")\");\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tdebug(\"Sorry! Exporting as '\" + type + \"' is not supported!\");\n\t\t}\n\t\treturn null;\n\t}\n}\n\nclass SVGRenderer extends Renderer {\n\trender() {\n\t\tlet result = super.render();\n\t\tif (result) {\n\t\t\tlet root = this.graph.currentRoot;\n\t\t\tlet buf = new StringBuffer('<svg width=\"100%\" height=\"100%\" xmlns=\"http://www.w3.org/2000/svg\">');\n\t\t\tlet t = this.translate;\n\t\t\tbuf.append('<g transform=\"translate(').append(t[0]).append(',').append(t[1]).append(')scale(').append(this.scale).append(')\">');\n\t\t\tbuf.append(this.renderDefs());\n\t\t\tbuf.append(root.render(this));\n\t\t\tbuf.append('</g></svg>');\n\t\t\tthis.box.innerHTML = buf.toString();\n\t\t\tthis.svg = this.box.firstElementChild;\n\t\t}\n\t}\n\n\trenderDefs() {\n\t\tlet buf = new StringBuffer('<defs>');\n\t\tbuf.append(this.getTemplate('Grid', this.prop(\"gridSize\")));\n\t\tlet markers = this.graph.markers;\n\t\tif (markers.length > 0)\n\t\t\tbuf.append(SVGRenderer.renderMarkers(markers));\n\t\tbuf.append('</defs>');\n\t\treturn buf.toString();\n\t}\n\n\trefresh() {\n\t\tif (!this.svg) return;\n\t\tlet g = this.svg.querySelector('g');\n\t\tlet t = this.translate;\n\t\tg.setAttribute('transform', 'translate(' + t[0] + ',' + t[1] + ')scale(' + this.scale + ')');\n\t}\n\n\tstatic renderMarkers(markers) {\n\t\tlet buf = new StringBuffer(), str1, str2;\n\t\tmarkers.forEach(function(marker) {\n\t\t\tstr1 = this.TEMPLATES['Marker'](marker);\n\t\t\tstr2 = marker.shape;\n\t\t\tif (!_.isString(str2))\n\t\t\t\tstr2 = this.renderShape(str2);\n\t\t\tstr1 = str1.replace(/\\#\\{shape\\}/, str2);\n\t\t\tbuf.append(str1);\n\t\t}, this);\n\t\treturn buf.toString();\n\t}\n\n\tstatic renderLabel(box) {\n\t\treturn this.TEMPLATES['Label'](box);\n\t}\n\n\tstatic renderShape(shape) {\n\t\tlet template = this.TEMPLATES[shape.name];\n\t\tif (_.isString(template))\n\t\t\ttemplate = _.template(template);\n\t\treturn template(shape);\n\t}\n\n\tstatic getPathData(shape) {\n\t\tlet points = shape.points;\n\t\tlet controlPts = shape.controlPts;\n\t\tif (!points || points.length == 0) return '';\n\n\t\tif (!controlPts && shape.round) {\n\t\t\t// render rounded line joins.\n\t\t\tlet newPts = [];\n\t\t\tcontrolPts = [];\n\t\t\tlet prev = points[0], next, d1, d2, corner;\n\t\t\tnewPts.push(prev);\n\t\t\tfor (let i = 1; i < points.length - 1; i++) {\n\t\t\t\tnext = points[i];\n\t\t\t\t// set the control point first.\n\t\t\t\tcontrolPts[2*i] = [next, next];\n\t\t\t\t// check the size of the corner.\n\t\t\t\td1 = prev.distance(next);\n\t\t\t\td2 = next.distance(points[i+1]);\n\t\t\t\tcorner = Math.min(shape.round, d1/2, d2/2);\n\t\t\t\t// split the point into two.\n\t\t\t\tnewPts.push(next.getDirection(prev).scale(corner).translate(next));\n\t\t\t\tnewPts.push(next.getDirection(points[i+1]).scale(corner).translate(next));\n\t\t\t\tprev = next;\n\t\t\t}\n\t\t\tnewPts.push(points[points.length - 1]);\n\t\t\tpoints = newPts;\n\t\t}\n\t\tlet buf = new StringBuffer('M'), point;\n\t\tfor (let i = 0; i < points.length; i++) {\n\t\t\tpoint = points[i];\n\t\t\tif (i == 0)\n\t\t\t\tbuf.append(point);\n\t\t\telse {\n\t\t\t\tif (controlPts && controlPts[i]) {\n\t\t\t\t\tbuf.append(' C ');\n\t\t\t\t\tfor (let j = 0; j < controlPts[i].length; j++)\n\t\t\t\t\t\tbuf.append(controlPts[i][j]).append(' ');\n\t\t\t\t\tbuf.append(point);\n\t\t\t\t} else\n\t\t\t\t\tbuf.append(' L ').append(point);\n\t\t\t}\n\t\t}\n\t\treturn buf.toString();\n\t}\n\n\tstatic renderLink(shape) {\n\t\tlet buf = new StringBuffer();\n\t\tlet d = SVGRenderer.getPathData(shape);\n\t\tif (shape.showGauge)\n\t\t\tbuf.append('<path style=\"stroke: white; stroke-width: 9; visibility: hidden; pointer-events: stroke;\" d=\"')\n\t\t\t\t.append(d).append('\"/>');\n\t\tbuf.append('<path d=\"').append(d).append('\"');\n\t\tif (shape.startMarker || shape.endMarker) {\n\t\t\tbuf.append(' style=\"');\n\t\t\tif (shape.startMarker)\n\t\t\t\tbuf.append('marker-start: url(#').append(_.isString(shape.startMarker) ? shape.startMarker : shape.startMarker.id).append(');');\n\t\t\tif (shape.endMarker)\n\t\t\t\tbuf.append('marker-end: url(#').append(_.isString(shape.endMarker) ? shape.endMarker : shape.endMarker.id).append(');');\n\t\t\tbuf.append('\"');\n\t\t}\n\t\tbuf.append('/>');\n\t\treturn buf.toString();\n\t}\n\n\tstatic appendContent(el, content) {\n\t\tlet buf = new StringBuffer();\n\t\tbuf.append('<svg>').append(content).append('</svg');\n\t\tlet temp = DomUtils.createElement('div', null, null, buf.toString()).firstElementChild;\n\n\t\twhile (temp.firstChild)\n\t\t\tel.appendChild(temp.firstChild);\n\t\treturn el;\n\t}\n\n\tstatic transform(transform) {\n\t\tlet translate = [0, 0], scale = 1.0;\n\t\t//\n\t\tlet parts = transform.match(/translate\\(\\s*([^)]+)/);\n\t\tif (parts) {\n\t\t\tlet m = parts[1].trim().match(/([\\d.-]+)[ ,]([\\d.-]+)/);\n\t\t\tif (m) {\n\t\t\t\ttranslate[0] = parseFloat(m[1]) || 0;\n\t\t\t\ttranslate[1] = parseFloat(m[2]) || 0;\n\t\t\t} else\n\t\t\t\ttranslate[0] = translate[1] = parseFloat(parts[1]);\n\t\t}\n\t\tparts = transform.match(/scale\\(\\s*([^)]+)/);\n\t\tif (parts)\n\t\t\tscale = parseFloat(parts[1]) || 1.0;\n\n\t\treturn {translate, scale};\n\t}\n}\nSVGRenderer.TEMPLATES = {\n\t$root: '<g id=\"${id}\" class=\"${className}\">#{children}</g>',\n\t$node: '<g id=\"${id}\" class=\"${className}\" style=\"${style}\" ns=\"${namespace}\" transform=\"translate(${x},${y})\">#{shape}#{label}</g>',\n\t$edge: '<g id=\"${id}\" class=\"${className}\" style=\"${style}\" ns=\"${namespace}\">#{shape}#{label}</g>',\n\tEllipse: '<ellipse cx=\"0\" cy=\"0\" rx=\"${width/2}\" ry=\"${height/2}\"/>',\n\tRectangle: '<rect x=\"${-width/2}\" y=\"${-height/2}\" width=\"${width}\" height=\"${height}\" rx=\"9\" ry=\"9\"/>',\n\tTriangle: '<polygon points=\"${-width/2},${-height/2} ${width/2},${-height/2} 0,${height/2}\"/>',\n\tRhombus: '<polygon points=\"0,${-height/2} ${width/2},0 0,${height/2} ${-width/2},0\"/>',\n\tHexagon: function(config) {\n\t\tvar vertical = config.direction == 'north' || config.direction == 'south';\n\t\tif (vertical)\n\t\t\treturn '<polygon points=\"0,${-height/2} ${width/2},${-height/4} ${width/2},${height/4} 0,${height/2} ${-width/2},${height/4} ${-width/2},${-height/4}\"/>';\n\t\telse\n\t\t\treturn '<polygon points=\"${-width/2},0 ${width/4},${-height/2} ${width/4},${-height/2} ${width/2},0 ${width/4},${height/2} ${-width/4},${height/2}\"/>';\n\t},\n\tPolygon: function(shape) {\n\t\tlet buf = new StringBuffer('<polygon points=\"');\n\t\tshape.points.forEach(function(pt){\n\t\t\tbuf.append(pt[0]).append(',').append(pt[1]).append(' ');\n\t\t});\n\t\tbuf.removeLast();\n\t\tbuf.append('\"/>');\n\t\treturn buf.toString();\n\t},\n\tImage: function(config) {\n\t\treturn '<image x=\"${-width/2}\" y=\"${-height/2}\" width=\"${width}\" height=\"${height}\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" xlink:href=\"' + config.image + '\"/>';\n\t},\n\tMarker: function(marker) {\n\t\treturn `\n<marker id=\"${marker.id}\" markerWidth=\"${marker.size}\" markerHeight=\"${marker.size}\" refx=\"${marker.ref[0]}\" \nrefy=\"${marker.ref[1]}\" orient=\"auto\" viewbox=\"${marker.viewBox.x} ${marker.viewBox.y} ${marker.viewBox.width} ${marker.viewBox.height}\"\nmarkerUnits=\"userSpaceOnUse\" ${marker.fill ? `style=\"stroke: ${marker.fill};fill:${marker.fill}\"` : ''}>#{shape}</marker>\n`.trim();\n\t},\n\tGrid: function(size) {\n\t\treturn `\n<pattern id=\"GridPattern\" width=\"${size}\" height=\"${size}\" patternUnits=\"userSpaceOnUse\">\n\t<ellipse cx=\"0\" cy=\"0\" rx=\"1\" ry=\"1\" fill=\"#999999\"/>\n\t<ellipse cx=\"0\" cy=\"${size}\" rx=\"1\" ry=\"1\" fill=\"#999999\"/>\n\t<ellipse cx=\"${size}\" cy=\"0\" rx=\"1\" ry=\"1\" fill=\"#999999\"/>\n\t<ellipse cx=\"${size}\" cy=\"${size}\" rx=\"1\" ry=\"1\" fill=\"#999999\"/>\n</pattern>`.trim();\n\t},\n\tLabel: _.template(`\n<% var box = _.has(data, \"dx\") ? data : (data.getLabelBox ? data.getLabelBox() : null); \n   if (box) {%>\n\t<g <% if (box.config && box.config.class) {%>class=\"<%=box.config.class%>\"<%}%>\\\n\t\t<% if (box.config && box.config.ns) {%>ns=\"<%=box.config.ns%>\"<%}%>\\\n\t\t<% if (box.config && box.config.inlineStyle) {%>\\\n\t\t\tfont-size=\"<%=box.config.fontSize%>\"\\\n\t\t\tfont-family=\"<%=box.config.fontFamily%>\"\\\n\t\t\tfont-weight=\"<% if (box.bold) {%>bold<%} else {%>normal<%}%>\"\\\n\t\t\t<% if (box.underline) {%>text-decoration=\"underline\"<%}%>\\\n\t\t\t<% if (box.italic) {%>font-style=\"italic\"<%}%>\\\n\t\t<%}%>\\\n\t\ttext-anchor=\"<%=box.anchor%>\"\\\n\t\ttransform=\"translate(<%=box.bounds.x%>,<%=box.bounds.y%>)<% if (box.config && box.config.rotation) {%>rotate(<%=box.config.rotation%> <%=box.pivot[0]%> <%=box.pivot[1]%>)<%}%>\">\n\t<% if (box.config.backgroundStyle) {%>\n\t\t<rect x=\"<%=-box.bounds.width/2%>\" y=\"<%=-box.bounds.height/2%>\" width=\"<%=box.bounds.width%>\" height=\"<%=box.bounds.height%>\" style=\"<%=box.config.backgroundStyle%>\"/>\n\t<% } if (_.isArray(box.label)) { \n\t\t_.each(box.label, function(value, line) {%>\n\t\t\t<text <% if (box.config && box.config.textStyle) {%>style=\"<%=box.config.textStyle%>\"<%}%>\\\n\t\t\t\tdx=\"<%=box.dx%>\" dy=\"<%=box.dy + box.lineHeight * line%>\"><%=value%></text>\n\t\t<%});} else { %>\n\t\t\t<text><%=box.label%></text>\n\t\t<%}%>\n\t</g>\n<%}%>\n`.trim(), {variable: \"data\"})   //TODO add more inline text styles.\n};\n\nexport default SVGRenderer;\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/view/SVGRenderer.js\n **/"],"sourceRoot":"/source/"}