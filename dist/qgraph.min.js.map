{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","qgraph.js","webpack:/webpack/bootstrap 85ede51e30946b20c0c8","webpack:///src/index.js","webpack:///src/util/base64.js","webpack:///src/util/Utils.js","webpack:///src/geometry/Point.js","webpack:///src/geometry/Rectangle.js","webpack:/external {\"root\":\"_\",\"commonjs\":\"lodash\",\"commonjs2\":\"lodash\",\"amd\":\"lodash\"}","webpack:///src/geometry/Shape.js","webpack:///src/util/DomUtils.js","webpack:///src/util/StringBuffer.js","webpack:///src/geometry/Line.js","webpack:///src/geometry/Ellipse.js","webpack:///src/geometry/Rhombus.js","webpack:///src/geometry/Link.js","webpack:///~/bean/bean.js","webpack:///src/event/EventDispatcher.js","webpack:///src/event/KeyUtils.js","webpack:///src/graph/Graph.js","webpack:///src/graph/Node.js","webpack:///src/graph/Cell.js","webpack:///src/util/Cache.js","webpack:///src/view/Label.js","webpack:///src/graph/Edge.js","webpack:///src/view/Marker.js","webpack:///src/layout/Layout.js","webpack:///src/layout/FlowLayout.js","webpack:///src/view/Renderer.js","webpack:///src/behavior/GraphBehavior.js","webpack:///src/behavior/Behavior.js","webpack:///src/behavior/SelectionBehavior.js","webpack:///src/view/SVGRenderer.js"],"names":["root","factory","exports","module","require","define","amd","this","__WEBPACK_EXTERNAL_MODULE_5__","modules","__webpack_require__","moduleId","installedModules","id","loaded","call","m","c","p","_interopRequireDefault","obj","__esModule","default","Object","defineProperty","value","_base","_base2","_Utils","_Utils2","_DomUtils","_DomUtils2","_StringBuffer","_StringBuffer2","_Point","_Point2","_Line","_Line2","_Shape","_Shape2","_Rectangle","_Rectangle2","_Ellipse","_Ellipse2","_Rhombus","_Rhombus2","_Link","_Link2","_bean","_bean2","_EventDispatcher","_EventDispatcher2","_Graph","_Graph2","_Cell","_Cell2","_Node","_Node2","_Edge","_Edge2","_Layout","_Layout2","_FlowLayout","_FlowLayout2","_Label","_Label2","_Marker","_Marker2","_Renderer","_Renderer2","_SVGRenderer","_SVGRenderer2","_GraphBehavior","_GraphBehavior2","_SelectionBehavior","_SelectionBehavior2","addShape","Events","Base64","Cache","Utils","DomUtils","StringBuffer","Point","Line","Shape","Rectangle","Ellipse","Link","EventDispatcher","Label","Marker","Graph","Cell","Node","Edge","Layout","FlowLayout","Renderer","SVGRenderer","GraphBehavior","SelectionBehavior","_keyStr","encode","input","chr1","chr2","chr3","enc1","enc2","enc3","enc4","output","i","_utf8_encode","length","charCodeAt","isNaN","charAt","decode","replace","indexOf","String","fromCharCode","_utf8_decode","string","utftext","n","c1","c2","c3","global","_classCallCheck","instance","Constructor","TypeError","_possibleConstructorReturn","self","ReferenceError","_inherits","subClass","superClass","prototype","create","constructor","enumerable","writable","configurable","setPrototypeOf","__proto__","window","addEventHandler","document","navigator","_debugging","_debugAll","typeRegistry","splice","Array","type","namespace","name","Map","set","get","createType","props","defaultType","extend","getPrototypeOf","apply","arguments","_extend","config","_","assign","typeName","log","buildTypes","types","_this2","remove","defaultsDeep","forEach","child","parent","protoProps","staticProps","Surrogate","superclass","initConfig","cArr","DEFAULTS","prop","getConstructor","jsClass","defaultClass","isString","eval","debug","moduleName","push","message","console","substring","info","getRelativePosition","bounds","geometry","x","Math","abs","width","y","height","offsetPosition","pos","anchorX","offsetX","anchorY","offsetY","unscale","t","scale","o","getProperty","has","isFunction","_createClass","defineProperties","target","descriptor","key","aPt","sqrt","p2","dist","distance","angle","cos","PI","sin","clone","rotate","rect","vertical","W","N","S","E","NE","NW","SE","SW","_lodash","_lodash2","_Shape3","el","w","h","left","right","top","bottom","pt","contains","pt1","pt2","horizontal","contains1","contains2","outPt","orthogonal","undefined","dx","dy","alpha","atan2","pi","pi2","beta","tan","dir","getDirection","point","direction","pts","margin","isArray","min","max","rects","minx","miny","maxx","Infinity","maxy","each","r","registry","defaults","refPt","getPerimeter","view","template","getTemplate","isIE","sAgent","userAgent","Idx","parseInt","match","isFireFox","InstallTrigger","isChrome","raw","isMac","platform","toUpperCase","isWindows","appVersion","isLinux","createElement","tag","attribs","styles","html","setElement","innerHTML","createElementByString","str","temp","childNodes","setAttribute","style","testElement","node","method","nodeType","getAncestorBy","parentNode","getPosition","context","body","elRect","getBoundingClientRect","contextRect","getCenterPosition","move","getSize","offsetWidth","offsetHeight","resize","preloadImages","array","list","img","that","Image","onload","index","src","getImageInfo","downloadFile","data","mime","split","encoded","atob","decodeURI","GetBlob","msSaveBlob","link","href","download","display","appendChild","click","removeChild","contentType","sliceSize","byteArrays","offset","slice","byteNumbers","byteArray","Uint8Array","Blob","openImage","image","myWindow","open","myDocument","eventFromInput","e","tagName","buffer","stuff","concat","pop","sep","join","start","end","l","cosa","dotProduct","x0","y0","x1","y1","x2","y2","x3","y3","denom","nume_a","nume_b","ua","ub","intersectionX","intersectionY","a","b","cx","cy","px","py","d","f","g","det","xout1","xout2","yout1","yout2","dist1","pow","dist2","xout","yout","Rhombus","tx","ty","intersection","defaultConfig","showGauge","defaultGeometry","linkTypes","terminalVisual","shapeConfig","startMarker","endMarker","startNormal","endNormal","renderLink","isNumber","points","translate","getScaled","linkClass","DirectLink","BezierLink","ctrlpts","controlPts","p1","p3","p4","s","EntityRelations","_Link3","source","Port","getBounds","edge","isSourceLeft","isTargetLeft","result","getCenterY","xe","ye","seg","segment","dep","arr","midY","Manhattan","_Link4","MIN_BUFFER","autoRoute","randomNoise","step","maxChannelWidth","container","boxes","startBox","endBox","side","side2","box","intersect","j","channel","channel2","startPadding","endPadding","_getChannel","_getFirstIntersection","_getRouteTendency","_hasIntersection","_moveSegment","breakPt","_getRouteDirection","getCenter","box1","box2","getLeft","getRight","getBottom","getTop","getTranslated","route","_mergeSegments","getCommonAncestor","getDescendants","excludeFromRouting","isAncestor","range","randomNumber","floor","random","startBuffer","endBuffer","startBufferNormal","endBufferNormal","middle","prunePts","detectIntersection","savedIndex","savedSide","h1","h2","equals","__WEBPACK_AMD_DEFINE_FACTORY__","__WEBPACK_AMD_DEFINE_RESULT__","definition","selectorEngine","win","old","namespaceRegex","nameRegex","addEvent","removeEvent","doc","documentElement","W3C_MODEL","eventSupport","ONE","str2arr","standardNativeEvents","w3cNativeEvents","nativeEvents","hash","events","customEvents","element","compareDocumentPosition","check","event","related","relatedTarget","prefix","test","toString","mouseenter","base","condition","mouseleave","mousewheel","Event","commonProps","mouseProps","mouseWheelProps","keyProps","textProps","touchProps","messageProps","stateProps","overOutRegex","typeFixers","reg","fix","newEvent","keyCode","which","rightClick","button","pageX","pageY","clientX","clientY","scrollLeft","scrollTop","typeFixerMap","isNative","ownerDocument","parentWindow","originalEvent","isBean","fixer","srcElement","preventDefault","returnValue","stopPropagation","cancelBubble","stop","stopped","stopImmediatePropagation","isImmediatePropagationStopped","currentTarget","ne","targetElement","RegEntry","wrappedHandler","fn","args","eargs","findTarget","eventElement","__beanDel","ft","handler","original","namespaces","customType","once","removeListener","eventType","inNamespaces","checkNamespaces","matches","checkElement","checkOriginal","checkHandler","map","forAll","pfx","all","substr","entries","entry","put","del","removed","setSelectorEngine","querySelectorAll","Error","rootListener","propertyName","listeners","listener","add","custom","attachEvent","detachEvent","rm","originalFn","orgType","handlers","delegate","selector","fireListener","evt","createEvent","dispatchEvent","fireEvent","createEventObject","off","typeSpec","k","isTypeStr","hasOwnProperty","on","first","delfn","one","fire","names","from","beanDel","bean","noConflict","cleanup","CollectGarbage","_interopRequireWildcard","newObj","_KeyUtils","KeyUtils","zoomScale","rootNS","getAttribute","dragging","bind","handleEvent","started","enterStack","startKeys","stopKeys","buf","ns","stack","isRoot","startsWith","rootTarget","nsTarget","prepend","targetStack","_this","isKeyEvent","getKeyEvent","getEventInfo","wheelDelta","dragObject","mouse","dragPos","mousemove","currentPos","dispatch","mouseup","simulateEnterLeave","last","clearEnterStack","getNS","val","append","item","nsType","regexp","callback","lastPosition","_this3","registerKey","getKeyData","ctrl","alt","shift","meta","code","_this4","unregisterKey","zIndex","_this5","register","RegExp","registeredType","changedTouches","svg","ownerSVGElement","createSVGPoint","matrixTransform","getScreenCTM","inverse","clientLeft","clientTop","KeyboardEvent","ctrlKey","altKey","shiftKey","metaKey","nodeDefaults","role","draggable","selectable","editable","resizable","sourceable","targetable","visible","edgeDefaults","size","color","uniqueId","model","nodes","edges","selection","destroyed","nodeTypes","edgeTypes","markers","marker","markerConfig","getMarker","loadModel","currentRoot","NodeClass","getJSClass","addChild","to","EdgeClass","addNode","addEdge","children","without","allowDanglingEdges","multiConnect","readOnly","viewOnly","_Cell3","graph","inEdges","outEdges","ports","render","portName","endPt","shape","getShape","label","_Cache","_Cache2","decorators","createDecorators","views","viewProps","isUndefined","className","computedClassName","viewProp","shapeClass","getView","getLabelBox","renderLabel","_computedClassName","caches","getCache","clear","namesapce","FONT_BOLD","FONT_ITALIC","FONT_UNDERLINE","FONT_SHADOW","fontSize","fontFamily","fontStyle","fontColor","padding","linePadding","align","rotation","labelConfig","containerWidth","containerHeight","_getLabelBox","getLabelBoxForLink","bold","wrappedLabel","wrap","anchor","setAnchorX","pivot","maxBounds","_label","underline","italic","shadow","lineHeight","baseline","stringMeasureEl","measureDiv","baselineDiv","getStringSize","memoize","position","visibility","contentWindow","write","close","getElementById","fontWeight","strut","firstChild","baselineHeight","offsetTop","maxWidth","spaceSize","space","lines","word","words","line","currentWidth","wordWidth","newLine","editor","refEl","textEl","singleLine","unselectable","overflow","border","font-family","font-size","font-weight","focus","select","cancel","_get","object","property","receiver","Function","desc","getOwnPropertyDescriptor","getter","setSource","sourcePos","setTarget","targetPos","setTerminal","setEdgeAt","removeEdge","addOutEdge","addInEdge","center","refPts","getReferencePoints","terminals","getBound","getPort","getLink","getTerminalVisual","arrow","sign","viewBox","ref","fill","triangle","oval","diamond","orientation","HORIZONTAL","VERTICAL","_Layout3","items","getLinkedNodes","owner","hgap","vgap","_flPos","moveTo","trigger","tabindex","layout","layoutClass","_translate","_scale","dispatcher","graphBehavior","selectionBehavior","nodeBehavior","edgeBehavior","connectionBehavior","scaled","viewport","isNull","vp","transform","refresh","_graph","initializeBehaviors","renderMarkers","_firstSelection","_delayEdit","delay","preprocessor","TEMPLATES","parts","part","trim","camelCase","interpolate","gridSize","gBounds","vBounds","parseFloat","defaultClickMode","hideOutline","singleSelect","gridEnabled","guidesEnabled","maxZoom","minZoom","zoomFactor","maskOpacity","_Behavior2","_Behavior3","_Behavior","renderer","handleDrag","handleZoom","pan","Behavior","selectCell","unselectCell","handleMultiSelect","selectedNodes","selectedLinks","attachedLinks","classed","selectedVertices","getShapes","getAttachedEdges","selectedEdges","cell","toggle","isSelected","d3","dataTarget","moveToFront","setSelection","util","startPt","getBoundingRectangle","rubberband","appendNode","getCellLayer","cells","getCurrentRoot","filter","attr","_Renderer3","NS","SVGElement","createElementNS","outerHTML","$node","$temp","cloneNode","ropen","nodeName","rclose","markup","lastChild","firstElementChild","toDataURL","exportSVG","svg_xml","_svg","svg_dataurl","base64dataURLencode","options","b64","btoa","exportImage","canvas","ctx","getContext","svg_img","drawImage","image_dataurl","onerror","exportImageCanvg","canvg","xcanvas","jsCanvas","keepOutsideViewport","bbox","getBBox","compile","msg","keepNonSafe","renderDefs","querySelector","str1","str2","renderShape","round","newPts","prev","next","d1","d2","corner","getPathData","content","$root","$edge","Triangle","Hexagon","Polygon","removeLast","Grid","variable"],"mappings":"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","file":"qgraph.min.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory(require(\"lodash\"));\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([\"lodash\"], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"qgraph\"] = factory(require(\"lodash\"));\n\telse\n\t\troot[\"qgraph\"] = factory(root[\"_\"]);\n})(this, function(__WEBPACK_EXTERNAL_MODULE_5__) {\nreturn \n\n\n// WEBPACK FOOTER //\n// webpack/universalModuleDefinition","/*!\n * \n * \tqgraph - A Graph Manipulation and Visualization Library\n * \tAuthor: Tong Zou\n * \tVersion: v0.1.3\n * \tUrl: https://github.com/tongzou/qgraph\n * \tLicense(s): MIT\n * \n */\n(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory(require(\"lodash\"));\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([\"lodash\"], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"qgraph\"] = factory(require(\"lodash\"));\n\telse\n\t\troot[\"qgraph\"] = factory(root[\"_\"]);\n})(this, function(__WEBPACK_EXTERNAL_MODULE_5__) {\nreturn /******/ (function(modules) { // webpackBootstrap\n/******/ \t// The module cache\n/******/ \tvar installedModules = {};\n/******/\n/******/ \t// The require function\n/******/ \tfunction __webpack_require__(moduleId) {\n/******/\n/******/ \t\t// Check if module is in cache\n/******/ \t\tif(installedModules[moduleId])\n/******/ \t\t\treturn installedModules[moduleId].exports;\n/******/\n/******/ \t\t// Create a new module (and put it into the cache)\n/******/ \t\tvar module = installedModules[moduleId] = {\n/******/ \t\t\texports: {},\n/******/ \t\t\tid: moduleId,\n/******/ \t\t\tloaded: false\n/******/ \t\t};\n/******/\n/******/ \t\t// Execute the module function\n/******/ \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n/******/\n/******/ \t\t// Flag the module as loaded\n/******/ \t\tmodule.loaded = true;\n/******/\n/******/ \t\t// Return the exports of the module\n/******/ \t\treturn module.exports;\n/******/ \t}\n/******/\n/******/\n/******/ \t// expose the modules object (__webpack_modules__)\n/******/ \t__webpack_require__.m = modules;\n/******/\n/******/ \t// expose the module cache\n/******/ \t__webpack_require__.c = installedModules;\n/******/\n/******/ \t// __webpack_public_path__\n/******/ \t__webpack_require__.p = \"\";\n/******/\n/******/ \t// Load entry module and return exports\n/******/ \treturn __webpack_require__(0);\n/******/ })\n/************************************************************************/\n/******/ ([\n/* 0 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t\tvalue: true\n\t});\n\t\n\tvar _base = __webpack_require__(1);\n\t\n\tvar _base2 = _interopRequireDefault(_base);\n\t\n\tvar _Utils = __webpack_require__(2);\n\t\n\tvar _Utils2 = _interopRequireDefault(_Utils);\n\t\n\tvar _DomUtils = __webpack_require__(7);\n\t\n\tvar _DomUtils2 = _interopRequireDefault(_DomUtils);\n\t\n\tvar _StringBuffer = __webpack_require__(8);\n\t\n\tvar _StringBuffer2 = _interopRequireDefault(_StringBuffer);\n\t\n\tvar _Point = __webpack_require__(3);\n\t\n\tvar _Point2 = _interopRequireDefault(_Point);\n\t\n\tvar _Line = __webpack_require__(9);\n\t\n\tvar _Line2 = _interopRequireDefault(_Line);\n\t\n\tvar _Shape = __webpack_require__(6);\n\t\n\tvar _Shape2 = _interopRequireDefault(_Shape);\n\t\n\tvar _Rectangle = __webpack_require__(4);\n\t\n\tvar _Rectangle2 = _interopRequireDefault(_Rectangle);\n\t\n\tvar _Ellipse = __webpack_require__(10);\n\t\n\tvar _Ellipse2 = _interopRequireDefault(_Ellipse);\n\t\n\tvar _Rhombus = __webpack_require__(11);\n\t\n\tvar _Rhombus2 = _interopRequireDefault(_Rhombus);\n\t\n\tvar _Link = __webpack_require__(12);\n\t\n\tvar _Link2 = _interopRequireDefault(_Link);\n\t\n\tvar _bean = __webpack_require__(13);\n\t\n\tvar _bean2 = _interopRequireDefault(_bean);\n\t\n\tvar _EventDispatcher = __webpack_require__(14);\n\t\n\tvar _EventDispatcher2 = _interopRequireDefault(_EventDispatcher);\n\t\n\tvar _Graph = __webpack_require__(16);\n\t\n\tvar _Graph2 = _interopRequireDefault(_Graph);\n\t\n\tvar _Cell = __webpack_require__(18);\n\t\n\tvar _Cell2 = _interopRequireDefault(_Cell);\n\t\n\tvar _Node = __webpack_require__(17);\n\t\n\tvar _Node2 = _interopRequireDefault(_Node);\n\t\n\tvar _Edge = __webpack_require__(21);\n\t\n\tvar _Edge2 = _interopRequireDefault(_Edge);\n\t\n\tvar _Layout = __webpack_require__(23);\n\t\n\tvar _Layout2 = _interopRequireDefault(_Layout);\n\t\n\tvar _FlowLayout = __webpack_require__(24);\n\t\n\tvar _FlowLayout2 = _interopRequireDefault(_FlowLayout);\n\t\n\tvar _Label = __webpack_require__(20);\n\t\n\tvar _Label2 = _interopRequireDefault(_Label);\n\t\n\tvar _Marker = __webpack_require__(22);\n\t\n\tvar _Marker2 = _interopRequireDefault(_Marker);\n\t\n\tvar _Renderer = __webpack_require__(25);\n\t\n\tvar _Renderer2 = _interopRequireDefault(_Renderer);\n\t\n\tvar _SVGRenderer = __webpack_require__(29);\n\t\n\tvar _SVGRenderer2 = _interopRequireDefault(_SVGRenderer);\n\t\n\tvar _GraphBehavior = __webpack_require__(26);\n\t\n\tvar _GraphBehavior2 = _interopRequireDefault(_GraphBehavior);\n\t\n\tvar _SelectionBehavior = __webpack_require__(28);\n\t\n\tvar _SelectionBehavior2 = _interopRequireDefault(_SelectionBehavior);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\t_Shape2.default.addShape(\"Rectangle\", _Rectangle2.default);\n\t_Shape2.default.addShape(\"Ellipse\", _Ellipse2.default);\n\t_Shape2.default.addShape(\"Rhombus\", _Rhombus2.default);\n\t\n\texports.default = {\n\t\tEvents: _bean2.default,\n\t\tBase64: _base2.default,\n\t\tCache: _Utils2.default,\n\t\tUtils: _Utils2.default,\n\t\tDomUtils: _DomUtils2.default,\n\t\tStringBuffer: _StringBuffer2.default,\n\t\tPoint: _Point2.default,\n\t\tLine: _Line2.default,\n\t\tShape: _Shape2.default,\n\t\tRectangle: _Rectangle2.default,\n\t\tEllipse: _Ellipse2.default,\n\t\tLink: _Link2.default,\n\t\tEventDispatcher: _EventDispatcher2.default,\n\t\tLabel: _Label2.default,\n\t\tMarker: _Marker2.default,\n\t\tGraph: _Graph2.default,\n\t\tCell: _Cell2.default,\n\t\tNode: _Node2.default,\n\t\tEdge: _Edge2.default,\n\t\tLayout: _Layout2.default,\n\t\tFlowLayout: _FlowLayout2.default,\n\t\tRenderer: _Renderer2.default,\n\t\tSVGRenderer: _SVGRenderer2.default,\n\t\tGraphBehavior: _GraphBehavior2.default,\n\t\tSelectionBehavior: _SelectionBehavior2.default\n\t};\n\n/***/ }),\n/* 1 */\n/***/ (function(module, exports) {\n\n\t\"use strict\";\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t\tvalue: true\n\t});\n\t// http://www.webtoolkit.info/javascript-base64.html\n\t\n\tvar Base64 = {\n\t\n\t\t// private property\n\t\t_keyStr: \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=\",\n\t\n\t\t// public method for encoding\n\t\tencode: function encode(input) {\n\t\t\tvar output = \"\";\n\t\t\tvar chr1, chr2, chr3, enc1, enc2, enc3, enc4;\n\t\t\tvar i = 0;\n\t\n\t\t\tinput = Base64._utf8_encode(input);\n\t\n\t\t\twhile (i < input.length) {\n\t\n\t\t\t\tchr1 = input.charCodeAt(i++);\n\t\t\t\tchr2 = input.charCodeAt(i++);\n\t\t\t\tchr3 = input.charCodeAt(i++);\n\t\n\t\t\t\tenc1 = chr1 >> 2;\n\t\t\t\tenc2 = (chr1 & 3) << 4 | chr2 >> 4;\n\t\t\t\tenc3 = (chr2 & 15) << 2 | chr3 >> 6;\n\t\t\t\tenc4 = chr3 & 63;\n\t\n\t\t\t\tif (isNaN(chr2)) {\n\t\t\t\t\tenc3 = enc4 = 64;\n\t\t\t\t} else if (isNaN(chr3)) {\n\t\t\t\t\tenc4 = 64;\n\t\t\t\t}\n\t\n\t\t\t\toutput = output + this._keyStr.charAt(enc1) + this._keyStr.charAt(enc2) + this._keyStr.charAt(enc3) + this._keyStr.charAt(enc4);\n\t\t\t}\n\t\n\t\t\treturn output;\n\t\t},\n\t\n\t\t// public method for decoding\n\t\tdecode: function decode(input) {\n\t\t\tvar output = \"\";\n\t\t\tvar chr1, chr2, chr3;\n\t\t\tvar enc1, enc2, enc3, enc4;\n\t\t\tvar i = 0;\n\t\n\t\t\tinput = input.replace(/[^A-Za-z0-9\\+\\/\\=]/g, \"\");\n\t\n\t\t\twhile (i < input.length) {\n\t\n\t\t\t\tenc1 = this._keyStr.indexOf(input.charAt(i++));\n\t\t\t\tenc2 = this._keyStr.indexOf(input.charAt(i++));\n\t\t\t\tenc3 = this._keyStr.indexOf(input.charAt(i++));\n\t\t\t\tenc4 = this._keyStr.indexOf(input.charAt(i++));\n\t\n\t\t\t\tchr1 = enc1 << 2 | enc2 >> 4;\n\t\t\t\tchr2 = (enc2 & 15) << 4 | enc3 >> 2;\n\t\t\t\tchr3 = (enc3 & 3) << 6 | enc4;\n\t\n\t\t\t\toutput = output + String.fromCharCode(chr1);\n\t\n\t\t\t\tif (enc3 != 64) {\n\t\t\t\t\toutput = output + String.fromCharCode(chr2);\n\t\t\t\t}\n\t\t\t\tif (enc4 != 64) {\n\t\t\t\t\toutput = output + String.fromCharCode(chr3);\n\t\t\t\t}\n\t\t\t}\n\t\n\t\t\toutput = Base64._utf8_decode(output);\n\t\n\t\t\treturn output;\n\t\t},\n\t\n\t\t// private method for UTF-8 encoding\n\t\t_utf8_encode: function _utf8_encode(string) {\n\t\t\tstring = string.replace(/\\r\\n/g, \"\\n\");\n\t\t\tvar utftext = \"\";\n\t\n\t\t\tfor (var n = 0; n < string.length; n++) {\n\t\n\t\t\t\tvar c = string.charCodeAt(n);\n\t\n\t\t\t\tif (c < 128) {\n\t\t\t\t\tutftext += String.fromCharCode(c);\n\t\t\t\t} else if (c > 127 && c < 2048) {\n\t\t\t\t\tutftext += String.fromCharCode(c >> 6 | 192);\n\t\t\t\t\tutftext += String.fromCharCode(c & 63 | 128);\n\t\t\t\t} else {\n\t\t\t\t\tutftext += String.fromCharCode(c >> 12 | 224);\n\t\t\t\t\tutftext += String.fromCharCode(c >> 6 & 63 | 128);\n\t\t\t\t\tutftext += String.fromCharCode(c & 63 | 128);\n\t\t\t\t}\n\t\t\t}\n\t\n\t\t\treturn utftext;\n\t\t},\n\t\n\t\t// private method for UTF-8 decoding\n\t\t_utf8_decode: function _utf8_decode(utftext) {\n\t\t\tvar string = \"\";\n\t\t\tvar i = 0;\n\t\t\tvar c = c1 = c2 = 0;\n\t\n\t\t\twhile (i < utftext.length) {\n\t\n\t\t\t\tc = utftext.charCodeAt(i);\n\t\n\t\t\t\tif (c < 128) {\n\t\t\t\t\tstring += String.fromCharCode(c);\n\t\t\t\t\ti++;\n\t\t\t\t} else if (c > 191 && c < 224) {\n\t\t\t\t\tc2 = utftext.charCodeAt(i + 1);\n\t\t\t\t\tstring += String.fromCharCode((c & 31) << 6 | c2 & 63);\n\t\t\t\t\ti += 2;\n\t\t\t\t} else {\n\t\t\t\t\tc2 = utftext.charCodeAt(i + 1);\n\t\t\t\t\tc3 = utftext.charCodeAt(i + 2);\n\t\t\t\t\tstring += String.fromCharCode((c & 15) << 12 | (c2 & 63) << 6 | c3 & 63);\n\t\t\t\t\ti += 3;\n\t\t\t\t}\n\t\t\t}\n\t\n\t\t\treturn string;\n\t\t}\n\t\n\t};\n\t\n\texports.default = Base64;\n\n/***/ }),\n/* 2 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t/* WEBPACK VAR INJECTION */(function(global) {\"use strict\";\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t\tvalue: true\n\t});\n\t\n\tvar _Point = __webpack_require__(3);\n\t\n\tvar _Point2 = _interopRequireDefault(_Point);\n\t\n\tvar _Rectangle = __webpack_require__(4);\n\t\n\tvar _Rectangle2 = _interopRequireDefault(_Rectangle);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\t\n\tfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\t\n\t// bean requires the existence of window\n\tif (typeof window === 'undefined' && typeof global !== 'undefined') {\n\t\tglobal.window = { addEventHandler: function addEventHandler() {} };\n\t\tglobal.document = {};\n\t\tglobal.navigator = {};\n\t}\n\t\n\t// util variables\n\tvar _debugging = [],\n\t    _debugAll = false,\n\t    typeRegistry = {},\n\t    splice = Array.splice;\n\t\n\t/**\n\t * Utility functions\n\t */\n\texports.default = {\n\t\ttype: function type(namespace, name, _type) {\n\t\t\tif (!typeRegistry[namespace]) typeRegistry[namespace] = new Map();\n\t\t\tif (!name) return typeRegistry[namespace];\n\t\t\tif (!_type) return typeRegistry[namespace].get(name);\n\t\t\ttypeRegistry[namespace].set(name, _type);\n\t\t},\n\t\n\t\tcreateType: function createType(namespace, props, defaultType) {\n\t\t\tvar name = props.name;\n\t\n\t\t\t// first check if type exists\n\t\t\tvar type = this.type(namespace, name);\n\t\t\tif (!type) {\n\t\t\t\tvar extend = props.extends ? this.type(namespace, props.extends) : null;\n\t\t\t\tif (!extend && defaultType) extend = defaultType;\n\t\t\t\tif (extend) type = function (_extend) {\n\t\t\t\t\t_inherits(type, _extend);\n\t\n\t\t\t\t\tfunction type() {\n\t\t\t\t\t\t_classCallCheck(this, type);\n\t\n\t\t\t\t\t\treturn _possibleConstructorReturn(this, (type.__proto__ || Object.getPrototypeOf(type)).apply(this, arguments));\n\t\t\t\t\t}\n\t\n\t\t\t\t\treturn type;\n\t\t\t\t}(extend);else {\n\t\t\t\t\ttype = function type(config) {\n\t\t\t\t\t\t_classCallCheck(this, type);\n\t\n\t\t\t\t\t\t_.assign(this, config);\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t\tdelete props.name;\n\t\t\t\tdelete props.extends;\n\t\t\t\t_.assign(type.prototype, props);\n\t\t\t\ttype.typeName = name;\n\t\t\t\tthis.type(namespace, name, type);\n\t\t\t\tthis.log('Utils', 'Utils.createType - ' + namespace + '.' + name);\n\t\t\t}\n\t\t\treturn type;\n\t\t},\n\t\n\t\tbuildTypes: function buildTypes(types, namespace, defaultType) {\n\t\t\tvar _this2 = this;\n\t\n\t\t\tthis.log('Utils', 'Utils.buildTypes - ' + namespace);\n\t\n\t\t\tif (!types && defaultType) {\n\t\t\t\tthis.createType(namespace, defaultType);\n\t\t\t\tthis.log('Utils', 'Utils.buildTypes end');\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tif (defaultType) {\n\t\t\t\tvar type = _.remove(types, { name: defaultType.name });\n\t\t\t\ttype = type.length > 0 ? type[0] : null;\n\t\t\t\tif (type) defaultType = this.createType(namespace, _.defaultsDeep(type, defaultType));else defaultType = this.createType(namespace, defaultType);\n\t\t\t}\n\t\n\t\t\t_.forEach(types, function (type) {\n\t\t\t\t_this2.createType(namespace, type, defaultType);\n\t\t\t});\n\t\t\tthis.log('Utils', 'Utils.buildTypes end');\n\t\t},\n\t\n\t\t// Helper function to correctly set up the prototype chain, for subclasses.\n\t\t// Similar to `goog.inherits`, but uses a hash of prototype properties and\n\t\t// class properties to be extended.\n\t\textend: function extend(child, parent, protoProps, staticProps) {\n\t\t\t// Add static properties to the constructor function, if supplied.\n\t\t\t_.extend(child, parent, staticProps);\n\t\n\t\t\t// Set the prototype chain to inherit from `parent`, without calling\n\t\t\t// `parent`'s constructor function.\n\t\t\tvar Surrogate = function Surrogate() {\n\t\t\t\tthis.constructor = child;\n\t\t\t};\n\t\t\tSurrogate.prototype = parent.prototype;\n\t\t\tchild.prototype = new Surrogate();\n\t\n\t\t\t// Add prototype properties (instance properties) to the subclass,\n\t\t\t// if supplied.\n\t\t\tif (protoProps) _.extend(child.prototype, protoProps);\n\t\n\t\t\t// Set a convenience property in case the parent's prototype is needed later.\n\t\t\tchild.superclass = parent.prototype;\n\t\n\t\t\treturn child;\n\t\t},\n\t\n\t\tinitConfig: function initConfig(obj, config) {\n\t\t\tvar props = {},\n\t\t\t    c = obj.constructor,\n\t\t\t    cArr = [c];\n\t\t\twhile (c) {\n\t\t\t\tif (c.super) {\n\t\t\t\t\tc = c.super.constructor;\n\t\t\t\t\tsplice.apply(cArr, [0, 0, c]);\n\t\t\t\t} else c = null;\n\t\t\t}\n\t\n\t\t\tfor (var i = 0; i < cArr.length; i++) {\n\t\t\t\tc = cArr[i];\n\t\t\t\tif (c.DEFAULTS) _.assign(props, c.DEFAULTS);\n\t\t\t}\n\t\t\tobj.props = _.assign(props, config);\n\t\t\tc.prototype.prop = function (name, value) {\n\t\t\t\tif (!value) return this.props[name];\n\t\t\t\tthis.props[name] = value;\n\t\t\t};\n\t\t},\n\t\n\t\t/**\n\t  * Gets the JS class constructor.\n\t  * @param {Object} jsClass\n\t  * @param {Object} defaultClass\n\t  */\n\t\tgetConstructor: function getConstructor(jsClass, defaultClass) {\n\t\t\tif (!jsClass) jsClass = defaultClass;\n\t\n\t\t\tif (_.isString(jsClass)) jsClass = eval(jsClass);\n\t\t\treturn jsClass;\n\t\t},\n\t\n\t\tdebug: function debug(moduleName) {\n\t\t\tif (moduleName) {\n\t\t\t\t_debugging.push(moduleName);\n\t\t\t} else {\n\t\t\t\t_debugAll = true;\n\t\t\t}\n\t\t},\n\t\n\t\tlog: function log(name, message) {\n\t\t\tif (!window.console) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tvar debug = _debugAll;\n\t\t\tif (!_debugAll) {\n\t\t\t\tdebug = false;\n\t\t\t\tfor (var i = 0; i < _debugging.length; i++) {\n\t\t\t\t\tif (_debugging[i] == name) debug = true;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (!debug) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\twhile (name.length < 10) {\n\t\t\t\tname = name + ' ';\n\t\t\t}\n\t\t\tname = name.substring(0, 10) + \" - \";\n\t\t\tconsole.info(name, message);\n\t\t},\n\t\n\t\t/**\n\t  * Get the relative position of sub shapes within a parent share.\n\t  * @param bounds\n\t  * @param geometry The geometry information, the format of Geometry is:\n\t  * {\n\t  *      x: \"x coordinate of ref point, if less than 1, will be treated as the percentage of the parent width.\",\n\t  *      y: \"y coordinate of ref point.\",\n\t  *      anchorX: \"x pos of child relative to the ref point\",\n\t  *      anchorY: \"y pos of child relative to the ref point\",\n\t  *      offsetX: \"the offset in the x direction.\",\n\t  *      offsetY: \"the offset in the y direction.\",\n\t  *      width: \"the width of the child element\",\n\t  *      height: \"the height of the child element\"\n\t  * }\n\t  * @returns {*[]}\n\t  */\n\t\tgetRelativePosition: function getRelativePosition(bounds, geometry) {\n\t\t\tvar x = Math.abs(geometry.x) <= 1 ? bounds.width * geometry.x : geometry.x;\n\t\t\tvar y = Math.abs(geometry.y) <= 1 ? bounds.height * geometry.y : geometry.y;\n\t\t\treturn this.offsetPosition([x, y], geometry);\n\t\t},\n\t\n\t\toffsetPosition: function offsetPosition(pos, geometry) {\n\t\t\treturn [pos[0] + geometry.width * geometry.anchorX + geometry.offsetX, pos[1] + geometry.height * geometry.anchorY + geometry.offsetY];\n\t\t},\n\t\n\t\t/**\n\t  * Get the position relative to the graph that's unscaled, i.e., absolute position without considering translation and scale.\n\t  * @param t the current translate\n\t  * @param scale the current scale\n\t  * @param o can be either a Point or a Rectangle or a Point array.\n\t  */\n\t\tunscale: function unscale(t, scale, o) {\n\t\t\tif (o instanceof _Rectangle2.default) return new _Rectangle2.default(o.x * scale + t[0], o.y * scale + t[1], o.width * scale, o.height * scale);else if (o instanceof _Point2.default) return new _Point2.default(o.x * scale + t[0], o.y * scale + t[1]);else return [o[0] * scale + t[0], o[1] * scale + t[1]];\n\t\t},\n\t\n\t\t/**\n\t  * Get the position relative to the graph that's scaled, i.e., relative position considering translation and scale.\n\t  * @param t the current translation\n\t  * @param scale the current scale\n\t  * @param o can be either a Point or a Rectangle or a Point array.\n\t  */\n\t\tscale: function scale(t, _scale, o) {\n\t\t\tif (o instanceof _Rectangle2.default) return new _Rectangle2.default((o.x - t[0]) / _scale, (o.y - t[1]) / _scale, o.width / _scale, o.height / _scale);else if (o instanceof _Point2.default) return new _Point2.default((o.x - t[0]) / _scale, (o.y - t[1]) / _scale);else return [(o[0] - t[0]) / _scale, (o[1] - t[1]) / _scale];\n\t\t},\n\t\n\t\t/**\n\t  * Convenience method.\n\t  */\n\t\tgetProperty: function getProperty(obj, prop) {\n\t\t\tif (!obj) return null;\n\t\t\tif (_.has(obj, prop)) return obj[prop];\n\t\t\tif (obj.prop && _.isFunction(obj.prop)) return obj.prop(prop);\n\t\t\treturn null;\n\t\t}\n\t};\n\t/* WEBPACK VAR INJECTION */}.call(exports, (function() { return this; }())))\n\n/***/ }),\n/* 3 */\n/***/ (function(module, exports) {\n\n\t\"use strict\";\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t\tvalue: true\n\t});\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tvar Point = function () {\n\t\tfunction Point(x, y) {\n\t\t\t_classCallCheck(this, Point);\n\t\n\t\t\tthis.x = x;\n\t\t\tthis.y = y;\n\t\t}\n\t\n\t\t/**\n\t  * Make a clone of this point\n\t  */\n\t\n\t\n\t\t_createClass(Point, [{\n\t\t\tkey: \"clone\",\n\t\t\tvalue: function clone() {\n\t\t\t\treturn new Point(this.x, this.y);\n\t\t\t}\n\t\n\t\t\t/**\n\t   * Calculate the distance from this pt to the other pt.\n\t   * @param aPt\n\t   * @returns {number}\n\t   */\n\t\n\t\t}, {\n\t\t\tkey: \"distance\",\n\t\t\tvalue: function distance(aPt) {\n\t\t\t\treturn Math.sqrt((this.x - aPt.x) * (this.x - aPt.x) + (this.y - aPt.y) * (this.y - aPt.y));\n\t\t\t}\n\t\n\t\t\t/**\n\t   * Translate this point\n\t  \t */\n\t\n\t\t}, {\n\t\t\tkey: \"translate\",\n\t\t\tvalue: function translate(p2) {\n\t\t\t\tthis.x += p2.x;\n\t\t\t\tthis.y += p2.y;\n\t\t\t\treturn this;\n\t\t\t}\n\t\n\t\t\t/**\n\t   * Scale this vector\n\t  \t */\n\t\n\t\t}, {\n\t\t\tkey: \"scale\",\n\t\t\tvalue: function scale(_scale) {\n\t\t\t\tthis.x *= _scale;\n\t\t\t\tthis.y *= _scale;\n\t\t\t\treturn this;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"getScaled\",\n\t\t\tvalue: function getScaled(scale) {\n\t\t\t\treturn new Point(this.x * scale, this.y * scale);\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"getTranslated\",\n\t\t\tvalue: function getTranslated(p2) {\n\t\t\t\treturn new Point(this.x + p2.x, this.y + p2.y);\n\t\t\t}\n\t\n\t\t\t/**\n\t   * Get the direction vector from this point to p2.\n\t   * @param p2\n\t   * @returns {Point}\n\t   */\n\t\n\t\t}, {\n\t\t\tkey: \"getDirection\",\n\t\t\tvalue: function getDirection(p2) {\n\t\t\t\tvar dist = this.distance(p2);\n\t\t\t\treturn new Point((p2.x - this.x) / dist, (p2.y - this.y) / dist);\n\t\t\t}\n\t\n\t\t\t/**\n\t   * rotate the point about the origin. With the specified angle.\n\t   * @param angle the angle to rotate\n\t   */\n\t\n\t\t}, {\n\t\t\tkey: \"rotate\",\n\t\t\tvalue: function rotate(angle) {\n\t\t\t\tvar cos = Math.cos(angle * Math.PI / 180);\n\t\t\t\tvar sin = Math.sin(angle * Math.PI / 180);\n\t\t\t\tvar x = this.x,\n\t\t\t\t    y = this.y;\n\t\t\t\tthis.x = x * cos - y * sin;\n\t\t\t\tthis.y = x * sin + y * cos;\n\t\t\t\treturn this;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"getRotated\",\n\t\t\tvalue: function getRotated(angle) {\n\t\t\t\treturn this.clone().rotate(angle);\n\t\t\t}\n\t\n\t\t\t/**\n\t   * Calculate the dot product, treating this and p2 as vectors.\n\t   */\n\t\n\t\t}, {\n\t\t\tkey: \"dotProduct\",\n\t\t\tvalue: function dotProduct(p2) {\n\t\t\t\treturn this.x * p2.x + this.y * p2.y;\n\t\t\t}\n\t\n\t\t\t/**\n\t   * Get the mid point between this and p2.\n\t  \t */\n\t\n\t\t}, {\n\t\t\tkey: \"getMidPoint\",\n\t\t\tvalue: function getMidPoint(p2) {\n\t\t\t\treturn new Point((this.x + p2.x) / 2, (this.y + p2.y) / 2);\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"reverse\",\n\t\t\tvalue: function reverse() {\n\t\t\t\tthis.x = -this.x;\n\t\t\t\tthis.y = -this.y;\n\t\t\t\treturn this;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"equals\",\n\t\t\tvalue: function equals(p2) {\n\t\t\t\tif (!p2 || p2.constructor != Point) return false;\n\t\n\t\t\t\treturn this.x == p2.x && this.y == p2.y;\n\t\t\t}\n\t\n\t\t\t/**\n\t   * Reflect this point w.r.t. the rectangle.\n\t   * If vertical is true, it will reflect the point cross the vertical\n\t   * central line of the rectangle, otherwise reflect cross the horizontal\n\t   * central line.\n\t   *\n\t   * @param rect the rectangle\n\t   * @param vertical whether is vertical reflection or horizontal reflection.\n\t   */\n\t\n\t\t}, {\n\t\t\tkey: \"reflect\",\n\t\t\tvalue: function reflect(rect, vertical) {\n\t\t\t\tif (vertical) this.x = 2 * rect.x - this.x;else this.y = 2 * rect.y - this.y;\n\t\t\t\treturn this;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"toString\",\n\t\t\tvalue: function toString() {\n\t\t\t\treturn this.x + \",\" + this.y;\n\t\t\t}\n\t\t}]);\n\t\n\t\treturn Point;\n\t}();\n\t\n\tPoint.W = new Point(-1, 0);\n\tPoint.N = new Point(0, -1);\n\tPoint.S = new Point(0, 1);\n\tPoint.E = new Point(1, 0);\n\tPoint.NE = new Point(1, -1);\n\tPoint.NW = new Point(-1, -1);\n\tPoint.SE = new Point(1, 1);\n\tPoint.SW = new Point(-1, 1);\n\t\n\texports.default = Point;\n\n/***/ }),\n/* 4 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t\tvalue: true\n\t});\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tvar _lodash = __webpack_require__(5);\n\t\n\tvar _lodash2 = _interopRequireDefault(_lodash);\n\t\n\tvar _Point = __webpack_require__(3);\n\t\n\tvar _Point2 = _interopRequireDefault(_Point);\n\t\n\tvar _Shape2 = __webpack_require__(6);\n\t\n\tvar _Shape3 = _interopRequireDefault(_Shape2);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\t\n\tfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\t\n\tvar Rectangle = function (_Shape) {\n\t\t_inherits(Rectangle, _Shape);\n\t\n\t\tfunction Rectangle() {\n\t\t\t_classCallCheck(this, Rectangle);\n\t\n\t\t\treturn _possibleConstructorReturn(this, (Rectangle.__proto__ || Object.getPrototypeOf(Rectangle)).apply(this, arguments));\n\t\t}\n\t\n\t\t_createClass(Rectangle, [{\n\t\t\tkey: \"contains\",\n\t\n\t\t\t/**\r\n\t   * Checks whether this rectangle contains a given point of a given rectangle\r\n\t   */\n\t\t\tvalue: function contains(el) {\n\t\t\t\tvar w = el.width || 0;\n\t\t\t\tvar h = el.height || 0;\n\t\t\t\tvar left = el.x - w / 2;\n\t\t\t\tvar right = el.x + w / 2;\n\t\t\t\tvar top = el.y - h / 2;\n\t\t\t\tvar bottom = el.y + h / 2;\n\t\t\t\treturn right <= this.right && left >= this.left && top >= this.top && bottom <= this.bottom;\n\t\t\t}\n\t\n\t\t\t/**\r\n\t   * Calcualte the distance to a point. 0 if this rectangle contains the point.\r\n\t   */\n\t\n\t\t}, {\n\t\t\tkey: \"distance\",\n\t\t\tvalue: function distance(pt) {\n\t\t\t\tif (this.contains(pt)) return 0;\n\t\n\t\t\t\tif (pt.x < this.left) {\n\t\t\t\t\tif (pt.y < this.top) return pt.distance(new _Point2.default(this.left, this.top));\n\t\t\t\t\tif (pt.y <= this.bottom) return this.left - pt.x;\n\t\t\t\t\treturn pt.distance(new _Point2.default(this.left, this.bottom));\n\t\t\t\t}\n\t\t\t\tif (pt.x <= this.right) {\n\t\t\t\t\tif (pt.y <= this.top) return this.top - pt.y;\n\t\t\t\t\treturn pt.y - this.bottom;\n\t\t\t\t}\n\t\t\t\tif (pt.y < this.top) return pt.distance(new _Point2.default(this.right, this.top));\n\t\t\t\tif (pt.y <= this.bottom) return pt.x - this.right;\n\t\t\t\treturn pt.distance(new _Point2.default(this.right, this.bottom));\n\t\t\t}\n\t\n\t\t\t/**\r\n\t   * Given two points, we want to detect whether the line joining the pts intersect\r\n\t   * with the rectangle or not. We assume only horizontal or vertical line segments.\r\n\t   *\r\n\t   * @return int the side of the intersection: -1: no intersection, 0: left, 1: top, 2: right, 3: bottom, 4: containment.\r\n\t   */\n\t\n\t\t}, {\n\t\t\tkey: \"detectIntersection\",\n\t\t\tvalue: function detectIntersection(pt1, pt2) {\n\t\t\t\tvar horizontal = pt1.y == pt2.y;\n\t\t\t\tvar contains1 = this.contains(pt1);\n\t\t\t\tvar contains2 = this.contains(pt2);\n\t\t\t\tif (contains1 && contains2) return 4;\n\t\t\t\tif (!contains1 && !contains2) {\n\t\t\t\t\tif (horizontal && pt1.y >= this.top && pt1.y <= this.bottom) {\n\t\t\t\t\t\tif (pt1.x < this.left && pt2.x > this.right) return 0;\n\t\t\t\t\t\tif (pt1.x > this.right && pt2.x < this.left) return 2;\n\t\t\t\t\t}\n\t\t\t\t\tif (!horizontal && pt1.x >= this.left && pt1.x <= this.right) {\n\t\t\t\t\t\tif (pt1.y < this.top && pt2.y > this.bottom) return 1;\n\t\t\t\t\t\tif (pt1.y > this.bottom && pt2.y < this.top) return 3;\n\t\t\t\t\t}\n\t\t\t\t\treturn -1;\n\t\t\t\t}\n\t\n\t\t\t\tvar outPt = contains1 ? pt2 : pt1;\n\t\t\t\tif (horizontal) {\n\t\t\t\t\tif (outPt.x > this.right) return 2;\n\t\t\t\t\treturn 0;\n\t\t\t\t} else {\n\t\t\t\t\tif (outPt.y < this.top) return 1;\n\t\t\t\t\treturn 3;\n\t\t\t\t}\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"toString\",\n\t\t\tvalue: function toString() {\n\t\t\t\treturn 'Rectangle:{x=' + this.x + ';y=' + this.y + ';width=' + this.width + ';height=' + this.height + '}';\n\t\t\t}\n\t\t}], [{\n\t\t\tkey: \"getPerimeter\",\n\t\t\tvalue: function getPerimeter(rect, pt) {\n\t\t\t\tvar orthogonal = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;\n\t\n\t\t\t\tvar x = rect.x;\n\t\t\t\tvar y = rect.y;\n\t\t\t\tvar dx = pt.x - x;\n\t\t\t\tvar dy = pt.y - y;\n\t\t\t\tvar alpha = Math.atan2(dy, dx);\n\t\t\t\tvar p = new _Point2.default(0, 0);\n\t\t\t\tvar pi = Math.PI;\n\t\t\t\tvar pi2 = Math.PI / 2;\n\t\t\t\tvar beta = pi2 - alpha;\n\t\t\t\tvar t = Math.atan2(rect.height, rect.width);\n\t\n\t\t\t\tif (alpha < -pi + t || alpha > pi - t) {\n\t\t\t\t\t// Left edge\n\t\t\t\t\tp.x = rect.left;\n\t\t\t\t\tp.y = y - rect.width * Math.tan(alpha) / 2;\n\t\t\t\t} else if (alpha < -t) {\n\t\t\t\t\t// Top Edge\n\t\t\t\t\tp.y = rect.top;\n\t\t\t\t\tp.x = x - rect.height * Math.tan(beta) / 2;\n\t\t\t\t} else if (alpha < t) {\n\t\t\t\t\t// Right Edge\n\t\t\t\t\tp.x = rect.right;\n\t\t\t\t\tp.y = y + rect.width * Math.tan(alpha) / 2;\n\t\t\t\t} else {\n\t\t\t\t\t// Bottom Edge\n\t\t\t\t\tp.y = rect.bottom;\n\t\t\t\t\tp.x = x + rect.height * Math.tan(beta) / 2;\n\t\t\t\t}\n\t\n\t\t\t\tif (orthogonal) {\n\t\t\t\t\tif (alpha < -pi + t || alpha > pi - t) {\n\t\t\t\t\t\t// Left edge\n\t\t\t\t\t\tp.x = rect.left;\n\t\t\t\t\t\tp.y = y;\n\t\t\t\t\t} else if (alpha < -t) {\n\t\t\t\t\t\t// Top Edge\n\t\t\t\t\t\tp.y = rect.top;\n\t\t\t\t\t\tp.x = x;\n\t\t\t\t\t} else if (alpha < t) {\n\t\t\t\t\t\t// Right Edge\n\t\t\t\t\t\tp.x = rect.right;\n\t\t\t\t\t\tp.y = y;\n\t\t\t\t\t} else {\n\t\t\t\t\t\t// Bottom Edge\n\t\t\t\t\t\tp.y = rect.bottom;\n\t\t\t\t\t\tp.x = x;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\n\t\t\t\tvar dir = Rectangle.getDirection(rect, p, orthogonal);\n\t\t\t\treturn { point: p, direction: dir };\n\t\t\t}\n\t\n\t\t\t/**\r\n\t   * Return the bounding rectangle that contains p1 and p2\r\n\t   */\n\t\n\t\t}, {\n\t\t\tkey: \"getBoundingRectangle\",\n\t\t\tvalue: function getBoundingRectangle(pts, margin) {\n\t\t\t\tif (!pts || pts.length == 0) return null;\n\t\t\t\tmargin = margin || [0, 0, 0, 0];\n\t\t\t\tif (!_lodash2.default.isArray(margin)) margin = [margin, margin, margin, margin];\n\t\t\t\tvar min = [pts[0].x, pts[0].y];\n\t\t\t\tvar max = [pts[0].x, pts[0].y];\n\t\t\t\tfor (var i = 1; i < pts.length; i++) {\n\t\t\t\t\tvar p = pts[i];\n\t\t\t\t\tif (p.x < min[0]) {\n\t\t\t\t\t\tmin[0] = p.x;\n\t\t\t\t\t}\n\t\t\t\t\tif (p.y < min[1]) {\n\t\t\t\t\t\tmin[1] = p.y;\n\t\t\t\t\t}\n\t\t\t\t\tif (p.x > max[0]) {\n\t\t\t\t\t\tmax[0] = p.x;\n\t\t\t\t\t}\n\t\t\t\t\tif (p.y > max[1]) {\n\t\t\t\t\t\tmax[1] = p.y;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tmin[0] = min[0] - margin[0];\n\t\t\t\tmin[1] = min[1] - margin[1];\n\t\t\t\tmax[0] = max[0] + margin[2];\n\t\t\t\tmax[1] = max[1] + margin[3];\n\t\t\t\tvar w = Math.abs(max[0] - min[0]);\n\t\t\t\tvar h = Math.abs(max[1] - min[1]);\n\t\t\t\treturn new Rectangle(min[0] + w / 2, min[1] + h / 2, w, h);\n\t\t\t}\n\t\n\t\t\t/**\r\n\t   * Create a union of all the rectangles.\r\n\t   * @param rects\r\n\t   */\n\t\n\t\t}, {\n\t\t\tkey: \"union\",\n\t\t\tvalue: function union(rects) {\n\t\t\t\tvar minx = null,\n\t\t\t\t    miny = null,\n\t\t\t\t    maxx = -Infinity,\n\t\t\t\t    maxy = -Infinity;\n\t\t\t\t_lodash2.default.each(rects, function (rect) {\n\t\t\t\t\tminx = minx || rect.x;\n\t\t\t\t\tminy = miny || rect.y;\n\t\t\t\t\tminx = Math.min(minx, rect.x);\n\t\t\t\t\tminy = Math.min(miny, rect.y);\n\t\t\t\t\tmaxx = Math.max(maxx, rect.right());\n\t\t\t\t\tmaxy = Math.max(maxy, rect.bottom());\n\t\t\t\t});\n\t\t\t\tminx = minx || 0;\n\t\t\t\tminy = miny || 0;\n\t\t\t\treturn new Rectangle(minx, miny, maxx - minx, maxy - miny);\n\t\t\t}\n\t\n\t\t\t/**\r\n\t   * Returns the direction the point <i>p</i> is in relation to the given rectangle.\r\n\t   * Possible values are WEST (-1,0), EAST (1,0), NORTH (0,-1) and SOUTH (0,1) if orthogonal is true, otherwise return\r\n\t   * the direction connection the center of r and p.\r\n\t   * @param r\r\n\t   * @param p\r\n\t   * @param orthogonal\r\n\t   * @returns {Point|*}\r\n\t   */\n\t\n\t\t}, {\n\t\t\tkey: \"getDirection\",\n\t\t\tvalue: function getDirection(r, p) {\n\t\t\t\tvar orthogonal = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;\n\t\n\t\t\t\tif (!orthogonal) return new _Point2.default(r.x, r.y).getDirection(new _Point2.default(p.x, p.y));\n\t\n\t\t\t\tvar i = void 0,\n\t\t\t\t    distance = Math.abs(r.left - p.x),\n\t\t\t\t    direction = _Point2.default.W;\n\t\n\t\t\t\ti = Math.abs(r.top - p.y);\n\t\t\t\tif (i <= distance) {\n\t\t\t\t\tdistance = i;\n\t\t\t\t\tdirection = _Point2.default.N;\n\t\t\t\t}\n\t\n\t\t\t\ti = Math.abs(r.bottom - p.y);\n\t\t\t\tif (i <= distance) {\n\t\t\t\t\tdistance = i;\n\t\t\t\t\tdirection = _Point2.default.S;\n\t\t\t\t}\n\t\n\t\t\t\ti = Math.abs(r.right - p.x);\n\t\t\t\tif (i < distance) {\n\t\t\t\t\tdirection = _Point2.default.E;\n\t\t\t\t}\n\t\n\t\t\t\treturn direction;\n\t\t\t}\n\t\t}]);\n\t\n\t\treturn Rectangle;\n\t}(_Shape3.default);\n\t\n\texports.default = Rectangle;\n\n/***/ }),\n/* 5 */\n/***/ (function(module, exports) {\n\n\tmodule.exports = __WEBPACK_EXTERNAL_MODULE_5__;\n\n/***/ }),\n/* 6 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t\tvalue: true\n\t});\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tvar _lodash = __webpack_require__(5);\n\t\n\tvar _lodash2 = _interopRequireDefault(_lodash);\n\t\n\tvar _Point = __webpack_require__(3);\n\t\n\tvar _Point2 = _interopRequireDefault(_Point);\n\t\n\tvar _Rectangle = __webpack_require__(4);\n\t\n\tvar _Rectangle2 = _interopRequireDefault(_Rectangle);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tvar registry = {};\n\t\n\tvar Shape = function () {\n\t\tfunction Shape(x, y, width, height, config) {\n\t\t\t_classCallCheck(this, Shape);\n\t\n\t\t\tthis.x = x;\n\t\t\tthis.y = y;\n\t\t\tthis.width = width;\n\t\t\tthis.height = height;\n\t\t\t_lodash2.default.defaults(this, config, { x: 0, y: 0, width: 0, height: 0 });\n\t\t}\n\t\n\t\t/**\n\t  * Return the y-coord of the top side of this rectangle\n\t  */\n\t\n\t\n\t\t_createClass(Shape, [{\n\t\t\tkey: \"contains\",\n\t\t\tvalue: function contains(el) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\n\t\t\t/**\n\t   * This will generate n ports on the shape.\n\t   */\n\t\n\t\t}, {\n\t\t\tkey: \"getRegularPoints\",\n\t\t\tvalue: function getRegularPoints(n) {\n\t\t\t\treturn null;\n\t\t\t}\n\t\n\t\t\t/**\n\t   * Get the intersection between boundary of this shape and the line connecting (x,y) with the refPt.\n\t   * @param refPt\n\t   * @param orthogonal\n\t   * @returns {*|{point, direction}}\n\t   */\n\t\n\t\t}, {\n\t\t\tkey: \"getPerimeter\",\n\t\t\tvalue: function getPerimeter(refPt) {\n\t\t\t\tvar orthogonal = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n\t\n\t\t\t\treturn this.constructor.getPerimeter(this, refPt, orthogonal);\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"render\",\n\t\t\tvalue: function render(view) {\n\t\t\t\tvar template = _lodash2.default.template(view.getTemplate(this.name, this));\n\t\t\t\treturn template(this);\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"top\",\n\t\t\tget: function get() {\n\t\t\t\treturn this.y - this.height / 2;\n\t\t\t}\n\t\n\t\t\t/**\n\t   * Returns the y-coordinate of the bottom of this Rectangle.\n\t   */\n\t\n\t\t}, {\n\t\t\tkey: \"bottom\",\n\t\t\tget: function get() {\n\t\t\t\treturn this.y + this.height / 2;\n\t\t\t}\n\t\n\t\t\t/**\n\t   * Return the x-coord of left side of this rectangle\n\t   */\n\t\n\t\t}, {\n\t\t\tkey: \"left\",\n\t\t\tget: function get() {\n\t\t\t\treturn this.x - this.width / 2;\n\t\t\t}\n\t\n\t\t\t/**\n\t   * Returns the x-coordinate of the right side of this Rectangle.\n\t   */\n\t\n\t\t}, {\n\t\t\tkey: \"right\",\n\t\t\tget: function get() {\n\t\t\t\treturn this.x + this.width / 2;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"center\",\n\t\t\tget: function get() {\n\t\t\t\treturn new _Point2.default(this.x, this.y);\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"bounds\",\n\t\t\tget: function get() {\n\t\t\t\treturn new _Rectangle2.default(this.x, this.y, this.width, this.height);\n\t\t\t}\n\t\t}], [{\n\t\t\tkey: \"getShape\",\n\t\t\tvalue: function getShape(name) {\n\t\t\t\treturn registry[name];\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"addShape\",\n\t\t\tvalue: function addShape(name, c) {\n\t\t\t\tregistry[name] = c;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"removeShape\",\n\t\t\tvalue: function removeShape(name) {\n\t\t\t\tdelete registry[name];\n\t\t\t}\n\t\t}]);\n\t\n\t\treturn Shape;\n\t}();\n\t\n\texports.default = Shape;\n\n/***/ }),\n/* 7 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t\tvalue: true\n\t});\n\t\n\tvar _lodash = __webpack_require__(5);\n\t\n\tvar _lodash2 = _interopRequireDefault(_lodash);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\t/**\n\t * dom Utility functions\n\t */\n\texports.default = {\n\t\tisIE: function () {\n\t\t\tif (!window || !window.navigator || !navigator) return false;\n\t\t\tvar sAgent = window.navigator.userAgent;\n\t\t\tvar Idx = sAgent.indexOf(\"MSIE\");\n\t\n\t\t\t// If IE, return version number.\n\t\t\tif (Idx > 0) return parseInt(sAgent.substring(Idx + 5, sAgent.indexOf(\".\", Idx)));\n\t\n\t\t\t// If IE 11 then look for Updated user agent string.\n\t\t\telse if (!!navigator.userAgent.match(/Trident\\/7\\./)) return 11;else if (!!navigator.userAgent.match(/Edge\\//)) return \"Edge\";else return false;\n\t\t}(),\n\t\n\t\tisFireFox: function () {\n\t\t\t// InstallTrigger: Firefox's API to install add-ons\n\t\t\treturn typeof InstallTrigger !== 'undefined';\n\t\t}(),\n\t\n\t\tisChrome: function () {\n\t\t\tif (!window || !window.navigator || !navigator || navigator.userAgent.indexOf('Edge') >= 0) return false;\n\t\t\tvar raw = navigator.userAgent.match(/Chrom(e|ium)\\/([0-9]+)\\./);\n\t\t\treturn raw ? parseInt(raw[2], 10) : false;\n\t\t}(),\n\t\n\t\tisMac: function () {\n\t\t\tif (!window || !window.navigator || !navigator) return false;\n\t\t\treturn navigator.platform.toUpperCase().indexOf('MAC') >= 0;\n\t\t}(),\n\t\n\t\tisWindows: function () {\n\t\t\tif (!window || !window.navigator || !navigator) return false;\n\t\t\treturn navigator.appVersion.indexOf(\"Windows\") >= 0;\n\t\t}(),\n\t\n\t\tisLinux: function () {\n\t\t\tif (!window || !window.navigator || !navigator) return false;\n\t\t\treturn navigator.appVersion.indexOf(\"Linux\") >= 0;\n\t\t}(),\n\t\n\t\tcreateElement: function createElement(tag, attribs, styles, html) {\n\t\t\tvar el = document.createElement(tag);\n\t\t\tthis.setElement(el, attribs, styles);\n\t\t\tif (html) el.innerHTML = html;\n\t\t\treturn el;\n\t\t},\n\t\n\t\tcreateElementByString: function createElementByString(str) {\n\t\t\tvar temp = this.createElement('div', null, null, str);\n\t\t\treturn temp.childNodes;\n\t\t},\n\t\n\t\tsetElement: function setElement(el, attribs, styles) {\n\t\t\tif (attribs) {\n\t\t\t\t_lodash2.default.forEach(attribs, function (value, key) {\n\t\t\t\t\tel.setAttribute(key, value);\n\t\t\t\t});\n\t\t\t}\n\t\t\tif (styles) {\n\t\t\t\t_lodash2.default.forEach(styles, function (value, key) {\n\t\t\t\t\tel.style[key] = value;\n\t\t\t\t});\n\t\t\t}\n\t\t},\n\t\n\t\ttestElement: function testElement(node, method) {\n\t\t\treturn node && node.nodeType == 1 && (!method || method(node));\n\t\t},\n\t\n\t\tgetAncestorBy: function getAncestorBy(node, method) {\n\t\t\twhile (node = node.parentNode) {\n\t\t\t\tif (this.testElement(node, method)) return node;\n\t\t\t}return null;\n\t\t},\n\t\n\t\t/**\n\t  * Get the position of element relative to the context.\n\t  * @param el the element\n\t  * @param context\n\t  * @returns {*[]}\n\t  */\n\t\tgetPosition: function getPosition(el, context) {\n\t\t\tif (!context) context = document.body;\n\t\t\tvar elRect = el.getBoundingClientRect();\n\t\t\tvar contextRect = context.getBoundingClientRect();\n\t\n\t\t\treturn [elRect.left - contextRect.left, elRect.top - contextRect.top];\n\t\t},\n\t\tgetCenterPosition: function getCenterPosition(el, context) {\n\t\t\tif (!context) context = document.body;\n\t\t\tvar elRect = el.getBoundingClientRect();\n\t\t\tvar contextRect = context.getBoundingClientRect();\n\t\t\tvar w = elRect.right - elRect.left;\n\t\t\tvar h = elRect.bottom - elRect.top;\n\t\n\t\t\treturn [elRect.left - contextRect.left + w / 2, elRect.top - contextRect.top + h / 2];\n\t\t},\n\t\n\t\n\t\tmove: function move(el, x, y) {\n\t\t\tif (x) el.style.left = x + 'px';\n\t\t\tif (y) el.style.top = y + 'px';\n\t\t},\n\t\n\t\tgetSize: function getSize(el) {\n\t\t\tvar w = parseInt(el.style.offsetWidth, 10);\n\t\t\tvar h = parseInt(el.style.offsetHeight, 10);\n\t\t\treturn [w, h];\n\t\t},\n\t\n\t\tresize: function resize(el, w, h) {\n\t\t\tif (w) el.style.width = w + \"px\";\n\t\t\tif (h) el.style.height = h + 'px';\n\t\t},\n\t\n\t\tpreloadImages: function preloadImages(array) {\n\t\t\tif (!this.preloadImages.list) this.preloadImages.list = [];\n\t\t\tif (!this.preloadImages.loaded) this.preloadImages.loaded = {};\n\t\n\t\t\tvar list = this.preloadImages.list;\n\t\t\tvar img,\n\t\t\t    that = this;\n\t\t\tfor (var i = 0; i < array.length; i++) {\n\t\t\t\timg = new Image();\n\t\t\t\timg.onload = function () {\n\t\t\t\t\tvar index = list.indexOf(this);\n\t\t\t\t\tif (index !== -1) {\n\t\t\t\t\t\tthat.preloadImages.loaded[this.name] = { width: this.width, height: this.height };\n\t\t\t\t\t\t// remove image from the array once it's loaded\n\t\t\t\t\t\t// for memory consumption reasons\n\t\t\t\t\t\tlist.splice(index, 1);\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t\tlist.push(img);\n\t\t\t\timg.src = array[i];\n\t\t\t\timg.name = array[i];\n\t\t\t}\n\t\t},\n\t\n\t\t/**\n\t  * Get's the image's information given the url. Must be preloaded by calling the preloadImage function.\n\t  * @param src\n\t  */\n\t\tgetImageInfo: function getImageInfo(src) {\n\t\t\tif (this.preloadImages.loaded) {\n\t\t\t\treturn this.preloadImages.loaded[src];\n\t\t\t}\n\t\t\treturn null;\n\t\t},\n\t\n\t\tdownloadFile: function downloadFile(name, data) {\n\t\t\tif (!data) return;\n\t\t\tvar mime = data.match(/^data:([^;,]*)/)[1];\n\t\t\tif (name.indexOf('.') < 0) {\n\t\t\t\tif (!mime) mime = 'text/plain';\n\t\t\t\tif (mime == 'text/plain') name = name + '.txt';else {\n\t\t\t\t\tvar type = mime.split('/')[1];\n\t\t\t\t\tif (type.indexOf('+') > 0) type = type.split('+')[0];\n\t\t\t\t\tname = name + '.' + type;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (this.isIE) {\n\t\t\t\tvar encoded = data.indexOf(';base64') >= 0;\n\t\t\t\tif (encoded) data = atob(data.replace('data:' + mime + ';base64,', ''));else data = decodeURI(data.replace('data:' + mime + ',', ''));\n\t\t\t\tdata = this.GetBlob(data, mime);\n\t\t\t\tnavigator.msSaveBlob(data, name);\n\t\t\t} else {\n\t\t\t\tvar link = this.createElement('a', { href: data, download: name }, { display: \"none\" });\n\t\t\t\tdocument.body.appendChild(link);\n\t\t\t\tlink.click();\n\t\t\t\tlink.parentNode.removeChild(link);\n\t\t\t}\n\t\t},\n\t\n\t\t/**\n\t  * Convert b54 to blob. IE only\n\t  */\n\t\tGetBlob: function GetBlob(data, contentType, sliceSize) {\n\t\t\tcontentType = contentType || '';\n\t\t\tsliceSize = sliceSize || 512;\n\t\n\t\t\tvar byteArrays = [];\n\t\n\t\t\tfor (var offset = 0; offset < data.length; offset += sliceSize) {\n\t\t\t\tvar slice = data.slice(offset, offset + sliceSize);\n\t\n\t\t\t\tvar byteNumbers = new Array(slice.length);\n\t\t\t\tfor (var i = 0; i < slice.length; i++) {\n\t\t\t\t\tbyteNumbers[i] = slice.charCodeAt(i);\n\t\t\t\t}\n\t\t\t\tvar byteArray = new Uint8Array(byteNumbers);\n\t\t\t\tbyteArrays.push(byteArray);\n\t\t\t}\n\t\t\treturn new Blob(byteArrays, { type: contentType });\n\t\t},\n\t\n\t\topenImage: function openImage(name, image) {\n\t\t\tvar myWindow = window.open(\"\", \"_blank\", \"toolbar=yes, scrollbars=yes, resizable=yes, width=500, height=500\");\n\t\t\tvar myDocument = myWindow.document;\n\t\t\tvar img = myDocument.createElement(\"img\");\n\t\t\tthis.setElement(img, { src: image, name: name });\n\t\t\tmyDocument.body.appendChild(img);\n\t\t},\n\t\n\t\t/**\n\t  * Check whether the key event is from input, textarea or select.\n\t  * @param e  input event\n\t  */\n\t\teventFromInput: function eventFromInput(e) {\n\t\t\tvar tagName = e.target.tagName;\n\t\t\treturn tagName == 'INPUT' || tagName == 'TEXTAREA' || tagName == 'SELECT';\n\t\t}\n\t};\n\n/***/ }),\n/* 8 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t\tvalue: true\n\t});\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tvar _lodash = __webpack_require__(5);\n\t\n\tvar _lodash2 = _interopRequireDefault(_lodash);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\t/**\n\t * A string buffer for fast string manipulation\n\t */\n\tvar StringBuffer = function () {\n\t\tfunction StringBuffer(str) {\n\t\t\t_classCallCheck(this, StringBuffer);\n\t\n\t\t\tthis.buffer = [];\n\t\t\tif (str) this.buffer.push(str);\n\t\t}\n\t\n\t\t_createClass(StringBuffer, [{\n\t\t\tkey: \"append\",\n\t\t\tvalue: function append(stuff) {\n\t\t\t\tif (_lodash2.default.isString(stuff)) this.buffer.push(stuff);else if (_lodash2.default.isArray(stuff)) this.buffer = this.buffer.concat(stuff);else this.buffer.push(\"\" + stuff);\n\t\t\t\treturn this;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"prepend\",\n\t\t\tvalue: function prepend(stuff) {\n\t\t\t\tif (_lodash2.default.isString(stuff)) this.buffer.splice(0, 0, stuff);else if (_lodash2.default.isArray(stuff)) this.buffer = stuff.concat(this.buffer);else this.buffer.splice(0, 0, \"\" + stuff);\n\t\t\t\treturn this;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"clear\",\n\t\t\tvalue: function clear() {\n\t\t\t\tthis.buffer = [];\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"removeLast\",\n\t\t\tvalue: function removeLast() {\n\t\t\t\tthis.buffer.pop();\n\t\t\t\treturn this;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"toString\",\n\t\t\tvalue: function toString(sep) {\n\t\t\t\tif (!sep) sep = '';\n\t\t\t\treturn this.buffer.join(sep);\n\t\t\t}\n\t\t}]);\n\t\n\t\treturn StringBuffer;\n\t}();\n\t\n\texports.default = StringBuffer;\n\n/***/ }),\n/* 9 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t\tvalue: true\n\t});\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tvar _Point = __webpack_require__(3);\n\t\n\tvar _Point2 = _interopRequireDefault(_Point);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tvar Line = function () {\n\t\tfunction Line(start, end) {\n\t\t\t_classCallCheck(this, Line);\n\t\n\t\t\tthis.start = start;\n\t\t\tthis.end = end;\n\t\t}\n\t\n\t\t/**\n\t  * Calculate the length of this line\n\t  */\n\t\n\t\n\t\t_createClass(Line, [{\n\t\t\tkey: 'length',\n\t\t\tvalue: function length() {\n\t\t\t\treturn this.start.distance(this.end);\n\t\t\t}\n\t\n\t\t\t/**\n\t   * Calculate the distance of this line to the point.\n\t   */\n\t\n\t\t}, {\n\t\t\tkey: 'distance',\n\t\t\tvalue: function distance(pt) {\n\t\t\t\tvar x = this.start.distance(pt);\n\t\t\t\tif (x == 0) return 0;\n\t\n\t\t\t\tvar l = this.length();\n\t\t\t\tvar cosa = new _Point2.default((this.end.x - this.start.x) / l, (this.end.y - this.start.y) / l).dotProduct(new _Point2.default(pt.x / x, pt.y / x));\n\t\n\t\t\t\treturn x * Math.sqrt(1 - cosa * cosa);\n\t\t\t}\n\t\n\t\t\t/**\n\t   * Function: intersection\n\t   *\n\t   * Returns the intersection of two lines as an <mxPoint>.\n\t   *\n\t   * Parameters:\n\t   *\n\t   * x0 - X-coordinate of the first line's startpoint.\n\t   * y0 - X-coordinate of the first line's startpoint.\n\t   * x1 - X-coordinate of the first line's endpoint.\n\t   * y1 - Y-coordinate of the first line's endpoint.\n\t   * x2 - X-coordinate of the second line's startpoint.\n\t   * y2 - Y-coordinate of the second line's startpoint.\n\t   * x3 - X-coordinate of the second line's endpoint.\n\t   * y3 - Y-coordinate of the second line's endpoint.\n\t   */\n\t\n\t\t}, {\n\t\t\tkey: 'toString',\n\t\t\tvalue: function toString() {\n\t\t\t\treturn 'Line:{start=' + this.start + ';end=' + this.end + '}';\n\t\t\t}\n\t\t}], [{\n\t\t\tkey: 'intersection',\n\t\t\tvalue: function intersection(x0, y0, x1, y1, x2, y2, x3, y3) {\n\t\t\t\tvar denom = (y3 - y2) * (x1 - x0) - (x3 - x2) * (y1 - y0);\n\t\t\t\tvar nume_a = (x3 - x2) * (y0 - y2) - (y3 - y2) * (x0 - x2);\n\t\t\t\tvar nume_b = (x1 - x0) * (y0 - y2) - (y1 - y0) * (x0 - x2);\n\t\n\t\t\t\tvar ua = nume_a / denom;\n\t\t\t\tvar ub = nume_b / denom;\n\t\n\t\t\t\tif (ua >= 0.0 && ua <= 1.0 && ub >= 0.0 && ub <= 1.0) {\n\t\t\t\t\t// Get the intersection point\n\t\t\t\t\tvar intersectionX = x0 + ua * (x1 - x0);\n\t\t\t\t\tvar intersectionY = y0 + ua * (y1 - y0);\n\t\n\t\t\t\t\treturn new _Point2.default(intersectionX, intersectionY);\n\t\t\t\t}\n\t\n\t\t\t\t// No intersection\n\t\t\t\treturn null;\n\t\t\t}\n\t\t}]);\n\t\n\t\treturn Line;\n\t}();\n\t\n\texports.default = Line;\n\n/***/ }),\n/* 10 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t\tvalue: true\n\t});\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tvar _Shape2 = __webpack_require__(6);\n\t\n\tvar _Shape3 = _interopRequireDefault(_Shape2);\n\t\n\tvar _Point = __webpack_require__(3);\n\t\n\tvar _Point2 = _interopRequireDefault(_Point);\n\t\n\tvar _Rectangle = __webpack_require__(4);\n\t\n\tvar _Rectangle2 = _interopRequireDefault(_Rectangle);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\t\n\tfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\t\n\tvar Ellipse = function (_Shape) {\n\t\t_inherits(Ellipse, _Shape);\n\t\n\t\tfunction Ellipse() {\n\t\t\t_classCallCheck(this, Ellipse);\n\t\n\t\t\treturn _possibleConstructorReturn(this, (Ellipse.__proto__ || Object.getPrototypeOf(Ellipse)).apply(this, arguments));\n\t\t}\n\t\n\t\t_createClass(Ellipse, [{\n\t\t\tkey: \"toString\",\n\t\t\tvalue: function toString() {\n\t\t\t\treturn 'Ellipse:{x=' + this.x + ';y=' + this.y + ';width=' + this.width + ';height=' + this.height + '}';\n\t\t\t}\n\t\t}], [{\n\t\t\tkey: \"getPerimeter\",\n\t\t\tvalue: function getPerimeter(rect, pt) {\n\t\t\t\tvar orthogonal = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;\n\t\n\t\t\t\tvar a = rect.width / 2;\n\t\t\t\tvar b = rect.height / 2;\n\t\t\t\tvar cx = rect.x;\n\t\t\t\tvar cy = rect.y;\n\t\t\t\tvar px = pt.x;\n\t\t\t\tvar py = pt.y;\n\t\n\t\t\t\t// Calculates straight line equation through\n\t\t\t\t// point and ellipse center y = d * x + h\n\t\t\t\tvar dx = parseInt(px - cx);\n\t\t\t\tvar dy = parseInt(py - cy);\n\t\n\t\t\t\tvar tx = void 0,\n\t\t\t\t    ty = void 0;\n\t\n\t\t\t\tif (dx == 0 && dy != 0) {\n\t\t\t\t\treturn new _Point2.default(cx, cy + b * dy / Math.abs(dy));\n\t\t\t\t} else if (dx == 0 && dy == 0) {\n\t\t\t\t\treturn new _Point2.default(px, py);\n\t\t\t\t}\n\t\n\t\t\t\t// Calculates intersection\n\t\t\t\tvar d = dy / dx;\n\t\t\t\tvar h = cy - d * cx;\n\t\t\t\tvar e = a * a * d * d + b * b;\n\t\t\t\tvar f = -2 * cx * e;\n\t\t\t\tvar g = a * a * d * d * cx * cx + b * b * cx * cx - a * a * b * b;\n\t\t\t\tvar det = Math.sqrt(f * f - 4 * e * g);\n\t\n\t\t\t\t// Two solutions (perimeter points)\n\t\t\t\tvar xout1 = (-f + det) / (2 * e);\n\t\t\t\tvar xout2 = (-f - det) / (2 * e);\n\t\t\t\tvar yout1 = d * xout1 + h;\n\t\t\t\tvar yout2 = d * xout2 + h;\n\t\t\t\tvar dist1 = Math.sqrt(Math.pow(xout1 - px, 2) + Math.pow(yout1 - py, 2));\n\t\t\t\tvar dist2 = Math.sqrt(Math.pow(xout2 - px, 2) + Math.pow(yout2 - py, 2));\n\t\n\t\t\t\t// Correct solution\n\t\t\t\tvar xout = 0;\n\t\t\t\tvar yout = 0;\n\t\n\t\t\t\tif (dist1 < dist2) {\n\t\t\t\t\txout = xout1;\n\t\t\t\t\tyout = yout1;\n\t\t\t\t} else {\n\t\t\t\t\txout = xout2;\n\t\t\t\t\tyout = yout2;\n\t\t\t\t}\n\t\n\t\t\t\tvar p = new _Point2.default(xout, yout);\n\t\t\t\tvar dir = _Rectangle2.default.getDirection(rect, p, orthogonal);\n\t\t\t\tif (orthogonal) {\n\t\t\t\t\tif (dir.x == -1) {\n\t\t\t\t\t\treturn { point: new _Point2.default(cx - a, cy), direction: dir };\n\t\t\t\t\t}\n\t\t\t\t\tif (dir.x == 1) {\n\t\t\t\t\t\treturn { point: new _Point2.default(cx + a, cy), direction: dir };\n\t\t\t\t\t}\n\t\t\t\t\tif (dir.y == -1) {\n\t\t\t\t\t\treturn { point: new _Point2.default(cx, cy - b), direction: dir };\n\t\t\t\t\t}\n\t\t\t\t\tif (dir.y == 1) {\n\t\t\t\t\t\treturn { point: new _Point2.default(cx, cy + b), direction: dir };\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn { point: p, direction: dir };\n\t\t\t}\n\t\t}]);\n\t\n\t\treturn Ellipse;\n\t}(_Shape3.default);\n\t\n\texports.default = Ellipse;\n\n/***/ }),\n/* 11 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t\tvalue: true\n\t});\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tvar _Shape2 = __webpack_require__(6);\n\t\n\tvar _Shape3 = _interopRequireDefault(_Shape2);\n\t\n\tvar _Point = __webpack_require__(3);\n\t\n\tvar _Point2 = _interopRequireDefault(_Point);\n\t\n\tvar _Line = __webpack_require__(9);\n\t\n\tvar _Line2 = _interopRequireDefault(_Line);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\t\n\tfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\t\n\tvar Rhombus = function (_Shape) {\n\t\t_inherits(Rhombus, _Shape);\n\t\n\t\tfunction Rhombus() {\n\t\t\t_classCallCheck(this, Rhombus);\n\t\n\t\t\treturn _possibleConstructorReturn(this, (Rhombus.__proto__ || Object.getPrototypeOf(Rhombus)).apply(this, arguments));\n\t\t}\n\t\n\t\t_createClass(Rhombus, [{\n\t\t\tkey: \"toString\",\n\t\t\tvalue: function toString() {\n\t\t\t\treturn 'Rhombus:{x=' + this.x + ';y=' + this.y + ';width=' + this.width + ';height=' + this.height + '}';\n\t\t\t}\n\t\t}], [{\n\t\t\tkey: \"getPerimeter\",\n\t\t\tvalue: function getPerimeter(rect, pt) {\n\t\t\t\tvar orthogonal = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;\n\t\n\t\t\t\tvar w = rect.width;\n\t\t\t\tvar h = rect.height;\n\t\t\t\tvar cx = rect.x;\n\t\t\t\tvar cy = rect.y;\n\t\t\t\tvar x = cx - w / 2;\n\t\t\t\tvar y = cy - h / 2;\n\t\n\t\t\t\tvar px = pt.x;\n\t\t\t\tvar py = pt.y;\n\t\n\t\t\t\t// Special case for intersecting the diamond's corners\n\t\t\t\tif (cx === px) {\n\t\t\t\t\tif (cy > py) {\n\t\t\t\t\t\treturn { point: new _Point2.default(cx, y), direction: _Point2.default.S };\n\t\t\t\t\t\t// top\n\t\t\t\t\t} else {\n\t\t\t\t\t\treturn { point: new _Point2.default(cx, y + h), direction: _Point2.default.N };\n\t\t\t\t\t\t// bottom\n\t\t\t\t\t}\n\t\t\t\t} else if (cy === py) {\n\t\t\t\t\tif (cx > px) {\n\t\t\t\t\t\treturn { point: new _Point2.default(x, cy), direction: _Point2.default.E };\n\t\t\t\t\t\t// left\n\t\t\t\t\t} else {\n\t\t\t\t\t\treturn { point: new _Point2.default(x + w, cy), direction: _Point2.default.W };\n\t\t\t\t\t\t// right\n\t\t\t\t\t}\n\t\t\t\t}\n\t\n\t\t\t\tvar tx = cx;\n\t\t\t\tvar ty = cy;\n\t\n\t\t\t\tif (orthogonal) {\n\t\t\t\t\tif (px >= x && px <= x + w) {\n\t\t\t\t\t\ttx = px;\n\t\t\t\t\t} else if (py >= y && py <= y + h) {\n\t\t\t\t\t\tty = py;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\n\t\t\t\tvar p = void 0,\n\t\t\t\t    dir = void 0;\n\t\t\t\t// TODO direction calculation is not quite right.\n\t\t\t\t// In which quadrant will the intersection be?\n\t\t\t\t// set the slope and offset of the border line accordingly\n\t\t\t\tif (px < cx) {\n\t\t\t\t\tif (py < cy) {\n\t\t\t\t\t\tp = _Line2.default.intersection(px, py, tx, ty, cx, y, x, cy);\n\t\t\t\t\t\tdir = _Point2.default.S;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tp = _Line2.default.intersection(px, py, tx, ty, cx, y + h, x, cy);\n\t\t\t\t\t\tdir = _Point2.default.N;\n\t\t\t\t\t}\n\t\t\t\t} else if (py < cy) {\n\t\t\t\t\tp = _Line2.default.intersection(px, py, tx, ty, cx, y, x + w, cy);\n\t\t\t\t\tdir = _Point2.default.E;\n\t\t\t\t} else {\n\t\t\t\t\tp = _Line2.default.intersection(px, py, tx, ty, cx, y + h, x + w, cy);\n\t\t\t\t\tdir = _Point2.default.W;\n\t\t\t\t}\n\t\t\t\treturn { point: p, direction: dir };\n\t\t\t}\n\t\t}]);\n\t\n\t\treturn Rhombus;\n\t}(_Shape3.default);\n\t\n\texports.default = Rhombus;\n\n/***/ }),\n/* 12 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t\tvalue: true\n\t});\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tvar _lodash = __webpack_require__(5);\n\t\n\tvar _lodash2 = _interopRequireDefault(_lodash);\n\t\n\tvar _Point = __webpack_require__(3);\n\t\n\tvar _Point2 = _interopRequireDefault(_Point);\n\t\n\tvar _Utils = __webpack_require__(2);\n\t\n\tvar _Utils2 = _interopRequireDefault(_Utils);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\t\n\tfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tvar defaultConfig = {\n\t\ttype: \"direct\",\n\t\tshowGauge: true,\n\t\torthogonal: false\n\t};\n\t\n\tvar defaultGeometry = {\n\t\twidth: 0,\n\t\theight: 0,\n\t\tanchorX: 0,\n\t\tanchorY: 0,\n\t\toffsetX: 0,\n\t\toffsetY: 0\n\t};\n\t\n\tvar linkTypes = {};\n\t\n\tvar Link = function () {\n\t\tfunction Link(terminalVisual) {\n\t\t\tvar shapeConfig = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n\t\t\tvar startMarker = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : null;\n\t\t\tvar endMarker = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : null;\n\t\n\t\t\t_classCallCheck(this, Link);\n\t\n\t\t\tthis.start = terminalVisual[0].point;\n\t\t\tthis.end = terminalVisual[1].point;\n\t\t\tthis.startNormal = terminalVisual[0].direction;\n\t\t\tthis.endNormal = terminalVisual[1].direction;\n\t\t\tthis.startMarker = startMarker;\n\t\t\tthis.endMarker = endMarker;\n\t\t\t_lodash2.default.assign(this, shapeConfig);\n\t\t}\n\t\n\t\t_createClass(Link, [{\n\t\t\tkey: \"render\",\n\t\t\tvalue: function render(view) {\n\t\t\t\treturn view.renderLink(this);\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"getRelativePosition\",\n\t\n\t\n\t\t\t/**\n\t   * Calculate the position where to put decorators or label..\n\t   *\n\t   * @param geometry: defines how far along the edge should the point be placed.\n\t   * @return *[] the relative position.\n\t   */\n\t\t\tvalue: function getRelativePosition(geometry) {\n\t\t\t\tif (_lodash2.default.isNumber(geometry)) geometry = { x: geometry };\n\t\t\t\tgeometry = _lodash2.default.defaults(geometry, defaultGeometry);\n\t\t\t\tvar p = geometry.x,\n\t\t\t\t    l = this.length;\n\t\t\t\tif (Math.abs(p) <= 1) p *= l;\n\t\t\t\tif (p < 0) p = l + p;\n\t\t\t\tif (p > l) p = l;\n\t\n\t\t\t\tvar points = this.points,\n\t\t\t\t    d = void 0,\n\t\t\t\t    point = void 0,\n\t\t\t\t    dir = void 0;\n\t\t\t\tfor (var i = 0; i < points.length - 1; i++) {\n\t\t\t\t\td = points[i].distance(points[i + 1]);\n\t\t\t\t\tif (p <= d) {\n\t\t\t\t\t\t// we've located the line segment.\n\t\t\t\t\t\tpoint = points[i].clone();\n\t\t\t\t\t\tdir = point.getDirection(points[i + 1]);\n\t\t\t\t\t\tpoint.translate(dir.getScaled(p));\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\tp -= d;\n\t\t\t\t}\n\t\n\t\t\t\t// return the last point.\n\t\t\t\tif (!point) point = points[points.length - 1];\n\t\t\t\treturn _Utils2.default.offsetPosition([point.x, point.y], geometry);\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"toString\",\n\t\t\tvalue: function toString() {\n\t\t\t\treturn 'Link';\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"points\",\n\t\t\tget: function get() {\n\t\t\t\treturn null;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"controlPts\",\n\t\t\tget: function get() {\n\t\t\t\treturn null;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"length\",\n\t\t\tget: function get() {\n\t\t\t\tvar points = this.points;\n\t\t\t\tvar i = void 0,\n\t\t\t\t    l = 0;\n\t\t\t\tfor (i = 0; i < points.length - 1; i++) {\n\t\t\t\t\tl += points[i].distance(points[i + 1]);\n\t\t\t\t}return l;\n\t\t\t}\n\t\t}], [{\n\t\t\tkey: \"getLink\",\n\t\t\tvalue: function getLink(terminalVisual) {\n\t\t\t\tvar shapeConfig = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n\t\t\t\tvar startMarker = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : null;\n\t\t\t\tvar endMarker = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : null;\n\t\n\t\t\t\tshapeConfig = _lodash2.default.defaultsDeep(shapeConfig, defaultConfig);\n\t\t\t\tvar linkClass = linkTypes[shapeConfig.type];\n\t\t\t\tif (linkClass) return new linkClass(terminalVisual, shapeConfig, startMarker, endMarker);\n\t\t\t\tconsole.log('link type not supported: ' + shapeConfig.type);\n\t\t\t\treturn null;\n\t\t\t}\n\t\t}]);\n\t\n\t\treturn Link;\n\t}();\n\t\n\tvar DirectLink = function (_Link) {\n\t\t_inherits(DirectLink, _Link);\n\t\n\t\tfunction DirectLink() {\n\t\t\t_classCallCheck(this, DirectLink);\n\t\n\t\t\treturn _possibleConstructorReturn(this, (DirectLink.__proto__ || Object.getPrototypeOf(DirectLink)).apply(this, arguments));\n\t\t}\n\t\n\t\t_createClass(DirectLink, [{\n\t\t\tkey: \"points\",\n\t\t\tget: function get() {\n\t\t\t\treturn [this.start, this.end];\n\t\t\t}\n\t\t}]);\n\t\n\t\treturn DirectLink;\n\t}(Link);\n\t\n\tvar BezierLink = function (_Link2) {\n\t\t_inherits(BezierLink, _Link2);\n\t\n\t\tfunction BezierLink() {\n\t\t\t_classCallCheck(this, BezierLink);\n\t\n\t\t\treturn _possibleConstructorReturn(this, (BezierLink.__proto__ || Object.getPrototypeOf(BezierLink)).apply(this, arguments));\n\t\t}\n\t\n\t\t_createClass(BezierLink, [{\n\t\t\tkey: \"getRelativePosition\",\n\t\t\tvalue: function getRelativePosition(geometry) {\n\t\t\t\tif (_lodash2.default.isNumber(geometry)) geometry = { x: geometry };\n\t\t\t\tgeometry = _lodash2.default.defaults(geometry, defaultGeometry);\n\t\t\t\tvar p = geometry.x,\n\t\t\t\t    l = this.length;\n\t\t\t\tif (Math.abs(p) > 1) p /= l;\n\t\t\t\tif (p < 0) p++;\n\t\t\t\tif (p > 1) p--;\n\t\n\t\t\t\tvar pts = this.points;\n\t\t\t\tvar ctrlpts = this.controlPts;\n\t\t\t\tvar p1 = pts[0];\n\t\t\t\tvar p2 = ctrlpts[1][0];\n\t\t\t\tvar p3 = ctrlpts[1][1];\n\t\t\t\tvar p4 = pts[1];\n\t\n\t\t\t\tvar point = [(1 - p) * (1 - p) * (1 - p) * p1.x + 3 * p * (1 - p) * (1 - p) * p2.x + 3 * p * p * (1 - p) * p3.x + p * p * p * p4.x, (1 - p) * (1 - p) * (1 - p) * p1.y + 3 * p * (1 - p) * (1 - p) * p2.y + 3 * p * p * (1 - p) * p3.y + p * p * p * p4.y];\n\t\t\t\treturn _Utils2.default.offsetPosition([point.x, point.y], geometry);\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"points\",\n\t\t\tget: function get() {\n\t\t\t\treturn [this.start, this.end];\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"controlPts\",\n\t\t\tget: function get() {\n\t\t\t\tvar s = this.points[0],\n\t\t\t\t    e = this.points[1];\n\t\t\t\tvar pts = [];\n\t\t\t\tpts[0] = null;\n\t\t\t\tpts[1] = [];\n\t\t\t\tif (this.startNormal.x === 0) {\n\t\t\t\t\tpts[1][0] = new _Point2.default(s.x, (s.y + e.y) / 2);\n\t\t\t\t} else {\n\t\t\t\t\tpts[1][0] = new _Point2.default((s.x + e.x) / 2, s.y);\n\t\t\t\t}\n\t\t\t\tif (this.endNormal.x === 0) {\n\t\t\t\t\tpts[1][1] = new _Point2.default(e.x, (s.y + e.y) / 2);\n\t\t\t\t} else {\n\t\t\t\t\tpts[1][1] = new _Point2.default((s.x + e.x) / 2, e.y);\n\t\t\t\t}\n\t\t\t\treturn pts;\n\t\t\t}\n\t\t}]);\n\t\n\t\treturn BezierLink;\n\t}(Link);\n\t\n\tvar EntityRelations = function (_Link3) {\n\t\t_inherits(EntityRelations, _Link3);\n\t\n\t\tfunction EntityRelations() {\n\t\t\t_classCallCheck(this, EntityRelations);\n\t\n\t\t\treturn _possibleConstructorReturn(this, (EntityRelations.__proto__ || Object.getPrototypeOf(EntityRelations)).apply(this, arguments));\n\t\t}\n\t\n\t\t_createClass(EntityRelations, [{\n\t\t\tkey: \"points\",\n\t\t\tget: function get() {\n\t\t\t\tvar source = Port.getBounds(edge, true);\n\t\t\t\tvar target = Port.getBounds(edge, false);\n\t\t\t\tvar isSourceLeft = target.right() < source.x;\n\t\t\t\tvar isTargetLeft = source.right() < target.x;\n\t\t\t\tvar result = [];\n\t\n\t\t\t\tvar x0 = isSourceLeft ? source.x : source.x + source.width;\n\t\t\t\tvar y0 = source.getCenterY();\n\t\t\t\tresult.push(new _Point2.default(x0, y0));\n\t\n\t\t\t\tvar xe = isTargetLeft ? target.x : target.x + target.width;\n\t\t\t\tvar ye = target.getCenterY();\n\t\n\t\t\t\tvar seg = this.segment;\n\t\n\t\t\t\tvar dx = isSourceLeft ? -seg : seg;\n\t\t\t\tvar dep = new _Point2.default(x0 + dx, y0);\n\t\n\t\t\t\tdx = isTargetLeft ? -seg : seg;\n\t\t\t\tvar arr = new _Point2.default(xe + dx, ye);\n\t\n\t\t\t\t// Adds intermediate points if both go out on same side\n\t\t\t\tif (isSourceLeft == isTargetLeft) {\n\t\t\t\t\tvar x = isSourceLeft ? Math.min(x0, xe) - seg : Math.max(x0, xe) + seg;\n\t\n\t\t\t\t\tresult.push(new _Point2.default(x, y0));\n\t\t\t\t\tresult.push(new _Point2.default(x, ye));\n\t\t\t\t} else if (dep.x < arr.x == isSourceLeft) {\n\t\t\t\t\tvar midY = y0 + (ye - y0) / 2;\n\t\n\t\t\t\t\tresult.push(dep);\n\t\t\t\t\tresult.push(new _Point2.default(dep.x, midY));\n\t\t\t\t\tresult.push(new _Point2.default(arr.x, midY));\n\t\t\t\t\tresult.push(arr);\n\t\t\t\t} else {\n\t\t\t\t\tresult.push(dep);\n\t\t\t\t\tresult.push(arr);\n\t\t\t\t}\n\t\n\t\t\t\tresult.push(new _Point2.default(xe, ye));\n\t\t\t\treturn result;\n\t\t\t}\n\t\t}]);\n\t\n\t\treturn EntityRelations;\n\t}(Link);\n\t\n\tvar Manhattan = function (_Link4) {\n\t\t_inherits(Manhattan, _Link4);\n\t\n\t\tfunction Manhattan(terminalVisual, shapeConfig, startMarker, endMarker) {\n\t\t\t_classCallCheck(this, Manhattan);\n\t\n\t\t\tshapeConfig = _lodash2.default.defaults(shapeConfig, {\n\t\t\t\tMIN_BUFFER: 10,\n\t\t\t\tautoRoute: false,\n\t\t\t\trandomNoise: 0,\n\t\t\t\tstep: 1,\n\t\t\t\tmaxChannelWidth: 100\n\t\t\t});\n\t\t\treturn _possibleConstructorReturn(this, (Manhattan.__proto__ || Object.getPrototypeOf(Manhattan)).call(this, terminalVisual, shapeConfig, startMarker, endMarker));\n\t\t}\n\t\n\t\t_createClass(Manhattan, [{\n\t\t\tkey: \"autoRoute\",\n\t\n\t\n\t\t\t/**\n\t   * Automatically route the connection to avoid intersections with other vertices.\n\t   */\n\t\t\tvalue: function autoRoute(pts, container, boxes, startBox, endBox) {\n\t\t\t\tvar side = void 0,\n\t\t\t\t    side2 = void 0,\n\t\t\t\t    d = void 0,\n\t\t\t\t    box = void 0,\n\t\t\t\t    intersect = void 0,\n\t\t\t\t    j = void 0;\n\t\t\t\tvar channel = void 0,\n\t\t\t\t    channel2 = void 0,\n\t\t\t\t    pt = void 0,\n\t\t\t\t    dir = void 0;\n\t\n\t\t\t\tvar startPadding = 0,\n\t\t\t\t    endPadding = void 0;\n\t\t\t\t// first get the start and end channel\n\t\t\t\tbox = boxes[endBox];\n\t\t\t\tpt = pts[pts.length - 2];\n\t\t\t\tif (pt.y < box.y) side = 1;else if (pt.y > box.y + box.height) side = 3;else if (pt.x < box.x) side = 0;else side = 2;\n\t\t\t\tchannel = _getChannel(container, endBox, boxes, side);\n\t\t\t\tendPadding = channel.horizontal ? (channel.right - channel.left) / 2 : (channel.bottom - channel.top) / 2;\n\t\n\t\t\t\tfor (var i = 0; i < pts.length - 1; i++) {\n\t\t\t\t\tif (pts[i + 1].x == pts[i].x && pts[i + 1].y == pts[i].y) continue;\n\t\t\t\t\tintersect = _getFirstIntersection(pts, i, boxes, startBox, endBox);\n\t\t\t\t\tif (!intersect) continue;\n\t\t\t\t\tj = intersect[0];\n\t\t\t\t\tside = intersect[1];\n\t\t\t\t\tbox = boxes[j];\n\t\t\t\t\tchannel = _getChannel(container, j, boxes, side);\n\t\t\t\t\tswitch (side) {\n\t\t\t\t\t\tcase 0:\n\t\t\t\t\t\tcase 2:\n\t\t\t\t\t\t\tpt = new _Point2.default((channel.right + channel.left) / 2, pts[i].y);\n\t\t\t\t\t\t\tdir = _getRouteTendency(pts, i, pt, box, side);\n\t\t\t\t\t\t\tside2 = dir < 0 ? 1 : 3;\n\t\t\t\t\t\t\tchannel2 = _getChannel(container, j, boxes, side2);\n\t\t\t\t\t\t\t// if the previous point is in the channel2, use that point instead of center of the channel.\n\t\t\t\t\t\t\tif (i > 1 && pts[i - 2].y == pts[i - 1].y && pts[i - 1].y > channel2.top && pts[i - 1].y < channel2.bottom) d = pts[i - 1].y - pt.y;else if (i < pts.length - 3 && pts[i + 2].y == pts[i + 3].y && pts[i + 2].y > channel2.top && pts[i + 2].y < channel2.bottom) d = pts[i + 2].y - pt.y;else d = (channel2.bottom + channel2.top) / 2 - pt.y;\n\t\t\t\t\t\t\t// check if we need this pt.\n\t\t\t\t\t\t\tif (side == 0 && pt.x <= pts[i].x || side == 2 && pt.x >= pts[i].x) pt = null;else if (i > 0) {\n\t\t\t\t\t\t\t\t// see if we can push the line out to where we started.\n\t\t\t\t\t\t\t\tif (!_hasIntersection([new _Point2.default(pts[i].x, pts[i].y), new _Point2.default(pts[i].x, pts[i].y + d), new _Point2.default(pt.x, pt.y + d)], boxes)) pt = null;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 1:\n\t\t\t\t\t\tcase 3:\n\t\t\t\t\t\t\tpt = new _Point2.default(pts[i].x, (channel.bottom + channel.top) / 2);\n\t\t\t\t\t\t\tdir = _getRouteTendency(pts, i, pt, box, side);\n\t\t\t\t\t\t\tside2 = dir < 0 ? 0 : 2;\n\t\t\t\t\t\t\tchannel2 = _getChannel(container, j, boxes, side2);\n\t\t\t\t\t\t\t// if the previous point is in the channel2, use that point instead of center of the channel.\n\t\t\t\t\t\t\tif (i > 1 && pts[i - 2].x == pts[i - 1].x && pts[i - 1].x > channel2.left && pts[i - 1].x < channel2.right) d = pts[i - 1].x - pt.x;else if (i < pts.length - 3 && pts[i + 2].x == pts[i + 3].x && pts[i + 2].x > channel2.left && pts[i + 2].x < channel2.right) d = pts[i + 2].x - pt.x;else d = (channel2.right + channel2.left) / 2 - pt.x;\n\t\t\t\t\t\t\t// check if we need this pt.\n\t\t\t\t\t\t\tif (side == 1 && pt.y <= pts[i].y || side == 3 && pt.y >= pts[i].y) pt = null;else if (i > 0) {\n\t\t\t\t\t\t\t\t// see if we can push the line out to where we started.\n\t\t\t\t\t\t\t\tif (!_hasIntersection([new _Point2.default(pts[i].x, pts[i].y), new _Point2.default(pts[i].x + d, pts[i].y), new _Point2.default(pt.x + d, pt.y)], boxes)) pt = null;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 4:\n\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\t\t\t\t\t// max points.\n\t\t\t\t\tif (i > 20) return;\n\t\t\t\t\tif (pt && (pt.x != pts[i].x || pt.y != pts[i].y)) {\n\t\t\t\t\t\tpts.splice(i + 1, 0, pt);\n\t\t\t\t\t\t_moveSegment(pts, i + 1, d, startPadding, endPadding);\n\t\t\t\t\t\ti++;\n\t\t\t\t\t} else _moveSegment(pts, i, d, startPadding, endPadding);\n\t\t\t\t}\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"_getRouteTendency\",\n\t\t\tvalue: function _getRouteTendency(pts, i, breakPt, box, side) {\n\t\t\t\tvar dir = void 0;\n\t\t\t\tvar p = void 0;\n\t\t\t\tswitch (side) {\n\t\t\t\t\tcase 0:\n\t\t\t\t\tcase 2:\n\t\t\t\t\t\tp = \"y\";\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 1:\n\t\t\t\t\tcase 3:\n\t\t\t\t\t\tp = \"x\";\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\t//first try the breakpt.\n\t\t\t\tdir = _getRouteDirection(breakPt, pts[pts.length - 1])[p];\n\t\t\t\tif (dir == 0) {\n\t\t\t\t\tdir = -_getRouteDirection(pts[0], pts[pts.length - 1])[p];\n\t\t\t\t\tif (dir == 0) {\n\t\t\t\t\t\tif (breakPt[p] < box.getCenter()[p]) dir = -1;else dir = 1;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn dir;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"_getChannel\",\n\t\t\tvalue: function _getChannel(container, index, boxes, side) {\n\t\t\t\tvar maxChannelWidth = this.maxChannelWidth;\n\t\t\t\tvar box1 = boxes[index],\n\t\t\t\t    box2 = void 0;\n\t\t\t\tvar pt = void 0,\n\t\t\t\t    i = void 0;\n\t\t\t\tvar channel = {},\n\t\t\t\t    l = void 0,\n\t\t\t\t    t = void 0,\n\t\t\t\t    b = void 0,\n\t\t\t\t    r = void 0;\n\t\t\t\tswitch (side) {\n\t\t\t\t\tcase 0:\n\t\t\t\t\t\tpt = box1.getLeft();\n\t\t\t\t\t\tchannel.right = pt.x;\n\t\t\t\t\t\tchannel.horizontal = false;\n\t\t\t\t\t\tfor (i = 0; i < boxes.length; i++) {\n\t\t\t\t\t\t\tif (i == index) continue;\n\t\t\t\t\t\t\tr = boxes[i].getRight().x;\n\t\t\t\t\t\t\tif (r >= pt.x) continue;\n\t\t\t\t\t\t\tif (!channel.left || channel.left < r) channel.left = r;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (!channel.left) {\n\t\t\t\t\t\t\tchannel.left = container.getLeft().x;\n\t\t\t\t\t\t\tif (channel.right - channel.left > maxChannelWidth) channel.left = channel.right - maxChannelWidth;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tfor (i = 0; i < boxes.length; i++) {\n\t\t\t\t\t\t\tif (i == index) continue;\n\t\t\t\t\t\t\tbox2 = boxes[i];\n\t\t\t\t\t\t\tb = box2.getBottom().y;\n\t\t\t\t\t\t\tt = box2.getTop().y;\n\t\t\t\t\t\t\tif (b < pt.y && box2.getRight() > channel.left && box2.getLeft() < channel.right) {\n\t\t\t\t\t\t\t\tif (!channel.top || channel.top < b) channel.top = b;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (t > pt.y && box2.getRight() > channel.left && box2.getLeft() < channel.right) {\n\t\t\t\t\t\t\t\tif (!channel.bottom || channel.bottom > t) channel.bottom = t;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (!channel.top) channel.top = container.getTop().y;\n\t\t\t\t\t\tif (!channel.bottom) channel.bottom = container.getBottom().y;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 1:\n\t\t\t\t\t\tpt = box1.getTop();\n\t\t\t\t\t\tchannel.horizontal = true;\n\t\t\t\t\t\tchannel.bottom = pt.y;\n\t\t\t\t\t\tfor (i = 0; i < boxes.length; i++) {\n\t\t\t\t\t\t\tif (i == index) continue;\n\t\t\t\t\t\t\tb = boxes[i].getBottom().y;\n\t\t\t\t\t\t\tif (b >= pt.y) continue;\n\t\t\t\t\t\t\tif (!channel.top || channel.top < b) channel.top = b;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (!channel.top) {\n\t\t\t\t\t\t\tchannel.top = container.getTop().y;\n\t\t\t\t\t\t\tif (channel.bottom - channel.top > maxChannelWidth) channel.top = channel.bottom - maxChannelWidth;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tfor (i = 0; i < boxes.length; i++) {\n\t\t\t\t\t\t\tif (i == index) continue;\n\t\t\t\t\t\t\tbox2 = boxes[i];\n\t\t\t\t\t\t\tl = box2.getLeft().x;\n\t\t\t\t\t\t\tr = box2.getRight().x;\n\t\t\t\t\t\t\tif (r < pt.x && box2.getBottom() > channel.top && box2.getTop() < channel.bottom) {\n\t\t\t\t\t\t\t\tif (!channel.left || channel.left < r) channel.left = r;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (l > pt.x && box2.getBottom() > channel.top && box2.getTop() < channel.bottom) {\n\t\t\t\t\t\t\t\tif (!channel.right || channel.right > l) channel.right = l;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (!channel.left) channel.left = container.getLeft().x;\n\t\t\t\t\t\tif (!channel.right) channel.right = container.getRight().x;\n\t\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 2:\n\t\t\t\t\t\tpt = box1.getRight();\n\t\t\t\t\t\tchannel.horizontal = false;\n\t\t\t\t\t\tchannel.left = pt.x;\n\t\t\t\t\t\tfor (i = 0; i < boxes.length; i++) {\n\t\t\t\t\t\t\tif (i == index) continue;\n\t\t\t\t\t\t\tl = boxes[i].getLeft().x;\n\t\t\t\t\t\t\tif (l <= pt.x) continue;\n\t\t\t\t\t\t\tif (!channel.right || channel.right > l) channel.right = l;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (!channel.right) {\n\t\t\t\t\t\t\tchannel.right = container.getRight().x;\n\t\t\t\t\t\t\tif (channel.right - channel.left > maxChannelWidth) channel.right = channel.left + maxChannelWidth;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tfor (i = 0; i < boxes.length; i++) {\n\t\t\t\t\t\t\tif (i == index) continue;\n\t\t\t\t\t\t\tbox2 = boxes[i];\n\t\t\t\t\t\t\tb = box2.getBottom().y;\n\t\t\t\t\t\t\tt = box2.getTop().y;\n\t\t\t\t\t\t\tif (b < pt.y && box2.getRight() > channel.left && box2.getLeft() < channel.right) {\n\t\t\t\t\t\t\t\tif (!channel.top || channel.top < b) channel.top = b;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (t > pt.y && box2.getRight() > channel.left && box2.getLeft() < channel.right) {\n\t\t\t\t\t\t\t\tif (!channel.bottom || channel.bottom > t) channel.bottom = t;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (!channel.top) channel.top = container.getTop().y;\n\t\t\t\t\t\tif (!channel.bottom) channel.bottom = container.getBottom().y;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 3:\n\t\t\t\t\t\tpt = box1.getBottom();\n\t\t\t\t\t\tchannel.horizontal = true;\n\t\t\t\t\t\tchannel.top = pt.y;\n\t\t\t\t\t\tfor (i = 0; i < boxes.length; i++) {\n\t\t\t\t\t\t\tif (i == index) continue;\n\t\t\t\t\t\t\tbox2 = boxes[i];\n\t\t\t\t\t\t\tif (box2.getTop().y <= pt.y) continue;\n\t\t\t\t\t\t\tif (!channel.bottom || channel.bottom > box2.getTop().y) channel.bottom = box2.getTop().y;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (!channel.bottom) {\n\t\t\t\t\t\t\tchannel.bottom = container.getBottom().y;\n\t\t\t\t\t\t\tif (channel.bottom - channel.top > maxChannelWidth) channel.bottom = channel.top + maxChannelWidth;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tfor (i = 0; i < boxes.length; i++) {\n\t\t\t\t\t\t\tif (i == index) continue;\n\t\t\t\t\t\t\tbox2 = boxes[i];\n\t\t\t\t\t\t\tl = box2.getLeft().x;\n\t\t\t\t\t\t\tr = box2.getRight().x;\n\t\t\t\t\t\t\tif (r < pt.x && box2.getBottom() > channel.top && box2.getTop() < channel.bottom) {\n\t\t\t\t\t\t\t\tif (!channel.left || channel.left < r) channel.left = r;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (l > pt.x && box2.getBottom() > channel.top && box2.getTop() < channel.bottom) {\n\t\t\t\t\t\t\t\tif (!channel.right || channel.right > l) channel.right = l;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (!channel.left) channel.left = container.getLeft().x;\n\t\t\t\t\t\tif (!channel.right) channel.right = container.getRight().x;\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\treturn channel;\n\t\t\t}\n\t\n\t\t\t/**\n\t   * Move a line segment by a specified distance.\n\t   *\n\t   * @param pts the list of points.\n\t   * @param i the index of the segment.\n\t   * @param d the distance to move.\n\t   * @param startPadding\n\t   * @param endPadding\n\t   */\n\t\n\t\t}, {\n\t\t\tkey: \"_moveSegment\",\n\t\t\tvalue: function _moveSegment(pts, i, d, startPadding, endPadding) {\n\t\t\t\t// first check if we need to add new line segments.\n\t\t\t\tvar dir = void 0,\n\t\t\t\t    l = void 0,\n\t\t\t\t    pt = void 0;\n\t\t\t\tif (i == 0) {\n\t\t\t\t\t// we need to break off the segment, since we can't change the starting point.\n\t\t\t\t\tdir = pts[0].getDirection(pts[1]);\n\t\t\t\t\tif (!startPadding) startPadding = this.MIN_BUFFER;\n\t\t\t\t\tl = Math.min(startPadding, pts[0].distance(pts[1]) / 2);\n\t\t\t\t\tpt = pts[0].getTranslated(dir.scale(l));\n\t\t\t\t\tpts.splice(1, 0, pt);\n\t\t\t\t\tthis._moveSegment(pts, i + 1, d);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tif (i == pts.length - 2) {\n\t\t\t\t\t// we need to break off the segment, since we can't change the end point.\n\t\t\t\t\tdir = pts[pts.length - 1].getDirection(pts[pts.length - 2]);\n\t\t\t\t\tif (!endPadding) endPadding = this.MIN_BUFFER;\n\t\t\t\t\tl = Math.min(endPadding, pts[pts.length - 1].distance(pts[pts.length - 2]) / 2);\n\t\t\t\t\tpt = pts[pts.length - 1].getTranslated(dir.scale(l));\n\t\t\t\t\tpts.splice(pts.length - 1, 0, pt);\n\t\t\t\t\tthis._moveSegment(pts, i, d);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\n\t\t\t\tif (pts[i].y == pts[i + 1].y) {\n\t\t\t\t\tif (i > 0 && pts[i - 1].y == pts[i].y) {\n\t\t\t\t\t\tpts.splice(i + 1, 0, pts[i].clone());\n\t\t\t\t\t\ti++;\n\t\t\t\t\t}\n\t\t\t\t\tif (i < pts.length - 2 && pts[i + 1].y == pts[i + 2].y) pts.splice(i + 1, 0, pts[i + 1].clone());\n\t\t\t\t\tpts[i].y += d;\n\t\t\t\t\tpts[i + 1].y += d;\n\t\t\t\t} else {\n\t\t\t\t\tif (i > 0 && pts[i - 1].x == pts[i].x) {\n\t\t\t\t\t\tpts.splice(i + 1, 0, pts[i].clone());\n\t\t\t\t\t\ti++;\n\t\t\t\t\t}\n\t\t\t\t\tif (i < pts.length - 2 && pts[i + 1].x == pts[i + 2].x) pts.splice(i + 1, 0, pts[i + 1].clone());\n\t\t\t\t\tpts[i].x += d;\n\t\t\t\t\tpts[i + 1].x += d;\n\t\t\t\t}\n\t\t\t}\n\t\n\t\t\t/**\n\t   * This method will merge the redundant segments.\n\t   */\n\t\n\t\t}, {\n\t\t\tkey: \"points\",\n\t\t\tget: function get() {\n\t\t\t\tvar pos = Manhattan.route(this.start, this.end, this.startNormal, this.endNormal, this.MIN_BUFFER);\n\t\t\t\tif (this.autoRoute) {\n\t\t\t\t\tthis._mergeSegments(pos);\n\t\t\t\t\tvar boxes = [],\n\t\t\t\t\t    node = void 0,\n\t\t\t\t\t    startBox = void 0,\n\t\t\t\t\t    endBox = void 0;\n\t\t\t\t\tvar container = edge.source.getCommonAncestor(edge.target);\n\t\t\t\t\tvar childNodes = container.getDescendants();\n\t\t\t\t\tvar index = 0;\n\t\t\t\t\tfor (var i = 0; i < childNodes.length; i++) {\n\t\t\t\t\t\tnode = childNodes[i];\n\t\t\t\t\t\t// Do not include source or target ancestors in routing.\n\t\t\t\t\t\tif (node.excludeFromRouting(edge) || node.isAncestor(edge.source) || node.isAncestor(edge.target)) continue;\n\t\t\t\t\t\tif (node == edge.source) startBox = index;\n\t\t\t\t\t\tif (node == edge.target) endBox = index;\n\t\t\t\t\t\tboxes.push(node.getBounds(document));\n\t\t\t\t\t\tindex++;\n\t\t\t\t\t}\n\t\t\t\t\tif (boxes.length > 1) this.autoRoute(pos, container.getBounds(document), boxes, startBox, endBox);\n\t\t\t\t}\n\t\t\t\tManhattan._mergeSegments(pos);\n\t\t\t\tif (this.randomNoise && pos.length > 3) {\n\t\t\t\t\tfor (var _i = 1; _i < pos.length - 2; _i++) {\n\t\t\t\t\t\tvar range = this.randomNoise / this.step;\n\t\t\t\t\t\tvar randomNumber = Math.floor(Math.random() * range * 2 - range + 1) * this.step;\n\t\t\t\t\t\tthis._moveSegment(pos, _i, randomNumber, 1, 1);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn pos;\n\t\t\t}\n\t\n\t\t\t//New function for finding route\n\t\n\t\t}], [{\n\t\t\tkey: \"route\",\n\t\t\tvalue: function route(start, end, startNormal, endNormal, buffer) {\n\t\t\t\tvar startBuffer = new _Point2.default(start.x + startNormal.x * buffer, start.y + startNormal.y * buffer);\n\t\t\t\tvar endBuffer = new _Point2.default(end.x + endNormal.x * buffer, end.y + endNormal.y * buffer);\n\t\t\t\tvar startBufferNormal = void 0,\n\t\t\t\t    endBufferNormal = void 0;\n\t\t\t\tvar pts = void 0;\n\t\t\t\tif (startNormal.x != 0) {\n\t\t\t\t\tif ((endBuffer.x - startBuffer.x) / startNormal.x > 0) {\n\t\t\t\t\t\tstartBufferNormal = startNormal;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tstartBufferNormal = new _Point2.default(0, endBuffer.y >= startBuffer.y ? 1 : -1);\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tif ((endBuffer.y - startBuffer.y) / startNormal.y > 0) {\n\t\t\t\t\t\tstartBufferNormal = startNormal;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tstartBufferNormal = new _Point2.default(endBuffer.x >= startBuffer.x ? 1 : -1, 0);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (endNormal.x != 0) {\n\t\t\t\t\tif ((startBuffer.x - endBuffer.x) / endNormal.x > 0) {\n\t\t\t\t\t\tendBufferNormal = endNormal;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tendBufferNormal = new _Point2.default(0, startBuffer.y >= endBuffer.y ? 1 : -1);\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tif ((startBuffer.y - endBuffer.y) / endNormal.y > 0) {\n\t\t\t\t\t\tendBufferNormal = endNormal;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tendBufferNormal = new _Point2.default(startBuffer.x >= endBuffer.x ? 1 : -1, 0);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\n\t\t\t\tif (startBufferNormal.dotProduct(endBufferNormal) == 0) {\n\t\t\t\t\tvar middle = startBufferNormal.x == 0 ? new _Point2.default(startBuffer.x, endBuffer.y) : new _Point2.default(endBuffer.x, startBuffer.y);\n\t\t\t\t\tpts = [start, startBuffer, middle, endBuffer, end];\n\t\t\t\t} else if (startBufferNormal.dotProduct(endBufferNormal) < 0) {\n\t\t\t\t\tif (startBufferNormal.x == 0) {\n\t\t\t\t\t\tpts = [start, startBuffer, new _Point2.default(startBuffer.x, (start.y + end.y) / 2), new _Point2.default(endBuffer.x, (start.y + end.y) / 2), endBuffer, end];\n\t\t\t\t\t} else {\n\t\t\t\t\t\tpts = [start, startBuffer, new _Point2.default((start.x + end.x) / 2, startBuffer.y), new _Point2.default((start.x + end.x) / 2, endBuffer.y), endBuffer, end];\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tpts = [start, startBuffer, new _Point2.default(startBuffer.x + startBufferNormal.x * buffer, startBuffer.y + startBufferNormal.y * buffer), new _Point2.default(endBuffer.x + endBufferNormal.x * buffer, endBuffer.y + endBufferNormal.y * buffer), endBuffer, end];\n\t\t\t\t}\n\t\n\t\t\t\tvar prunePts = [];\n\t\t\t\tprunePts[0] = pts[0];\n\t\t\t\tfor (var i = 1; i < pts.length - 1; i++) {\n\t\t\t\t\tif (pts[i].x == pts[i - 1].x && pts[i].x == pts[i + 1].x || pts[i].y == pts[i - 1].y && pts[i].y == pts[i + 1].y) {\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\t\t\t\t\tprunePts.push(pts[i]);\n\t\t\t\t}\n\t\t\t\tprunePts.push(pts[pts.length - 1]);\n\t\t\t\treturn prunePts;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"_hasIntersection\",\n\t\t\tvalue: function _hasIntersection(pts, boxes) {\n\t\t\t\tfor (var i = 0; i < pts.length - 1; i++) {\n\t\t\t\t\tfor (var j = 0; j < boxes.length; j++) {\n\t\t\t\t\t\tif (boxes[j].detectIntersection(pts[i], pts[i + 1]) >= 0) return true;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"_getFirstIntersection\",\n\t\t\tvalue: function _getFirstIntersection(pts, i, boxes, startBox, endBox) {\n\t\t\t\tvar box = void 0,\n\t\t\t\t    side = void 0,\n\t\t\t\t    savedIndex = null,\n\t\t\t\t    savedSide = null;\n\t\t\t\tfor (var j = 0; j < boxes.length; j++) {\n\t\t\t\t\tif (i == 0 && j == startBox || i == pts.length - 2 && j == endBox) continue;\n\t\t\t\t\tbox = boxes[j];\n\t\t\t\t\tside = box.detectIntersection(pts[i], pts[i + 1]);\n\t\t\t\t\tif (side >= 0) {\n\t\t\t\t\t\tif (savedIndex == null) {\n\t\t\t\t\t\t\tsavedIndex = j;\n\t\t\t\t\t\t\tsavedSide = side;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tif (boxes[savedIndex].distance(pts[i]) > box.distance(pts[i])) {\n\t\t\t\t\t\t\t\tsavedIndex = j;\n\t\t\t\t\t\t\t\tsavedSide = side;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (savedIndex != null) return [savedIndex, savedSide];\n\t\t\t\treturn null;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"_getRouteDirection\",\n\t\t\tvalue: function _getRouteDirection(pt1, pt2) {\n\t\t\t\tif (pt1.x == pt2.x) {\n\t\t\t\t\tif (pt1.y < pt2.y) return _Point2.default.S;\n\t\t\t\t\treturn _Point2.default.N;\n\t\t\t\t} else if (pt1.y == pt2.y) {\n\t\t\t\t\tif (pt1.x < pt2.x) return _Point2.default.E;\n\t\t\t\t\treturn _Point2.default.W;\n\t\t\t\t} else if (pt1.x < pt2.x) {\n\t\t\t\t\tif (pt1.y < pt2.y) return _Point2.default.SE;\n\t\t\t\t\treturn _Point2.default.NE;\n\t\t\t\t} else {\n\t\t\t\t\tif (pt1.y < pt2.y) return _Point2.default.SW;\n\t\t\t\t\treturn _Point2.default.NW;\n\t\t\t\t}\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"_mergeSegments\",\n\t\t\tvalue: function _mergeSegments(pts) {\n\t\t\t\tvar h1 = pts[pts.length - 1].y == pts[pts.length - 2].y;\n\t\t\t\tvar h2 = void 0;\n\t\t\t\tfor (var i = pts.length - 2; i >= 1; i--) {\n\t\t\t\t\th2 = pts[i].y == pts[i - 1].y;\n\t\t\t\t\tif (h2 == h1 || pts[i].equals(pts[i - 1])) pts.splice(i, 1);else h1 = !h1;\n\t\t\t\t}\n\t\t\t}\n\t\t}]);\n\t\n\t\treturn Manhattan;\n\t}(Link);\n\t\n\tlinkTypes['direct'] = DirectLink;\n\tlinkTypes['bezier'] = BezierLink;\n\tlinkTypes['entityRelations'] = EntityRelations;\n\tlinkTypes['manhattan'] = Manhattan;\n\t\n\texports.default = Link;\n\n/***/ }),\n/* 13 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\tvar __WEBPACK_AMD_DEFINE_FACTORY__, __WEBPACK_AMD_DEFINE_RESULT__;/*!\n\t  * Bean - copyright (c) Jacob Thornton 2011-2012\n\t  * https://github.com/fat/bean\n\t  * MIT license\n\t  */\n\t(function (name, context, definition) {\n\t  if (typeof module != 'undefined' && module.exports) module.exports = definition()\n\t  else if (true) !(__WEBPACK_AMD_DEFINE_FACTORY__ = (definition), __WEBPACK_AMD_DEFINE_RESULT__ = (typeof __WEBPACK_AMD_DEFINE_FACTORY__ === 'function' ? (__WEBPACK_AMD_DEFINE_FACTORY__.call(exports, __webpack_require__, exports, module)) : __WEBPACK_AMD_DEFINE_FACTORY__), __WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__))\n\t  else context[name] = definition()\n\t})('bean', this, function (name, context) {\n\t  name    = name    || 'bean'\n\t  context = context || this\n\t\n\t  var win            = window\n\t    , old            = context[name]\n\t    , namespaceRegex = /[^\\.]*(?=\\..*)\\.|.*/\n\t    , nameRegex      = /\\..*/\n\t    , addEvent       = 'addEventListener'\n\t    , removeEvent    = 'removeEventListener'\n\t    , doc            = document || {}\n\t    , root           = doc.documentElement || {}\n\t    , W3C_MODEL      = root[addEvent]\n\t    , eventSupport   = W3C_MODEL ? addEvent : 'attachEvent'\n\t    , ONE            = {} // singleton for quick matching making add() do one()\n\t\n\t    , slice          = Array.prototype.slice\n\t    , str2arr        = function (s, d) { return s.split(d || ' ') }\n\t    , isString       = function (o) { return typeof o == 'string' }\n\t    , isFunction     = function (o) { return typeof o == 'function' }\n\t\n\t      // events that we consider to be 'native', anything not in this list will\n\t      // be treated as a custom event\n\t    , standardNativeEvents =\n\t        'click dblclick mouseup mousedown contextmenu '                  + // mouse buttons\n\t        'mousewheel mousemultiwheel DOMMouseScroll '                     + // mouse wheel\n\t        'mouseover mouseout mousemove selectstart selectend '            + // mouse movement\n\t        'keydown keypress keyup '                                        + // keyboard\n\t        'orientationchange '                                             + // mobile\n\t        'focus blur change reset select submit '                         + // form elements\n\t        'load unload beforeunload resize move DOMContentLoaded '         + // window\n\t        'readystatechange message '                                      + // window\n\t        'error abort scroll '                                              // misc\n\t      // element.fireEvent('onXYZ'... is not forgiving if we try to fire an event\n\t      // that doesn't actually exist, so make sure we only do these on newer browsers\n\t    , w3cNativeEvents =\n\t        'show '                                                          + // mouse buttons\n\t        'input invalid '                                                 + // form elements\n\t        'touchstart touchmove touchend touchcancel '                     + // touch\n\t        'gesturestart gesturechange gestureend '                         + // gesture\n\t        'textinput '                                                     + // TextEvent\n\t        'readystatechange pageshow pagehide popstate '                   + // window\n\t        'hashchange offline online '                                     + // window\n\t        'afterprint beforeprint '                                        + // printing\n\t        'dragstart dragenter dragover dragleave drag drop dragend '      + // dnd\n\t        'loadstart progress suspend emptied stalled loadmetadata '       + // media\n\t        'loadeddata canplay canplaythrough playing waiting seeking '     + // media\n\t        'seeked ended durationchange timeupdate play pause ratechange '  + // media\n\t        'volumechange cuechange '                                        + // media\n\t        'checking noupdate downloading cached updateready obsolete '       // appcache\n\t\n\t      // convert to a hash for quick lookups\n\t    , nativeEvents = (function (hash, events, i) {\n\t        for (i = 0; i < events.length; i++) events[i] && (hash[events[i]] = 1)\n\t        return hash\n\t      }({}, str2arr(standardNativeEvents + (W3C_MODEL ? w3cNativeEvents : ''))))\n\t\n\t      // custom events are events that we *fake*, they are not provided natively but\n\t      // we can use native events to generate them\n\t    , customEvents = (function () {\n\t        var isAncestor = 'compareDocumentPosition' in root\n\t              ? function (element, container) {\n\t                  return container.compareDocumentPosition && (container.compareDocumentPosition(element) & 16) === 16\n\t                }\n\t              : 'contains' in root\n\t                ? function (element, container) {\n\t                    container = container.nodeType === 9 || container === window ? root : container\n\t                    return container !== element && container.contains(element)\n\t                  }\n\t                : function (element, container) {\n\t                    while (element = element.parentNode) if (element === container) return 1\n\t                    return 0\n\t                  }\n\t          , check = function (event) {\n\t              var related = event.relatedTarget\n\t              return !related\n\t                ? related == null\n\t                : (related !== this && related.prefix !== 'xul' && !/document/.test(this.toString())\n\t                    && !isAncestor(related, this))\n\t            }\n\t\n\t        return {\n\t            mouseenter: { base: 'mouseover', condition: check }\n\t          , mouseleave: { base: 'mouseout', condition: check }\n\t          , mousewheel: { base: /Firefox/.test(navigator.userAgent) ? 'DOMMouseScroll' : 'mousewheel' }\n\t        }\n\t      }())\n\t\n\t      // we provide a consistent Event object across browsers by taking the actual DOM\n\t      // event object and generating a new one from its properties.\n\t    , Event = (function () {\n\t            // a whitelist of properties (for different event types) tells us what to check for and copy\n\t        var commonProps  = str2arr('altKey attrChange attrName bubbles cancelable ctrlKey currentTarget ' +\n\t              'detail eventPhase getModifierState isTrusted metaKey relatedNode relatedTarget shiftKey '  +\n\t              'srcElement target timeStamp type view which propertyName')\n\t          , mouseProps   = commonProps.concat(str2arr('button buttons clientX clientY dataTransfer '      +\n\t              'fromElement offsetX offsetY pageX pageY screenX screenY toElement'))\n\t          , mouseWheelProps = mouseProps.concat(str2arr('wheelDelta wheelDeltaX wheelDeltaY wheelDeltaZ ' +\n\t              'axis')) // 'axis' is FF specific\n\t          , keyProps     = commonProps.concat(str2arr('char charCode key keyCode keyIdentifier '          +\n\t              'keyLocation location'))\n\t          , textProps    = commonProps.concat(str2arr('data'))\n\t          , touchProps   = commonProps.concat(str2arr('touches targetTouches changedTouches scale rotation'))\n\t          , messageProps = commonProps.concat(str2arr('data origin source'))\n\t          , stateProps   = commonProps.concat(str2arr('state'))\n\t          , overOutRegex = /over|out/\n\t            // some event types need special handling and some need special properties, do that all here\n\t          , typeFixers   = [\n\t                { // key events\n\t                    reg: /key/i\n\t                  , fix: function (event, newEvent) {\n\t                      newEvent.keyCode = event.keyCode || event.which\n\t                      return keyProps\n\t                    }\n\t                }\n\t              , { // mouse events\n\t                    reg: /click|mouse(?!(.*wheel|scroll))|menu|drag|drop/i\n\t                  , fix: function (event, newEvent, type) {\n\t                      newEvent.rightClick = event.which === 3 || event.button === 2\n\t                      newEvent.pos = { x: 0, y: 0 }\n\t                      if (event.pageX || event.pageY) {\n\t                        newEvent.clientX = event.pageX\n\t                        newEvent.clientY = event.pageY\n\t                      } else if (event.clientX || event.clientY) {\n\t                        newEvent.clientX = event.clientX + doc.body.scrollLeft + root.scrollLeft\n\t                        newEvent.clientY = event.clientY + doc.body.scrollTop + root.scrollTop\n\t                      }\n\t                      if (overOutRegex.test(type)) {\n\t                        newEvent.relatedTarget = event.relatedTarget\n\t                          || event[(type == 'mouseover' ? 'from' : 'to') + 'Element']\n\t                      }\n\t                      return mouseProps\n\t                    }\n\t                }\n\t              , { // mouse wheel events\n\t                    reg: /mouse.*(wheel|scroll)/i\n\t                  , fix: function () { return mouseWheelProps }\n\t                }\n\t              , { // TextEvent\n\t                    reg: /^text/i\n\t                  , fix: function () { return textProps }\n\t                }\n\t              , { // touch and gesture events\n\t                    reg: /^touch|^gesture/i\n\t                  , fix: function () { return touchProps }\n\t                }\n\t              , { // message events\n\t                    reg: /^message$/i\n\t                  , fix: function () { return messageProps }\n\t                }\n\t              , { // popstate events\n\t                    reg: /^popstate$/i\n\t                  , fix: function () { return stateProps }\n\t                }\n\t              , { // everything else\n\t                    reg: /.*/\n\t                  , fix: function () { return commonProps }\n\t                }\n\t            ]\n\t          , typeFixerMap = {} // used to map event types to fixer functions (above), a basic cache mechanism\n\t\n\t          , Event = function (event, element, isNative) {\n\t              if (!arguments.length) return\n\t              event = event || ((element.ownerDocument || element.document || element).parentWindow || win).event\n\t              this.originalEvent = event\n\t              this.isNative       = isNative\n\t              this.isBean         = true\n\t\n\t              if (!event) return\n\t\n\t              var type   = event.type\n\t                , target = event.target || event.srcElement\n\t                , i, l, p, props, fixer\n\t\n\t              this.target = target && target.nodeType === 3 ? target.parentNode : target\n\t\n\t              if (isNative) { // we only need basic augmentation on custom events, the rest expensive & pointless\n\t                fixer = typeFixerMap[type]\n\t                if (!fixer) { // haven't encountered this event type before, map a fixer function for it\n\t                  for (i = 0, l = typeFixers.length; i < l; i++) {\n\t                    if (typeFixers[i].reg.test(type)) { // guaranteed to match at least one, last is .*\n\t                      typeFixerMap[type] = fixer = typeFixers[i].fix\n\t                      break\n\t                    }\n\t                  }\n\t                }\n\t\n\t                props = fixer(event, this, type)\n\t                for (i = props.length; i--;) {\n\t                  if (!((p = props[i]) in this) && p in event) this[p] = event[p]\n\t                }\n\t              }\n\t            }\n\t\n\t        // preventDefault() and stopPropagation() are a consistent interface to those functions\n\t        // on the DOM, stop() is an alias for both of them together\n\t        Event.prototype.preventDefault = function () {\n\t          if (this.originalEvent.preventDefault) this.originalEvent.preventDefault()\n\t          else this.originalEvent.returnValue = false\n\t        }\n\t        Event.prototype.stopPropagation = function () {\n\t          if (this.originalEvent.stopPropagation) this.originalEvent.stopPropagation()\n\t          else this.originalEvent.cancelBubble = true\n\t        }\n\t        Event.prototype.stop = function () {\n\t          this.preventDefault()\n\t          this.stopPropagation()\n\t          this.stopped = true\n\t        }\n\t        // stopImmediatePropagation() has to be handled internally because we manage the event list for\n\t        // each element\n\t        // note that originalElement may be a Bean#Event object in some situations\n\t        Event.prototype.stopImmediatePropagation = function () {\n\t          if (this.originalEvent.stopImmediatePropagation) this.originalEvent.stopImmediatePropagation()\n\t          this.isImmediatePropagationStopped = function () { return true }\n\t        }\n\t        Event.prototype.isImmediatePropagationStopped = function () {\n\t          return this.originalEvent.isImmediatePropagationStopped && this.originalEvent.isImmediatePropagationStopped()\n\t        }\n\t        Event.prototype.clone = function (currentTarget) {\n\t          //TODO: this is ripe for optimisation, new events are *expensive*\n\t          // improving this will speed up delegated events\n\t          var ne = new Event(this, this.element, this.isNative)\n\t          ne.currentTarget = currentTarget\n\t          return ne\n\t        }\n\t\n\t        return Event\n\t      }())\n\t\n\t      // if we're in old IE we can't do onpropertychange on doc or win so we use doc.documentElement for both\n\t    , targetElement = function (element, isNative) {\n\t        return !W3C_MODEL && !isNative && (element === doc || element === win) ? root : element\n\t      }\n\t\n\t      /**\n\t        * Bean maintains an internal registry for event listeners. We don't touch elements, objects\n\t        * or functions to identify them, instead we store everything in the registry.\n\t        * Each event listener has a RegEntry object, we have one 'registry' for the whole instance.\n\t        */\n\t    , RegEntry = (function () {\n\t        // each handler is wrapped so we can handle delegation and custom events\n\t        var wrappedHandler = function (element, fn, condition, args) {\n\t            var call = function (event, eargs) {\n\t                  return fn.apply(element, args ? slice.call(eargs, event ? 0 : 1).concat(args) : eargs)\n\t                }\n\t              , findTarget = function (event, eventElement) {\n\t                  return fn.__beanDel ? fn.__beanDel.ft(event.target, element) : eventElement\n\t                }\n\t              , handler = condition\n\t                  ? function (event) {\n\t                      var target = findTarget(event, this) // deleated event\n\t                      if (condition.apply(target, arguments)) {\n\t                        if (event) event.currentTarget = target\n\t                        return call(event, arguments)\n\t                      }\n\t                    }\n\t                  : function (event) {\n\t                      if (fn.__beanDel) event = event.clone(findTarget(event)) // delegated event, fix the fix\n\t                      return call(event, arguments)\n\t                    }\n\t            handler.__beanDel = fn.__beanDel\n\t            return handler\n\t          }\n\t\n\t        , RegEntry = function (element, type, handler, original, namespaces, args, root) {\n\t            var customType     = customEvents[type]\n\t              , isNative\n\t\n\t            if (type == 'unload') {\n\t              // self clean-up\n\t              handler = once(removeListener, element, type, handler, original)\n\t            }\n\t\n\t            if (customType) {\n\t              if (customType.condition) {\n\t                handler = wrappedHandler(element, handler, customType.condition, args)\n\t              }\n\t              type = customType.base || type\n\t            }\n\t\n\t            this.isNative      = isNative = nativeEvents[type] && !!element[eventSupport]\n\t            this.customType    = !W3C_MODEL && !isNative && type\n\t            this.element       = element\n\t            this.type          = type\n\t            this.original      = original\n\t            this.namespaces    = namespaces\n\t            this.eventType     = W3C_MODEL || isNative ? type : 'propertychange'\n\t            this.target        = targetElement(element, isNative)\n\t            this[eventSupport] = !!this.target[eventSupport]\n\t            this.root          = root\n\t            this.handler       = wrappedHandler(element, handler, null, args)\n\t          }\n\t\n\t        // given a list of namespaces, is our entry in any of them?\n\t        RegEntry.prototype.inNamespaces = function (checkNamespaces) {\n\t          var i, j, c = 0\n\t          if (!checkNamespaces) return true\n\t          if (!this.namespaces) return false\n\t          for (i = checkNamespaces.length; i--;) {\n\t            for (j = this.namespaces.length; j--;) {\n\t              if (checkNamespaces[i] == this.namespaces[j]) c++\n\t            }\n\t          }\n\t          return checkNamespaces.length === c\n\t        }\n\t\n\t        // match by element, original fn (opt), handler fn (opt)\n\t        RegEntry.prototype.matches = function (checkElement, checkOriginal, checkHandler) {\n\t          return this.element === checkElement &&\n\t            (!checkOriginal || this.original === checkOriginal) &&\n\t            (!checkHandler || this.handler === checkHandler)\n\t        }\n\t\n\t        return RegEntry\n\t      }())\n\t\n\t    , registry = (function () {\n\t        // our map stores arrays by event type, just because it's better than storing\n\t        // everything in a single array.\n\t        // uses '$' as a prefix for the keys for safety and 'r' as a special prefix for\n\t        // rootListeners so we can look them up fast\n\t        var map = {}\n\t\n\t          // generic functional search of our registry for matching listeners,\n\t          // `fn` returns false to break out of the loop\n\t          , forAll = function (element, type, original, handler, root, fn) {\n\t              var pfx = root ? 'r' : '$'\n\t              if (!type || type == '*') {\n\t                // search the whole registry\n\t                for (var t in map) {\n\t                  if (t.charAt(0) == pfx) {\n\t                    forAll(element, t.substr(1), original, handler, root, fn)\n\t                  }\n\t                }\n\t              } else {\n\t                var i = 0, l, list = map[pfx + type], all = element == '*'\n\t                if (!list) return\n\t                for (l = list.length; i < l; i++) {\n\t                  if ((all || list[i].matches(element, original, handler)) && !fn(list[i], list, i, type)) return\n\t                }\n\t              }\n\t            }\n\t\n\t          , has = function (element, type, original, root) {\n\t              // we're not using forAll here simply because it's a bit slower and this\n\t              // needs to be fast\n\t              var i, list = map[(root ? 'r' : '$') + type]\n\t              if (list) {\n\t                for (i = list.length; i--;) {\n\t                  if (!list[i].root && list[i].matches(element, original, null)) return true\n\t                }\n\t              }\n\t              return false\n\t            }\n\t\n\t          , get = function (element, type, original, root) {\n\t              var entries = []\n\t              forAll(element, type, original, null, root, function (entry) {\n\t                return entries.push(entry)\n\t              })\n\t              return entries\n\t            }\n\t\n\t          , put = function (entry) {\n\t              var has = !entry.root && !this.has(entry.element, entry.type, null, false)\n\t                , key = (entry.root ? 'r' : '$') + entry.type\n\t              ;(map[key] || (map[key] = [])).push(entry)\n\t              return has\n\t            }\n\t\n\t          , del = function (entry) {\n\t              forAll(entry.element, entry.type, null, entry.handler, entry.root, function (entry, list, i) {\n\t                list.splice(i, 1)\n\t                entry.removed = true\n\t                if (list.length === 0) delete map[(entry.root ? 'r' : '$') + entry.type]\n\t                return false\n\t              })\n\t            }\n\t\n\t            // dump all entries, used for onunload\n\t          , entries = function () {\n\t              var t, entries = []\n\t              for (t in map) {\n\t                if (t.charAt(0) == '$') entries = entries.concat(map[t])\n\t              }\n\t              return entries\n\t            }\n\t\n\t        return { has: has, get: get, put: put, del: del, entries: entries }\n\t      }())\n\t\n\t      // we need a selector engine for delegated events, use querySelectorAll if it exists\n\t      // but for older browsers we need Qwery, Sizzle or similar\n\t    , selectorEngine\n\t    , setSelectorEngine = function (e) {\n\t        if (!arguments.length) {\n\t          selectorEngine = doc.querySelectorAll\n\t            ? function (s, r) {\n\t                return r.querySelectorAll(s)\n\t              }\n\t            : function () {\n\t                throw new Error('Bean: No selector engine installed') // eeek\n\t              }\n\t        } else {\n\t          selectorEngine = e\n\t        }\n\t      }\n\t\n\t      // we attach this listener to each DOM event that we need to listen to, only once\n\t      // per event type per DOM element\n\t    , rootListener = function (event, type) {\n\t        if (!W3C_MODEL && type && event && event.propertyName != '_on' + type) return\n\t\n\t        var listeners = registry.get(this, type || event.type, null, false)\n\t          , l = listeners.length\n\t          , i = 0\n\t\n\t        event = new Event(event, this, true)\n\t        if (type) event.type = type\n\t\n\t        // iterate through all handlers registered for this type, calling them unless they have\n\t        // been removed by a previous handler or stopImmediatePropagation() has been called\n\t        for (; i < l && !event.isImmediatePropagationStopped(); i++) {\n\t          if (!listeners[i].removed) listeners[i].handler.call(this, event)\n\t        }\n\t      }\n\t\n\t      // add and remove listeners to DOM elements\n\t    , listener = W3C_MODEL\n\t        ? function (element, type, add) {\n\t            // new browsers\n\t            element[add ? addEvent : removeEvent](type, rootListener, false)\n\t          }\n\t        : function (element, type, add, custom) {\n\t            // IE8 and below, use attachEvent/detachEvent and we have to piggy-back propertychange events\n\t            // to simulate event bubbling etc.\n\t            var entry\n\t            if (add) {\n\t              registry.put(entry = new RegEntry(\n\t                  element\n\t                , custom || type\n\t                , function (event) { // handler\n\t                    rootListener.call(element, event, custom)\n\t                  }\n\t                , rootListener\n\t                , null\n\t                , null\n\t                , true // is root\n\t              ))\n\t              if (custom && element['_on' + custom] == null) element['_on' + custom] = 0\n\t              entry.target.attachEvent('on' + entry.eventType, entry.handler)\n\t            } else {\n\t              entry = registry.get(element, custom || type, rootListener, true)[0]\n\t              if (entry) {\n\t                entry.target.detachEvent('on' + entry.eventType, entry.handler)\n\t                registry.del(entry)\n\t              }\n\t            }\n\t          }\n\t\n\t    , once = function (rm, element, type, fn, originalFn) {\n\t        // wrap the handler in a handler that does a remove as well\n\t        return function () {\n\t          fn.apply(this, arguments)\n\t          rm(element, type, originalFn)\n\t        }\n\t      }\n\t\n\t    , removeListener = function (element, orgType, handler, namespaces) {\n\t        var type     = orgType && orgType.replace(nameRegex, '')\n\t          , handlers = registry.get(element, type, null, false)\n\t          , removed  = {}\n\t          , i, l\n\t\n\t        for (i = 0, l = handlers.length; i < l; i++) {\n\t          if ((!handler || handlers[i].original === handler) && handlers[i].inNamespaces(namespaces)) {\n\t            // TODO: this is problematic, we have a registry.get() and registry.del() that\n\t            // both do registry searches so we waste cycles doing this. Needs to be rolled into\n\t            // a single registry.forAll(fn) that removes while finding, but the catch is that\n\t            // we'll be splicing the arrays that we're iterating over. Needs extra tests to\n\t            // make sure we don't screw it up. @rvagg\n\t            registry.del(handlers[i])\n\t            if (!removed[handlers[i].eventType] && handlers[i][eventSupport])\n\t              removed[handlers[i].eventType] = { t: handlers[i].eventType, c: handlers[i].type }\n\t          }\n\t        }\n\t        // check each type/element for removed listeners and remove the rootListener where it's no longer needed\n\t        for (i in removed) {\n\t          if (!registry.has(element, removed[i].t, null, false)) {\n\t            // last listener of this type, remove the rootListener\n\t            listener(element, removed[i].t, false, removed[i].c)\n\t          }\n\t        }\n\t      }\n\t\n\t      // set up a delegate helper using the given selector, wrap the handler function\n\t    , delegate = function (selector, fn) {\n\t        //TODO: findTarget (therefore $) is called twice, once for match and once for\n\t        // setting e.currentTarget, fix this so it's only needed once\n\t        var findTarget = function (target, root) {\n\t              var i, array = isString(selector) ? selectorEngine(selector, root) : selector\n\t              for (; target && target !== root; target = target.parentNode) {\n\t                for (i = array.length; i--;) {\n\t                  if (array[i] === target) return target\n\t                }\n\t              }\n\t            }\n\t          , handler = function (e) {\n\t              var match = findTarget(e.target, this)\n\t              if (match) fn.apply(match, arguments)\n\t            }\n\t\n\t        // __beanDel isn't pleasant but it's a private function, not exposed outside of Bean\n\t        handler.__beanDel = {\n\t            ft       : findTarget // attach it here for customEvents to use too\n\t          , selector : selector\n\t        }\n\t        return handler\n\t      }\n\t\n\t    , fireListener = W3C_MODEL ? function (isNative, type, element) {\n\t        // modern browsers, do a proper dispatchEvent()\n\t        var evt = doc.createEvent(isNative ? 'HTMLEvents' : 'UIEvents')\n\t        evt[isNative ? 'initEvent' : 'initUIEvent'](type, true, true, win, 1)\n\t        element.dispatchEvent(evt)\n\t      } : function (isNative, type, element) {\n\t        // old browser use onpropertychange, just increment a custom property to trigger the event\n\t        element = targetElement(element, isNative)\n\t        isNative ? element.fireEvent('on' + type, doc.createEventObject()) : element['_on' + type]++\n\t      }\n\t\n\t      /**\n\t        * Public API: off(), on(), add(), (remove()), one(), fire(), clone()\n\t        */\n\t\n\t      /**\n\t        * off(element[, eventType(s)[, handler ]])\n\t        */\n\t    , off = function (element, typeSpec, fn) {\n\t        var isTypeStr = isString(typeSpec)\n\t          , k, type, namespaces, i\n\t\n\t        if (isTypeStr && typeSpec.indexOf(' ') > 0) {\n\t          // off(el, 't1 t2 t3', fn) or off(el, 't1 t2 t3')\n\t          typeSpec = str2arr(typeSpec)\n\t          for (i = typeSpec.length; i--;)\n\t            off(element, typeSpec[i], fn)\n\t          return element\n\t        }\n\t\n\t        type = isTypeStr && typeSpec.replace(nameRegex, '')\n\t        if (type && customEvents[type]) type = customEvents[type].base\n\t\n\t        if (!typeSpec || isTypeStr) {\n\t          // off(el) or off(el, t1.ns) or off(el, .ns) or off(el, .ns1.ns2.ns3)\n\t          if (namespaces = isTypeStr && typeSpec.replace(namespaceRegex, '')) namespaces = str2arr(namespaces, '.')\n\t          removeListener(element, type, fn, namespaces)\n\t        } else if (isFunction(typeSpec)) {\n\t          // off(el, fn)\n\t          removeListener(element, null, typeSpec)\n\t        } else {\n\t          // off(el, { t1: fn1, t2, fn2 })\n\t          for (k in typeSpec) {\n\t            if (typeSpec.hasOwnProperty(k)) off(element, k, typeSpec[k])\n\t          }\n\t        }\n\t\n\t        return element\n\t      }\n\t\n\t      /**\n\t        * on(element, eventType(s)[, selector], handler[, args ])\n\t        */\n\t    , on = function(element, events, selector, fn) {\n\t        var originalFn, type, types, i, args, entry, first\n\t\n\t        //TODO: the undefined check means you can't pass an 'args' argument, fix this perhaps?\n\t        if (selector === undefined && typeof events == 'object') {\n\t          //TODO: this can't handle delegated events\n\t          for (type in events) {\n\t            if (events.hasOwnProperty(type)) {\n\t              on.call(this, element, type, events[type])\n\t            }\n\t          }\n\t          return\n\t        }\n\t\n\t        if (!isFunction(selector)) {\n\t          // delegated event\n\t          originalFn = fn\n\t          args       = slice.call(arguments, 4)\n\t          fn         = delegate(selector, originalFn, selectorEngine)\n\t        } else {\n\t          args       = slice.call(arguments, 3)\n\t          fn         = originalFn = selector\n\t        }\n\t\n\t        types = str2arr(events)\n\t\n\t        // special case for one(), wrap in a self-removing handler\n\t        if (this === ONE) {\n\t          fn = once(off, element, events, fn, originalFn)\n\t        }\n\t\n\t        for (i = types.length; i--;) {\n\t          // add new handler to the registry and check if it's the first for this element/type\n\t          first = registry.put(entry = new RegEntry(\n\t              element\n\t            , types[i].replace(nameRegex, '') // event type\n\t            , fn\n\t            , originalFn\n\t            , str2arr(types[i].replace(namespaceRegex, ''), '.') // namespaces\n\t            , args\n\t            , false // not root\n\t          ))\n\t          if (entry[eventSupport] && first) {\n\t            // first event of this type on this element, add root listener\n\t            listener(element, entry.eventType, true, entry.customType)\n\t          }\n\t        }\n\t\n\t        return element\n\t      }\n\t\n\t      /**\n\t        * add(element[, selector], eventType(s), handler[, args ])\n\t        *\n\t        * Deprecated: kept (for now) for backward-compatibility\n\t        */\n\t    , add = function (element, events, fn, delfn) {\n\t        return on.apply(\n\t            null\n\t          , !isString(fn)\n\t              ? slice.call(arguments)\n\t              : [ element, fn, events, delfn ].concat(arguments.length > 3 ? slice.call(arguments, 5) : [])\n\t        )\n\t      }\n\t\n\t      /**\n\t        * one(element, eventType(s)[, selector], handler[, args ])\n\t        */\n\t    , one = function () {\n\t        return on.apply(ONE, arguments)\n\t      }\n\t\n\t      /**\n\t        * fire(element, eventType(s)[, args ])\n\t        *\n\t        * The optional 'args' argument must be an array, if no 'args' argument is provided\n\t        * then we can use the browser's DOM event system, otherwise we trigger handlers manually\n\t        */\n\t    , fire = function (element, type, args) {\n\t        var types = str2arr(type)\n\t          , i, j, l, names, handlers\n\t\n\t        for (i = types.length; i--;) {\n\t          type = types[i].replace(nameRegex, '')\n\t          if (names = types[i].replace(namespaceRegex, '')) names = str2arr(names, '.')\n\t          if (!names && !args && element[eventSupport]) {\n\t            fireListener(nativeEvents[type], type, element)\n\t          } else {\n\t            // non-native event, either because of a namespace, arguments or a non DOM element\n\t            // iterate over all listeners and manually 'fire'\n\t            handlers = registry.get(element, type, null, false)\n\t            args = [false].concat(args)\n\t            for (j = 0, l = handlers.length; j < l; j++) {\n\t              if (handlers[j].inNamespaces(names)) {\n\t                handlers[j].handler.apply(element, args)\n\t              }\n\t            }\n\t          }\n\t        }\n\t        return element\n\t      }\n\t\n\t      /**\n\t        * clone(dstElement, srcElement[, eventType ])\n\t        *\n\t        * TODO: perhaps for consistency we should allow the same flexibility in type specifiers?\n\t        */\n\t    , clone = function (element, from, type) {\n\t        var handlers = registry.get(from, type, null, false)\n\t          , l = handlers.length\n\t          , i = 0\n\t          , args, beanDel\n\t\n\t        for (; i < l; i++) {\n\t          if (handlers[i].original) {\n\t            args = [ element, handlers[i].type ]\n\t            if (beanDel = handlers[i].handler.__beanDel) args.push(beanDel.selector)\n\t            args.push(handlers[i].original)\n\t            on.apply(null, args)\n\t          }\n\t        }\n\t        return element\n\t      }\n\t\n\t    , bean = {\n\t          'on'                : on\n\t        , 'add'               : add\n\t        , 'one'               : one\n\t        , 'off'               : off\n\t        , 'remove'            : off\n\t        , 'clone'             : clone\n\t        , 'fire'              : fire\n\t        , 'Event'             : Event\n\t        , 'setSelectorEngine' : setSelectorEngine\n\t        , 'noConflict'        : function () {\n\t            context[name] = old\n\t            return this\n\t          }\n\t      }\n\t\n\t  // for IE, clean up on unload to avoid leaks\n\t  if (win.attachEvent) {\n\t    var cleanup = function () {\n\t      var i, entries = registry.entries()\n\t      for (i in entries) {\n\t        if (entries[i].type && entries[i].type !== 'unload') off(entries[i].element, entries[i].type)\n\t      }\n\t      win.detachEvent('onunload', cleanup)\n\t      win.CollectGarbage && win.CollectGarbage()\n\t    }\n\t    win.attachEvent('onunload', cleanup)\n\t  }\n\t\n\t  // initialize selector engine to internal default (qSA or throw Error)\n\t  setSelectorEngine()\n\t\n\t  return bean\n\t});\n\n\n/***/ }),\n/* 14 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t\tvalue: true\n\t});\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tvar _lodash = __webpack_require__(5);\n\t\n\tvar _lodash2 = _interopRequireDefault(_lodash);\n\t\n\tvar _bean = __webpack_require__(13);\n\t\n\tvar _bean2 = _interopRequireDefault(_bean);\n\t\n\tvar _KeyUtils = __webpack_require__(15);\n\t\n\tvar KeyUtils = _interopRequireWildcard(_KeyUtils);\n\t\n\tvar _DomUtils = __webpack_require__(7);\n\t\n\tvar _DomUtils2 = _interopRequireDefault(_DomUtils);\n\t\n\tvar _StringBuffer = __webpack_require__(8);\n\t\n\tvar _StringBuffer2 = _interopRequireDefault(_StringBuffer);\n\t\n\tfunction _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj.default = obj; return newObj; } }\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tvar DEFAULTS = {\n\t\tstopPropagation: false\n\t};\n\t\n\t/**\n\t * The EventDispatcher is the central event management. It will monitor all events and translate it into the a higher\n\t * level events for consumption.\n\t */\n\t\n\tvar EventDispatcher = function () {\n\t\t/**\n\t  * Constructor\n\t  * @param root the root element that the manager will listen to.\n\t  * @param zoomScale\n\t  * @param config the configuraton for the event dispatcher.\n\t  */\n\t\tfunction EventDispatcher(root) {\n\t\t\tvar zoomScale = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : [0, Infinity];\n\t\t\tvar config = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n\t\n\t\t\t_classCallCheck(this, EventDispatcher);\n\t\n\t\t\tthis.root = root;\n\t\t\tthis.rootNS = root.getAttribute('ns') || 'root';\n\t\t\tthis.zoomScale = zoomScale;\n\t\t\t_lodash2.default.assign(this, DEFAULTS, config);\n\t\t\tthis.scale = 1.0;\n\t\t\tthis.listeners = {};\n\t\t\tthis.dragging = false;\n\t\t\tthis.handler = _lodash2.default.bind(this.handleEvent, this);\n\t\t\tthis.started = false;\n\t\n\t\t\t// Simulate mouseenter/mouseleave events\n\t\t\tthis.enterStack = [];\n\t\t}\n\t\n\t\t/**\n\t  * Start listening for events.\n\t  */\n\t\n\t\n\t\t_createClass(EventDispatcher, [{\n\t\t\tkey: \"start\",\n\t\t\tvalue: function start() {\n\t\t\t\tif (this.started) return;\n\t\t\t\t_bean2.default.on(this.root, 'mousedown mouseover mouseout mouseenter mouseleave dblclick click contextmenu mousewheel', this.handler);\n\t\t\t\tthis.startKeys();\n\t\t\t\tthis.started = true;\n\t\t\t}\n\t\n\t\t\t/**\n\t   * Stop listening for events.\n\t   */\n\t\n\t\t}, {\n\t\t\tkey: \"stop\",\n\t\t\tvalue: function stop() {\n\t\t\t\tif (!this.started) return;\n\t\t\t\t_bean2.default.off(this.root, 'mousedown mouseover mouseout mouseenter mouseleave dblclick click contextmenu mousewheel', this.handler);\n\t\t\t\tthis.stopKeys();\n\t\t\t\tthis.started = false;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"startKeys\",\n\t\t\tvalue: function startKeys() {\n\t\t\t\t_bean2.default.on(document, 'keydown keyup', this.handler);\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"stopKeys\",\n\t\t\tvalue: function stopKeys() {\n\t\t\t\t_bean2.default.off(document, 'keydown keyup', this.handler);\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"zoomIn\",\n\t\t\tvalue: function zoomIn() {\n\t\t\t\tthis.scale *= 1.25;\n\t\t\t\tthis.scale = Math.max(Math.min(this.zoomScale[1], this.scale), this.zoomScale[0]);\n\t\t\t\treturn this.scale;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"zoomOut\",\n\t\t\tvalue: function zoomOut() {\n\t\t\t\tthis.scale *= 0.8;\n\t\t\t\tthis.scale = Math.max(Math.min(this.zoomScale[1], this.scale), this.zoomScale[0]);\n\t\t\t\treturn this.scale;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"getEventInfo\",\n\t\t\tvalue: function getEventInfo(event) {\n\t\t\t\tvar target = event.target;\n\t\t\t\tvar buf = new _StringBuffer2.default(),\n\t\t\t\t    ns = void 0,\n\t\t\t\t    stack = [],\n\t\t\t\t    isRoot = false;\n\t\t\t\twhile (!isRoot && target && target != document) {\n\t\t\t\t\tns = target.getAttribute('ns');\n\t\t\t\t\tif (ns) {\n\t\t\t\t\t\tisRoot = _lodash2.default.startsWith(ns, \"root.\");\n\t\t\t\t\t\tif (isRoot) {\n\t\t\t\t\t\t\tns = ns.substring(5);\n\t\t\t\t\t\t\tevent.rootTarget = target;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (!event.nsTarget) event.nsTarget = target;\n\t\t\t\t\t\tstack.splice(0, 0, target);\n\t\t\t\t\t\tbuf.prepend(ns);\n\t\t\t\t\t}\n\t\t\t\t\ttarget = target.parentNode;\n\t\t\t\t}\n\t\t\t\tif (!isRoot) event.rootTarget = event.nsTarget;\n\t\n\t\t\t\t// target stack is a stack of all the ns targets up to the one with the data binding.\n\t\t\t\tevent.targetStack = stack;\n\t\t\t\tns = buf.toString('.');\n\t\t\t\tif (ns == '') ns = this.rootNS;\n\t\t\t\treturn { data: event.rootTarget, ns: ns };\n\t\t\t}\n\t\n\t\t\t/**\n\t   * The main event handler method, it processes event and generate relevant events to dispatch.\n\t   */\n\t\n\t\t}, {\n\t\t\tkey: \"handleEvent\",\n\t\t\tvalue: function handleEvent(event) {\n\t\t\t\tvar _this = this;\n\t\n\t\t\t\tvar type = event.type;\n\t\n\t\t\t\t// Do not dispatch other events if we are dragging.\n\t\t\t\tif (this.dragging || _DomUtils2.default.eventFromInput(event)) return;\n\t\n\t\t\t\tvar data = void 0,\n\t\t\t\t    ns = void 0,\n\t\t\t\t    pos = this.getPosition(event),\n\t\t\t\t    info = void 0,\n\t\t\t\t    isKeyEvent = type == 'keydown' || type == 'keyup';\n\t\t\t\tif (isKeyEvent) {\n\t\t\t\t\tdata = this.root;\n\t\t\t\t\tns = KeyUtils.getKeyEvent(event);\n\t\t\t\t} else {\n\t\t\t\t\tinfo = this.getEventInfo(event);\n\t\t\t\t\tif (!info) return;\n\t\t\t\t\tdata = info.data;\n\t\t\t\t\tns = info.ns;\n\t\t\t\t}\n\t\n\t\t\t\t//Utils.log('EventDispatcher', \"handleEvent - \" + type + ';ns=' + ns);\n\t\n\t\t\t\tif (type == 'mousewheel') {\n\t\t\t\t\tthis.scale *= Math.pow(2, event.wheelDelta * 0.002);\n\t\t\t\t\tthis.scale = Math.max(Math.min(this.zoomScale[1], this.scale), this.zoomScale[0]);\n\t\t\t\t\tevent.scale = this.scale;\n\t\t\t\t\ttype = 'zoom';\n\t\t\t\t}\n\t\n\t\t\t\t// See if we should create drag events\n\t\t\t\tif (type == 'mousedown' && event.button == 0 /*only drag on left click*/) {\n\t\t\t\t\t\t// Create drag object.\n\t\t\t\t\t\tvar dragObject = { data: data, pos: ns == 'root' ? EventDispatcher.mouse(this.root, event) : pos };\n\t\t\t\t\t\tthis.dragging = false;\n\t\t\t\t\t\t// Start listening for mouse move.\n\t\t\t\t\t\tvar dragPos = void 0;\n\t\n\t\t\t\t\t\tvar mousemove = function mousemove(event) {\n\t\t\t\t\t\t\tvar currentPos = _this.getPosition(event);\n\t\t\t\t\t\t\tif (!_this.dragging) {\n\t\t\t\t\t\t\t\t// check if the mouse has moved. IE always fire mousemove after mousedown even if the mouse hasn't moved yet.\n\t\t\t\t\t\t\t\tif (dragObject.pos[0] == currentPos[0] && dragObject.pos[1] == currentPos[1]) return;\n\t\n\t\t\t\t\t\t\t\t// start dragging\n\t\t\t\t\t\t\t\t_this.dragging = true;\n\t\t\t\t\t\t\t\tevent.rootTarget = dragObject.data;\n\t\t\t\t\t\t\t\t_this.dispatch(event, 'dragstart', ns, dragObject.data, dragObject.pos);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (ns == \"root\") dragPos = EventDispatcher.mouse(_this.root, event);else dragPos = currentPos;\n\t\t\t\t\t\t\t_this.getEventInfo(event);\n\t\t\t\t\t\t\t_this.dispatch(event, 'drag', ns, dragObject.data, dragPos);\n\t\t\t\t\t\t};\n\t\t\t\t\t\tvar mouseup = function mouseup(event) {\n\t\t\t\t\t\t\tif (ns == \"root\") dragPos = EventDispatcher.mouse(_this.root, event);else dragPos = _this.getPosition(event);\n\t\n\t\t\t\t\t\t\tvar info = _this.getEventInfo(event);\n\t\t\t\t\t\t\tif (_this.dragging) {\n\t\t\t\t\t\t\t\t_this.dragging = false;\n\t\t\t\t\t\t\t\t_this.dispatch(event, 'dragend', ns, dragObject.data, dragPos);\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t_this.dispatch(event, 'mouseup', ns, info.data, dragPos);\n\t\t\t\t\t\t\t}\n\t\n\t\t\t\t\t\t\t_bean2.default.off(window, 'mousemove', mousemove);\n\t\t\t\t\t\t\t_bean2.default.off(window, 'mouseup', mouseup);\n\t\t\t\t\t\t};\n\t\t\t\t\t\tevent.preventDefault();\n\t\t\t\t\t\t_bean2.default.on(window, 'mousemove', mousemove);\n\t\t\t\t\t\t_bean2.default.on(window, 'mouseup', mouseup);\n\t\t\t\t\t}\n\t\n\t\t\t\tif (!isKeyEvent) this.simulateEnterLeave(event, type, ns, data, pos);\n\t\t\t\tthis.dispatch(event, type, ns, data, pos);\n\t\n\t\t\t\t// disable the default context menu\n\t\t\t\t//if (type == 'contextmenu')\n\t\t\t\t//\tevent.preventDefault();\n\t\t\t}\n\t\n\t\t\t/**\n\t   * try to simulate mouseenter/mouseleave events.\n\t   */\n\t\n\t\t}, {\n\t\t\tkey: \"simulateEnterLeave\",\n\t\t\tvalue: function simulateEnterLeave(event, type, ns, data, pos) {\n\t\t\t\tvar _this2 = this;\n\t\n\t\t\t\tvar last = void 0,\n\t\t\t\t    stack = void 0;\n\t\t\t\tvar clearEnterStack = function clearEnterStack(k) {\n\t\t\t\t\tk = k || 0;\n\t\t\t\t\t// Clear off the enter stack.\n\t\t\t\t\twhile (_this2.enterStack.length >= k + 1) {\n\t\t\t\t\t\tlast = _this2.enterStack.pop();\n\t\t\t\t\t\t_this2.dispatch(event, 'mouseleave', last.ns, last.data, pos);\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t\tvar getNS = function getNS(index) {\n\t\t\t\t\tvar buf = new _StringBuffer2.default();\n\t\t\t\t\tfor (var i = 0; i <= index; i++) {\n\t\t\t\t\t\tvar val = stack[i].getAttribute(\"ns\");\n\t\t\t\t\t\tif (_lodash2.default.startsWith(val, \"root.\")) val = val.substring(5);\n\t\t\t\t\t\tbuf.append(val);\n\t\t\t\t\t}\n\t\t\t\t\treturn buf.toString('.');\n\t\t\t\t};\n\t\n\t\t\t\tif (ns && ns != this.rootNS) {\n\t\t\t\t\tif (type == 'mouseover') {\n\t\t\t\t\t\tstack = event.targetStack;\n\t\t\t\t\t\tvar item = void 0;\n\t\t\t\t\t\tfor (var i = 0; i < stack.length; i++) {\n\t\t\t\t\t\t\tif (i < this.enterStack.length) {\n\t\t\t\t\t\t\t\tif (this.enterStack[i].target != stack[i]) {\n\t\t\t\t\t\t\t\t\tclearEnterStack(i);\n\t\t\t\t\t\t\t\t} else continue;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\titem = { data: data, ns: getNS(i), target: stack[i] };\n\t\t\t\t\t\t\tthis.enterStack.push(item);\n\t\t\t\t\t\t\tthis.dispatch(event, 'mouseenter', item.ns, data, pos);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (stack.length < this.enterStack.length) clearEnterStack(stack.length);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (ns == this.rootNS && this.enterStack.length > 0) clearEnterStack();\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"dispatch\",\n\t\t\tvalue: function dispatch(event, type, ns, data, pos) {\n\t\t\t\t//if (type != 'mouseover' && type != 'mouseout')\n\t\t\t\t//\tUtils.log('EventDispatcher', \"dispatch - \" + type + '.' + ns + ';' + pos + ';rootTarget=' + event.rootTarget + ';data=' + data);\n\t\t\t\tif (!this.started) return;\n\t\t\t\tvar nsType = ns ? type + '.' + ns : type;\n\t\t\t\t_lodash2.default.forEach(this.listeners, function (listeners, key) {\n\t\t\t\t\tif (EventDispatcher.match(nsType, listeners.regexp ? listeners.regexp : key)) {\n\t\t\t\t\t\t_lodash2.default.forEach(listeners, function (listener) {\n\t\t\t\t\t\t\tif (!listener.context) listener.callback.apply(window, [type, ns, data, pos, event]);else listener.callback.apply(listener.context, [type, ns, data, pos, event]);\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t});\n\t\n\t\t\t\t// after dispatching, do not propagate.\n\t\t\t\tif (this.stopPropagation && event.stopPropagation) event.stopPropagation();\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"getPosition\",\n\t\t\tvalue: function getPosition(event) {\n\t\t\t\tvar pos = EventDispatcher.mouse(this.root, event);\n\t\t\t\tif (!_lodash2.default.isNaN(pos[0]) && !_lodash2.default.isNaN(pos[1])) this.lastPosition = pos;\n\t\t\t\treturn this.lastPosition;\n\t\t\t}\n\t\n\t\t\t/**\n\t   * Registers a key event handler\n\t   * // Key is object {ctrl, alt, shift, meta, code}\n\t   */\n\t\n\t\t}, {\n\t\t\tkey: \"registerKey\",\n\t\t\tvalue: function registerKey(type, key, callback, context) {\n\t\t\t\tvar _this3 = this;\n\t\n\t\t\t\tif (_lodash2.default.isArray(key)) {\n\t\t\t\t\t_lodash2.default.forEach(key, function (k) {\n\t\t\t\t\t\t_this3.registerKey(type, k, callback, context);\n\t\t\t\t\t});\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tkey = KeyUtils.getKeyData(key.ctrl, key.alt, key.shift, key.meta, key.code);\n\t\t\t\tif (!key.length) return;\n\t\t\t\tkey = new _StringBuffer2.default(type).append(key).toString('.');\n\t\n\t\t\t\tvar listener = { callback: callback, context: context };\n\t\t\t\tthis.listeners[key] || (this.listeners[key] = []);\n\t\t\t\tthis.listeners[key].push(listener);\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"unregisterKey\",\n\t\t\tvalue: function unregisterKey(type, key, callback, context) {\n\t\t\t\tvar _this4 = this;\n\t\n\t\t\t\tif (_lodash2.default.isArray(key)) {\n\t\t\t\t\t_lodash2.default.forEach(key, function (k) {\n\t\t\t\t\t\t_this4.unregisterKey(type, k, callback, context);\n\t\t\t\t\t});\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tkey = KeyUtils.getKeyData(key.ctrl, key.alt, key.shift, key.meta, key.code);\n\t\t\t\tif (!key.length) return;\n\t\t\t\tkey = new _StringBuffer2.default(type).append(key).toString('.');\n\t\n\t\t\t\tvar listeners = this.listeners[key],\n\t\t\t\t    listener = void 0;\n\t\t\t\tif (!listeners) return;\n\t\t\t\tfor (var i = 0; i < listeners.length; i++) {\n\t\t\t\t\tlistener = listeners[i];\n\t\t\t\t\tif (listener.callback === callback && (!context || context === listener.context)) {\n\t\t\t\t\t\tlisteners.splice(i, 1);\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\n\t\t\t/**\n\t   * Registers an event handler\n\t   */\n\t\n\t\t}, {\n\t\t\tkey: \"register\",\n\t\t\tvalue: function register(type, callback, context, zIndex) {\n\t\t\t\tvar _this5 = this;\n\t\n\t\t\t\tif (_lodash2.default.isArray(type)) {\n\t\t\t\t\t_lodash2.default.forEach(type, function (t) {\n\t\t\t\t\t\t_this5.register(t, callback, context, zIndex);\n\t\t\t\t\t});\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tvar listener = { callback: callback, context: context, zIndex: zIndex };\n\t\t\t\tvar regexp = null;\n\t\t\t\tif (type instanceof RegExp) {\n\t\t\t\t\tregexp = type;\n\t\t\t\t\ttype = type + '';\n\t\t\t\t}\n\t\t\t\tthis.listeners[type] || (this.listeners[type] = []);\n\t\t\t\tif (regexp && !this.listeners[type].regexp) this.listeners[type].regexp = regexp;\n\t\t\t\tthis.listeners[type].push(listener);\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"unregister\",\n\t\t\tvalue: function unregister(type, callback, context) {\n\t\t\t\tif (type instanceof RegExp) type = type + '';\n\t\t\t\tvar listeners = this.listeners[type],\n\t\t\t\t    listener = void 0;\n\t\t\t\tif (!listeners) return;\n\t\t\t\tfor (var i = 0; i < listeners.length; i++) {\n\t\t\t\t\tlistener = listeners[i];\n\t\t\t\t\tif (listener.callback === callback && (!context || context === listener.context)) {\n\t\t\t\t\t\tlisteners.splice(i, 1);\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"destroy\",\n\t\t\tvalue: function destroy() {\n\t\t\t\tthis.stop();\n\t\t\t\tdelete this.root;\n\t\t\t\tdelete this.listeners;\n\t\t\t\tdelete this.enterStack;\n\t\t\t}\n\t\n\t\t\t/**\n\t   * Check if the registered event type matches the real event type. \"*\" is allowed as a wild card.\n\t   */\n\t\n\t\t}], [{\n\t\t\tkey: \"match\",\n\t\t\tvalue: function match(nsType, registeredType) {\n\t\t\t\tif (registeredType instanceof RegExp) return nsType.match(registeredType);\n\t\n\t\t\t\treturn nsType == registeredType;\n\t\t\t\t/*const arr = registeredType.split('*');\n\t   if (arr.length == 1)\n\t   \treturn nsType == registeredType;\n\t   \tlet substr, index = 0;\n\t   for (let i = 0; i < arr.length; i++) {\n\t   \tif (arr[i].length == 0) continue;\n\t   \tsubstr = nsType.slice(index);\n\t   \tindex = substr.indexOf(arr[i]);\n\t   \tif (index < 0)\n\t   \t\treturn false;\n\t   \tindex += arr[i].length;\n\t   }\n\t   return true;*/\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"mouse\",\n\t\t\tvalue: function mouse(container, e) {\n\t\t\t\tif (e.changedTouches) e = e.changedTouches[0];\n\t\t\t\tvar svg = container.ownerSVGElement || container;\n\t\t\t\tif (svg.createSVGPoint) {\n\t\t\t\t\tvar point = svg.createSVGPoint();\n\t\t\t\t\tpoint.x = e.clientX;point.y = e.clientY;\n\t\t\t\t\tpoint = point.matrixTransform(container.getScreenCTM().inverse());\n\t\t\t\t\treturn [point.x, point.y];\n\t\t\t\t}\n\t\t\t\tvar rect = container.getBoundingClientRect();\n\t\t\t\treturn [e.clientX - rect.left - container.clientLeft, e.clientY - rect.top - container.clientTop];\n\t\t\t}\n\t\t}]);\n\t\n\t\treturn EventDispatcher;\n\t}();\n\t\n\texports.default = EventDispatcher;\n\n/***/ }),\n/* 15 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t\tvalue: true\n\t});\n\texports.getKeyEvent = getKeyEvent;\n\texports.getKeyData = getKeyData;\n\t\n\tvar _StringBuffer = __webpack_require__(8);\n\t\n\tvar _StringBuffer2 = _interopRequireDefault(_StringBuffer);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\t/**\n\t * KEY constant\n\t */\n\tvar KEY = {\n\t\tALT: 18,\n\t\tBACK_SPACE: 8,\n\t\tCAPS_LOCK: 20,\n\t\tCONTROL: 17,\n\t\tDELETE: 46,\n\t\tDOWN: 40,\n\t\tEND: 35,\n\t\tENTER: 13,\n\t\tESCAPE: 220,\n\t\tHOME: 36,\n\t\tLEFT: 37,\n\t\tMETA: 224,\n\t\tNUM_LOCK: 144,\n\t\tPAGE_DOWN: 34,\n\t\tPAGE_UP: 33,\n\t\tPAUSE: 19,\n\t\tPRINTSCREEN: 44,\n\t\tRIGHT: 39,\n\t\tSCROLL_LOCK: 145,\n\t\tSHIFT: 16,\n\t\tSPACE: 32,\n\t\tTAB: 9,\n\t\tUP: 38\n\t\t//ADD          : DomUtils.isFireFox ? 61  : 187,\n\t\t//SUBTRACT     : DomUtils.isFireFox ? 173 : 189\n\t}; ///////////////////////////////////////////////////////////////////////////////\n\t//                                                                           //\n\t//           The Key Utility CLass for the Event Dispatcher          \t     //\n\t//                                                                           //\n\t///////////////////////////////////////////////////////////////////////////////\n\t\n\tfunction getKeyEvent(event) {\n\t\tif (!event || !event instanceof KeyboardEvent) {\n\t\t\treturn null;\n\t\t}\n\t\n\t\tvar key = event.keyCode || event.which;\n\t\n\t\t// Need to find a way to avoid this\n\t\tif (key >= 16 && key <= 18) {\n\t\t\tkey = null;\n\t\t}\n\t\n\t\treturn getKeyData(event.ctrlKey, event.altKey, event.shiftKey, event.metaKey, key);\n\t}\n\t\n\tfunction getKeyData(ctrl, alt, shift, meta, key) {\n\t\tvar buf = new _StringBuffer2.default();\n\t\n\t\tif (ctrl) buf.append(\"CTRL\");\n\t\tif (alt) buf.append(\"ALT\");\n\t\tif (shift) buf.append(\"SHIFT\");\n\t\tif (meta) buf.append(\"META\");\n\t\tif (key) buf.append(key);\n\t\n\t\treturn buf.toString(\".\");\n\t}\n\n/***/ }),\n/* 16 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t\tvalue: true\n\t});\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tvar _lodash = __webpack_require__(5);\n\t\n\tvar _lodash2 = _interopRequireDefault(_lodash);\n\t\n\tvar _Utils = __webpack_require__(2);\n\t\n\tvar _Utils2 = _interopRequireDefault(_Utils);\n\t\n\tvar _Node = __webpack_require__(17);\n\t\n\tvar _Node2 = _interopRequireDefault(_Node);\n\t\n\tvar _Edge = __webpack_require__(21);\n\t\n\tvar _Edge2 = _interopRequireDefault(_Edge);\n\t\n\tvar _Marker = __webpack_require__(22);\n\t\n\tvar _Marker2 = _interopRequireDefault(_Marker);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tvar nodeDefaults = {\n\t\tname: 'Default',\n\t\trole: 'node',\n\t\tdraggable: true,\n\t\tselectable: true,\n\t\teditable: true,\n\t\tresizable: false,\n\t\tsourceable: true,\n\t\ttargetable: true,\n\t\tvisible: true\n\t};\n\t\n\tvar edgeDefaults = {\n\t\tname: 'Default',\n\t\trole: 'edge',\n\t\tselectable: true,\n\t\tvisible: true,\n\t\tstartMarker: null,\n\t\tendMarker: {\n\t\t\tid: 'Default_EndMarker',\n\t\t\ttype: 'arrow',\n\t\t\tsize: 10,\n\t\t\tcolor: '#0ea117'\n\t\t},\n\t\t/* start and end is only used if the edge is not connected to a node */\n\t\tstart: [0, 0],\n\t\tend: [400, 200]\n\t};\n\t\n\tvar Graph = function () {\n\t\tfunction Graph() {\n\t\t\tvar id = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : _lodash2.default.uniqueId(\"G\");\n\t\t\tvar config = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n\t\t\tvar model = arguments[2];\n\t\n\t\t\t_classCallCheck(this, Graph);\n\t\n\t\t\tthis.id = id;\n\t\n\t\t\tthis.nodes = {};\n\t\t\tthis.edges = {};\n\t\n\t\t\tthis.selection = null;\n\t\t\tthis.destroyed = false;\n\t\n\t\t\t_Utils2.default.buildTypes(config.nodeTypes, \"Nodes\", nodeDefaults);\n\t\t\t_Utils2.default.buildTypes(config.edgeTypes, \"Edges\", edgeDefaults);\n\t\t\t// check for markers.\n\t\t\tthis.markers = [];\n\t\t\tvar edgeTypes = _Utils2.default.type(_Edge2.default.namespace),\n\t\t\t    marker = void 0,\n\t\t\t    markerConfig = void 0;\n\t\t\tedgeTypes.forEach(function (type) {\n\t\t\t\tmarkerConfig = type.prototype.startMarker;\n\t\t\t\tif (markerConfig) {\n\t\t\t\t\tmarker = _Marker2.default.getMarker(markerConfig, true);\n\t\t\t\t\tthis.markers.push(marker);\n\t\t\t\t}\n\t\t\t\tmarkerConfig = type.prototype.endMarker;\n\t\t\t\tif (markerConfig) {\n\t\t\t\t\tmarker = _Marker2.default.getMarker(markerConfig, false);\n\t\t\t\t\tthis.markers.push(marker);\n\t\t\t\t}\n\t\t\t}, this);\n\t\n\t\t\tdelete config.nodeTypes;\n\t\t\tdelete config.edgeTypes;\n\t\t\t_Utils2.default.initConfig(this, config);\n\t\t\tthis.root = null;\n\t\t\tif (model) this.loadModel(model);\n\t\t}\n\t\n\t\t_createClass(Graph, [{\n\t\t\tkey: \"addNode\",\n\t\n\t\n\t\t\t/**\n\t   * Create a new Node\n\t   * @param config\n\t   * @param parent\n\t   * @param pos\n\t   * @returns {*}\n\t   */\n\t\t\tvalue: function addNode(config) {\n\t\t\t\tvar parent = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : this.currentRoot;\n\t\t\t\tvar pos = arguments[2];\n\t\n\t\t\t\tvar NodeClass = Graph.getJSClass(config, _Node2.default);\n\t\t\t\tvar node = new NodeClass(this, config);\n\t\n\t\t\t\tif (parent) Graph.addChild(parent, node, pos);else {\n\t\t\t\t\tthis.root = node;\n\t\t\t\t\tthis.root.prop('role', 'root');\n\t\t\t\t}\n\t\n\t\t\t\tthis.nodes[node.id] = node;\n\t\t\t\treturn node;\n\t\t\t}\n\t\n\t\t\t/**\n\t   * Create a new Edge\n\t   * @param config\n\t   * @param parent\n\t   * @param from\n\t   * @param to\n\t   * @returns {*}\n\t   */\n\t\n\t\t}, {\n\t\t\tkey: \"addEdge\",\n\t\t\tvalue: function addEdge(config) {\n\t\t\t\tvar parent = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : this.currentRoot;\n\t\t\t\tvar from = arguments[2];\n\t\t\t\tvar to = arguments[3];\n\t\n\t\t\t\tvar EdgeClass = Graph.getJSClass(config, _Edge2.default);\n\t\t\t\tvar edge = new EdgeClass(this, config, from, to);\n\t\n\t\t\t\tGraph.addChild(parent, edge);\n\t\t\t\tthis.edges[edge.id] = edge;\n\t\t\t\treturn edge;\n\t\t\t}\n\t\n\t\t\t/**\n\t   * Added a new child to the parent. The parent has to be a node.\n\t   * @param parent\n\t   * @param child\n\t   */\n\t\n\t\t}, {\n\t\t\tkey: \"loadModel\",\n\t\t\tvalue: function loadModel(model) {\n\t\t\t\tvar _this = this;\n\t\n\t\t\t\tvar parent = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : this.currentRoot;\n\t\n\t\t\t\tvar nodes = model.nodes;\n\t\t\t\tvar edges = model.edges;\n\t\t\t\tdelete model.nodes;\n\t\t\t\tdelete model.edges;\n\t\n\t\t\t\tvar node = this.addNode(model, parent);\n\t\t\t\tif (nodes) {\n\t\t\t\t\t_lodash2.default.forEach(nodes, function (child) {\n\t\t\t\t\t\t_this.loadModel(child, node);\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\tif (edges) {\n\t\t\t\t\t_lodash2.default.forEach(edges, function (edge) {\n\t\t\t\t\t\tvar from = void 0,\n\t\t\t\t\t\t    to = void 0;\n\t\t\t\t\t\tif (edge.from) from = _this.nodes[edge.from];\n\t\t\t\t\t\tif (edge.to) to = _this.nodes[edge.to];\n\t\t\t\t\t\t_this.addEdge(edge, node, from, to);\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"reset\",\n\t\t\tvalue: function reset() {}\n\t\t}, {\n\t\t\tkey: \"destroy\",\n\t\t\tvalue: function destroy() {}\n\t\t}, {\n\t\t\tkey: \"currentRoot\",\n\t\t\tget: function get() {\n\t\t\t\treturn this.root;\n\t\t\t}\n\t\t}], [{\n\t\t\tkey: \"getJSClass\",\n\t\t\tvalue: function getJSClass(config, defaultClass) {\n\t\t\t\tvar jsClass = null;\n\t\t\t\tif (config && config.type) {\n\t\t\t\t\t// See if we can get the js class from config.\n\t\t\t\t\tvar type = _Utils2.default.type(defaultClass.namespace, config.type);\n\t\t\t\t\tif (type) jsClass = type.jsClass;\n\t\t\t\t}\n\t\n\t\t\t\treturn _Utils2.default.getConstructor(jsClass, defaultClass);\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"addChild\",\n\t\t\tvalue: function addChild(parent, child) {\n\t\t\t\tif (!parent.children) parent.children = [];\n\t\n\t\t\t\tif (child.parent != parent) {\n\t\t\t\t\tparent.children.push(child);\n\t\n\t\t\t\t\tif (child.parent && child.parent.children) child.parent.children = _lodash2.default.without(child.parent.children, child);\n\t\t\t\t}\n\t\t\t\tchild.parent = parent;\n\t\t\t}\n\t\t}]);\n\t\n\t\treturn Graph;\n\t}();\n\t\n\tGraph.DEFAULTS = {\n\t\tallowDanglingEdges: true,\n\t\tmultiConnect: false,\n\t\treadOnly: false,\n\t\tviewOnly: false\n\t};\n\t\n\texports.default = Graph;\n\n/***/ }),\n/* 17 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t\tvalue: true\n\t});\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tvar _lodash = __webpack_require__(5);\n\t\n\tvar _lodash2 = _interopRequireDefault(_lodash);\n\t\n\tvar _StringBuffer = __webpack_require__(8);\n\t\n\tvar _StringBuffer2 = _interopRequireDefault(_StringBuffer);\n\t\n\tvar _Cell2 = __webpack_require__(18);\n\t\n\tvar _Cell3 = _interopRequireDefault(_Cell2);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\t\n\tfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\t\n\t/**\n\t * A Node represents vertex of the graph.\n\t */\n\tvar Node = function (_Cell) {\n\t\t_inherits(Node, _Cell);\n\t\n\t\tfunction Node(graph) {\n\t\t\tvar config = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n\t\n\t\t\t_classCallCheck(this, Node);\n\t\n\t\t\tif (!config.id) config.id = _lodash2.default.uniqueId('N');\n\t\n\t\t\tvar _this = _possibleConstructorReturn(this, (Node.__proto__ || Object.getPrototypeOf(Node)).call(this, graph, config));\n\t\n\t\t\t_this.inEdges = [];\n\t\t\t_this.outEdges = [];\n\t\t\t_this.ports = null;\n\t\t\t_this.parent = null;\n\t\t\treturn _this;\n\t\t}\n\t\n\t\t_createClass(Node, [{\n\t\t\tkey: \"isAncestor\",\n\t\t\tvalue: function isAncestor(n) {\n\t\t\t\t// TODO: should we move this to graph class ?\n\t\t\t\tvar node = n.parent;\n\t\t\t\twhile (node) {\n\t\t\t\t\tif (this == node) {\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t}\n\t\t\t\t\tnode = node.parent;\n\t\t\t\t}\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"removeEdge\",\n\t\t\tvalue: function removeEdge(edge) {\n\t\t\t\tvar edges = edge.source == this ? this.outEdges : this.inEdges;\n\t\t\t\tfor (var i = 0; i < edges.length; i++) {\n\t\t\t\t\tif (edge == edges[i]) {\n\t\t\t\t\t\tedges.splice(i, 1);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\n\t\t\t// Add a new incoming edge\n\t\n\t\t}, {\n\t\t\tkey: \"addInEdge\",\n\t\t\tvalue: function addInEdge(edge, pos) {\n\t\t\t\tif (pos == null || pos === undefined) this.inEdges.push(edge);else this.inEdges.splice(pos, 0, edge);\n\t\t\t}\n\t\n\t\t\t// Add a new outgoing edge\n\t\n\t\t}, {\n\t\t\tkey: \"addOutEdge\",\n\t\t\tvalue: function addOutEdge(edge, pos) {\n\t\t\t\tif (pos == null || pos === undefined || pos > edge.length - 1) this.outEdges.push(edge);else this.outEdges.splice(pos, 0, edge);\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"renderChildren\",\n\t\t\tvalue: function renderChildren(view) {\n\t\t\t\tif (this.children) {\n\t\t\t\t\tvar buf = new _StringBuffer2.default();\n\t\t\t\t\t_lodash2.default.forEach(this.children, function (child) {\n\t\t\t\t\t\tbuf.append(child.render(view));\n\t\t\t\t\t});\n\t\t\t\t\treturn buf.toString();\n\t\t\t\t}\n\t\t\t\treturn '';\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"getPort\",\n\t\t\tvalue: function getPort(key) {\n\t\t\t\tvar portName = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 'auto';\n\t\t\t\tvar endPt = arguments[2];\n\t\t\t\tvar orthogonal = arguments[3];\n\t\n\t\t\t\tvar shape = this.getShape(key);\n\t\t\t\tif (portName == 'auto') {\n\t\t\t\t\treturn shape.getPerimeter(endPt, orthogonal);\n\t\t\t\t}\n\t\t\t\treturn null;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"toString\",\n\t\t\tvalue: function toString() {\n\t\t\t\tvar label = this.prop(\"label\") ? this.prop(\"label\") : \"undefined\";\n\t\t\t\tif (_lodash2.default.isArray(label)) label = label[0];\n\t\t\t\treturn 'Node:{id:' + this.id + ';label:' + label + ';type:' + this.props.constructor.typeName + '}';\n\t\t\t}\n\t\t}]);\n\t\n\t\treturn Node;\n\t}(_Cell3.default);\n\t\n\tNode.namespace = \"Nodes\";\n\t\n\texports.default = Node;\n\t\n\t/*\n\t\n\t/**\n\t * The DrillDownParent is the parent that displays the vertex when drilled down.\n\t *\n\tVertex.prototype.getDrillDownParent = function() {\n\t\treturn this.parent;\n\t};\n\n\tVertex.prototype.isLocked = function() {\n\t\tvar mode = this.getProperty(\"mode\") || 3;\n\t\treturn !(mode & Graph.ALLOW_INTERACTIONS);\n\t};\n\n\tVertex.prototype.getCrumbText = function() {\n\t\tif (this.isLocked())\n\t\t\treturn '<span><img src=\"webwb/pzreadonly.png\" /></span><span>&nbsp;' + this.getProperty(\"label\") + '</span>';\n\t\treturn this.getProperty(\"label\");\n\t};\n\n\tVertex.prototype.canEdit = function() {\n\t\treturn (!this.parent || !this.parent.isLocked()) && Vertex.superclass.canEdit.call(this);\n\t};\n\n\tVertex.prototype.isContainer = function() {\n\t\treturn this.getProperty(\"container\");\n\t};\n\n\t*/\n\n/***/ }),\n/* 18 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t\tvalue: true\n\t});\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tvar _lodash = __webpack_require__(5);\n\t\n\tvar _lodash2 = _interopRequireDefault(_lodash);\n\t\n\tvar _Utils = __webpack_require__(2);\n\t\n\tvar _Utils2 = _interopRequireDefault(_Utils);\n\t\n\tvar _Cache = __webpack_require__(19);\n\t\n\tvar _Cache2 = _interopRequireDefault(_Cache);\n\t\n\tvar _StringBuffer = __webpack_require__(8);\n\t\n\tvar _StringBuffer2 = _interopRequireDefault(_StringBuffer);\n\t\n\tvar _Shape = __webpack_require__(6);\n\t\n\tvar _Shape2 = _interopRequireDefault(_Shape);\n\t\n\tvar _Rectangle = __webpack_require__(4);\n\t\n\tvar _Rectangle2 = _interopRequireDefault(_Rectangle);\n\t\n\tvar _Label = __webpack_require__(20);\n\t\n\tvar _Label2 = _interopRequireDefault(_Label);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\t/**\n\t * The Cell is the common parent for Node and Edge.\n\t */\n\tvar Cell = function () {\n\t\tfunction Cell(graph) {\n\t\t\tvar config = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : { id: _lodash2.default.uniqueId() };\n\t\n\t\t\t_classCallCheck(this, Cell);\n\t\n\t\t\tthis.graph = graph;\n\t\t\tthis.id = config.id;\n\t\t\tdelete config.id;\n\t\n\t\t\t// Initialize decorators\n\t\t\tif (config.decorators) {\n\t\t\t\tthis.createDecorators(config.decorators);\n\t\t\t\tdelete config.decorators;\n\t\t\t}\n\t\n\t\t\t// Initialize View Properties\n\t\t\tif (config.views) {\n\t\t\t\tthis.viewProps = config.views;\n\t\t\t\tdelete config.views;\n\t\t\t}\n\t\n\t\t\t// Initialize type\n\t\t\tvar type = config.type || \"Default\";\n\t\t\ttype = _Utils2.default.type(this.constructor.namespace, type);\n\t\t\tif (!type) throw new Error(\"Type not found \" + config.type);\n\t\t\tdelete config.type;\n\t\t\tthis.props = new type(config);\n\t\t}\n\t\n\t\t_createClass(Cell, [{\n\t\t\tkey: \"prop\",\n\t\t\tvalue: function prop(name, value) {\n\t\t\t\tif (_lodash2.default.isUndefined(value)) return this.props[name];\n\t\t\t\tthis.props[name] = value;\n\t\t\t}\n\t\n\t\t\t/**\n\t   * Get/Set property stored by views.\n\t   * @param key\n\t   * @param name\n\t   * @param value\n\t   * @returns {*}\n\t   */\n\t\n\t\t}, {\n\t\t\tkey: \"viewProp\",\n\t\t\tvalue: function viewProp() {\n\t\t\t\tvar key = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 'default';\n\t\t\t\tvar name = arguments[1];\n\t\t\t\tvar value = arguments[2];\n\t\n\t\t\t\tif (_lodash2.default.isUndefined(value)) {\n\t\t\t\t\tif (key == 'default') return this.prop(name, value);\n\t\t\t\t\treturn this.viewProps[key][name];\n\t\t\t\t}\n\t\t\t\tif (key == 'default') {\n\t\t\t\t\tthis.prop(name, value);\n\t\t\t\t} else {\n\t\t\t\t\tif (!this.viewProps[key]) this.viewProps[key] = {};\n\t\t\t\t\tthis.viewProps[key][name] = value;\n\t\t\t\t}\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"createDecorators\",\n\t\t\tvalue: function createDecorators(decorators) {}\n\t\n\t\t\t/**\n\t   * Get properties needed for rendering this element\n\t   * @returns {{key: (string|*), className: *, namespace: *, bounds: *}}\n\t   */\n\t\n\t\t}, {\n\t\t\tkey: \"getView\",\n\t\t\tvalue: function getView(key) {\n\t\t\t\tvar shape = this.getShape(key);\n\t\t\t\treturn _lodash2.default.assign({\n\t\t\t\t\tid: this.id,\n\t\t\t\t\tkey: key,\n\t\t\t\t\tclassName: this.computedClassName,\n\t\t\t\t\tstyle: this.viewProp(key, 'style'),\n\t\t\t\t\tnamespace: this.namespace\n\t\t\t\t}, shape);\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"getShape\",\n\t\t\tvalue: function getShape(key) {\n\t\t\t\tvar shape = _Cache2.default.get(this.id + \".shape\", key);\n\t\t\t\tif (shape) return shape;\n\t\n\t\t\t\tvar shapeConfig = this.viewProp(key, 'shape');\n\t\t\t\tvar shapeClass = shapeConfig ? _Shape2.default.getShape(shapeConfig.name) : _Shape2.default.getShape('Rectangle');\n\t\t\t\tvar x = this.viewProp(key, \"x\");\n\t\t\t\tvar y = this.viewProp(key, \"y\");\n\t\t\t\tvar width = this.viewProp(key, \"width\");\n\t\t\t\tvar height = this.viewProp(key, \"height\");\n\t\t\t\tshape = new shapeClass(x, y, width, height, shapeConfig);\n\t\t\t\t_Cache2.default.set(this.id + '.shape', shape, key);\n\t\t\t\treturn shape;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"render\",\n\t\t\tvalue: function render(view) {\n\t\t\t\tvar template = _Cache2.default.get(this.id + '.template', view.id);\n\t\t\t\tif (!template) {\n\t\t\t\t\t//create the template\n\t\t\t\t\tvar role = this.prop('role');\n\t\t\t\t\ttemplate = view.getTemplate('$' + role, null, this);\n\t\t\t\t\tif (_lodash2.default.isString(template)) template = _lodash2.default.template(template);\n\t\t\t\t\t_Cache2.default.set(this.id + '.template', template, view.id);\n\t\t\t\t}\n\t\t\t\treturn template(this.getView(view.id));\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"renderShape\",\n\t\t\tvalue: function renderShape(view) {\n\t\t\t\tvar shape = this.getShape(view.id);\n\t\t\t\tif (shape) return shape.render(view);\n\t\t\t\treturn '';\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"renderLabel\",\n\t\t\tvalue: function renderLabel(view) {\n\t\t\t\tif (this == this.graph.currentRoot) return null;\n\t\t\t\tvar box = this.getLabelBox(view.id);\n\t\t\t\tif (box) return view.renderLabel(box);\n\t\t\t\treturn '';\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"getLabelBox\",\n\t\t\tvalue: function getLabelBox(key) {\n\t\t\t\tvar box = _Cache2.default.get(this.id + '.labelBox', key);\n\t\t\t\tif (box) return box;\n\t\t\t\tvar shape = this.getShape(key);\n\t\t\t\t// Just get the config will have a positive performance boost for IE11 and IE10.\n\t\t\t\tbox = _Label2.default.getLabelBox(this.prop('label'), this.viewProp(key, 'labelConfig'), shape.width, shape.height);\n\t\t\t\t_Cache2.default.set(this.id + '.labelBox', box, key);\n\t\t\t\treturn box;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"destroy\",\n\t\t\tvalue: function destroy() {\n\t\t\t\tdelete this.graph;\n\t\t\t\tdelete this.decorators;\n\t\t\t\tdelete this.props;\n\t\t\t\tdelete this.viewProps;\n\t\t\t\tthis.destroyed = true;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"computedClassName\",\n\t\t\tget: function get() {\n\t\t\t\tif (!this._computedClassName) {\n\t\t\t\t\tvar buf = new _StringBuffer2.default(this.prop(\"role\"));\n\t\t\t\t\tvar props = this.props;\n\t\t\t\t\tif (props.hasOwnProperty(\"className\")) buf.append(props[\"className\"]);\n\t\t\t\t\tprops = props.constructor.prototype;\n\t\t\t\t\twhile (props) {\n\t\t\t\t\t\tif (props.hasOwnProperty(\"className\")) buf.append(props[\"className\"]);\n\t\t\t\t\t\tprops = Object.getPrototypeOf(props);\n\t\t\t\t\t}\n\t\t\t\t\tthis._computedClassName = buf.toString(' ');\n\t\t\t\t}\n\t\t\t\treturn this._computedClassName;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"namespace\",\n\t\t\tget: function get() {\n\t\t\t\tif (this == this.graph.currentRoot) return '';\n\t\t\t\treturn \"root.\" + this.prop(\"role\");\n\t\t\t}\n\t\t}]);\n\t\n\t\treturn Cell;\n\t}();\n\t\n\t/*\n\t\n\tCell.prototype.move = function(x, y) {\n\t\tthis.setProperty(\"x\", Math.round(x));\n\t\tthis.setProperty(\"y\", Math.round(y));\n\t\tdelete this.bounds;\n\t};\n\t\n\tCell.prototype.resize = function(w, h) {\n\t\tthis.setProperty(\"width\", w);\n\t\tthis.setProperty(\"height\", h);\n\t\tdelete this.bounds;\n\t};\n\t\n\tCell.prototype.canEdit = function() {\n\t\treturn (this.graph ? this.graph.canEdit() : true) && this.getProperty(\"editable\");\n\t};\n\t\n\tCell.prototype.canSelect = function() {\n\t\treturn (this.graph ? this.graph.canSelect() : true) && this.getProperty(\"selectable\");\n\t};\n\t\n\tCell.prototype.canMove = function() {\n\t\treturn (this.graph ? this.graph.canEdit() : true) && this.getProperty(\"draggable\");\n\t};\n\t\n\tCell.prototype.canResize = function() {\n\t\treturn (this.graph ? this.graph.canEdit() : true) && this.getProperty(\"resizable\");\n\t};\n\t\n\tCell.prototype.getTypeFromString = function(typeStr) {\n\t\treturn this.graph.getType(typeStr);\n\t};\n\t\n\tCell.prototype.createModifiers = function(modifiers) {\n\t\tthis.modifiers = null;\n\t\tvar modifierSettings = this.getProperty(\"modifierSettings\");\n\t\tif (modifierSettings) {\n\t\t\t_.each(modifiers, function(config) {\n\t\t\t\tconfig.type = this.graph.getModifierType(config.className);\n\t\t\t\tconfig.setting = modifierSettings[config.className];\n\t\t\t\tif (!config.type || !config.setting) return;\n\t\n\t\t\t\tthis.addModifier(config.className, new Modifier(this, config));\n\t\t\t}, this);\n\t\n\t\t\t// Check for showAlways settings\n\t\t\t_.each(modifierSettings, function(setting, name) {\n\t\t\t\tif (setting.showAlways && (!this.modifiers || !this.modifiers[name])) {\n\t\t\t\t\tvar config = {type: this.graph.getModifierType(name), setting: setting};\n\t\t\t\t\tif (!config.type) return;\n\t\t\t\t\tthis.addModifier(name, new Modifier(this, config));\n\t\t\t\t}\n\t\t\t}, this);\n\t\t}\n\t};\n\t\n\tCell.prototype.addModifier = function(name, modifier) {\n\t\tif (!this.modifiers)\n\t\t\tthis.modifiers = {};\n\t\n\t\tif (!modifier.hasOwnProperty(\"showHeader\"))\n\t\t\tmodifier.showHeader = true;\n\t\n\t\t// @hack preferably set it in configurations.\n\t\tif (modifier.name == \"HoverProcessModifier\" || modifier.name == \"HoverResults\")\n\t\t\tmodifier.showHeader = false;\n\t\n\t\tthis.modifiers[name] = modifier;\n\t};\n\t\n\tCell.prototype.getModifiers = function() {\n\t\tif (_.isUndefined(this.modifiers))\n\t\t\tthis.createModifiers();\n\t\treturn this.modifiers;\n\t};\n\t\n\tCell.prototype.getModifier = function(name) {\n\t\tvar modifiers = this.getModifiers();\n\t\tif (modifiers)\n\t\t\treturn modifiers[name];\n\t\treturn null;\n\t};\n\t\n\tCell.prototype.isVisible = function() {\n\t\treturn this.getProperty('visible');\n\t};\n\t\n\tCell.prototype.isContainer = function() {\n\t\treturn false;\n\t};\n\t*/\n\t\n\t\n\texports.default = Cell;\n\n/***/ }),\n/* 19 */\n/***/ (function(module, exports) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t\tvalue: true\n\t});\n\t/**\n\t * Created by tong on 6/7/2016.\n\t */\n\t\n\tvar caches = {};\n\t\n\tvar Cache = {\n\t\tget: function get(key, namespace) {\n\t\t\treturn this.getCache(namespace)[key];\n\t\t},\n\t\n\t\tset: function set(key, value, namespace) {\n\t\t\tthis.getCache(namespace)[key] = value;\n\t\t},\n\t\n\t\tcontains: function contains(key, namespace) {\n\t\t\treturn key in this.getCache(namespace);\n\t\t},\n\t\n\t\tremove: function remove(key, namespace) {\n\t\t\tdelete this.getCache(namespace)[key];\n\t\t},\n\t\n\t\tclear: function clear(namesapce) {\n\t\t\tif (!namespace) caches = {};else if (caches[namespace]) caches[namespace] = {};\n\t\t},\n\t\n\t\tgetCache: function getCache() {\n\t\t\tvar namespace = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 'default';\n\t\n\t\t\tif (!caches[namespace]) caches[namespace] = {};\n\t\t\treturn caches[namespace];\n\t\t}\n\t};\n\t\n\texports.default = Cache;\n\n/***/ }),\n/* 20 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t\tvalue: true\n\t});\n\t\n\tvar _lodash = __webpack_require__(5);\n\t\n\tvar _lodash2 = _interopRequireDefault(_lodash);\n\t\n\tvar _bean = __webpack_require__(13);\n\t\n\tvar _bean2 = _interopRequireDefault(_bean);\n\t\n\tvar _Utils = __webpack_require__(2);\n\t\n\tvar _Utils2 = _interopRequireDefault(_Utils);\n\t\n\tvar _DomUtils = __webpack_require__(7);\n\t\n\tvar _DomUtils2 = _interopRequireDefault(_DomUtils);\n\t\n\tvar _StringBuffer = __webpack_require__(8);\n\t\n\tvar _StringBuffer2 = _interopRequireDefault(_StringBuffer);\n\t\n\tvar _Rectangle = __webpack_require__(4);\n\t\n\tvar _Rectangle2 = _interopRequireDefault(_Rectangle);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tvar FONT_BOLD = 1,\n\t    FONT_ITALIC = 2,\n\t    FONT_UNDERLINE = 4,\n\t    FONT_SHADOW = 8;\n\t\n\tvar defaultConfig = {\n\t\tfontSize: 11,\n\t\tfontFamily: \"Arial\",\n\t\tfontStyle: 0,\n\t\tfontColor: 'black',\n\t\tpadding: 0,\n\t\tlinePadding: 0,\n\t\talign: \"left\",\n\t\twidth: 0,\n\t\theight: 0,\n\t\trotation: null,\n\t\tgeometry: { x: 0, y: 0, anchorY: 0, offsetX: 0, offsetY: 0 }\n\t};\n\t\n\t/**\n\t * The label object handles label sizing/positioning\n\t */\n\t\n\texports.default = function () {\n\t\tvar stringMeasureEl = null,\n\t\t    measureDiv = void 0,\n\t\t    baselineDiv = void 0;\n\t\n\t\t/**\n\t  * Calculate the size of the string.\n\t  */\n\t\tvar getStringSize = _lodash2.default.memoize(function (str, fontSize, fontFamily, bold) {\n\t\t\tfontSize = fontSize || 11;\n\t\t\tfontFamily = fontFamily || 'Arial,Helvetica';\n\t\t\tbold = !_lodash2.default.isUndefined(bold) ? bold : false;\n\t\n\t\t\t// first check if there is a string-measuring div available, if not, create now.\n\t\t\tif (!stringMeasureEl) {\n\t\t\t\tstringMeasureEl = _DomUtils2.default.createElement('iframe', { id: \"_ComputeStylesIframe\" }, { position: \"absolute\", visibility: \"hidden\", width: \"auto\" });\n\t\t\t\tdocument.body.appendChild(stringMeasureEl);\n\t\t\t\tvar doc = stringMeasureEl.contentWindow.document;\n\t\t\t\tdoc.open();\n\t\t\t\tdoc.write('<html><body>\\\n\t\t\t\t\t<div id=\"baselineDiv\" style=\"height:100px;\"><span style=\"line-height:0\">T</span><span style=\"height:100%;display:inline-block;\"></span></div>\\\n\t\t\t\t\t<div id=\"measureDiv\" style=\"position:absolute;width:auto;height:auto;padding:0;white-space:pre-wrap;word-wrap:break-word;display:inline-block;\"></div>\\\n\t\t\t\t\t</body></html>');\n\t\t\t\tdoc.close();\n\t\t\t\tmeasureDiv = doc.getElementById(\"measureDiv\");\n\t\t\t\tbaselineDiv = doc.getElementById(\"baselineDiv\");\n\t\t\t}\n\t\t\tbaselineDiv.style.fontSize = measureDiv.style.fontSize = fontSize;\n\t\t\tbaselineDiv.style.fontFamily = measureDiv.style.fontFamily = fontFamily;\n\t\t\tbaselineDiv.style.fontWeight = measureDiv.style.fontWeight = bold ? 'bold' : 'normal';\n\t\t\tmeasureDiv.innerHTML = str;\n\t\n\t\t\tvar strut = baselineDiv.firstChild;\n\t\t\tvar baselineHeight = strut.offsetTop + strut.offsetHeight - baselineDiv.offsetHeight - baselineDiv.offsetTop;\n\t\n\t\t\treturn { width: measureDiv.offsetWidth, height: measureDiv.offsetHeight, baseline: baselineHeight };\n\t\t}, function (str, fontSize, fontFamily, bold) {\n\t\t\treturn str + ';' + fontSize + ';' + fontFamily + ';' + bold;\n\t\t});\n\t\n\t\t/**\n\t  * Create a wrapped text.\n\t  * @param {String} string the string to wrap.\n\t  * @param {maxWidth} the maximum width this string can take.\n\t  * @param {fontSize}\n\t  * @param {fontFamily}\n\t  * @param {bold}\n\t  */\n\t\tvar wrap = _lodash2.default.memoize(function (string, maxWidth, fontSize, fontFamily, bold) {\n\t\t\tmaxWidth = maxWidth || 0;\n\t\t\tfontSize = fontSize || 11;\n\t\t\tfontFamily = fontFamily || 'Arial,Helvetica';\n\t\t\tbold = !_lodash2.default.isUndefined(bold) ? bold : false;\n\t\n\t\t\tvar arr = [];\n\t\t\tvar spaceSize = getStringSize(\"&nbsp;\", fontSize, fontFamily, bold),\n\t\t\t    space = spaceSize.width;\n\t\t\tarr.lineHeight = spaceSize.height;\n\t\t\tarr.baseline = spaceSize.baseline;\n\t\n\t\t\tif (!maxWidth || !string || string == \"\") {\n\t\t\t\tarr.push(string);\n\t\t\t\tarr.width = !string || string == \"\" ? space : getStringSize(string, fontSize, fontFamily, bold).width;\n\t\t\t\tarr.height = arr.lineHeight;\n\t\t\t\treturn arr;\n\t\t\t}\n\t\n\t\t\tvar width = 0;\n\t\t\t//split the text by lines\n\t\t\tvar lines = string.split('\\n');\n\t\n\t\t\tvar buf = new _StringBuffer2.default();\n\t\n\t\t\tfor (var j = 0; j < lines.length; j++) {\n\t\t\t\t//split each line by word\n\t\t\t\tvar words = lines[j].split(/\\s/);\n\t\t\t\tvar line = \"\",\n\t\t\t\t    currentWidth = 0,\n\t\t\t\t    wordWidth = 0,\n\t\t\t\t    newLine = true,\n\t\t\t\t    word;\n\t\n\t\t\t\tfor (var i = 0; i < words.length; i++) {\n\t\t\t\t\tword = words[i];\n\t\t\t\t\twordWidth = getStringSize(word, fontSize, fontFamily, bold).width;\n\t\n\t\t\t\t\tif ((newLine ? wordWidth : currentWidth + space + wordWidth) > maxWidth) {\n\t\t\t\t\t\tif (newLine) {\n\t\t\t\t\t\t\tbuf.append(word);\n\t\t\t\t\t\t\twidth = Math.max(width, wordWidth);\n\t\t\t\t\t\t\tif (i < words.length - 1) {\n\t\t\t\t\t\t\t\tarr.push(buf.toString());\n\t\t\t\t\t\t\t\tbuf.clear();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tarr.push(buf.append(line).toString());\n\t\t\t\t\t\t\twidth = Math.max(width, currentWidth + space + wordWidth);\n\t\t\t\t\t\t\tbuf.clear();\n\t\t\t\t\t\t}\n\t\t\t\t\t\tline = \"\";\n\t\t\t\t\t\tcurrentWidth = 0;\n\t\t\t\t\t\tif (!newLine) i--; // move back one word.\n\t\t\t\t\t\tnewLine = true;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tline = newLine ? word : line + \" \" + word;\n\t\t\t\t\t\tcurrentWidth = newLine ? wordWidth : currentWidth + space + wordWidth;\n\t\t\t\t\t\twidth = Math.max(width, currentWidth);\n\t\t\t\t\t\tnewLine = false;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (line != \"\") buf.append(line);\n\t\t\t\tif (j < lines.length - 1) {\n\t\t\t\t\tarr.push(buf.toString());\n\t\t\t\t\tbuf.clear();\n\t\t\t\t}\n\t\t\t}\n\t\n\t\t\tarr.push(buf.toString());\n\t\t\tarr.width = width;\n\t\t\tarr.height = arr.lineHeight * arr.length;\n\t\t\treturn arr;\n\t\t}, function (str, maxWidth, fontSize, fontFamily, bold) {\n\t\t\treturn str + ';' + maxWidth + ';' + fontSize + ';' + fontFamily + ';' + bold;\n\t\t});\n\t\n\t\t/**\n\t  *  Get the view information for how to display the label.\n\t  * @param label The string that needs to be displayed\n\t  * @param containerWidth The width of the parent container.\n\t  * @param containerHeight The height of the parent container.\n\t  * @param labelConfig The configuration on how to display label. It should be an object with the following parameters:\n\t  * {\n\t  *      fontSize, fontFamily, fontStyle, padding,\n\t  *      align: can be either \"left\", \"center\" or \"right\",\n\t  *      width: the maximum width of the label. if less than 1, then is treated as percentage. If 0, no wrapping will occur,\n\t  *      height,\n\t  *      geometry\n\t  * }\n\t  * @returns {*}\n\t  */\n\t\tfunction getLabelBox(label, labelConfig, containerWidth, containerHeight) {\n\t\t\treturn _getLabelBox.call(this, label, labelConfig, { width: containerWidth, height: containerHeight });\n\t\t}\n\t\n\t\tfunction getLabelBoxForLink(label, labelConfig, link) {\n\t\t\treturn _getLabelBox.call(this, label, labelConfig, link);\n\t\t}\n\t\n\t\tfunction _getLabelBox(label) {\n\t\t\tvar labelConfig = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n\t\t\tvar context = arguments[2];\n\t\n\t\t\tlabelConfig = _lodash2.default.defaultsDeep(labelConfig, defaultConfig);\n\t\t\tvar fontSize = labelConfig.fontSize;\n\t\t\tvar fontFamily = labelConfig.fontFamily;\n\t\t\tvar fontStyle = labelConfig.fontStyle;\n\t\t\tvar bold = (fontStyle & FONT_BOLD) == FONT_BOLD;\n\t\t\tvar padding = labelConfig.padding;\n\t\t\tvar linePadding = labelConfig.linePadding;\n\t\t\tvar align = labelConfig.align;\n\t\n\t\t\tvar w = labelConfig.width,\n\t\t\t    h = labelConfig.height;\n\t\t\tif (context.width) {\n\t\t\t\tw = w <= 5 ? context.width * w : w;\n\t\t\t\th = h <= 5 ? context.height * h : h;\n\t\t\t}\n\t\t\tw -= 2 * padding;\n\t\t\th -= 2 * padding;\n\t\t\tw = Math.max(0, w);\n\t\t\th = Math.max(0, h);\n\t\n\t\t\tvar geometry = _lodash2.default.clone(labelConfig.geometry);\n\t\t\tvar wrappedLabel = this.wrap(label, w, fontSize, fontFamily, bold);\n\t\t\tgeometry.width = wrappedLabel.width + 2 * padding;\n\t\t\tgeometry.height = wrappedLabel.height + 2 * padding + (wrappedLabel.length - 1) * linePadding;\n\t\t\tvar anchor = \"start\",\n\t\t\t    dx = 0,\n\t\t\t    setAnchorX = !_lodash2.default.has(geometry, \"anchorX\");\n\t\t\tswitch (align) {\n\t\t\t\tcase \"center\":\n\t\t\t\t\tanchor = \"middle\";\n\t\t\t\t\tif (setAnchorX) geometry.anchorX = 0;\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"right\":\n\t\t\t\t\tanchor = \"end\";\n\t\t\t\t\tdx = wrappedLabel.width / 2;\n\t\t\t\t\tif (setAnchorX) geometry.anchorX = -0.5;\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"left\":\n\t\t\t\t\tdx = -wrappedLabel.width / 2;\n\t\t\t\t\tif (setAnchorX) geometry.anchorX = 0.5;\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t\tvar pos = void 0;\n\t\t\tif (context.getRelativePosition) pos = context.getRelativePosition(geometry);else pos = _Utils2.default.getRelativePosition({ width: context.width, height: context.height }, geometry);\n\t\n\t\t\tvar bounds = new _Rectangle2.default(pos[0], pos[1], geometry.width, geometry.height);\n\t\t\t// the pivot is the center of rotation when the label has a rotation specified.\n\t\t\tvar pivot = align == 'center' ? [0, 0] : align == 'left' ? [-wrappedLabel.width / 2, 0] : [wrappedLabel.width / 2, 0];\n\t\n\t\t\t// the maximum bounds for the label, used to position inline editor\n\t\t\tgeometry.width = Math.max(w + 2 * padding, geometry.width);\n\t\t\tgeometry.height = Math.max(h + 2 * padding, geometry.height);\n\t\n\t\t\tif (context.getRelativePosition) pos = context.getRelativePosition(geometry);else pos = _Utils2.default.getRelativePosition({ width: context.width, height: context.height }, geometry);\n\t\n\t\t\tvar maxBounds = new _Rectangle2.default(pos[0], pos[1], geometry.width, geometry.height);\n\t\t\treturn {\n\t\t\t\tconfig: labelConfig, label: wrappedLabel, _label: label,\n\t\t\t\tbold: bold, underline: fontStyle & FONT_UNDERLINE, italic: fontStyle & FONT_ITALIC, shadow: fontStyle & FONT_SHADOW,\n\t\t\t\tdx: dx, dy: -geometry.height / 2 + padding + wrappedLabel.lineHeight - wrappedLabel.baseline, anchor: anchor, lineHeight: wrappedLabel.lineHeight + linePadding,\n\t\t\t\tpivot: pivot, bounds: bounds, maxBounds: maxBounds\n\t\t\t};\n\t\t}\n\t\n\t\tfunction render(view, box) {\n\t\t\treturn view.renderLabel(box);\n\t\t}\n\t\n\t\t// This is the inline editor for editing label text in place.\n\t\tvar editor = {\n\t\t\tstart: function start(key, container, box, refEl, textEl) {\n\t\t\t\tvar _this = this;\n\t\n\t\t\t\tvar scale = arguments.length > 5 && arguments[5] !== undefined ? arguments[5] : 1.0;\n\t\t\t\tvar singleLine = arguments.length > 6 && arguments[6] !== undefined ? arguments[6] : true;\n\t\n\t\t\t\tif (this.input) {\n\t\t\t\t\tif (this.key != key) {\n\t\t\t\t\t\t// need to close the existing editor first\n\t\t\t\t\t\tthis.stop();\n\t\t\t\t\t} else return;\n\t\t\t\t}\n\t\t\t\tvar tag = singleLine ? 'input' : 'textarea';\n\t\t\t\tthis.input = _DomUtils2.default.createElement(tag, { id: \"inlineEditor\", unselectable: \"off\" }, { position: \"absolute\", overflow: \"hidden\", padding: \"0px\", margin: \"0px\", border: \"transparent\" });\n\t\t\t\tif (singleLine) {\n\t\t\t\t\t_bean2.default.on(this.input, 'keydown keyup', function (event) {\n\t\t\t\t\t\tif (event.keyCode == 13) {\n\t\t\t\t\t\t\t_bean2.default.off(_this.input, 'keydown keyup');\n\t\t\t\t\t\t\t_this.stop();\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\tcontainer.appendChild(this.input);\n\t\n\t\t\t\tthis.key = key;\n\t\t\t\tthis.box = box;\n\t\t\t\tthis.refEl = refEl;\n\t\t\t\tthis.textEl = textEl;\n\t\n\t\t\t\tvar labelConfig = box.config;\n\t\t\t\tvar maxBounds = new _Rectangle2.default(box.maxBounds.x, box.maxBounds.y, box.maxBounds.width * scale, box.maxBounds.height * scale);\n\t\t\t\tvar pos = _DomUtils2.default.getCenterPosition(refEl, container);\n\t\t\t\tpos = [pos[0] + maxBounds.left, pos[1] + maxBounds.top];\n\t\n\t\t\t\tif (textEl) textEl.style.visibility = 'hidden';\n\t\n\t\t\t\t_DomUtils2.default.setElement(this.input, null, {\n\t\t\t\t\tvisibility: 'visible',\n\t\t\t\t\tleft: pos[0] + \"px\",\n\t\t\t\t\ttop: pos[1] + \"px\",\n\t\t\t\t\twidth: maxBounds.width + 'px',\n\t\t\t\t\theight: maxBounds.height + 'px',\n\t\t\t\t\t\"font-family\": labelConfig.fontFamily,\n\t\t\t\t\t\"font-size\": labelConfig.fontSize * scale + 'px',\n\t\t\t\t\t\"font-weight\": (labelConfig.fontStyle & FONT_BOLD) == FONT_BOLD ? 'bold' : 'normal'\n\t\t\t\t\t/*\"color\": labelConfig.fontColor*/\n\t\t\t\t});\n\t\n\t\t\t\tthis.input.value = box._label;\n\t\t\t\tthis.input.focus();\n\t\t\t\tthis.input.select();\n\t\t\t\t_bean2.default.fire(this, 'editor.start', [this.key]);\n\t\t\t},\n\t\n\t\t\tstop: function stop(cancel) {\n\t\t\t\tif (!this.input) return;\n\t\n\t\t\t\tcancel = cancel || false;\n\t\t\t\tif (this.textEl) this.textEl.style.visibility = null;\n\t\n\t\t\t\t// remove the input\n\t\t\t\tthis.input.parentNode.removeChild(this.input);\n\t\n\t\t\t\tif (!cancel) _bean2.default.fire(this, 'editor.update', [this.key, this.input.value]);\n\t\n\t\t\t\t_bean2.default.fire(this, 'editor.stop', [this.key]);\n\t\n\t\t\t\tdelete this.input;\n\t\t\t\tdelete this.key;\n\t\t\t\tdelete this.box;\n\t\t\t\tdelete this.refEl;\n\t\t\t\tdelete this.textEl;\n\t\t\t}\n\t\t};\n\t\n\t\treturn {\n\t\t\tFONT_BOLD: FONT_BOLD,\n\t\t\tFONT_ITALIC: FONT_ITALIC,\n\t\t\tFONT_UNDERLINE: FONT_UNDERLINE,\n\t\t\tFONT_SHADOW: FONT_SHADOW,\n\t\t\tgetStringSize: getStringSize,\n\t\t\twrap: wrap,\n\t\t\tgetLabelBox: getLabelBox,\n\t\t\tgetLabelBoxForLink: getLabelBoxForLink,\n\t\t\trender: render,\n\t\t\teditor: editor\n\t\t};\n\t}();\n\n/***/ }),\n/* 21 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t\tvalue: true\n\t});\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tvar _get = function get(object, property, receiver) { if (object === null) object = Function.prototype; var desc = Object.getOwnPropertyDescriptor(object, property); if (desc === undefined) { var parent = Object.getPrototypeOf(object); if (parent === null) { return undefined; } else { return get(parent, property, receiver); } } else if (\"value\" in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } };\n\t\n\tvar _lodash = __webpack_require__(5);\n\t\n\tvar _lodash2 = _interopRequireDefault(_lodash);\n\t\n\tvar _Cell2 = __webpack_require__(18);\n\t\n\tvar _Cell3 = _interopRequireDefault(_Cell2);\n\t\n\tvar _Rectangle = __webpack_require__(4);\n\t\n\tvar _Rectangle2 = _interopRequireDefault(_Rectangle);\n\t\n\tvar _Link = __webpack_require__(12);\n\t\n\tvar _Link2 = _interopRequireDefault(_Link);\n\t\n\tvar _Label = __webpack_require__(20);\n\t\n\tvar _Label2 = _interopRequireDefault(_Label);\n\t\n\tvar _Cache = __webpack_require__(19);\n\t\n\tvar _Cache2 = _interopRequireDefault(_Cache);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\t\n\tfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\t\n\tvar Edge = function (_Cell) {\n\t\t_inherits(Edge, _Cell);\n\t\n\t\tfunction Edge(graph) {\n\t\t\tvar config = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n\t\t\tvar source = arguments[2];\n\t\t\tvar target = arguments[3];\n\t\n\t\t\t_classCallCheck(this, Edge);\n\t\n\t\t\tif (!config.id) config.id = _lodash2.default.uniqueId('E');\n\t\n\t\t\tvar _this = _possibleConstructorReturn(this, (Edge.__proto__ || Object.getPrototypeOf(Edge)).call(this, graph, config));\n\t\n\t\t\t_this.source = _this.target = null;\n\t\t\t_this.setSource(source, config.sourcePos);\n\t\t\t_this.setTarget(target, config.targetPos);\n\t\t\treturn _this;\n\t\t}\n\t\n\t\t_createClass(Edge, [{\n\t\t\tkey: \"setSource\",\n\t\t\tvalue: function setSource(node, pos) {\n\t\t\t\tthis.setTerminal(node, pos, 'source');\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"setTarget\",\n\t\t\tvalue: function setTarget(node, pos) {\n\t\t\t\tthis.setTerminal(node, pos, 'target');\n\t\t\t}\n\t\n\t\t\t/**\n\t   * Internal methods to set either the source or target\n\t   */\n\t\n\t\t}, {\n\t\t\tkey: \"setTerminal\",\n\t\t\tvalue: function setTerminal(node, pos, dir) {\n\t\t\t\tvar end = dir == 'source' ? this.source : this.target;\n\t\t\t\tif (end == node) {\n\t\t\t\t\t// simply change the position of the edge.\n\t\t\t\t\tif (node) node.setEdgeAt(this, pos);\n\t\t\t\t} else {\n\t\t\t\t\tif (end) {\n\t\t\t\t\t\t// first remove the edge from the current end\n\t\t\t\t\t\tend.removeEdge(this);\n\t\t\t\t\t}\n\t\n\t\t\t\t\tif (node) {\n\t\t\t\t\t\tif (dir == 'source') node.addOutEdge(this, pos);else node.addInEdge(this, pos);\n\t\t\t\t\t}\n\t\t\t\t\tif (dir == 'source') this.source = node;else this.target = node;\n\t\t\t\t\t//this.clearPoints();\n\t\t\t\t}\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"getLabelBox\",\n\t\t\tvalue: function getLabelBox(key) {\n\t\t\t\tvar label = this.prop('label');\n\t\t\t\tif (label) return _Label2.default.getLabelBoxForLink(label, this.viewProp(key, 'labelConfig'), this.getShape(key));\n\t\t\t\treturn null;\n\t\t\t}\n\t\n\t\t\t/**\n\t   * Return a pair of points as reference to the calculation of start and end points.\n\t   */\n\t\n\t\t}, {\n\t\t\tkey: \"getReferencePoints\",\n\t\t\tvalue: function getReferencePoints(key) {\n\t\t\t\tvar pts = [];\n\t\t\t\tif (this.source) pts.push(this.source.getShape(key).center);else pts.push(this.viewProp(key, 'start'));\n\t\n\t\t\t\tif (this.target) pts.push(this.target.getShape(key).center);else pts.push(this.viewProp(key, 'end'));\n\t\n\t\t\t\treturn pts;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"getTerminalVisual\",\n\t\t\tvalue: function getTerminalVisual(key, orthogonal) {\n\t\t\t\tvar refPts = this.getReferencePoints(key);\n\t\t\t\tvar terminals = [];\n\t\n\t\t\t\tvar getBound = function getBound(pt) {\n\t\t\t\t\treturn new _Rectangle2.default(pt.x, pt.y, 3, 3);\n\t\t\t\t};\n\t\n\t\t\t\tif (this.source) {\n\t\t\t\t\tterminals.push(this.source.getPort(key, this.prop('sourcePort'), refPts[1], orthogonal));\n\t\t\t\t} else terminals.push({ point: refPts[0], direction: _Rectangle2.default.getDirection(getBound(refPts[0]), refPts[1], true) });\n\t\n\t\t\t\tif (this.target) {\n\t\t\t\t\tterminals.push(this.target.getPort(key, this.prop('targetPort'), refPts[0], orthogonal));\n\t\t\t\t} else terminals.push({ point: refPts[1], direction: _Rectangle2.default.getDirection(getBound(refPts[1]), refPts[0], true) });\n\t\t\t\treturn terminals;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"getShape\",\n\t\t\tvalue: function getShape(key) {\n\t\t\t\tvar shape = _Cache2.default.get(this.id + \".shape\", key);\n\t\t\t\tif (shape) return shape;\n\t\n\t\t\t\tvar config = this.viewProp(key, 'shape');\n\t\t\t\tshape = _Link2.default.getLink(this.getTerminalVisual(key, config.orthogonal), config, this.prop('startMarker'), this.prop('endMarker'));\n\t\t\t\t_Cache2.default.set(this.id + '.shape', shape, key);\n\t\t\t\treturn shape;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"toString\",\n\t\t\tvalue: function toString() {\n\t\t\t\treturn 'Edge:{' + (!this.source ? 'null' : this.source.id) + '--' + (!this.target ? 'null' : this.target.id) + '}';\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"destroy\",\n\t\t\tvalue: function destroy() {\n\t\t\t\t_get(Edge.prototype.__proto__ || Object.getPrototypeOf(Edge.prototype), \"destroy\", this).call(this);\n\t\t\t\tthis.setSource(null);\n\t\t\t\tthis.setTarget(null);\n\t\t\t}\n\t\t}]);\n\t\n\t\treturn Edge;\n\t}(_Cell3.default);\n\t\n\tEdge.namespace = \"Edges\";\n\t\n\texports.default = Edge;\n\t\n\t/*\n\t\n\tEdge.prototype.isVisible = function() {\n\t\tif (this.graph.getProperty(\"allowDanglingEdges\")) {\n\t\t\treturn (this.source ? this.source.isVisible() : true) && (this.target ? this.target.isVisible() : true) && this.getProperty(\"visible\");\n\t\t} else\n\t\t\treturn this.source && this.target && this.getProperty('visible') && this.source.isVisible() && this.target.isVisible();\n\t};\n\n\t*/\n\n/***/ }),\n/* 22 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t\tvalue: true\n\t});\n\t\n\tvar _Rectangle = __webpack_require__(4);\n\t\n\tvar _Rectangle2 = _interopRequireDefault(_Rectangle);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tvar registry = {};\n\t\n\tvar Marker = function () {\n\t\n\t\t/** Begin Standard Marker Type **/\n\t\tfunction arrow(size, source, styles) {\n\t\t\tvar sign = source ? -1 : 1;\n\t\t\tvar marker = {\n\t\t\t\tviewBox: new _Rectangle2.default(-5, -5, 10, 10),\n\t\t\t\tsize: size,\n\t\t\t\tref: [4 * sign, 0],\n\t\t\t\tfill: styles.color\n\t\t\t};\n\t\t\tmarker.shape = {\n\t\t\t\tname: 'Polygon',\n\t\t\t\tpoints: [[-2 * sign, 0], [-4 * sign, 4], [4 * sign, 0], [-4 * sign, -4]]\n\t\t\t};\n\t\t\treturn marker;\n\t\t}\n\t\n\t\tfunction triangle(size, source, styles) {\n\t\t\tvar sign = source ? -1 : 1;\n\t\t\tvar marker = {\n\t\t\t\tviewBox: new _Rectangle2.default(-5, -5, 10, 10),\n\t\t\t\tsize: size,\n\t\t\t\tref: [4 * sign, 0],\n\t\t\t\tfill: styles.color\n\t\t\t};\n\t\t\tmarker.shape = {\n\t\t\t\tname: 'Polygon',\n\t\t\t\tpoints: [[-5 * sign, -5], [-5 * sign, 5], [4 * sign, 0]]\n\t\t\t};\n\t\t\treturn marker;\n\t\t}\n\t\n\t\tfunction oval(size, source, styles) {\n\t\t\tvar r = size / 2;\n\t\t\tvar marker = {\n\t\t\t\tviewBox: new _Rectangle2.default(-r, -r, size, size),\n\t\t\t\tsize: size,\n\t\t\t\tref: [0, 0],\n\t\t\t\tfill: styles.color\n\t\t\t};\n\t\t\tmarker.shape = '<ellipse cx=\"0\" cy=\"0\" rx=\"' + r + '\" ry=\"' + r + '\"></ellipse>';\n\t\t\treturn marker;\n\t\t}\n\t\n\t\tfunction diamond(size, source, styles) {\n\t\t\tvar sign = source ? -1 : 1;\n\t\t\tvar marker = {\n\t\t\t\tviewBox: new _Rectangle2.default(-5, -5, 10, 10),\n\t\t\t\tsize: size,\n\t\t\t\tref: [4 * sign, 0],\n\t\t\t\tfill: styles.color\n\t\t\t};\n\t\t\tmarker.shape = {\n\t\t\t\tname: 'Polygon',\n\t\t\t\tpoints: [[-4, 0], [0, 4], [4, 0], [0, -4]]\n\t\t\t};;\n\t\t\treturn marker;\n\t\t}\n\t\t/** End Standard Marker Type **/\n\t\tfunction getMarker(config, source) {\n\t\t\tvar factory = registry[config.type];\n\t\t\tvar marker = factory(config.size, source, config);\n\t\t\tmarker.id = config.id;\n\t\t\treturn marker;\n\t\t}\n\t\n\t\tregistry['arrow'] = arrow;\n\t\tregistry['triangle'] = triangle;\n\t\tregistry['oval'] = oval;\n\t\tregistry['diamond'] = diamond;\n\t\n\t\treturn {\n\t\t\tregistry: registry,\n\t\t\tgetMarker: getMarker\n\t\t};\n\t}();\n\t\n\texports.default = Marker;\n\n/***/ }),\n/* 23 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t\tvalue: true\n\t});\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tvar _lodash = __webpack_require__(5);\n\t\n\tvar _lodash2 = _interopRequireDefault(_lodash);\n\t\n\tvar _Utils = __webpack_require__(2);\n\t\n\tvar _Utils2 = _interopRequireDefault(_Utils);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tvar Layout = function () {\n\t\tfunction Layout() {\n\t\t\tvar config = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n\t\n\t\t\t_classCallCheck(this, Layout);\n\t\n\t\t\tif (config.hasOwnProperty(\"orientation\") && _lodash2.default.isString(config.orientation)) {\n\t\t\t\tif (config.orientation.toUpperCase() == \"HORIZONTAL\") config.orientation = Layout.HORIZONTAL;else delete config.orientation;\n\t\t\t}\n\t\t\t_Utils2.default.initConfig(this, config);\n\t\t}\n\t\n\t\t_createClass(Layout, [{\n\t\t\tkey: \"layout\",\n\t\t\tvalue: function layout(root, bounds) {}\n\t\t}, {\n\t\t\tkey: \"reset\",\n\t\t\tvalue: function reset() {}\n\t\t}, {\n\t\t\tkey: \"destroy\",\n\t\t\tvalue: function destroy() {}\n\t\t}]);\n\t\n\t\treturn Layout;\n\t}();\n\t\n\tLayout.VERTICAL = 0;\n\tLayout.HORIZONTAL = 1;\n\t\n\tLayout.DEFAULTS = {\n\t\torientation: Layout.VERTICAL\n\t};\n\t\n\texports.default = Layout;\n\n/***/ }),\n/* 24 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t\tvalue: true\n\t});\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tvar _Layout2 = __webpack_require__(23);\n\t\n\tvar _Layout3 = _interopRequireDefault(_Layout2);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\t\n\tfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\t\n\tvar FlowLayout = function (_Layout) {\n\t\t_inherits(FlowLayout, _Layout);\n\t\n\t\tfunction FlowLayout() {\n\t\t\t_classCallCheck(this, FlowLayout);\n\t\n\t\t\treturn _possibleConstructorReturn(this, (FlowLayout.__proto__ || Object.getPrototypeOf(FlowLayout)).apply(this, arguments));\n\t\t}\n\t\n\t\t_createClass(FlowLayout, [{\n\t\t\tkey: \"layout\",\n\t\t\tvalue: function layout(root, bounds) {\n\t\t\t\tvar items;\n\t\t\t\tif (!root) items = this.owner.childNodes;else if (_.isArray(root)) items = root;else items = root.getLinkedNodes('target');\n\t\t\t\tif (!items || items.length == 0) return;\n\t\n\t\t\t\tvar x = 0,\n\t\t\t\t    y = 0,\n\t\t\t\t    h = 0,\n\t\t\t\t    node;\n\t\t\t\tvar p1 = 0,\n\t\t\t\t    p2 = 0;\n\t\t\t\tfor (var i = 0; i < items.length; i++) {\n\t\t\t\t\tnode = items[i];\n\t\t\t\t\tif (x > 0 && x + this.hgap + node.getProperty(\"width\") > bounds.width) {\n\t\t\t\t\t\t// create new line\n\t\t\t\t\t\ty += h + this.vgap;\n\t\t\t\t\t\tx = 0;h = 0;p1 = 0;p2++;\n\t\t\t\t\t}\n\t\t\t\t\tnode._flPos = [p1, p2];\n\t\t\t\t\tnode.moveTo([bounds.x + x, bounds.y + y]);\n\t\t\t\t\tx += this.hgap + node.getProperty(\"width\");\n\t\t\t\t\tp1++;\n\t\t\t\t\th = h < node.getProperty(\"height\") ? node.getProperty(\"height\") : h;\n\t\t\t\t}\n\t\t\t\tthis.trigger(new Rectangle(bounds.x, bounds.y, bounds.width, y + h));\n\t\t\t}\n\t\t}]);\n\t\n\t\treturn FlowLayout;\n\t}(_Layout3.default);\n\t\n\tFlowLayout.DEFAULTS = {\n\t\thgap: 10,\n\t\tvgap: 10\n\t};\n\t\n\texports.default = FlowLayout;\n\n/***/ }),\n/* 25 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t\tvalue: true\n\t});\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tvar _lodash = __webpack_require__(5);\n\t\n\tvar _lodash2 = _interopRequireDefault(_lodash);\n\t\n\tvar _bean = __webpack_require__(13);\n\t\n\tvar _bean2 = _interopRequireDefault(_bean);\n\t\n\tvar _Utils = __webpack_require__(2);\n\t\n\tvar _Utils2 = _interopRequireDefault(_Utils);\n\t\n\tvar _DomUtils = __webpack_require__(7);\n\t\n\tvar _DomUtils2 = _interopRequireDefault(_DomUtils);\n\t\n\tvar _Layout = __webpack_require__(23);\n\t\n\tvar _Layout2 = _interopRequireDefault(_Layout);\n\t\n\tvar _Rectangle = __webpack_require__(4);\n\t\n\tvar _Rectangle2 = _interopRequireDefault(_Rectangle);\n\t\n\tvar _EventDispatcher = __webpack_require__(14);\n\t\n\tvar _EventDispatcher2 = _interopRequireDefault(_EventDispatcher);\n\t\n\tvar _GraphBehavior = __webpack_require__(26);\n\t\n\tvar _GraphBehavior2 = _interopRequireDefault(_GraphBehavior);\n\t\n\tvar _SelectionBehavior = __webpack_require__(28);\n\t\n\tvar _SelectionBehavior2 = _interopRequireDefault(_SelectionBehavior);\n\t\n\tvar _Label = __webpack_require__(20);\n\t\n\tvar _Label2 = _interopRequireDefault(_Label);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tvar Renderer = function () {\n\t\tfunction Renderer(id, container) {\n\t\t\tvar config = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n\t\t\tvar graph = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : null;\n\t\n\t\t\t_classCallCheck(this, Renderer);\n\t\n\t\t\tthis.id = id;\n\t\t\tthis.box = _DomUtils2.default.createElement('div', { id: this.id, tabindex: 0, ns: 'graph' }, { overflow: \"hidden\", width: \"100%\", height: \"100%\", position: 'relative' });\n\t\t\tcontainer.appendChild(this.box);\n\t\t\tif (config.layout) {\n\t\t\t\tvar layoutClass = _Utils2.default.getConstructor(config.layout.jsClass, _Layout2.default);\n\t\t\t\tthis.layout = new layoutClass(config.layout.config);\n\t\t\t\tdelete config.layout;\n\t\t\t}\n\t\t\tthis.clear = true;\n\t\t\tthis._translate = [0, 0];\n\t\t\tthis._scale = 1.0;\n\t\t\tthis.graph = graph;\n\t\t\tthis.dispatcher = null;\n\t\t\tthis.graphBehavior = null;\n\t\t\tthis.selectionBehavior = null;\n\t\t\tthis.nodeBehavior = null;\n\t\t\tthis.edgeBehavior = null;\n\t\t\tthis.connectionBehavior = null;\n\t\t\t_Utils2.default.initConfig(this, config);\n\t\n\t\t\t_bean2.default.on(_Label2.default.editor, 'editor.update.*', _lodash2.default.bind(function (key, value) {\n\t\t\t\t//this.graph.nodes[key].prop('label', value);\n\t\t\t\t//this.render();\n\t\t\t\tconsole.log(key + '=' + value);\n\t\t\t}, this));\n\t\t}\n\t\n\t\t_createClass(Renderer, [{\n\t\t\tkey: \"viewport\",\n\t\t\tvalue: function viewport(scaled, _viewport) {\n\t\t\t\tif (_lodash2.default.isUndefined(scaled) || _lodash2.default.isNull(scaled)) scaled = false;\n\t\t\t\tif (!_viewport) {\n\t\t\t\t\tvar vp = new _Rectangle2.default(0, 0, this.box.offsetWidth, this.box.offsetHeight);\n\t\t\t\t\tif (scaled) return _Utils2.default.scale(this.translate, this.scale, vp);\n\t\t\t\t\treturn vp;\n\t\t\t\t}\n\t\t\t\tif (!scaled) _viewport = _Utils2.default.scale(this.translate, this.scale, _viewport);\n\t\t\t\tvar w = this.box.offsetWidth;\n\t\t\t\tvar scale = w / _viewport.width;\n\t\t\t\tthis.transform(-_viewport.x * scale, -_viewport.y * scale, scale);\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"transform\",\n\t\t\tvalue: function transform() {\n\t\t\t\tvar x = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : null;\n\t\t\t\tvar y = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : null;\n\t\t\t\tvar scale = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : null;\n\t\n\t\t\t\tvar graph = this.graph;\n\t\t\t\tvar root = graph ? graph.currentRoot : null;\n\t\t\t\tif (!_lodash2.default.isNull(x)) {\n\t\t\t\t\tthis._translate[0] = x;\n\t\t\t\t\tif (root) root.viewProp(this.id, 'x', x);\n\t\t\t\t}\n\t\t\t\tif (!_lodash2.default.isNull(y)) {\n\t\t\t\t\tthis._translate[1] = y;\n\t\t\t\t\tif (root) root.viewProp(this.id, 'y', y);\n\t\t\t\t}\n\t\t\t\tif (!_lodash2.default.isNull(scale)) {\n\t\t\t\t\tthis._scale = scale;\n\t\t\t\t\tif (root) root.viewProp(this.id, 'scale', scale);\n\t\t\t\t\t// sync the scale between the dispatcher and the graph\n\t\t\t\t\tvar s = this.dispatcher.scale;\n\t\t\t\t\tif (s != scale) this.dispatcher.scale = scale;\n\t\t\t\t}\n\t\t\t\tthis.refresh();\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"render\",\n\t\t\tvalue: function render() {\n\t\t\t\tif (!this._graph) return false;\n\t\t\t\tif (this.layout) this.layout.layout(this._graph.currentRoot, this.viewport());\n\t\n\t\t\t\tthis.initializeBehaviors();\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"renderLabel\",\n\t\t\tvalue: function renderLabel(box) {\n\t\t\t\treturn this.constructor.renderLabel(box);\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"renderLink\",\n\t\t\tvalue: function renderLink(shape) {\n\t\t\t\treturn this.constructor.renderLink(shape);\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"renderMarkers\",\n\t\t\tvalue: function renderMarkers(markers) {\n\t\t\t\treturn this.constructor.renderMarkers(markers);\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"initializeBehaviors\",\n\t\t\tvalue: function initializeBehaviors() {\n\t\t\t\t// create the event dispatcher if necessary.\n\t\t\t\tif (!this.dispatcher) {\n\t\t\t\t\tthis.dispatcher = new _EventDispatcher2.default(this.box, [this.prop('minZoom'), this.prop('maxZoom')]);\n\t\t\t\t\tvar jsClass = void 0;\n\t\t\t\t\tif (this.prop('graphBehavior')) {\n\t\t\t\t\t\tjsClass = _Utils2.default.getConstructor(this.prop('graphBehavior'));\n\t\t\t\t\t\tthis.graphBehavior = new jsClass(this);\n\t\t\t\t\t}\n\t\t\t\t\tif (this.prop('selectionBehavior')) {\n\t\t\t\t\t\tjsClass = _Utils2.default.getConstructor(this.prop('selectionBehavior'));\n\t\t\t\t\t\tthis.selectionBehavior = new jsClass(this);\n\t\t\t\t\t}\n\t\t\t\t\tthis.dispatcher.register('mouseup.node.label', function (type, ns, target, pos, event) {\n\t\t\t\t\t\tvar _this = this;\n\t\n\t\t\t\t\t\tvar node = this._graph.nodes[target.getAttribute('id')];\n\t\t\t\t\t\tif (!this.dispatcher.dragging && !node._firstSelection) {\n\t\t\t\t\t\t\t_Label2.default._delayEdit = _lodash2.default.delay(function () {\n\t\t\t\t\t\t\t\tif (_Label2.default._delayEdit) {\n\t\t\t\t\t\t\t\t\tdelete _Label2.default._delayEdit;\n\t\t\t\t\t\t\t\t\t_Label2.default.editor.start(node.id, _this.box, node.getLabelBox(_this.id), target, event.nsTarget, _this.scale);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}, 250);\n\t\t\t\t\t\t}\n\t\t\t\t\t}, this);\n\t\t\t\t\tthis.dispatcher.register([/^mousedown/, /^zoom/], function (type, ns, target, pos, event) {\n\t\t\t\t\t\tif (!_DomUtils2.default.eventFromInput(event)) {\n\t\t\t\t\t\t\t_Label2.default.editor.stop();\n\t\t\t\t\t\t}\n\t\t\t\t\t}, this);\n\t\t\t\t}\n\t\t\t\tthis.dispatcher.start();\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"refresh\",\n\t\t\tvalue: function refresh() {}\n\t\n\t\t\t/**\n\t   * Get the template for the specified key.\n\t   * @param key\n\t   * @param config if the template is a function, this config will be passed as the argument.\n\t   * @param preprocessor if the template contains preprossing elements, such as #{shape}, the preprocessor will be\n\t   * used to render them.\n\t   * @returns {*}\n\t   */\n\t\n\t\t}, {\n\t\t\tkey: \"getTemplate\",\n\t\t\tvalue: function getTemplate(key, config, preprocessor) {\n\t\t\t\tvar t = this.constructor.TEMPLATES[key];\n\t\t\t\tif (t && _lodash2.default.isFunction(t)) {\n\t\t\t\t\tt = t(config);\n\t\t\t\t}\n\t\t\t\t// check if there are any preprocessing tags.\n\t\t\t\tif (preprocessor) {\n\t\t\t\t\tvar parts = t.match(/(#{[^#]*})/g);\n\t\t\t\t\tvar obj = {};\n\t\t\t\t\tfor (var part in parts) {\n\t\t\t\t\t\tpart = parts[part];\n\t\t\t\t\t\tpart = part.substring(2, part.length - 1).trim();\n\t\t\t\t\t\tobj[part] = preprocessor[_lodash2.default.camelCase('render ' + part)](this);\n\t\t\t\t\t}\n\t\t\t\t\tt = _lodash2.default.template(t, { interpolate: /#{([\\s\\S]+?)}/g })(obj);\n\t\t\t\t}\n\t\t\t\treturn t;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"reset\",\n\t\t\tvalue: function reset() {}\n\t\t}, {\n\t\t\tkey: \"destroy\",\n\t\t\tvalue: function destroy() {\n\t\t\t\tdelete this._graph;\n\t\t\t\tdelete this.layout;\n\t\t\t\tif (this.dispatcher) {\n\t\t\t\t\tthis.dispatcher.stop();\n\t\t\t\t\tdelete this.dispatcher;\n\t\t\t\t}\n\t\t\t\tthis.box.innerHTML = '';\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"graph\",\n\t\t\tget: function get() {\n\t\t\t\treturn this._graph;\n\t\t\t},\n\t\t\tset: function set(graph) {\n\t\t\t\tthis._graph = graph;\n\t\t\t\tvar root = graph.currentRoot;\n\t\t\t\tif (root) {\n\t\t\t\t\tthis._translate = [root.viewProp(this.id, 'x') || 0, root.viewProp(this.id, 'y') || 0];\n\t\t\t\t\tthis._scale = root.viewProp(this.id, 'scale') || 1.0;\n\t\t\t\t}\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"translate\",\n\t\t\tget: function get() {\n\t\t\t\treturn this._translate;\n\t\t\t},\n\t\t\tset: function set(t) {\n\t\t\t\tthis.transform(t[0], t[1]);\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"scale\",\n\t\t\tget: function get() {\n\t\t\t\treturn this._scale;\n\t\t\t},\n\t\t\tset: function set(k) {\n\t\t\t\tswitch (k) {\n\t\t\t\t\tcase \"in\":\n\t\t\t\t\t\tk = this.scale * this.prop(\"zoomFactor\");\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase \"out\":\n\t\t\t\t\t\tk = this.scale / this.prop(\"zoomFactor\");\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase \"actual\":\n\t\t\t\t\t\tk = 1.0;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase \"fit\":\n\t\t\t\t\t\tvar gridSize = this.prop(\"gridSize\") * 2;\n\t\n\t\t\t\t\t\tvar gBounds = this.getBounds();\n\t\t\t\t\t\tvar vBounds = this.viewport();\n\t\n\t\t\t\t\t\tvBounds.width -= gridSize;\n\t\t\t\t\t\tvBounds.height -= gridSize;\n\t\n\t\t\t\t\t\t/* Do not zoom more than actual if graph already fits into the bounds */\n\t\t\t\t\t\tk = Math.min(vBounds.width / gBounds.width, vBounds.height / gBounds.height, 1.0);\n\t\n\t\t\t\t\t\t//TODO: Add centering code here or trigger an event for that\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tdefault:\n\t\t\t\t\t\tif (_lodash2.default.isString(k)) k = parseFloat(k);\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tthis.transform(null, null, k);\n\t\t\t}\n\t\t}]);\n\t\n\t\treturn Renderer;\n\t}();\n\t\n\tRenderer.DEFAULTS = {\n\t\tdefaultClickMode: \"pan\",\n\t\thideOutline: false,\n\t\tsingleSelect: true,\n\t\tdraggable: true,\n\t\tgridEnabled: false,\n\t\tguidesEnabled: true,\n\t\tgridSize: 30,\n\t\tmaxZoom: 4.0,\n\t\tminZoom: 0.2,\n\t\tzoomFactor: 1.2,\n\t\tmaskOpacity: 0.5,\n\t\tgraphBehavior: _GraphBehavior2.default,\n\t\tselectionBehavior: _SelectionBehavior2.default\n\t};\n\t\n\texports.default = Renderer;\n\n/***/ }),\n/* 26 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t\tvalue: true\n\t});\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tvar _Behavior2 = __webpack_require__(27);\n\t\n\tvar _Behavior3 = _interopRequireDefault(_Behavior2);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\t\n\tfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; } /**\n\t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * Created by tong on 6/28/2016.\n\t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                */\n\t\n\t\n\t/**\n\t * Graph handler handles Panning and Zoom and rubber band selection\n\t */\n\tvar GraphBehavior = function (_Behavior) {\n\t\t_inherits(GraphBehavior, _Behavior);\n\t\n\t\tfunction GraphBehavior(renderer) {\n\t\t\t_classCallCheck(this, GraphBehavior);\n\t\n\t\t\tvar _this = _possibleConstructorReturn(this, (GraphBehavior.__proto__ || Object.getPrototypeOf(GraphBehavior)).call(this, renderer));\n\t\n\t\t\tvar dispatcher = renderer.dispatcher;\n\t\t\tvar f = function f(type, ns, graph, pos, event) {\n\t\t\t\t//Cursor.updateCursor(type, ns, graph, event);\n\t\t\t};\n\t\t\tdispatcher.register(/^drag.*\\.graph$/, _this.handleDrag, _this);\n\t\t\tdispatcher.register(/^zoom/, _this.handleZoom, _this);\n\t\t\t//dispatcher.register(['mousedown.graph', 'mouseenter.graph', 'mouseleave.graph'], f);\n\t\t\t_this.offset = null;\n\t\t\treturn _this;\n\t\t}\n\t\n\t\t_createClass(GraphBehavior, [{\n\t\t\tkey: \"handleZoom\",\n\t\t\tvalue: function handleZoom(type, ns, graph, pos, event) {\n\t\t\t\tthis.renderer.transform(null, null, event.scale);\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"handleDrag\",\n\t\t\tvalue: function handleDrag(type, ns, graph, pos, event) {\n\t\t\t\tif (type == 'dragstart') {\n\t\t\t\t\tvar pan = this.renderer.prop(\"defaultClickMode\") == \"pan\" ^ (event.ctrlKey || event.shiftKey);\n\t\t\t\t\tif (!pan) return;\n\t\t\t\t\tvar t = this.renderer.translate;\n\t\t\t\t\tthis.offset = [t[0] - pos[0], t[1] - pos[1]];\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tif (!this.offset) return;\n\t\t\t\tthis.renderer.transform(pos[0] + this.offset[0], pos[1] + this.offset[1]);\n\t\t\t\tif (type == 'dragend') {\n\t\t\t\t\t//Cursor.updateCursor('mouseup', ns, graph, event);\n\t\t\t\t\tdelete this.offset;\n\t\t\t\t}\n\t\t\t}\n\t\t}]);\n\t\n\t\treturn GraphBehavior;\n\t}(_Behavior3.default);\n\t\n\texports.default = GraphBehavior;\n\n/***/ }),\n/* 27 */\n/***/ (function(module, exports) {\n\n\t\"use strict\";\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t\tvalue: true\n\t});\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tvar Behavior = function () {\n\t\tfunction Behavior(renderer) {\n\t\t\t_classCallCheck(this, Behavior);\n\t\n\t\t\tthis.renderer = renderer;\n\t\t}\n\t\n\t\t_createClass(Behavior, [{\n\t\t\tkey: \"destroy\",\n\t\t\tvalue: function destroy() {\n\t\t\t\tdelete this.renderer;\n\t\t\t}\n\t\t}]);\n\t\n\t\treturn Behavior;\n\t}();\n\t\n\texports.default = Behavior;\n\n/***/ }),\n/* 28 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t\tvalue: true\n\t});\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tvar _get = function get(object, property, receiver) { if (object === null) object = Function.prototype; var desc = Object.getOwnPropertyDescriptor(object, property); if (desc === undefined) { var parent = Object.getPrototypeOf(object); if (parent === null) { return undefined; } else { return get(parent, property, receiver); } } else if (\"value\" in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } };\n\t\n\tvar _Rectangle = __webpack_require__(4);\n\t\n\tvar _Rectangle2 = _interopRequireDefault(_Rectangle);\n\t\n\tvar _Cell = __webpack_require__(18);\n\t\n\tvar _Cell2 = _interopRequireDefault(_Cell);\n\t\n\tvar _Behavior2 = __webpack_require__(27);\n\t\n\tvar _Behavior3 = _interopRequireDefault(_Behavior2);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\t\n\tfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\t\n\tvar SelectionBehavior = function (_Behavior) {\n\t\t_inherits(SelectionBehavior, _Behavior);\n\t\n\t\tfunction SelectionBehavior(renderer) {\n\t\t\t_classCallCheck(this, SelectionBehavior);\n\t\n\t\t\tvar _this = _possibleConstructorReturn(this, (SelectionBehavior.__proto__ || Object.getPrototypeOf(SelectionBehavior)).call(this, renderer));\n\t\n\t\t\tvar dispatcher = renderer.dispatcher;\n\t\t\tdispatcher.register('mousedown.*', _this.selectCell, _this);\n\t\t\tdispatcher.register('mouseup.*', _this.unselectCell, _this);\n\t\t\tdispatcher.register('drag*.graph', _this.handleMultiSelect, _this);\n\t\t\t//graph.on(Graph.EVENT_TYPES.SELECTION_CHANGE, this.updateSelections, this);\n\t\t\t_this.selectedNodes = null;\n\t\t\t_this.selectedLinks = null;\n\t\t\t_this.attachedLinks = null;\n\t\t\treturn _this;\n\t\t}\n\t\n\t\t_createClass(SelectionBehavior, [{\n\t\t\tkey: \"updateSelections\",\n\t\t\tvalue: function updateSelections() {\n\t\t\t\tif (this.selectedNodes) this.selectedNodes.classed('selected', false);\n\t\t\t\tif (this.selectedLinks) this.selectedLinks.classed('selected', false);\n\t\n\t\t\t\tthis.selectedNodes = null;\n\t\t\t\tthis.selectedLinks = null;\n\t\t\t\tthis.attachedLinks = null;\n\t\n\t\t\t\tif (this.graph.selectedVertices && this.graph.selectedVertices.length > 0) {\n\t\t\t\t\tthis.selectedNodes = this.graph.renderer.getShapes(this.graph.selectedVertices);\n\t\t\t\t\tthis.attachedLinks = this.graph.renderer.getShapes(this.graph.getAttachedEdges());\n\t\t\t\t\tthis.selectedNodes.classed('selected', true);\n\t\t\t\t}\n\t\n\t\t\t\tif (this.graph.selectedEdges && this.graph.selectedEdges.length > 0) {\n\t\t\t\t\tthis.selectedLinks = this.graph.renderer.getShapes(this.graph.selectedEdges);\n\t\t\t\t\tthis.selectedLinks.classed('selected', true);\n\t\t\t\t}\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"selectCell\",\n\t\t\tvalue: function selectCell(type, ns, data, pos, event) {\n\t\t\t\tvar cell = data == this.graph ? null : data;\n\t\t\t\tif (cell && !(cell instanceof _Cell2.default)) return;\n\t\t\t\tvar toggle = event.ctrlKey || event.shiftKey;\n\t\t\t\tif (cell && cell instanceof _Cell2.default) {\n\t\t\t\t\tif (!this.graph.isSelected(cell)) delete cell._firstSelection;else cell._firstSelection = true;\n\t\n\t\t\t\t\td3.select(event.dataTarget).moveToFront();\n\t\t\t\t\tthis.graph.setSelection(cell, toggle);\n\t\t\t\t}\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"unselectCell\",\n\t\t\tvalue: function unselectCell(type, ns, data, pos, event) {\n\t\t\t\tvar cell = data == this.graph ? null : data;\n\t\t\t\tif (cell && !(cell instanceof _Cell2.default)) return;\n\t\t\t\tvar ctrlKey = event.ctrlKey || event.shiftKey;\n\t\t\t\tif (!cell) {\n\t\t\t\t\tthis.graph.setSelection(cell, ctrlKey);\n\t\t\t\t}\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"handleMultiSelect\",\n\t\t\tvalue: function handleMultiSelect(type, ns, data, pos, event) {\n\t\t\t\tpos = util.scale(this.graph, pos);\n\t\n\t\t\t\tif (type == 'dragstart') {\n\t\t\t\t\tvar select = this.graph.getProperty(\"defaultClickMode\") == \"select\" ^ (event.ctrlKey || event.shiftKey);\n\t\t\t\t\tif (!select) return;\n\t\t\t\t\tthis.startPt = new Point(pos[0], pos[1]);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tif (!this.startPt) return;\n\t\t\t\tvar rect = _Rectangle2.default.getBoundingRectangle([new Point(pos[0], pos[1]), this.startPt]);\n\t\t\t\tvar renderer = this.graph.renderer;\n\t\t\t\tif (!this.rubberband) {\n\t\t\t\t\tthis.rubberband = d3.select(renderer.appendNode(renderer.getCellLayer(), {\n\t\t\t\t\t\ttemplate: _.template('<g><rect x=\"0\" y=\"0\" width=\"100\" height=\"100\" stroke=\"#000000\" fill=\"none\" stroke-dasharray=\"3 3\"/></g>')\n\t\t\t\t\t}, false));\n\t\t\t\t}\n\t\t\t\tif (type == 'dragend') {\n\t\t\t\t\tvar cells = this.graph.getCurrentRoot().children;\n\t\t\t\t\t// TODO: Define if we want to select vertexes / edges or both\n\t\t\t\t\tcells = _.filter(cells, function (cell) {\n\t\t\t\t\t\tvar box = cell.getBounds();\n\t\t\t\t\t\tif (rect.contains(box)) {\n\t\t\t\t\t\t\treturn true;\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t});\n\t\t\t\t\t// TODO: Set selection\n\t\t\t\t\tthis.graph.setSelection(cells, event.ctrlKey);\n\t\n\t\t\t\t\tthis.rubberband.remove();\n\t\t\t\t\tdelete this.startPt;\n\t\t\t\t\tdelete this.rubberband;\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tthis.rubberband.select(\"rect\").attr({ x: rect.x, y: rect.y, width: rect.width, height: rect.height });\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"destroy\",\n\t\t\tvalue: function destroy() {\n\t\t\t\t_get(SelectionBehavior.prototype.__proto__ || Object.getPrototypeOf(SelectionBehavior.prototype), \"destroy\", this).call(this);\n\t\t\t\tdelete this.selectedNodes;\n\t\t\t\tdelete this.selectedLinks;\n\t\t\t\tdelete this.attachedLinks;\n\t\t\t}\n\t\t}]);\n\t\n\t\treturn SelectionBehavior;\n\t}(_Behavior3.default);\n\t\n\texports.default = SelectionBehavior;\n\n/***/ }),\n/* 29 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t\tvalue: true\n\t});\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tvar _get = function get(object, property, receiver) { if (object === null) object = Function.prototype; var desc = Object.getOwnPropertyDescriptor(object, property); if (desc === undefined) { var parent = Object.getPrototypeOf(object); if (parent === null) { return undefined; } else { return get(parent, property, receiver); } } else if (\"value\" in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } };\n\t\n\tvar _lodash = __webpack_require__(5);\n\t\n\tvar _lodash2 = _interopRequireDefault(_lodash);\n\t\n\tvar _base = __webpack_require__(1);\n\t\n\tvar _base2 = _interopRequireDefault(_base);\n\t\n\tvar _DomUtils = __webpack_require__(7);\n\t\n\tvar _DomUtils2 = _interopRequireDefault(_DomUtils);\n\t\n\tvar _Renderer2 = __webpack_require__(25);\n\t\n\tvar _Renderer3 = _interopRequireDefault(_Renderer2);\n\t\n\tvar _StringBuffer = __webpack_require__(8);\n\t\n\tvar _StringBuffer2 = _interopRequireDefault(_StringBuffer);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\t\n\tfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\t\n\tvar NS = 'http://www.w3.org/2000/svg';\n\tif (typeof SVGElement != \"undefined\") {\n\t\tvar svg = document.createElementNS(NS, \"svg\");\n\t\tsvg.innerHTML = '<circle/>';\n\t\tif (svg.firstChild !== \"[object SVGCircleElement]\") {\n\t\t\tObject.defineProperties(SVGElement.prototype, {\n\t\t\t\t\"outerHTML\": {\n\t\t\t\t\tenumerable: false,\n\t\t\t\t\tconfigurable: true,\n\t\t\t\t\tget: function get() {\n\t\t\t\t\t\tvar $node, $temp;\n\t\t\t\t\t\t$temp = document.createElement('div');\n\t\t\t\t\t\t$node = this.cloneNode(true);\n\t\t\t\t\t\t$temp.appendChild($node);\n\t\t\t\t\t\treturn $temp.innerHTML;\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t\"innerHTML\": {\n\t\t\t\t\tenumerable: false,\n\t\t\t\t\tconfigurable: true,\n\t\t\t\t\tget: function get() {\n\t\t\t\t\t\tvar s = this.outerHTML;\n\t\t\t\t\t\tvar ropen = new RegExp(\"<\" + this.nodeName + '\\\\b(?:([\"\\'])[^\"]*?(\\\\1)|[^>])*>', \"i\");\n\t\t\t\t\t\tvar rclose = new RegExp(\"<\\/\" + this.nodeName + \">$\", \"i\");\n\t\t\t\t\t\treturn s.replace(ropen, \"\").replace(rclose, \"\");\n\t\t\t\t\t},\n\t\t\t\t\tset: function set(markup) {\n\t\t\t\t\t\t// empty el first.\n\t\t\t\t\t\tvar child = void 0;\n\t\t\t\t\t\twhile (child = this.lastChild) {\n\t\t\t\t\t\t\tthis.removeChild(child);\n\t\t\t\t\t\t}var buf = new _StringBuffer2.default();\n\t\t\t\t\t\tbuf.append('<svg>').append(markup).append('</svg');\n\t\t\t\t\t\tvar $temp = _DomUtils2.default.createElement('div', null, null, buf.toString()).firstElementChild;\n\t\t\t\t\t\twhile ($temp.firstChild) {\n\t\t\t\t\t\t\tthis.appendChild($temp.firstChild);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t\t// Define the toDataURL for SVG\n\t\tSVGElement.prototype.toDataURL = function (type) {\n\t\t\tvar options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n\t\n\t\t\tvar _svg = this;\n\t\n\t\t\tvar debug = function debug(msg) {};\n\t\n\t\t\tif (options['debug'] == true && typeof console != 'undefined') debug = function debug(msg) {\n\t\t\t\tconsole.log(\"SVG.toDataURL:\", msg);\n\t\t\t};\n\t\n\t\t\tfunction exportSVG() {\n\t\t\t\tvar svg_xml = _svg.outerHTML;\n\t\t\t\tvar svg_dataurl = base64dataURLencode(svg_xml);\n\t\t\t\tdebug(type + \" length: \" + svg_dataurl.length);\n\t\n\t\t\t\t// NOTE double data carrier\n\t\t\t\tif (options.callback) options.callback(svg_dataurl);\n\t\t\t\treturn svg_dataurl;\n\t\t\t}\n\t\n\t\t\tfunction base64dataURLencode(s) {\n\t\t\t\tvar b64 = \"data:image/svg+xml;base64,\";\n\t\n\t\t\t\t// https://developer.mozilla.org/en/DOM/window.btoa\n\t\t\t\tif (window.btoa) {\n\t\t\t\t\tdebug(\"using window.btoa for base64 encoding\");\n\t\t\t\t\tb64 += btoa(s);\n\t\t\t\t} else {\n\t\t\t\t\tdebug(\"using custom base64 encoder\");\n\t\t\t\t\tb64 += _base2.default.encode(s);\n\t\t\t\t}\n\t\n\t\t\t\treturn b64;\n\t\t\t}\n\t\n\t\t\t// Native export doesn't work very well. should use canvg instead.\n\t\t\tfunction exportImage(type) {\n\t\t\t\tvar canvas = document.createElement(\"canvas\");\n\t\t\t\tvar ctx = canvas.getContext('2d');\n\t\n\t\t\t\t// TODO: if (options.keepOutsideViewport), do some translation magic?\n\t\n\t\t\t\tvar svg_img = new Image();\n\t\t\t\tvar svg_xml = _svg.outerHTML;\n\t\t\t\tsvg_img.src = base64dataURLencode(svg_xml);\n\t\n\t\t\t\tsvg_img.onload = function () {\n\t\t\t\t\tdebug(\"exported image size: \" + [svg_img.width, svg_img.height]);\n\t\t\t\t\tcanvas.width = svg_img.width;\n\t\t\t\t\tcanvas.height = svg_img.height;\n\t\t\t\t\tctx.drawImage(svg_img, 0, 0);\n\t\n\t\t\t\t\t// SECURITY_ERR WILL HAPPEN NOW\n\t\t\t\t\tvar image_dataurl = canvas.toDataURL(type);\n\t\t\t\t\tdebug(type + \" length: \" + image_dataurl.length);\n\t\n\t\t\t\t\tif (options.callback) options.callback(image_dataurl);else debug(\"WARNING: no callback set, so nothing happens.\");\n\t\t\t\t};\n\t\n\t\t\t\tsvg_img.onerror = function () {\n\t\t\t\t\tdebug(\"Can't export! Maybe your browser doesn't support \" + \"SVG in img element or SVG input for Canvas drawImage?\\n\" + \"http://en.wikipedia.org/wiki/SVG#Native_support\");\n\t\t\t\t};\n\t\n\t\t\t\t// NOTE: will not return anything\n\t\t\t}\n\t\n\t\t\tfunction exportImageCanvg(type) {\n\t\t\t\tif (!canvg) return null;\n\t\t\t\tvar canvas = _DomUtils2.default.createElement('canvas', null, { display: \"none\" });\n\t\t\t\tdocument.body.appendChild(canvas);\n\t\t\t\tif (type == 'javascript') {\n\t\t\t\t\tvar xcanvas = new jsCanvas('jscanvastest');\n\t\t\t\t\txcanvas.canvas.style.display = 'none';\n\t\t\t\t\t//xcanvas.canvas = canvas;\n\t\t\t\t}\n\t\n\t\t\t\tif (!options.keepOutsideViewport) {\n\t\t\t\t\tcanvg(canvas, _svg.outerHTML);\n\t\t\t\t} else {\n\t\t\t\t\tvar padding = options.padding || 0;\n\t\t\t\t\tvar scale = 1.0;\n\t\t\t\t\tvar translate = [0, 0];\n\t\t\t\t\tvar bbox = _svg.getBBox();\n\t\t\t\t\tdebug(\"detected svg dimensions \" + [bbox.x, bbox.y, bbox.width, bbox.height]);\n\t\t\t\t\tvar transform = _svg.firstElementChild.getAttribute('transform');\n\t\t\t\t\tif (transform) {\n\t\t\t\t\t\tdebug('detected svg transform ' + transform);\n\t\t\t\t\t\ttransform = SVGRenderer.transform(transform);\n\t\t\t\t\t\ttranslate = transform.translate;\n\t\t\t\t\t\tscale = transform.scale;\n\t\t\t\t\t}\n\t\t\t\t\tvar buf = new _StringBuffer2.default();\n\t\t\t\t\tbuf.append('<svg width=\"').append(bbox.width + 2 * padding).append('px\" height=\"').append(bbox.height + 2 * padding).append('px\"><g transform=\"translate(').append(-bbox.x + translate[0] + padding).append(',').append(-bbox.y + translate[1] + padding).append(')scale(').append(scale).append(')\">').append(_svg.firstElementChild.innerHTML).append('</g></svg>');\n\t\t\t\t\tif (type == 'javascript') {\n\t\t\t\t\t\txcanvas.compile(buf.toString(), function () {\n\t\t\t\t\t\t\tif (options.callback) options.callback(xcanvas.toString());\n\t\t\t\t\t\t});\n\t\t\t\t\t\treturn;\n\t\t\t\t\t} else canvg(canvas, buf.toString());\n\t\t\t\t}\n\t\t\t\tvar image_dataurl = canvas.toDataURL(type);\n\t\t\t\tif (options.callback) options.callback(image_dataurl);\n\t\t\t\tcanvas.parentNode.removeChild(canvas);\n\t\t\t\treturn image_dataurl;\n\t\t\t}\n\t\n\t\t\tif (!type) type = \"image/svg+xml\";\n\t\n\t\t\tif (options.keepNonSafe) debug(\"NOTE: keepNonSafe is NOT supported and will be ignored!\");\n\t\t\tif (options.keepOutsideViewport) debug(\"NOTE: keepOutsideViewport is only supported with canvg exporter.\");\n\t\n\t\t\tswitch (type) {\n\t\t\t\tcase \"image/svg+xml\":\n\t\t\t\t\treturn exportSVG();\n\t\t\t\tcase \"image/png\":\n\t\t\t\tcase \"image/jpeg\":\n\t\t\t\tcase \"javascript\":\n\t\t\t\t\tif (!options.renderer) {\n\t\t\t\t\t\tif (window.canvg) options.renderer = \"canvg\";else options.renderer = \"native\";\n\t\t\t\t\t}\n\t\t\t\t\tswitch (options.renderer) {\n\t\t\t\t\t\tcase \"canvg\":\n\t\t\t\t\t\t\tdebug(\"using canvg renderer for \" + type + \" image export\");\n\t\t\t\t\t\t\treturn exportImageCanvg(type);\n\t\t\t\t\t\tcase \"native\":\n\t\t\t\t\t\t\tdebug(\"using native renderer for \" + type + \" export. THIS MIGHT FAIL.\");\n\t\t\t\t\t\t\treturn exportImage(type);\n\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\tdebug(\"unknown image renderer given, doing noting (\" + options.renderer + \")\");\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\tdebug(\"Sorry! Exporting as '\" + type + \"' is not supported!\");\n\t\t\t}\n\t\t\treturn null;\n\t\t};\n\t}\n\t\n\tvar SVGRenderer = function (_Renderer) {\n\t\t_inherits(SVGRenderer, _Renderer);\n\t\n\t\tfunction SVGRenderer() {\n\t\t\t_classCallCheck(this, SVGRenderer);\n\t\n\t\t\treturn _possibleConstructorReturn(this, (SVGRenderer.__proto__ || Object.getPrototypeOf(SVGRenderer)).apply(this, arguments));\n\t\t}\n\t\n\t\t_createClass(SVGRenderer, [{\n\t\t\tkey: \"render\",\n\t\t\tvalue: function render() {\n\t\t\t\tvar result = _get(SVGRenderer.prototype.__proto__ || Object.getPrototypeOf(SVGRenderer.prototype), \"render\", this).call(this);\n\t\t\t\tif (result) {\n\t\t\t\t\tvar root = this.graph.currentRoot;\n\t\t\t\t\tvar buf = new _StringBuffer2.default('<svg width=\"100%\" height=\"100%\" xmlns=\"http://www.w3.org/2000/svg\">');\n\t\t\t\t\tvar t = this.translate;\n\t\t\t\t\tbuf.append('<g transform=\"translate(').append(t[0]).append(',').append(t[1]).append(')scale(').append(this.scale).append(')\">');\n\t\t\t\t\tbuf.append(this.renderDefs());\n\t\t\t\t\tbuf.append(root.render(this));\n\t\t\t\t\tbuf.append('</g></svg>');\n\t\t\t\t\tthis.box.innerHTML = buf.toString();\n\t\t\t\t\tthis.svg = this.box.firstElementChild;\n\t\t\t\t}\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"renderDefs\",\n\t\t\tvalue: function renderDefs() {\n\t\t\t\tvar buf = new _StringBuffer2.default('<defs>');\n\t\t\t\tbuf.append(this.getTemplate('Grid', this.prop(\"gridSize\")));\n\t\t\t\tvar markers = this.graph.markers;\n\t\t\t\tif (markers.length > 0) buf.append(SVGRenderer.renderMarkers(markers));\n\t\t\t\tbuf.append('</defs>');\n\t\t\t\treturn buf.toString();\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"refresh\",\n\t\t\tvalue: function refresh() {\n\t\t\t\tif (!this.svg) return;\n\t\t\t\tvar g = this.svg.querySelector('g');\n\t\t\t\tvar t = this.translate;\n\t\t\t\tg.setAttribute('transform', 'translate(' + t[0] + ',' + t[1] + ')scale(' + this.scale + ')');\n\t\t\t}\n\t\t}], [{\n\t\t\tkey: \"renderMarkers\",\n\t\t\tvalue: function renderMarkers(markers) {\n\t\t\t\tvar buf = new _StringBuffer2.default(),\n\t\t\t\t    str1 = void 0,\n\t\t\t\t    str2 = void 0;\n\t\t\t\tmarkers.forEach(function (marker) {\n\t\t\t\t\tstr1 = this.TEMPLATES['Marker'](marker);\n\t\t\t\t\tstr2 = marker.shape;\n\t\t\t\t\tif (!_lodash2.default.isString(str2)) str2 = this.renderShape(str2);\n\t\t\t\t\tstr1 = str1.replace(/\\#\\{shape\\}/, str2);\n\t\t\t\t\tbuf.append(str1);\n\t\t\t\t}, this);\n\t\t\t\treturn buf.toString();\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"renderLabel\",\n\t\t\tvalue: function renderLabel(box) {\n\t\t\t\treturn this.TEMPLATES['Label'](box);\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"renderShape\",\n\t\t\tvalue: function renderShape(shape) {\n\t\t\t\tvar template = this.TEMPLATES[shape.name];\n\t\t\t\tif (_lodash2.default.isString(template)) template = _lodash2.default.template(template);\n\t\t\t\treturn template(shape);\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"getPathData\",\n\t\t\tvalue: function getPathData(shape) {\n\t\t\t\tvar points = shape.points;\n\t\t\t\tvar controlPts = shape.controlPts;\n\t\t\t\tif (!points || points.length == 0) return '';\n\t\n\t\t\t\tif (!controlPts && shape.round) {\n\t\t\t\t\t// render rounded line joins.\n\t\t\t\t\tvar newPts = [];\n\t\t\t\t\tcontrolPts = [];\n\t\t\t\t\tvar prev = points[0],\n\t\t\t\t\t    next = void 0,\n\t\t\t\t\t    d1 = void 0,\n\t\t\t\t\t    d2 = void 0,\n\t\t\t\t\t    corner = void 0;\n\t\t\t\t\tnewPts.push(prev);\n\t\t\t\t\tfor (var i = 1; i < points.length - 1; i++) {\n\t\t\t\t\t\tnext = points[i];\n\t\t\t\t\t\t// set the control point first.\n\t\t\t\t\t\tcontrolPts[2 * i] = [next, next];\n\t\t\t\t\t\t// check the size of the corner.\n\t\t\t\t\t\td1 = prev.distance(next);\n\t\t\t\t\t\td2 = next.distance(points[i + 1]);\n\t\t\t\t\t\tcorner = Math.min(shape.round, d1 / 2, d2 / 2);\n\t\t\t\t\t\t// split the point into two.\n\t\t\t\t\t\tnewPts.push(next.getDirection(prev).scale(corner).translate(next));\n\t\t\t\t\t\tnewPts.push(next.getDirection(points[i + 1]).scale(corner).translate(next));\n\t\t\t\t\t\tprev = next;\n\t\t\t\t\t}\n\t\t\t\t\tnewPts.push(points[points.length - 1]);\n\t\t\t\t\tpoints = newPts;\n\t\t\t\t}\n\t\t\t\tvar buf = new _StringBuffer2.default('M'),\n\t\t\t\t    point = void 0;\n\t\t\t\tfor (var _i = 0; _i < points.length; _i++) {\n\t\t\t\t\tpoint = points[_i];\n\t\t\t\t\tif (_i == 0) buf.append(point);else {\n\t\t\t\t\t\tif (controlPts && controlPts[_i]) {\n\t\t\t\t\t\t\tbuf.append(' C ');\n\t\t\t\t\t\t\tfor (var j = 0; j < controlPts[_i].length; j++) {\n\t\t\t\t\t\t\t\tbuf.append(controlPts[_i][j]).append(' ');\n\t\t\t\t\t\t\t}buf.append(point);\n\t\t\t\t\t\t} else buf.append(' L ').append(point);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn buf.toString();\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"renderLink\",\n\t\t\tvalue: function renderLink(shape) {\n\t\t\t\tvar buf = new _StringBuffer2.default();\n\t\t\t\tvar d = SVGRenderer.getPathData(shape);\n\t\t\t\tif (shape.showGauge) buf.append('<path style=\"stroke: white; stroke-width: 9; visibility: hidden; pointer-events: stroke;\" d=\"').append(d).append('\"/>');\n\t\t\t\tbuf.append('<path d=\"').append(d).append('\"');\n\t\t\t\tif (shape.startMarker || shape.endMarker) {\n\t\t\t\t\tbuf.append(' style=\"');\n\t\t\t\t\tif (shape.startMarker) buf.append('marker-start: url(#').append(_lodash2.default.isString(shape.startMarker) ? shape.startMarker : shape.startMarker.id).append(');');\n\t\t\t\t\tif (shape.endMarker) buf.append('marker-end: url(#').append(_lodash2.default.isString(shape.endMarker) ? shape.endMarker : shape.endMarker.id).append(');');\n\t\t\t\t\tbuf.append('\"');\n\t\t\t\t}\n\t\t\t\tbuf.append('/>');\n\t\t\t\treturn buf.toString();\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"appendContent\",\n\t\t\tvalue: function appendContent(el, content) {\n\t\t\t\tvar buf = new _StringBuffer2.default();\n\t\t\t\tbuf.append('<svg>').append(content).append('</svg');\n\t\t\t\tvar temp = _DomUtils2.default.createElement('div', null, null, buf.toString()).firstElementChild;\n\t\n\t\t\t\twhile (temp.firstChild) {\n\t\t\t\t\tel.appendChild(temp.firstChild);\n\t\t\t\t}return el;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"transform\",\n\t\t\tvalue: function transform(_transform) {\n\t\t\t\tvar translate = [0, 0],\n\t\t\t\t    scale = 1.0;\n\t\t\t\t//\n\t\t\t\tvar parts = _transform.match(/translate\\(\\s*([^)]+)/);\n\t\t\t\tif (parts) {\n\t\t\t\t\tvar m = parts[1].trim().match(/([\\d.-]+)[ ,]([\\d.-]+)/);\n\t\t\t\t\tif (m) {\n\t\t\t\t\t\ttranslate[0] = parseFloat(m[1]) || 0;\n\t\t\t\t\t\ttranslate[1] = parseFloat(m[2]) || 0;\n\t\t\t\t\t} else translate[0] = translate[1] = parseFloat(parts[1]);\n\t\t\t\t}\n\t\t\t\tparts = _transform.match(/scale\\(\\s*([^)]+)/);\n\t\t\t\tif (parts) scale = parseFloat(parts[1]) || 1.0;\n\t\n\t\t\t\treturn { translate: translate, scale: scale };\n\t\t\t}\n\t\t}]);\n\t\n\t\treturn SVGRenderer;\n\t}(_Renderer3.default);\n\t\n\tSVGRenderer.TEMPLATES = {\n\t\t$root: '<g id=\"${id}\" class=\"${className}\">#{children}</g>',\n\t\t$node: '<g id=\"${id}\" class=\"${className}\" style=\"${style}\" ns=\"${namespace}\" transform=\"translate(${x},${y})\">#{shape}#{label}</g>',\n\t\t$edge: '<g id=\"${id}\" class=\"${className}\" style=\"${style}\" ns=\"${namespace}\">#{shape}#{label}</g>',\n\t\tEllipse: '<ellipse cx=\"0\" cy=\"0\" rx=\"${width/2}\" ry=\"${height/2}\"/>',\n\t\tRectangle: '<rect x=\"${-width/2}\" y=\"${-height/2}\" width=\"${width}\" height=\"${height}\" rx=\"9\" ry=\"9\"/>',\n\t\tTriangle: '<polygon points=\"${-width/2},${-height/2} ${width/2},${-height/2} 0,${height/2}\"/>',\n\t\tRhombus: '<polygon points=\"0,${-height/2} ${width/2},0 0,${height/2} ${-width/2},0\"/>',\n\t\tHexagon: function Hexagon(config) {\n\t\t\tvar vertical = config.direction == 'north' || config.direction == 'south';\n\t\t\tif (vertical) return '<polygon points=\"0,${-height/2} ${width/2},${-height/4} ${width/2},${height/4} 0,${height/2} ${-width/2},${height/4} ${-width/2},${-height/4}\"/>';else return '<polygon points=\"${-width/2},0 ${width/4},${-height/2} ${width/4},${-height/2} ${width/2},0 ${width/4},${height/2} ${-width/4},${height/2}\"/>';\n\t\t},\n\t\tPolygon: function Polygon(shape) {\n\t\t\tvar buf = new _StringBuffer2.default('<polygon points=\"');\n\t\t\tshape.points.forEach(function (pt) {\n\t\t\t\tbuf.append(pt[0]).append(',').append(pt[1]).append(' ');\n\t\t\t});\n\t\t\tbuf.removeLast();\n\t\t\tbuf.append('\"/>');\n\t\t\treturn buf.toString();\n\t\t},\n\t\tImage: function Image(config) {\n\t\t\treturn '<image x=\"${-width/2}\" y=\"${-height/2}\" width=\"${width}\" height=\"${height}\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" xlink:href=\"' + config.image + '\"/>';\n\t\t},\n\t\tMarker: function Marker(marker) {\n\t\t\treturn (\"\\n<marker id=\\\"\" + marker.id + \"\\\" markerWidth=\\\"\" + marker.size + \"\\\" markerHeight=\\\"\" + marker.size + \"\\\" refx=\\\"\" + marker.ref[0] + \"\\\" \\nrefy=\\\"\" + marker.ref[1] + \"\\\" orient=\\\"auto\\\" viewbox=\\\"\" + marker.viewBox.x + \" \" + marker.viewBox.y + \" \" + marker.viewBox.width + \" \" + marker.viewBox.height + \"\\\"\\nmarkerUnits=\\\"userSpaceOnUse\\\" \" + (marker.fill ? \"style=\\\"stroke: \" + marker.fill + \";fill:\" + marker.fill + \"\\\"\" : '') + \">#{shape}</marker>\\n\").trim();\n\t\t},\n\t\tGrid: function Grid(size) {\n\t\t\treturn (\"\\n<pattern id=\\\"GridPattern\\\" width=\\\"\" + size + \"\\\" height=\\\"\" + size + \"\\\" patternUnits=\\\"userSpaceOnUse\\\">\\n\\t<ellipse cx=\\\"0\\\" cy=\\\"0\\\" rx=\\\"1\\\" ry=\\\"1\\\" fill=\\\"#999999\\\"/>\\n\\t<ellipse cx=\\\"0\\\" cy=\\\"\" + size + \"\\\" rx=\\\"1\\\" ry=\\\"1\\\" fill=\\\"#999999\\\"/>\\n\\t<ellipse cx=\\\"\" + size + \"\\\" cy=\\\"0\\\" rx=\\\"1\\\" ry=\\\"1\\\" fill=\\\"#999999\\\"/>\\n\\t<ellipse cx=\\\"\" + size + \"\\\" cy=\\\"\" + size + \"\\\" rx=\\\"1\\\" ry=\\\"1\\\" fill=\\\"#999999\\\"/>\\n</pattern>\").trim();\n\t\t},\n\t\tLabel: _lodash2.default.template(\"\\n<% var box = _.has(data, \\\"dx\\\") ? data : (data.getLabelBox ? data.getLabelBox() : null); \\n   if (box) {%>\\n\\t<g <% if (box.config && box.config.class) {%>class=\\\"<%=box.config.class%>\\\"<%}%>\\t\\t<% if (box.config && box.config.ns) {%>ns=\\\"<%=box.config.ns%>\\\"<%}%>\\t\\t<% if (box.config && box.config.inlineStyle) {%>\\t\\t\\tfont-size=\\\"<%=box.config.fontSize%>\\\"\\t\\t\\tfont-family=\\\"<%=box.config.fontFamily%>\\\"\\t\\t\\tfont-weight=\\\"<% if (box.bold) {%>bold<%} else {%>normal<%}%>\\\"\\t\\t\\t<% if (box.underline) {%>text-decoration=\\\"underline\\\"<%}%>\\t\\t\\t<% if (box.italic) {%>font-style=\\\"italic\\\"<%}%>\\t\\t<%}%>\\t\\ttext-anchor=\\\"<%=box.anchor%>\\\"\\t\\ttransform=\\\"translate(<%=box.bounds.x%>,<%=box.bounds.y%>)<% if (box.config && box.config.rotation) {%>rotate(<%=box.config.rotation%> <%=box.pivot[0]%> <%=box.pivot[1]%>)<%}%>\\\">\\n\\t<% if (box.config.backgroundStyle) {%>\\n\\t\\t<rect x=\\\"<%=-box.bounds.width/2%>\\\" y=\\\"<%=-box.bounds.height/2%>\\\" width=\\\"<%=box.bounds.width%>\\\" height=\\\"<%=box.bounds.height%>\\\" style=\\\"<%=box.config.backgroundStyle%>\\\"/>\\n\\t<% } if (_.isArray(box.label)) { \\n\\t\\t_.each(box.label, function(value, line) {%>\\n\\t\\t\\t<text <% if (box.config && box.config.textStyle) {%>style=\\\"<%=box.config.textStyle%>\\\"<%}%>\\t\\t\\t\\tdx=\\\"<%=box.dx%>\\\" dy=\\\"<%=box.dy + box.lineHeight * line%>\\\"><%=value%></text>\\n\\t\\t<%});} else { %>\\n\\t\\t\\t<text><%=box.label%></text>\\n\\t\\t<%}%>\\n\\t\\t<% if (box.config.title) {%>\\n\\t\\t\\t<title><%=box.config.title%></title>\\n\\t\\t<%}%>\\n\\t</g>\\n<%}%>\\n\".trim(), { variable: \"data\" } //TODO add more inline text styles.\n\t\t) };\n\t\n\texports.default = SVGRenderer;\n\n/***/ })\n/******/ ])\n});\n;\n"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 85ede51e30946b20c0c8","import Base64 from \"./util/base64\";\nimport Cache from \"./util/Utils\";\nimport Utils from \"./util/Utils\";\nimport DomUtils from \"./util/DomUtils\";\nimport StringBuffer from \"./util/StringBuffer\";\nimport Point from \"./geometry/Point\";\nimport Line from \"./geometry/Line\";\nimport Shape from \"./geometry/Shape\";\nimport Rectangle from \"./geometry/Rectangle\";\nimport Ellipse from \"./geometry/Ellipse\";\nimport Rhombus from \"./geometry/Rhombus\";\nimport Link from \"./geometry/Link\";\nimport Events from \"bean\";\nimport EventDispatcher from \"./event/EventDispatcher\";\nimport Graph from \"./graph/Graph\";\nimport Cell from \"./graph/Cell\";\nimport Node from \"./graph/Node\";\nimport Edge from \"./graph/Edge\";\nimport Layout from \"./layout/Layout\";\nimport FlowLayout from \"./layout/FlowLayout\";\nimport Label from \"./view/Label\";\nimport Marker from \"./view/Marker\";\nimport Renderer from \"./view/Renderer\";\nimport SVGRenderer from \"./view/SVGRenderer\";\nimport GraphBehavior from \"./behavior/GraphBehavior\";\nimport SelectionBehavior from \"./behavior/SelectionBehavior\";\n\nShape.addShape(\"Rectangle\", Rectangle);\nShape.addShape(\"Ellipse\", Ellipse);\nShape.addShape(\"Rhombus\", Rhombus);\n\nexport default {\n\tEvents,\n\tBase64,\n\tCache,\n\tUtils,\n\tDomUtils,\n\tStringBuffer,\n\tPoint,\n\tLine,\n\tShape,\n\tRectangle,\n\tEllipse,\n\tLink,\n\tEventDispatcher,\n\tLabel,\n\tMarker,\n\tGraph,\n\tCell,\n\tNode,\n\tEdge,\n\tLayout,\n\tFlowLayout,\n\tRenderer,\n\tSVGRenderer,\n\tGraphBehavior,\n\tSelectionBehavior\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/index.js","// http://www.webtoolkit.info/javascript-base64.html\n\nvar Base64 = {\n\n\t// private property\n\t_keyStr : \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=\",\n\n\t// public method for encoding\n\tencode : function (input) {\n\t\tvar output = \"\";\n\t\tvar chr1, chr2, chr3, enc1, enc2, enc3, enc4;\n\t\tvar i = 0;\n\n\t\tinput = Base64._utf8_encode(input);\n\n\t\twhile (i < input.length) {\n\n\t\t\tchr1 = input.charCodeAt(i++);\n\t\t\tchr2 = input.charCodeAt(i++);\n\t\t\tchr3 = input.charCodeAt(i++);\n\n\t\t\tenc1 = chr1 >> 2;\n\t\t\tenc2 = ((chr1 & 3) << 4) | (chr2 >> 4);\n\t\t\tenc3 = ((chr2 & 15) << 2) | (chr3 >> 6);\n\t\t\tenc4 = chr3 & 63;\n\n\t\t\tif (isNaN(chr2)) {\n\t\t\t\tenc3 = enc4 = 64;\n\t\t\t} else if (isNaN(chr3)) {\n\t\t\t\tenc4 = 64;\n\t\t\t}\n\n\t\t\toutput = output +\n\t\t\tthis._keyStr.charAt(enc1) + this._keyStr.charAt(enc2) +\n\t\t\tthis._keyStr.charAt(enc3) + this._keyStr.charAt(enc4);\n\n\t\t}\n\n\t\treturn output;\n\t},\n\n\t// public method for decoding\n\tdecode : function (input) {\n\t\tvar output = \"\";\n\t\tvar chr1, chr2, chr3;\n\t\tvar enc1, enc2, enc3, enc4;\n\t\tvar i = 0;\n\n\t\tinput = input.replace(/[^A-Za-z0-9\\+\\/\\=]/g, \"\");\n\n\t\twhile (i < input.length) {\n\n\t\t\tenc1 = this._keyStr.indexOf(input.charAt(i++));\n\t\t\tenc2 = this._keyStr.indexOf(input.charAt(i++));\n\t\t\tenc3 = this._keyStr.indexOf(input.charAt(i++));\n\t\t\tenc4 = this._keyStr.indexOf(input.charAt(i++));\n\n\t\t\tchr1 = (enc1 << 2) | (enc2 >> 4);\n\t\t\tchr2 = ((enc2 & 15) << 4) | (enc3 >> 2);\n\t\t\tchr3 = ((enc3 & 3) << 6) | enc4;\n\n\t\t\toutput = output + String.fromCharCode(chr1);\n\n\t\t\tif (enc3 != 64) {\n\t\t\t\toutput = output + String.fromCharCode(chr2);\n\t\t\t}\n\t\t\tif (enc4 != 64) {\n\t\t\t\toutput = output + String.fromCharCode(chr3);\n\t\t\t}\n\n\t\t}\n\n\t\toutput = Base64._utf8_decode(output);\n\n\t\treturn output;\n\n\t},\n\n\t// private method for UTF-8 encoding\n\t_utf8_encode : function (string) {\n\t\tstring = string.replace(/\\r\\n/g,\"\\n\");\n\t\tvar utftext = \"\";\n\n\t\tfor (var n = 0; n < string.length; n++) {\n\n\t\t\tvar c = string.charCodeAt(n);\n\n\t\t\tif (c < 128) {\n\t\t\t\tutftext += String.fromCharCode(c);\n\t\t\t}\n\t\t\telse if((c > 127) && (c < 2048)) {\n\t\t\t\tutftext += String.fromCharCode((c >> 6) | 192);\n\t\t\t\tutftext += String.fromCharCode((c & 63) | 128);\n\t\t\t}\n\t\t\telse {\n\t\t\t\tutftext += String.fromCharCode((c >> 12) | 224);\n\t\t\t\tutftext += String.fromCharCode(((c >> 6) & 63) | 128);\n\t\t\t\tutftext += String.fromCharCode((c & 63) | 128);\n\t\t\t}\n\n\t\t}\n\n\t\treturn utftext;\n\t},\n\n\t// private method for UTF-8 decoding\n\t_utf8_decode : function (utftext) {\n\t\tvar string = \"\";\n\t\tvar i = 0;\n\t\tvar c = c1 = c2 = 0;\n\n\t\twhile ( i < utftext.length ) {\n\n\t\t\tc = utftext.charCodeAt(i);\n\n\t\t\tif (c < 128) {\n\t\t\t\tstring += String.fromCharCode(c);\n\t\t\t\ti++;\n\t\t\t}\n\t\t\telse if((c > 191) && (c < 224)) {\n\t\t\t\tc2 = utftext.charCodeAt(i+1);\n\t\t\t\tstring += String.fromCharCode(((c & 31) << 6) | (c2 & 63));\n\t\t\t\ti += 2;\n\t\t\t}\n\t\t\telse {\n\t\t\t\tc2 = utftext.charCodeAt(i+1);\n\t\t\t\tc3 = utftext.charCodeAt(i+2);\n\t\t\t\tstring += String.fromCharCode(((c & 15) << 12) | ((c2 & 63) << 6) | (c3 & 63));\n\t\t\t\ti += 3;\n\t\t\t}\n\n\t\t}\n\n\t\treturn string;\n\t}\n\n};\n\nexport default Base64;\n\n\n\n// WEBPACK FOOTER //\n// ./src/util/base64.js","import Point from \"../geometry/Point\";\nimport Rectangle from \"../geometry/Rectangle\";\n\n// bean requires the existence of window\nif (typeof window === 'undefined' && typeof global !== 'undefined') {\n\tglobal.window = { addEventHandler: function() {} };\n\tglobal.document = {};\n\tglobal.navigator = {};\n}\n\n// util variables\nlet _debugging = [], _debugAll = false, typeRegistry = {}, splice = Array.splice;\n\n/**\n * Utility functions\n */\nexport default {\n\ttype: function (namespace, name, type) {\n\t\tif (!typeRegistry[namespace])\n\t\t\ttypeRegistry[namespace] = new Map();\n\t\tif (!name)\n\t\t\treturn typeRegistry[namespace];\n\t\tif (!type)\n\t\t\treturn typeRegistry[namespace].get(name);\n\t\ttypeRegistry[namespace].set(name, type);\n\t},\n\n\tcreateType: function (namespace, props, defaultType) {\n\t\tlet name = props.name;\n\n\t\t// first check if type exists\n\t\tlet type = this.type(namespace, name);\n\t\tif (!type) {\n\t\t\tlet extend = props.extends ? this.type(namespace, props.extends) : null;\n\t\t\tif (!extend && defaultType)\n\t\t\t\textend = defaultType;\n\t\t\tif (extend)\n\t\t\t\ttype = class extends extend {\n\t\t\t\t};\n\t\t\telse {\n\t\t\t\ttype = class {\n\t\t\t\t\tconstructor(config) {\n\t\t\t\t\t\t_.assign(this, config);\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t}\n\t\t\tdelete props.name;\n\t\t\tdelete props.extends;\n\t\t\t_.assign(type.prototype, props);\n\t\t\ttype.typeName = name;\n\t\t\tthis.type(namespace, name, type);\n\t\t\tthis.log('Utils', 'Utils.createType - ' + namespace + '.' + name);\n\t\t}\n\t\treturn type;\n\t},\n\n\tbuildTypes: function (types, namespace, defaultType) {\n\t\tthis.log('Utils', 'Utils.buildTypes - ' + namespace);\n\n\t\tif (!types && defaultType) {\n\t\t\tthis.createType(namespace, defaultType);\n\t\t\tthis.log('Utils', 'Utils.buildTypes end');\n\t\t\treturn;\n\t\t}\n\t\tif (defaultType) {\n\t\t\tlet type = _.remove(types, {name: defaultType.name});\n\t\t\ttype = type.length > 0 ? type[0] : null;\n\t\t\tif (type)\n\t\t\t\tdefaultType = this.createType(namespace, _.defaultsDeep(type, defaultType));\n\t\t\telse\n\t\t\t\tdefaultType = this.createType(namespace, defaultType);\n\t\t}\n\n\t\t_.forEach(types, (type) => {\n\t\t\tthis.createType(namespace, type, defaultType);\n\t\t});\n\t\tthis.log('Utils', 'Utils.buildTypes end');\n\t},\n\n\t// Helper function to correctly set up the prototype chain, for subclasses.\n\t// Similar to `goog.inherits`, but uses a hash of prototype properties and\n\t// class properties to be extended.\n\textend: function (child, parent, protoProps, staticProps) {\n\t\t// Add static properties to the constructor function, if supplied.\n\t\t_.extend(child, parent, staticProps);\n\n\t\t// Set the prototype chain to inherit from `parent`, without calling\n\t\t// `parent`'s constructor function.\n\t\tvar Surrogate = function () {\n\t\t\tthis.constructor = child;\n\t\t};\n\t\tSurrogate.prototype = parent.prototype;\n\t\tchild.prototype = new Surrogate;\n\n\t\t// Add prototype properties (instance properties) to the subclass,\n\t\t// if supplied.\n\t\tif (protoProps) _.extend(child.prototype, protoProps);\n\n\t\t// Set a convenience property in case the parent's prototype is needed later.\n\t\tchild.superclass = parent.prototype;\n\n\t\treturn child;\n\t},\n\n\tinitConfig: function (obj, config) {\n\t\tlet props = {}, c = obj.constructor, cArr = [c];\n\t\twhile (c) {\n\t\t\tif (c.super) {\n\t\t\t\tc = c.super.constructor;\n\t\t\t\tsplice.apply(cArr, [0, 0, c]);\n\t\t\t} else\n\t\t\t\tc = null;\n\t\t}\n\n\t\tfor (let i = 0; i < cArr.length; i++) {\n\t\t\tc = cArr[i];\n\t\t\tif (c.DEFAULTS)\n\t\t\t\t_.assign(props, c.DEFAULTS);\n\t\t}\n\t\tobj.props = _.assign(props, config);\n\t\tc.prototype.prop = function (name, value) {\n\t\t\tif (!value)\n\t\t\t\treturn this.props[name];\n\t\t\tthis.props[name] = value;\n\t\t};\n\t},\n\n\t/**\n\t * Gets the JS class constructor.\n\t * @param {Object} jsClass\n\t * @param {Object} defaultClass\n\t */\n\tgetConstructor: function (jsClass, defaultClass) {\n\t\tif (!jsClass)\n\t\t\tjsClass = defaultClass;\n\n\t\tif (_.isString(jsClass))\n\t\t\tjsClass = eval(jsClass);\n\t\treturn jsClass;\n\t},\n\n\tdebug: function (moduleName) {\n\t\tif (moduleName) {\n\t\t\t_debugging.push(moduleName);\n\t\t} else {\n\t\t\t_debugAll = true;\n\t\t}\n\t},\n\n\tlog: function (name, message) {\n\t\tif (!window.console) {\n\t\t\treturn;\n\t\t}\n\t\tvar debug = _debugAll;\n\t\tif (!_debugAll) {\n\t\t\tdebug = false;\n\t\t\tfor (var i = 0; i < _debugging.length; i++) {\n\t\t\t\tif (_debugging[i] == name) debug = true;\n\t\t\t}\n\t\t}\n\t\tif (!debug) {\n\t\t\treturn;\n\t\t}\n\t\twhile (name.length < 10) {\n\t\t\tname = name + ' ';\n\t\t}\n\t\tname = name.substring(0, 10) + \" - \";\n\t\tconsole.info(name, message);\n\t},\n\n\t/**\n\t * Get the relative position of sub shapes within a parent share.\n\t * @param bounds\n\t * @param geometry The geometry information, the format of Geometry is:\n\t * {\n\t *      x: \"x coordinate of ref point, if less than 1, will be treated as the percentage of the parent width.\",\n\t *      y: \"y coordinate of ref point.\",\n\t *      anchorX: \"x pos of child relative to the ref point\",\n\t *      anchorY: \"y pos of child relative to the ref point\",\n\t *      offsetX: \"the offset in the x direction.\",\n\t *      offsetY: \"the offset in the y direction.\",\n\t *      width: \"the width of the child element\",\n\t *      height: \"the height of the child element\"\n\t * }\n\t * @returns {*[]}\n\t */\n\tgetRelativePosition: function (bounds, geometry) {\n\t\tlet x = Math.abs(geometry.x) <= 1 ? bounds.width * geometry.x : geometry.x;\n\t\tlet y = Math.abs(geometry.y) <= 1 ? bounds.height * geometry.y : geometry.y;\n\t\treturn this.offsetPosition([x, y], geometry);\n\t},\n\n\toffsetPosition: function (pos, geometry) {\n\t\treturn [pos[0] + geometry.width * geometry.anchorX + geometry.offsetX, pos[1] + geometry.height * geometry.anchorY + geometry.offsetY];\n\t},\n\n\t/**\n\t * Get the position relative to the graph that's unscaled, i.e., absolute position without considering translation and scale.\n\t * @param t the current translate\n\t * @param scale the current scale\n\t * @param o can be either a Point or a Rectangle or a Point array.\n\t */\n\tunscale: function (t, scale, o) {\n\t\tif (o instanceof Rectangle)\n\t\t\treturn new Rectangle(o.x * scale + t[0], o.y * scale + t[1], o.width * scale, o.height * scale);\n\t\telse if (o instanceof Point)\n\t\t\treturn new Point(o.x * scale + t[0], o.y * scale + t[1]);\n\t\telse\n\t\t\treturn [o[0] * scale + t[0], o[1] * scale + t[1]];\n\t},\n\n\t/**\n\t * Get the position relative to the graph that's scaled, i.e., relative position considering translation and scale.\n\t * @param t the current translation\n\t * @param scale the current scale\n\t * @param o can be either a Point or a Rectangle or a Point array.\n\t */\n\tscale: function (t, scale, o) {\n\t\tif (o instanceof Rectangle)\n\t\t\treturn new Rectangle((o.x - t[0]) / scale, (o.y - t[1]) / scale, o.width / scale, o.height / scale);\n\t\telse if (o instanceof Point)\n\t\t\treturn new Point((o.x - t[0]) / scale, (o.y - t[1]) / scale);\n\t\telse\n\t\t\treturn [(o[0] - t[0]) / scale, (o[1] - t[1]) / scale];\n\t},\n\n\t/**\n\t * Convenience method.\n\t */\n\tgetProperty: function (obj, prop) {\n\t\tif (!obj)\n\t\t\treturn null;\n\t\tif (_.has(obj, prop))\n\t\t\treturn obj[prop];\n\t\tif (obj.prop && _.isFunction(obj.prop))\n\t\t\treturn obj.prop(prop);\n\t\treturn null;\n\t}\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/util/Utils.js","class Point {\n\tconstructor(x, y) {\n\t\tthis.x = x;\n\t\tthis.y = y;\n\t}\n\n\t/**\n\t * Make a clone of this point\n\t */\n\tclone() {\n\t\treturn new Point(this.x, this.y);\n\t}\n\n\t/**\n\t * Calculate the distance from this pt to the other pt.\n\t * @param aPt\n\t * @returns {number}\n\t */\n\tdistance(aPt) {\n\t\treturn Math.sqrt((this.x - aPt.x) * (this.x - aPt.x) + (this.y - aPt.y) * (this.y - aPt.y));\n\t}\n\n\t/**\n\t * Translate this point\n \t */\n\ttranslate(p2) {\n\t\tthis.x += p2.x;\n\t\tthis.y += p2.y;\n\t\treturn this;\n\t}\n\n\t/**\n\t * Scale this vector\n \t */\n\tscale(scale) {\n\t\tthis.x *= scale;\n\t\tthis.y *= scale;\n\t\treturn this;\n\t}\n\n\tgetScaled(scale) {\n\t\treturn new Point(this.x * scale, this.y * scale);\n\t}\n\n\tgetTranslated(p2) {\n\t\treturn new Point(this.x + p2.x, this.y + p2.y);\n\t}\n\n\t/**\n\t * Get the direction vector from this point to p2.\n\t * @param p2\n\t * @returns {Point}\n\t */\n\tgetDirection(p2) {\n\t\tvar dist = this.distance(p2);\n\t\treturn new Point((p2.x - this.x) / dist, (p2.y - this.y) / dist);\n\t}\n\n\t/**\n\t * rotate the point about the origin. With the specified angle.\n\t * @param angle the angle to rotate\n\t */\n\trotate(angle) {\n\t\tvar cos = Math.cos(angle * Math.PI / 180);\n\t\tvar sin = Math.sin(angle * Math.PI / 180);\n\t\tvar x = this.x, y = this.y;\n\t\tthis.x = x * cos - y * sin;\n\t\tthis.y = x * sin + y * cos;\n\t\treturn this;\n\t}\n\n\tgetRotated(angle) {\n\t\treturn this.clone().rotate(angle);\n\t}\n\n\t/**\n\t * Calculate the dot product, treating this and p2 as vectors.\n\t */\n\tdotProduct(p2) {\n\t\treturn this.x * p2.x + this.y * p2.y;\n\t}\n\n\t/**\n\t * Get the mid point between this and p2.\n \t */\n\tgetMidPoint(p2) {\n\t\treturn new Point((this.x + p2.x) / 2, (this.y + p2.y) / 2);\n\t}\n\n\treverse() {\n\t\tthis.x = -this.x;\n\t\tthis.y = -this.y;\n\t\treturn this;\n\t}\n\n\tequals(p2) {\n\t\tif (!p2 || p2.constructor != Point) return false;\n\n\t\treturn (this.x == p2.x && this.y == p2.y);\n\t}\n\n\t/**\n\t * Reflect this point w.r.t. the rectangle.\n\t * If vertical is true, it will reflect the point cross the vertical\n\t * central line of the rectangle, otherwise reflect cross the horizontal\n\t * central line.\n\t *\n\t * @param rect the rectangle\n\t * @param vertical whether is vertical reflection or horizontal reflection.\n\t */\n\treflect(rect, vertical) {\n\t\tif (vertical)\n\t\t\tthis.x = 2 * rect.x - this.x;\n\t\telse\n\t\t\tthis.y = 2 * rect.y - this.y;\n\t\treturn this;\n\t}\n\n\ttoString() {\n\t\treturn this.x + \",\" + this.y;\n\t}\n}\n\nPoint.W = new Point(-1, 0);\nPoint.N = new Point(0, -1);\nPoint.S = new Point(0, 1);\nPoint.E = new Point(1, 0);\nPoint.NE = new Point(1, -1);\nPoint.NW = new Point(-1, -1);\nPoint.SE = new Point(1, 1);\nPoint.SW = new Point(-1, 1);\n\nexport default Point;\n\n\n\n// WEBPACK FOOTER //\n// ./src/geometry/Point.js","import _ from \"lodash\";\r\nimport Point from \"./Point\";\r\nimport Shape from \"./Shape\";\r\n\r\nexport default class Rectangle extends Shape {\r\n\t/**\r\n\t * Checks whether this rectangle contains a given point of a given rectangle\r\n\t */\r\n\tcontains(el) {\r\n\t\tlet w = el.width || 0;\r\n\t\tlet h = el.height || 0;\r\n\t\tlet left = el.x - w/2;\r\n\t\tlet right = el.x + w/2;\r\n\t\tlet top = el.y - h/2;\r\n\t\tlet bottom = el.y + h/2;\r\n\t\treturn (right <= this.right) && (left >= this.left) &&\r\n\t\t\t(top >= this.top) && (bottom <= this.bottom);\r\n\t}\r\n\r\n\t/**\r\n\t * Calcualte the distance to a point. 0 if this rectangle contains the point.\r\n\t */\r\n\tdistance(pt) {\r\n\t\tif (this.contains(pt)) return 0;\r\n\r\n\t\tif (pt.x < this.left) {\r\n\t\t\tif (pt.y < this.top)\r\n\t\t\t\treturn pt.distance(new Point(this.left, this.top));\r\n\t\t\tif (pt.y <= this.bottom)\r\n\t\t\t\treturn this.left - pt.x;\r\n\t\t\treturn pt.distance(new Point(this.left, this.bottom));\r\n\t\t}\r\n\t\tif (pt.x <= this.right) {\r\n\t\t\tif (pt.y <= this.top)\r\n\t\t\t\treturn this.top - pt.y;\r\n\t\t\treturn pt.y - this.bottom;\r\n\t\t}\r\n\t\tif (pt.y < this.top)\r\n\t\t\treturn pt.distance(new Point(this.right, this.top));\r\n\t\tif (pt.y <= this.bottom)\r\n\t\t\treturn pt.x - this.right;\r\n\t\treturn pt.distance(new Point(this.right, this.bottom));\r\n\t}\r\n\r\n\t/**\r\n\t * Given two points, we want to detect whether the line joining the pts intersect\r\n\t * with the rectangle or not. We assume only horizontal or vertical line segments.\r\n\t *\r\n\t * @return int the side of the intersection: -1: no intersection, 0: left, 1: top, 2: right, 3: bottom, 4: containment.\r\n\t */\r\n\tdetectIntersection(pt1, pt2) {\r\n\t\tlet horizontal = pt1.y == pt2.y;\r\n\t\tlet contains1 = this.contains(pt1);\r\n\t\tlet contains2 = this.contains(pt2);\r\n\t\tif (contains1 && contains2) return 4;\r\n\t\tif (!contains1 && !contains2) {\r\n\t\t\tif (horizontal && (pt1.y >= this.top && pt1.y <= this.bottom)) {\r\n\t\t\t\tif (pt1.x < this.left && pt2.x > this.right)\r\n\t\t\t\t\treturn 0;\r\n\t\t\t\tif (pt1.x > this.right && pt2.x < this.left)\r\n\t\t\t\t\treturn 2;\r\n\t\t\t}\r\n\t\t\tif (!horizontal && (pt1.x >= this.left && pt1.x <= this.right)) {\r\n\t\t\t\tif (pt1.y < this.top && pt2.y > this.bottom)\r\n\t\t\t\t\treturn 1;\r\n\t\t\t\tif (pt1.y > this.bottom && pt2.y < this.top)\r\n\t\t\t\t\treturn 3;\r\n\t\t\t}\r\n\t\t\treturn -1;\r\n\t\t}\r\n\r\n\t\tlet outPt = contains1 ? pt2 : pt1;\r\n\t\tif (horizontal) {\r\n\t\t\tif (outPt.x > this.right)\r\n\t\t\t\treturn 2;\r\n\t\t\treturn 0;\r\n\t\t} else {\r\n\t\t\tif (outPt.y < this.top)\r\n\t\t\t\treturn 1;\r\n\t\t\treturn 3;\r\n\t\t}\r\n\t}\r\n\r\n\ttoString() {\r\n\t\treturn 'Rectangle:{x=' + this.x + ';y=' + this.y + ';width=' + this.width + ';height=' + this.height + '}';\r\n\t}\r\n\r\n\tstatic getPerimeter(rect, pt, orthogonal = false) {\r\n\t\tlet x = rect.x;\r\n\t\tlet y = rect.y;\r\n\t\tlet dx = pt.x - x;\r\n\t\tlet dy = pt.y - y;\r\n\t\tlet alpha = Math.atan2(dy, dx);\r\n\t\tlet p = new Point(0, 0);\r\n\t\tlet pi = Math.PI;\r\n\t\tlet pi2 = Math.PI/2;\r\n\t\tlet beta = pi2 - alpha;\r\n\t\tlet t = Math.atan2(rect.height, rect.width);\r\n\r\n\t\tif (alpha < -pi + t || alpha > pi - t) {\r\n\t\t\t// Left edge\r\n\t\t\tp.x = rect.left;\r\n\t\t\tp.y = y - rect.width * Math.tan(alpha) / 2;\r\n\t\t} else if (alpha < -t) {\r\n\t\t\t// Top Edge\r\n\t\t\tp.y = rect.top;\r\n\t\t\tp.x = x - rect.height * Math.tan(beta) / 2;\r\n\t\t} else if (alpha < t) {\r\n\t\t\t// Right Edge\r\n\t\t\tp.x = rect.right;\r\n\t\t\tp.y = y + rect.width * Math.tan(alpha) / 2;\r\n\t\t} else {\r\n\t\t\t// Bottom Edge\r\n\t\t\tp.y = rect.bottom;\r\n\t\t\tp.x = x + rect.height * Math.tan(beta) / 2;\r\n\t\t}\r\n\r\n\t\tif (orthogonal) {\r\n\t\t\tif (alpha < -pi + t || alpha > pi - t) {\r\n\t\t\t\t// Left edge\r\n\t\t\t\tp.x = rect.left;\r\n\t\t\t\tp.y = y;\r\n\t\t\t} else if (alpha < -t) {\r\n\t\t\t\t// Top Edge\r\n\t\t\t\tp.y = rect.top;\r\n\t\t\t\tp.x = x;\r\n\t\t\t} else if (alpha < t) {\r\n\t\t\t\t// Right Edge\r\n\t\t\t\tp.x = rect.right;\r\n\t\t\t\tp.y = y;\r\n\t\t\t} else {\r\n\t\t\t\t// Bottom Edge\r\n\t\t\t\tp.y = rect.bottom;\r\n\t\t\t\tp.x = x;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tlet dir = Rectangle.getDirection(rect, p, orthogonal);\r\n\t\treturn {point: p, direction: dir};\r\n\t}\r\n\r\n\t/**\r\n\t * Return the bounding rectangle that contains p1 and p2\r\n\t */\r\n\tstatic getBoundingRectangle(pts, margin) {\r\n\t\tif (!pts || pts.length == 0) return null;\r\n\t\tmargin = margin || [0, 0, 0, 0];\r\n\t\tif (!_.isArray(margin))\r\n\t\t\tmargin = [margin, margin, margin, margin];\r\n\t\tlet min = [pts[0].x, pts[0].y];\r\n\t\tlet max = [pts[0].x, pts[0].y];\r\n\t\tfor (let i = 1; i < pts.length; i++) {\r\n\t\t\tlet p = pts[i];\r\n\t\t\tif (p.x < min[0]) {\r\n\t\t\t\tmin[0] = p.x;\r\n\t\t\t}\r\n\t\t\tif (p.y < min[1]) {\r\n\t\t\t\tmin[1] = p.y;\r\n\t\t\t}\r\n\t\t\tif (p.x > max[0]) {\r\n\t\t\t\tmax[0] = p.x;\r\n\t\t\t}\r\n\t\t\tif (p.y > max[1]) {\r\n\t\t\t\tmax[1] = p.y;\r\n\t\t\t}\r\n\t\t}\r\n\t\tmin[0] = min[0] - margin[0];\r\n\t\tmin[1] = min[1] - margin[1];\r\n\t\tmax[0] = max[0] + margin[2];\r\n\t\tmax[1] = max[1] + margin[3];\r\n\t\tlet w = Math.abs(max[0] - min[0]);\r\n\t\tlet h = Math.abs(max[1] - min[1]);\r\n\t\treturn new Rectangle(min[0] + w/2, min[1] + h/2, w, h);\r\n\t}\r\n\r\n\t/**\r\n\t * Create a union of all the rectangles.\r\n\t * @param rects\r\n\t */\r\n\tstatic union(rects) {\r\n\t\tlet minx = null, miny = null, maxx = -Infinity, maxy = -Infinity;\r\n\t\t_.each(rects, function (rect) {\r\n\t\t\tminx = minx || rect.x;\r\n\t\t\tminy = miny || rect.y;\r\n\t\t\tminx = Math.min(minx, rect.x);\r\n\t\t\tminy = Math.min(miny, rect.y);\r\n\t\t\tmaxx = Math.max(maxx, rect.right());\r\n\t\t\tmaxy = Math.max(maxy, rect.bottom());\r\n\t\t});\r\n\t\tminx = minx || 0;\r\n\t\tminy = miny || 0;\r\n\t\treturn new Rectangle(minx, miny, maxx - minx, maxy - miny);\r\n\t}\r\n\r\n\t/**\r\n\t * Returns the direction the point <i>p</i> is in relation to the given rectangle.\r\n\t * Possible values are WEST (-1,0), EAST (1,0), NORTH (0,-1) and SOUTH (0,1) if orthogonal is true, otherwise return\r\n\t * the direction connection the center of r and p.\r\n\t * @param r\r\n\t * @param p\r\n\t * @param orthogonal\r\n\t * @returns {Point|*}\r\n\t */\r\n\tstatic getDirection(r, p, orthogonal = false) {\r\n\t\tif (!orthogonal)\r\n\t\t\treturn new Point(r.x, r.y).getDirection(new Point(p.x, p.y));\r\n\r\n\t\tlet i, distance = Math.abs(r.left - p.x), direction = Point.W;\r\n\r\n\t\ti = Math.abs(r.top - p.y);\r\n\t\tif (i <= distance) {\r\n\t\t\tdistance = i;\r\n\t\t\tdirection = Point.N;\r\n\t\t}\r\n\r\n\t\ti = Math.abs(r.bottom - p.y);\r\n\t\tif (i <= distance) {\r\n\t\t\tdistance = i;\r\n\t\t\tdirection = Point.S;\r\n\t\t}\r\n\r\n\t\ti = Math.abs(r.right - p.x);\r\n\t\tif (i < distance) {\r\n\t\t\tdirection = Point.E;\r\n\t\t}\r\n\r\n\t\treturn direction;\r\n\t}\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/geometry/Rectangle.js","module.exports = __WEBPACK_EXTERNAL_MODULE_5__;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external {\"root\":\"_\",\"commonjs\":\"lodash\",\"commonjs2\":\"lodash\",\"amd\":\"lodash\"}\n// module id = 5\n// module chunks = 0","import _ from \"lodash\";\nimport Point from \"./Point\";\nimport Rectangle from \"./Rectangle\";\n\nlet registry = {};\n\nclass Shape {\n\tconstructor(x, y, width, height, config) {\n\t\tthis.x = x;\n\t\tthis.y = y;\n\t\tthis.width = width;\n\t\tthis.height = height;\n\t\t_.defaults(this, config, {x: 0, y: 0, width: 0, height: 0});\n\t}\n\n\t/**\n\t * Return the y-coord of the top side of this rectangle\n\t */\n\tget top() { return this.y - this.height/2; }\n\n\t/**\n\t * Returns the y-coordinate of the bottom of this Rectangle.\n\t */\n\tget bottom() { return this.y + this.height/2; }\n\n\t/**\n\t * Return the x-coord of left side of this rectangle\n\t */\n\tget left() { return this.x - this.width/2; }\n\n\t/**\n\t * Returns the x-coordinate of the right side of this Rectangle.\n\t */\n\tget right() { return this.x + this.width/2; }\n\n\tget center() { return new Point(this.x, this.y); }\n\n\tget bounds() { return new Rectangle(this.x, this.y, this.width, this.height); }\n\n\tcontains(el) { return false; }\n\n\t/**\n\t * This will generate n ports on the shape.\n\t */\n\tgetRegularPoints(n) {return null;}\n\n\t/**\n\t * Get the intersection between boundary of this shape and the line connecting (x,y) with the refPt.\n\t * @param refPt\n\t * @param orthogonal\n\t * @returns {*|{point, direction}}\n\t */\n\tgetPerimeter(refPt, orthogonal = false) {\n\t\treturn this.constructor.getPerimeter(this, refPt, orthogonal);\n\t}\n\n\trender(view) {\n\t\tlet template = _.template(view.getTemplate(this.name, this));\n\t\treturn template(this);\n\t}\n\n\tstatic getShape(name) {\n\t\treturn registry[name];\n\t}\n\n\tstatic addShape(name, c) {\n\t\tregistry[name] = c;\n\t}\n\n\tstatic removeShape(name) {\n\t\tdelete registry[name];\n\t}\n}\n\nexport default Shape;\n\n\n\n\n\n// WEBPACK FOOTER //\n// ./src/geometry/Shape.js","import _ from \"lodash\";\n\n/**\n * dom Utility functions\n */\nexport default {\n\tisIE: (function () {\n\t\tif (!window || !window.navigator || !navigator) return false;\n\t\tvar sAgent = window.navigator.userAgent;\n\t\tvar Idx = sAgent.indexOf(\"MSIE\");\n\n\t\t// If IE, return version number.\n\t\tif (Idx > 0)\n\t\t\treturn parseInt(sAgent.substring(Idx + 5, sAgent.indexOf(\".\", Idx)));\n\n\t\t// If IE 11 then look for Updated user agent string.\n\t\telse if (!!navigator.userAgent.match(/Trident\\/7\\./))\n\t\t\treturn 11;\n\t\telse if (!!navigator.userAgent.match(/Edge\\//))\n\t\t\treturn \"Edge\";\n\t\telse\n\t\t\treturn false;\n\t})(),\n\n\tisFireFox : (function(){\n\t\t// InstallTrigger: Firefox's API to install add-ons\n\t\treturn typeof InstallTrigger !== 'undefined';\n\t})(),\n\n\tisChrome: (function() {\n\t\tif (!window || !window.navigator || !navigator || navigator.userAgent.indexOf('Edge') >= 0) return false;\n\t\tvar raw = navigator.userAgent.match(/Chrom(e|ium)\\/([0-9]+)\\./);\n\t\treturn raw ? parseInt(raw[2], 10) : false;\n\t})(),\n\n\tisMac: (function() {\n\t\tif (!window || !window.navigator || !navigator) return false;\n\t\treturn navigator.platform.toUpperCase().indexOf('MAC') >= 0;\n\t})(),\n\n\tisWindows: (function() {\n\t\tif (!window || !window.navigator || !navigator) return false;\n\t\treturn navigator.appVersion.indexOf(\"Windows\") >= 0;\n\t})(),\n\n\tisLinux: (function() {\n\t\tif (!window || !window.navigator || !navigator) return false;\n\t\treturn navigator.appVersion.indexOf(\"Linux\") >= 0;\n\t})(),\n\n\tcreateElement: function (tag, attribs, styles, html) {\n\t\tlet el = document.createElement(tag);\n\t\tthis.setElement(el, attribs, styles);\n\t\tif (html)\n\t\t\tel.innerHTML = html;\n\t\treturn el;\n\t},\n\n\tcreateElementByString: function(str) {\n\t\tlet temp = this.createElement('div', null, null, str);\n\t\treturn temp.childNodes;\n\t},\n\n\tsetElement: function (el, attribs, styles) {\n\t\tif (attribs) {\n\t\t\t_.forEach(attribs, function(value, key) {\n\t\t\t    el.setAttribute(key, value);\n\t\t\t });\n\t\t}\n\t\tif (styles) {\n\t\t\t_.forEach(styles, function(value, key) {\n\t\t\t\tel.style[key] = value;\n\t\t\t});\n\t\t}\n\t},\n\n\ttestElement: function(node, method) {\n\t\treturn node && node.nodeType == 1 && ( !method || method(node) );\n\t},\n\n\tgetAncestorBy: function(node, method) {\n\t\twhile (node = node.parentNode)\n\t\t\tif (this.testElement(node, method) )\n\t\t\t\treturn node;\n\n\t\treturn null;\n\t},\n\n\t/**\n\t * Get the position of element relative to the context.\n\t * @param el the element\n\t * @param context\n\t * @returns {*[]}\n\t */\n\tgetPosition(el, context) {\n\t\tif (!context) context = document.body;\n\t\tlet elRect = el.getBoundingClientRect();\n\t\tlet contextRect = context.getBoundingClientRect();\n\n\t\treturn [elRect.left - contextRect.left, elRect.top - contextRect.top];\n\t},\n\n\tgetCenterPosition(el, context) {\n\t\tif (!context) context = document.body;\n\t\tlet elRect = el.getBoundingClientRect();\n\t\tlet contextRect = context.getBoundingClientRect();\n\t\tlet w = elRect.right - elRect.left;\n\t\tlet h = elRect.bottom - elRect.top;\n\n\t\treturn [elRect.left - contextRect.left + w/2, elRect.top - contextRect.top + h/2];\n\t},\n\n\tmove: function(el, x, y) {\n\t\tif (x) el.style.left = x + 'px';\n\t\tif (y) el.style.top = y + 'px';\n\t},\n\n\tgetSize: function(el) {\n\t\tvar w = parseInt(el.style.offsetWidth, 10);\n\t\tvar h = parseInt(el.style.offsetHeight, 10);\n\t\treturn [w, h];\n\t},\n\n\tresize: function(el, w, h) {\n\t\tif (w) el.style.width = w + \"px\";\n\t\tif (h) el.style.height = h + 'px';\n\t},\n\n\tpreloadImages: function(array) {\n\t\tif (!this.preloadImages.list) this.preloadImages.list = [];\n\t\tif (!this.preloadImages.loaded) this.preloadImages.loaded = {};\n\n\t\tvar list = this.preloadImages.list;\n\t\tvar img, that = this;\n\t\tfor (var i = 0; i < array.length; i++) {\n\t\t\timg = new Image();\n\t\t\timg.onload = function() {\n\t\t\t\tvar index = list.indexOf(this);\n\t\t\t\tif (index !== -1) {\n\t\t\t\t\tthat.preloadImages.loaded[this.name] = {width: this.width, height: this.height};\n\t\t\t\t\t// remove image from the array once it's loaded\n\t\t\t\t\t// for memory consumption reasons\n\t\t\t\t\tlist.splice(index, 1);\n\t\t\t\t}\n\t\t\t};\n\t\t\tlist.push(img);\n\t\t\timg.src = array[i];\n\t\t\timg.name = array[i];\n\t\t}\n\t},\n\n\t/**\n\t * Get's the image's information given the url. Must be preloaded by calling the preloadImage function.\n\t * @param src\n\t */\n\tgetImageInfo: function(src) {\n\t\tif (this.preloadImages.loaded) {\n\t\t\treturn this.preloadImages.loaded[src];\n\t\t}\n\t\treturn null;\n\t},\n\n\tdownloadFile: function(name, data) {\n\t\tif (!data) return;\n\t\tlet mime = data.match(/^data:([^;,]*)/)[1];\n\t\tif (name.indexOf('.') < 0) {\n\t\t\tif (!mime) mime = 'text/plain';\n\t\t\tif (mime == 'text/plain')\n\t\t\t\tname = name + '.txt';\n\t\t\telse {\n\t\t\t\tlet type = mime.split('/')[1];\n\t\t\t\tif (type.indexOf('+') > 0) type = type.split('+')[0];\n\t\t\t\tname = name + '.' + type;\n\t\t\t}\n\t\t}\n\t\tif (this.isIE) {\n\t\t\tlet encoded = data.indexOf(';base64') >= 0;\n\t\t\tif (encoded)\n\t\t\t\tdata = atob(data.replace('data:' + mime + ';base64,', ''));\n\t\t\telse\n\t\t\t\tdata = decodeURI(data.replace('data:' + mime + ',', ''));\n\t\t\tdata = this.GetBlob(data, mime);\n\t\t\tnavigator.msSaveBlob(data, name);\n\t\t} else {\n\t\t\tlet link = this.createElement('a', {href: data, download: name}, {display: \"none\"});\n\t\t\tdocument.body.appendChild(link);\n\t\t\tlink.click();\n\t\t\tlink.parentNode.removeChild(link);\n\t\t}\n\t},\n\n\t/**\n\t * Convert b54 to blob. IE only\n\t */\n\tGetBlob: function (data, contentType, sliceSize) {\n\t\tcontentType = contentType || '';\n\t\tsliceSize = sliceSize || 512;\n\n\t\tvar byteArrays = [];\n\n\t\tfor (var offset = 0; offset < data.length; offset += sliceSize) {\n\t\t\tvar slice = data.slice(offset, offset + sliceSize);\n\n\t\t\tvar byteNumbers = new Array(slice.length);\n\t\t\tfor (var i = 0; i < slice.length; i++) {\n\t\t\t\tbyteNumbers[i] = slice.charCodeAt(i);\n\t\t\t}\n\t\t\tvar byteArray = new Uint8Array(byteNumbers);\n\t\t\tbyteArrays.push(byteArray);\n\t\t}\n\t\treturn new Blob(byteArrays, {type: contentType});\n\t},\n\n\topenImage: function(name, image) {\n\t\tvar myWindow = window.open(\"\", \"_blank\", \"toolbar=yes, scrollbars=yes, resizable=yes, width=500, height=500\");\n\t\tvar myDocument = myWindow.document;\n\t\tvar img = myDocument.createElement(\"img\");\n\t\tthis.setElement(img, {src: image, name: name});\n\t\tmyDocument.body.appendChild(img);\n\t},\n\n\t/**\n\t * Check whether the key event is from input, textarea or select.\n\t * @param e  input event\n\t */\n\teventFromInput: function(e){\n\t\tvar tagName = e.target.tagName;\n\t\treturn (tagName == 'INPUT' || tagName == 'TEXTAREA' || tagName == 'SELECT');\n\t}\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/util/DomUtils.js","import _ from \"lodash\";\n\n/**\n * A string buffer for fast string manipulation\n */\nexport default class StringBuffer {\n\tconstructor(str) {\n\t\tthis.buffer = [];\n\t\tif (str)\n\t\t\tthis.buffer.push(str);\n\t}\n\n\tappend(stuff) {\n\t\tif (_.isString(stuff))\n\t\t\tthis.buffer.push(stuff);\n\t\telse if (_.isArray(stuff))\n\t\t\tthis.buffer = this.buffer.concat(stuff);\n\t\telse\n\t\t\tthis.buffer.push(\"\" + stuff);\n\t\treturn this;\n\t}\n\n\tprepend(stuff) {\n\t\tif (_.isString(stuff))\n\t\t\tthis.buffer.splice(0, 0, stuff);\n\t\telse if (_.isArray(stuff))\n\t\t\tthis.buffer = stuff.concat(this.buffer);\n\t\telse\n\t\t\tthis.buffer.splice(0, 0, \"\" + stuff);\n\t\treturn this;\n\t}\n\n\tclear() {\n\t\tthis.buffer = [];\n\t}\n\n\tremoveLast() {\n\t\tthis.buffer.pop();\n\t\treturn this;\n\t}\n\n\ttoString(sep) {\n\t\tif (!sep) sep = '';\n\t\treturn this.buffer.join(sep);\n\t}\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/util/StringBuffer.js","import Point from \"./Point\";\n\nexport default class Line {\n\tconstructor(start, end) {\n\t\tthis.start = start;\n\t\tthis.end = end;\n\t}\n\n\t/**\n\t * Calculate the length of this line\n\t */\n\tlength() {\n\t\treturn this.start.distance(this.end);\n\t}\n\n\t/**\n\t * Calculate the distance of this line to the point.\n\t */\n\tdistance(pt) {\n\t\tvar x = this.start.distance(pt);\n\t\tif (x == 0) return 0;\n\n\t\tvar l = this.length();\n\t\tvar cosa = new Point((this.end.x - this.start.x) / l, (this.end.y - this.start.y) / l).dotProduct(\n\t\t\tnew Point(pt.x / x, pt.y / x));\n\n\t\treturn x * Math.sqrt(1 - cosa * cosa);\n\t}\n\n\t/**\n\t * Function: intersection\n\t *\n\t * Returns the intersection of two lines as an <mxPoint>.\n\t *\n\t * Parameters:\n\t *\n\t * x0 - X-coordinate of the first line's startpoint.\n\t * y0 - X-coordinate of the first line's startpoint.\n\t * x1 - X-coordinate of the first line's endpoint.\n\t * y1 - Y-coordinate of the first line's endpoint.\n\t * x2 - X-coordinate of the second line's startpoint.\n\t * y2 - Y-coordinate of the second line's startpoint.\n\t * x3 - X-coordinate of the second line's endpoint.\n\t * y3 - Y-coordinate of the second line's endpoint.\n\t */\n\tstatic intersection(x0, y0, x1, y1, x2, y2, x3, y3) {\n\t\tvar denom = ((y3 - y2) * (x1 - x0)) - ((x3 - x2) * (y1 - y0));\n\t\tvar nume_a = ((x3 - x2) * (y0 - y2)) - ((y3 - y2) * (x0 - x2));\n\t\tvar nume_b = ((x1 - x0) * (y0 - y2)) - ((y1 - y0) * (x0 - x2));\n\n\t\tvar ua = nume_a / denom;\n\t\tvar ub = nume_b / denom;\n\n\t\tif (ua >= 0.0 && ua <= 1.0 && ub >= 0.0 && ub <= 1.0) {\n\t\t\t// Get the intersection point\n\t\t\tvar intersectionX = x0 + ua * (x1 - x0);\n\t\t\tvar intersectionY = y0 + ua * (y1 - y0);\n\n\t\t\treturn new Point(intersectionX, intersectionY);\n\t\t}\n\n\t\t// No intersection\n\t\treturn null;\n\t}\n\n\ttoString() {\n\t\treturn 'Line:{start=' + this.start + ';end=' + this.end + '}';\n\t}\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/geometry/Line.js","import Shape from \"./Shape\";\nimport Point from \"./Point\";\nimport Rectangle from \"./Rectangle\";\n\nexport default class Ellipse extends Shape {\n\ttoString() {\n\t\treturn 'Ellipse:{x=' + this.x + ';y=' + this.y + ';width=' + this.width + ';height=' + this.height + '}';\n\t}\n\n\tstatic getPerimeter(rect, pt, orthogonal = false) {\n\t\tlet a = rect.width / 2;\n\t\tlet b = rect.height / 2;\n\t\tlet cx = rect.x;\n\t\tlet cy = rect.y;\n\t\tlet px = pt.x;\n\t\tlet py = pt.y;\n\n\t\t// Calculates straight line equation through\n\t\t// point and ellipse center y = d * x + h\n\t\tlet dx = parseInt(px - cx);\n\t\tlet dy = parseInt(py - cy);\n\n\t\tlet tx, ty;\n\n\t\tif (dx == 0 && dy != 0) {\n\t\t\treturn new Point(cx, cy + b * dy / Math.abs(dy));\n\t\t} else if (dx == 0 && dy == 0) {\n\t\t\treturn new Point(px, py);\n\t\t}\n\n\t\t// Calculates intersection\n\t\tlet d = dy / dx;\n\t\tlet h = cy - d * cx;\n\t\tlet e = a * a * d * d + b * b;\n\t\tlet f = -2 * cx * e;\n\t\tlet g = a * a * d * d * cx * cx + b * b * cx * cx - a * a * b * b;\n\t\tlet det = Math.sqrt(f * f - 4 * e * g);\n\n\t\t// Two solutions (perimeter points)\n\t\tlet xout1 = (-f + det) / (2 * e);\n\t\tlet xout2 = (-f - det) / (2 * e);\n\t\tlet yout1 = d * xout1 + h;\n\t\tlet yout2 = d * xout2 + h;\n\t\tlet dist1 = Math.sqrt(Math.pow((xout1 - px), 2) + Math.pow((yout1 - py), 2));\n\t\tlet dist2 = Math.sqrt(Math.pow((xout2 - px), 2) + Math.pow((yout2 - py), 2));\n\n\t\t// Correct solution\n\t\tlet xout = 0;\n\t\tlet yout = 0;\n\n\t\tif (dist1 < dist2) {\n\t\t\txout = xout1;\n\t\t\tyout = yout1;\n\t\t} else {\n\t\t\txout = xout2;\n\t\t\tyout = yout2;\n\t\t}\n\n\t\tlet p = new Point(xout, yout);\n\t\tlet dir = Rectangle.getDirection(rect, p, orthogonal);\n\t\tif (orthogonal) {\n\t\t\tif (dir.x == -1) {\n\t\t\t\treturn {point: new Point(cx - a, cy), direction: dir};\n\t\t\t}\n\t\t\tif (dir.x == 1) {\n\t\t\t\treturn {point: new Point(cx + a, cy), direction: dir};\n\t\t\t}\n\t\t\tif (dir.y == -1) {\n\t\t\t\treturn {point: new Point(cx, cy - b), direction: dir};\n\t\t\t}\n\t\t\tif (dir.y == 1) {\n\t\t\t\treturn {point: new Point(cx, cy + b), direction: dir};\n\t\t\t}\n\t\t}\n\t\treturn {point: p, direction: dir};\n\t}\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/geometry/Ellipse.js","import Shape from \"./Shape\";\nimport Point from \"./Point\";\nimport Line from \"./Line\";\n\nexport default class Rhombus extends Shape {\n\ttoString() {\n\t\treturn 'Rhombus:{x=' + this.x + ';y=' + this.y + ';width=' + this.width + ';height=' + this.height + '}';\n\t}\n\n\tstatic getPerimeter(rect, pt, orthogonal = false) {\n\t\tlet w = rect.width;\n\t\tlet h = rect.height;\n\t\tlet cx = rect.x;\n\t\tlet cy = rect.y;\n\t\tlet x = cx - w/2;\n\t\tlet y = cy - h/2;\n\n\t\tlet px = pt.x;\n\t\tlet py = pt.y;\n\n\t\t// Special case for intersecting the diamond's corners\n\t\tif (cx === px) {\n\t\t\tif (cy > py) {\n\t\t\t\treturn {point: new Point(cx, y), direction: Point.S};\n\t\t\t\t// top\n\t\t\t} else {\n\t\t\t\treturn {point: new Point(cx, y + h), direction: Point.N};\n\t\t\t\t// bottom\n\t\t\t}\n\t\t} else if (cy === py) {\n\t\t\tif (cx > px) {\n\t\t\t\treturn {point: new Point(x, cy), direction: Point.E};\n\t\t\t\t// left\n\t\t\t} else {\n\t\t\t\treturn {point: new Point(x + w, cy), direction: Point.W};\n\t\t\t\t// right\n\t\t\t}\n\t\t}\n\n\t\tlet tx = cx;\n\t\tlet ty = cy;\n\n\t\tif (orthogonal) {\n\t\t\tif (px >= x && px <= x + w) {\n\t\t\t\ttx = px;\n\t\t\t} else if (py >= y && py <= y + h) {\n\t\t\t\tty = py;\n\t\t\t}\n\t\t}\n\n\t\tlet p, dir;\n\t\t// TODO direction calculation is not quite right.\n\t\t// In which quadrant will the intersection be?\n\t\t// set the slope and offset of the border line accordingly\n\t\tif (px < cx) {\n\t\t\tif (py < cy) {\n\t\t\t\tp = Line.intersection(px, py, tx, ty, cx, y, x, cy);\n\t\t\t\tdir = Point.S;\n\t\t\t} else {\n\t\t\t\tp = Line.intersection(px, py, tx, ty, cx, y + h, x, cy);\n\t\t\t\tdir = Point.N;\n\t\t\t}\n\t\t} else if (py < cy) {\n\t\t\tp = Line.intersection(px, py, tx, ty, cx, y, x + w, cy);\n\t\t\tdir = Point.E;\n\t\t} else {\n\t\t\tp = Line.intersection(px, py, tx, ty, cx, y + h, x + w, cy);\n\t\t\tdir = Point.W;\n\t\t}\n\t\treturn {point: p, direction: dir};\n\t}\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/geometry/Rhombus.js","import _ from \"lodash\";\nimport Point from \"./Point\";\nimport Utils from \"../util/Utils\";\n\nlet defaultConfig = {\n\ttype: \"direct\",\n\tshowGauge: true,\n\torthogonal: false\n};\n\nlet defaultGeometry = {\n\twidth: 0,\n\theight: 0,\n\tanchorX: 0,\n\tanchorY: 0,\n\toffsetX: 0,\n\toffsetY: 0\n};\n\nlet linkTypes = {};\n\nclass Link {\n\tconstructor(terminalVisual, shapeConfig = {}, startMarker = null, endMarker = null) {\n\t\tthis.start = terminalVisual[0].point;\n\t\tthis.end = terminalVisual[1].point;\n\t\tthis.startNormal = terminalVisual[0].direction;\n\t\tthis.endNormal = terminalVisual[1].direction;\n\t\tthis.startMarker = startMarker;\n\t\tthis.endMarker = endMarker;\n\t\t_.assign(this, shapeConfig);\n\t}\n\n\trender(view) {\n\t\treturn view.renderLink(this);\n\t}\n\n\tget points() { return null; }\n\tget controlPts() { return null; }\n\tget length() {\n\t\tlet points = this.points;\n\t\tlet i, l = 0;\n\t\tfor (i = 0; i < points.length - 1; i++)\n\t\t\tl += points[i].distance(points[i+1]);\n\t\treturn l;\n\t}\n\n\t/**\n\t * Calculate the position where to put decorators or label..\n\t *\n\t * @param geometry: defines how far along the edge should the point be placed.\n\t * @return *[] the relative position.\n\t */\n\tgetRelativePosition(geometry) {\n\t\tif (_.isNumber(geometry))\n\t\t\tgeometry = {x: geometry};\n\t\tgeometry = _.defaults(geometry, defaultGeometry);\n\t\tlet p = geometry.x, l = this.length;\n\t\tif (Math.abs(p) <= 1) p *= l;\n\t\tif (p < 0) p = l + p;\n\t\tif (p > l) p = l;\n\n\t\tlet points = this.points, d, point, dir;\n\t\tfor (let i = 0; i < points.length - 1; i++) {\n\t\t\td = points[i].distance(points[i+1]);\n\t\t\tif (p <= d) {\n\t\t\t\t// we've located the line segment.\n\t\t\t\tpoint = points[i].clone();\n\t\t\t\tdir = point.getDirection(points[i+1]);\n\t\t\t\tpoint.translate(dir.getScaled(p));\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tp -= d;\n\t\t}\n\n\t\t// return the last point.\n\t\tif (!point)\n\t\t\tpoint = points[points.length - 1];\n\t\treturn Utils.offsetPosition([point.x, point.y], geometry);\n\t}\n\n\ttoString() {\n\t\treturn 'Link';\n\t}\n\n\tstatic getLink(terminalVisual, shapeConfig = {}, startMarker = null, endMarker = null) {\n\t\tshapeConfig = _.defaultsDeep(shapeConfig, defaultConfig);\n\t\tlet linkClass = linkTypes[shapeConfig.type];\n\t\tif (linkClass)\n\t\t\treturn new linkClass(terminalVisual, shapeConfig, startMarker, endMarker);\n\t\tconsole.log('link type not supported: ' + shapeConfig.type);\n\t\treturn null;\n\t}\n}\n\nclass DirectLink extends Link {\n\tget points() {\n\t\treturn [this.start, this.end];\n\t}\n}\n\nclass BezierLink extends Link {\n\tget points() {\n\t\treturn [this.start, this.end];\n\t}\n\n\tget controlPts() {\n\t\tlet s = this.points[0], e = this.points[1];\n\t\tlet pts = [];\n\t\tpts[0] = null;\n\t\tpts[1] = [];\n\t\tif (this.startNormal.x === 0) {\n\t\t\tpts[1][0] = new Point(s.x, (s.y + e.y)/2);\n\t\t}\n\t\telse {\n\t\t\tpts[1][0] = new Point((s.x + e.x)/2, s.y);\n\t\t}\n\t\tif (this.endNormal.x === 0) {\n\t\t\tpts[1][1] = new Point(e.x, (s.y + e.y)/2);\n\t\t}\n\t\telse {\n\t\t\tpts[1][1] = new Point((s.x + e.x)/2, e.y);\n\t\t}\n\t\treturn pts;\n\t}\n\n\tgetRelativePosition(geometry) {\n\t\tif (_.isNumber(geometry))\n\t\t\tgeometry = {x: geometry};\n\t\tgeometry = _.defaults(geometry, defaultGeometry);\n\t\tlet p = geometry.x, l = this.length;\n\t\tif (Math.abs(p) > 1) p /= l;\n\t\tif (p < 0) p++;\n\t\tif (p > 1) p--;\n\n\t\tlet pts = this.points;\n\t\tlet ctrlpts = this.controlPts;\n\t\tlet p1 = pts[0];\n\t\tlet p2 = ctrlpts[1][0];\n\t\tlet p3 = ctrlpts[1][1];\n\t\tlet p4 = pts[1];\n\n\t\tlet point = [(1-p)*(1-p)*(1-p) * p1.x + 3*p*(1-p)*(1-p) * p2.x + 3*p*p*(1-p) * p3.x + p*p*p * p4.x, (1-p)*(1-p)*(1-p) * p1.y + 3*p*(1-p)*(1-p) * p2.y + 3*p*p*(1-p) * p3.y + p*p*p * p4.y];\n\t\treturn Utils.offsetPosition([point.x, point.y], geometry);\n\t}\n}\n\nclass EntityRelations extends Link {\n\tget points() {\n\t\tlet source = Port.getBounds(edge, true);\n\t\tlet target = Port.getBounds(edge, false);\n\t\tlet isSourceLeft = target.right() < source.x;\n\t\tlet isTargetLeft = source.right() < target.x;\n\t\tlet result = [];\n\n\t\tlet x0 = (isSourceLeft) ? source.x : source.x + source.width;\n\t\tlet y0 = source.getCenterY();\n\t\tresult.push(new Point(x0, y0));\n\n\t\tlet xe = (isTargetLeft) ? target.x : target.x + target.width;\n\t\tlet ye = target.getCenterY();\n\n\t\tlet seg = this.segment;\n\n\t\tlet dx = (isSourceLeft) ? -seg : seg;\n\t\tlet dep = new Point(x0 + dx, y0);\n\n\t\tdx = (isTargetLeft) ? -seg : seg;\n\t\tlet arr = new Point(xe + dx, ye);\n\n\t\t// Adds intermediate points if both go out on same side\n\t\tif (isSourceLeft == isTargetLeft)\n\t\t{\n\t\t\tlet x = (isSourceLeft) ?\n\t\t\tMath.min(x0, xe)-seg :\n\t\t\tMath.max(x0, xe)+seg;\n\n\t\t\tresult.push(new Point(x, y0));\n\t\t\tresult.push(new Point(x, ye));\n\t\t}\n\t\telse if ((dep.x < arr.x) == isSourceLeft)\n\t\t{\n\t\t\tlet midY = y0 + (ye - y0) / 2;\n\n\t\t\tresult.push(dep);\n\t\t\tresult.push(new Point(dep.x, midY));\n\t\t\tresult.push(new Point(arr.x, midY));\n\t\t\tresult.push(arr);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tresult.push(dep);\n\t\t\tresult.push(arr);\n\t\t}\n\n\t\tresult.push(new Point(xe, ye));\n\t\treturn result;\n\t}\n}\n\nclass Manhattan extends Link {\n\tconstructor(terminalVisual, shapeConfig, startMarker, endMarker) {\n\t\tshapeConfig = _.defaults(shapeConfig, {\n\t\t\tMIN_BUFFER: 10,\n\t\t\tautoRoute: false,\n\t\t\trandomNoise: 0,\n\t\t\tstep: 1,\n\t\t\tmaxChannelWidth: 100\n\t\t});\n\t\tsuper(terminalVisual, shapeConfig, startMarker, endMarker);\n\t}\n\n\tget points() {\n\t\tlet pos = Manhattan.route(this.start, this.end, this.startNormal, this.endNormal, this.MIN_BUFFER);\n\t\tif (this.autoRoute) {\n\t\t\tthis._mergeSegments(pos);\n\t\t\tlet boxes = [], node, startBox, endBox;\n\t\t\tlet container = edge.source.getCommonAncestor(edge.target);\n\t\t\tlet childNodes = container.getDescendants();\n\t\t\tlet index = 0;\n\t\t\tfor (let i = 0; i < childNodes.length; i++) {\n\t\t\t\tnode = childNodes[i];\n\t\t\t\t// Do not include source or target ancestors in routing.\n\t\t\t\tif (node.excludeFromRouting(edge) || node.isAncestor(edge.source) || node.isAncestor(edge.target)) continue;\n\t\t\t\tif (node == edge.source)\n\t\t\t\tstartBox = index;\n\t\t\t\tif (node == edge.target)\n\t\t\t\tendBox = index;\n\t\t\t\tboxes.push(node.getBounds(document));\n\t\t\t\tindex++;\n\t\t\t}\n\t\t\tif (boxes.length > 1)\n\t\t\t\tthis.autoRoute(pos, container.getBounds(document), boxes, startBox, endBox);\n\t\t}\n\t\tManhattan._mergeSegments(pos);\n\t\tif (this.randomNoise && pos.length > 3) {\n\t\t\tfor (let i = 1; i < pos.length - 2; i++) {\n\t\t\t\tlet range = this.randomNoise / this.step;\n\t\t\t\tlet randomNumber = Math.floor(Math.random() * range * 2 - range + 1) * this.step;\n\t\t\t\tthis._moveSegment(pos, i, randomNumber, 1, 1);\n\t\t\t}\n\t\t}\n\t\treturn pos;\n\t}\n\n\t//New function for finding route\n\tstatic route(start, end, startNormal, endNormal, buffer) {\n\t\tlet startBuffer = new Point(start.x + startNormal.x * buffer, start.y + startNormal.y * buffer);\n\t\tlet endBuffer = new Point(end.x + endNormal.x * buffer, end.y + endNormal.y * buffer);\n\t\tlet startBufferNormal, endBufferNormal;\n\t\tlet pts;\n\t\tif (startNormal.x != 0) {\n\t\t\tif ((endBuffer.x - startBuffer.x) / startNormal.x > 0) {\n\t\t\t\tstartBufferNormal = startNormal;\n\t\t\t}\n\t\t\telse {\n\t\t\t\tstartBufferNormal = new Point(0, (endBuffer.y >= startBuffer.y) ? 1 : -1);\n\t\t\t}\n\t\t}\n\t\telse {\n\t\t\tif ((endBuffer.y - startBuffer.y) / startNormal.y > 0) {\n\t\t\t\tstartBufferNormal = startNormal;\n\t\t\t}\n\t\t\telse {\n\t\t\t\tstartBufferNormal = new Point((endBuffer.x >= startBuffer.x) ? 1 : -1, 0);\n\t\t\t}\n\t\t}\n\t\tif (endNormal.x != 0) {\n\t\t\tif ((startBuffer.x - endBuffer.x) / endNormal.x > 0) {\n\t\t\t\tendBufferNormal = endNormal;\n\t\t\t}\n\t\t\telse {\n\t\t\t\tendBufferNormal = new Point(0, (startBuffer.y >= endBuffer.y) ? 1 : -1);\n\t\t\t}\n\t\t}\n\t\telse {\n\t\t\tif ((startBuffer.y - endBuffer.y) / endNormal.y > 0) {\n\t\t\t\tendBufferNormal = endNormal;\n\t\t\t}\n\t\t\telse {\n\t\t\t\tendBufferNormal = new Point((startBuffer.x >= endBuffer.x) ? 1 : -1, 0);\n\t\t\t}\n\t\t}\n\n\t\tif (startBufferNormal.dotProduct(endBufferNormal) == 0) {\n\t\t\tlet middle = (startBufferNormal.x == 0) ? new Point(startBuffer.x, endBuffer.y) : new Point(endBuffer.x, startBuffer.y);\n\t\t\tpts = [start, startBuffer, middle, endBuffer, end];\n\t\t}\n\t\telse if (startBufferNormal.dotProduct(endBufferNormal) < 0) {\n\t\t\tif (startBufferNormal.x == 0) {\n\t\t\t\tpts = [start, startBuffer, new Point(startBuffer.x, (start.y + end.y) / 2), new Point(endBuffer.x, (start.y + end.y) / 2), endBuffer, end];\n\t\t\t}\n\t\t\telse {\n\t\t\t\tpts = [start, startBuffer, new Point((start.x + end.x) / 2, startBuffer.y), new Point((start.x + end.x) / 2, endBuffer.y), endBuffer, end];\n\t\t\t}\n\t\t}\n\t\telse {\n\t\t\tpts = [start, startBuffer, new Point(startBuffer.x + startBufferNormal.x * buffer, startBuffer.y + startBufferNormal.y * buffer), new Point(endBuffer.x + endBufferNormal.x * buffer, endBuffer.y + endBufferNormal.y * buffer), endBuffer, end];\n\t\t}\n\n\t\tlet prunePts = [];\n\t\tprunePts[0] = pts[0];\n\t\tfor (let i = 1; i < pts.length - 1; i++) {\n\t\t\tif ((pts[i].x == pts[i-1].x && pts[i].x == pts[i+1].x) || (pts[i].y == pts[i-1].y && pts[i].y == pts[i+1].y)) {\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tprunePts.push(pts[i]);\n\t\t}\n\t\tprunePts.push(pts[pts.length - 1]);\n\t\treturn prunePts;\n\t}\n\n\t/**\n\t * Automatically route the connection to avoid intersections with other vertices.\n\t */\n\tautoRoute(pts, container, boxes, startBox, endBox) {\n\t\tlet side, side2, d, box, intersect, j;\n\t\tlet channel, channel2, pt, dir;\n\n\t\tlet startPadding = 0, endPadding;\n\t\t// first get the start and end channel\n\t\tbox = boxes[endBox];\n\t\tpt = pts[pts.length - 2];\n\t\tif (pt.y < box.y)\n\t\t\tside = 1;\n\t\telse if (pt.y > box.y + box.height)\n\t\t\tside = 3;\n\t\telse if (pt.x < box.x)\n\t\t\tside = 0;\n\t\telse\n\t\t\tside = 2;\n\t\tchannel = _getChannel(container, endBox, boxes, side);\n\t\tendPadding = channel.horizontal ? (channel.right - channel.left)/2 : (channel.bottom - channel.top)/2;\n\n\t\tfor (let i = 0; i < pts.length - 1; i++) {\n\t\t\tif (pts[i+1].x == pts[i].x && pts[i+1].y == pts[i].y) continue;\n\t\t\tintersect = _getFirstIntersection(pts, i, boxes, startBox, endBox);\n\t\t\tif (!intersect) continue;\n\t\t\tj = intersect[0];\n\t\t\tside = intersect[1];\n\t\t\tbox = boxes[j];\n\t\t\tchannel = _getChannel(container, j, boxes, side);\n\t\t\tswitch(side) {\n\t\t\t\tcase 0:\n\t\t\t\tcase 2:\n\t\t\t\t\tpt = new Point((channel.right + channel.left)/2, pts[i].y);\n\t\t\t\t\tdir = _getRouteTendency(pts, i, pt, box, side);\n\t\t\t\t\tside2 = dir < 0 ? 1 : 3;\n\t\t\t\t\tchannel2 = _getChannel(container, j, boxes, side2);\n\t\t\t\t\t// if the previous point is in the channel2, use that point instead of center of the channel.\n\t\t\t\t\tif (i > 1 && (pts[i-2].y == pts[i-1].y) && (pts[i-1].y > channel2.top && pts[i-1].y < channel2.bottom))\n\t\t\t\t\t\td = pts[i-1].y - pt.y;\n\t\t\t\t\telse if (i < pts.length - 3 && (pts[i+2].y == pts[i+3].y) && (pts[i+2].y > channel2.top && pts[i+2].y < channel2.bottom))\n\t\t\t\t\t\td = pts[i+2].y - pt.y;\n\t\t\t\t\telse\n\t\t\t\t\t\td = (channel2.bottom + channel2.top)/2 - pt.y;\n\t\t\t\t\t// check if we need this pt.\n\t\t\t\t\tif ((side == 0 && pt.x <= pts[i].x) || (side == 2 && pt.x >= pts[i].x))\n\t\t\t\t\t\tpt = null;\n\t\t\t\t\telse if (i > 0) {\n\t\t\t\t\t\t// see if we can push the line out to where we started.\n\t\t\t\t\t\tif (!_hasIntersection(\n\t\t\t\t\t\t\t\t[new Point(pts[i].x, pts[i].y), new Point(pts[i].x, pts[i].y + d), new Point(pt.x, pt.y + d)],\n\t\t\t\t\t\t\t\tboxes))\n\t\t\t\t\t\t\tpt = null;\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tcase 1:\n\t\t\t\tcase 3:\n\t\t\t\t\tpt = new Point(pts[i].x, (channel.bottom + channel.top)/2);\n\t\t\t\t\tdir = _getRouteTendency(pts, i, pt, box, side);\n\t\t\t\t\tside2 = dir < 0 ? 0 : 2;\n\t\t\t\t\tchannel2 = _getChannel(container, j, boxes, side2);\n\t\t\t\t\t// if the previous point is in the channel2, use that point instead of center of the channel.\n\t\t\t\t\tif (i > 1 && (pts[i-2].x == pts[i-1].x) && (pts[i-1].x > channel2.left && pts[i-1].x < channel2.right))\n\t\t\t\t\t\td = pts[i-1].x - pt.x;\n\t\t\t\t\telse if (i < pts.length - 3 && (pts[i+2].x == pts[i+3].x) && (pts[i+2].x > channel2.left && pts[i+2].x < channel2.right))\n\t\t\t\t\t\td = pts[i+2].x - pt.x;\n\t\t\t\t\telse\n\t\t\t\t\t\td = (channel2.right + channel2.left)/2 - pt.x;\n\t\t\t\t\t// check if we need this pt.\n\t\t\t\t\tif ((side == 1 && pt.y <= pts[i].y) || (side == 3 && pt.y >= pts[i].y))\n\t\t\t\t\t\tpt = null;\n\t\t\t\t\telse if (i > 0) {\n\t\t\t\t\t\t// see if we can push the line out to where we started.\n\t\t\t\t\t\tif (!_hasIntersection(\n\t\t\t\t\t\t\t\t[new Point(pts[i].x, pts[i].y), new Point(pts[i].x + d, pts[i].y), new Point(pt.x + d, pt.y)],\n\t\t\t\t\t\t\t\tboxes))\n\t\t\t\t\t\t\tpt = null;\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tcase 4:\n\t\t\t\t\tcontinue;\n\t\t\t}\n\t\t\t// max points.\n\t\t\tif (i > 20) return;\n\t\t\tif (pt && (pt.x != pts[i].x || pt.y != pts[i].y)) {\n\t\t\t\tpts.splice(i+1, 0, pt);\n\t\t\t\t_moveSegment(pts, i+1, d, startPadding, endPadding);\n\t\t\t\ti++;\n\t\t\t} else\n\t\t\t\t_moveSegment(pts, i, d, startPadding, endPadding);\n\t\t}\n\t}\n\n\tstatic _hasIntersection(pts, boxes) {\n\t\tfor (let i = 0; i < pts.length - 1; i++) {\n\t\t\tfor (let j = 0; j < boxes.length; j++) {\n\t\t\t\tif (boxes[j].detectIntersection(pts[i], pts[i+1]) >= 0)\n\t\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t}\n\n\tstatic _getFirstIntersection(pts, i, boxes, startBox, endBox) {\n\t\tlet box, side, savedIndex = null, savedSide = null;\n\t\tfor (let j = 0; j < boxes.length; j++) {\n\t\t\tif ((i == 0 && j == startBox) || (i == pts.length - 2 && j == endBox))\n\t\t\t\tcontinue;\n\t\t\tbox = boxes[j];\n\t\t\tside = box.detectIntersection(pts[i], pts[i+1]);\n\t\t\tif (side >= 0) {\n\t\t\t\tif (savedIndex == null) {\n\t\t\t\t\tsavedIndex = j;\n\t\t\t\t\tsavedSide = side;\n\t\t\t\t} else {\n\t\t\t\t\tif (boxes[savedIndex].distance(pts[i]) > box.distance(pts[i])) {\n\t\t\t\t\t\tsavedIndex = j;\n\t\t\t\t\t\tsavedSide = side;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tif (savedIndex != null)\n\t\t\treturn [savedIndex, savedSide];\n\t\treturn null;\n\t}\n\n\t_getRouteTendency(pts, i, breakPt, box, side) {\n\t\tlet dir;\n\t\tlet p;\n\t\tswitch (side) {\n\t\t\tcase 0:\n\t\t\tcase 2:\n\t\t\t\tp = \"y\";\n\t\t\t\tbreak;\n\t\t\tcase 1:\n\t\t\tcase 3:\n\t\t\t\tp = \"x\";\n\t\t\t\tbreak;\n\t\t}\n\t\t//first try the breakpt.\n\t\tdir = _getRouteDirection(breakPt, pts[pts.length - 1])[p];\n\t\tif (dir == 0) {\n\t\t\tdir = -_getRouteDirection(pts[0], pts[pts.length - 1])[p];\n\t\t\tif (dir == 0) {\n\t\t\t\tif (breakPt[p] < box.getCenter()[p])\n\t\t\t\t\tdir = -1;\n\t\t\t\telse\n\t\t\t\t\tdir = 1;\n\t\t\t}\n\t\t}\n\t\treturn dir;\n\t}\n\n\tstatic _getRouteDirection(pt1, pt2) {\n\t\tif (pt1.x == pt2.x) {\n\t\t\tif (pt1.y < pt2.y) return Point.S;\n\t\t\treturn Point.N;\n\t\t} else if (pt1.y == pt2.y) {\n\t\t\tif (pt1.x < pt2.x) return Point.E;\n\t\t\treturn Point.W;\n\t\t} else if (pt1.x < pt2.x) {\n\t\t\tif (pt1.y < pt2.y) return Point.SE;\n\t\t\treturn Point.NE;\n\t\t} else {\n\t\t\tif (pt1.y < pt2.y) return Point.SW;\n\t\t\treturn Point.NW;\n\t\t}\n\t}\n\n\t_getChannel(container, index, boxes, side) {\n\t\tlet maxChannelWidth = this.maxChannelWidth;\n\t\tlet box1 = boxes[index], box2;\n\t\tlet pt, i;\n\t\tlet channel = {}, l, t, b, r;\n\t\tswitch (side) {\n\t\t\tcase 0:\n\t\t\t\tpt = box1.getLeft();\n\t\t\t\tchannel.right = pt.x;\n\t\t\t\tchannel.horizontal = false;\n\t\t\t\tfor (i = 0; i < boxes.length; i++) {\n\t\t\t\t\tif (i == index) continue;\n\t\t\t\t\tr = boxes[i].getRight().x;\n\t\t\t\t\tif (r >= pt.x) continue;\n\t\t\t\t\tif (!channel.left || channel.left < r)\n\t\t\t\t\t\tchannel.left = r;\n\t\t\t\t}\n\t\t\t\tif (!channel.left) {\n\t\t\t\t\tchannel.left = container.getLeft().x;\n\t\t\t\t\tif (channel.right - channel.left > maxChannelWidth)\n\t\t\t\t\t\tchannel.left = channel.right - maxChannelWidth;\n\t\t\t\t}\n\t\t\t\tfor (i = 0; i < boxes.length; i++) {\n\t\t\t\t\tif (i == index) continue;\n\t\t\t\t\tbox2 = boxes[i];\n\t\t\t\t\tb = box2.getBottom().y;\n\t\t\t\t\tt = box2.getTop().y;\n\t\t\t\t\tif (b < pt.y && (box2.getRight() > channel.left && box2.getLeft() < channel.right)) {\n\t\t\t\t\t\tif (!channel.top || channel.top < b)\n\t\t\t\t\t\t\tchannel.top = b;\n\t\t\t\t\t}\n\t\t\t\t\tif (t > pt.y && (box2.getRight() > channel.left && box2.getLeft() < channel.right)) {\n\t\t\t\t\t\tif (!channel.bottom || channel.bottom > t)\n\t\t\t\t\t\t\tchannel.bottom = t;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (!channel.top) channel.top = container.getTop().y;\n\t\t\t\tif (!channel.bottom) channel.bottom = container.getBottom().y;\n\t\t\t\tbreak;\n\t\t\tcase 1:\n\t\t\t\tpt = box1.getTop();\n\t\t\t\tchannel.horizontal = true;\n\t\t\t\tchannel.bottom = pt.y;\n\t\t\t\tfor (i = 0; i < boxes.length; i++) {\n\t\t\t\t\tif (i == index) continue;\n\t\t\t\t\tb = boxes[i].getBottom().y;\n\t\t\t\t\tif (b >= pt.y) continue;\n\t\t\t\t\tif (!channel.top || channel.top < b)\n\t\t\t\t\t\tchannel.top = b;\n\t\t\t\t}\n\t\t\t\tif (!channel.top) {\n\t\t\t\t\tchannel.top = container.getTop().y;\n\t\t\t\t\tif (channel.bottom - channel.top > maxChannelWidth)\n\t\t\t\t\t\tchannel.top = channel.bottom - maxChannelWidth;\n\t\t\t\t}\n\t\t\t\tfor (i = 0; i < boxes.length; i++) {\n\t\t\t\t\tif (i == index) continue;\n\t\t\t\t\tbox2 = boxes[i];\n\t\t\t\t\tl = box2.getLeft().x;\n\t\t\t\t\tr = box2.getRight().x;\n\t\t\t\t\tif (r < pt.x && (box2.getBottom() > channel.top && box2.getTop() < channel.bottom)) {\n\t\t\t\t\t\tif (!channel.left || channel.left < r)\n\t\t\t\t\t\t\tchannel.left = r;\n\t\t\t\t\t}\n\t\t\t\t\tif (l > pt.x && (box2.getBottom() > channel.top && box2.getTop() < channel.bottom)) {\n\t\t\t\t\t\tif (!channel.right || channel.right > l)\n\t\t\t\t\t\t\tchannel.right = l;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (!channel.left) channel.left = container.getLeft().x;\n\t\t\t\tif (!channel.right) channel.right = container.getRight().x;\n\n\t\t\t\tbreak;\n\t\t\tcase 2:\n\t\t\t\tpt = box1.getRight();\n\t\t\t\tchannel.horizontal = false;\n\t\t\t\tchannel.left = pt.x;\n\t\t\t\tfor (i = 0; i < boxes.length; i++) {\n\t\t\t\t\tif (i == index) continue;\n\t\t\t\t\tl = boxes[i].getLeft().x;\n\t\t\t\t\tif (l <= pt.x) continue;\n\t\t\t\t\tif (!channel.right || channel.right > l)\n\t\t\t\t\t\tchannel.right = l;\n\t\t\t\t}\n\t\t\t\tif (!channel.right) {\n\t\t\t\t\tchannel.right = container.getRight().x;\n\t\t\t\t\tif (channel.right - channel.left > maxChannelWidth)\n\t\t\t\t\t\tchannel.right = channel.left + maxChannelWidth;\n\t\t\t\t}\n\t\t\t\tfor (i = 0; i < boxes.length; i++) {\n\t\t\t\t\tif (i == index) continue;\n\t\t\t\t\tbox2 = boxes[i];\n\t\t\t\t\tb = box2.getBottom().y;\n\t\t\t\t\tt = box2.getTop().y;\n\t\t\t\t\tif (b < pt.y && (box2.getRight() > channel.left && box2.getLeft() < channel.right)) {\n\t\t\t\t\t\tif (!channel.top || channel.top < b)\n\t\t\t\t\t\t\tchannel.top = b;\n\t\t\t\t\t}\n\t\t\t\t\tif (t > pt.y && (box2.getRight() > channel.left && box2.getLeft() < channel.right)) {\n\t\t\t\t\t\tif (!channel.bottom || channel.bottom > t)\n\t\t\t\t\t\t\tchannel.bottom = t;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (!channel.top) channel.top = container.getTop().y;\n\t\t\t\tif (!channel.bottom) channel.bottom = container.getBottom().y;\n\t\t\t\tbreak;\n\t\t\tcase 3:\n\t\t\t\tpt = box1.getBottom();\n\t\t\t\tchannel.horizontal = true;\n\t\t\t\tchannel.top = pt.y;\n\t\t\t\tfor (i = 0; i < boxes.length; i++) {\n\t\t\t\t\tif (i == index) continue;\n\t\t\t\t\tbox2 = boxes[i];\n\t\t\t\t\tif (box2.getTop().y <= pt.y) continue;\n\t\t\t\t\tif (!channel.bottom || channel.bottom > box2.getTop().y)\n\t\t\t\t\t\tchannel.bottom = box2.getTop().y;\n\t\t\t\t}\n\t\t\t\tif (!channel.bottom) {\n\t\t\t\t\tchannel.bottom = container.getBottom().y;\n\t\t\t\t\tif (channel.bottom - channel.top > maxChannelWidth)\n\t\t\t\t\t\tchannel.bottom = channel.top + maxChannelWidth;\n\t\t\t\t}\n\t\t\t\tfor (i = 0; i < boxes.length; i++) {\n\t\t\t\t\tif (i == index) continue;\n\t\t\t\t\tbox2 = boxes[i];\n\t\t\t\t\tl = box2.getLeft().x;\n\t\t\t\t\tr = box2.getRight().x;\n\t\t\t\t\tif (r < pt.x && (box2.getBottom() > channel.top && box2.getTop() < channel.bottom)) {\n\t\t\t\t\t\tif (!channel.left || channel.left < r)\n\t\t\t\t\t\t\tchannel.left = r;\n\t\t\t\t\t}\n\t\t\t\t\tif (l > pt.x && (box2.getBottom() > channel.top && box2.getTop() < channel.bottom)) {\n\t\t\t\t\t\tif (!channel.right || channel.right > l)\n\t\t\t\t\t\t\tchannel.right = l;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (!channel.left) channel.left = container.getLeft().x;\n\t\t\t\tif (!channel.right) channel.right = container.getRight().x;\n\t\t\t\tbreak;\n\t\t}\n\t\treturn channel;\n\t}\n\n\t/**\n\t * Move a line segment by a specified distance.\n\t *\n\t * @param pts the list of points.\n\t * @param i the index of the segment.\n\t * @param d the distance to move.\n\t * @param startPadding\n\t * @param endPadding\n\t */\n\t_moveSegment(pts, i, d, startPadding, endPadding) {\n\t\t// first check if we need to add new line segments.\n\t\tlet dir, l, pt;\n\t\tif (i == 0) {\n\t\t\t// we need to break off the segment, since we can't change the starting point.\n\t\t\tdir = pts[0].getDirection(pts[1]);\n\t\t\tif (!startPadding)\n\t\t\t\tstartPadding = this.MIN_BUFFER;\n\t\t\tl = Math.min(startPadding, pts[0].distance(pts[1])/2);\n\t\t\tpt = pts[0].getTranslated(dir.scale(l));\n\t\t\tpts.splice(1, 0, pt);\n\t\t\tthis._moveSegment(pts, i+1, d);\n\t\t\treturn;\n\t\t}\n\t\tif (i == pts.length - 2) {\n\t\t\t// we need to break off the segment, since we can't change the end point.\n\t\t\tdir = pts[pts.length-1].getDirection(pts[pts.length-2]);\n\t\t\tif (!endPadding)\n\t\t\t\tendPadding = this.MIN_BUFFER;\n\t\t\tl = Math.min(endPadding, pts[pts.length-1].distance(pts[pts.length-2])/2);\n\t\t\tpt = pts[pts.length - 1].getTranslated(dir.scale(l));\n\t\t\tpts.splice(pts.length - 1, 0, pt);\n\t\t\tthis._moveSegment(pts, i, d);\n\t\t\treturn;\n\t\t}\n\n\t\tif (pts[i].y == pts[i+1].y) {\n\t\t\tif (i > 0 && pts[i - 1].y == pts[i].y) {\n\t\t\t\tpts.splice(i + 1, 0, pts[i].clone());\n\t\t\t\ti++;\n\t\t\t}\n\t\t\tif (i < pts.length - 2 && pts[i+1].y == pts[i+2].y)\n\t\t\t\tpts.splice(i + 1, 0, pts[i+1].clone());\n\t\t\tpts[i].y += d;\n\t\t\tpts[i+1].y += d;\n\t\t} else {\n\t\t\tif (i > 0 && pts[i - 1].x == pts[i].x) {\n\t\t\t\tpts.splice(i + 1, 0, pts[i].clone());\n\t\t\t\ti++;\n\t\t\t}\n\t\t\tif (i < pts.length - 2 && pts[i+1].x == pts[i+2].x)\n\t\t\t\tpts.splice(i + 1, 0, pts[i+1].clone());\n\t\t\tpts[i].x += d;\n\t\t\tpts[i+1].x += d;\n\t\t}\n\t}\n\n\t/**\n\t * This method will merge the redundant segments.\n\t */\n\tstatic _mergeSegments(pts) {\n\t\tlet h1 = pts[pts.length-1].y == pts[pts.length-2].y;\n\t\tlet h2;\n\t\tfor (let i = pts.length - 2; i >= 1; i--) {\n\t\t\th2 = pts[i].y == pts[i-1].y;\n\t\t\tif (h2 == h1 || (pts[i].equals(pts[i-1])))\n\t\t\t\tpts.splice(i, 1);\n\t\t\telse\n\t\t\t\th1 = !h1;\n\t\t}\n\t}\n}\n\nlinkTypes['direct'] = DirectLink;\nlinkTypes['bezier'] = BezierLink;\nlinkTypes['entityRelations'] = EntityRelations;\nlinkTypes['manhattan'] = Manhattan;\n\nexport default Link;\n\n\n\n// WEBPACK FOOTER //\n// ./src/geometry/Link.js","/*!\n  * Bean - copyright (c) Jacob Thornton 2011-2012\n  * https://github.com/fat/bean\n  * MIT license\n  */\n(function (name, context, definition) {\n  if (typeof module != 'undefined' && module.exports) module.exports = definition()\n  else if (typeof define == 'function' && define.amd) define(definition)\n  else context[name] = definition()\n})('bean', this, function (name, context) {\n  name    = name    || 'bean'\n  context = context || this\n\n  var win            = window\n    , old            = context[name]\n    , namespaceRegex = /[^\\.]*(?=\\..*)\\.|.*/\n    , nameRegex      = /\\..*/\n    , addEvent       = 'addEventListener'\n    , removeEvent    = 'removeEventListener'\n    , doc            = document || {}\n    , root           = doc.documentElement || {}\n    , W3C_MODEL      = root[addEvent]\n    , eventSupport   = W3C_MODEL ? addEvent : 'attachEvent'\n    , ONE            = {} // singleton for quick matching making add() do one()\n\n    , slice          = Array.prototype.slice\n    , str2arr        = function (s, d) { return s.split(d || ' ') }\n    , isString       = function (o) { return typeof o == 'string' }\n    , isFunction     = function (o) { return typeof o == 'function' }\n\n      // events that we consider to be 'native', anything not in this list will\n      // be treated as a custom event\n    , standardNativeEvents =\n        'click dblclick mouseup mousedown contextmenu '                  + // mouse buttons\n        'mousewheel mousemultiwheel DOMMouseScroll '                     + // mouse wheel\n        'mouseover mouseout mousemove selectstart selectend '            + // mouse movement\n        'keydown keypress keyup '                                        + // keyboard\n        'orientationchange '                                             + // mobile\n        'focus blur change reset select submit '                         + // form elements\n        'load unload beforeunload resize move DOMContentLoaded '         + // window\n        'readystatechange message '                                      + // window\n        'error abort scroll '                                              // misc\n      // element.fireEvent('onXYZ'... is not forgiving if we try to fire an event\n      // that doesn't actually exist, so make sure we only do these on newer browsers\n    , w3cNativeEvents =\n        'show '                                                          + // mouse buttons\n        'input invalid '                                                 + // form elements\n        'touchstart touchmove touchend touchcancel '                     + // touch\n        'gesturestart gesturechange gestureend '                         + // gesture\n        'textinput '                                                     + // TextEvent\n        'readystatechange pageshow pagehide popstate '                   + // window\n        'hashchange offline online '                                     + // window\n        'afterprint beforeprint '                                        + // printing\n        'dragstart dragenter dragover dragleave drag drop dragend '      + // dnd\n        'loadstart progress suspend emptied stalled loadmetadata '       + // media\n        'loadeddata canplay canplaythrough playing waiting seeking '     + // media\n        'seeked ended durationchange timeupdate play pause ratechange '  + // media\n        'volumechange cuechange '                                        + // media\n        'checking noupdate downloading cached updateready obsolete '       // appcache\n\n      // convert to a hash for quick lookups\n    , nativeEvents = (function (hash, events, i) {\n        for (i = 0; i < events.length; i++) events[i] && (hash[events[i]] = 1)\n        return hash\n      }({}, str2arr(standardNativeEvents + (W3C_MODEL ? w3cNativeEvents : ''))))\n\n      // custom events are events that we *fake*, they are not provided natively but\n      // we can use native events to generate them\n    , customEvents = (function () {\n        var isAncestor = 'compareDocumentPosition' in root\n              ? function (element, container) {\n                  return container.compareDocumentPosition && (container.compareDocumentPosition(element) & 16) === 16\n                }\n              : 'contains' in root\n                ? function (element, container) {\n                    container = container.nodeType === 9 || container === window ? root : container\n                    return container !== element && container.contains(element)\n                  }\n                : function (element, container) {\n                    while (element = element.parentNode) if (element === container) return 1\n                    return 0\n                  }\n          , check = function (event) {\n              var related = event.relatedTarget\n              return !related\n                ? related == null\n                : (related !== this && related.prefix !== 'xul' && !/document/.test(this.toString())\n                    && !isAncestor(related, this))\n            }\n\n        return {\n            mouseenter: { base: 'mouseover', condition: check }\n          , mouseleave: { base: 'mouseout', condition: check }\n          , mousewheel: { base: /Firefox/.test(navigator.userAgent) ? 'DOMMouseScroll' : 'mousewheel' }\n        }\n      }())\n\n      // we provide a consistent Event object across browsers by taking the actual DOM\n      // event object and generating a new one from its properties.\n    , Event = (function () {\n            // a whitelist of properties (for different event types) tells us what to check for and copy\n        var commonProps  = str2arr('altKey attrChange attrName bubbles cancelable ctrlKey currentTarget ' +\n              'detail eventPhase getModifierState isTrusted metaKey relatedNode relatedTarget shiftKey '  +\n              'srcElement target timeStamp type view which propertyName')\n          , mouseProps   = commonProps.concat(str2arr('button buttons clientX clientY dataTransfer '      +\n              'fromElement offsetX offsetY pageX pageY screenX screenY toElement'))\n          , mouseWheelProps = mouseProps.concat(str2arr('wheelDelta wheelDeltaX wheelDeltaY wheelDeltaZ ' +\n              'axis')) // 'axis' is FF specific\n          , keyProps     = commonProps.concat(str2arr('char charCode key keyCode keyIdentifier '          +\n              'keyLocation location'))\n          , textProps    = commonProps.concat(str2arr('data'))\n          , touchProps   = commonProps.concat(str2arr('touches targetTouches changedTouches scale rotation'))\n          , messageProps = commonProps.concat(str2arr('data origin source'))\n          , stateProps   = commonProps.concat(str2arr('state'))\n          , overOutRegex = /over|out/\n            // some event types need special handling and some need special properties, do that all here\n          , typeFixers   = [\n                { // key events\n                    reg: /key/i\n                  , fix: function (event, newEvent) {\n                      newEvent.keyCode = event.keyCode || event.which\n                      return keyProps\n                    }\n                }\n              , { // mouse events\n                    reg: /click|mouse(?!(.*wheel|scroll))|menu|drag|drop/i\n                  , fix: function (event, newEvent, type) {\n                      newEvent.rightClick = event.which === 3 || event.button === 2\n                      newEvent.pos = { x: 0, y: 0 }\n                      if (event.pageX || event.pageY) {\n                        newEvent.clientX = event.pageX\n                        newEvent.clientY = event.pageY\n                      } else if (event.clientX || event.clientY) {\n                        newEvent.clientX = event.clientX + doc.body.scrollLeft + root.scrollLeft\n                        newEvent.clientY = event.clientY + doc.body.scrollTop + root.scrollTop\n                      }\n                      if (overOutRegex.test(type)) {\n                        newEvent.relatedTarget = event.relatedTarget\n                          || event[(type == 'mouseover' ? 'from' : 'to') + 'Element']\n                      }\n                      return mouseProps\n                    }\n                }\n              , { // mouse wheel events\n                    reg: /mouse.*(wheel|scroll)/i\n                  , fix: function () { return mouseWheelProps }\n                }\n              , { // TextEvent\n                    reg: /^text/i\n                  , fix: function () { return textProps }\n                }\n              , { // touch and gesture events\n                    reg: /^touch|^gesture/i\n                  , fix: function () { return touchProps }\n                }\n              , { // message events\n                    reg: /^message$/i\n                  , fix: function () { return messageProps }\n                }\n              , { // popstate events\n                    reg: /^popstate$/i\n                  , fix: function () { return stateProps }\n                }\n              , { // everything else\n                    reg: /.*/\n                  , fix: function () { return commonProps }\n                }\n            ]\n          , typeFixerMap = {} // used to map event types to fixer functions (above), a basic cache mechanism\n\n          , Event = function (event, element, isNative) {\n              if (!arguments.length) return\n              event = event || ((element.ownerDocument || element.document || element).parentWindow || win).event\n              this.originalEvent = event\n              this.isNative       = isNative\n              this.isBean         = true\n\n              if (!event) return\n\n              var type   = event.type\n                , target = event.target || event.srcElement\n                , i, l, p, props, fixer\n\n              this.target = target && target.nodeType === 3 ? target.parentNode : target\n\n              if (isNative) { // we only need basic augmentation on custom events, the rest expensive & pointless\n                fixer = typeFixerMap[type]\n                if (!fixer) { // haven't encountered this event type before, map a fixer function for it\n                  for (i = 0, l = typeFixers.length; i < l; i++) {\n                    if (typeFixers[i].reg.test(type)) { // guaranteed to match at least one, last is .*\n                      typeFixerMap[type] = fixer = typeFixers[i].fix\n                      break\n                    }\n                  }\n                }\n\n                props = fixer(event, this, type)\n                for (i = props.length; i--;) {\n                  if (!((p = props[i]) in this) && p in event) this[p] = event[p]\n                }\n              }\n            }\n\n        // preventDefault() and stopPropagation() are a consistent interface to those functions\n        // on the DOM, stop() is an alias for both of them together\n        Event.prototype.preventDefault = function () {\n          if (this.originalEvent.preventDefault) this.originalEvent.preventDefault()\n          else this.originalEvent.returnValue = false\n        }\n        Event.prototype.stopPropagation = function () {\n          if (this.originalEvent.stopPropagation) this.originalEvent.stopPropagation()\n          else this.originalEvent.cancelBubble = true\n        }\n        Event.prototype.stop = function () {\n          this.preventDefault()\n          this.stopPropagation()\n          this.stopped = true\n        }\n        // stopImmediatePropagation() has to be handled internally because we manage the event list for\n        // each element\n        // note that originalElement may be a Bean#Event object in some situations\n        Event.prototype.stopImmediatePropagation = function () {\n          if (this.originalEvent.stopImmediatePropagation) this.originalEvent.stopImmediatePropagation()\n          this.isImmediatePropagationStopped = function () { return true }\n        }\n        Event.prototype.isImmediatePropagationStopped = function () {\n          return this.originalEvent.isImmediatePropagationStopped && this.originalEvent.isImmediatePropagationStopped()\n        }\n        Event.prototype.clone = function (currentTarget) {\n          //TODO: this is ripe for optimisation, new events are *expensive*\n          // improving this will speed up delegated events\n          var ne = new Event(this, this.element, this.isNative)\n          ne.currentTarget = currentTarget\n          return ne\n        }\n\n        return Event\n      }())\n\n      // if we're in old IE we can't do onpropertychange on doc or win so we use doc.documentElement for both\n    , targetElement = function (element, isNative) {\n        return !W3C_MODEL && !isNative && (element === doc || element === win) ? root : element\n      }\n\n      /**\n        * Bean maintains an internal registry for event listeners. We don't touch elements, objects\n        * or functions to identify them, instead we store everything in the registry.\n        * Each event listener has a RegEntry object, we have one 'registry' for the whole instance.\n        */\n    , RegEntry = (function () {\n        // each handler is wrapped so we can handle delegation and custom events\n        var wrappedHandler = function (element, fn, condition, args) {\n            var call = function (event, eargs) {\n                  return fn.apply(element, args ? slice.call(eargs, event ? 0 : 1).concat(args) : eargs)\n                }\n              , findTarget = function (event, eventElement) {\n                  return fn.__beanDel ? fn.__beanDel.ft(event.target, element) : eventElement\n                }\n              , handler = condition\n                  ? function (event) {\n                      var target = findTarget(event, this) // deleated event\n                      if (condition.apply(target, arguments)) {\n                        if (event) event.currentTarget = target\n                        return call(event, arguments)\n                      }\n                    }\n                  : function (event) {\n                      if (fn.__beanDel) event = event.clone(findTarget(event)) // delegated event, fix the fix\n                      return call(event, arguments)\n                    }\n            handler.__beanDel = fn.__beanDel\n            return handler\n          }\n\n        , RegEntry = function (element, type, handler, original, namespaces, args, root) {\n            var customType     = customEvents[type]\n              , isNative\n\n            if (type == 'unload') {\n              // self clean-up\n              handler = once(removeListener, element, type, handler, original)\n            }\n\n            if (customType) {\n              if (customType.condition) {\n                handler = wrappedHandler(element, handler, customType.condition, args)\n              }\n              type = customType.base || type\n            }\n\n            this.isNative      = isNative = nativeEvents[type] && !!element[eventSupport]\n            this.customType    = !W3C_MODEL && !isNative && type\n            this.element       = element\n            this.type          = type\n            this.original      = original\n            this.namespaces    = namespaces\n            this.eventType     = W3C_MODEL || isNative ? type : 'propertychange'\n            this.target        = targetElement(element, isNative)\n            this[eventSupport] = !!this.target[eventSupport]\n            this.root          = root\n            this.handler       = wrappedHandler(element, handler, null, args)\n          }\n\n        // given a list of namespaces, is our entry in any of them?\n        RegEntry.prototype.inNamespaces = function (checkNamespaces) {\n          var i, j, c = 0\n          if (!checkNamespaces) return true\n          if (!this.namespaces) return false\n          for (i = checkNamespaces.length; i--;) {\n            for (j = this.namespaces.length; j--;) {\n              if (checkNamespaces[i] == this.namespaces[j]) c++\n            }\n          }\n          return checkNamespaces.length === c\n        }\n\n        // match by element, original fn (opt), handler fn (opt)\n        RegEntry.prototype.matches = function (checkElement, checkOriginal, checkHandler) {\n          return this.element === checkElement &&\n            (!checkOriginal || this.original === checkOriginal) &&\n            (!checkHandler || this.handler === checkHandler)\n        }\n\n        return RegEntry\n      }())\n\n    , registry = (function () {\n        // our map stores arrays by event type, just because it's better than storing\n        // everything in a single array.\n        // uses '$' as a prefix for the keys for safety and 'r' as a special prefix for\n        // rootListeners so we can look them up fast\n        var map = {}\n\n          // generic functional search of our registry for matching listeners,\n          // `fn` returns false to break out of the loop\n          , forAll = function (element, type, original, handler, root, fn) {\n              var pfx = root ? 'r' : '$'\n              if (!type || type == '*') {\n                // search the whole registry\n                for (var t in map) {\n                  if (t.charAt(0) == pfx) {\n                    forAll(element, t.substr(1), original, handler, root, fn)\n                  }\n                }\n              } else {\n                var i = 0, l, list = map[pfx + type], all = element == '*'\n                if (!list) return\n                for (l = list.length; i < l; i++) {\n                  if ((all || list[i].matches(element, original, handler)) && !fn(list[i], list, i, type)) return\n                }\n              }\n            }\n\n          , has = function (element, type, original, root) {\n              // we're not using forAll here simply because it's a bit slower and this\n              // needs to be fast\n              var i, list = map[(root ? 'r' : '$') + type]\n              if (list) {\n                for (i = list.length; i--;) {\n                  if (!list[i].root && list[i].matches(element, original, null)) return true\n                }\n              }\n              return false\n            }\n\n          , get = function (element, type, original, root) {\n              var entries = []\n              forAll(element, type, original, null, root, function (entry) {\n                return entries.push(entry)\n              })\n              return entries\n            }\n\n          , put = function (entry) {\n              var has = !entry.root && !this.has(entry.element, entry.type, null, false)\n                , key = (entry.root ? 'r' : '$') + entry.type\n              ;(map[key] || (map[key] = [])).push(entry)\n              return has\n            }\n\n          , del = function (entry) {\n              forAll(entry.element, entry.type, null, entry.handler, entry.root, function (entry, list, i) {\n                list.splice(i, 1)\n                entry.removed = true\n                if (list.length === 0) delete map[(entry.root ? 'r' : '$') + entry.type]\n                return false\n              })\n            }\n\n            // dump all entries, used for onunload\n          , entries = function () {\n              var t, entries = []\n              for (t in map) {\n                if (t.charAt(0) == '$') entries = entries.concat(map[t])\n              }\n              return entries\n            }\n\n        return { has: has, get: get, put: put, del: del, entries: entries }\n      }())\n\n      // we need a selector engine for delegated events, use querySelectorAll if it exists\n      // but for older browsers we need Qwery, Sizzle or similar\n    , selectorEngine\n    , setSelectorEngine = function (e) {\n        if (!arguments.length) {\n          selectorEngine = doc.querySelectorAll\n            ? function (s, r) {\n                return r.querySelectorAll(s)\n              }\n            : function () {\n                throw new Error('Bean: No selector engine installed') // eeek\n              }\n        } else {\n          selectorEngine = e\n        }\n      }\n\n      // we attach this listener to each DOM event that we need to listen to, only once\n      // per event type per DOM element\n    , rootListener = function (event, type) {\n        if (!W3C_MODEL && type && event && event.propertyName != '_on' + type) return\n\n        var listeners = registry.get(this, type || event.type, null, false)\n          , l = listeners.length\n          , i = 0\n\n        event = new Event(event, this, true)\n        if (type) event.type = type\n\n        // iterate through all handlers registered for this type, calling them unless they have\n        // been removed by a previous handler or stopImmediatePropagation() has been called\n        for (; i < l && !event.isImmediatePropagationStopped(); i++) {\n          if (!listeners[i].removed) listeners[i].handler.call(this, event)\n        }\n      }\n\n      // add and remove listeners to DOM elements\n    , listener = W3C_MODEL\n        ? function (element, type, add) {\n            // new browsers\n            element[add ? addEvent : removeEvent](type, rootListener, false)\n          }\n        : function (element, type, add, custom) {\n            // IE8 and below, use attachEvent/detachEvent and we have to piggy-back propertychange events\n            // to simulate event bubbling etc.\n            var entry\n            if (add) {\n              registry.put(entry = new RegEntry(\n                  element\n                , custom || type\n                , function (event) { // handler\n                    rootListener.call(element, event, custom)\n                  }\n                , rootListener\n                , null\n                , null\n                , true // is root\n              ))\n              if (custom && element['_on' + custom] == null) element['_on' + custom] = 0\n              entry.target.attachEvent('on' + entry.eventType, entry.handler)\n            } else {\n              entry = registry.get(element, custom || type, rootListener, true)[0]\n              if (entry) {\n                entry.target.detachEvent('on' + entry.eventType, entry.handler)\n                registry.del(entry)\n              }\n            }\n          }\n\n    , once = function (rm, element, type, fn, originalFn) {\n        // wrap the handler in a handler that does a remove as well\n        return function () {\n          fn.apply(this, arguments)\n          rm(element, type, originalFn)\n        }\n      }\n\n    , removeListener = function (element, orgType, handler, namespaces) {\n        var type     = orgType && orgType.replace(nameRegex, '')\n          , handlers = registry.get(element, type, null, false)\n          , removed  = {}\n          , i, l\n\n        for (i = 0, l = handlers.length; i < l; i++) {\n          if ((!handler || handlers[i].original === handler) && handlers[i].inNamespaces(namespaces)) {\n            // TODO: this is problematic, we have a registry.get() and registry.del() that\n            // both do registry searches so we waste cycles doing this. Needs to be rolled into\n            // a single registry.forAll(fn) that removes while finding, but the catch is that\n            // we'll be splicing the arrays that we're iterating over. Needs extra tests to\n            // make sure we don't screw it up. @rvagg\n            registry.del(handlers[i])\n            if (!removed[handlers[i].eventType] && handlers[i][eventSupport])\n              removed[handlers[i].eventType] = { t: handlers[i].eventType, c: handlers[i].type }\n          }\n        }\n        // check each type/element for removed listeners and remove the rootListener where it's no longer needed\n        for (i in removed) {\n          if (!registry.has(element, removed[i].t, null, false)) {\n            // last listener of this type, remove the rootListener\n            listener(element, removed[i].t, false, removed[i].c)\n          }\n        }\n      }\n\n      // set up a delegate helper using the given selector, wrap the handler function\n    , delegate = function (selector, fn) {\n        //TODO: findTarget (therefore $) is called twice, once for match and once for\n        // setting e.currentTarget, fix this so it's only needed once\n        var findTarget = function (target, root) {\n              var i, array = isString(selector) ? selectorEngine(selector, root) : selector\n              for (; target && target !== root; target = target.parentNode) {\n                for (i = array.length; i--;) {\n                  if (array[i] === target) return target\n                }\n              }\n            }\n          , handler = function (e) {\n              var match = findTarget(e.target, this)\n              if (match) fn.apply(match, arguments)\n            }\n\n        // __beanDel isn't pleasant but it's a private function, not exposed outside of Bean\n        handler.__beanDel = {\n            ft       : findTarget // attach it here for customEvents to use too\n          , selector : selector\n        }\n        return handler\n      }\n\n    , fireListener = W3C_MODEL ? function (isNative, type, element) {\n        // modern browsers, do a proper dispatchEvent()\n        var evt = doc.createEvent(isNative ? 'HTMLEvents' : 'UIEvents')\n        evt[isNative ? 'initEvent' : 'initUIEvent'](type, true, true, win, 1)\n        element.dispatchEvent(evt)\n      } : function (isNative, type, element) {\n        // old browser use onpropertychange, just increment a custom property to trigger the event\n        element = targetElement(element, isNative)\n        isNative ? element.fireEvent('on' + type, doc.createEventObject()) : element['_on' + type]++\n      }\n\n      /**\n        * Public API: off(), on(), add(), (remove()), one(), fire(), clone()\n        */\n\n      /**\n        * off(element[, eventType(s)[, handler ]])\n        */\n    , off = function (element, typeSpec, fn) {\n        var isTypeStr = isString(typeSpec)\n          , k, type, namespaces, i\n\n        if (isTypeStr && typeSpec.indexOf(' ') > 0) {\n          // off(el, 't1 t2 t3', fn) or off(el, 't1 t2 t3')\n          typeSpec = str2arr(typeSpec)\n          for (i = typeSpec.length; i--;)\n            off(element, typeSpec[i], fn)\n          return element\n        }\n\n        type = isTypeStr && typeSpec.replace(nameRegex, '')\n        if (type && customEvents[type]) type = customEvents[type].base\n\n        if (!typeSpec || isTypeStr) {\n          // off(el) or off(el, t1.ns) or off(el, .ns) or off(el, .ns1.ns2.ns3)\n          if (namespaces = isTypeStr && typeSpec.replace(namespaceRegex, '')) namespaces = str2arr(namespaces, '.')\n          removeListener(element, type, fn, namespaces)\n        } else if (isFunction(typeSpec)) {\n          // off(el, fn)\n          removeListener(element, null, typeSpec)\n        } else {\n          // off(el, { t1: fn1, t2, fn2 })\n          for (k in typeSpec) {\n            if (typeSpec.hasOwnProperty(k)) off(element, k, typeSpec[k])\n          }\n        }\n\n        return element\n      }\n\n      /**\n        * on(element, eventType(s)[, selector], handler[, args ])\n        */\n    , on = function(element, events, selector, fn) {\n        var originalFn, type, types, i, args, entry, first\n\n        //TODO: the undefined check means you can't pass an 'args' argument, fix this perhaps?\n        if (selector === undefined && typeof events == 'object') {\n          //TODO: this can't handle delegated events\n          for (type in events) {\n            if (events.hasOwnProperty(type)) {\n              on.call(this, element, type, events[type])\n            }\n          }\n          return\n        }\n\n        if (!isFunction(selector)) {\n          // delegated event\n          originalFn = fn\n          args       = slice.call(arguments, 4)\n          fn         = delegate(selector, originalFn, selectorEngine)\n        } else {\n          args       = slice.call(arguments, 3)\n          fn         = originalFn = selector\n        }\n\n        types = str2arr(events)\n\n        // special case for one(), wrap in a self-removing handler\n        if (this === ONE) {\n          fn = once(off, element, events, fn, originalFn)\n        }\n\n        for (i = types.length; i--;) {\n          // add new handler to the registry and check if it's the first for this element/type\n          first = registry.put(entry = new RegEntry(\n              element\n            , types[i].replace(nameRegex, '') // event type\n            , fn\n            , originalFn\n            , str2arr(types[i].replace(namespaceRegex, ''), '.') // namespaces\n            , args\n            , false // not root\n          ))\n          if (entry[eventSupport] && first) {\n            // first event of this type on this element, add root listener\n            listener(element, entry.eventType, true, entry.customType)\n          }\n        }\n\n        return element\n      }\n\n      /**\n        * add(element[, selector], eventType(s), handler[, args ])\n        *\n        * Deprecated: kept (for now) for backward-compatibility\n        */\n    , add = function (element, events, fn, delfn) {\n        return on.apply(\n            null\n          , !isString(fn)\n              ? slice.call(arguments)\n              : [ element, fn, events, delfn ].concat(arguments.length > 3 ? slice.call(arguments, 5) : [])\n        )\n      }\n\n      /**\n        * one(element, eventType(s)[, selector], handler[, args ])\n        */\n    , one = function () {\n        return on.apply(ONE, arguments)\n      }\n\n      /**\n        * fire(element, eventType(s)[, args ])\n        *\n        * The optional 'args' argument must be an array, if no 'args' argument is provided\n        * then we can use the browser's DOM event system, otherwise we trigger handlers manually\n        */\n    , fire = function (element, type, args) {\n        var types = str2arr(type)\n          , i, j, l, names, handlers\n\n        for (i = types.length; i--;) {\n          type = types[i].replace(nameRegex, '')\n          if (names = types[i].replace(namespaceRegex, '')) names = str2arr(names, '.')\n          if (!names && !args && element[eventSupport]) {\n            fireListener(nativeEvents[type], type, element)\n          } else {\n            // non-native event, either because of a namespace, arguments or a non DOM element\n            // iterate over all listeners and manually 'fire'\n            handlers = registry.get(element, type, null, false)\n            args = [false].concat(args)\n            for (j = 0, l = handlers.length; j < l; j++) {\n              if (handlers[j].inNamespaces(names)) {\n                handlers[j].handler.apply(element, args)\n              }\n            }\n          }\n        }\n        return element\n      }\n\n      /**\n        * clone(dstElement, srcElement[, eventType ])\n        *\n        * TODO: perhaps for consistency we should allow the same flexibility in type specifiers?\n        */\n    , clone = function (element, from, type) {\n        var handlers = registry.get(from, type, null, false)\n          , l = handlers.length\n          , i = 0\n          , args, beanDel\n\n        for (; i < l; i++) {\n          if (handlers[i].original) {\n            args = [ element, handlers[i].type ]\n            if (beanDel = handlers[i].handler.__beanDel) args.push(beanDel.selector)\n            args.push(handlers[i].original)\n            on.apply(null, args)\n          }\n        }\n        return element\n      }\n\n    , bean = {\n          'on'                : on\n        , 'add'               : add\n        , 'one'               : one\n        , 'off'               : off\n        , 'remove'            : off\n        , 'clone'             : clone\n        , 'fire'              : fire\n        , 'Event'             : Event\n        , 'setSelectorEngine' : setSelectorEngine\n        , 'noConflict'        : function () {\n            context[name] = old\n            return this\n          }\n      }\n\n  // for IE, clean up on unload to avoid leaks\n  if (win.attachEvent) {\n    var cleanup = function () {\n      var i, entries = registry.entries()\n      for (i in entries) {\n        if (entries[i].type && entries[i].type !== 'unload') off(entries[i].element, entries[i].type)\n      }\n      win.detachEvent('onunload', cleanup)\n      win.CollectGarbage && win.CollectGarbage()\n    }\n    win.attachEvent('onunload', cleanup)\n  }\n\n  // initialize selector engine to internal default (qSA or throw Error)\n  setSelectorEngine()\n\n  return bean\n});\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/bean/bean.js\n// module id = 13\n// module chunks = 0","import _ from \"lodash\";\nimport Events from \"bean\";\nimport * as KeyUtils from \"./KeyUtils\";\nimport DomUtils from \"../util/DomUtils\";\nimport StringBuffer from \"./../util/StringBuffer\";\n\nconst DEFAULTS = {\n\tstopPropagation: false\n};\n\n/**\n * The EventDispatcher is the central event management. It will monitor all events and translate it into the a higher\n * level events for consumption.\n */\nexport default class EventDispatcher {\n\t/**\n\t * Constructor\n\t * @param root the root element that the manager will listen to.\n\t * @param zoomScale\n\t * @param config the configuraton for the event dispatcher.\n\t */\n\tconstructor(root, zoomScale = [0, Infinity], config = {}) {\n\t\tthis.root = root;\n\t\tthis.rootNS = root.getAttribute('ns') || 'root';\n\t\tthis.zoomScale = zoomScale;\n\t\t_.assign(this, DEFAULTS, config);\n\t\tthis.scale = 1.0;\n\t\tthis.listeners = {};\n\t\tthis.dragging = false;\n\t\tthis.handler = _.bind(this.handleEvent, this);\n\t\tthis.started = false;\n\n\t\t// Simulate mouseenter/mouseleave events\n\t\tthis.enterStack = [];\n\t}\n\n\t/**\n\t * Start listening for events.\n\t */\n\tstart() {\n\t\tif (this.started) return;\n\t\tEvents.on(this.root, 'mousedown mouseover mouseout mouseenter mouseleave dblclick click contextmenu mousewheel', this.handler);\n\t\tthis.startKeys();\n\t\tthis.started = true;\n\t}\n\n\t/**\n\t * Stop listening for events.\n\t */\n\tstop() {\n\t\tif (!this.started) return;\n\t\tEvents.off(this.root, 'mousedown mouseover mouseout mouseenter mouseleave dblclick click contextmenu mousewheel', this.handler);\n\t\tthis.stopKeys();\n\t\tthis.started = false;\n\t}\n\n\tstartKeys() {\n\t\tEvents.on(document, 'keydown keyup', this.handler);\n\t}\n\n\tstopKeys() {\n\t\tEvents.off(document, 'keydown keyup', this.handler);\n\t}\n\n\tzoomIn() {\n\t\tthis.scale *= 1.25;\n\t\tthis.scale = Math.max(Math.min(this.zoomScale[1], this.scale), this.zoomScale[0]);\n\t\treturn this.scale;\n\t}\n\n\tzoomOut() {\n\t\tthis.scale *= 0.8;\n\t\tthis.scale = Math.max(Math.min(this.zoomScale[1], this.scale), this.zoomScale[0]);\n\t\treturn this.scale;\n\t}\n\n\tgetEventInfo(event) {\n\t\tlet target = event.target;\n\t\tlet buf = new StringBuffer(), ns, stack = [], isRoot = false;\n\t\twhile (!isRoot && target && target != document) {\n\t\t\tns = target.getAttribute('ns');\n\t\t\tif (ns) {\n\t\t\t\tisRoot = _.startsWith(ns, \"root.\");\n\t\t\t\tif (isRoot) {\n\t\t\t\t\tns = ns.substring(5);\n\t\t\t\t\tevent.rootTarget = target;\n\t\t\t\t}\n\t\t\t\tif (!event.nsTarget) event.nsTarget = target;\n\t\t\t\tstack.splice(0, 0, target);\n\t\t\t\tbuf.prepend(ns);\n\t\t\t}\n\t\t\ttarget = target.parentNode;\n\t\t}\n\t\tif (!isRoot)\n\t\t\tevent.rootTarget = event.nsTarget;\n\n\t\t// target stack is a stack of all the ns targets up to the one with the data binding.\n\t\tevent.targetStack = stack;\n\t\tns = buf.toString('.');\n\t\tif (ns == '') ns = this.rootNS;\n\t\treturn {data: event.rootTarget, ns: ns};\n\t}\n\n\t/**\n\t * The main event handler method, it processes event and generate relevant events to dispatch.\n\t */\n\thandleEvent(event) {\n\t\tlet type = event.type;\n\n\t\t// Do not dispatch other events if we are dragging.\n\t\tif (this.dragging || DomUtils.eventFromInput(event)) return;\n\n\t\tlet data, ns, pos = this.getPosition(event), info, isKeyEvent = (type == 'keydown' || type =='keyup');\n\t\tif (isKeyEvent) {\n\t\t\tdata = this.root;\n\t\t\tns = KeyUtils.getKeyEvent(event);\n\t\t} else {\n\t\t\tinfo = this.getEventInfo(event);\n\t\t\tif (!info) return;\n\t\t\tdata = info.data;\n\t\t\tns = info.ns;\n\t\t}\n\n\t\t//Utils.log('EventDispatcher', \"handleEvent - \" + type + ';ns=' + ns);\n\n\t\tif (type == 'mousewheel') {\n\t\t\tthis.scale *= Math.pow(2, event.wheelDelta * 0.002);\n\t\t\tthis.scale = Math.max(Math.min(this.zoomScale[1], this.scale), this.zoomScale[0]);\n\t\t\tevent.scale = this.scale;\n\t\t\ttype = 'zoom';\n\t\t}\n\n\t\t// See if we should create drag events\n\t\tif (type == 'mousedown' && event.button == 0 /*only drag on left click*/) {\n\t\t\t// Create drag object.\n\t\t\tconst dragObject = {data: data, pos: ns == 'root' ? EventDispatcher.mouse(this.root, event) : pos};\n\t\t\tthis.dragging = false;\n\t\t\t// Start listening for mouse move.\n\t\t\tlet dragPos;\n\n\t\t\tconst mousemove = (event) => {\n\t\t\t\tlet currentPos = this.getPosition(event);\n\t\t\t\tif (!this.dragging) {\n\t\t\t\t\t// check if the mouse has moved. IE always fire mousemove after mousedown even if the mouse hasn't moved yet.\n\t\t\t\t\tif (dragObject.pos[0] == currentPos[0] && dragObject.pos[1] == currentPos[1]) return;\n\n\t\t\t\t\t// start dragging\n\t\t\t\t\tthis.dragging = true;\n\t\t\t\t\tevent.rootTarget = dragObject.data;\n\t\t\t\t\tthis.dispatch(event, 'dragstart', ns, dragObject.data, dragObject.pos);\n\t\t\t\t}\n\t\t\t\tif (ns == \"root\")\n\t\t\t\t\tdragPos = EventDispatcher.mouse(this.root, event);\n\t\t\t\telse\n\t\t\t\t\tdragPos = currentPos;\n\t\t\t\tthis.getEventInfo(event);\n\t\t\t\tthis.dispatch(event, 'drag', ns, dragObject.data, dragPos);\n\t\t\t};\n\t\t\tconst mouseup = (event) => {\n\t\t\t\tif (ns == \"root\")\n\t\t\t\t\tdragPos = EventDispatcher.mouse(this.root, event);\n\t\t\t\telse\n\t\t\t\t\tdragPos = this.getPosition(event);\n\n\t\t\t\tlet info = this.getEventInfo(event);\n\t\t\t\tif (this.dragging) {\n\t\t\t\t\tthis.dragging = false;\n\t\t\t\t\tthis.dispatch(event, 'dragend', ns, dragObject.data, dragPos);\n\t\t\t\t} else {\n\t\t\t\t\tthis.dispatch(event, 'mouseup', ns, info.data, dragPos);\n\t\t\t\t}\n\n\t\t\t\tEvents.off(window, 'mousemove', mousemove);\n\t\t\t\tEvents.off(window, 'mouseup', mouseup);\n\t\t\t};\n\t\t\tevent.preventDefault();\n\t\t\tEvents.on(window, 'mousemove', mousemove);\n\t\t\tEvents.on(window, 'mouseup', mouseup);\n\t\t}\n\n\t\tif (!isKeyEvent)\n\t\t\tthis.simulateEnterLeave(event, type, ns, data, pos);\n\t\tthis.dispatch(event, type, ns, data, pos);\n\n\t\t// disable the default context menu\n\t\t//if (type == 'contextmenu')\n\t\t//\tevent.preventDefault();\n\t}\n\n\t/**\n\t * try to simulate mouseenter/mouseleave events.\n\t */\n\tsimulateEnterLeave(event, type, ns, data, pos) {\n\t\tlet last, stack;\n\t\tconst clearEnterStack = (k) => {\n\t\t\tk = k || 0;\n\t\t\t// Clear off the enter stack.\n\t\t\twhile (this.enterStack.length >= k + 1) {\n\t\t\t\tlast = this.enterStack.pop();\n\t\t\t\tthis.dispatch(event, 'mouseleave', last.ns, last.data, pos);\n\t\t\t}\n\t\t};\n\t\tconst getNS = function(index) {\n\t\t\tlet buf = new StringBuffer();\n\t\t\tfor (let i = 0; i <= index; i++) {\n\t\t\t\tlet val = stack[i].getAttribute(\"ns\");\n\t\t\t\tif (_.startsWith(val, \"root.\"))\n\t\t\t\t\tval = val.substring(5);\n\t\t\t\tbuf.append(val);\n\t\t\t}\n\t\t\treturn buf.toString('.');\n\t\t};\n\n\t\tif (ns && ns != this.rootNS) {\n\t\t\tif (type == 'mouseover') {\n\t\t\t\tstack = event.targetStack;\n\t\t\t\tlet item;\n\t\t\t\tfor (let i = 0; i < stack.length; i++) {\n\t\t\t\t\tif (i < this.enterStack.length) {\n\t\t\t\t\t\tif (this.enterStack[i].target != stack[i]) {\n\t\t\t\t\t\t\tclearEnterStack(i);\n\t\t\t\t\t\t} else\n\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\t\t\t\t\titem = {data: data, ns: getNS(i), target: stack[i]};\n\t\t\t\t\tthis.enterStack.push(item);\n\t\t\t\t\tthis.dispatch(event, 'mouseenter', item.ns, data, pos);\n\t\t\t\t}\n\t\t\t\tif (stack.length < this.enterStack.length)\n\t\t\t\t\tclearEnterStack(stack.length);\n\t\t\t}\n\t\t}\n\t\tif (ns == this.rootNS && this.enterStack.length > 0)\n\t\t\tclearEnterStack();\n\t}\n\n\tdispatch(event, type, ns, data, pos) {\n\t\t//if (type != 'mouseover' && type != 'mouseout')\n\t\t//\tUtils.log('EventDispatcher', \"dispatch - \" + type + '.' + ns + ';' + pos + ';rootTarget=' + event.rootTarget + ';data=' + data);\n\t\tif (!this.started) return;\n\t\tconst nsType = ns ? type + '.' + ns : type;\n\t\t_.forEach(this.listeners, (listeners, key) => {\n\t\t\tif (EventDispatcher.match(nsType, listeners.regexp ? listeners.regexp : key)) {\n\t\t\t\t_.forEach(listeners, (listener) => {\n\t\t\t\t\tif (!listener.context)\n\t\t\t\t\t\tlistener.callback.apply(window, [type, ns, data, pos, event]);\n\t\t\t\t\telse\n\t\t\t\t\t\tlistener.callback.apply(listener.context, [type, ns, data, pos, event]);\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\n\t\t// after dispatching, do not propagate.\n\t\tif (this.stopPropagation && event.stopPropagation)\n\t\t\tevent.stopPropagation();\n\t}\n\n\tgetPosition(event) {\n\t\tconst pos = EventDispatcher.mouse(this.root, event);\n\t\tif(! _.isNaN(pos[0]) && ! _.isNaN(pos[1]))\n\t\t\tthis.lastPosition = pos;\n\t\treturn this.lastPosition;\n\t}\n\n\t/**\n\t * Registers a key event handler\n\t * // Key is object {ctrl, alt, shift, meta, code}\n\t */\n\tregisterKey(type, key, callback, context) {\n\t\tif (_.isArray(key)) {\n\t\t\t_.forEach(key, (k) => {\n\t\t\t\tthis.registerKey(type, k, callback, context);\n\t\t\t});\n\t\t\treturn;\n\t\t}\n\t\tkey = KeyUtils.getKeyData(key.ctrl, key.alt, key.shift, key.meta, key.code);\n\t\tif(!key.length) return;\n\t\tkey = new StringBuffer(type).append(key).toString('.');\n\n\t\tconst listener = {callback: callback, context: context};\n\t\tthis.listeners[key] || (this.listeners[key] = []);\n\t\tthis.listeners[key].push(listener);\n\t}\n\n\tunregisterKey(type, key, callback, context) {\n\t\tif (_.isArray(key)) {\n\t\t\t_.forEach(key, (k) => {\n\t\t\t\tthis.unregisterKey(type, k, callback, context);\n\t\t\t});\n\t\t\treturn;\n\t\t}\n\t\tkey = KeyUtils.getKeyData(key.ctrl, key.alt, key.shift, key.meta, key.code);\n\t\tif(!key.length) return;\n\t\tkey = new StringBuffer(type).append(key).toString('.');\n\n\t\tlet listeners = this.listeners[key], listener;\n\t\tif (!listeners) return;\n\t\tfor (let i = 0; i < listeners.length; i++) {\n\t\t\tlistener = listeners[i];\n\t\t\tif (listener.callback === callback && (!context || context === listener.context)) {\n\t\t\t\tlisteners.splice(i, 1);\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * Registers an event handler\n\t */\n\tregister(type, callback, context, zIndex) {\n\t\tif (_.isArray(type)) {\n\t\t\t_.forEach(type, (t) => {\n\t\t\t\tthis.register(t, callback, context, zIndex);\n\t\t\t});\n\t\t\treturn;\n\t\t}\n\t\tconst listener = {callback: callback, context: context, zIndex: zIndex};\n\t\tlet regexp = null;\n\t\tif (type instanceof RegExp) {\n\t\t\tregexp = type;\n\t\t\ttype = type + '';\n\t\t}\n\t\tthis.listeners[type] || (this.listeners[type] = []);\n\t\tif (regexp && !this.listeners[type].regexp)\n\t\t\tthis.listeners[type].regexp = regexp;\n\t\tthis.listeners[type].push(listener);\n\t}\n\n\tunregister(type, callback, context) {\n\t\tif (type instanceof RegExp)\n\t\t\ttype = type + '';\n\t\tlet listeners = this.listeners[type], listener;\n\t\tif (!listeners) return;\n\t\tfor (let i = 0; i < listeners.length; i++) {\n\t\t\tlistener = listeners[i];\n\t\t\tif (listener.callback === callback && (!context || context === listener.context)) {\n\t\t\t\tlisteners.splice(i, 1);\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t}\n\n\tdestroy() {\n\t\tthis.stop();\n\t\tdelete this.root;\n\t\tdelete this.listeners;\n\t\tdelete this.enterStack;\n\t}\n\n\t/**\n\t * Check if the registered event type matches the real event type. \"*\" is allowed as a wild card.\n\t */\n\tstatic match(nsType, registeredType) {\n\t\tif (registeredType instanceof RegExp)\n\t\t\treturn nsType.match(registeredType);\n\n\t\treturn nsType == registeredType;\n\t\t/*const arr = registeredType.split('*');\n\t\tif (arr.length == 1)\n\t\t\treturn nsType == registeredType;\n\n\t\tlet substr, index = 0;\n\t\tfor (let i = 0; i < arr.length; i++) {\n\t\t\tif (arr[i].length == 0) continue;\n\t\t\tsubstr = nsType.slice(index);\n\t\t\tindex = substr.indexOf(arr[i]);\n\t\t\tif (index < 0)\n\t\t\t\treturn false;\n\t\t\tindex += arr[i].length;\n\t\t}\n\t\treturn true;*/\n\t}\n\n\tstatic mouse(container, e) {\n\t\tif (e.changedTouches) e = e.changedTouches[0];\n\t\tlet svg = container.ownerSVGElement || container;\n\t\tif (svg.createSVGPoint) {\n\t\t\tlet point = svg.createSVGPoint();\n\t\t\tpoint.x = e.clientX; point.y = e.clientY;\n\t\t\tpoint = point.matrixTransform(container.getScreenCTM().inverse());\n\t\t\treturn [point.x, point.y];\n\t\t}\n\t\tlet rect = container.getBoundingClientRect();\n\t\treturn [e.clientX - rect.left - container.clientLeft, e.clientY - rect.top - container.clientTop];\n\t}\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/event/EventDispatcher.js","///////////////////////////////////////////////////////////////////////////////\n//                                                                           //\n//           The Key Utility CLass for the Event Dispatcher          \t     //\n//                                                                           //\n///////////////////////////////////////////////////////////////////////////////\n\nimport StringBuffer from \"./../util/StringBuffer\";\n\n/**\n * KEY constant\n */\nconst KEY = {\n\tALT          : 18,\n\tBACK_SPACE   : 8,\n\tCAPS_LOCK    : 20,\n\tCONTROL      : 17,\n\tDELETE       : 46,\n\tDOWN         : 40,\n\tEND          : 35,\n\tENTER        : 13,\n\tESCAPE       : 220,\n\tHOME         : 36,\n\tLEFT         : 37,\n\tMETA         : 224,\n\tNUM_LOCK     : 144,\n\tPAGE_DOWN    : 34,\n\tPAGE_UP      : 33,\n\tPAUSE        : 19,\n\tPRINTSCREEN  : 44,\n\tRIGHT        : 39,\n\tSCROLL_LOCK  : 145,\n\tSHIFT        : 16,\n\tSPACE        : 32,\n\tTAB          : 9,\n\tUP           : 38\n\t//ADD          : DomUtils.isFireFox ? 61  : 187,\n\t//SUBTRACT     : DomUtils.isFireFox ? 173 : 189\n};\n\nexport function getKeyEvent(event) {\n\tif (!event || !event instanceof KeyboardEvent) {\n\t\treturn null;\n\t}\n\n\tvar key = event.keyCode || event.which;\n\n\t// Need to find a way to avoid this\n\tif (key >= 16 && key <= 18) {\n\t\tkey = null;\n\t}\n\n\treturn getKeyData(event.ctrlKey, event.altKey, event.shiftKey, event.metaKey, key);\n}\n\nexport function getKeyData(ctrl, alt, shift, meta, key) {\n\tvar buf = new StringBuffer();\n\n\tif (ctrl) buf.append(\"CTRL\");\n\tif (alt) buf.append(\"ALT\");\n\tif (shift) buf.append(\"SHIFT\");\n\tif (meta) buf.append(\"META\");\n\tif (key) buf.append(key);\n\n\treturn buf.toString(\".\");\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/event/KeyUtils.js","import _ from \"lodash\";\nimport Utils from \"../util/Utils\";\nimport Node from \"./Node\";\nimport Edge from \"./Edge\";\nimport Marker from \"../view/Marker\";\n\nconst nodeDefaults = {\n\tname: 'Default',\n\trole: 'node',\n\tdraggable: true,\n\tselectable: true,\n\teditable: true,\n\tresizable: false,\n\tsourceable: true,\n\ttargetable: true,\n\tvisible: true\n};\n\nconst edgeDefaults = {\n\tname: 'Default',\n\trole: 'edge',\n\tselectable: true,\n\tvisible: true,\n\tstartMarker: null,\n\tendMarker: {\n\t\tid: 'Default_EndMarker',\n\t\ttype: 'arrow',\n\t\tsize: 10,\n\t\tcolor: '#0ea117'\n\t},\n\t/* start and end is only used if the edge is not connected to a node */\n\tstart: [0, 0],\n\tend: [400, 200]\n};\n\nclass Graph {\n\tconstructor(id = _.uniqueId(\"G\"), config = {}, model) {\n\t\tthis.id = id;\n\n\t\tthis.nodes = {};\n\t\tthis.edges = {};\n\n\t\tthis.selection = null;\n\t\tthis.destroyed = false;\n\n\t\tUtils.buildTypes(config.nodeTypes, \"Nodes\", nodeDefaults);\n\t\tUtils.buildTypes(config.edgeTypes, \"Edges\", edgeDefaults);\n\t\t// check for markers.\n\t\tthis.markers = [];\n\t\tlet edgeTypes = Utils.type(Edge.namespace), marker, markerConfig;\n\t\tedgeTypes.forEach(function(type) {\n\t\t\tmarkerConfig = type.prototype.startMarker;\n\t\t\tif (markerConfig) {\n\t\t\t\tmarker = Marker.getMarker(markerConfig, true);\n\t\t\t\tthis.markers.push(marker);\n\t\t\t}\n\t\t\tmarkerConfig = type.prototype.endMarker;\n\t\t\tif (markerConfig) {\n\t\t\t\tmarker = Marker.getMarker(markerConfig, false);\n\t\t\t\tthis.markers.push(marker);\n\t\t\t}\n\t\t}, this);\n\n\t\tdelete config.nodeTypes;\n\t\tdelete config.edgeTypes;\n\t\tUtils.initConfig(this, config);\n\t\tthis.root = null;\n\t\tif (model)\n\t\t\tthis.loadModel(model);\n\t}\n\n\tstatic getJSClass(config, defaultClass) {\n\t\tvar jsClass = null;\n\t\tif (config && config.type) {\n\t\t\t// See if we can get the js class from config.\n\t\t\tvar type = Utils.type(defaultClass.namespace, config.type);\n\t\t\tif (type)\n\t\t\t\tjsClass = type.jsClass;\n\t\t}\n\n\t\treturn Utils.getConstructor(jsClass, defaultClass);\n\t}\n\n\t/**\n\t * Create a new Node\n\t * @param config\n\t * @param parent\n\t * @param pos\n\t * @returns {*}\n\t */\n\taddNode(config, parent = this.currentRoot, pos) {\n\t\tlet NodeClass = Graph.getJSClass(config, Node);\n\t\tlet node = new NodeClass(this, config);\n\n\t\tif (parent)\n\t\t\tGraph.addChild(parent, node, pos);\n\t\telse {\n\t\t\tthis.root = node;\n\t\t\tthis.root.prop('role', 'root');\n\t\t}\n\n\t\tthis.nodes[node.id] = node;\n\t\treturn node;\n\t}\n\n\t/**\n\t * Create a new Edge\n\t * @param config\n\t * @param parent\n\t * @param from\n\t * @param to\n\t * @returns {*}\n\t */\n\taddEdge(config, parent = this.currentRoot, from, to) {\n\t\tlet EdgeClass = Graph.getJSClass(config, Edge);\n\t\tlet edge = new EdgeClass(this, config, from, to);\n\n\t\tGraph.addChild(parent, edge);\n\t\tthis.edges[edge.id] = edge;\n\t\treturn edge;\n\t}\n\n\t/**\n\t * Added a new child to the parent. The parent has to be a node.\n\t * @param parent\n\t * @param child\n\t */\n\tstatic addChild(parent, child) {\n\t\tif (!parent.children)\n\t\t\tparent.children = [];\n\n\t\tif (child.parent != parent) {\n\t\t\tparent.children.push(child);\n\n\t\t\tif (child.parent && child.parent.children)\n\t\t\t\tchild.parent.children = _.without(child.parent.children, child);\n\t\t}\n\t\tchild.parent = parent;\n\t}\n\n\tloadModel(model, parent = this.currentRoot) {\n\t\tvar nodes = model.nodes;\n\t\tvar edges = model.edges;\n\t\tdelete model.nodes;\n\t\tdelete model.edges;\n\n\t\tvar node = this.addNode(model, parent);\n\t\tif (nodes) {\n\t\t\t_.forEach(nodes, (child) => {\n\t\t\t\tthis.loadModel(child, node);\n\t\t\t});\n\t\t}\n\t\tif (edges) {\n\t\t\t_.forEach(edges, (edge) => {\n\t\t\t\tlet from, to;\n\t\t\t\tif (edge.from)\n\t\t\t\t\tfrom = this.nodes[edge.from];\n\t\t\t\tif (edge.to)\n\t\t\t\t\tto = this.nodes[edge.to];\n\t\t\t\tthis.addEdge(edge, node, from, to);\n\t\t\t});\n\t\t}\n\t}\n\n\tget currentRoot() {\n\t\treturn this.root;\n\t}\n\n\treset() {}\n\tdestroy() {}\n}\n\nGraph.DEFAULTS = {\n\tallowDanglingEdges: true,\n\tmultiConnect: false,\n\treadOnly: false,\n\tviewOnly: false\n};\n\nexport default Graph;\n\n\n\n// WEBPACK FOOTER //\n// ./src/graph/Graph.js","import _ from \"lodash\";\nimport StringBuffer from \"../util/StringBuffer\";\nimport Cell from \"./Cell\";\n\n/**\n * A Node represents vertex of the graph.\n */\nclass Node extends Cell {\n\tconstructor(graph, config = {}) {\n\t\tif (!config.id) config.id = _.uniqueId('N');\n\t\tsuper(graph, config);\n\n\t\tthis.inEdges = [];\n\t\tthis.outEdges = [];\n\t\tthis.ports = null;\n\t\tthis.parent = null;\n\t}\n\n\tisAncestor(n) {\n\t\t// TODO: should we move this to graph class ?\n\t\tvar node = n.parent;\n\t\twhile (node) {\n\t\t\tif (this == node) { return true; }\n\t\t\tnode = node.parent;\n\t\t}\n\t\treturn false;\n\t}\n\n\tremoveEdge(edge) {\n\t\tvar edges = edge.source == this ? this.outEdges : this.inEdges;\n\t\tfor (var i = 0; i < edges.length; i++) {\n\t\t\tif (edge == edges[i]) {\n\t\t\t\tedges.splice(i, 1);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\n\t// Add a new incoming edge\n\taddInEdge(edge, pos) {\n\t\tif (pos == null || pos === undefined)\n\t\t\tthis.inEdges.push(edge);\n\t\telse\n\t\t\tthis.inEdges.splice(pos, 0, edge);\n\t}\n\n\t// Add a new outgoing edge\n\taddOutEdge(edge, pos) {\n\t\tif (pos == null || pos === undefined || pos > edge.length - 1)\n\t\t\tthis.outEdges.push(edge);\n\t\telse\n\t\t\tthis.outEdges.splice(pos, 0, edge);\n\t}\n\n\trenderChildren(view) {\n\t\tif (this.children) {\n\t\t\tlet buf = new StringBuffer();\n\t\t\t_.forEach(this.children, (child) => {\n\t\t\t\tbuf.append(child.render(view));\n\t\t\t});\n\t\t\treturn buf.toString();\n\t\t}\n\t\treturn '';\n\t}\n\n\tgetPort(key, portName = 'auto', endPt, orthogonal) {\n\t\tlet shape = this.getShape(key);\n\t\tif (portName == 'auto') {\n\t\t\treturn shape.getPerimeter(endPt, orthogonal);\n\t\t}\n\t\treturn null;\n\t}\n\n\ttoString() {\n\t\tvar label = this.prop(\"label\") ? this.prop(\"label\") : \"undefined\";\n\t\tif (_.isArray(label))\n\t\t\tlabel = label[0];\n\t\treturn 'Node:{id:' + this.id + ';label:' + label + ';type:' + this.props.constructor.typeName + '}';\n\t}\n}\nNode.namespace = \"Nodes\";\n\nexport default Node;\n\n/*\n\n/**\n * The DrillDownParent is the parent that displays the vertex when drilled down.\n *\nVertex.prototype.getDrillDownParent = function() {\n\treturn this.parent;\n};\n\nVertex.prototype.isLocked = function() {\n\tvar mode = this.getProperty(\"mode\") || 3;\n\treturn !(mode & Graph.ALLOW_INTERACTIONS);\n};\n\nVertex.prototype.getCrumbText = function() {\n\tif (this.isLocked())\n\t\treturn '<span><img src=\"webwb/pzreadonly.png\" /></span><span>&nbsp;' + this.getProperty(\"label\") + '</span>';\n\treturn this.getProperty(\"label\");\n};\n\nVertex.prototype.canEdit = function() {\n\treturn (!this.parent || !this.parent.isLocked()) && Vertex.superclass.canEdit.call(this);\n};\n\nVertex.prototype.isContainer = function() {\n\treturn this.getProperty(\"container\");\n};\n\n*/\n\n\n\n// WEBPACK FOOTER //\n// ./src/graph/Node.js","import _ from \"lodash\";\nimport Utils from \"../util/Utils\";\nimport Cache from \"../util/Cache\";\nimport StringBuffer from \"../util/StringBuffer\";\nimport Shape from \"../geometry/Shape\";\nimport Rectangle from \"../geometry/Rectangle\";\nimport Label from \"../view/Label\";\n\n/**\n * The Cell is the common parent for Node and Edge.\n */\nexport default class Cell {\n\tconstructor(graph, config = {id: _.uniqueId()}) {\n\t\tthis.graph = graph;\n\t\tthis.id = config.id;\n\t\tdelete config.id;\n\n\t\t// Initialize decorators\n\t\tif (config.decorators) {\n\t\t\tthis.createDecorators(config.decorators);\n\t\t\tdelete config.decorators;\n\t\t}\n\n\t\t// Initialize View Properties\n\t\tif (config.views) {\n\t\t\tthis.viewProps = config.views;\n\t\t\tdelete config.views;\n\t\t}\n\n\t\t// Initialize type\n\t\tvar type = config.type || \"Default\";\n\t\ttype = Utils.type(this.constructor.namespace, type);\n\t\tif (!type)\n\t\t\tthrow new Error(\"Type not found \" + config.type);\n\t\tdelete config.type;\n\t\tthis.props = new type(config);\n\t}\n\n\tprop(name, value) {\n\t\tif (_.isUndefined(value))\n\t\t\treturn this.props[name];\n\t\tthis.props[name] = value;\n\t}\n\n\t/**\n\t * Get/Set property stored by views.\n\t * @param key\n\t * @param name\n\t * @param value\n\t * @returns {*}\n\t */\n\tviewProp(key = 'default', name, value) {\n\t\tif (_.isUndefined(value)) {\n\t\t\tif (key == 'default')\n\t\t\t\treturn this.prop(name, value);\n\t\t\treturn this.viewProps[key][name];\n\t\t}\n\t\tif (key == 'default') {\n\t\t\tthis.prop(name, value);\n\t\t} else {\n\t\t\tif (!this.viewProps[key])\n\t\t\t\tthis.viewProps[key] = {};\n\t\t\tthis.viewProps[key][name] = value;\n\t\t}\n\t}\n\n\tcreateDecorators(decorators) {}\n\n\t/**\n\t * Get properties needed for rendering this element\n\t * @returns {{key: (string|*), className: *, namespace: *, bounds: *}}\n\t */\n\tgetView(key) {\n\t\tlet shape = this.getShape(key);\n\t\treturn _.assign({\n\t\t\tid: this.id,\n\t\t\tkey: key,\n\t\t\tclassName: this.computedClassName,\n\t\t\tstyle: this.viewProp(key, 'style'),\n\t\t\tnamespace: this.namespace\n\t\t}, shape);\n\t}\n\n\tgetShape(key) {\n\t\tlet shape = Cache.get(this.id + \".shape\", key);\n\t\tif (shape) return shape;\n\n\t\tlet shapeConfig = this.viewProp(key, 'shape');\n\t\tlet shapeClass = shapeConfig ? Shape.getShape(shapeConfig.name) : Shape.getShape('Rectangle');\n\t\tlet x = this.viewProp(key, \"x\");\n\t\tlet y = this.viewProp(key, \"y\");\n\t\tlet width = this.viewProp(key, \"width\");\n\t\tlet height = this.viewProp(key, \"height\");\n\t\tshape = new shapeClass(x, y, width, height, shapeConfig);\n\t\tCache.set(this.id + '.shape', shape, key);\n\t\treturn shape;\n\t}\n\n\trender(view) {\n\t\tlet template = Cache.get(this.id + '.template', view.id);\n\t\tif (!template) {\n\t\t\t//create the template\n\t\t\tlet role = this.prop('role');\n\t\t\ttemplate = view.getTemplate('$' + role, null, this);\n\t\t\tif (_.isString(template))\n\t\t\t\ttemplate = _.template(template);\n\t\t\tCache.set(this.id + '.template', template, view.id);\n\t\t}\n\t\treturn template(this.getView(view.id));\n\t}\n\n\trenderShape(view) {\n\t\tlet shape = this.getShape(view.id);\n\t\tif (shape)\n\t\t\treturn shape.render(view);\n\t\treturn '';\n\t}\n\n\trenderLabel(view) {\n\t\tif (this == this.graph.currentRoot)\n\t\t\treturn null;\n\t\tlet box = this.getLabelBox(view.id);\n\t\tif (box)\n\t\t\treturn view.renderLabel(box);\n\t\treturn '';\n\t}\n\n\tgetLabelBox(key) {\n\t\tlet box = Cache.get(this.id + '.labelBox', key);\n\t\tif (box) return box;\n\t\tlet shape = this.getShape(key);\n\t\t// Just get the config will have a positive performance boost for IE11 and IE10.\n\t\tbox = Label.getLabelBox(this.prop('label'), this.viewProp(key, 'labelConfig'), shape.width, shape.height);\n\t\tCache.set(this.id + '.labelBox', box, key);\n\t\treturn box;\n\t}\n\n\tget computedClassName() {\n\t\tif (!this._computedClassName) {\n\t\t\tvar buf = new StringBuffer(this.prop(\"role\"));\n\t\t\tlet props = this.props;\n\t\t\tif (props.hasOwnProperty(\"className\"))\n\t\t\t\tbuf.append(props[\"className\"]);\n\t\t\tprops = props.constructor.prototype;\n\t\t\twhile (props) {\n\t\t\t\tif (props.hasOwnProperty(\"className\"))\n\t\t\t\t\tbuf.append(props[\"className\"]);\n\t\t\t\tprops = Object.getPrototypeOf(props);\n\t\t\t}\n\t\t\tthis._computedClassName = buf.toString(' ');\n\t\t}\n\t\treturn this._computedClassName;\n\t}\n\n\tget namespace() {\n\t\tif (this == this.graph.currentRoot) return '';\n\t\treturn \"root.\" + this.prop(\"role\");\n\t}\n\n\tdestroy() {\n\t\tdelete this.graph;\n\t\tdelete this.decorators;\n\t\tdelete this.props;\n\t\tdelete this.viewProps;\n\t\tthis.destroyed = true;\n\t}\n}\n\n/*\n\nCell.prototype.move = function(x, y) {\n\tthis.setProperty(\"x\", Math.round(x));\n\tthis.setProperty(\"y\", Math.round(y));\n\tdelete this.bounds;\n};\n\nCell.prototype.resize = function(w, h) {\n\tthis.setProperty(\"width\", w);\n\tthis.setProperty(\"height\", h);\n\tdelete this.bounds;\n};\n\nCell.prototype.canEdit = function() {\n\treturn (this.graph ? this.graph.canEdit() : true) && this.getProperty(\"editable\");\n};\n\nCell.prototype.canSelect = function() {\n\treturn (this.graph ? this.graph.canSelect() : true) && this.getProperty(\"selectable\");\n};\n\nCell.prototype.canMove = function() {\n\treturn (this.graph ? this.graph.canEdit() : true) && this.getProperty(\"draggable\");\n};\n\nCell.prototype.canResize = function() {\n\treturn (this.graph ? this.graph.canEdit() : true) && this.getProperty(\"resizable\");\n};\n\nCell.prototype.getTypeFromString = function(typeStr) {\n\treturn this.graph.getType(typeStr);\n};\n\nCell.prototype.createModifiers = function(modifiers) {\n\tthis.modifiers = null;\n\tvar modifierSettings = this.getProperty(\"modifierSettings\");\n\tif (modifierSettings) {\n\t\t_.each(modifiers, function(config) {\n\t\t\tconfig.type = this.graph.getModifierType(config.className);\n\t\t\tconfig.setting = modifierSettings[config.className];\n\t\t\tif (!config.type || !config.setting) return;\n\n\t\t\tthis.addModifier(config.className, new Modifier(this, config));\n\t\t}, this);\n\n\t\t// Check for showAlways settings\n\t\t_.each(modifierSettings, function(setting, name) {\n\t\t\tif (setting.showAlways && (!this.modifiers || !this.modifiers[name])) {\n\t\t\t\tvar config = {type: this.graph.getModifierType(name), setting: setting};\n\t\t\t\tif (!config.type) return;\n\t\t\t\tthis.addModifier(name, new Modifier(this, config));\n\t\t\t}\n\t\t}, this);\n\t}\n};\n\nCell.prototype.addModifier = function(name, modifier) {\n\tif (!this.modifiers)\n\t\tthis.modifiers = {};\n\n\tif (!modifier.hasOwnProperty(\"showHeader\"))\n\t\tmodifier.showHeader = true;\n\n\t// @hack preferably set it in configurations.\n\tif (modifier.name == \"HoverProcessModifier\" || modifier.name == \"HoverResults\")\n\t\tmodifier.showHeader = false;\n\n\tthis.modifiers[name] = modifier;\n};\n\nCell.prototype.getModifiers = function() {\n\tif (_.isUndefined(this.modifiers))\n\t\tthis.createModifiers();\n\treturn this.modifiers;\n};\n\nCell.prototype.getModifier = function(name) {\n\tvar modifiers = this.getModifiers();\n\tif (modifiers)\n\t\treturn modifiers[name];\n\treturn null;\n};\n\nCell.prototype.isVisible = function() {\n\treturn this.getProperty('visible');\n};\n\nCell.prototype.isContainer = function() {\n\treturn false;\n};\n*/\n\n\n\n// WEBPACK FOOTER //\n// ./src/graph/Cell.js","/**\n * Created by tong on 6/7/2016.\n */\n\nlet caches = {};\n\nlet Cache = {\n\tget: function(key, namespace) {\n\t\treturn this.getCache(namespace)[key];\n\t},\n\n\tset: function(key, value, namespace) {\n\t\tthis.getCache(namespace)[key] = value;\n\t},\n\n\tcontains: function(key, namespace) {\n\t\treturn key in this.getCache(namespace);\n\t},\n\n\tremove: function(key, namespace) {\n\t\tdelete this.getCache(namespace)[key];\n\t},\n\n\tclear: function(namesapce) {\n\t\tif (!namespace)\n\t\t\tcaches = {};\n\t\telse if (caches[namespace])\n\t\t\tcaches[namespace] = {};\n\t},\n\n\tgetCache: function(namespace = 'default') {\n\t\tif (!caches[namespace])\n\t\t\tcaches[namespace] = {};\n\t\treturn caches[namespace];\n\t}\n};\n\nexport default Cache;\n\n\n\n// WEBPACK FOOTER //\n// ./src/util/Cache.js","import _ from \"lodash\";\nimport Events from \"bean\";\nimport Utils from \"../util/Utils\";\nimport DomUtils from \"../util/DomUtils\";\nimport StringBuffer from \"../util/StringBuffer\";\nimport Rectangle from \"../geometry/Rectangle\";\n\nconst FONT_BOLD = 1, FONT_ITALIC = 2, FONT_UNDERLINE = 4, FONT_SHADOW = 8;\n\nlet defaultConfig = {\n\tfontSize: 11,\n\tfontFamily: \"Arial\",\n\tfontStyle: 0,\n\tfontColor: 'black',\n\tpadding: 0,\n\tlinePadding: 0,\n\talign: \"left\",\n\twidth: 0,\n\theight: 0,\n\trotation: null,\n\tgeometry: {x: 0, y: 0, anchorY: 0, offsetX: 0, offsetY: 0}\n};\n\n/**\n * The label object handles label sizing/positioning\n */\nexport default (function() {\n\tlet stringMeasureEl = null, measureDiv, baselineDiv;\n\n\t/**\n\t * Calculate the size of the string.\n\t */\n\tlet getStringSize = _.memoize(function(str, fontSize, fontFamily, bold) {\n\t\tfontSize = fontSize || 11;\n\t\tfontFamily = fontFamily || 'Arial,Helvetica';\n\t\tbold = !_.isUndefined(bold) ? bold: false;\n\n\t\t// first check if there is a string-measuring div available, if not, create now.\n\t\tif (!stringMeasureEl) {\n\t\t\tstringMeasureEl = DomUtils.createElement('iframe', {id:\"_ComputeStylesIframe\"}, {position:\"absolute\", visibility:\"hidden\", width:\"auto\"});\n\t\t\tdocument.body.appendChild(stringMeasureEl);\n\t\t\tvar doc = stringMeasureEl.contentWindow.document;\n\t\t\tdoc.open();\n\t\t\tdoc.write('<html><body>\\\n\t\t\t\t<div id=\"baselineDiv\" style=\"height:100px;\"><span style=\"line-height:0\">T</span><span style=\"height:100%;display:inline-block;\"></span></div>\\\n\t\t\t\t<div id=\"measureDiv\" style=\"position:absolute;width:auto;height:auto;padding:0;white-space:pre-wrap;word-wrap:break-word;display:inline-block;\"></div>\\\n\t\t\t\t</body></html>');\n\t\t\tdoc.close();\n\t\t\tmeasureDiv = doc.getElementById(\"measureDiv\");\n\t\t\tbaselineDiv = doc.getElementById(\"baselineDiv\");\n\t\t}\n\t\tbaselineDiv.style.fontSize = measureDiv.style.fontSize = fontSize;\n\t\tbaselineDiv.style.fontFamily = measureDiv.style.fontFamily = fontFamily;\n\t\tbaselineDiv.style.fontWeight = measureDiv.style.fontWeight = bold ? 'bold' : 'normal';\n\t\tmeasureDiv.innerHTML = str;\n\n\t\tlet strut = baselineDiv.firstChild;\n\t\tlet baselineHeight = strut.offsetTop + strut.offsetHeight - baselineDiv.offsetHeight - baselineDiv.offsetTop;\n\n\t\treturn {width: measureDiv.offsetWidth, height: measureDiv.offsetHeight, baseline: baselineHeight};\n\t}, function(str, fontSize, fontFamily, bold) { return str + ';' + fontSize + ';' + fontFamily + ';' + bold; });\n\n\t/**\n\t * Create a wrapped text.\n\t * @param {String} string the string to wrap.\n\t * @param {maxWidth} the maximum width this string can take.\n\t * @param {fontSize}\n\t * @param {fontFamily}\n\t * @param {bold}\n\t */\n\tlet wrap = _.memoize(function(string, maxWidth, fontSize, fontFamily, bold) {\n\t\tmaxWidth = maxWidth || 0;\n\t\tfontSize = fontSize || 11;\n\t\tfontFamily = fontFamily || 'Arial,Helvetica';\n\t\tbold = !_.isUndefined(bold) ? bold: false;\n\n\t\tlet arr = [];\n\t\tlet spaceSize = getStringSize(\"&nbsp;\", fontSize, fontFamily, bold), space = spaceSize.width;\n\t\tarr.lineHeight = spaceSize.height;\n\t\tarr.baseline = spaceSize.baseline;\n\n\t\tif (!maxWidth || !string || string == \"\") {\n\t\t\tarr.push(string);\n\t\t\tarr.width = (!string || string == \"\") ? space : getStringSize(string, fontSize, fontFamily, bold).width;\n\t\t\tarr.height = arr.lineHeight;\n\t\t\treturn arr;\n\t\t}\n\n\t\tvar width = 0;\n\t\t//split the text by lines\n\t\tvar lines = string.split('\\n');\n\n\t\tvar buf = new StringBuffer();\n\n\t\tfor (var j = 0; j < lines.length; j++) {\n\t\t\t//split each line by word\n\t\t\tvar words = lines[j].split(/\\s/);\n\t\t\tvar line = \"\", currentWidth = 0, wordWidth = 0, newLine = true, word;\n\n\t\t\tfor (var i = 0; i < words.length; i++) {\n\t\t\t\tword = words[i];\n\t\t\t\twordWidth = getStringSize(word, fontSize, fontFamily, bold).width;\n\n\t\t\t\tif ((newLine ? wordWidth : currentWidth + space + wordWidth) > maxWidth) {\n\t\t\t\t\tif (newLine) {\n\t\t\t\t\t\tbuf.append(word);\n\t\t\t\t\t\twidth = Math.max(width, wordWidth);\n\t\t\t\t\t\tif (i < words.length - 1) {\n\t\t\t\t\t\t\tarr.push(buf.toString());\n\t\t\t\t\t\t\tbuf.clear();\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tarr.push(buf.append(line).toString());\n\t\t\t\t\t\twidth = Math.max(width, currentWidth + space + wordWidth);\n\t\t\t\t\t\tbuf.clear();\n\t\t\t\t\t}\n\t\t\t\t\tline = \"\";\n\t\t\t\t\tcurrentWidth = 0;\n\t\t\t\t\tif (!newLine)\n\t\t\t\t\t\ti--; // move back one word.\n\t\t\t\t\tnewLine = true;\n\t\t\t\t} else {\n\t\t\t\t\tline = newLine ? word : line + \" \" + word;\n\t\t\t\t\tcurrentWidth = newLine ? wordWidth : currentWidth + space + wordWidth;\n\t\t\t\t\twidth = Math.max(width, currentWidth);\n\t\t\t\t\tnewLine = false;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (line != \"\")\n\t\t\t\tbuf.append(line);\n\t\t\tif (j < lines.length - 1) {\n\t\t\t\tarr.push(buf.toString());\n\t\t\t\tbuf.clear();\n\t\t\t}\n\t\t}\n\n\t\tarr.push(buf.toString());\n\t\tarr.width = width;\n\t\tarr.height = arr.lineHeight * arr.length;\n\t\treturn arr;\n\t}, function(str, maxWidth, fontSize, fontFamily, bold) { return str + ';' + maxWidth + ';' + fontSize + ';' + fontFamily + ';' + bold; });\n\n\t/**\n\t *  Get the view information for how to display the label.\n\t * @param label The string that needs to be displayed\n\t * @param containerWidth The width of the parent container.\n\t * @param containerHeight The height of the parent container.\n\t * @param labelConfig The configuration on how to display label. It should be an object with the following parameters:\n\t * {\n\t *      fontSize, fontFamily, fontStyle, padding,\n\t *      align: can be either \"left\", \"center\" or \"right\",\n\t *      width: the maximum width of the label. if less than 1, then is treated as percentage. If 0, no wrapping will occur,\n\t *      height,\n\t *      geometry\n\t * }\n\t * @returns {*}\n\t */\n\tfunction getLabelBox(label, labelConfig, containerWidth, containerHeight) {\n\t\treturn _getLabelBox.call(this, label, labelConfig, {width: containerWidth, height: containerHeight});\n\t}\n\n\tfunction getLabelBoxForLink(label, labelConfig, link) {\n\t\treturn _getLabelBox.call(this, label, labelConfig, link);\n\t}\n\n\tfunction _getLabelBox(label, labelConfig = {}, context) {\n\t\tlabelConfig = _.defaultsDeep(labelConfig, defaultConfig);\n\t\tlet fontSize = labelConfig.fontSize;\n\t\tlet fontFamily = labelConfig.fontFamily;\n\t\tlet fontStyle = labelConfig.fontStyle;\n\t\tlet bold = (fontStyle & FONT_BOLD) == FONT_BOLD;\n\t\tlet padding = labelConfig.padding;\n\t\tlet linePadding = labelConfig.linePadding;\n\t\tlet align = labelConfig.align;\n\n\t\tlet w = labelConfig.width, h = labelConfig.height;\n\t\tif (context.width) {\n\t\t\tw = w <= 5 ? context.width * w : w;\n\t\t\th = h <= 5 ? context.height * h : h;\n\t\t}\n\t\tw -= 2 * padding;\n\t\th -= 2 * padding;\n\t\tw = Math.max(0, w);\n\t\th = Math.max(0, h);\n\n\t\tlet geometry = _.clone(labelConfig.geometry);\n\t\tlet wrappedLabel = this.wrap(label, w, fontSize, fontFamily, bold);\n\t\tgeometry.width = wrappedLabel.width + 2 * padding;\n\t\tgeometry.height = wrappedLabel.height + 2 * padding + (wrappedLabel.length - 1) * linePadding;\n\t\tlet anchor = \"start\", dx = 0, setAnchorX = !_.has(geometry, \"anchorX\");\n\t\tswitch (align) {\n\t\t\tcase \"center\":\n\t\t\t\tanchor = \"middle\";\n\t\t\t\tif (setAnchorX) geometry.anchorX = 0;\n\t\t\t\tbreak;\n\t\t\tcase \"right\":\n\t\t\t\tanchor = \"end\";\n\t\t\t\tdx = wrappedLabel.width/2;\n\t\t\t\tif (setAnchorX) geometry.anchorX = -0.5;\n\t\t\t\tbreak;\n\t\t\tcase \"left\":\n\t\t\t\tdx = -wrappedLabel.width/2;\n\t\t\t\tif (setAnchorX) geometry.anchorX = 0.5;\n\t\t\t\tbreak;\n\t\t}\n\t\tlet pos;\n\t\tif (context.getRelativePosition)\n\t\t\tpos = context.getRelativePosition(geometry);\n\t\telse\n\t\t\tpos = Utils.getRelativePosition({width: context.width, height: context.height}, geometry);\n\n\t\tlet bounds = new Rectangle(pos[0], pos[1], geometry.width, geometry.height);\n\t\t// the pivot is the center of rotation when the label has a rotation specified.\n\t\tlet pivot = align == 'center' ? [0, 0] : (align == 'left' ? [-wrappedLabel.width/2, 0] : [wrappedLabel.width/2, 0]);\n\n\t\t// the maximum bounds for the label, used to position inline editor\n\t\tgeometry.width = Math.max(w + 2 * padding, geometry.width);\n\t\tgeometry.height = Math.max(h + 2 * padding, geometry.height);\n\n\t\tif (context.getRelativePosition)\n\t\t\tpos = context.getRelativePosition(geometry);\n\t\telse\n\t\t\tpos = Utils.getRelativePosition({width: context.width, height: context.height}, geometry);\n\n\t\tlet maxBounds = new Rectangle(pos[0], pos[1], geometry.width, geometry.height);\n\t\treturn {\n\t\t\tconfig: labelConfig, label: wrappedLabel, _label: label,\n\t\t\tbold, underline: fontStyle & FONT_UNDERLINE, italic: fontStyle & FONT_ITALIC, shadow: fontStyle & FONT_SHADOW,\n\t\t\tdx, dy: -geometry.height/2 + padding + wrappedLabel.lineHeight - wrappedLabel.baseline, anchor, lineHeight: wrappedLabel.lineHeight + linePadding,\n\t\t\tpivot, bounds, maxBounds\n\t\t};\n\t}\n\n\tfunction render(view, box) {\n\t\treturn view.renderLabel(box);\n\t}\n\n\t// This is the inline editor for editing label text in place.\n\tlet editor = {\n\t\tstart: function(key, container, box, refEl, textEl, scale = 1.0, singleLine = true) {\n\t\t\tif (this.input) {\n\t\t\t\tif (this.key != key) {\n\t\t\t\t\t// need to close the existing editor first\n\t\t\t\t\tthis.stop();\n\t\t\t\t} else\n\t\t\t\t\treturn;\n\t\t\t}\n\t\t\tvar tag = singleLine ? 'input' : 'textarea';\n\t\t\tthis.input = DomUtils.createElement(tag, {id:\"inlineEditor\", unselectable:\"off\"}, {position:\"absolute\", overflow:\"hidden\", padding:\"0px\", margin:\"0px\", border:\"transparent\"});\n\t\t\tif (singleLine) {\n\t\t\t\tEvents.on(this.input, 'keydown keyup', (event) => {\n\t\t\t\t\tif (event.keyCode == 13) {\n\t\t\t\t\t\tEvents.off(this.input, 'keydown keyup');\n\t\t\t\t\t\tthis.stop();\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t\tcontainer.appendChild(this.input);\n\n\t\t\tthis.key = key;\n\t\t\tthis.box = box;\n\t\t\tthis.refEl = refEl;\n\t\t\tthis.textEl = textEl;\n\n\t\t\tlet labelConfig = box.config;\n\t\t\tlet maxBounds = new Rectangle(box.maxBounds.x, box.maxBounds.y, box.maxBounds.width * scale, box.maxBounds.height * scale);\n\t\t\tlet pos = DomUtils.getCenterPosition(refEl, container);\n\t\t\tpos = [pos[0] + maxBounds.left, pos[1] + maxBounds.top];\n\n\t\t\tif (textEl)\n\t\t\t\ttextEl.style.visibility = 'hidden';\n\n\t\t\tDomUtils.setElement(this.input, null, {\n\t\t\t\tvisibility: 'visible',\n\t\t\t\tleft: pos[0] + \"px\",\n\t\t\t\ttop: pos[1] + \"px\",\n\t\t\t\twidth: maxBounds.width + 'px',\n\t\t\t\theight: maxBounds.height + 'px',\n\t\t\t\t\"font-family\": labelConfig.fontFamily,\n\t\t\t\t\"font-size\": (labelConfig.fontSize * scale) + 'px',\n\t\t\t\t\"font-weight\": (labelConfig.fontStyle & FONT_BOLD) == FONT_BOLD ? 'bold' : 'normal'\n\t\t\t\t/*\"color\": labelConfig.fontColor*/\n\t\t\t});\n\n\t\t\tthis.input.value = box._label;\n\t\t\tthis.input.focus();\n\t\t\tthis.input.select();\n\t\t\tEvents.fire(this, 'editor.start', [this.key]);\n\t\t},\n\n\t\tstop: function(cancel) {\n\t\t\tif (!this.input) return;\n\n\t\t\tcancel = cancel || false;\n\t\t\tif (this.textEl)\n\t\t\t\tthis.textEl.style.visibility = null;\n\n\t\t\t// remove the input\n\t\t\tthis.input.parentNode.removeChild(this.input);\n\n\t\t\tif (!cancel)\n\t\t\t\tEvents.fire(this, 'editor.update', [this.key, this.input.value]);\n\n\t\t\tEvents.fire(this, 'editor.stop', [this.key]);\n\n\t\t\tdelete this.input;\n\t\t\tdelete this.key;\n\t\t\tdelete this.box;\n\t\t\tdelete this.refEl;\n\t\t\tdelete this.textEl;\n\t\t}\n\t};\n\n\treturn {\n\t\tFONT_BOLD,\n\t\tFONT_ITALIC,\n\t\tFONT_UNDERLINE,\n\t\tFONT_SHADOW,\n\t\tgetStringSize,\n\t\twrap,\n\t\tgetLabelBox,\n\t\tgetLabelBoxForLink,\n\t\trender,\n\t\teditor\n\t};\n})();\n\n\n\n// WEBPACK FOOTER //\n// ./src/view/Label.js","import _ from \"lodash\";\nimport Cell from \"./Cell\";\nimport Rectangle from \"../geometry/Rectangle\";\nimport Link from \"../geometry/Link\";\nimport Label from \"../view/Label\";\nimport Cache from \"../util/Cache\";\n\nclass Edge extends Cell {\n\tconstructor(graph, config = {}, source, target) {\n\t\tif (!config.id) config.id = _.uniqueId('E');\n\t\tsuper(graph, config);\n\n\t\tthis.source = this.target = null;\n\t\tthis.setSource(source, config.sourcePos);\n\t\tthis.setTarget(target, config.targetPos);\n\t}\n\n\tsetSource(node, pos) {\n\t\tthis.setTerminal(node, pos, 'source');\n\t}\n\n\tsetTarget(node, pos) {\n\t\tthis.setTerminal(node, pos, 'target');\n\t}\n\n\t/**\n\t * Internal methods to set either the source or target\n\t */\n\t setTerminal(node, pos, dir) {\n\t\tvar end = dir == 'source' ? this.source : this.target;\n\t\tif (end == node) {\n\t\t\t// simply change the position of the edge.\n\t\t\tif (node)\n\t\t\t\tnode.setEdgeAt(this, pos);\n\t\t} else {\n\t\t\tif (end) {\n\t\t\t\t// first remove the edge from the current end\n\t\t\t\tend.removeEdge(this);\n\t\t\t}\n\n\t\t\tif (node) {\n\t\t\t\tif (dir == 'source')\n\t\t\t\t\tnode.addOutEdge(this, pos);\n\t\t\t\telse\n\t\t\t\t\tnode.addInEdge(this, pos);\n\t\t\t}\n\t\t\tif (dir == 'source')\n\t\t\t\tthis.source = node;\n\t\t\telse\n\t\t\t\tthis.target = node;\n\t\t\t//this.clearPoints();\n\t\t}\n\t}\n\n\tgetLabelBox(key) {\n\t\tvar label = this.prop('label');\n\t\tif (label)\n\t\t\treturn Label.getLabelBoxForLink(label, this.viewProp(key, 'labelConfig'), this.getShape(key));\n\t\treturn null;\n\t}\n\n\t/**\n\t * Return a pair of points as reference to the calculation of start and end points.\n\t */\n\tgetReferencePoints(key) {\n\t\tlet pts = [];\n\t\tif (this.source)\n\t\t\tpts.push(this.source.getShape(key).center);\n\t\telse\n\t\t\tpts.push(this.viewProp(key, 'start'));\n\n\t\tif (this.target)\n\t\t\tpts.push(this.target.getShape(key).center);\n\t\telse\n\t\t\tpts.push(this.viewProp(key, 'end'));\n\n\t\treturn pts;\n\t}\n\n\tgetTerminalVisual(key, orthogonal) {\n\t\tlet refPts = this.getReferencePoints(key);\n\t\tlet terminals = [];\n\n\t\tlet getBound = function(pt) {\n\t\t\treturn new Rectangle(pt.x, pt.y, 3, 3);\n\t\t};\n\n\t\tif (this.source) {\n\t\t\tterminals.push(this.source.getPort(key, this.prop('sourcePort'), refPts[1], orthogonal));\n\t\t} else\n\t\t\tterminals.push({point: refPts[0], direction: Rectangle.getDirection(getBound(refPts[0]), refPts[1], true)});\n\n\t\tif (this.target) {\n\t\t\tterminals.push(this.target.getPort(key, this.prop('targetPort'), refPts[0], orthogonal));\n\t\t} else\n\t\t\tterminals.push({point: refPts[1], direction: Rectangle.getDirection(getBound(refPts[1]), refPts[0], true)});\n\t\treturn terminals;\n\t}\n\n\tgetShape(key) {\n\t\tlet shape = Cache.get(this.id + \".shape\", key);\n\t\tif (shape) return shape;\n\n\t\tlet config = this.viewProp(key, 'shape');\n\t\tshape = Link.getLink(this.getTerminalVisual(key, config.orthogonal), config, this.prop('startMarker'), this.prop('endMarker'));\n\t\tCache.set(this.id + '.shape', shape, key);\n\t\treturn shape;\n\t}\n\n\ttoString() {\n\t\treturn 'Edge:{' + (!this.source ? 'null' : this.source.id) + '--' + (!this.target ? 'null' : this.target.id) + '}';\n\t}\n\n\tdestroy() {\n\t\tsuper.destroy();\n\t\tthis.setSource(null);\n\t\tthis.setTarget(null);\n\t}\n}\nEdge.namespace = \"Edges\";\n\nexport default Edge;\n\n/*\n\nEdge.prototype.isVisible = function() {\n\tif (this.graph.getProperty(\"allowDanglingEdges\")) {\n\t\treturn (this.source ? this.source.isVisible() : true) && (this.target ? this.target.isVisible() : true) && this.getProperty(\"visible\");\n\t} else\n\t\treturn this.source && this.target && this.getProperty('visible') && this.source.isVisible() && this.target.isVisible();\n};\n\n*/\n\n\n\n// WEBPACK FOOTER //\n// ./src/graph/Edge.js","import Rectangle from \"../geometry/Rectangle\";\n\nlet registry = {};\n\nlet Marker = (function() {\n\n\t/** Begin Standard Marker Type **/\n\tfunction arrow(size, source, styles) {\n\t\tvar sign = source ? -1 : 1;\n\t\tvar marker = {\n\t\t\tviewBox: new Rectangle(-5, -5, 10, 10),\n\t\t\tsize: size,\n\t\t\tref: [4*sign, 0],\n\t\t\tfill: styles.color\n\t\t};\n\t\tmarker.shape = {\n\t\t\tname: 'Polygon',\n\t\t\tpoints: [[-2*sign, 0], [-4*sign, 4], [4*sign, 0], [-4*sign, -4]]\n\t\t};\n\t\treturn marker;\n\t}\n\n\tfunction triangle(size, source, styles) {\n\t\tvar sign = source ? -1 : 1;\n\t\tvar marker = {\n\t\t\tviewBox: new Rectangle(-5, -5, 10, 10),\n\t\t\tsize: size,\n\t\t\tref: [4*sign, 0],\n\t\t\tfill: styles.color\n\t\t};\n\t\tmarker.shape = {\n\t\t\tname: 'Polygon',\n\t\t\tpoints: [[-5*sign, -5], [-5*sign, 5], [4*sign, 0]]\n\t\t};\n\t\treturn marker;\n\t}\n\n\tfunction oval(size, source, styles) {\n\t\tvar r = size / 2;\n\t\tvar marker = {\n\t\t\tviewBox: new Rectangle(-r, -r, size, size),\n\t\t\tsize: size,\n\t\t\tref: [0, 0],\n\t\t\tfill: styles.color\n\t\t};\n\t\tmarker.shape = '<ellipse cx=\"0\" cy=\"0\" rx=\"' + r + '\" ry=\"' + r + '\"></ellipse>';\n\t\treturn marker;\n\t}\n\n\tfunction diamond(size, source, styles) {\n\t\tvar sign = source ? -1 : 1;\n\t\tvar marker = {\n\t\t\tviewBox: new Rectangle(-5, -5, 10, 10),\n\t\t\tsize: size,\n\t\t\tref: [4*sign, 0],\n\t\t\tfill: styles.color\n\t\t};\n\t\tmarker.shape = {\n\t\t\tname: 'Polygon',\n\t\t\tpoints: [[-4, 0], [0, 4], [4, 0], [0, -4]]\n\t\t};;\n\t\treturn marker;\n\t}\n\t/** End Standard Marker Type **/\n\tfunction getMarker(config, source) {\n\t\tvar factory = registry[config.type];\n\t\tvar marker = factory(config.size, source, config);\n\t\tmarker.id = config.id;\n\t\treturn marker;\n\t}\n\n\tregistry['arrow'] = arrow;\n\tregistry['triangle'] = triangle;\n\tregistry['oval'] = oval;\n\tregistry['diamond'] = diamond;\n\n\treturn {\n\t\tregistry: registry,\n\t\tgetMarker: getMarker\n\t};\n})();\n\nexport default Marker;\n\n\n\n\n// WEBPACK FOOTER //\n// ./src/view/Marker.js","import _ from \"lodash\";\nimport Utils from \"../util/Utils\";\n\nclass Layout {\n\tconstructor(config={}) {\n\t\tif (config.hasOwnProperty(\"orientation\") && _.isString(config.orientation)) {\n\t\t\tif (config.orientation.toUpperCase() == \"HORIZONTAL\")\n\t\t\t\tconfig.orientation = Layout.HORIZONTAL;\n\t\t\telse\n\t\t\t\tdelete config.orientation;\n\t\t}\n\t\tUtils.initConfig(this, config);\n\t}\n\n\tlayout(root, bounds) {}\n\treset() {}\n\tdestroy() {}\n}\nLayout.VERTICAL = 0;\nLayout.HORIZONTAL = 1;\n\nLayout.DEFAULTS = {\n\torientation: Layout.VERTICAL\n};\n\nexport default Layout;\n\n\n\n// WEBPACK FOOTER //\n// ./src/layout/Layout.js","import Layout from \"./Layout\";\n\nclass FlowLayout extends Layout {\n\tlayout(root, bounds) {\n\t\tvar items;\n\t\tif (!root)\n\t\t\titems = this.owner.childNodes;\n\t\telse if (_.isArray(root))\n\t\t\titems = root;\n\t\telse\n\t\t\titems = root.getLinkedNodes('target');\n\t\tif (!items || items.length == 0) return;\n\n\t\tvar x = 0, y = 0, h = 0, node;\n\t\tvar p1 = 0, p2 = 0;\n\t\tfor (var i = 0; i < items.length; i++) {\n\t\t\tnode = items[i];\n\t\t\tif (x > 0 && x + this.hgap + node.getProperty(\"width\") > bounds.width) {\n\t\t\t\t// create new line\n\t\t\t\ty += h + this.vgap;\n\t\t\t\tx = 0;h = 0;p1 = 0;p2++;\n\t\t\t}\n\t\t\tnode._flPos = [p1, p2];\n\t\t\tnode.moveTo([bounds.x + x, bounds.y + y]);\n\t\t\tx += this.hgap + node.getProperty(\"width\");\n\t\t\tp1++;\n\t\t\th = h < node.getProperty(\"height\") ? node.getProperty(\"height\") : h;\n\t\t}\n\t\tthis.trigger(new Rectangle(bounds.x, bounds.y, bounds.width, y + h));\n\t}\n}\n\nFlowLayout.DEFAULTS = {\n\thgap: 10,\n\tvgap: 10\n};\n\nexport default FlowLayout;\n\n\n\n// WEBPACK FOOTER //\n// ./src/layout/FlowLayout.js","import _ from \"lodash\";\nimport Events from \"bean\";\nimport Utils from \"../util/Utils\";\nimport DomUtils from \"../util/DomUtils\";\nimport Layout from \"../layout/Layout\";\nimport Rectangle from \"../geometry/Rectangle\";\nimport EventDispatcher from \"../event/EventDispatcher\";\nimport GraphBehavior from \"../behavior/GraphBehavior\";\nimport SelectionBehavior from \"../behavior/SelectionBehavior\";\nimport Label from \"./Label\";\n\nclass Renderer {\n\tconstructor(id, container, config = {}, graph = null) {\n\t\tthis.id = id;\n\t\tthis.box = DomUtils.createElement('div', {id: this.id, tabindex: 0, ns: 'graph'}, {overflow: \"hidden\", width: \"100%\", height: \"100%\", position: 'relative'});\n\t\tcontainer.appendChild(this.box);\n\t\tif (config.layout) {\n\t\t\tlet layoutClass = Utils.getConstructor(config.layout.jsClass, Layout);\n\t\t\tthis.layout = new layoutClass(config.layout.config);\n\t\t\tdelete config.layout;\n\t\t}\n\t\tthis.clear = true;\n\t\tthis._translate = [0, 0];\n\t\tthis._scale = 1.0;\n\t\tthis.graph = graph;\n\t\tthis.dispatcher = null;\n\t\tthis.graphBehavior = null;\n\t\tthis.selectionBehavior = null;\n\t\tthis.nodeBehavior = null;\n\t\tthis.edgeBehavior = null;\n\t\tthis.connectionBehavior = null;\n\t\tUtils.initConfig(this, config);\n\n\t\tEvents.on(Label.editor, 'editor.update.*', _.bind(function(key, value) {\n\t\t\t//this.graph.nodes[key].prop('label', value);\n\t\t\t//this.render();\n\t\t\tconsole.log(key + '=' + value);\n\t\t}, this));\n\t}\n\n\tget graph() {\n\t\treturn this._graph;\n\t}\n\n\tset graph(graph) {\n\t\tthis._graph = graph;\n\t\tlet root = graph.currentRoot;\n\t\tif (root) {\n\t\t\tthis._translate = [root.viewProp(this.id, 'x') || 0, root.viewProp(this.id, 'y') || 0];\n\t\t\tthis._scale = root.viewProp(this.id, 'scale') || 1.0;\n\t\t}\n\t}\n\n\tviewport(scaled, viewport) {\n\t\tif (_.isUndefined(scaled) || _.isNull(scaled)) scaled = false;\n\t\tif (!viewport) {\n\t\t\tvar vp = new Rectangle(0, 0, this.box.offsetWidth, this.box.offsetHeight);\n\t\t\tif (scaled)\n\t\t\t\treturn Utils.scale(this.translate, this.scale, vp);\n\t\t\treturn vp;\n\t\t}\n\t\tif (!scaled) viewport = Utils.scale(this.translate, this.scale, viewport);\n\t\tvar w = this.box.offsetWidth;\n\t\tvar scale = w / viewport.width;\n\t\tthis.transform(-viewport.x*scale, -viewport.y*scale, scale);\n\t}\n\n\tget translate() { return this._translate; }\n\tset translate(t) { this.transform(t[0], t[1]); }\n\tget scale() { return this._scale; }\n\tset scale(k) {\n\t\tswitch (k) {\n\t\t\tcase \"in\":\n\t\t\t\tk = this.scale * this.prop(\"zoomFactor\");\n\t\t\t\tbreak;\n\t\t\tcase \"out\":\n\t\t\t\tk = this.scale / this.prop(\"zoomFactor\");\n\t\t\t\tbreak;\n\t\t\tcase \"actual\":\n\t\t\t\tk = 1.0;\n\t\t\t\tbreak;\n\t\t\tcase \"fit\":\n\t\t\t\tvar gridSize = this.prop(\"gridSize\") * 2;\n\n\t\t\t\tvar gBounds = this.getBounds();\n\t\t\t\tvar vBounds = this.viewport();\n\n\t\t\t\tvBounds.width -= gridSize;\n\t\t\t\tvBounds.height -= gridSize;\n\n\t\t\t\t/* Do not zoom more than actual if graph already fits into the bounds */\n\t\t\t\tk = Math.min((vBounds.width / gBounds.width), (vBounds.height /gBounds.height), 1.0);\n\n\t\t\t\t//TODO: Add centering code here or trigger an event for that\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tif (_.isString(k)) k = parseFloat(k);\n\t\t\t\tbreak;\n\t\t}\n\t\tthis.transform(null, null, k);\n\t}\n\n\ttransform(x = null, y = null, scale = null) {\n\t\tlet graph = this.graph;\n\t\tlet root = graph ? graph.currentRoot : null;\n\t\tif (!_.isNull(x)) {\n\t\t\tthis._translate[0] = x;\n\t\t\tif (root)\n\t\t\t\troot.viewProp(this.id, 'x', x);\n\t\t}\n\t\tif (!_.isNull(y)) {\n\t\t\tthis._translate[1] = y;\n\t\t\tif (root)\n\t\t\t\troot.viewProp(this.id, 'y', y);\n\t\t}\n\t\tif (!_.isNull(scale)) {\n\t\t\tthis._scale = scale;\n\t\t\tif (root)\n\t\t\t\troot.viewProp(this.id, 'scale', scale);\n\t\t\t// sync the scale between the dispatcher and the graph\n\t\t\tlet s = this.dispatcher.scale;\n\t\t\tif (s != scale)\n\t\t\t\tthis.dispatcher.scale = scale;\n\t\t}\n\t\tthis.refresh();\n\t}\n\n\trender() {\n\t\tif (!this._graph) return false;\n\t\tif (this.layout)\n\t\t\tthis.layout.layout(this._graph.currentRoot, this.viewport());\n\n\t\tthis.initializeBehaviors();\n\t\treturn true;\n\t}\n\n\trenderLabel(box) {\n\t\treturn this.constructor.renderLabel(box);\n\t}\n\n\trenderLink(shape) {\n\t\treturn this.constructor.renderLink(shape);\n\t}\n\n\trenderMarkers(markers) {\n\t\treturn this.constructor.renderMarkers(markers);\n\t}\n\n\tinitializeBehaviors() {\n\t\t// create the event dispatcher if necessary.\n\t\tif (!this.dispatcher) {\n\t\t\tthis.dispatcher = new EventDispatcher(this.box, [this.prop('minZoom'), this.prop('maxZoom')]);\n\t\t\tlet jsClass;\n\t\t\tif (this.prop('graphBehavior')) {\n\t\t\t\tjsClass = Utils.getConstructor(this.prop('graphBehavior'));\n\t\t\t\tthis.graphBehavior = new jsClass(this);\n\t\t\t}\n\t\t\tif (this.prop('selectionBehavior')) {\n\t\t\t\tjsClass = Utils.getConstructor(this.prop('selectionBehavior'));\n\t\t\t\tthis.selectionBehavior = new jsClass(this);\n\t\t\t}\n\t\t\tthis.dispatcher.register('mouseup.node.label', function(type, ns, target, pos, event) {\n\t\t\t\tlet node = this._graph.nodes[target.getAttribute('id')];\n\t\t\t\tif (!this.dispatcher.dragging && !node._firstSelection) {\n\t\t\t\t\tLabel._delayEdit = _.delay(() => {\n\t\t\t\t\t\tif (Label._delayEdit) {\n\t\t\t\t\t\t\tdelete Label._delayEdit;\n\t\t\t\t\t\t\tLabel.editor.start(node.id, this.box, node.getLabelBox(this.id), target, event.nsTarget, this.scale);\n\t\t\t\t\t\t}\n\t\t\t\t\t}, 250);\n\t\t\t\t}\n\t\t\t}, this);\n\t\t\tthis.dispatcher.register([/^mousedown/, /^zoom/], function(type, ns, target, pos, event) {\n\t\t\t\tif (!DomUtils.eventFromInput(event)) {\n\t\t\t\t\tLabel.editor.stop();\n\t\t\t\t}\n\t\t\t}, this);\n\t\t}\n\t\tthis.dispatcher.start();\n\t}\n\n\trefresh() {}\n\n\t/**\n\t * Get the template for the specified key.\n\t * @param key\n\t * @param config if the template is a function, this config will be passed as the argument.\n\t * @param preprocessor if the template contains preprossing elements, such as #{shape}, the preprocessor will be\n\t * used to render them.\n\t * @returns {*}\n\t */\n\tgetTemplate(key, config, preprocessor) {\n\t\tvar t = this.constructor.TEMPLATES[key];\n\t\tif (t && _.isFunction(t)) {\n\t\t\tt = t(config);\n\t\t}\n\t\t// check if there are any preprocessing tags.\n\t\tif (preprocessor) {\n\t\t\tvar parts = t.match(/(#{[^#]*})/g);\n\t\t\tvar obj = {};\n\t\t\tfor (let part in parts) {\n\t\t\t\tpart = parts[part];\n\t\t\t\tpart = part.substring(2, part.length -1).trim();\n\t\t\t\tobj[part] = preprocessor[_.camelCase('render ' + part)](this);\n\t\t\t}\n\t\t\tt = _.template(t, {interpolate: /#{([\\s\\S]+?)}/g})(obj);\n\t\t}\n\t\treturn t;\n\t}\n\n\treset() {}\n\n\tdestroy() {\n\t\tdelete this._graph;\n\t\tdelete this.layout;\n\t\tif (this.dispatcher) {\n\t\t\tthis.dispatcher.stop();\n\t\t\tdelete this.dispatcher;\n\t\t}\n\t\tthis.box.innerHTML = '';\n\t}\n}\nRenderer.DEFAULTS = {\n\tdefaultClickMode: \"pan\",\n\thideOutline: false,\n\tsingleSelect: true,\n\tdraggable: true,\n\tgridEnabled: false,\n\tguidesEnabled: true,\n\tgridSize: 30,\n\tmaxZoom: 4.0,\n\tminZoom: 0.2,\n\tzoomFactor: 1.2,\n\tmaskOpacity: 0.5,\n\tgraphBehavior: GraphBehavior,\n\tselectionBehavior: SelectionBehavior\n};\n\nexport default Renderer;\n\n\n\n// WEBPACK FOOTER //\n// ./src/view/Renderer.js","/**\n * Created by tong on 6/28/2016.\n */\nimport Behavior from \"./Behavior\";\n\n/**\n * Graph handler handles Panning and Zoom and rubber band selection\n */\nclass GraphBehavior extends Behavior {\n\tconstructor(renderer) {\n\t\tsuper(renderer);\n\t\tlet dispatcher = renderer.dispatcher;\n\t\tlet f = function(type, ns, graph, pos, event) {\n\t\t\t//Cursor.updateCursor(type, ns, graph, event);\n\t\t};\n\t\tdispatcher.register(/^drag.*\\.graph$/, this.handleDrag, this);\n\t\tdispatcher.register(/^zoom/, this.handleZoom, this);\n\t\t//dispatcher.register(['mousedown.graph', 'mouseenter.graph', 'mouseleave.graph'], f);\n\t\tthis.offset = null;\n\t}\n\n\thandleZoom(type, ns, graph, pos, event) {\n\t\tthis.renderer.transform(null, null, event.scale);\n\t}\n\n\thandleDrag(type, ns, graph, pos, event) {\n\t\tif (type == 'dragstart') {\n\t\t\tlet pan = (this.renderer.prop(\"defaultClickMode\") == \"pan\") ^ (event.ctrlKey || event.shiftKey);\n\t\t\tif (!pan) return;\n\t\t\tlet t = this.renderer.translate;\n\t\t\tthis.offset = [t[0] - pos[0], t[1] - pos[1]];\n\t\t\treturn;\n\t\t}\n\t\tif (!this.offset) return;\n\t\tthis.renderer.transform(pos[0] + this.offset[0], pos[1] + this.offset[1]);\n\t\tif (type == 'dragend') {\n\t\t\t//Cursor.updateCursor('mouseup', ns, graph, event);\n\t\t\tdelete this.offset;\n\t\t}\n\t}\n}\n\nexport default GraphBehavior;\n\n\n\n// WEBPACK FOOTER //\n// ./src/behavior/GraphBehavior.js","export default class Behavior {\n\tconstructor(renderer) {\n\t\tthis.renderer = renderer;\n\t}\n\n\tdestroy() {\n\t\tdelete this.renderer;\n\t}\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/behavior/Behavior.js","import Rectangle from \"../geometry/Rectangle\";\nimport Cell from \"../graph/Cell\";\nimport Behavior from \"./Behavior\";\n\nclass SelectionBehavior extends Behavior {\n\tconstructor(renderer) {\n\t\tsuper(renderer);\n\t\tlet dispatcher = renderer.dispatcher;\n\t\tdispatcher.register('mousedown.*', this.selectCell, this);\n\t\tdispatcher.register('mouseup.*', this.unselectCell, this);\n\t\tdispatcher.register('drag*.graph', this.handleMultiSelect, this);\n\t\t//graph.on(Graph.EVENT_TYPES.SELECTION_CHANGE, this.updateSelections, this);\n\t\tthis.selectedNodes = null;\n\t\tthis.selectedLinks = null;\n\t\tthis.attachedLinks = null;\n\t}\n\n\tupdateSelections() {\n\t\tif (this.selectedNodes)\n\t\t\tthis.selectedNodes.classed('selected', false);\n\t\tif (this.selectedLinks)\n\t\t\tthis.selectedLinks.classed('selected', false);\n\n\t\tthis.selectedNodes = null;\n\t\tthis.selectedLinks = null;\n\t\tthis.attachedLinks = null;\n\n\t\tif (this.graph.selectedVertices && this.graph.selectedVertices.length > 0) {\n\t\t\tthis.selectedNodes = this.graph.renderer.getShapes(this.graph.selectedVertices);\n\t\t\tthis.attachedLinks = this.graph.renderer.getShapes(this.graph.getAttachedEdges());\n\t\t\tthis.selectedNodes.classed('selected', true);\n\t\t}\n\n\t\tif (this.graph.selectedEdges && this.graph.selectedEdges.length > 0) {\n\t\t\tthis.selectedLinks = this.graph.renderer.getShapes(this.graph.selectedEdges);\n\t\t\tthis.selectedLinks.classed('selected', true);\n\t\t}\n\t}\n\n\tselectCell(type, ns, data, pos, event) {\n\t\tvar cell = data == this.graph ? null : data;\n\t\tif (cell && !(cell instanceof Cell)) return;\n\t\tvar toggle = event.ctrlKey || event.shiftKey;\n\t\tif (cell && (cell instanceof Cell)) {\n\t\t\tif (!this.graph.isSelected(cell))\n\t\t\t\tdelete cell._firstSelection;\n\t\t\telse\n\t\t\t\tcell._firstSelection = true;\n\n\t\t\td3.select(event.dataTarget).moveToFront();\n\t\t\tthis.graph.setSelection(cell, toggle);\n\t\t}\n\t}\n\n\tunselectCell(type, ns, data, pos, event) {\n\t\tvar cell = data == this.graph ? null : data;\n\t\tif (cell && !(cell instanceof Cell)) return;\n\t\tvar ctrlKey = event.ctrlKey || event.shiftKey;\n\t\tif (!cell) {\n\t\t\tthis.graph.setSelection(cell, ctrlKey);\n\t\t}\n\t}\n\n\thandleMultiSelect(type, ns, data, pos, event) {\n\t\tpos = util.scale(this.graph, pos);\n\n\t\tif (type == 'dragstart') {\n\t\t\tvar select = (this.graph.getProperty(\"defaultClickMode\") == \"select\") ^ (event.ctrlKey || event.shiftKey);\n\t\t\tif (!select) return;\n\t\t\tthis.startPt = new Point(pos[0], pos[1]);\n\t\t\treturn;\n\t\t}\n\t\tif (!this.startPt) return;\n\t\tvar rect = Rectangle.getBoundingRectangle([new Point(pos[0], pos[1]), this.startPt]);\n\t\tvar renderer = this.graph.renderer;\n\t\tif (!this.rubberband) {\n\t\t\tthis.rubberband = d3.select(renderer.appendNode(renderer.getCellLayer(), {\n\t\t\t\ttemplate: _.template('<g><rect x=\"0\" y=\"0\" width=\"100\" height=\"100\" stroke=\"#000000\" fill=\"none\" stroke-dasharray=\"3 3\"/></g>')\n\t\t\t}, false));\n\t\t}\n\t\tif (type == 'dragend') {\n\t\t\tvar cells = this.graph.getCurrentRoot().children;\n\t\t\t// TODO: Define if we want to select vertexes / edges or both\n\t\t\tcells = _.filter(cells, function (cell) {\n\t\t\t\tvar box = cell.getBounds();\n\t\t\t\tif (rect.contains(box)) {\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t\treturn false;\n\t\t\t});\n\t\t\t// TODO: Set selection\n\t\t\tthis.graph.setSelection(cells, event.ctrlKey);\n\n\t\t\tthis.rubberband.remove();\n\t\t\tdelete this.startPt;\n\t\t\tdelete this.rubberband;\n\t\t\treturn;\n\t\t}\n\t\tthis.rubberband.select(\"rect\").attr({x: rect.x, y: rect.y, width: rect.width, height: rect.height});\n\t}\n\n\tdestroy() {\n\t\tsuper.destroy();\n\t\tdelete this.selectedNodes;\n\t\tdelete this.selectedLinks;\n\t\tdelete this.attachedLinks;\n\t}\n}\n\nexport default SelectionBehavior;\n\n\n\n// WEBPACK FOOTER //\n// ./src/behavior/SelectionBehavior.js","import _ from \"lodash\";\r\nimport Base64 from \"../util/base64\";\r\nimport DomUtils from \"../util/DomUtils\";\r\nimport Renderer from \"./Renderer\";\r\nimport StringBuffer from \"../util/StringBuffer\";\r\n\r\nconst NS = 'http://www.w3.org/2000/svg';\r\nif (typeof (SVGElement) != \"undefined\") {\r\n\tvar svg = document.createElementNS(NS, \"svg\");\r\n\tsvg.innerHTML = '<circle/>';\r\n\tif (svg.firstChild !== \"[object SVGCircleElement]\") {\r\n\t\tObject.defineProperties(SVGElement.prototype, {\r\n\t\t\t\"outerHTML\": {\r\n\t\t\t\tenumerable: false,\r\n\t\t\t\tconfigurable: true,\r\n\t\t\t\tget: function() {\r\n\t\t\t\t\tvar $node, $temp;\r\n\t\t\t\t\t$temp = document.createElement('div');\r\n\t\t\t\t\t$node = this.cloneNode(true);\r\n\t\t\t\t\t$temp.appendChild($node);\r\n\t\t\t\t\treturn $temp.innerHTML;\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\t\"innerHTML\": {\r\n\t\t\t\tenumerable: false,\r\n\t\t\t\tconfigurable: true,\r\n\t\t\t\tget: function() {\r\n\t\t\t\t\tvar s = this.outerHTML;\r\n\t\t\t\t\tvar ropen = new RegExp(\"<\" + this.nodeName + '\\\\b(?:([\"\\'])[^\"]*?(\\\\1)|[^>])*>', \"i\");\r\n\t\t\t\t\tvar rclose = new RegExp(\"<\\/\" + this.nodeName + \">$\", \"i\");\r\n\t\t\t\t\treturn  s.replace(ropen, \"\").replace(rclose, \"\");\r\n\t\t\t\t},\r\n\t\t\t\tset: function(markup) {\r\n\t\t\t\t\t// empty el first.\r\n\t\t\t\t\tlet child;\r\n\t\t\t\t\twhile (child = this.lastChild)\r\n\t\t\t\t\t\tthis.removeChild(child);\r\n\t\t\t\t\tlet buf = new StringBuffer();\r\n\t\t\t\t\tbuf.append('<svg>').append(markup).append('</svg');\r\n\t\t\t\t\tlet $temp = DomUtils.createElement('div', null, null, buf.toString()).firstElementChild;\r\n\t\t\t\t\twhile ($temp.firstChild)\r\n\t\t\t\t\t\tthis.appendChild($temp.firstChild);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t})\r\n\t}\r\n\t// Define the toDataURL for SVG\r\n\tSVGElement.prototype.toDataURL = function(type, options = {}) {\r\n\t\tlet _svg = this;\r\n\r\n\t\tlet debug = function(msg) {};\r\n\r\n\t\tif (options['debug'] == true && typeof(console) != 'undefined')\r\n\t\t\tdebug = function(msg) { console.log(\"SVG.toDataURL:\", msg); };\r\n\r\n\t\tfunction exportSVG() {\r\n\t\t\tvar svg_xml = _svg.outerHTML;\r\n\t\t\tvar svg_dataurl = base64dataURLencode(svg_xml);\r\n\t\t\tdebug(type + \" length: \" + svg_dataurl.length);\r\n\r\n\t\t\t// NOTE double data carrier\r\n\t\t\tif (options.callback) options.callback(svg_dataurl);\r\n\t\t\treturn svg_dataurl;\r\n\t\t}\r\n\r\n\t\tfunction base64dataURLencode(s) {\r\n\t\t\tvar b64 = \"data:image/svg+xml;base64,\";\r\n\r\n\t\t\t// https://developer.mozilla.org/en/DOM/window.btoa\r\n\t\t\tif (window.btoa) {\r\n\t\t\t\tdebug(\"using window.btoa for base64 encoding\");\r\n\t\t\t\tb64 += btoa(s);\r\n\t\t\t} else {\r\n\t\t\t\tdebug(\"using custom base64 encoder\");\r\n\t\t\t\tb64 += Base64.encode(s);\r\n\t\t\t}\r\n\r\n\t\t\treturn b64;\r\n\t\t}\r\n\r\n\t\t// Native export doesn't work very well. should use canvg instead.\r\n\t\tfunction exportImage(type) {\r\n\t\t\tvar canvas = document.createElement(\"canvas\");\r\n\t\t\tvar ctx = canvas.getContext('2d');\r\n\r\n\t\t\t// TODO: if (options.keepOutsideViewport), do some translation magic?\r\n\r\n\t\t\tvar svg_img = new Image();\r\n\t\t\tvar svg_xml = _svg.outerHTML;\r\n\t\t\tsvg_img.src = base64dataURLencode(svg_xml);\r\n\r\n\t\t\tsvg_img.onload = function() {\r\n\t\t\t\tdebug(\"exported image size: \" + [svg_img.width, svg_img.height]);\r\n\t\t\t\tcanvas.width = svg_img.width;\r\n\t\t\t\tcanvas.height = svg_img.height;\r\n\t\t\t\tctx.drawImage(svg_img, 0, 0);\r\n\r\n\t\t\t\t// SECURITY_ERR WILL HAPPEN NOW\r\n\t\t\t\tvar image_dataurl = canvas.toDataURL(type);\r\n\t\t\t\tdebug(type + \" length: \" + image_dataurl.length);\r\n\r\n\t\t\t\tif (options.callback) options.callback( image_dataurl );\r\n\t\t\t\telse debug(\"WARNING: no callback set, so nothing happens.\");\r\n\t\t\t};\r\n\r\n\t\t\tsvg_img.onerror = function() {\r\n\t\t\t\tdebug(\r\n\t\t\t\t\t\"Can't export! Maybe your browser doesn't support \" +\r\n\t\t\t\t\t\"SVG in img element or SVG input for Canvas drawImage?\\n\" +\r\n\t\t\t\t\t\"http://en.wikipedia.org/wiki/SVG#Native_support\"\r\n\t\t\t\t);\r\n\t\t\t};\r\n\r\n\t\t\t// NOTE: will not return anything\r\n\t\t}\r\n\r\n\t\tfunction exportImageCanvg(type) {\r\n\t\t\tif (!canvg) return null;\r\n\t\t\tlet canvas = DomUtils.createElement('canvas', null, {display: \"none\"});\r\n\t\t\tdocument.body.appendChild(canvas);\r\n\t\t\tif (type == 'javascript') {\r\n\t\t\t\tvar xcanvas = new jsCanvas ('jscanvastest');\r\n\t\t\t\txcanvas.canvas.style.display = 'none';\r\n\t\t\t\t//xcanvas.canvas = canvas;\r\n\t\t\t}\r\n\r\n\t\t\tif (!options.keepOutsideViewport) {\r\n\t\t\t\tcanvg(canvas, _svg.outerHTML);\r\n\t\t\t} else {\r\n\t\t\t\tlet padding = options.padding || 0;\r\n\t\t\t\tlet scale = 1.0;\r\n\t\t\t\tlet translate = [0, 0];\r\n\t\t\t\tlet bbox = _svg.getBBox();\r\n\t\t\t\tdebug(\"detected svg dimensions \" + [bbox.x, bbox.y, bbox.width, bbox.height]);\r\n\t\t\t\tlet transform = _svg.firstElementChild.getAttribute('transform');\r\n\t\t\t\tif (transform) {\r\n\t\t\t\t\tdebug('detected svg transform ' + transform);\r\n\t\t\t\t\ttransform = SVGRenderer.transform(transform);\r\n\t\t\t\t\ttranslate = transform.translate;\r\n\t\t\t\t\tscale = transform.scale;\r\n\t\t\t\t}\r\n\t\t\t\tlet buf = new StringBuffer();\r\n\t\t\t\tbuf.append('<svg width=\"').append(bbox.width + 2*padding).append('px\" height=\"').append(bbox.height + 2*padding).append('px\"><g transform=\"translate(')\r\n\t\t\t\t\t.append(-bbox.x+translate[0]+padding).append(',').append(-bbox.y+translate[1]+padding).append(')scale(').append(scale).append(')\">')\r\n\t\t\t\t\t.append(_svg.firstElementChild.innerHTML).append('</g></svg>');\r\n\t\t\t\tif (type == 'javascript') {\r\n\t\t\t\t\txcanvas.compile(buf.toString(), function () {\r\n\t\t\t\t\t\tif (options.callback) options.callback(xcanvas.toString());\r\n\t\t\t\t\t});\r\n\t\t\t\t\treturn;\r\n\t\t\t\t} else\r\n\t\t\t\t\tcanvg(canvas, buf.toString());\r\n\t\t\t}\r\n\t\t\tvar image_dataurl = canvas.toDataURL(type);\r\n\t\t\tif (options.callback) options.callback( image_dataurl );\r\n\t\t\tcanvas.parentNode.removeChild(canvas);\r\n\t\t\treturn image_dataurl;\r\n\t\t}\r\n\r\n\t\tif (!type) type = \"image/svg+xml\";\r\n\r\n\t\tif (options.keepNonSafe) debug(\"NOTE: keepNonSafe is NOT supported and will be ignored!\");\r\n\t\tif (options.keepOutsideViewport) debug(\"NOTE: keepOutsideViewport is only supported with canvg exporter.\");\r\n\r\n\t\tswitch (type) {\r\n\t\t\tcase \"image/svg+xml\":\r\n\t\t\t\treturn exportSVG();\r\n\t\t\tcase \"image/png\":\r\n\t\t\tcase \"image/jpeg\":\r\n\t\t\tcase \"javascript\":\r\n\t\t\t\tif (!options.renderer) {\r\n\t\t\t\t\tif (window.canvg) options.renderer = \"canvg\";\r\n\t\t\t\t\telse options.renderer=\"native\";\r\n\t\t\t\t}\r\n\t\t\t\tswitch (options.renderer) {\r\n\t\t\t\t\tcase \"canvg\":\r\n\t\t\t\t\t\tdebug(\"using canvg renderer for \" + type + \" image export\");\r\n\t\t\t\t\t\treturn exportImageCanvg(type);\r\n\t\t\t\t\tcase \"native\":\r\n\t\t\t\t\t\tdebug(\"using native renderer for \" + type + \" export. THIS MIGHT FAIL.\");\r\n\t\t\t\t\t\treturn exportImage(type);\r\n\t\t\t\t\tdefault:\r\n\t\t\t\t\t\tdebug(\"unknown image renderer given, doing noting (\" + options.renderer + \")\");\r\n\t\t\t\t}\r\n\t\t\t\tbreak;\r\n\t\t\tdefault:\r\n\t\t\t\tdebug(\"Sorry! Exporting as '\" + type + \"' is not supported!\");\r\n\t\t}\r\n\t\treturn null;\r\n\t}\r\n}\r\n\r\nclass SVGRenderer extends Renderer {\r\n\trender() {\r\n\t\tlet result = super.render();\r\n\t\tif (result) {\r\n\t\t\tlet root = this.graph.currentRoot;\r\n\t\t\tlet buf = new StringBuffer('<svg width=\"100%\" height=\"100%\" xmlns=\"http://www.w3.org/2000/svg\">');\r\n\t\t\tlet t = this.translate;\r\n\t\t\tbuf.append('<g transform=\"translate(').append(t[0]).append(',').append(t[1]).append(')scale(').append(this.scale).append(')\">');\r\n\t\t\tbuf.append(this.renderDefs());\r\n\t\t\tbuf.append(root.render(this));\r\n\t\t\tbuf.append('</g></svg>');\r\n\t\t\tthis.box.innerHTML = buf.toString();\r\n\t\t\tthis.svg = this.box.firstElementChild;\r\n\t\t}\r\n\t}\r\n\r\n\trenderDefs() {\r\n\t\tlet buf = new StringBuffer('<defs>');\r\n\t\tbuf.append(this.getTemplate('Grid', this.prop(\"gridSize\")));\r\n\t\tlet markers = this.graph.markers;\r\n\t\tif (markers.length > 0)\r\n\t\t\tbuf.append(SVGRenderer.renderMarkers(markers));\r\n\t\tbuf.append('</defs>');\r\n\t\treturn buf.toString();\r\n\t}\r\n\r\n\trefresh() {\r\n\t\tif (!this.svg) return;\r\n\t\tlet g = this.svg.querySelector('g');\r\n\t\tlet t = this.translate;\r\n\t\tg.setAttribute('transform', 'translate(' + t[0] + ',' + t[1] + ')scale(' + this.scale + ')');\r\n\t}\r\n\r\n\tstatic renderMarkers(markers) {\r\n\t\tlet buf = new StringBuffer(), str1, str2;\r\n\t\tmarkers.forEach(function(marker) {\r\n\t\t\tstr1 = this.TEMPLATES['Marker'](marker);\r\n\t\t\tstr2 = marker.shape;\r\n\t\t\tif (!_.isString(str2))\r\n\t\t\t\tstr2 = this.renderShape(str2);\r\n\t\t\tstr1 = str1.replace(/\\#\\{shape\\}/, str2);\r\n\t\t\tbuf.append(str1);\r\n\t\t}, this);\r\n\t\treturn buf.toString();\r\n\t}\r\n\r\n\tstatic renderLabel(box) {\r\n\t\treturn this.TEMPLATES['Label'](box);\r\n\t}\r\n\r\n\tstatic renderShape(shape) {\r\n\t\tlet template = this.TEMPLATES[shape.name];\r\n\t\tif (_.isString(template))\r\n\t\t\ttemplate = _.template(template);\r\n\t\treturn template(shape);\r\n\t}\r\n\r\n\tstatic getPathData(shape) {\r\n\t\tlet points = shape.points;\r\n\t\tlet controlPts = shape.controlPts;\r\n\t\tif (!points || points.length == 0) return '';\r\n\r\n\t\tif (!controlPts && shape.round) {\r\n\t\t\t// render rounded line joins.\r\n\t\t\tlet newPts = [];\r\n\t\t\tcontrolPts = [];\r\n\t\t\tlet prev = points[0], next, d1, d2, corner;\r\n\t\t\tnewPts.push(prev);\r\n\t\t\tfor (let i = 1; i < points.length - 1; i++) {\r\n\t\t\t\tnext = points[i];\r\n\t\t\t\t// set the control point first.\r\n\t\t\t\tcontrolPts[2*i] = [next, next];\r\n\t\t\t\t// check the size of the corner.\r\n\t\t\t\td1 = prev.distance(next);\r\n\t\t\t\td2 = next.distance(points[i+1]);\r\n\t\t\t\tcorner = Math.min(shape.round, d1/2, d2/2);\r\n\t\t\t\t// split the point into two.\r\n\t\t\t\tnewPts.push(next.getDirection(prev).scale(corner).translate(next));\r\n\t\t\t\tnewPts.push(next.getDirection(points[i+1]).scale(corner).translate(next));\r\n\t\t\t\tprev = next;\r\n\t\t\t}\r\n\t\t\tnewPts.push(points[points.length - 1]);\r\n\t\t\tpoints = newPts;\r\n\t\t}\r\n\t\tlet buf = new StringBuffer('M'), point;\r\n\t\tfor (let i = 0; i < points.length; i++) {\r\n\t\t\tpoint = points[i];\r\n\t\t\tif (i == 0)\r\n\t\t\t\tbuf.append(point);\r\n\t\t\telse {\r\n\t\t\t\tif (controlPts && controlPts[i]) {\r\n\t\t\t\t\tbuf.append(' C ');\r\n\t\t\t\t\tfor (let j = 0; j < controlPts[i].length; j++)\r\n\t\t\t\t\t\tbuf.append(controlPts[i][j]).append(' ');\r\n\t\t\t\t\tbuf.append(point);\r\n\t\t\t\t} else\r\n\t\t\t\t\tbuf.append(' L ').append(point);\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn buf.toString();\r\n\t}\r\n\r\n\tstatic renderLink(shape) {\r\n\t\tlet buf = new StringBuffer();\r\n\t\tlet d = SVGRenderer.getPathData(shape);\r\n\t\tif (shape.showGauge)\r\n\t\t\tbuf.append('<path style=\"stroke: white; stroke-width: 9; visibility: hidden; pointer-events: stroke;\" d=\"')\r\n\t\t\t\t.append(d).append('\"/>');\r\n\t\tbuf.append('<path d=\"').append(d).append('\"');\r\n\t\tif (shape.startMarker || shape.endMarker) {\r\n\t\t\tbuf.append(' style=\"');\r\n\t\t\tif (shape.startMarker)\r\n\t\t\t\tbuf.append('marker-start: url(#').append(_.isString(shape.startMarker) ? shape.startMarker : shape.startMarker.id).append(');');\r\n\t\t\tif (shape.endMarker)\r\n\t\t\t\tbuf.append('marker-end: url(#').append(_.isString(shape.endMarker) ? shape.endMarker : shape.endMarker.id).append(');');\r\n\t\t\tbuf.append('\"');\r\n\t\t}\r\n\t\tbuf.append('/>');\r\n\t\treturn buf.toString();\r\n\t}\r\n\r\n\tstatic appendContent(el, content) {\r\n\t\tlet buf = new StringBuffer();\r\n\t\tbuf.append('<svg>').append(content).append('</svg');\r\n\t\tlet temp = DomUtils.createElement('div', null, null, buf.toString()).firstElementChild;\r\n\r\n\t\twhile (temp.firstChild)\r\n\t\t\tel.appendChild(temp.firstChild);\r\n\t\treturn el;\r\n\t}\r\n\r\n\tstatic transform(transform) {\r\n\t\tlet translate = [0, 0], scale = 1.0;\r\n\t\t//\r\n\t\tlet parts = transform.match(/translate\\(\\s*([^)]+)/);\r\n\t\tif (parts) {\r\n\t\t\tlet m = parts[1].trim().match(/([\\d.-]+)[ ,]([\\d.-]+)/);\r\n\t\t\tif (m) {\r\n\t\t\t\ttranslate[0] = parseFloat(m[1]) || 0;\r\n\t\t\t\ttranslate[1] = parseFloat(m[2]) || 0;\r\n\t\t\t} else\r\n\t\t\t\ttranslate[0] = translate[1] = parseFloat(parts[1]);\r\n\t\t}\r\n\t\tparts = transform.match(/scale\\(\\s*([^)]+)/);\r\n\t\tif (parts)\r\n\t\t\tscale = parseFloat(parts[1]) || 1.0;\r\n\r\n\t\treturn {translate, scale};\r\n\t}\r\n}\r\nSVGRenderer.TEMPLATES = {\r\n\t$root: '<g id=\"${id}\" class=\"${className}\">#{children}</g>',\r\n\t$node: '<g id=\"${id}\" class=\"${className}\" style=\"${style}\" ns=\"${namespace}\" transform=\"translate(${x},${y})\">#{shape}#{label}</g>',\r\n\t$edge: '<g id=\"${id}\" class=\"${className}\" style=\"${style}\" ns=\"${namespace}\">#{shape}#{label}</g>',\r\n\tEllipse: '<ellipse cx=\"0\" cy=\"0\" rx=\"${width/2}\" ry=\"${height/2}\"/>',\r\n\tRectangle: '<rect x=\"${-width/2}\" y=\"${-height/2}\" width=\"${width}\" height=\"${height}\" rx=\"9\" ry=\"9\"/>',\r\n\tTriangle: '<polygon points=\"${-width/2},${-height/2} ${width/2},${-height/2} 0,${height/2}\"/>',\r\n\tRhombus: '<polygon points=\"0,${-height/2} ${width/2},0 0,${height/2} ${-width/2},0\"/>',\r\n\tHexagon: function(config) {\r\n\t\tvar vertical = config.direction == 'north' || config.direction == 'south';\r\n\t\tif (vertical)\r\n\t\t\treturn '<polygon points=\"0,${-height/2} ${width/2},${-height/4} ${width/2},${height/4} 0,${height/2} ${-width/2},${height/4} ${-width/2},${-height/4}\"/>';\r\n\t\telse\r\n\t\t\treturn '<polygon points=\"${-width/2},0 ${width/4},${-height/2} ${width/4},${-height/2} ${width/2},0 ${width/4},${height/2} ${-width/4},${height/2}\"/>';\r\n\t},\r\n\tPolygon: function(shape) {\r\n\t\tlet buf = new StringBuffer('<polygon points=\"');\r\n\t\tshape.points.forEach(function(pt){\r\n\t\t\tbuf.append(pt[0]).append(',').append(pt[1]).append(' ');\r\n\t\t});\r\n\t\tbuf.removeLast();\r\n\t\tbuf.append('\"/>');\r\n\t\treturn buf.toString();\r\n\t},\r\n\tImage: function(config) {\r\n\t\treturn '<image x=\"${-width/2}\" y=\"${-height/2}\" width=\"${width}\" height=\"${height}\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" xlink:href=\"' + config.image + '\"/>';\r\n\t},\r\n\tMarker: function(marker) {\r\n\t\treturn `\r\n<marker id=\"${marker.id}\" markerWidth=\"${marker.size}\" markerHeight=\"${marker.size}\" refx=\"${marker.ref[0]}\" \r\nrefy=\"${marker.ref[1]}\" orient=\"auto\" viewbox=\"${marker.viewBox.x} ${marker.viewBox.y} ${marker.viewBox.width} ${marker.viewBox.height}\"\r\nmarkerUnits=\"userSpaceOnUse\" ${marker.fill ? `style=\"stroke: ${marker.fill};fill:${marker.fill}\"` : ''}>#{shape}</marker>\r\n`.trim();\r\n\t},\r\n\tGrid: function(size) {\r\n\t\treturn `\r\n<pattern id=\"GridPattern\" width=\"${size}\" height=\"${size}\" patternUnits=\"userSpaceOnUse\">\r\n\t<ellipse cx=\"0\" cy=\"0\" rx=\"1\" ry=\"1\" fill=\"#999999\"/>\r\n\t<ellipse cx=\"0\" cy=\"${size}\" rx=\"1\" ry=\"1\" fill=\"#999999\"/>\r\n\t<ellipse cx=\"${size}\" cy=\"0\" rx=\"1\" ry=\"1\" fill=\"#999999\"/>\r\n\t<ellipse cx=\"${size}\" cy=\"${size}\" rx=\"1\" ry=\"1\" fill=\"#999999\"/>\r\n</pattern>`.trim();\r\n\t},\r\n\tLabel: _.template(`\r\n<% var box = _.has(data, \"dx\") ? data : (data.getLabelBox ? data.getLabelBox() : null); \r\n   if (box) {%>\r\n\t<g <% if (box.config && box.config.class) {%>class=\"<%=box.config.class%>\"<%}%>\\\r\n\t\t<% if (box.config && box.config.ns) {%>ns=\"<%=box.config.ns%>\"<%}%>\\\r\n\t\t<% if (box.config && box.config.inlineStyle) {%>\\\r\n\t\t\tfont-size=\"<%=box.config.fontSize%>\"\\\r\n\t\t\tfont-family=\"<%=box.config.fontFamily%>\"\\\r\n\t\t\tfont-weight=\"<% if (box.bold) {%>bold<%} else {%>normal<%}%>\"\\\r\n\t\t\t<% if (box.underline) {%>text-decoration=\"underline\"<%}%>\\\r\n\t\t\t<% if (box.italic) {%>font-style=\"italic\"<%}%>\\\r\n\t\t<%}%>\\\r\n\t\ttext-anchor=\"<%=box.anchor%>\"\\\r\n\t\ttransform=\"translate(<%=box.bounds.x%>,<%=box.bounds.y%>)<% if (box.config && box.config.rotation) {%>rotate(<%=box.config.rotation%> <%=box.pivot[0]%> <%=box.pivot[1]%>)<%}%>\">\r\n\t<% if (box.config.backgroundStyle) {%>\r\n\t\t<rect x=\"<%=-box.bounds.width/2%>\" y=\"<%=-box.bounds.height/2%>\" width=\"<%=box.bounds.width%>\" height=\"<%=box.bounds.height%>\" style=\"<%=box.config.backgroundStyle%>\"/>\r\n\t<% } if (_.isArray(box.label)) { \r\n\t\t_.each(box.label, function(value, line) {%>\r\n\t\t\t<text <% if (box.config && box.config.textStyle) {%>style=\"<%=box.config.textStyle%>\"<%}%>\\\r\n\t\t\t\tdx=\"<%=box.dx%>\" dy=\"<%=box.dy + box.lineHeight * line%>\"><%=value%></text>\r\n\t\t<%});} else { %>\r\n\t\t\t<text><%=box.label%></text>\r\n\t\t<%}%>\r\n\t\t<% if (box.config.title) {%>\r\n\t\t\t<title><%=box.config.title%></title>\r\n\t\t<%}%>\r\n\t</g>\r\n<%}%>\r\n`.trim(), {variable: \"data\"})   //TODO add more inline text styles.\r\n};\r\n\r\nexport default SVGRenderer;\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/view/SVGRenderer.js"]}