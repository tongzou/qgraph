{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","qgraph.js","webpack:/webpack/bootstrap 23f5f316dd0fc5962c1b","webpack:///src/index.js","webpack:///src/util/base64.js","webpack:///src/util/Utils.js","webpack:///src/geometry/Point.js","webpack:///src/geometry/Rectangle.js","webpack:/external {\"root\":\"_\",\"commonjs\":\"lodash\",\"commonjs2\":\"lodash\",\"amd\":\"lodash\"}","webpack:///src/geometry/Shape.js","webpack:///src/util/DomUtils.js","webpack:///src/util/StringBuffer.js","webpack:///src/geometry/Line.js","webpack:///src/geometry/Ellipse.js","webpack:///src/geometry/Link.js","webpack:///~/bean/bean.js","webpack:///src/event/EventDispatcher.js","webpack:///src/event/KeyUtils.js","webpack:///src/graph/Graph.js","webpack:///src/graph/Node.js","webpack:///src/graph/Cell.js","webpack:///src/util/Cache.js","webpack:///src/view/Label.js","webpack:///src/graph/Edge.js","webpack:///src/view/Marker.js","webpack:///src/layout/Layout.js","webpack:///src/layout/FlowLayout.js","webpack:///src/view/Renderer.js","webpack:///src/behavior/GraphBehavior.js","webpack:///src/behavior/Behavior.js","webpack:///src/behavior/SelectionBehavior.js","webpack:///src/view/SVGRenderer.js"],"names":["root","factory","exports","module","require","define","amd","this","__WEBPACK_EXTERNAL_MODULE_5__","modules","__webpack_require__","moduleId","installedModules","id","loaded","call","m","c","p","_interopRequireDefault","obj","__esModule","default","Object","defineProperty","value","_base","_base2","_Utils","_Utils2","_DomUtils","_DomUtils2","_StringBuffer","_StringBuffer2","_Point","_Point2","_Line","_Line2","_Shape","_Shape2","_Rectangle","_Rectangle2","_Ellipse","_Ellipse2","_Link","_Link2","_bean","_bean2","_EventDispatcher","_EventDispatcher2","_Graph","_Graph2","_Cell","_Cell2","_Node","_Node2","_Edge","_Edge2","_Layout","_Layout2","_FlowLayout","_FlowLayout2","_Label","_Label2","_Marker","_Marker2","_Renderer","_Renderer2","_SVGRenderer","_SVGRenderer2","_GraphBehavior","_GraphBehavior2","_SelectionBehavior","_SelectionBehavior2","addShape","Events","Base64","Cache","Utils","DomUtils","StringBuffer","Point","Line","Shape","Rectangle","Ellipse","Link","EventDispatcher","Label","Marker","Graph","Cell","Node","Edge","Layout","FlowLayout","Renderer","SVGRenderer","GraphBehavior","SelectionBehavior","_keyStr","encode","input","chr1","chr2","chr3","enc1","enc2","enc3","enc4","output","i","_utf8_encode","length","charCodeAt","isNaN","charAt","decode","replace","indexOf","String","fromCharCode","_utf8_decode","string","utftext","n","c1","c2","c3","global","_classCallCheck","instance","Constructor","TypeError","_possibleConstructorReturn","self","ReferenceError","_inherits","subClass","superClass","prototype","create","constructor","enumerable","writable","configurable","setPrototypeOf","__proto__","window","addEventHandler","document","navigator","_debugging","_debugAll","typeRegistry","splice","Array","type","namespace","name","_type","Map","set","get","createType","props","defaultType","extend","_extend","getPrototypeOf","apply","arguments","config","_","assign","typeName","log","buildTypes","types","_this2","remove","defaultsDeep","forEach","child","parent","protoProps","staticProps","Surrogate","superclass","initConfig","cArr","DEFAULTS","prop","getConstructor","jsClass","defaultClass","isString","eval","debug","moduleName","push","message","console","substring","info","getRelativePosition","bounds","geometry","x","Math","abs","width","y","height","offsetPosition","pos","anchorX","offsetX","anchorY","offsetY","unscale","t","scale","o","_scale","getProperty","has","isFunction","_createClass","defineProperties","target","descriptor","key","aPt","sqrt","p2","dist","distance","angle","cos","PI","sin","clone","rotate","rect","vertical","W","N","S","E","NE","NW","SE","SW","_lodash","_lodash2","_Shape3","el","w","h","left","right","top","bottom","pt","contains","pt1","pt2","horizontal","contains1","contains2","outPt","orthogonal","undefined","dx","dy","alpha","atan2","pi","pi2","beta","tan","dir","getDirection","point","direction","pts","margin","isArray","min","max","rects","minx","miny","maxx","Infinity","maxy","each","r","registry","defaults","refPt","getPerimeter","view","template","getTemplate","isIE","sAgent","userAgent","Idx","parseInt","match","isFireFox","InstallTrigger","isChrome","raw","isMac","platform","toUpperCase","isWindows","appVersion","isLinux","createElement","tag","attribs","styles","html","setElement","innerHTML","createElementByString","str","temp","childNodes","setAttribute","style","testElement","node","method","nodeType","getAncestorBy","parentNode","getPosition","context","body","elRect","getBoundingClientRect","contextRect","getCenterPosition","move","getSize","offsetWidth","offsetHeight","resize","preloadImages","array","list","img","that","Image","onload","index","src","getImageInfo","downloadFile","data","mime","split","encoded","atob","decodeURI","GetBlob","msSaveBlob","link","href","download","display","appendChild","click","removeChild","contentType","sliceSize","byteArrays","offset","slice","byteNumbers","byteArray","Uint8Array","Blob","openImage","image","myWindow","open","myDocument","eventFromInput","e","tagName","buffer","stuff","concat","pop","sep","join","start","end","l","cosa","dotProduct","x0","y0","x1","y1","x2","y2","x3","y3","denom","nume_a","nume_b","ua","ub","intersectionX","intersectionY","a","b","cx","cy","px","py","d","f","g","det","xout1","xout2","yout1","yout2","dist1","pow","dist2","xout","yout","defaultConfig","showGauge","defaultGeometry","linkTypes","terminalVisual","shapeConfig","startMarker","endMarker","startNormal","endNormal","renderLink","isNumber","points","translate","getScaled","linkClass","DirectLink","BezierLink","ctrlpts","controlPts","p1","p3","p4","s","EntityRelations","_Link3","source","Port","getBounds","edge","isSourceLeft","isTargetLeft","result","getCenterY","xe","ye","seg","segment","dep","arr","midY","Manhattan","_Link4","MIN_BUFFER","autoRoute","maxChannelWidth","container","boxes","startBox","endBox","side","side2","box","intersect","j","channel","channel2","endPadding","startPadding","_getChannel","_getFirstIntersection","_getRouteTendency","_hasIntersection","_moveSegment","detectIntersection","savedIndex","savedSide","breakPt","_getRouteDirection","getCenter","box2","box1","getLeft","getRight","getBottom","getTop","_moveSegment2","_x7","_x8","_x9","_x10","_x11","toString","getTranslated","h2","h1","equals","findPositions","_mergeSegments","getCommonAncestor","getDescendants","excludeFromRouting","isAncestor","startBufferNormal","endBufferNormal","startBuffer","endBuffer","middle","prunePts","average","getMidPoint","startPositive","endPositive","positions","current","prev","__WEBPACK_AMD_DEFINE_FACTORY__","__WEBPACK_AMD_DEFINE_RESULT__","definition","selectorEngine","win","old","namespaceRegex","nameRegex","addEvent","removeEvent","doc","documentElement","W3C_MODEL","eventSupport","ONE","str2arr","standardNativeEvents","w3cNativeEvents","nativeEvents","hash","events","customEvents","element","compareDocumentPosition","check","event","related","relatedTarget","prefix","test","mouseenter","base","condition","mouseleave","mousewheel","Event","commonProps","mouseProps","mouseWheelProps","keyProps","textProps","touchProps","messageProps","stateProps","overOutRegex","typeFixers","reg","fix","newEvent","keyCode","which","rightClick","button","pageX","pageY","clientX","clientY","scrollLeft","scrollTop","typeFixerMap","isNative","ownerDocument","parentWindow","originalEvent","isBean","fixer","srcElement","preventDefault","returnValue","stopPropagation","cancelBubble","stop","stopped","stopImmediatePropagation","isImmediatePropagationStopped","currentTarget","ne","targetElement","RegEntry","wrappedHandler","fn","args","eargs","findTarget","eventElement","__beanDel","ft","handler","original","namespaces","customType","once","removeListener","eventType","inNamespaces","checkNamespaces","matches","checkElement","checkOriginal","checkHandler","map","forAll","pfx","all","substr","entries","entry","put","del","removed","setSelectorEngine","querySelectorAll","Error","rootListener","propertyName","listeners","listener","add","custom","attachEvent","detachEvent","rm","originalFn","orgType","handlers","delegate","selector","fireListener","evt","createEvent","dispatchEvent","fireEvent","createEventObject","off","typeSpec","k","isTypeStr","hasOwnProperty","on","first","delfn","one","fire","names","from","beanDel","bean","noConflict","cleanup","CollectGarbage","_interopRequireWildcard","newObj","_KeyUtils","KeyUtils","zoomScale","rootNS","getAttribute","dragging","bind","handleEvent","started","enterStack","startKeys","stopKeys","buf","ns","stack","isRoot","startsWith","rootTarget","nsTarget","prepend","targetStack","_this","isKeyEvent","getKeyEvent","getEventInfo","wheelDelta","dragObject","mouse","dragPos","mousemove","currentPos","dispatch","mouseup","simulateEnterLeave","last","clearEnterStack","getNS","val","append","item","nsType","regexp","callback","lastPosition","_this3","registerKey","getKeyData","ctrl","alt","shift","meta","code","_this4","unregisterKey","zIndex","_this5","register","RegExp","registeredType","changedTouches","svg","ownerSVGElement","createSVGPoint","matrixTransform","getScreenCTM","inverse","clientLeft","clientTop","KeyboardEvent","ctrlKey","altKey","shiftKey","metaKey","nodeDefaults","role","draggable","selectable","editable","resizable","sourceable","targetable","visible","edgeDefaults","size","color","uniqueId","model","nodes","edges","selection","destroyed","nodeTypes","edgeTypes","markers","marker","markerConfig","getMarker","loadModel","currentRoot","NodeClass","getJSClass","addChild","to","EdgeClass","addNode","addEdge","children","without","allowDanglingEdges","multiConnect","readOnly","viewOnly","_typeof","Symbol","iterator","_Cell3","graph","inEdges","outEdges","ports","_ret","render","v","portName","endPt","shape","getShape","label","_Cache","_Cache2","decorators","createDecorators","views","viewProps","isUndefined","className","computedClassName","viewProp","shapeClass","getView","getLabelBox","renderLabel","_computedClassName","caches","getCache","clear","namesapce","FONT_BOLD","FONT_ITALIC","FONT_UNDERLINE","FONT_SHADOW","fontSize","fontFamily","fontStyle","fontColor","padding","linePadding","align","rotation","labelConfig","containerWidth","containerHeight","_getLabelBox","getLabelBoxForLink","bold","wrappedLabel","wrap","anchor","setAnchorX","pivot","maxBounds","_label","underline","italic","shadow","lineHeight","baseline","stringMeasureEl","measureDiv","baselineDiv","getStringSize","memoize","position","visibility","contentWindow","write","close","getElementById","fontWeight","strut","firstChild","baselineHeight","offsetTop","maxWidth","spaceSize","space","lines","word","words","line","currentWidth","wordWidth","newLine","editor","refEl","textEl","singleLine","unselectable","overflow","border","font-family","font-size","font-weight","focus","select","cancel","_get","object","property","receiver","Function","desc","getOwnPropertyDescriptor","getter","setSource","sourcePos","setTarget","targetPos","setTerminal","setEdgeAt","removeEdge","addOutEdge","addInEdge","center","refPts","getReferencePoints","terminals","getBound","getPort","getLink","getTerminalVisual","arrow","sign","viewBox","ref","fill","triangle","oval","diamond","orientation","HORIZONTAL","VERTICAL","_Layout3","items","getLinkedNodes","owner","hgap","vgap","_flPos","moveTo","trigger","tabindex","layout","layoutClass","_translate","dispatcher","graphBehavior","selectionBehavior","nodeBehavior","edgeBehavior","connectionBehavior","scaled","_viewport","isNull","vp","transform","refresh","_graph","viewport","initializeBehaviors","renderMarkers","preprocessor","TEMPLATES","parts","part","trim","camelCase","interpolate","gridSize","gBounds","vBounds","parseFloat","defaultClickMode","hideOutline","singleSelect","gridEnabled","guidesEnabled","maxZoom","minZoom","zoomFactor","maskOpacity","_Behavior2","_Behavior3","_Behavior","renderer","handleDrag","handleZoom","pan","Behavior","selectCell","unselectCell","handleMultiSelect","selectedNodes","selectedLinks","attachedLinks","classed","selectedVertices","getShapes","getAttachedEdges","selectedEdges","cell","toggle","isSelected","_firstSelection","d3","dataTarget","moveToFront","setSelection","util","startPt","getBoundingRectangle","rubberband","appendNode","getCellLayer","cells","getCurrentRoot","filter","attr","_Renderer3","NS","SVGElement","createElementNS","outerHTML","$node","$temp","cloneNode","ropen","nodeName","rclose","markup","lastChild","firstElementChild","toDataURL","exportSVG","svg_xml","_svg","svg_dataurl","base64dataURLencode","options","b64","btoa","exportImage","canvas","ctx","getContext","svg_img","drawImage","image_dataurl","onerror","exportImageCanvg","canvg","xcanvas","jsCanvas","keepOutsideViewport","bbox","getBBox","compile","msg","keepNonSafe","renderDefs","querySelector","str1","str2","renderShape","round","newPts","next","d1","d2","corner","_i","getPathData","content","_transform","$root","$edge","Triangle","Rhombus","Hexagon","Polygon","removeLast","Grid","variable"],"mappings":"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","file":"qgraph.min.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory(require(\"lodash\"));\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([\"lodash\"], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"qgraph\"] = factory(require(\"lodash\"));\n\telse\n\t\troot[\"qgraph\"] = factory(root[\"_\"]);\n})(this, function(__WEBPACK_EXTERNAL_MODULE_5__) {\nreturn \n\n\n/** WEBPACK FOOTER **\n ** webpack/universalModuleDefinition\n **/","/*!\n * \n * \tqgraph - A Graph Manipulation and Visualization Library\n * \tAuthor: Tong Zou\n * \tVersion: v0.1.3\n * \tUrl: https://github.com/tongzou/qgraph\n * \tLicense(s): MIT\n * \n */\n(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory(require(\"lodash\"));\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([\"lodash\"], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"qgraph\"] = factory(require(\"lodash\"));\n\telse\n\t\troot[\"qgraph\"] = factory(root[\"_\"]);\n})(this, function(__WEBPACK_EXTERNAL_MODULE_5__) {\nreturn /******/ (function(modules) { // webpackBootstrap\n/******/ \t// The module cache\n/******/ \tvar installedModules = {};\n/******/\n/******/ \t// The require function\n/******/ \tfunction __webpack_require__(moduleId) {\n/******/\n/******/ \t\t// Check if module is in cache\n/******/ \t\tif(installedModules[moduleId])\n/******/ \t\t\treturn installedModules[moduleId].exports;\n/******/\n/******/ \t\t// Create a new module (and put it into the cache)\n/******/ \t\tvar module = installedModules[moduleId] = {\n/******/ \t\t\texports: {},\n/******/ \t\t\tid: moduleId,\n/******/ \t\t\tloaded: false\n/******/ \t\t};\n/******/\n/******/ \t\t// Execute the module function\n/******/ \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n/******/\n/******/ \t\t// Flag the module as loaded\n/******/ \t\tmodule.loaded = true;\n/******/\n/******/ \t\t// Return the exports of the module\n/******/ \t\treturn module.exports;\n/******/ \t}\n/******/\n/******/\n/******/ \t// expose the modules object (__webpack_modules__)\n/******/ \t__webpack_require__.m = modules;\n/******/\n/******/ \t// expose the module cache\n/******/ \t__webpack_require__.c = installedModules;\n/******/\n/******/ \t// __webpack_public_path__\n/******/ \t__webpack_require__.p = \"\";\n/******/\n/******/ \t// Load entry module and return exports\n/******/ \treturn __webpack_require__(0);\n/******/ })\n/************************************************************************/\n/******/ ([\n/* 0 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t\tvalue: true\n\t});\n\t\n\tvar _base = __webpack_require__(1);\n\t\n\tvar _base2 = _interopRequireDefault(_base);\n\t\n\tvar _Utils = __webpack_require__(2);\n\t\n\tvar _Utils2 = _interopRequireDefault(_Utils);\n\t\n\tvar _DomUtils = __webpack_require__(7);\n\t\n\tvar _DomUtils2 = _interopRequireDefault(_DomUtils);\n\t\n\tvar _StringBuffer = __webpack_require__(8);\n\t\n\tvar _StringBuffer2 = _interopRequireDefault(_StringBuffer);\n\t\n\tvar _Point = __webpack_require__(3);\n\t\n\tvar _Point2 = _interopRequireDefault(_Point);\n\t\n\tvar _Line = __webpack_require__(9);\n\t\n\tvar _Line2 = _interopRequireDefault(_Line);\n\t\n\tvar _Shape = __webpack_require__(6);\n\t\n\tvar _Shape2 = _interopRequireDefault(_Shape);\n\t\n\tvar _Rectangle = __webpack_require__(4);\n\t\n\tvar _Rectangle2 = _interopRequireDefault(_Rectangle);\n\t\n\tvar _Ellipse = __webpack_require__(10);\n\t\n\tvar _Ellipse2 = _interopRequireDefault(_Ellipse);\n\t\n\tvar _Link = __webpack_require__(11);\n\t\n\tvar _Link2 = _interopRequireDefault(_Link);\n\t\n\tvar _bean = __webpack_require__(12);\n\t\n\tvar _bean2 = _interopRequireDefault(_bean);\n\t\n\tvar _EventDispatcher = __webpack_require__(13);\n\t\n\tvar _EventDispatcher2 = _interopRequireDefault(_EventDispatcher);\n\t\n\tvar _Graph = __webpack_require__(15);\n\t\n\tvar _Graph2 = _interopRequireDefault(_Graph);\n\t\n\tvar _Cell = __webpack_require__(17);\n\t\n\tvar _Cell2 = _interopRequireDefault(_Cell);\n\t\n\tvar _Node = __webpack_require__(16);\n\t\n\tvar _Node2 = _interopRequireDefault(_Node);\n\t\n\tvar _Edge = __webpack_require__(20);\n\t\n\tvar _Edge2 = _interopRequireDefault(_Edge);\n\t\n\tvar _Layout = __webpack_require__(22);\n\t\n\tvar _Layout2 = _interopRequireDefault(_Layout);\n\t\n\tvar _FlowLayout = __webpack_require__(23);\n\t\n\tvar _FlowLayout2 = _interopRequireDefault(_FlowLayout);\n\t\n\tvar _Label = __webpack_require__(19);\n\t\n\tvar _Label2 = _interopRequireDefault(_Label);\n\t\n\tvar _Marker = __webpack_require__(21);\n\t\n\tvar _Marker2 = _interopRequireDefault(_Marker);\n\t\n\tvar _Renderer = __webpack_require__(24);\n\t\n\tvar _Renderer2 = _interopRequireDefault(_Renderer);\n\t\n\tvar _SVGRenderer = __webpack_require__(28);\n\t\n\tvar _SVGRenderer2 = _interopRequireDefault(_SVGRenderer);\n\t\n\tvar _GraphBehavior = __webpack_require__(25);\n\t\n\tvar _GraphBehavior2 = _interopRequireDefault(_GraphBehavior);\n\t\n\tvar _SelectionBehavior = __webpack_require__(27);\n\t\n\tvar _SelectionBehavior2 = _interopRequireDefault(_SelectionBehavior);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\t_Shape2.default.addShape(\"Rectangle\", _Rectangle2.default);\n\t_Shape2.default.addShape(\"Ellipse\", _Ellipse2.default);\n\t\n\texports.default = {\n\t\tEvents: _bean2.default,\n\t\tBase64: _base2.default,\n\t\tCache: _Utils2.default,\n\t\tUtils: _Utils2.default,\n\t\tDomUtils: _DomUtils2.default,\n\t\tStringBuffer: _StringBuffer2.default,\n\t\tPoint: _Point2.default,\n\t\tLine: _Line2.default,\n\t\tShape: _Shape2.default,\n\t\tRectangle: _Rectangle2.default,\n\t\tEllipse: _Ellipse2.default,\n\t\tLink: _Link2.default,\n\t\tEventDispatcher: _EventDispatcher2.default,\n\t\tLabel: _Label2.default,\n\t\tMarker: _Marker2.default,\n\t\tGraph: _Graph2.default,\n\t\tCell: _Cell2.default,\n\t\tNode: _Node2.default,\n\t\tEdge: _Edge2.default,\n\t\tLayout: _Layout2.default,\n\t\tFlowLayout: _FlowLayout2.default,\n\t\tRenderer: _Renderer2.default,\n\t\tSVGRenderer: _SVGRenderer2.default,\n\t\tGraphBehavior: _GraphBehavior2.default,\n\t\tSelectionBehavior: _SelectionBehavior2.default\n\t};\n\n/***/ },\n/* 1 */\n/***/ function(module, exports) {\n\n\t\"use strict\";\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t\tvalue: true\n\t});\n\t// http://www.webtoolkit.info/javascript-base64.html\n\t\n\tvar Base64 = {\n\t\n\t\t// private property\n\t\t_keyStr: \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=\",\n\t\n\t\t// public method for encoding\n\t\tencode: function encode(input) {\n\t\t\tvar output = \"\";\n\t\t\tvar chr1, chr2, chr3, enc1, enc2, enc3, enc4;\n\t\t\tvar i = 0;\n\t\n\t\t\tinput = Base64._utf8_encode(input);\n\t\n\t\t\twhile (i < input.length) {\n\t\n\t\t\t\tchr1 = input.charCodeAt(i++);\n\t\t\t\tchr2 = input.charCodeAt(i++);\n\t\t\t\tchr3 = input.charCodeAt(i++);\n\t\n\t\t\t\tenc1 = chr1 >> 2;\n\t\t\t\tenc2 = (chr1 & 3) << 4 | chr2 >> 4;\n\t\t\t\tenc3 = (chr2 & 15) << 2 | chr3 >> 6;\n\t\t\t\tenc4 = chr3 & 63;\n\t\n\t\t\t\tif (isNaN(chr2)) {\n\t\t\t\t\tenc3 = enc4 = 64;\n\t\t\t\t} else if (isNaN(chr3)) {\n\t\t\t\t\tenc4 = 64;\n\t\t\t\t}\n\t\n\t\t\t\toutput = output + this._keyStr.charAt(enc1) + this._keyStr.charAt(enc2) + this._keyStr.charAt(enc3) + this._keyStr.charAt(enc4);\n\t\t\t}\n\t\n\t\t\treturn output;\n\t\t},\n\t\n\t\t// public method for decoding\n\t\tdecode: function decode(input) {\n\t\t\tvar output = \"\";\n\t\t\tvar chr1, chr2, chr3;\n\t\t\tvar enc1, enc2, enc3, enc4;\n\t\t\tvar i = 0;\n\t\n\t\t\tinput = input.replace(/[^A-Za-z0-9\\+\\/\\=]/g, \"\");\n\t\n\t\t\twhile (i < input.length) {\n\t\n\t\t\t\tenc1 = this._keyStr.indexOf(input.charAt(i++));\n\t\t\t\tenc2 = this._keyStr.indexOf(input.charAt(i++));\n\t\t\t\tenc3 = this._keyStr.indexOf(input.charAt(i++));\n\t\t\t\tenc4 = this._keyStr.indexOf(input.charAt(i++));\n\t\n\t\t\t\tchr1 = enc1 << 2 | enc2 >> 4;\n\t\t\t\tchr2 = (enc2 & 15) << 4 | enc3 >> 2;\n\t\t\t\tchr3 = (enc3 & 3) << 6 | enc4;\n\t\n\t\t\t\toutput = output + String.fromCharCode(chr1);\n\t\n\t\t\t\tif (enc3 != 64) {\n\t\t\t\t\toutput = output + String.fromCharCode(chr2);\n\t\t\t\t}\n\t\t\t\tif (enc4 != 64) {\n\t\t\t\t\toutput = output + String.fromCharCode(chr3);\n\t\t\t\t}\n\t\t\t}\n\t\n\t\t\toutput = Base64._utf8_decode(output);\n\t\n\t\t\treturn output;\n\t\t},\n\t\n\t\t// private method for UTF-8 encoding\n\t\t_utf8_encode: function _utf8_encode(string) {\n\t\t\tstring = string.replace(/\\r\\n/g, \"\\n\");\n\t\t\tvar utftext = \"\";\n\t\n\t\t\tfor (var n = 0; n < string.length; n++) {\n\t\n\t\t\t\tvar c = string.charCodeAt(n);\n\t\n\t\t\t\tif (c < 128) {\n\t\t\t\t\tutftext += String.fromCharCode(c);\n\t\t\t\t} else if (c > 127 && c < 2048) {\n\t\t\t\t\tutftext += String.fromCharCode(c >> 6 | 192);\n\t\t\t\t\tutftext += String.fromCharCode(c & 63 | 128);\n\t\t\t\t} else {\n\t\t\t\t\tutftext += String.fromCharCode(c >> 12 | 224);\n\t\t\t\t\tutftext += String.fromCharCode(c >> 6 & 63 | 128);\n\t\t\t\t\tutftext += String.fromCharCode(c & 63 | 128);\n\t\t\t\t}\n\t\t\t}\n\t\n\t\t\treturn utftext;\n\t\t},\n\t\n\t\t// private method for UTF-8 decoding\n\t\t_utf8_decode: function _utf8_decode(utftext) {\n\t\t\tvar string = \"\";\n\t\t\tvar i = 0;\n\t\t\tvar c = c1 = c2 = 0;\n\t\n\t\t\twhile (i < utftext.length) {\n\t\n\t\t\t\tc = utftext.charCodeAt(i);\n\t\n\t\t\t\tif (c < 128) {\n\t\t\t\t\tstring += String.fromCharCode(c);\n\t\t\t\t\ti++;\n\t\t\t\t} else if (c > 191 && c < 224) {\n\t\t\t\t\tc2 = utftext.charCodeAt(i + 1);\n\t\t\t\t\tstring += String.fromCharCode((c & 31) << 6 | c2 & 63);\n\t\t\t\t\ti += 2;\n\t\t\t\t} else {\n\t\t\t\t\tc2 = utftext.charCodeAt(i + 1);\n\t\t\t\t\tc3 = utftext.charCodeAt(i + 2);\n\t\t\t\t\tstring += String.fromCharCode((c & 15) << 12 | (c2 & 63) << 6 | c3 & 63);\n\t\t\t\t\ti += 3;\n\t\t\t\t}\n\t\t\t}\n\t\n\t\t\treturn string;\n\t\t}\n\t\n\t};\n\t\n\texports.default = Base64;\n\n/***/ },\n/* 2 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t/* WEBPACK VAR INJECTION */(function(global) {\"use strict\";\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t\tvalue: true\n\t});\n\t\n\tvar _Point = __webpack_require__(3);\n\t\n\tvar _Point2 = _interopRequireDefault(_Point);\n\t\n\tvar _Rectangle = __webpack_require__(4);\n\t\n\tvar _Rectangle2 = _interopRequireDefault(_Rectangle);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\t\n\tfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\t\n\t// bean requires the existence of window\n\tif (typeof window === 'undefined' && typeof global !== 'undefined') {\n\t\tglobal.window = { addEventHandler: function addEventHandler() {} };\n\t\tglobal.document = {};\n\t\tglobal.navigator = {};\n\t}\n\t\n\t// util variables\n\tvar _debugging = [],\n\t    _debugAll = false,\n\t    typeRegistry = {},\n\t    splice = Array.splice;\n\t\n\t/**\n\t * Utility functions\n\t */\n\texports.default = {\n\t\ttype: function type(namespace, name, _type) {\n\t\t\tif (!typeRegistry[namespace]) typeRegistry[namespace] = new Map();\n\t\t\tif (!name) return typeRegistry[namespace];\n\t\t\tif (!_type) return typeRegistry[namespace].get(name);\n\t\t\ttypeRegistry[namespace].set(name, _type);\n\t\t},\n\t\n\t\tcreateType: function createType(namespace, props, defaultType) {\n\t\t\tvar name = props.name;\n\t\n\t\t\t// first check if type exists\n\t\t\tvar type = this.type(namespace, name);\n\t\t\tif (!type) {\n\t\t\t\tvar extend = props.extends ? this.type(namespace, props.extends) : null;\n\t\t\t\tif (!extend && defaultType) extend = defaultType;\n\t\t\t\tif (extend) type = function (_extend) {\n\t\t\t\t\t_inherits(type, _extend);\n\t\n\t\t\t\t\tfunction type() {\n\t\t\t\t\t\t_classCallCheck(this, type);\n\t\n\t\t\t\t\t\treturn _possibleConstructorReturn(this, Object.getPrototypeOf(type).apply(this, arguments));\n\t\t\t\t\t}\n\t\n\t\t\t\t\treturn type;\n\t\t\t\t}(extend);else {\n\t\t\t\t\ttype = function type(config) {\n\t\t\t\t\t\t_classCallCheck(this, type);\n\t\n\t\t\t\t\t\t_.assign(this, config);\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t\tdelete props.name;\n\t\t\t\tdelete props.extends;\n\t\t\t\t_.assign(type.prototype, props);\n\t\t\t\ttype.typeName = name;\n\t\t\t\tthis.type(namespace, name, type);\n\t\t\t\tthis.log('Utils', 'Utils.createType - ' + namespace + '.' + name);\n\t\t\t}\n\t\t\treturn type;\n\t\t},\n\t\n\t\tbuildTypes: function buildTypes(types, namespace, defaultType) {\n\t\t\tvar _this2 = this;\n\t\n\t\t\tthis.log('Utils', 'Utils.buildTypes - ' + namespace);\n\t\n\t\t\tif (!types && defaultType) {\n\t\t\t\tthis.createType(namespace, defaultType);\n\t\t\t\tthis.log('Utils', 'Utils.buildTypes end');\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tif (defaultType) {\n\t\t\t\tvar type = _.remove(types, { name: defaultType.name });\n\t\t\t\ttype = type.length > 0 ? type[0] : null;\n\t\t\t\tif (type) defaultType = this.createType(namespace, _.defaultsDeep(type, defaultType));else defaultType = this.createType(namespace, defaultType);\n\t\t\t}\n\t\n\t\t\t_.forEach(types, function (type) {\n\t\t\t\t_this2.createType(namespace, type, defaultType);\n\t\t\t});\n\t\t\tthis.log('Utils', 'Utils.buildTypes end');\n\t\t},\n\t\n\t\t// Helper function to correctly set up the prototype chain, for subclasses.\n\t\t// Similar to `goog.inherits`, but uses a hash of prototype properties and\n\t\t// class properties to be extended.\n\t\textend: function extend(child, parent, protoProps, staticProps) {\n\t\t\t// Add static properties to the constructor function, if supplied.\n\t\t\t_.extend(child, parent, staticProps);\n\t\n\t\t\t// Set the prototype chain to inherit from `parent`, without calling\n\t\t\t// `parent`'s constructor function.\n\t\t\tvar Surrogate = function Surrogate() {\n\t\t\t\tthis.constructor = child;\n\t\t\t};\n\t\t\tSurrogate.prototype = parent.prototype;\n\t\t\tchild.prototype = new Surrogate();\n\t\n\t\t\t// Add prototype properties (instance properties) to the subclass,\n\t\t\t// if supplied.\n\t\t\tif (protoProps) _.extend(child.prototype, protoProps);\n\t\n\t\t\t// Set a convenience property in case the parent's prototype is needed later.\n\t\t\tchild.superclass = parent.prototype;\n\t\n\t\t\treturn child;\n\t\t},\n\t\n\t\tinitConfig: function initConfig(obj, config) {\n\t\t\tvar props = {},\n\t\t\t    c = obj.constructor,\n\t\t\t    cArr = [c];\n\t\t\twhile (c) {\n\t\t\t\tif (c.super) {\n\t\t\t\t\tc = c.super.constructor;\n\t\t\t\t\tsplice.apply(cArr, [0, 0, c]);\n\t\t\t\t} else c = null;\n\t\t\t}\n\t\n\t\t\tfor (var i = 0; i < cArr.length; i++) {\n\t\t\t\tc = cArr[i];\n\t\t\t\tif (c.DEFAULTS) _.assign(props, c.DEFAULTS);\n\t\t\t}\n\t\t\tobj.props = _.assign(props, config);\n\t\t\tc.prototype.prop = function (name, value) {\n\t\t\t\tif (!value) return this.props[name];\n\t\t\t\tthis.props[name] = value;\n\t\t\t};\n\t\t},\n\t\n\t\t/**\n\t  * Gets the JS class constructor.\n\t  * @param {Object} jsClass\n\t  * @param {Object} defaultClass\n\t  */\n\t\tgetConstructor: function getConstructor(jsClass, defaultClass) {\n\t\t\tif (!jsClass) jsClass = defaultClass;\n\t\n\t\t\tif (_.isString(jsClass)) jsClass = eval(jsClass);\n\t\t\treturn jsClass;\n\t\t},\n\t\n\t\tdebug: function debug(moduleName) {\n\t\t\tif (moduleName) {\n\t\t\t\t_debugging.push(moduleName);\n\t\t\t} else {\n\t\t\t\t_debugAll = true;\n\t\t\t}\n\t\t},\n\t\n\t\tlog: function log(name, message) {\n\t\t\tif (!window.console) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tvar debug = _debugAll;\n\t\t\tif (!_debugAll) {\n\t\t\t\tdebug = false;\n\t\t\t\tfor (var i = 0; i < _debugging.length; i++) {\n\t\t\t\t\tif (_debugging[i] == name) debug = true;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (!debug) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\twhile (name.length < 10) {\n\t\t\t\tname = name + ' ';\n\t\t\t}\n\t\t\tname = name.substring(0, 10) + \" - \";\n\t\t\tconsole.info(name, message);\n\t\t},\n\t\n\t\t/**\n\t  * Get the relative position of sub shapes within a parent share.\n\t  * @param bounds\n\t  * @param geometry The geometry information, the format of Geometry is:\n\t  * {\n\t  *      x: \"x coordinate of ref point, if less than 1, will be treated as the percentage of the parent width.\",\n\t  *      y: \"y coordinate of ref point.\",\n\t  *      anchorX: \"x pos of child relative to the ref point\",\n\t  *      anchorY: \"y pos of child relative to the ref point\",\n\t  *      offsetX: \"the offset in the x direction.\",\n\t  *      offsetY: \"the offset in the y direction.\",\n\t  *      width: \"the width of the child element\",\n\t  *      height: \"the height of the child element\"\n\t  * }\n\t  * @returns {*[]}\n\t  */\n\t\tgetRelativePosition: function getRelativePosition(bounds, geometry) {\n\t\t\tvar x = Math.abs(geometry.x) <= 1 ? bounds.width * geometry.x : geometry.x;\n\t\t\tvar y = Math.abs(geometry.y) <= 1 ? bounds.height * geometry.y : geometry.y;\n\t\t\treturn this.offsetPosition([x, y], geometry);\n\t\t},\n\t\n\t\toffsetPosition: function offsetPosition(pos, geometry) {\n\t\t\treturn [pos[0] + geometry.width * geometry.anchorX + geometry.offsetX, pos[1] + geometry.height * geometry.anchorY + geometry.offsetY];\n\t\t},\n\t\n\t\t/**\n\t  * Get the position relative to the graph that's unscaled, i.e., absolute position without considering translation and scale.\n\t  * @param t the current translate\n\t  * @param scale the current scale\n\t  * @param o can be either a Point or a Rectangle or a Point array.\n\t  */\n\t\tunscale: function unscale(t, scale, o) {\n\t\t\tif (o instanceof _Rectangle2.default) return new _Rectangle2.default(o.x * scale + t[0], o.y * scale + t[1], o.width * scale, o.height * scale);else if (o instanceof _Point2.default) return new _Point2.default(o.x * scale + t[0], o.y * scale + t[1]);else return [o[0] * scale + t[0], o[1] * scale + t[1]];\n\t\t},\n\t\n\t\t/**\n\t  * Get the position relative to the graph that's scaled, i.e., relative position considering translation and scale.\n\t  * @param t the current translation\n\t  * @param scale the current scale\n\t  * @param o can be either a Point or a Rectangle or a Point array.\n\t  */\n\t\tscale: function scale(t, _scale, o) {\n\t\t\tif (o instanceof _Rectangle2.default) return new _Rectangle2.default((o.x - t[0]) / _scale, (o.y - t[1]) / _scale, o.width / _scale, o.height / _scale);else if (o instanceof _Point2.default) return new _Point2.default((o.x - t[0]) / _scale, (o.y - t[1]) / _scale);else return [(o[0] - t[0]) / _scale, (o[1] - t[1]) / _scale];\n\t\t},\n\t\n\t\t/**\n\t  * Convenience method.\n\t  */\n\t\tgetProperty: function getProperty(obj, prop) {\n\t\t\tif (!obj) return null;\n\t\t\tif (_.has(obj, prop)) return obj[prop];\n\t\t\tif (obj.prop && _.isFunction(obj.prop)) return obj.prop(prop);\n\t\t\treturn null;\n\t\t}\n\t};\n\t/* WEBPACK VAR INJECTION */}.call(exports, (function() { return this; }())))\n\n/***/ },\n/* 3 */\n/***/ function(module, exports) {\n\n\t\"use strict\";\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t\tvalue: true\n\t});\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tvar Point = function () {\n\t\tfunction Point(x, y) {\n\t\t\t_classCallCheck(this, Point);\n\t\n\t\t\tthis.x = x;\n\t\t\tthis.y = y;\n\t\t}\n\t\n\t\t/**\n\t  * Make a clone of this point\n\t  */\n\t\n\t\n\t\t_createClass(Point, [{\n\t\t\tkey: \"clone\",\n\t\t\tvalue: function clone() {\n\t\t\t\treturn new Point(this.x, this.y);\n\t\t\t}\n\t\n\t\t\t/**\n\t   * Calculate the distance from this pt to the other pt.\n\t   * @param aPt\n\t   * @returns {number}\n\t   */\n\t\n\t\t}, {\n\t\t\tkey: \"distance\",\n\t\t\tvalue: function distance(aPt) {\n\t\t\t\treturn Math.sqrt((this.x - aPt.x) * (this.x - aPt.x) + (this.y - aPt.y) * (this.y - aPt.y));\n\t\t\t}\n\t\n\t\t\t/**\n\t   * Translate this point\n\t  \t */\n\t\n\t\t}, {\n\t\t\tkey: \"translate\",\n\t\t\tvalue: function translate(p2) {\n\t\t\t\tthis.x += p2.x;\n\t\t\t\tthis.y += p2.y;\n\t\t\t\treturn this;\n\t\t\t}\n\t\n\t\t\t/**\n\t   * Scale this vector\n\t  \t */\n\t\n\t\t}, {\n\t\t\tkey: \"scale\",\n\t\t\tvalue: function scale(_scale) {\n\t\t\t\tthis.x *= _scale;\n\t\t\t\tthis.y *= _scale;\n\t\t\t\treturn this;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"getScaled\",\n\t\t\tvalue: function getScaled(scale) {\n\t\t\t\treturn new Point(this.x * scale, this.y * scale);\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"getTranslated\",\n\t\t\tvalue: function getTranslated(p2) {\n\t\t\t\treturn new Point(this.x + p2.x, this.y + p2.y);\n\t\t\t}\n\t\n\t\t\t/**\n\t   * Get the direction vector from this point to p2.\n\t   * @param p2\n\t   * @returns {Point}\n\t   */\n\t\n\t\t}, {\n\t\t\tkey: \"getDirection\",\n\t\t\tvalue: function getDirection(p2) {\n\t\t\t\tvar dist = this.distance(p2);\n\t\t\t\treturn new Point((p2.x - this.x) / dist, (p2.y - this.y) / dist);\n\t\t\t}\n\t\n\t\t\t/**\n\t   * rotate the point about the origin. With the specified angle.\n\t   * @param angle the angle to rotate\n\t   */\n\t\n\t\t}, {\n\t\t\tkey: \"rotate\",\n\t\t\tvalue: function rotate(angle) {\n\t\t\t\tvar cos = Math.cos(angle * Math.PI / 180);\n\t\t\t\tvar sin = Math.sin(angle * Math.PI / 180);\n\t\t\t\tvar x = this.x,\n\t\t\t\t    y = this.y;\n\t\t\t\tthis.x = x * cos - y * sin;\n\t\t\t\tthis.y = x * sin + y * cos;\n\t\t\t\treturn this;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"getRotated\",\n\t\t\tvalue: function getRotated(angle) {\n\t\t\t\treturn this.clone().rotate(angle);\n\t\t\t}\n\t\n\t\t\t/**\n\t   * Calculate the dot product, treating this and p2 as vectors.\n\t   */\n\t\n\t\t}, {\n\t\t\tkey: \"dotProduct\",\n\t\t\tvalue: function dotProduct(p2) {\n\t\t\t\treturn this.x * p2.x + this.y * p2.y;\n\t\t\t}\n\t\n\t\t\t/**\n\t   * Get the mid point between this and p2.\n\t  \t */\n\t\n\t\t}, {\n\t\t\tkey: \"getMidPoint\",\n\t\t\tvalue: function getMidPoint(p2) {\n\t\t\t\treturn new Point((this.x + p2.x) / 2, (this.y + p2.y) / 2);\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"reverse\",\n\t\t\tvalue: function reverse() {\n\t\t\t\tthis.x = -this.x;\n\t\t\t\tthis.y = -this.y;\n\t\t\t\treturn this;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"equals\",\n\t\t\tvalue: function equals(p2) {\n\t\t\t\tif (!p2 || p2.constructor != Point) return false;\n\t\n\t\t\t\treturn this.x == p2.x && this.y == p2.y;\n\t\t\t}\n\t\n\t\t\t/**\n\t   * Reflect this point w.r.t. the rectangle.\n\t   * If vertical is true, it will reflect the point cross the vertical\n\t   * central line of the rectangle, otherwise reflect cross the horizontal\n\t   * central line.\n\t   *\n\t   * @param rect the rectangle\n\t   * @param vertical whether is vertical reflection or horizontal reflection.\n\t   */\n\t\n\t\t}, {\n\t\t\tkey: \"reflect\",\n\t\t\tvalue: function reflect(rect, vertical) {\n\t\t\t\tif (vertical) this.x = 2 * rect.x - this.x;else this.y = 2 * rect.y - this.y;\n\t\t\t\treturn this;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"toString\",\n\t\t\tvalue: function toString() {\n\t\t\t\treturn this.x + \",\" + this.y;\n\t\t\t}\n\t\t}]);\n\t\n\t\treturn Point;\n\t}();\n\t\n\tPoint.W = new Point(-1, 0);\n\tPoint.N = new Point(0, -1);\n\tPoint.S = new Point(0, 1);\n\tPoint.E = new Point(1, 0);\n\tPoint.NE = new Point(1, -1);\n\tPoint.NW = new Point(-1, -1);\n\tPoint.SE = new Point(1, 1);\n\tPoint.SW = new Point(-1, 1);\n\t\n\texports.default = Point;\n\n/***/ },\n/* 4 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t\tvalue: true\n\t});\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tvar _lodash = __webpack_require__(5);\n\t\n\tvar _lodash2 = _interopRequireDefault(_lodash);\n\t\n\tvar _Point = __webpack_require__(3);\n\t\n\tvar _Point2 = _interopRequireDefault(_Point);\n\t\n\tvar _Shape2 = __webpack_require__(6);\n\t\n\tvar _Shape3 = _interopRequireDefault(_Shape2);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\t\n\tfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\t\n\tvar Rectangle = function (_Shape) {\n\t\t_inherits(Rectangle, _Shape);\n\t\n\t\tfunction Rectangle() {\n\t\t\t_classCallCheck(this, Rectangle);\n\t\n\t\t\treturn _possibleConstructorReturn(this, Object.getPrototypeOf(Rectangle).apply(this, arguments));\n\t\t}\n\t\n\t\t_createClass(Rectangle, [{\n\t\t\tkey: \"contains\",\n\t\n\t\t\t/**\r\n\t   * Checks whether this rectangle contains a given point of a given rectangle\r\n\t   */\n\t\t\tvalue: function contains(el) {\n\t\t\t\tvar w = el.width || 0;\n\t\t\t\tvar h = el.height || 0;\n\t\t\t\tvar left = el.x - w / 2;\n\t\t\t\tvar right = el.x + w / 2;\n\t\t\t\tvar top = el.y - h / 2;\n\t\t\t\tvar bottom = el.y + h / 2;\n\t\t\t\treturn right <= this.right && left >= this.left && top >= this.top && bottom <= this.bottom;\n\t\t\t}\n\t\n\t\t\t/**\r\n\t   * Calcualte the distance to a point. 0 if this rectangle contains the point.\r\n\t   */\n\t\n\t\t}, {\n\t\t\tkey: \"distance\",\n\t\t\tvalue: function distance(pt) {\n\t\t\t\tif (this.contains(pt)) return 0;\n\t\n\t\t\t\tif (pt.x < this.left) {\n\t\t\t\t\tif (pt.y < this.top) return pt.distance(new _Point2.default(this.left, this.top));\n\t\t\t\t\tif (pt.y <= this.bottom) return this.left - pt.x;\n\t\t\t\t\treturn pt.distance(new _Point2.default(this.left, this.bottom));\n\t\t\t\t}\n\t\t\t\tif (pt.x <= this.right) {\n\t\t\t\t\tif (pt.y <= this.top) return this.top - pt.y;\n\t\t\t\t\treturn pt.y - this.bottom;\n\t\t\t\t}\n\t\t\t\tif (pt.y < this.top) return pt.distance(new _Point2.default(this.right, this.top));\n\t\t\t\tif (pt.y <= this.bottom) return pt.x - this.right;\n\t\t\t\treturn pt.distance(new _Point2.default(this.right, this.bottom));\n\t\t\t}\n\t\n\t\t\t/**\r\n\t   * Given two points, we want to detect whether the line joining the pts intersect\r\n\t   * with the rectangle or not. We assume only horizontal or vertical line segments.\r\n\t   *\r\n\t   * @return int the side of the intersection: -1: no intersection, 0: left, 1: top, 2: right, 3: bottom, 4: containment.\r\n\t   */\n\t\n\t\t}, {\n\t\t\tkey: \"detectIntersection\",\n\t\t\tvalue: function detectIntersection(pt1, pt2) {\n\t\t\t\tvar horizontal = pt1.y == pt2.y;\n\t\t\t\tvar contains1 = this.contains(pt1);\n\t\t\t\tvar contains2 = this.contains(pt2);\n\t\t\t\tif (contains1 && contains2) return 4;\n\t\t\t\tif (!contains1 && !contains2) {\n\t\t\t\t\tif (horizontal && pt1.y >= this.top && pt1.y <= this.bottom) {\n\t\t\t\t\t\tif (pt1.x < this.left && pt2.x > this.right) return 0;\n\t\t\t\t\t\tif (pt1.x > this.right && pt2.x < this.left) return 2;\n\t\t\t\t\t}\n\t\t\t\t\tif (!horizontal && pt1.x >= this.left && pt1.x <= this.right) {\n\t\t\t\t\t\tif (pt1.y < this.top && pt2.y > this.bottom) return 1;\n\t\t\t\t\t\tif (pt1.y > this.bottom && pt2.y < this.top) return 3;\n\t\t\t\t\t}\n\t\t\t\t\treturn -1;\n\t\t\t\t}\n\t\n\t\t\t\tvar outPt = contains1 ? pt2 : pt1;\n\t\t\t\tif (horizontal) {\n\t\t\t\t\tif (outPt.x > this.right) return 2;\n\t\t\t\t\treturn 0;\n\t\t\t\t} else {\n\t\t\t\t\tif (outPt.y < this.top) return 1;\n\t\t\t\t\treturn 3;\n\t\t\t\t}\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"toString\",\n\t\t\tvalue: function toString() {\n\t\t\t\treturn 'Rectangle:{x=' + this.x + ';y=' + this.y + ';width=' + this.width + ';height=' + this.height + '}';\n\t\t\t}\n\t\t}], [{\n\t\t\tkey: \"getPerimeter\",\n\t\t\tvalue: function getPerimeter(rect, pt) {\n\t\t\t\tvar orthogonal = arguments.length <= 2 || arguments[2] === undefined ? false : arguments[2];\n\t\n\t\t\t\tvar x = rect.x;\n\t\t\t\tvar y = rect.y;\n\t\t\t\tvar dx = pt.x - x;\n\t\t\t\tvar dy = pt.y - y;\n\t\t\t\tvar alpha = Math.atan2(dy, dx);\n\t\t\t\tvar p = new _Point2.default(0, 0);\n\t\t\t\tvar pi = Math.PI;\n\t\t\t\tvar pi2 = Math.PI / 2;\n\t\t\t\tvar beta = pi2 - alpha;\n\t\t\t\tvar t = Math.atan2(rect.height, rect.width);\n\t\n\t\t\t\tif (alpha < -pi + t || alpha > pi - t) {\n\t\t\t\t\t// Left edge\n\t\t\t\t\tp.x = rect.left;\n\t\t\t\t\tp.y = y - rect.width * Math.tan(alpha) / 2;\n\t\t\t\t} else if (alpha < -t) {\n\t\t\t\t\t// Top Edge\n\t\t\t\t\tp.y = rect.top;\n\t\t\t\t\tp.x = x - rect.height * Math.tan(beta) / 2;\n\t\t\t\t} else if (alpha < t) {\n\t\t\t\t\t// Right Edge\n\t\t\t\t\tp.x = rect.right;\n\t\t\t\t\tp.y = y + rect.width * Math.tan(alpha) / 2;\n\t\t\t\t} else {\n\t\t\t\t\t// Bottom Edge\n\t\t\t\t\tp.y = rect.bottom;\n\t\t\t\t\tp.x = x + rect.height * Math.tan(beta) / 2;\n\t\t\t\t}\n\t\n\t\t\t\tif (orthogonal) {\n\t\t\t\t\tif (alpha < -pi + t || alpha > pi - t) {\n\t\t\t\t\t\t// Left edge\n\t\t\t\t\t\tp.x = rect.left;\n\t\t\t\t\t\tp.y = y;\n\t\t\t\t\t} else if (alpha < -t) {\n\t\t\t\t\t\t// Top Edge\n\t\t\t\t\t\tp.y = rect.top;\n\t\t\t\t\t\tp.x = x;\n\t\t\t\t\t} else if (alpha < t) {\n\t\t\t\t\t\t// Right Edge\n\t\t\t\t\t\tp.x = rect.right;\n\t\t\t\t\t\tp.y = y;\n\t\t\t\t\t} else {\n\t\t\t\t\t\t// Bottom Edge\n\t\t\t\t\t\tp.y = rect.bottom;\n\t\t\t\t\t\tp.x = x;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\n\t\t\t\tvar dir = Rectangle.getDirection(rect, p, orthogonal);\n\t\t\t\treturn { point: p, direction: dir };\n\t\t\t}\n\t\n\t\t\t/**\r\n\t   * Return the bounding rectangle that contains p1 and p2\r\n\t   */\n\t\n\t\t}, {\n\t\t\tkey: \"getBoundingRectangle\",\n\t\t\tvalue: function getBoundingRectangle(pts, margin) {\n\t\t\t\tif (!pts || pts.length == 0) return null;\n\t\t\t\tmargin = margin || [0, 0, 0, 0];\n\t\t\t\tif (!_lodash2.default.isArray(margin)) margin = [margin, margin, margin, margin];\n\t\t\t\tvar min = [pts[0].x, pts[0].y];\n\t\t\t\tvar max = [pts[0].x, pts[0].y];\n\t\t\t\tfor (var i = 1; i < pts.length; i++) {\n\t\t\t\t\tvar p = pts[i];\n\t\t\t\t\tif (p.x < min[0]) {\n\t\t\t\t\t\tmin[0] = p.x;\n\t\t\t\t\t}\n\t\t\t\t\tif (p.y < min[1]) {\n\t\t\t\t\t\tmin[1] = p.y;\n\t\t\t\t\t}\n\t\t\t\t\tif (p.x > max[0]) {\n\t\t\t\t\t\tmax[0] = p.x;\n\t\t\t\t\t}\n\t\t\t\t\tif (p.y > max[1]) {\n\t\t\t\t\t\tmax[1] = p.y;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tmin[0] = min[0] - margin[0];\n\t\t\t\tmin[1] = min[1] - margin[1];\n\t\t\t\tmax[0] = max[0] + margin[2];\n\t\t\t\tmax[1] = max[1] + margin[3];\n\t\t\t\tvar w = Math.abs(max[0] - min[0]);\n\t\t\t\tvar h = Math.abs(max[1] - min[1]);\n\t\t\t\treturn new Rectangle(min[0] + w / 2, min[1] + h / 2, w, h);\n\t\t\t}\n\t\n\t\t\t/**\r\n\t   * Create a union of all the rectangles.\r\n\t   * @param rects\r\n\t   */\n\t\n\t\t}, {\n\t\t\tkey: \"union\",\n\t\t\tvalue: function union(rects) {\n\t\t\t\tvar minx = null,\n\t\t\t\t    miny = null,\n\t\t\t\t    maxx = -Infinity,\n\t\t\t\t    maxy = -Infinity;\n\t\t\t\t_lodash2.default.each(rects, function (rect) {\n\t\t\t\t\tminx = minx || rect.x;\n\t\t\t\t\tminy = miny || rect.y;\n\t\t\t\t\tminx = Math.min(minx, rect.x);\n\t\t\t\t\tminy = Math.min(miny, rect.y);\n\t\t\t\t\tmaxx = Math.max(maxx, rect.right());\n\t\t\t\t\tmaxy = Math.max(maxy, rect.bottom());\n\t\t\t\t});\n\t\t\t\tminx = minx || 0;\n\t\t\t\tminy = miny || 0;\n\t\t\t\treturn new Rectangle(minx, miny, maxx - minx, maxy - miny);\n\t\t\t}\n\t\n\t\t\t/**\r\n\t   * Returns the direction the point <i>p</i> is in relation to the given rectangle.\r\n\t   * Possible values are WEST (-1,0), EAST (1,0), NORTH (0,-1) and SOUTH (0,1) if orthogonal is true, otherwise return\r\n\t   * the direction connection the center of r and p.\r\n\t   * @param r\r\n\t   * @param p\r\n\t   * @param orthogonal\r\n\t   * @returns {Point|*}\r\n\t   */\n\t\n\t\t}, {\n\t\t\tkey: \"getDirection\",\n\t\t\tvalue: function getDirection(r, p) {\n\t\t\t\tvar orthogonal = arguments.length <= 2 || arguments[2] === undefined ? false : arguments[2];\n\t\n\t\t\t\tif (!orthogonal) return new _Point2.default(r.x, r.y).getDirection(new _Point2.default(p.x, p.y));\n\t\n\t\t\t\tvar i = void 0,\n\t\t\t\t    distance = Math.abs(r.left - p.x),\n\t\t\t\t    direction = _Point2.default.W;\n\t\n\t\t\t\ti = Math.abs(r.top - p.y);\n\t\t\t\tif (i <= distance) {\n\t\t\t\t\tdistance = i;\n\t\t\t\t\tdirection = _Point2.default.N;\n\t\t\t\t}\n\t\n\t\t\t\ti = Math.abs(r.bottom - p.y);\n\t\t\t\tif (i <= distance) {\n\t\t\t\t\tdistance = i;\n\t\t\t\t\tdirection = _Point2.default.S;\n\t\t\t\t}\n\t\n\t\t\t\ti = Math.abs(r.right - p.x);\n\t\t\t\tif (i < distance) {\n\t\t\t\t\tdirection = _Point2.default.E;\n\t\t\t\t}\n\t\n\t\t\t\treturn direction;\n\t\t\t}\n\t\t}]);\n\t\n\t\treturn Rectangle;\n\t}(_Shape3.default);\n\t\n\texports.default = Rectangle;\n\n/***/ },\n/* 5 */\n/***/ function(module, exports) {\n\n\tmodule.exports = __WEBPACK_EXTERNAL_MODULE_5__;\n\n/***/ },\n/* 6 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t\tvalue: true\n\t});\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tvar _lodash = __webpack_require__(5);\n\t\n\tvar _lodash2 = _interopRequireDefault(_lodash);\n\t\n\tvar _Point = __webpack_require__(3);\n\t\n\tvar _Point2 = _interopRequireDefault(_Point);\n\t\n\tvar _Rectangle = __webpack_require__(4);\n\t\n\tvar _Rectangle2 = _interopRequireDefault(_Rectangle);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tvar registry = {};\n\t\n\tvar Shape = function () {\n\t\tfunction Shape(x, y, width, height, config) {\n\t\t\t_classCallCheck(this, Shape);\n\t\n\t\t\tthis.x = x;\n\t\t\tthis.y = y;\n\t\t\tthis.width = width;\n\t\t\tthis.height = height;\n\t\t\t_lodash2.default.defaults(this, config, { x: 0, y: 0, width: 0, height: 0 });\n\t\t}\n\t\n\t\t/**\n\t  * Return the y-coord of the top side of this rectangle\n\t  */\n\t\n\t\n\t\t_createClass(Shape, [{\n\t\t\tkey: \"contains\",\n\t\t\tvalue: function contains(el) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\n\t\t\t/**\n\t   * This will generate n ports on the shape.\n\t   */\n\t\n\t\t}, {\n\t\t\tkey: \"getRegularPoints\",\n\t\t\tvalue: function getRegularPoints(n) {\n\t\t\t\treturn null;\n\t\t\t}\n\t\n\t\t\t/**\n\t   * Get the intersection between boundary of this shape and the line connecting (x,y) with the refPt.\n\t   * @param refPt\n\t   * @returns {null}\n\t   */\n\t\n\t\t}, {\n\t\t\tkey: \"getPerimeter\",\n\t\t\tvalue: function getPerimeter(refPt) {\n\t\t\t\tvar orthogonal = arguments.length <= 1 || arguments[1] === undefined ? false : arguments[1];\n\t\n\t\t\t\treturn this.constructor.getPerimeter(this, refPt, orthogonal);\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"render\",\n\t\t\tvalue: function render(view) {\n\t\t\t\tvar template = _lodash2.default.template(view.getTemplate(this.name, this));\n\t\t\t\treturn template(this);\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"top\",\n\t\t\tget: function get() {\n\t\t\t\treturn this.y - this.height / 2;\n\t\t\t}\n\t\n\t\t\t/**\n\t   * Returns the y-coordinate of the bottom of this Rectangle.\n\t   */\n\t\n\t\t}, {\n\t\t\tkey: \"bottom\",\n\t\t\tget: function get() {\n\t\t\t\treturn this.y + this.height / 2;\n\t\t\t}\n\t\n\t\t\t/**\n\t   * Return the x-coord of left side of this rectangle\n\t   */\n\t\n\t\t}, {\n\t\t\tkey: \"left\",\n\t\t\tget: function get() {\n\t\t\t\treturn this.x - this.width / 2;\n\t\t\t}\n\t\n\t\t\t/**\n\t   * Returns the x-coordinate of the right side of this Rectangle.\n\t   */\n\t\n\t\t}, {\n\t\t\tkey: \"right\",\n\t\t\tget: function get() {\n\t\t\t\treturn this.x + this.width / 2;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"center\",\n\t\t\tget: function get() {\n\t\t\t\treturn new _Point2.default(this.x, this.y);\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"bounds\",\n\t\t\tget: function get() {\n\t\t\t\treturn new _Rectangle2.default(this.x, this.y, this.width, this.height);\n\t\t\t}\n\t\t}], [{\n\t\t\tkey: \"getShape\",\n\t\t\tvalue: function getShape(name) {\n\t\t\t\treturn registry[name];\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"addShape\",\n\t\t\tvalue: function addShape(name, c) {\n\t\t\t\tregistry[name] = c;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"removeShape\",\n\t\t\tvalue: function removeShape(name) {\n\t\t\t\tdelete registry[name];\n\t\t\t}\n\t\t}]);\n\t\n\t\treturn Shape;\n\t}();\n\t\n\texports.default = Shape;\n\n/***/ },\n/* 7 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t\tvalue: true\n\t});\n\t\n\tvar _lodash = __webpack_require__(5);\n\t\n\tvar _lodash2 = _interopRequireDefault(_lodash);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\t/**\n\t * dom Utility functions\n\t */\n\texports.default = {\n\t\tisIE: function () {\n\t\t\tif (!window || !window.navigator || !navigator) return false;\n\t\t\tvar sAgent = window.navigator.userAgent;\n\t\t\tvar Idx = sAgent.indexOf(\"MSIE\");\n\t\n\t\t\t// If IE, return version number.\n\t\t\tif (Idx > 0) return parseInt(sAgent.substring(Idx + 5, sAgent.indexOf(\".\", Idx)));\n\t\n\t\t\t// If IE 11 then look for Updated user agent string.\n\t\t\telse if (!!navigator.userAgent.match(/Trident\\/7\\./)) return 11;else if (!!navigator.userAgent.match(/Edge\\//)) return \"Edge\";else return false;\n\t\t}(),\n\t\n\t\tisFireFox: function () {\n\t\t\t// InstallTrigger: Firefox's API to install add-ons\n\t\t\treturn typeof InstallTrigger !== 'undefined';\n\t\t}(),\n\t\n\t\tisChrome: function () {\n\t\t\tif (!window || !window.navigator || !navigator || navigator.userAgent.indexOf('Edge') >= 0) return false;\n\t\t\tvar raw = navigator.userAgent.match(/Chrom(e|ium)\\/([0-9]+)\\./);\n\t\t\treturn raw ? parseInt(raw[2], 10) : false;\n\t\t}(),\n\t\n\t\tisMac: function () {\n\t\t\tif (!window || !window.navigator || !navigator) return false;\n\t\t\treturn navigator.platform.toUpperCase().indexOf('MAC') >= 0;\n\t\t}(),\n\t\n\t\tisWindows: function () {\n\t\t\tif (!window || !window.navigator || !navigator) return false;\n\t\t\treturn navigator.appVersion.indexOf(\"Windows\") >= 0;\n\t\t}(),\n\t\n\t\tisLinux: function () {\n\t\t\tif (!window || !window.navigator || !navigator) return false;\n\t\t\treturn navigator.appVersion.indexOf(\"Linux\") >= 0;\n\t\t}(),\n\t\n\t\tcreateElement: function createElement(tag, attribs, styles, html) {\n\t\t\tvar el = document.createElement(tag);\n\t\t\tthis.setElement(el, attribs, styles);\n\t\t\tif (html) el.innerHTML = html;\n\t\t\treturn el;\n\t\t},\n\t\n\t\tcreateElementByString: function createElementByString(str) {\n\t\t\tvar temp = this.createElement('div', null, null, str);\n\t\t\treturn temp.childNodes;\n\t\t},\n\t\n\t\tsetElement: function setElement(el, attribs, styles) {\n\t\t\tif (attribs) {\n\t\t\t\t_lodash2.default.forEach(attribs, function (value, key) {\n\t\t\t\t\tel.setAttribute(key, value);\n\t\t\t\t});\n\t\t\t}\n\t\t\tif (styles) {\n\t\t\t\t_lodash2.default.forEach(styles, function (value, key) {\n\t\t\t\t\tel.style[key] = value;\n\t\t\t\t});\n\t\t\t}\n\t\t},\n\t\n\t\ttestElement: function testElement(node, method) {\n\t\t\treturn node && node.nodeType == 1 && (!method || method(node));\n\t\t},\n\t\n\t\tgetAncestorBy: function getAncestorBy(node, method) {\n\t\t\twhile (node = node.parentNode) {\n\t\t\t\tif (this.testElement(node, method)) return node;\n\t\t\t}return null;\n\t\t},\n\t\n\t\t/**\n\t  * Get the position of element relative to the context.\n\t  * @param el the element\n\t  * @param context\n\t  * @returns {*[]}\n\t  */\n\t\tgetPosition: function getPosition(el, context) {\n\t\t\tif (!context) context = document.body;\n\t\t\tvar elRect = el.getBoundingClientRect();\n\t\t\tvar contextRect = context.getBoundingClientRect();\n\t\n\t\t\treturn [elRect.left - contextRect.left, elRect.top - contextRect.top];\n\t\t},\n\t\tgetCenterPosition: function getCenterPosition(el, context) {\n\t\t\tif (!context) context = document.body;\n\t\t\tvar elRect = el.getBoundingClientRect();\n\t\t\tvar contextRect = context.getBoundingClientRect();\n\t\t\tvar w = elRect.right - elRect.left;\n\t\t\tvar h = elRect.bottom - elRect.top;\n\t\n\t\t\treturn [elRect.left - contextRect.left + w / 2, elRect.top - contextRect.top + h / 2];\n\t\t},\n\t\n\t\n\t\tmove: function move(el, x, y) {\n\t\t\tif (x) el.style.left = x + 'px';\n\t\t\tif (y) el.style.top = y + 'px';\n\t\t},\n\t\n\t\tgetSize: function getSize(el) {\n\t\t\tvar w = parseInt(el.style.offsetWidth, 10);\n\t\t\tvar h = parseInt(el.style.offsetHeight, 10);\n\t\t\treturn [w, h];\n\t\t},\n\t\n\t\tresize: function resize(el, w, h) {\n\t\t\tif (w) el.style.width = w + \"px\";\n\t\t\tif (h) el.style.height = h + 'px';\n\t\t},\n\t\n\t\tpreloadImages: function preloadImages(array) {\n\t\t\tif (!this.preloadImages.list) this.preloadImages.list = [];\n\t\t\tif (!this.preloadImages.loaded) this.preloadImages.loaded = {};\n\t\n\t\t\tvar list = this.preloadImages.list;\n\t\t\tvar img,\n\t\t\t    that = this;\n\t\t\tfor (var i = 0; i < array.length; i++) {\n\t\t\t\timg = new Image();\n\t\t\t\timg.onload = function () {\n\t\t\t\t\tvar index = list.indexOf(this);\n\t\t\t\t\tif (index !== -1) {\n\t\t\t\t\t\tthat.preloadImages.loaded[this.name] = { width: this.width, height: this.height };\n\t\t\t\t\t\t// remove image from the array once it's loaded\n\t\t\t\t\t\t// for memory consumption reasons\n\t\t\t\t\t\tlist.splice(index, 1);\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t\tlist.push(img);\n\t\t\t\timg.src = array[i];\n\t\t\t\timg.name = array[i];\n\t\t\t}\n\t\t},\n\t\n\t\t/**\n\t  * Get's the image's information given the url. Must be preloaded by calling the preloadImage function.\n\t  * @param src\n\t  */\n\t\tgetImageInfo: function getImageInfo(src) {\n\t\t\tif (this.preloadImages.loaded) {\n\t\t\t\treturn this.preloadImages.loaded[src];\n\t\t\t}\n\t\t\treturn null;\n\t\t},\n\t\n\t\tdownloadFile: function downloadFile(name, data) {\n\t\t\tif (!data) return;\n\t\t\tvar mime = data.match(/^data:([^;,]*)/)[1];\n\t\t\tif (name.indexOf('.') < 0) {\n\t\t\t\tif (!mime) mime = 'text/plain';\n\t\t\t\tif (mime == 'text/plain') name = name + '.txt';else {\n\t\t\t\t\tvar type = mime.split('/')[1];\n\t\t\t\t\tif (type.indexOf('+') > 0) type = type.split('+')[0];\n\t\t\t\t\tname = name + '.' + type;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (this.isIE) {\n\t\t\t\tvar encoded = data.indexOf(';base64') >= 0;\n\t\t\t\tif (encoded) data = atob(data.replace('data:' + mime + ';base64,', ''));else data = decodeURI(data.replace('data:' + mime + ',', ''));\n\t\t\t\tdata = this.GetBlob(data, mime);\n\t\t\t\tnavigator.msSaveBlob(data, name);\n\t\t\t} else {\n\t\t\t\tvar link = this.createElement('a', { href: data, download: name }, { display: \"none\" });\n\t\t\t\tdocument.body.appendChild(link);\n\t\t\t\tlink.click();\n\t\t\t\tlink.parentNode.removeChild(link);\n\t\t\t}\n\t\t},\n\t\n\t\t/**\n\t  * Convert b54 to blob. IE only\n\t  */\n\t\tGetBlob: function GetBlob(data, contentType, sliceSize) {\n\t\t\tcontentType = contentType || '';\n\t\t\tsliceSize = sliceSize || 512;\n\t\n\t\t\tvar byteArrays = [];\n\t\n\t\t\tfor (var offset = 0; offset < data.length; offset += sliceSize) {\n\t\t\t\tvar slice = data.slice(offset, offset + sliceSize);\n\t\n\t\t\t\tvar byteNumbers = new Array(slice.length);\n\t\t\t\tfor (var i = 0; i < slice.length; i++) {\n\t\t\t\t\tbyteNumbers[i] = slice.charCodeAt(i);\n\t\t\t\t}\n\t\t\t\tvar byteArray = new Uint8Array(byteNumbers);\n\t\t\t\tbyteArrays.push(byteArray);\n\t\t\t}\n\t\t\treturn new Blob(byteArrays, { type: contentType });\n\t\t},\n\t\n\t\topenImage: function openImage(name, image) {\n\t\t\tvar myWindow = window.open(\"\", \"_blank\", \"toolbar=yes, scrollbars=yes, resizable=yes, width=500, height=500\");\n\t\t\tvar myDocument = myWindow.document;\n\t\t\tvar img = myDocument.createElement(\"img\");\n\t\t\tthis.setElement(img, { src: image, name: name });\n\t\t\tmyDocument.body.appendChild(img);\n\t\t},\n\t\n\t\t/**\n\t  * Check whether the key event is from input, textarea or select.\n\t  * @param e  input event\n\t  */\n\t\teventFromInput: function eventFromInput(e) {\n\t\t\tvar tagName = e.target.tagName;\n\t\t\treturn tagName == 'INPUT' || tagName == 'TEXTAREA' || tagName == 'SELECT';\n\t\t}\n\t};\n\n/***/ },\n/* 8 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t\tvalue: true\n\t});\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tvar _lodash = __webpack_require__(5);\n\t\n\tvar _lodash2 = _interopRequireDefault(_lodash);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\t/**\n\t * A string buffer for fast string manipulation\n\t */\n\t\n\tvar StringBuffer = function () {\n\t\tfunction StringBuffer(str) {\n\t\t\t_classCallCheck(this, StringBuffer);\n\t\n\t\t\tthis.buffer = [];\n\t\t\tif (str) this.buffer.push(str);\n\t\t}\n\t\n\t\t_createClass(StringBuffer, [{\n\t\t\tkey: \"append\",\n\t\t\tvalue: function append(stuff) {\n\t\t\t\tif (_lodash2.default.isString(stuff)) this.buffer.push(stuff);else if (_lodash2.default.isArray(stuff)) this.buffer = this.buffer.concat(stuff);else this.buffer.push(\"\" + stuff);\n\t\t\t\treturn this;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"prepend\",\n\t\t\tvalue: function prepend(stuff) {\n\t\t\t\tif (_lodash2.default.isString(stuff)) this.buffer.splice(0, 0, stuff);else if (_lodash2.default.isArray(stuff)) this.buffer = stuff.concat(this.buffer);else this.buffer.splice(0, 0, \"\" + stuff);\n\t\t\t\treturn this;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"clear\",\n\t\t\tvalue: function clear() {\n\t\t\t\tthis.buffer = [];\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"removeLast\",\n\t\t\tvalue: function removeLast() {\n\t\t\t\tthis.buffer.pop();\n\t\t\t\treturn this;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"toString\",\n\t\t\tvalue: function toString(sep) {\n\t\t\t\tif (!sep) sep = '';\n\t\t\t\treturn this.buffer.join(sep);\n\t\t\t}\n\t\t}]);\n\t\n\t\treturn StringBuffer;\n\t}();\n\t\n\texports.default = StringBuffer;\n\n/***/ },\n/* 9 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t\tvalue: true\n\t});\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tvar _Point = __webpack_require__(3);\n\t\n\tvar _Point2 = _interopRequireDefault(_Point);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tvar Line = function () {\n\t\tfunction Line(start, end) {\n\t\t\t_classCallCheck(this, Line);\n\t\n\t\t\tthis.start = start;\n\t\t\tthis.end = end;\n\t\t}\n\t\n\t\t/**\n\t  * Calculate the length of this line\n\t  */\n\t\n\t\n\t\t_createClass(Line, [{\n\t\t\tkey: 'length',\n\t\t\tvalue: function length() {\n\t\t\t\treturn this.start.distance(this.end);\n\t\t\t}\n\t\n\t\t\t/**\n\t   * Calculate the distance of this line to the point.\n\t   */\n\t\n\t\t}, {\n\t\t\tkey: 'distance',\n\t\t\tvalue: function distance(pt) {\n\t\t\t\tvar x = this.start.distance(pt);\n\t\t\t\tif (x == 0) return 0;\n\t\n\t\t\t\tvar l = this.length();\n\t\t\t\tvar cosa = new _Point2.default((this.end.x - this.start.x) / l, (this.end.y - this.start.y) / l).dotProduct(new _Point2.default(pt.x / x, pt.y / x));\n\t\n\t\t\t\treturn x * Math.sqrt(1 - cosa * cosa);\n\t\t\t}\n\t\n\t\t\t/**\n\t   * Function: intersection\n\t   *\n\t   * Returns the intersection of two lines as an <mxPoint>.\n\t   *\n\t   * Parameters:\n\t   *\n\t   * x0 - X-coordinate of the first line's startpoint.\n\t   * y0 - X-coordinate of the first line's startpoint.\n\t   * x1 - X-coordinate of the first line's endpoint.\n\t   * y1 - Y-coordinate of the first line's endpoint.\n\t   * x2 - X-coordinate of the second line's startpoint.\n\t   * y2 - Y-coordinate of the second line's startpoint.\n\t   * x3 - X-coordinate of the second line's endpoint.\n\t   * y3 - Y-coordinate of the second line's endpoint.\n\t   */\n\t\n\t\t}, {\n\t\t\tkey: 'toString',\n\t\t\tvalue: function toString() {\n\t\t\t\treturn 'Line:{start=' + this.start + ';end=' + this.end + '}';\n\t\t\t}\n\t\t}], [{\n\t\t\tkey: 'intersection',\n\t\t\tvalue: function intersection(x0, y0, x1, y1, x2, y2, x3, y3) {\n\t\t\t\tvar denom = (y3 - y2) * (x1 - x0) - (x3 - x2) * (y1 - y0);\n\t\t\t\tvar nume_a = (x3 - x2) * (y0 - y2) - (y3 - y2) * (x0 - x2);\n\t\t\t\tvar nume_b = (x1 - x0) * (y0 - y2) - (y1 - y0) * (x0 - x2);\n\t\n\t\t\t\tvar ua = nume_a / denom;\n\t\t\t\tvar ub = nume_b / denom;\n\t\n\t\t\t\tif (ua >= 0.0 && ua <= 1.0 && ub >= 0.0 && ub <= 1.0) {\n\t\t\t\t\t// Get the intersection point\n\t\t\t\t\tvar intersectionX = x0 + ua * (x1 - x0);\n\t\t\t\t\tvar intersectionY = y0 + ua * (y1 - y0);\n\t\n\t\t\t\t\treturn new _Point2.default(intersectionX, intersectionY);\n\t\t\t\t}\n\t\n\t\t\t\t// No intersection\n\t\t\t\treturn null;\n\t\t\t}\n\t\t}]);\n\t\n\t\treturn Line;\n\t}();\n\t\n\texports.default = Line;\n\n/***/ },\n/* 10 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t\tvalue: true\n\t});\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tvar _Shape2 = __webpack_require__(6);\n\t\n\tvar _Shape3 = _interopRequireDefault(_Shape2);\n\t\n\tvar _Point = __webpack_require__(3);\n\t\n\tvar _Point2 = _interopRequireDefault(_Point);\n\t\n\tvar _Rectangle = __webpack_require__(4);\n\t\n\tvar _Rectangle2 = _interopRequireDefault(_Rectangle);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\t\n\tfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\t\n\tvar Ellipse = function (_Shape) {\n\t\t_inherits(Ellipse, _Shape);\n\t\n\t\tfunction Ellipse() {\n\t\t\t_classCallCheck(this, Ellipse);\n\t\n\t\t\treturn _possibleConstructorReturn(this, Object.getPrototypeOf(Ellipse).apply(this, arguments));\n\t\t}\n\t\n\t\t_createClass(Ellipse, [{\n\t\t\tkey: \"toString\",\n\t\t\tvalue: function toString() {\n\t\t\t\treturn 'Ellipse:{x=' + this.x + ';y=' + this.y + ';width=' + this.width + ';height=' + this.height + '}';\n\t\t\t}\n\t\t}], [{\n\t\t\tkey: \"getPerimeter\",\n\t\t\tvalue: function getPerimeter(rect, pt) {\n\t\t\t\tvar orthogonal = arguments.length <= 2 || arguments[2] === undefined ? false : arguments[2];\n\t\n\t\t\t\tvar a = rect.width / 2;\n\t\t\t\tvar b = rect.height / 2;\n\t\t\t\tvar cx = rect.x;\n\t\t\t\tvar cy = rect.y;\n\t\t\t\tvar px = pt.x;\n\t\t\t\tvar py = pt.y;\n\t\n\t\t\t\t// Calculates straight line equation through\n\t\t\t\t// point and ellipse center y = d * x + h\n\t\t\t\tvar dx = parseInt(px - cx);\n\t\t\t\tvar dy = parseInt(py - cy);\n\t\n\t\t\t\tvar tx, ty;\n\t\n\t\t\t\tif (dx == 0 && dy != 0) {\n\t\t\t\t\treturn new _Point2.default(cx, cy + b * dy / Math.abs(dy));\n\t\t\t\t} else if (dx == 0 && dy == 0) {\n\t\t\t\t\treturn new _Point2.default(px, py);\n\t\t\t\t}\n\t\n\t\t\t\t// Calculates intersection\n\t\t\t\tvar d = dy / dx;\n\t\t\t\tvar h = cy - d * cx;\n\t\t\t\tvar e = a * a * d * d + b * b;\n\t\t\t\tvar f = -2 * cx * e;\n\t\t\t\tvar g = a * a * d * d * cx * cx + b * b * cx * cx - a * a * b * b;\n\t\t\t\tvar det = Math.sqrt(f * f - 4 * e * g);\n\t\n\t\t\t\t// Two solutions (perimeter points)\n\t\t\t\tvar xout1 = (-f + det) / (2 * e);\n\t\t\t\tvar xout2 = (-f - det) / (2 * e);\n\t\t\t\tvar yout1 = d * xout1 + h;\n\t\t\t\tvar yout2 = d * xout2 + h;\n\t\t\t\tvar dist1 = Math.sqrt(Math.pow(xout1 - px, 2) + Math.pow(yout1 - py, 2));\n\t\t\t\tvar dist2 = Math.sqrt(Math.pow(xout2 - px, 2) + Math.pow(yout2 - py, 2));\n\t\n\t\t\t\t// Correct solution\n\t\t\t\tvar xout = 0;\n\t\t\t\tvar yout = 0;\n\t\n\t\t\t\tif (dist1 < dist2) {\n\t\t\t\t\txout = xout1;\n\t\t\t\t\tyout = yout1;\n\t\t\t\t} else {\n\t\t\t\t\txout = xout2;\n\t\t\t\t\tyout = yout2;\n\t\t\t\t}\n\t\n\t\t\t\tvar p = new _Point2.default(xout, yout);\n\t\t\t\tvar dir = _Rectangle2.default.getDirection(rect, p, orthogonal);\n\t\t\t\tif (orthogonal) {\n\t\t\t\t\tif (dir.x == -1) {\n\t\t\t\t\t\treturn { point: new _Point2.default(cx - a, cy), direction: dir };\n\t\t\t\t\t}\n\t\t\t\t\tif (dir.x == 1) {\n\t\t\t\t\t\treturn { point: new _Point2.default(cx + a, cy), direction: dir };\n\t\t\t\t\t}\n\t\t\t\t\tif (dir.y == -1) {\n\t\t\t\t\t\treturn { point: new _Point2.default(cx, cy - b), direction: dir };\n\t\t\t\t\t}\n\t\t\t\t\tif (dir.y == 1) {\n\t\t\t\t\t\treturn { point: new _Point2.default(cx, cy + b), direction: dir };\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn { point: p, direction: dir };\n\t\t\t}\n\t\t}]);\n\t\n\t\treturn Ellipse;\n\t}(_Shape3.default);\n\t\n\texports.default = Ellipse;\n\n/***/ },\n/* 11 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t\tvalue: true\n\t});\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tvar _lodash = __webpack_require__(5);\n\t\n\tvar _lodash2 = _interopRequireDefault(_lodash);\n\t\n\tvar _Point = __webpack_require__(3);\n\t\n\tvar _Point2 = _interopRequireDefault(_Point);\n\t\n\tvar _Utils = __webpack_require__(2);\n\t\n\tvar _Utils2 = _interopRequireDefault(_Utils);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\t\n\tfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tvar defaultConfig = {\n\t\ttype: \"direct\",\n\t\tshowGauge: true,\n\t\torthogonal: false\n\t};\n\t\n\tvar defaultGeometry = {\n\t\twidth: 0,\n\t\theight: 0,\n\t\tanchorX: 0,\n\t\tanchorY: 0,\n\t\toffsetX: 0,\n\t\toffsetY: 0\n\t};\n\t\n\tvar linkTypes = {};\n\t\n\tvar Link = function () {\n\t\tfunction Link(terminalVisual) {\n\t\t\tvar shapeConfig = arguments.length <= 1 || arguments[1] === undefined ? {} : arguments[1];\n\t\t\tvar startMarker = arguments.length <= 2 || arguments[2] === undefined ? null : arguments[2];\n\t\t\tvar endMarker = arguments.length <= 3 || arguments[3] === undefined ? null : arguments[3];\n\t\n\t\t\t_classCallCheck(this, Link);\n\t\n\t\t\tthis.start = terminalVisual[0].point;\n\t\t\tthis.end = terminalVisual[1].point;\n\t\t\tthis.startNormal = terminalVisual[0].direction;\n\t\t\tthis.endNormal = terminalVisual[1].direction;\n\t\t\tthis.startMarker = startMarker;\n\t\t\tthis.endMarker = endMarker;\n\t\t\t_lodash2.default.assign(this, shapeConfig);\n\t\t}\n\t\n\t\t_createClass(Link, [{\n\t\t\tkey: \"render\",\n\t\t\tvalue: function render(view) {\n\t\t\t\treturn view.renderLink(this);\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"getRelativePosition\",\n\t\n\t\n\t\t\t/**\r\n\t   * Calculate the position where to put modifiers or label..\r\n\t   *\r\n\t   * @param geometry: defines how far along the edge should the point be placed.\r\n\t   * @return *[] the relative position.\r\n\t   */\n\t\t\tvalue: function getRelativePosition(geometry) {\n\t\t\t\tif (_lodash2.default.isNumber(geometry)) geometry = { x: geometry };\n\t\t\t\tgeometry = _lodash2.default.defaults(geometry, defaultGeometry);\n\t\t\t\tvar p = geometry.x,\n\t\t\t\t    l = this.length;\n\t\t\t\tif (Math.abs(p) <= 1) p *= l;\n\t\t\t\tif (p < 0) p = l + p;\n\t\t\t\tif (p > l) p = l;\n\t\n\t\t\t\tvar points = this.points,\n\t\t\t\t    d = void 0,\n\t\t\t\t    point = void 0,\n\t\t\t\t    dir = void 0;\n\t\t\t\tfor (var i = 0; i < points.length - 1; i++) {\n\t\t\t\t\td = points[i].distance(points[i + 1]);\n\t\t\t\t\tif (p <= d) {\n\t\t\t\t\t\t// we've located the line segment.\n\t\t\t\t\t\tpoint = points[i].clone();\n\t\t\t\t\t\tdir = point.getDirection(points[i + 1]);\n\t\t\t\t\t\tpoint.translate(dir.getScaled(p));\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\tp -= d;\n\t\t\t\t}\n\t\n\t\t\t\t// return the last point.\n\t\t\t\tif (!point) point = points[points.length - 1];\n\t\t\t\treturn _Utils2.default.offsetPosition([point.x, point.y], geometry);\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"toString\",\n\t\t\tvalue: function toString() {\n\t\t\t\treturn 'Link';\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"points\",\n\t\t\tget: function get() {\n\t\t\t\treturn null;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"controlPts\",\n\t\t\tget: function get() {\n\t\t\t\treturn null;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"length\",\n\t\t\tget: function get() {\n\t\t\t\tvar points = this.points;\n\t\t\t\tvar i = void 0,\n\t\t\t\t    l = 0;\n\t\t\t\tfor (i = 0; i < points.length - 1; i++) {\n\t\t\t\t\tl += points[i].distance(points[i + 1]);\n\t\t\t\t}return l;\n\t\t\t}\n\t\t}], [{\n\t\t\tkey: \"getLink\",\n\t\t\tvalue: function getLink(terminalVisual) {\n\t\t\t\tvar shapeConfig = arguments.length <= 1 || arguments[1] === undefined ? {} : arguments[1];\n\t\t\t\tvar startMarker = arguments.length <= 2 || arguments[2] === undefined ? null : arguments[2];\n\t\t\t\tvar endMarker = arguments.length <= 3 || arguments[3] === undefined ? null : arguments[3];\n\t\n\t\t\t\tshapeConfig = _lodash2.default.defaultsDeep(shapeConfig, defaultConfig);\n\t\t\t\tvar linkClass = linkTypes[shapeConfig.type];\n\t\t\t\tif (linkClass) return new linkClass(terminalVisual, shapeConfig, startMarker, endMarker);\n\t\t\t\tconsole.log('link type not supported: ' + shapeConfig.type);\n\t\t\t\treturn null;\n\t\t\t}\n\t\t}]);\n\t\n\t\treturn Link;\n\t}();\n\t\n\tvar DirectLink = function (_Link) {\n\t\t_inherits(DirectLink, _Link);\n\t\n\t\tfunction DirectLink() {\n\t\t\t_classCallCheck(this, DirectLink);\n\t\n\t\t\treturn _possibleConstructorReturn(this, Object.getPrototypeOf(DirectLink).apply(this, arguments));\n\t\t}\n\t\n\t\t_createClass(DirectLink, [{\n\t\t\tkey: \"points\",\n\t\t\tget: function get() {\n\t\t\t\treturn [this.start, this.end];\n\t\t\t}\n\t\t}]);\n\t\n\t\treturn DirectLink;\n\t}(Link);\n\t\n\tvar BezierLink = function (_Link2) {\n\t\t_inherits(BezierLink, _Link2);\n\t\n\t\tfunction BezierLink() {\n\t\t\t_classCallCheck(this, BezierLink);\n\t\n\t\t\treturn _possibleConstructorReturn(this, Object.getPrototypeOf(BezierLink).apply(this, arguments));\n\t\t}\n\t\n\t\t_createClass(BezierLink, [{\n\t\t\tkey: \"getRelativePosition\",\n\t\t\tvalue: function getRelativePosition(geometry) {\n\t\t\t\tif (_lodash2.default.isNumber(geometry)) geometry = { x: geometry };\n\t\t\t\tgeometry = _lodash2.default.defaults(geometry, defaultGeometry);\n\t\t\t\tvar p = geometry.x,\n\t\t\t\t    l = this.length;\n\t\t\t\tif (Math.abs(p) > 1) p /= l;\n\t\t\t\tif (p < 0) p++;\n\t\t\t\tif (p > 1) p--;\n\t\n\t\t\t\tvar pts = this.points;\n\t\t\t\tvar ctrlpts = this.controlPts;\n\t\t\t\tvar p1 = pts[0];\n\t\t\t\tvar p2 = ctrlpts[1][0];\n\t\t\t\tvar p3 = ctrlpts[1][1];\n\t\t\t\tvar p4 = pts[1];\n\t\n\t\t\t\tvar point = [(1 - p) * (1 - p) * (1 - p) * p1.x + 3 * p * (1 - p) * (1 - p) * p2.x + 3 * p * p * (1 - p) * p3.x + p * p * p * p4.x, (1 - p) * (1 - p) * (1 - p) * p1.y + 3 * p * (1 - p) * (1 - p) * p2.y + 3 * p * p * (1 - p) * p3.y + p * p * p * p4.y];\n\t\t\t\treturn _Utils2.default.offsetPosition([point.x, point.y], geometry);\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"points\",\n\t\t\tget: function get() {\n\t\t\t\treturn [this.start, this.end];\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"controlPts\",\n\t\t\tget: function get() {\n\t\t\t\tvar s = this.points[0],\n\t\t\t\t    e = this.points[1];\n\t\t\t\tvar pts = [];\n\t\t\t\tpts[0] = null;\n\t\t\t\tpts[1] = [];\n\t\t\t\tif (this.startNormal.x == 0) {\n\t\t\t\t\tpts[1][0] = new _Point2.default(s.x, (s.y + e.y) / 2);\n\t\t\t\t} else {\n\t\t\t\t\tpts[1][0] = new _Point2.default((s.x + e.x) / 2, s.y);\n\t\t\t\t}\n\t\t\t\tif (this.endNormal.x == 0) {\n\t\t\t\t\tpts[1][1] = new _Point2.default(e.x, (s.y + e.y) / 2);\n\t\t\t\t} else {\n\t\t\t\t\tpts[1][1] = new _Point2.default((s.x + e.x) / 2, e.y);\n\t\t\t\t}\n\t\t\t\treturn pts;\n\t\t\t}\n\t\t}]);\n\t\n\t\treturn BezierLink;\n\t}(Link);\n\t\n\tvar EntityRelations = function (_Link3) {\n\t\t_inherits(EntityRelations, _Link3);\n\t\n\t\tfunction EntityRelations() {\n\t\t\t_classCallCheck(this, EntityRelations);\n\t\n\t\t\treturn _possibleConstructorReturn(this, Object.getPrototypeOf(EntityRelations).apply(this, arguments));\n\t\t}\n\t\n\t\t_createClass(EntityRelations, [{\n\t\t\tkey: \"points\",\n\t\t\tget: function get() {\n\t\t\t\tvar source = Port.getBounds(edge, true);\n\t\t\t\tvar target = Port.getBounds(edge, false);\n\t\t\t\tvar isSourceLeft = target.right() < source.x;\n\t\t\t\tvar isTargetLeft = source.right() < target.x;\n\t\t\t\tvar result = [];\n\t\n\t\t\t\tvar x0 = isSourceLeft ? source.x : source.x + source.width;\n\t\t\t\tvar y0 = source.getCenterY();\n\t\t\t\tresult.push(new _Point2.default(x0, y0));\n\t\n\t\t\t\tvar xe = isTargetLeft ? target.x : target.x + target.width;\n\t\t\t\tvar ye = target.getCenterY();\n\t\n\t\t\t\tvar seg = this.segment;\n\t\n\t\t\t\tvar dx = isSourceLeft ? -seg : seg;\n\t\t\t\tvar dep = new _Point2.default(x0 + dx, y0);\n\t\n\t\t\t\tdx = isTargetLeft ? -seg : seg;\n\t\t\t\tvar arr = new _Point2.default(xe + dx, ye);\n\t\n\t\t\t\t// Adds intermediate points if both go out on same side\n\t\t\t\tif (isSourceLeft == isTargetLeft) {\n\t\t\t\t\tvar x = isSourceLeft ? Math.min(x0, xe) - seg : Math.max(x0, xe) + seg;\n\t\n\t\t\t\t\tresult.push(new _Point2.default(x, y0));\n\t\t\t\t\tresult.push(new _Point2.default(x, ye));\n\t\t\t\t} else if (dep.x < arr.x == isSourceLeft) {\n\t\t\t\t\tvar midY = y0 + (ye - y0) / 2;\n\t\n\t\t\t\t\tresult.push(dep);\n\t\t\t\t\tresult.push(new _Point2.default(dep.x, midY));\n\t\t\t\t\tresult.push(new _Point2.default(arr.x, midY));\n\t\t\t\t\tresult.push(arr);\n\t\t\t\t} else {\n\t\t\t\t\tresult.push(dep);\n\t\t\t\t\tresult.push(arr);\n\t\t\t\t}\n\t\n\t\t\t\tresult.push(new _Point2.default(xe, ye));\n\t\t\t\treturn result;\n\t\t\t}\n\t\t}]);\n\t\n\t\treturn EntityRelations;\n\t}(Link);\n\t\n\tvar Manhattan = function (_Link4) {\n\t\t_inherits(Manhattan, _Link4);\n\t\n\t\tfunction Manhattan(terminalVisual, shapeConfig, startMarker, endMarker) {\n\t\t\t_classCallCheck(this, Manhattan);\n\t\n\t\t\tshapeConfig = _lodash2.default.defaults(shapeConfig, {\n\t\t\t\tMIN_BUFFER: 10,\n\t\t\t\tautoRoute: false,\n\t\t\t\tmaxChannelWidth: 100\n\t\t\t});\n\t\t\treturn _possibleConstructorReturn(this, Object.getPrototypeOf(Manhattan).call(this, terminalVisual, shapeConfig, startMarker, endMarker));\n\t\t}\n\t\n\t\t_createClass(Manhattan, [{\n\t\t\tkey: \"autoRoute\",\n\t\n\t\n\t\t\t/**\r\n\t   * Automatically route the connection to avoid intersections with other vertices.\r\n\t   */\n\t\t\tvalue: function autoRoute(pts, container, boxes, startBox, endBox) {\n\t\t\t\tvar side, side2, d, box, intersect, j;\n\t\t\t\tvar channel, channel2, pt, dir;\n\t\n\t\t\t\tvar startPadding = 0,\n\t\t\t\t    endPadding;\n\t\t\t\t// first get the start and end channel\n\t\t\t\tbox = boxes[endBox];\n\t\t\t\tpt = pts[pts.length - 2];\n\t\t\t\tif (pt.y < box.y) side = 1;else if (pt.y > box.y + box.height) side = 3;else if (pt.x < box.x) side = 0;else side = 2;\n\t\t\t\tchannel = _getChannel(container, endBox, boxes, side);\n\t\t\t\tendPadding = channel.horizontal ? (channel.right - channel.left) / 2 : (channel.bottom - channel.top) / 2;\n\t\n\t\t\t\tfor (var i = 0; i < pts.length - 1; i++) {\n\t\t\t\t\tif (pts[i + 1].x == pts[i].x && pts[i + 1].y == pts[i].y) continue;\n\t\t\t\t\tintersect = _getFirstIntersection(pts, i, boxes, startBox, endBox);\n\t\t\t\t\tif (!intersect) continue;\n\t\t\t\t\tj = intersect[0];\n\t\t\t\t\tside = intersect[1];\n\t\t\t\t\tbox = boxes[j];\n\t\t\t\t\tchannel = _getChannel(container, j, boxes, side);\n\t\t\t\t\tswitch (side) {\n\t\t\t\t\t\tcase 0:\n\t\t\t\t\t\tcase 2:\n\t\t\t\t\t\t\tpt = new _Point2.default((channel.right + channel.left) / 2, pts[i].y);\n\t\t\t\t\t\t\tdir = _getRouteTendency(pts, i, pt, box, side);\n\t\t\t\t\t\t\tside2 = dir < 0 ? 1 : 3;\n\t\t\t\t\t\t\tchannel2 = _getChannel(container, j, boxes, side2);\n\t\t\t\t\t\t\t// if the previous point is in the channel2, use that point instead of center of the channel.\n\t\t\t\t\t\t\tif (i > 1 && pts[i - 2].y == pts[i - 1].y && pts[i - 1].y > channel2.top && pts[i - 1].y < channel2.bottom) d = pts[i - 1].y - pt.y;else if (i < pts.length - 3 && pts[i + 2].y == pts[i + 3].y && pts[i + 2].y > channel2.top && pts[i + 2].y < channel2.bottom) d = pts[i + 2].y - pt.y;else d = (channel2.bottom + channel2.top) / 2 - pt.y;\n\t\t\t\t\t\t\t// check if we need this pt.\n\t\t\t\t\t\t\tif (side == 0 && pt.x <= pts[i].x || side == 2 && pt.x >= pts[i].x) pt = null;else if (i > 0) {\n\t\t\t\t\t\t\t\t// see if we can push the line out to where we started.\n\t\t\t\t\t\t\t\tif (!_hasIntersection([new _Point2.default(pts[i].x, pts[i].y), new _Point2.default(pts[i].x, pts[i].y + d), new _Point2.default(pt.x, pt.y + d)], boxes)) pt = null;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 1:\n\t\t\t\t\t\tcase 3:\n\t\t\t\t\t\t\tpt = new _Point2.default(pts[i].x, (channel.bottom + channel.top) / 2);\n\t\t\t\t\t\t\tdir = _getRouteTendency(pts, i, pt, box, side);\n\t\t\t\t\t\t\tside2 = dir < 0 ? 0 : 2;\n\t\t\t\t\t\t\tchannel2 = _getChannel(container, j, boxes, side2);\n\t\t\t\t\t\t\t// if the previous point is in the channel2, use that point instead of center of the channel.\n\t\t\t\t\t\t\tif (i > 1 && pts[i - 2].x == pts[i - 1].x && pts[i - 1].x > channel2.left && pts[i - 1].x < channel2.right) d = pts[i - 1].x - pt.x;else if (i < pts.length - 3 && pts[i + 2].x == pts[i + 3].x && pts[i + 2].x > channel2.left && pts[i + 2].x < channel2.right) d = pts[i + 2].x - pt.x;else d = (channel2.right + channel2.left) / 2 - pt.x;\n\t\t\t\t\t\t\t// check if we need this pt.\n\t\t\t\t\t\t\tif (side == 1 && pt.y <= pts[i].y || side == 3 && pt.y >= pts[i].y) pt = null;else if (i > 0) {\n\t\t\t\t\t\t\t\t// see if we can push the line out to where we started.\n\t\t\t\t\t\t\t\tif (!_hasIntersection([new _Point2.default(pts[i].x, pts[i].y), new _Point2.default(pts[i].x + d, pts[i].y), new _Point2.default(pt.x + d, pt.y)], boxes)) pt = null;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 4:\n\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\t\t\t\t\t// max points.\n\t\t\t\t\tif (i > 20) return;\n\t\t\t\t\tif (pt && (pt.x != pts[i].x || pt.y != pts[i].y)) {\n\t\t\t\t\t\tpts.splice(i + 1, 0, pt);\n\t\t\t\t\t\t_moveSegment(pts, i + 1, d, startPadding, endPadding);\n\t\t\t\t\t\ti++;\n\t\t\t\t\t} else _moveSegment(pts, i, d, startPadding, endPadding);\n\t\t\t\t}\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"_hasIntersection\",\n\t\t\tvalue: function _hasIntersection(pts, boxes) {\n\t\t\t\tfor (var i = 0; i < pts.length - 1; i++) {\n\t\t\t\t\tfor (var j = 0; j < boxes.length; j++) {\n\t\t\t\t\t\tif (boxes[j].detectIntersection(pts[i], pts[i + 1]) >= 0) return true;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"_getFirstIntersection\",\n\t\t\tvalue: function _getFirstIntersection(pts, i, boxes, startBox, endBox) {\n\t\t\t\tvar box,\n\t\t\t\t    side,\n\t\t\t\t    savedIndex = null,\n\t\t\t\t    savedSide = null;\n\t\t\t\tfor (var j = 0; j < boxes.length; j++) {\n\t\t\t\t\tif (i == 0 && j == startBox || i == pts.length - 2 && j == endBox) continue;\n\t\t\t\t\tbox = boxes[j];\n\t\t\t\t\tside = box.detectIntersection(pts[i], pts[i + 1]);\n\t\t\t\t\tif (side >= 0) {\n\t\t\t\t\t\tif (savedIndex == null) {\n\t\t\t\t\t\t\tsavedIndex = j;\n\t\t\t\t\t\t\tsavedSide = side;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tif (boxes[savedIndex].distance(pts[i]) > box.distance(pts[i])) {\n\t\t\t\t\t\t\t\tsavedIndex = j;\n\t\t\t\t\t\t\t\tsavedSide = side;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (savedIndex != null) return [savedIndex, savedSide];\n\t\t\t\treturn null;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"_getRouteTendency\",\n\t\t\tvalue: function _getRouteTendency(pts, i, breakPt, box, side) {\n\t\t\t\tvar dir;\n\t\t\t\tvar p;\n\t\t\t\tswitch (side) {\n\t\t\t\t\tcase 0:\n\t\t\t\t\tcase 2:\n\t\t\t\t\t\tp = \"y\";\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 1:\n\t\t\t\t\tcase 3:\n\t\t\t\t\t\tp = \"x\";\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\t//first try the breakpt.\n\t\t\t\tdir = _getRouteDirection(breakPt, pts[pts.length - 1])[p];\n\t\t\t\tif (dir == 0) {\n\t\t\t\t\tdir = -_getRouteDirection(pts[0], pts[pts.length - 1])[p];\n\t\t\t\t\tif (dir == 0) {\n\t\t\t\t\t\tif (breakPt[p] < box.getCenter()[p]) dir = -1;else dir = 1;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn dir;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"_getRouteDirection\",\n\t\t\tvalue: function _getRouteDirection(pt1, pt2) {\n\t\t\t\tif (pt1.x == pt2.x) {\n\t\t\t\t\tif (pt1.y < pt2.y) return _Point2.default.S;\n\t\t\t\t\treturn _Point2.default.N;\n\t\t\t\t} else if (pt1.y == pt2.y) {\n\t\t\t\t\tif (pt1.x < pt2.x) return _Point2.default.E;\n\t\t\t\t\treturn _Point2.default.W;\n\t\t\t\t} else if (pt1.x < pt2.x) {\n\t\t\t\t\tif (pt1.y < pt2.y) return _Point2.default.SE;\n\t\t\t\t\treturn _Point2.default.NE;\n\t\t\t\t} else {\n\t\t\t\t\tif (pt1.y < pt2.y) return _Point2.default.SW;\n\t\t\t\t\treturn _Point2.default.NW;\n\t\t\t\t}\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"_getChannel\",\n\t\t\tvalue: function _getChannel(container, index, boxes, side) {\n\t\t\t\tvar maxChannelWidth = this.maxChannelWidth;\n\t\t\t\tvar box1 = boxes[index],\n\t\t\t\t    box2;\n\t\t\t\tvar pt, i;\n\t\t\t\tvar channel = {},\n\t\t\t\t    l,\n\t\t\t\t    t,\n\t\t\t\t    b,\n\t\t\t\t    r;\n\t\t\t\tswitch (side) {\n\t\t\t\t\tcase 0:\n\t\t\t\t\t\tpt = box1.getLeft();\n\t\t\t\t\t\tchannel.right = pt.x;\n\t\t\t\t\t\tchannel.horizontal = false;\n\t\t\t\t\t\tfor (i = 0; i < boxes.length; i++) {\n\t\t\t\t\t\t\tif (i == index) continue;\n\t\t\t\t\t\t\tr = boxes[i].getRight().x;\n\t\t\t\t\t\t\tif (r >= pt.x) continue;\n\t\t\t\t\t\t\tif (!channel.left || channel.left < r) channel.left = r;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (!channel.left) {\n\t\t\t\t\t\t\tchannel.left = container.getLeft().x;\n\t\t\t\t\t\t\tif (channel.right - channel.left > maxChannelWidth) channel.left = channel.right - maxChannelWidth;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tfor (i = 0; i < boxes.length; i++) {\n\t\t\t\t\t\t\tif (i == index) continue;\n\t\t\t\t\t\t\tbox2 = boxes[i];\n\t\t\t\t\t\t\tb = box2.getBottom().y;\n\t\t\t\t\t\t\tt = box2.getTop().y;\n\t\t\t\t\t\t\tif (b < pt.y && box2.getRight() > channel.left && box2.getLeft() < channel.right) {\n\t\t\t\t\t\t\t\tif (!channel.top || channel.top < b) channel.top = b;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (t > pt.y && box2.getRight() > channel.left && box2.getLeft() < channel.right) {\n\t\t\t\t\t\t\t\tif (!channel.bottom || channel.bottom > t) channel.bottom = t;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (!channel.top) channel.top = container.getTop().y;\n\t\t\t\t\t\tif (!channel.bottom) channel.bottom = container.getBottom().y;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 1:\n\t\t\t\t\t\tpt = box1.getTop();\n\t\t\t\t\t\tchannel.horizontal = true;\n\t\t\t\t\t\tchannel.bottom = pt.y;\n\t\t\t\t\t\tfor (i = 0; i < boxes.length; i++) {\n\t\t\t\t\t\t\tif (i == index) continue;\n\t\t\t\t\t\t\tb = boxes[i].getBottom().y;\n\t\t\t\t\t\t\tif (b >= pt.y) continue;\n\t\t\t\t\t\t\tif (!channel.top || channel.top < b) channel.top = b;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (!channel.top) {\n\t\t\t\t\t\t\tchannel.top = container.getTop().y;\n\t\t\t\t\t\t\tif (channel.bottom - channel.top > maxChannelWidth) channel.top = channel.bottom - maxChannelWidth;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tfor (i = 0; i < boxes.length; i++) {\n\t\t\t\t\t\t\tif (i == index) continue;\n\t\t\t\t\t\t\tbox2 = boxes[i];\n\t\t\t\t\t\t\tl = box2.getLeft().x;\n\t\t\t\t\t\t\tr = box2.getRight().x;\n\t\t\t\t\t\t\tif (r < pt.x && box2.getBottom() > channel.top && box2.getTop() < channel.bottom) {\n\t\t\t\t\t\t\t\tif (!channel.left || channel.left < r) channel.left = r;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (l > pt.x && box2.getBottom() > channel.top && box2.getTop() < channel.bottom) {\n\t\t\t\t\t\t\t\tif (!channel.right || channel.right > l) channel.right = l;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (!channel.left) channel.left = container.getLeft().x;\n\t\t\t\t\t\tif (!channel.right) channel.right = container.getRight().x;\n\t\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 2:\n\t\t\t\t\t\tpt = box1.getRight();\n\t\t\t\t\t\tchannel.horizontal = false;\n\t\t\t\t\t\tchannel.left = pt.x;\n\t\t\t\t\t\tfor (i = 0; i < boxes.length; i++) {\n\t\t\t\t\t\t\tif (i == index) continue;\n\t\t\t\t\t\t\tl = boxes[i].getLeft().x;\n\t\t\t\t\t\t\tif (l <= pt.x) continue;\n\t\t\t\t\t\t\tif (!channel.right || channel.right > l) channel.right = l;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (!channel.right) {\n\t\t\t\t\t\t\tchannel.right = container.getRight().x;\n\t\t\t\t\t\t\tif (channel.right - channel.left > maxChannelWidth) channel.right = channel.left + maxChannelWidth;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tfor (i = 0; i < boxes.length; i++) {\n\t\t\t\t\t\t\tif (i == index) continue;\n\t\t\t\t\t\t\tbox2 = boxes[i];\n\t\t\t\t\t\t\tb = box2.getBottom().y;\n\t\t\t\t\t\t\tt = box2.getTop().y;\n\t\t\t\t\t\t\tif (b < pt.y && box2.getRight() > channel.left && box2.getLeft() < channel.right) {\n\t\t\t\t\t\t\t\tif (!channel.top || channel.top < b) channel.top = b;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (t > pt.y && box2.getRight() > channel.left && box2.getLeft() < channel.right) {\n\t\t\t\t\t\t\t\tif (!channel.bottom || channel.bottom > t) channel.bottom = t;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (!channel.top) channel.top = container.getTop().y;\n\t\t\t\t\t\tif (!channel.bottom) channel.bottom = container.getBottom().y;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 3:\n\t\t\t\t\t\tpt = box1.getBottom();\n\t\t\t\t\t\tchannel.horizontal = true;\n\t\t\t\t\t\tchannel.top = pt.y;\n\t\t\t\t\t\tfor (i = 0; i < boxes.length; i++) {\n\t\t\t\t\t\t\tif (i == index) continue;\n\t\t\t\t\t\t\tbox2 = boxes[i];\n\t\t\t\t\t\t\tif (box2.getTop().y <= pt.y) continue;\n\t\t\t\t\t\t\tif (!channel.bottom || channel.bottom > box2.getTop().y) channel.bottom = box2.getTop().y;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (!channel.bottom) {\n\t\t\t\t\t\t\tchannel.bottom = container.getBottom().y;\n\t\t\t\t\t\t\tif (channel.bottom - channel.top > maxChannelWidth) channel.bottom = channel.top + maxChannelWidth;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tfor (i = 0; i < boxes.length; i++) {\n\t\t\t\t\t\t\tif (i == index) continue;\n\t\t\t\t\t\t\tbox2 = boxes[i];\n\t\t\t\t\t\t\tl = box2.getLeft().x;\n\t\t\t\t\t\t\tr = box2.getRight().x;\n\t\t\t\t\t\t\tif (r < pt.x && box2.getBottom() > channel.top && box2.getTop() < channel.bottom) {\n\t\t\t\t\t\t\t\tif (!channel.left || channel.left < r) channel.left = r;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (l > pt.x && box2.getBottom() > channel.top && box2.getTop() < channel.bottom) {\n\t\t\t\t\t\t\t\tif (!channel.right || channel.right > l) channel.right = l;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (!channel.left) channel.left = container.getLeft().x;\n\t\t\t\t\t\tif (!channel.right) channel.right = container.getRight().x;\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\treturn channel;\n\t\t\t}\n\t\n\t\t\t/**\r\n\t   * Move a line segment by a specified distance.\r\n\t   *\r\n\t   * @param pts the list of points.\r\n\t   * @param i the index of the segment.\r\n\t   * @param d the distance to move.\r\n\t   * @param startPadding\r\n\t   * @param endPadding\r\n\t   */\n\t\n\t\t}, {\n\t\t\tkey: \"_moveSegment\",\n\t\t\tvalue: function (_moveSegment2) {\n\t\t\t\tfunction _moveSegment(_x7, _x8, _x9, _x10, _x11) {\n\t\t\t\t\treturn _moveSegment2.apply(this, arguments);\n\t\t\t\t}\n\t\n\t\t\t\t_moveSegment.toString = function () {\n\t\t\t\t\treturn _moveSegment2.toString();\n\t\t\t\t};\n\t\n\t\t\t\treturn _moveSegment;\n\t\t\t}(function (pts, i, d, startPadding, endPadding) {\n\t\t\t\t// first check if we need to add new line segments.\n\t\t\t\tvar dir, l, pt;\n\t\t\t\tif (i == 0) {\n\t\t\t\t\t// we need to break off the segment, since we can't change the starting point.\n\t\t\t\t\tdir = pts[0].getDirection(pts[1]);\n\t\t\t\t\tif (!startPadding) startPadding = this.MIN_BUFFER;\n\t\t\t\t\tl = Math.min(startPadding, pts[0].distance(pts[1]) / 2);\n\t\t\t\t\tpt = pts[0].getTranslated(dir.scale(l));\n\t\t\t\t\tpts.splice(1, 0, pt);\n\t\t\t\t\t_moveSegment(pts, i + 1, d);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tif (i == pts.length - 2) {\n\t\t\t\t\t// we need to break off the segment, since we can't change the end point.\n\t\t\t\t\tdir = pts[pts.length - 1].getDirection(pts[pts.length - 2]);\n\t\t\t\t\tif (!endPadding) endPadding = this.MIN_BUFFER;\n\t\t\t\t\tl = Math.min(endPadding, pts[pts.length - 1].distance(pts[pts.length - 2]) / 2);\n\t\t\t\t\tpt = pts[pts.length - 1].getTranslated(dir.scale(l));\n\t\t\t\t\tpts.splice(pts.length - 1, 0, pt);\n\t\t\t\t\t_moveSegment(pts, i, d);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\n\t\t\t\tif (pts[i].y == pts[i + 1].y) {\n\t\t\t\t\tif (i > 0 && pts[i - 1].y == pts[i].y) {\n\t\t\t\t\t\tpts.splice(i + 1, 0, pts[i].clone());\n\t\t\t\t\t\ti++;\n\t\t\t\t\t}\n\t\t\t\t\tif (i < pts.length - 2 && pts[i + 1].y == pts[i + 2].y) pts.splice(i + 1, 0, pts[i + 1].clone());\n\t\t\t\t\tpts[i].y += d;\n\t\t\t\t\tpts[i + 1].y += d;\n\t\t\t\t} else {\n\t\t\t\t\tif (i > 0 && pts[i - 1].x == pts[i].x) {\n\t\t\t\t\t\tpts.splice(i + 1, 0, pts[i].clone());\n\t\t\t\t\t\ti++;\n\t\t\t\t\t}\n\t\t\t\t\tif (i < pts.length - 2 && pts[i + 1].x == pts[i + 2].x) pts.splice(i + 1, 0, pts[i + 1].clone());\n\t\t\t\t\tpts[i].x += d;\n\t\t\t\t\tpts[i + 1].x += d;\n\t\t\t\t}\n\t\t\t})\n\t\n\t\t\t/**\r\n\t   * This method will merge the redundant segments.\r\n\t   */\n\t\n\t\t}, {\n\t\t\tkey: \"_mergeSegments\",\n\t\t\tvalue: function _mergeSegments(pts) {\n\t\t\t\tvar h1 = pts[pts.length - 1].y == pts[pts.length - 2].y;\n\t\t\t\tvar h2;\n\t\t\t\tfor (var i = pts.length - 2; i >= 1; i--) {\n\t\t\t\t\th2 = pts[i].y == pts[i - 1].y;\n\t\t\t\t\tif (h2 == h1 || pts[i].equals(pts[i - 1])) pts.splice(i, 1);else h1 = !h1;\n\t\t\t\t}\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"points\",\n\t\t\tget: function get() {\n\t\t\t\t//let pos = Manhattan.routeInternal(this.start, this.end, this.startNormal, this.endNormal, this.MIN_BUFFER);\n\t\t\t\t//pos = Manhattan.processPositions(this.start, this.end, pos, this.startNormal.x!=0);\n\t\t\t\tvar pos = Manhattan.findPositions(this.start, this.end, this.startNormal, this.endNormal, this.MIN_BUFFER);\n\t\t\t\tif (this.autoRoute) {\n\t\t\t\t\tthis._mergeSegments(pos);\n\t\t\t\t\tvar boxes = [],\n\t\t\t\t\t    node,\n\t\t\t\t\t    startBox,\n\t\t\t\t\t    endBox;\n\t\t\t\t\tvar container = edge.source.getCommonAncestor(edge.target);\n\t\t\t\t\tvar childNodes = container.getDescendants();\n\t\t\t\t\tvar index = 0;\n\t\t\t\t\tfor (var i = 0; i < childNodes.length; i++) {\n\t\t\t\t\t\tnode = childNodes[i];\n\t\t\t\t\t\t// Do not include source or target ancestors in routing.\n\t\t\t\t\t\tif (node.excludeFromRouting(edge) || node.isAncestor(edge.source) || node.isAncestor(edge.target)) continue;\n\t\t\t\t\t\tif (node == edge.source) startBox = index;\n\t\t\t\t\t\tif (node == edge.target) endBox = index;\n\t\t\t\t\t\tboxes.push(node.getBounds(document));\n\t\t\t\t\t\tindex++;\n\t\t\t\t\t}\n\t\t\t\t\tif (boxes.length > 1) this.autoRoute(pos, container.getBounds(document), boxes, startBox, endBox);\n\t\t\t\t}\n\t\t\t\tthis._mergeSegments(pos);\n\t\t\t\treturn pos;\n\t\t\t}\n\t\n\t\t\t//New function for finding route\n\t\n\t\t}], [{\n\t\t\tkey: \"findPositions\",\n\t\t\tvalue: function findPositions(start, end, startNormal, endNormal, buffer) {\n\t\t\t\tvar startBuffer = new _Point2.default(start.x + startNormal.x * buffer, start.y + startNormal.y * buffer);\n\t\t\t\tvar endBuffer = new _Point2.default(end.x + endNormal.x * buffer, end.y + endNormal.y * buffer);\n\t\t\t\tvar startBufferNormal, endBufferNormal;\n\t\t\t\tvar pts;\n\t\t\t\tif (startNormal.x != 0) {\n\t\t\t\t\tif ((endBuffer.x - startBuffer.x) / startNormal.x > 0) {\n\t\t\t\t\t\tstartBufferNormal = startNormal;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tstartBufferNormal = new _Point2.default(0, endBuffer.y >= startBuffer.y ? 1 : -1);\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tif ((endBuffer.y - startBuffer.y) / startNormal.y > 0) {\n\t\t\t\t\t\tstartBufferNormal = startNormal;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tstartBufferNormal = new _Point2.default(endBuffer.x >= startBuffer.x ? 1 : -1, 0);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (endNormal.x != 0) {\n\t\t\t\t\tif ((startBuffer.x - endBuffer.x) / endNormal.x > 0) {\n\t\t\t\t\t\tendBufferNormal = endNormal;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tendBufferNormal = new _Point2.default(0, startBuffer.y >= endBuffer.y ? 1 : -1);\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tif ((startBuffer.y - endBuffer.y) / endNormal.y > 0) {\n\t\t\t\t\t\tendBufferNormal = endNormal;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tendBufferNormal = new _Point2.default(startBuffer.x >= endBuffer.x ? 1 : -1, 0);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\n\t\t\t\tif (startBufferNormal.dotProduct(endBufferNormal) == 0) {\n\t\t\t\t\tvar middle = startBufferNormal.x == 0 ? new _Point2.default(startBuffer.x, endBuffer.y) : new _Point2.default(endBuffer.x, startBuffer.y);\n\t\t\t\t\tpts = [start, startBuffer, middle, endBuffer, end];\n\t\t\t\t} else if (startBufferNormal.dotProduct(endBufferNormal) < 0) {\n\t\t\t\t\tif (startBufferNormal.x == 0) {\n\t\t\t\t\t\tpts = [start, startBuffer, new _Point2.default(startBuffer.x, (start.y + end.y) / 2), new _Point2.default(endBuffer.x, (start.y + end.y) / 2), endBuffer, end];\n\t\t\t\t\t} else {\n\t\t\t\t\t\tpts = [start, startBuffer, new _Point2.default((start.x + end.x) / 2, startBuffer.y), new _Point2.default((start.x + end.x) / 2, endBuffer.y), endBuffer, end];\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tpts = [start, startBuffer, new _Point2.default(startBuffer.x + startBufferNormal.x * buffer, startBuffer.y + startBufferNormal.y * buffer), new _Point2.default(endBuffer.x + endBufferNormal.x * buffer, endBuffer.y + endBufferNormal.y * buffer), endBuffer, end];\n\t\t\t\t}\n\t\n\t\t\t\tvar prunePts = [];\n\t\t\t\tprunePts[0] = pts[0];\n\t\t\t\tfor (var i = 1; i < pts.length - 1; i++) {\n\t\t\t\t\tif (pts[i].x == pts[i - 1].x && pts[i].x == pts[i + 1].x || pts[i].y == pts[i - 1].y && pts[i].y == pts[i + 1].y) {\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\t\t\t\t\tprunePts.push(pts[i]);\n\t\t\t\t}\n\t\t\t\tprunePts.push(pts[pts.length - 1]);\n\t\t\t\treturn prunePts;\n\t\t\t}\n\t\n\t\t\t/**\r\n\t   * Make a route based on the start, end and startNormal and endNormal\r\n\t   * None of the parameters can be null\r\n\t   * TODO: This method could use some improvement...\r\n\t   */\n\t\n\t\t}, {\n\t\t\tkey: \"routeInternal\",\n\t\t\tvalue: function routeInternal(start, end, startNormal, endNormal, buffer) {\n\t\t\t\tvar direction = start.getDirection(end);\n\t\t\t\tvar average = start.getMidPoint(end);\n\t\t\t\tvar pos = [];\n\t\t\t\tvar startPositive = new _Point2.default(startNormal.x * startNormal.x, startNormal.y * startNormal.y);\n\t\t\t\tvar endPositive = new _Point2.default(endNormal.x * endNormal.x, endNormal.y * endNormal.y);\n\t\t\t\tvar horizontal = startNormal.x != 0;\n\t\t\t\tpos[0] = horizontal ? start.y : start.x;\n\t\n\t\t\t\thorizontal = !horizontal;\n\t\t\t\tvar i;\n\t\t\t\tif (startNormal.dotProduct(endNormal) == 0) {\n\t\t\t\t\tif (startNormal.dotProduct(direction) >= 0 && endNormal.dotProduct(direction) <= 0) {\n\t\t\t\t\t\t// 0\n\t\t\t\t\t} else {\n\t\t\t\t\t\t// 2\n\t\t\t\t\t\tif (startNormal.dotProduct(direction) < 0) i = startPositive.dotProduct(start.getTranslated(startNormal.getScaled(buffer)));else i = horizontal ? average.y : average.x;\n\t\n\t\t\t\t\t\tpos.push(i);\n\t\t\t\t\t\thorizontal = !horizontal;\n\t\n\t\t\t\t\t\tif (endNormal.dotProduct(direction) > 0) i = endPositive.dotProduct(end.getTranslated(endNormal.getScaled(buffer)));else i = horizontal ? average.y : average.x;\n\t\n\t\t\t\t\t\tpos.push(i);\n\t\t\t\t\t\thorizontal = !horizontal;\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tif (startNormal.dotProduct(endNormal) > 0) {\n\t\t\t\t\t\t//1\n\t\t\t\t\t\tif (startNormal.dotProduct(direction) >= 0) i = startPositive.dotProduct(start.getTranslated(startNormal.getScaled(buffer)));else i = endPositive.dotProduct(end.getTranslated(endNormal.getScaled(buffer)));\n\t\t\t\t\t\tpos.push(i);\n\t\t\t\t\t\thorizontal = !horizontal;\n\t\t\t\t\t} else {\n\t\t\t\t\t\t//3 or 1\n\t\t\t\t\t\tif (startNormal.dotProduct(direction) < 0) {\n\t\t\t\t\t\t\ti = startPositive.dotProduct(start.getTranslated(startNormal.getScaled(buffer)));\n\t\t\t\t\t\t\tpos.push(i);\n\t\t\t\t\t\t\thorizontal = !horizontal;\n\t\t\t\t\t\t}\n\t\n\t\t\t\t\t\ti = horizontal ? average.y : average.x;\n\t\t\t\t\t\tpos.push(i);\n\t\t\t\t\t\thorizontal = !horizontal;\n\t\n\t\t\t\t\t\tif (startNormal.dotProduct(direction) < 0) {\n\t\t\t\t\t\t\ti = endPositive.dotProduct(end.getTranslated(endNormal.getScaled(buffer)));\n\t\t\t\t\t\t\tpos.push(i);\n\t\t\t\t\t\t\thorizontal = !horizontal;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tpos.push(horizontal ? end.y : end.x);\n\t\n\t\t\t\treturn pos;\n\t\t\t}\n\t\n\t\t\t// Process the positions.\n\t\n\t\t}, {\n\t\t\tkey: \"processPositions\",\n\t\t\tvalue: function processPositions(start, end, positions, horizontal) {\n\t\t\t\tvar pos = [];\n\t\t\t\tpos[0] = horizontal ? start.x : start.y;\n\t\t\t\tvar i;\n\t\t\t\tfor (i = 0; i < positions.length; i++) {\n\t\t\t\t\tpos[i + 1] = positions[i];\n\t\t\t\t}\n\t\t\t\tpos.push(horizontal == (positions.length % 2 == 1) ? end.x : end.y);\n\t\n\t\t\t\tvar pts = [];\n\t\t\t\tpts[0] = start;\n\t\t\t\tvar p;\n\t\t\t\tvar current, prev;\n\t\t\t\tfor (i = 2; i < pos.length - 1; i++) {\n\t\t\t\t\thorizontal = !horizontal;\n\t\t\t\t\tprev = pos[i - 1];\n\t\t\t\t\tcurrent = pos[i];\n\t\t\t\t\tp = horizontal ? new _Point2.default(prev, current) : new _Point2.default(current, prev);\n\t\t\t\t\tpts.push(p);\n\t\t\t\t}\n\t\t\t\tpts.push(end);\n\t\t\t\treturn pts;\n\t\t\t}\n\t\t}]);\n\t\n\t\treturn Manhattan;\n\t}(Link);\n\t\n\tlinkTypes['direct'] = DirectLink;\n\tlinkTypes['bezier'] = BezierLink;\n\tlinkTypes['entityRelations'] = EntityRelations;\n\tlinkTypes['manhattan'] = Manhattan;\n\t\n\texports.default = Link;\n\n/***/ },\n/* 12 */\n/***/ function(module, exports, __webpack_require__) {\n\n\tvar __WEBPACK_AMD_DEFINE_FACTORY__, __WEBPACK_AMD_DEFINE_RESULT__;/*!\n\t  * Bean - copyright (c) Jacob Thornton 2011-2012\n\t  * https://github.com/fat/bean\n\t  * MIT license\n\t  */\n\t(function (name, context, definition) {\n\t  if (typeof module != 'undefined' && module.exports) module.exports = definition()\n\t  else if (true) !(__WEBPACK_AMD_DEFINE_FACTORY__ = (definition), __WEBPACK_AMD_DEFINE_RESULT__ = (typeof __WEBPACK_AMD_DEFINE_FACTORY__ === 'function' ? (__WEBPACK_AMD_DEFINE_FACTORY__.call(exports, __webpack_require__, exports, module)) : __WEBPACK_AMD_DEFINE_FACTORY__), __WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__))\n\t  else context[name] = definition()\n\t})('bean', this, function (name, context) {\n\t  name    = name    || 'bean'\n\t  context = context || this\n\t\n\t  var win            = window\n\t    , old            = context[name]\n\t    , namespaceRegex = /[^\\.]*(?=\\..*)\\.|.*/\n\t    , nameRegex      = /\\..*/\n\t    , addEvent       = 'addEventListener'\n\t    , removeEvent    = 'removeEventListener'\n\t    , doc            = document || {}\n\t    , root           = doc.documentElement || {}\n\t    , W3C_MODEL      = root[addEvent]\n\t    , eventSupport   = W3C_MODEL ? addEvent : 'attachEvent'\n\t    , ONE            = {} // singleton for quick matching making add() do one()\n\t\n\t    , slice          = Array.prototype.slice\n\t    , str2arr        = function (s, d) { return s.split(d || ' ') }\n\t    , isString       = function (o) { return typeof o == 'string' }\n\t    , isFunction     = function (o) { return typeof o == 'function' }\n\t\n\t      // events that we consider to be 'native', anything not in this list will\n\t      // be treated as a custom event\n\t    , standardNativeEvents =\n\t        'click dblclick mouseup mousedown contextmenu '                  + // mouse buttons\n\t        'mousewheel mousemultiwheel DOMMouseScroll '                     + // mouse wheel\n\t        'mouseover mouseout mousemove selectstart selectend '            + // mouse movement\n\t        'keydown keypress keyup '                                        + // keyboard\n\t        'orientationchange '                                             + // mobile\n\t        'focus blur change reset select submit '                         + // form elements\n\t        'load unload beforeunload resize move DOMContentLoaded '         + // window\n\t        'readystatechange message '                                      + // window\n\t        'error abort scroll '                                              // misc\n\t      // element.fireEvent('onXYZ'... is not forgiving if we try to fire an event\n\t      // that doesn't actually exist, so make sure we only do these on newer browsers\n\t    , w3cNativeEvents =\n\t        'show '                                                          + // mouse buttons\n\t        'input invalid '                                                 + // form elements\n\t        'touchstart touchmove touchend touchcancel '                     + // touch\n\t        'gesturestart gesturechange gestureend '                         + // gesture\n\t        'textinput '                                                     + // TextEvent\n\t        'readystatechange pageshow pagehide popstate '                   + // window\n\t        'hashchange offline online '                                     + // window\n\t        'afterprint beforeprint '                                        + // printing\n\t        'dragstart dragenter dragover dragleave drag drop dragend '      + // dnd\n\t        'loadstart progress suspend emptied stalled loadmetadata '       + // media\n\t        'loadeddata canplay canplaythrough playing waiting seeking '     + // media\n\t        'seeked ended durationchange timeupdate play pause ratechange '  + // media\n\t        'volumechange cuechange '                                        + // media\n\t        'checking noupdate downloading cached updateready obsolete '       // appcache\n\t\n\t      // convert to a hash for quick lookups\n\t    , nativeEvents = (function (hash, events, i) {\n\t        for (i = 0; i < events.length; i++) events[i] && (hash[events[i]] = 1)\n\t        return hash\n\t      }({}, str2arr(standardNativeEvents + (W3C_MODEL ? w3cNativeEvents : ''))))\n\t\n\t      // custom events are events that we *fake*, they are not provided natively but\n\t      // we can use native events to generate them\n\t    , customEvents = (function () {\n\t        var isAncestor = 'compareDocumentPosition' in root\n\t              ? function (element, container) {\n\t                  return container.compareDocumentPosition && (container.compareDocumentPosition(element) & 16) === 16\n\t                }\n\t              : 'contains' in root\n\t                ? function (element, container) {\n\t                    container = container.nodeType === 9 || container === window ? root : container\n\t                    return container !== element && container.contains(element)\n\t                  }\n\t                : function (element, container) {\n\t                    while (element = element.parentNode) if (element === container) return 1\n\t                    return 0\n\t                  }\n\t          , check = function (event) {\n\t              var related = event.relatedTarget\n\t              return !related\n\t                ? related == null\n\t                : (related !== this && related.prefix !== 'xul' && !/document/.test(this.toString())\n\t                    && !isAncestor(related, this))\n\t            }\n\t\n\t        return {\n\t            mouseenter: { base: 'mouseover', condition: check }\n\t          , mouseleave: { base: 'mouseout', condition: check }\n\t          , mousewheel: { base: /Firefox/.test(navigator.userAgent) ? 'DOMMouseScroll' : 'mousewheel' }\n\t        }\n\t      }())\n\t\n\t      // we provide a consistent Event object across browsers by taking the actual DOM\n\t      // event object and generating a new one from its properties.\n\t    , Event = (function () {\n\t            // a whitelist of properties (for different event types) tells us what to check for and copy\n\t        var commonProps  = str2arr('altKey attrChange attrName bubbles cancelable ctrlKey currentTarget ' +\n\t              'detail eventPhase getModifierState isTrusted metaKey relatedNode relatedTarget shiftKey '  +\n\t              'srcElement target timeStamp type view which propertyName')\n\t          , mouseProps   = commonProps.concat(str2arr('button buttons clientX clientY dataTransfer '      +\n\t              'fromElement offsetX offsetY pageX pageY screenX screenY toElement'))\n\t          , mouseWheelProps = mouseProps.concat(str2arr('wheelDelta wheelDeltaX wheelDeltaY wheelDeltaZ ' +\n\t              'axis')) // 'axis' is FF specific\n\t          , keyProps     = commonProps.concat(str2arr('char charCode key keyCode keyIdentifier '          +\n\t              'keyLocation location'))\n\t          , textProps    = commonProps.concat(str2arr('data'))\n\t          , touchProps   = commonProps.concat(str2arr('touches targetTouches changedTouches scale rotation'))\n\t          , messageProps = commonProps.concat(str2arr('data origin source'))\n\t          , stateProps   = commonProps.concat(str2arr('state'))\n\t          , overOutRegex = /over|out/\n\t            // some event types need special handling and some need special properties, do that all here\n\t          , typeFixers   = [\n\t                { // key events\n\t                    reg: /key/i\n\t                  , fix: function (event, newEvent) {\n\t                      newEvent.keyCode = event.keyCode || event.which\n\t                      return keyProps\n\t                    }\n\t                }\n\t              , { // mouse events\n\t                    reg: /click|mouse(?!(.*wheel|scroll))|menu|drag|drop/i\n\t                  , fix: function (event, newEvent, type) {\n\t                      newEvent.rightClick = event.which === 3 || event.button === 2\n\t                      newEvent.pos = { x: 0, y: 0 }\n\t                      if (event.pageX || event.pageY) {\n\t                        newEvent.clientX = event.pageX\n\t                        newEvent.clientY = event.pageY\n\t                      } else if (event.clientX || event.clientY) {\n\t                        newEvent.clientX = event.clientX + doc.body.scrollLeft + root.scrollLeft\n\t                        newEvent.clientY = event.clientY + doc.body.scrollTop + root.scrollTop\n\t                      }\n\t                      if (overOutRegex.test(type)) {\n\t                        newEvent.relatedTarget = event.relatedTarget\n\t                          || event[(type == 'mouseover' ? 'from' : 'to') + 'Element']\n\t                      }\n\t                      return mouseProps\n\t                    }\n\t                }\n\t              , { // mouse wheel events\n\t                    reg: /mouse.*(wheel|scroll)/i\n\t                  , fix: function () { return mouseWheelProps }\n\t                }\n\t              , { // TextEvent\n\t                    reg: /^text/i\n\t                  , fix: function () { return textProps }\n\t                }\n\t              , { // touch and gesture events\n\t                    reg: /^touch|^gesture/i\n\t                  , fix: function () { return touchProps }\n\t                }\n\t              , { // message events\n\t                    reg: /^message$/i\n\t                  , fix: function () { return messageProps }\n\t                }\n\t              , { // popstate events\n\t                    reg: /^popstate$/i\n\t                  , fix: function () { return stateProps }\n\t                }\n\t              , { // everything else\n\t                    reg: /.*/\n\t                  , fix: function () { return commonProps }\n\t                }\n\t            ]\n\t          , typeFixerMap = {} // used to map event types to fixer functions (above), a basic cache mechanism\n\t\n\t          , Event = function (event, element, isNative) {\n\t              if (!arguments.length) return\n\t              event = event || ((element.ownerDocument || element.document || element).parentWindow || win).event\n\t              this.originalEvent = event\n\t              this.isNative       = isNative\n\t              this.isBean         = true\n\t\n\t              if (!event) return\n\t\n\t              var type   = event.type\n\t                , target = event.target || event.srcElement\n\t                , i, l, p, props, fixer\n\t\n\t              this.target = target && target.nodeType === 3 ? target.parentNode : target\n\t\n\t              if (isNative) { // we only need basic augmentation on custom events, the rest expensive & pointless\n\t                fixer = typeFixerMap[type]\n\t                if (!fixer) { // haven't encountered this event type before, map a fixer function for it\n\t                  for (i = 0, l = typeFixers.length; i < l; i++) {\n\t                    if (typeFixers[i].reg.test(type)) { // guaranteed to match at least one, last is .*\n\t                      typeFixerMap[type] = fixer = typeFixers[i].fix\n\t                      break\n\t                    }\n\t                  }\n\t                }\n\t\n\t                props = fixer(event, this, type)\n\t                for (i = props.length; i--;) {\n\t                  if (!((p = props[i]) in this) && p in event) this[p] = event[p]\n\t                }\n\t              }\n\t            }\n\t\n\t        // preventDefault() and stopPropagation() are a consistent interface to those functions\n\t        // on the DOM, stop() is an alias for both of them together\n\t        Event.prototype.preventDefault = function () {\n\t          if (this.originalEvent.preventDefault) this.originalEvent.preventDefault()\n\t          else this.originalEvent.returnValue = false\n\t        }\n\t        Event.prototype.stopPropagation = function () {\n\t          if (this.originalEvent.stopPropagation) this.originalEvent.stopPropagation()\n\t          else this.originalEvent.cancelBubble = true\n\t        }\n\t        Event.prototype.stop = function () {\n\t          this.preventDefault()\n\t          this.stopPropagation()\n\t          this.stopped = true\n\t        }\n\t        // stopImmediatePropagation() has to be handled internally because we manage the event list for\n\t        // each element\n\t        // note that originalElement may be a Bean#Event object in some situations\n\t        Event.prototype.stopImmediatePropagation = function () {\n\t          if (this.originalEvent.stopImmediatePropagation) this.originalEvent.stopImmediatePropagation()\n\t          this.isImmediatePropagationStopped = function () { return true }\n\t        }\n\t        Event.prototype.isImmediatePropagationStopped = function () {\n\t          return this.originalEvent.isImmediatePropagationStopped && this.originalEvent.isImmediatePropagationStopped()\n\t        }\n\t        Event.prototype.clone = function (currentTarget) {\n\t          //TODO: this is ripe for optimisation, new events are *expensive*\n\t          // improving this will speed up delegated events\n\t          var ne = new Event(this, this.element, this.isNative)\n\t          ne.currentTarget = currentTarget\n\t          return ne\n\t        }\n\t\n\t        return Event\n\t      }())\n\t\n\t      // if we're in old IE we can't do onpropertychange on doc or win so we use doc.documentElement for both\n\t    , targetElement = function (element, isNative) {\n\t        return !W3C_MODEL && !isNative && (element === doc || element === win) ? root : element\n\t      }\n\t\n\t      /**\n\t        * Bean maintains an internal registry for event listeners. We don't touch elements, objects\n\t        * or functions to identify them, instead we store everything in the registry.\n\t        * Each event listener has a RegEntry object, we have one 'registry' for the whole instance.\n\t        */\n\t    , RegEntry = (function () {\n\t        // each handler is wrapped so we can handle delegation and custom events\n\t        var wrappedHandler = function (element, fn, condition, args) {\n\t            var call = function (event, eargs) {\n\t                  return fn.apply(element, args ? slice.call(eargs, event ? 0 : 1).concat(args) : eargs)\n\t                }\n\t              , findTarget = function (event, eventElement) {\n\t                  return fn.__beanDel ? fn.__beanDel.ft(event.target, element) : eventElement\n\t                }\n\t              , handler = condition\n\t                  ? function (event) {\n\t                      var target = findTarget(event, this) // deleated event\n\t                      if (condition.apply(target, arguments)) {\n\t                        if (event) event.currentTarget = target\n\t                        return call(event, arguments)\n\t                      }\n\t                    }\n\t                  : function (event) {\n\t                      if (fn.__beanDel) event = event.clone(findTarget(event)) // delegated event, fix the fix\n\t                      return call(event, arguments)\n\t                    }\n\t            handler.__beanDel = fn.__beanDel\n\t            return handler\n\t          }\n\t\n\t        , RegEntry = function (element, type, handler, original, namespaces, args, root) {\n\t            var customType     = customEvents[type]\n\t              , isNative\n\t\n\t            if (type == 'unload') {\n\t              // self clean-up\n\t              handler = once(removeListener, element, type, handler, original)\n\t            }\n\t\n\t            if (customType) {\n\t              if (customType.condition) {\n\t                handler = wrappedHandler(element, handler, customType.condition, args)\n\t              }\n\t              type = customType.base || type\n\t            }\n\t\n\t            this.isNative      = isNative = nativeEvents[type] && !!element[eventSupport]\n\t            this.customType    = !W3C_MODEL && !isNative && type\n\t            this.element       = element\n\t            this.type          = type\n\t            this.original      = original\n\t            this.namespaces    = namespaces\n\t            this.eventType     = W3C_MODEL || isNative ? type : 'propertychange'\n\t            this.target        = targetElement(element, isNative)\n\t            this[eventSupport] = !!this.target[eventSupport]\n\t            this.root          = root\n\t            this.handler       = wrappedHandler(element, handler, null, args)\n\t          }\n\t\n\t        // given a list of namespaces, is our entry in any of them?\n\t        RegEntry.prototype.inNamespaces = function (checkNamespaces) {\n\t          var i, j, c = 0\n\t          if (!checkNamespaces) return true\n\t          if (!this.namespaces) return false\n\t          for (i = checkNamespaces.length; i--;) {\n\t            for (j = this.namespaces.length; j--;) {\n\t              if (checkNamespaces[i] == this.namespaces[j]) c++\n\t            }\n\t          }\n\t          return checkNamespaces.length === c\n\t        }\n\t\n\t        // match by element, original fn (opt), handler fn (opt)\n\t        RegEntry.prototype.matches = function (checkElement, checkOriginal, checkHandler) {\n\t          return this.element === checkElement &&\n\t            (!checkOriginal || this.original === checkOriginal) &&\n\t            (!checkHandler || this.handler === checkHandler)\n\t        }\n\t\n\t        return RegEntry\n\t      }())\n\t\n\t    , registry = (function () {\n\t        // our map stores arrays by event type, just because it's better than storing\n\t        // everything in a single array.\n\t        // uses '$' as a prefix for the keys for safety and 'r' as a special prefix for\n\t        // rootListeners so we can look them up fast\n\t        var map = {}\n\t\n\t          // generic functional search of our registry for matching listeners,\n\t          // `fn` returns false to break out of the loop\n\t          , forAll = function (element, type, original, handler, root, fn) {\n\t              var pfx = root ? 'r' : '$'\n\t              if (!type || type == '*') {\n\t                // search the whole registry\n\t                for (var t in map) {\n\t                  if (t.charAt(0) == pfx) {\n\t                    forAll(element, t.substr(1), original, handler, root, fn)\n\t                  }\n\t                }\n\t              } else {\n\t                var i = 0, l, list = map[pfx + type], all = element == '*'\n\t                if (!list) return\n\t                for (l = list.length; i < l; i++) {\n\t                  if ((all || list[i].matches(element, original, handler)) && !fn(list[i], list, i, type)) return\n\t                }\n\t              }\n\t            }\n\t\n\t          , has = function (element, type, original, root) {\n\t              // we're not using forAll here simply because it's a bit slower and this\n\t              // needs to be fast\n\t              var i, list = map[(root ? 'r' : '$') + type]\n\t              if (list) {\n\t                for (i = list.length; i--;) {\n\t                  if (!list[i].root && list[i].matches(element, original, null)) return true\n\t                }\n\t              }\n\t              return false\n\t            }\n\t\n\t          , get = function (element, type, original, root) {\n\t              var entries = []\n\t              forAll(element, type, original, null, root, function (entry) {\n\t                return entries.push(entry)\n\t              })\n\t              return entries\n\t            }\n\t\n\t          , put = function (entry) {\n\t              var has = !entry.root && !this.has(entry.element, entry.type, null, false)\n\t                , key = (entry.root ? 'r' : '$') + entry.type\n\t              ;(map[key] || (map[key] = [])).push(entry)\n\t              return has\n\t            }\n\t\n\t          , del = function (entry) {\n\t              forAll(entry.element, entry.type, null, entry.handler, entry.root, function (entry, list, i) {\n\t                list.splice(i, 1)\n\t                entry.removed = true\n\t                if (list.length === 0) delete map[(entry.root ? 'r' : '$') + entry.type]\n\t                return false\n\t              })\n\t            }\n\t\n\t            // dump all entries, used for onunload\n\t          , entries = function () {\n\t              var t, entries = []\n\t              for (t in map) {\n\t                if (t.charAt(0) == '$') entries = entries.concat(map[t])\n\t              }\n\t              return entries\n\t            }\n\t\n\t        return { has: has, get: get, put: put, del: del, entries: entries }\n\t      }())\n\t\n\t      // we need a selector engine for delegated events, use querySelectorAll if it exists\n\t      // but for older browsers we need Qwery, Sizzle or similar\n\t    , selectorEngine\n\t    , setSelectorEngine = function (e) {\n\t        if (!arguments.length) {\n\t          selectorEngine = doc.querySelectorAll\n\t            ? function (s, r) {\n\t                return r.querySelectorAll(s)\n\t              }\n\t            : function () {\n\t                throw new Error('Bean: No selector engine installed') // eeek\n\t              }\n\t        } else {\n\t          selectorEngine = e\n\t        }\n\t      }\n\t\n\t      // we attach this listener to each DOM event that we need to listen to, only once\n\t      // per event type per DOM element\n\t    , rootListener = function (event, type) {\n\t        if (!W3C_MODEL && type && event && event.propertyName != '_on' + type) return\n\t\n\t        var listeners = registry.get(this, type || event.type, null, false)\n\t          , l = listeners.length\n\t          , i = 0\n\t\n\t        event = new Event(event, this, true)\n\t        if (type) event.type = type\n\t\n\t        // iterate through all handlers registered for this type, calling them unless they have\n\t        // been removed by a previous handler or stopImmediatePropagation() has been called\n\t        for (; i < l && !event.isImmediatePropagationStopped(); i++) {\n\t          if (!listeners[i].removed) listeners[i].handler.call(this, event)\n\t        }\n\t      }\n\t\n\t      // add and remove listeners to DOM elements\n\t    , listener = W3C_MODEL\n\t        ? function (element, type, add) {\n\t            // new browsers\n\t            element[add ? addEvent : removeEvent](type, rootListener, false)\n\t          }\n\t        : function (element, type, add, custom) {\n\t            // IE8 and below, use attachEvent/detachEvent and we have to piggy-back propertychange events\n\t            // to simulate event bubbling etc.\n\t            var entry\n\t            if (add) {\n\t              registry.put(entry = new RegEntry(\n\t                  element\n\t                , custom || type\n\t                , function (event) { // handler\n\t                    rootListener.call(element, event, custom)\n\t                  }\n\t                , rootListener\n\t                , null\n\t                , null\n\t                , true // is root\n\t              ))\n\t              if (custom && element['_on' + custom] == null) element['_on' + custom] = 0\n\t              entry.target.attachEvent('on' + entry.eventType, entry.handler)\n\t            } else {\n\t              entry = registry.get(element, custom || type, rootListener, true)[0]\n\t              if (entry) {\n\t                entry.target.detachEvent('on' + entry.eventType, entry.handler)\n\t                registry.del(entry)\n\t              }\n\t            }\n\t          }\n\t\n\t    , once = function (rm, element, type, fn, originalFn) {\n\t        // wrap the handler in a handler that does a remove as well\n\t        return function () {\n\t          fn.apply(this, arguments)\n\t          rm(element, type, originalFn)\n\t        }\n\t      }\n\t\n\t    , removeListener = function (element, orgType, handler, namespaces) {\n\t        var type     = orgType && orgType.replace(nameRegex, '')\n\t          , handlers = registry.get(element, type, null, false)\n\t          , removed  = {}\n\t          , i, l\n\t\n\t        for (i = 0, l = handlers.length; i < l; i++) {\n\t          if ((!handler || handlers[i].original === handler) && handlers[i].inNamespaces(namespaces)) {\n\t            // TODO: this is problematic, we have a registry.get() and registry.del() that\n\t            // both do registry searches so we waste cycles doing this. Needs to be rolled into\n\t            // a single registry.forAll(fn) that removes while finding, but the catch is that\n\t            // we'll be splicing the arrays that we're iterating over. Needs extra tests to\n\t            // make sure we don't screw it up. @rvagg\n\t            registry.del(handlers[i])\n\t            if (!removed[handlers[i].eventType] && handlers[i][eventSupport])\n\t              removed[handlers[i].eventType] = { t: handlers[i].eventType, c: handlers[i].type }\n\t          }\n\t        }\n\t        // check each type/element for removed listeners and remove the rootListener where it's no longer needed\n\t        for (i in removed) {\n\t          if (!registry.has(element, removed[i].t, null, false)) {\n\t            // last listener of this type, remove the rootListener\n\t            listener(element, removed[i].t, false, removed[i].c)\n\t          }\n\t        }\n\t      }\n\t\n\t      // set up a delegate helper using the given selector, wrap the handler function\n\t    , delegate = function (selector, fn) {\n\t        //TODO: findTarget (therefore $) is called twice, once for match and once for\n\t        // setting e.currentTarget, fix this so it's only needed once\n\t        var findTarget = function (target, root) {\n\t              var i, array = isString(selector) ? selectorEngine(selector, root) : selector\n\t              for (; target && target !== root; target = target.parentNode) {\n\t                for (i = array.length; i--;) {\n\t                  if (array[i] === target) return target\n\t                }\n\t              }\n\t            }\n\t          , handler = function (e) {\n\t              var match = findTarget(e.target, this)\n\t              if (match) fn.apply(match, arguments)\n\t            }\n\t\n\t        // __beanDel isn't pleasant but it's a private function, not exposed outside of Bean\n\t        handler.__beanDel = {\n\t            ft       : findTarget // attach it here for customEvents to use too\n\t          , selector : selector\n\t        }\n\t        return handler\n\t      }\n\t\n\t    , fireListener = W3C_MODEL ? function (isNative, type, element) {\n\t        // modern browsers, do a proper dispatchEvent()\n\t        var evt = doc.createEvent(isNative ? 'HTMLEvents' : 'UIEvents')\n\t        evt[isNative ? 'initEvent' : 'initUIEvent'](type, true, true, win, 1)\n\t        element.dispatchEvent(evt)\n\t      } : function (isNative, type, element) {\n\t        // old browser use onpropertychange, just increment a custom property to trigger the event\n\t        element = targetElement(element, isNative)\n\t        isNative ? element.fireEvent('on' + type, doc.createEventObject()) : element['_on' + type]++\n\t      }\n\t\n\t      /**\n\t        * Public API: off(), on(), add(), (remove()), one(), fire(), clone()\n\t        */\n\t\n\t      /**\n\t        * off(element[, eventType(s)[, handler ]])\n\t        */\n\t    , off = function (element, typeSpec, fn) {\n\t        var isTypeStr = isString(typeSpec)\n\t          , k, type, namespaces, i\n\t\n\t        if (isTypeStr && typeSpec.indexOf(' ') > 0) {\n\t          // off(el, 't1 t2 t3', fn) or off(el, 't1 t2 t3')\n\t          typeSpec = str2arr(typeSpec)\n\t          for (i = typeSpec.length; i--;)\n\t            off(element, typeSpec[i], fn)\n\t          return element\n\t        }\n\t\n\t        type = isTypeStr && typeSpec.replace(nameRegex, '')\n\t        if (type && customEvents[type]) type = customEvents[type].base\n\t\n\t        if (!typeSpec || isTypeStr) {\n\t          // off(el) or off(el, t1.ns) or off(el, .ns) or off(el, .ns1.ns2.ns3)\n\t          if (namespaces = isTypeStr && typeSpec.replace(namespaceRegex, '')) namespaces = str2arr(namespaces, '.')\n\t          removeListener(element, type, fn, namespaces)\n\t        } else if (isFunction(typeSpec)) {\n\t          // off(el, fn)\n\t          removeListener(element, null, typeSpec)\n\t        } else {\n\t          // off(el, { t1: fn1, t2, fn2 })\n\t          for (k in typeSpec) {\n\t            if (typeSpec.hasOwnProperty(k)) off(element, k, typeSpec[k])\n\t          }\n\t        }\n\t\n\t        return element\n\t      }\n\t\n\t      /**\n\t        * on(element, eventType(s)[, selector], handler[, args ])\n\t        */\n\t    , on = function(element, events, selector, fn) {\n\t        var originalFn, type, types, i, args, entry, first\n\t\n\t        //TODO: the undefined check means you can't pass an 'args' argument, fix this perhaps?\n\t        if (selector === undefined && typeof events == 'object') {\n\t          //TODO: this can't handle delegated events\n\t          for (type in events) {\n\t            if (events.hasOwnProperty(type)) {\n\t              on.call(this, element, type, events[type])\n\t            }\n\t          }\n\t          return\n\t        }\n\t\n\t        if (!isFunction(selector)) {\n\t          // delegated event\n\t          originalFn = fn\n\t          args       = slice.call(arguments, 4)\n\t          fn         = delegate(selector, originalFn, selectorEngine)\n\t        } else {\n\t          args       = slice.call(arguments, 3)\n\t          fn         = originalFn = selector\n\t        }\n\t\n\t        types = str2arr(events)\n\t\n\t        // special case for one(), wrap in a self-removing handler\n\t        if (this === ONE) {\n\t          fn = once(off, element, events, fn, originalFn)\n\t        }\n\t\n\t        for (i = types.length; i--;) {\n\t          // add new handler to the registry and check if it's the first for this element/type\n\t          first = registry.put(entry = new RegEntry(\n\t              element\n\t            , types[i].replace(nameRegex, '') // event type\n\t            , fn\n\t            , originalFn\n\t            , str2arr(types[i].replace(namespaceRegex, ''), '.') // namespaces\n\t            , args\n\t            , false // not root\n\t          ))\n\t          if (entry[eventSupport] && first) {\n\t            // first event of this type on this element, add root listener\n\t            listener(element, entry.eventType, true, entry.customType)\n\t          }\n\t        }\n\t\n\t        return element\n\t      }\n\t\n\t      /**\n\t        * add(element[, selector], eventType(s), handler[, args ])\n\t        *\n\t        * Deprecated: kept (for now) for backward-compatibility\n\t        */\n\t    , add = function (element, events, fn, delfn) {\n\t        return on.apply(\n\t            null\n\t          , !isString(fn)\n\t              ? slice.call(arguments)\n\t              : [ element, fn, events, delfn ].concat(arguments.length > 3 ? slice.call(arguments, 5) : [])\n\t        )\n\t      }\n\t\n\t      /**\n\t        * one(element, eventType(s)[, selector], handler[, args ])\n\t        */\n\t    , one = function () {\n\t        return on.apply(ONE, arguments)\n\t      }\n\t\n\t      /**\n\t        * fire(element, eventType(s)[, args ])\n\t        *\n\t        * The optional 'args' argument must be an array, if no 'args' argument is provided\n\t        * then we can use the browser's DOM event system, otherwise we trigger handlers manually\n\t        */\n\t    , fire = function (element, type, args) {\n\t        var types = str2arr(type)\n\t          , i, j, l, names, handlers\n\t\n\t        for (i = types.length; i--;) {\n\t          type = types[i].replace(nameRegex, '')\n\t          if (names = types[i].replace(namespaceRegex, '')) names = str2arr(names, '.')\n\t          if (!names && !args && element[eventSupport]) {\n\t            fireListener(nativeEvents[type], type, element)\n\t          } else {\n\t            // non-native event, either because of a namespace, arguments or a non DOM element\n\t            // iterate over all listeners and manually 'fire'\n\t            handlers = registry.get(element, type, null, false)\n\t            args = [false].concat(args)\n\t            for (j = 0, l = handlers.length; j < l; j++) {\n\t              if (handlers[j].inNamespaces(names)) {\n\t                handlers[j].handler.apply(element, args)\n\t              }\n\t            }\n\t          }\n\t        }\n\t        return element\n\t      }\n\t\n\t      /**\n\t        * clone(dstElement, srcElement[, eventType ])\n\t        *\n\t        * TODO: perhaps for consistency we should allow the same flexibility in type specifiers?\n\t        */\n\t    , clone = function (element, from, type) {\n\t        var handlers = registry.get(from, type, null, false)\n\t          , l = handlers.length\n\t          , i = 0\n\t          , args, beanDel\n\t\n\t        for (; i < l; i++) {\n\t          if (handlers[i].original) {\n\t            args = [ element, handlers[i].type ]\n\t            if (beanDel = handlers[i].handler.__beanDel) args.push(beanDel.selector)\n\t            args.push(handlers[i].original)\n\t            on.apply(null, args)\n\t          }\n\t        }\n\t        return element\n\t      }\n\t\n\t    , bean = {\n\t          'on'                : on\n\t        , 'add'               : add\n\t        , 'one'               : one\n\t        , 'off'               : off\n\t        , 'remove'            : off\n\t        , 'clone'             : clone\n\t        , 'fire'              : fire\n\t        , 'Event'             : Event\n\t        , 'setSelectorEngine' : setSelectorEngine\n\t        , 'noConflict'        : function () {\n\t            context[name] = old\n\t            return this\n\t          }\n\t      }\n\t\n\t  // for IE, clean up on unload to avoid leaks\n\t  if (win.attachEvent) {\n\t    var cleanup = function () {\n\t      var i, entries = registry.entries()\n\t      for (i in entries) {\n\t        if (entries[i].type && entries[i].type !== 'unload') off(entries[i].element, entries[i].type)\n\t      }\n\t      win.detachEvent('onunload', cleanup)\n\t      win.CollectGarbage && win.CollectGarbage()\n\t    }\n\t    win.attachEvent('onunload', cleanup)\n\t  }\n\t\n\t  // initialize selector engine to internal default (qSA or throw Error)\n\t  setSelectorEngine()\n\t\n\t  return bean\n\t});\n\n\n/***/ },\n/* 13 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t\tvalue: true\n\t});\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tvar _lodash = __webpack_require__(5);\n\t\n\tvar _lodash2 = _interopRequireDefault(_lodash);\n\t\n\tvar _bean = __webpack_require__(12);\n\t\n\tvar _bean2 = _interopRequireDefault(_bean);\n\t\n\tvar _KeyUtils = __webpack_require__(14);\n\t\n\tvar KeyUtils = _interopRequireWildcard(_KeyUtils);\n\t\n\tvar _Utils = __webpack_require__(2);\n\t\n\tvar _Utils2 = _interopRequireDefault(_Utils);\n\t\n\tvar _DomUtils = __webpack_require__(7);\n\t\n\tvar _DomUtils2 = _interopRequireDefault(_DomUtils);\n\t\n\tvar _StringBuffer = __webpack_require__(8);\n\t\n\tvar _StringBuffer2 = _interopRequireDefault(_StringBuffer);\n\t\n\tfunction _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj.default = obj; return newObj; } }\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tvar DEFAULTS = {\n\t\tstopPropagation: false\n\t};\n\t\n\tvar EventDispatcher = function () {\n\t\t/**\n\t  * Constructor\n\t  * @param root the root element that the manager will listen to.\n\t  * @param zoomScale\n\t  * @param config the configuraton for the event dispatcher.\n\t  */\n\t\n\t\tfunction EventDispatcher(root) {\n\t\t\tvar zoomScale = arguments.length <= 1 || arguments[1] === undefined ? [0, Infinity] : arguments[1];\n\t\t\tvar config = arguments.length <= 2 || arguments[2] === undefined ? {} : arguments[2];\n\t\n\t\t\t_classCallCheck(this, EventDispatcher);\n\t\n\t\t\tthis.root = root;\n\t\t\tthis.rootNS = root.getAttribute('ns') || 'root';\n\t\t\tthis.zoomScale = zoomScale;\n\t\t\t_lodash2.default.assign(this, DEFAULTS, config);\n\t\t\tthis.scale = 1.0;\n\t\t\tthis.listeners = {};\n\t\t\tthis.dragging = false;\n\t\t\tthis.handler = _lodash2.default.bind(this.handleEvent, this);\n\t\t\tthis.started = false;\n\t\n\t\t\t// Simulate mouseenter/mouseleave events\n\t\t\tthis.enterStack = [];\n\t\t}\n\t\n\t\t/**\n\t  * Start listening for events.\n\t  */\n\t\n\t\n\t\t_createClass(EventDispatcher, [{\n\t\t\tkey: \"start\",\n\t\t\tvalue: function start() {\n\t\t\t\tif (this.started) return;\n\t\t\t\t_bean2.default.on(this.root, 'mousedown mouseover mouseout mouseenter mouseleave dblclick click contextmenu mousewheel', this.handler);\n\t\t\t\tthis.startKeys();\n\t\t\t\tthis.started = true;\n\t\t\t}\n\t\n\t\t\t/**\n\t   * Stop listening for events.\n\t   */\n\t\n\t\t}, {\n\t\t\tkey: \"stop\",\n\t\t\tvalue: function stop() {\n\t\t\t\tif (!this.started) return;\n\t\t\t\t_bean2.default.off(this.root, 'mousedown mouseover mouseout mouseenter mouseleave dblclick click contextmenu mousewheel', this.handler);\n\t\t\t\tthis.stopKeys();\n\t\t\t\tthis.started = false;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"startKeys\",\n\t\t\tvalue: function startKeys() {\n\t\t\t\t_bean2.default.on(document, 'keydown keyup', this.handler);\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"stopKeys\",\n\t\t\tvalue: function stopKeys() {\n\t\t\t\t_bean2.default.off(document, 'keydown keyup', this.handler);\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"zoomIn\",\n\t\t\tvalue: function zoomIn() {\n\t\t\t\tthis.scale *= 1.25;\n\t\t\t\tthis.scale = Math.max(Math.min(this.zoomScale[1], this.scale), this.zoomScale[0]);\n\t\t\t\treturn this.scale;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"zoomOut\",\n\t\t\tvalue: function zoomOut() {\n\t\t\t\tthis.scale *= 0.8;\n\t\t\t\tthis.scale = Math.max(Math.min(this.zoomScale[1], this.scale), this.zoomScale[0]);\n\t\t\t\treturn this.scale;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"getEventInfo\",\n\t\t\tvalue: function getEventInfo(event) {\n\t\t\t\tvar target = event.target;\n\t\t\t\tvar buf = new _StringBuffer2.default(),\n\t\t\t\t    ns = void 0,\n\t\t\t\t    stack = [],\n\t\t\t\t    isRoot = false;\n\t\t\t\twhile (!isRoot && target && target != document) {\n\t\t\t\t\tns = target.getAttribute('ns');\n\t\t\t\t\tif (ns) {\n\t\t\t\t\t\tisRoot = _lodash2.default.startsWith(ns, \"root.\");\n\t\t\t\t\t\tif (isRoot) {\n\t\t\t\t\t\t\tns = ns.substring(5);\n\t\t\t\t\t\t\tevent.rootTarget = target;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (!event.nsTarget) event.nsTarget = target;\n\t\t\t\t\t\tstack.splice(0, 0, target);\n\t\t\t\t\t\tbuf.prepend(ns);\n\t\t\t\t\t}\n\t\t\t\t\ttarget = target.parentNode;\n\t\t\t\t}\n\t\t\t\tif (!isRoot) event.rootTarget = event.nsTarget;\n\t\n\t\t\t\t// target stack is a stack of all the ns targets up to the one with the data binding.\n\t\t\t\tevent.targetStack = stack;\n\t\t\t\tns = buf.toString('.');\n\t\t\t\tif (ns == '') ns = this.rootNS;\n\t\t\t\treturn { data: event.rootTarget, ns: ns };\n\t\t\t}\n\t\n\t\t\t/**\n\t   * The main event handler method, it processes event and generate relevant events to dispatch.\n\t   */\n\t\n\t\t}, {\n\t\t\tkey: \"handleEvent\",\n\t\t\tvalue: function handleEvent(event) {\n\t\t\t\tvar _this = this;\n\t\n\t\t\t\tvar type = event.type;\n\t\n\t\t\t\t// Do not dispatch other events if we are dragging.\n\t\t\t\tif (this.dragging || _DomUtils2.default.eventFromInput(event)) return;\n\t\n\t\t\t\tvar data = void 0,\n\t\t\t\t    ns = void 0,\n\t\t\t\t    pos = this.getPosition(event),\n\t\t\t\t    info = void 0,\n\t\t\t\t    isKeyEvent = type == 'keydown' || type == 'keyup';\n\t\t\t\tif (isKeyEvent) {\n\t\t\t\t\tdata = this.root;\n\t\t\t\t\tns = KeyUtils.getKeyEvent(event);\n\t\t\t\t} else {\n\t\t\t\t\tinfo = this.getEventInfo(event);\n\t\t\t\t\tif (!info) return;\n\t\t\t\t\tdata = info.data;\n\t\t\t\t\tns = info.ns;\n\t\t\t\t}\n\t\n\t\t\t\t//Utils.log('EventDispatcher', \"handleEvent - \" + type + ';ns=' + ns);\n\t\n\t\t\t\tif (type == 'mousewheel') {\n\t\t\t\t\tthis.scale *= Math.pow(2, event.wheelDelta * 0.002);\n\t\t\t\t\tthis.scale = Math.max(Math.min(this.zoomScale[1], this.scale), this.zoomScale[0]);\n\t\t\t\t\tevent.scale = this.scale;\n\t\t\t\t\ttype = 'zoom';\n\t\t\t\t}\n\t\n\t\t\t\t// See if we should create drag events\n\t\t\t\tif (type == 'mousedown' && event.button == 0 /*only drag on left click*/) {\n\t\t\t\t\t\t(function () {\n\t\t\t\t\t\t\t// Create drag object.\n\t\t\t\t\t\t\tvar dragObject = { data: data, pos: ns == 'root' ? EventDispatcher.mouse(_this.root, event) : pos };\n\t\t\t\t\t\t\t_this.dragging = false;\n\t\t\t\t\t\t\t// Start listening for mouse move.\n\t\t\t\t\t\t\tvar dragPos = void 0;\n\t\n\t\t\t\t\t\t\tvar mousemove = function mousemove(event) {\n\t\t\t\t\t\t\t\tvar currentPos = _this.getPosition(event);\n\t\t\t\t\t\t\t\tif (!_this.dragging) {\n\t\t\t\t\t\t\t\t\t// check if the mouse has moved. IE always fire mousemove after mousedown even if the mouse hasn't moved yet.\n\t\t\t\t\t\t\t\t\tif (dragObject.pos[0] == currentPos[0] && dragObject.pos[1] == currentPos[1]) return;\n\t\n\t\t\t\t\t\t\t\t\t// start dragging\n\t\t\t\t\t\t\t\t\t_this.dragging = true;\n\t\t\t\t\t\t\t\t\tevent.rootTarget = dragObject.data;\n\t\t\t\t\t\t\t\t\t_this.dispatch(event, 'dragstart', ns, dragObject.data, dragObject.pos);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tif (ns == \"root\") dragPos = EventDispatcher.mouse(_this.root, event);else dragPos = currentPos;\n\t\t\t\t\t\t\t\t_this.getEventInfo(event);\n\t\t\t\t\t\t\t\t_this.dispatch(event, 'drag', ns, dragObject.data, dragPos);\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\tvar mouseup = function mouseup(event) {\n\t\t\t\t\t\t\t\tif (ns == \"root\") dragPos = EventDispatcher.mouse(_this.root, event);else dragPos = _this.getPosition(event);\n\t\n\t\t\t\t\t\t\t\tvar info = _this.getEventInfo(event);\n\t\t\t\t\t\t\t\tif (_this.dragging) {\n\t\t\t\t\t\t\t\t\t_this.dragging = false;\n\t\t\t\t\t\t\t\t\t_this.dispatch(event, 'dragend', ns, dragObject.data, dragPos);\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t_this.dispatch(event, 'mouseup', ns, info.data, dragPos);\n\t\t\t\t\t\t\t\t}\n\t\n\t\t\t\t\t\t\t\t_bean2.default.off(window, 'mousemove', mousemove);\n\t\t\t\t\t\t\t\t_bean2.default.off(window, 'mouseup', mouseup);\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\tevent.preventDefault();\n\t\t\t\t\t\t\t_bean2.default.on(window, 'mousemove', mousemove);\n\t\t\t\t\t\t\t_bean2.default.on(window, 'mouseup', mouseup);\n\t\t\t\t\t\t})();\n\t\t\t\t\t}\n\t\n\t\t\t\tif (!isKeyEvent) this.simulateEnterLeave(event, type, ns, data, pos);\n\t\t\t\tthis.dispatch(event, type, ns, data, pos);\n\t\n\t\t\t\t// disable the default context menu\n\t\t\t\t//if (type == 'contextmenu')\n\t\t\t\t//\tevent.preventDefault();\n\t\t\t}\n\t\n\t\t\t/**\n\t   * try to simulate mouseenter/mouseleave events.\n\t   */\n\t\n\t\t}, {\n\t\t\tkey: \"simulateEnterLeave\",\n\t\t\tvalue: function simulateEnterLeave(event, type, ns, data, pos) {\n\t\t\t\tvar _this2 = this;\n\t\n\t\t\t\tvar last = void 0,\n\t\t\t\t    stack = void 0;\n\t\t\t\tvar clearEnterStack = function clearEnterStack(k) {\n\t\t\t\t\tk = k || 0;\n\t\t\t\t\t// Clear off the enter stack.\n\t\t\t\t\twhile (_this2.enterStack.length >= k + 1) {\n\t\t\t\t\t\tlast = _this2.enterStack.pop();\n\t\t\t\t\t\t_this2.dispatch(event, 'mouseleave', last.ns, last.data, pos);\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t\tvar getNS = function getNS(index) {\n\t\t\t\t\tvar buf = new _StringBuffer2.default();\n\t\t\t\t\tfor (var i = 0; i <= index; i++) {\n\t\t\t\t\t\tvar val = stack[i].getAttribute(\"ns\");\n\t\t\t\t\t\tif (_lodash2.default.startsWith(val, \"root.\")) val = val.substring(5);\n\t\t\t\t\t\tbuf.append(val);\n\t\t\t\t\t}\n\t\t\t\t\treturn buf.toString('.');\n\t\t\t\t};\n\t\n\t\t\t\tif (ns && ns != this.rootNS) {\n\t\t\t\t\tif (type == 'mouseover') {\n\t\t\t\t\t\tstack = event.targetStack;\n\t\t\t\t\t\tvar item = void 0;\n\t\t\t\t\t\tfor (var i = 0; i < stack.length; i++) {\n\t\t\t\t\t\t\tif (i < this.enterStack.length) {\n\t\t\t\t\t\t\t\tif (this.enterStack[i].target != stack[i]) {\n\t\t\t\t\t\t\t\t\tclearEnterStack(i);\n\t\t\t\t\t\t\t\t} else continue;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\titem = { data: data, ns: getNS(i), target: stack[i] };\n\t\t\t\t\t\t\tthis.enterStack.push(item);\n\t\t\t\t\t\t\tthis.dispatch(event, 'mouseenter', item.ns, data, pos);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (stack.length < this.enterStack.length) clearEnterStack(stack.length);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (ns == this.rootNS && this.enterStack.length > 0) clearEnterStack();\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"dispatch\",\n\t\t\tvalue: function dispatch(event, type, ns, data, pos) {\n\t\t\t\t//if (type != 'mouseover' && type != 'mouseout')\n\t\t\t\t//\tUtils.log('EventDispatcher', \"dispatch - \" + type + '.' + ns + ';' + pos + ';rootTarget=' + event.rootTarget + ';data=' + data);\n\t\t\t\tif (!this.started) return;\n\t\t\t\tvar nsType = ns ? type + '.' + ns : type;\n\t\t\t\t_lodash2.default.forEach(this.listeners, function (listeners, key) {\n\t\t\t\t\tif (EventDispatcher.match(nsType, listeners.regexp ? listeners.regexp : key)) {\n\t\t\t\t\t\t_lodash2.default.forEach(listeners, function (listener) {\n\t\t\t\t\t\t\tif (!listener.context) listener.callback.apply(window, [type, ns, data, pos, event]);else listener.callback.apply(listener.context, [type, ns, data, pos, event]);\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t});\n\t\n\t\t\t\t// after dispatching, do not propagate.\n\t\t\t\tif (this.stopPropagation && event.stopPropagation) event.stopPropagation();\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"getPosition\",\n\t\t\tvalue: function getPosition(event) {\n\t\t\t\tvar pos = EventDispatcher.mouse(this.root, event);\n\t\t\t\tif (!_lodash2.default.isNaN(pos[0]) && !_lodash2.default.isNaN(pos[1])) this.lastPosition = pos;\n\t\t\t\treturn this.lastPosition;\n\t\t\t}\n\t\n\t\t\t/**\n\t   * Registers a key event handler\n\t   * // Key is object {ctrl, alt, shift, meta, code}\n\t   */\n\t\n\t\t}, {\n\t\t\tkey: \"registerKey\",\n\t\t\tvalue: function registerKey(type, key, callback, context) {\n\t\t\t\tvar _this3 = this;\n\t\n\t\t\t\tif (_lodash2.default.isArray(key)) {\n\t\t\t\t\t_lodash2.default.forEach(key, function (k) {\n\t\t\t\t\t\t_this3.registerKey(type, k, callback, context);\n\t\t\t\t\t});\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tkey = KeyUtils.getKeyData(key.ctrl, key.alt, key.shift, key.meta, key.code);\n\t\t\t\tif (!key.length) return;\n\t\t\t\tkey = new _StringBuffer2.default(type).append(key).toString('.');\n\t\n\t\t\t\tvar listener = { callback: callback, context: context };\n\t\t\t\tthis.listeners[key] || (this.listeners[key] = []);\n\t\t\t\tthis.listeners[key].push(listener);\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"unregisterKey\",\n\t\t\tvalue: function unregisterKey(type, key, callback, context) {\n\t\t\t\tvar _this4 = this;\n\t\n\t\t\t\tif (_lodash2.default.isArray(key)) {\n\t\t\t\t\t_lodash2.default.forEach(key, function (k) {\n\t\t\t\t\t\t_this4.unregisterKey(type, k, callback, context);\n\t\t\t\t\t});\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tkey = KeyUtils.getKeyData(key.ctrl, key.alt, key.shift, key.meta, key.code);\n\t\t\t\tif (!key.length) return;\n\t\t\t\tkey = new _StringBuffer2.default(type).append(key).toString('.');\n\t\n\t\t\t\tvar listeners = this.listeners[key],\n\t\t\t\t    listener = void 0;\n\t\t\t\tif (!listeners) return;\n\t\t\t\tfor (var i = 0; i < listeners.length; i++) {\n\t\t\t\t\tlistener = listeners[i];\n\t\t\t\t\tif (listener.callback === callback && (!context || context === listener.context)) {\n\t\t\t\t\t\tlisteners.splice(i, 1);\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\n\t\t\t/**\n\t   * Registers an event handler\n\t   */\n\t\n\t\t}, {\n\t\t\tkey: \"register\",\n\t\t\tvalue: function register(type, callback, context, zIndex) {\n\t\t\t\tvar _this5 = this;\n\t\n\t\t\t\tif (_lodash2.default.isArray(type)) {\n\t\t\t\t\t_lodash2.default.forEach(type, function (t) {\n\t\t\t\t\t\t_this5.register(t, callback, context, zIndex);\n\t\t\t\t\t});\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tvar listener = { callback: callback, context: context, zIndex: zIndex };\n\t\t\t\tvar regexp = null;\n\t\t\t\tif (type instanceof RegExp) {\n\t\t\t\t\tregexp = type;\n\t\t\t\t\ttype = type + '';\n\t\t\t\t}\n\t\t\t\tthis.listeners[type] || (this.listeners[type] = []);\n\t\t\t\tif (regexp && !this.listeners[type].regexp) this.listeners[type].regexp = regexp;\n\t\t\t\tthis.listeners[type].push(listener);\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"unregister\",\n\t\t\tvalue: function unregister(type, callback, context) {\n\t\t\t\tif (type instanceof RegExp) type = type + '';\n\t\t\t\tvar listeners = this.listeners[type],\n\t\t\t\t    listener = void 0;\n\t\t\t\tif (!listeners) return;\n\t\t\t\tfor (var i = 0; i < listeners.length; i++) {\n\t\t\t\t\tlistener = listeners[i];\n\t\t\t\t\tif (listener.callback === callback && (!context || context === listener.context)) {\n\t\t\t\t\t\tlisteners.splice(i, 1);\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"destroy\",\n\t\t\tvalue: function destroy() {\n\t\t\t\tthis.stop();\n\t\t\t\tdelete this.root;\n\t\t\t\tdelete this.listeners;\n\t\t\t\tdelete this.enterStack;\n\t\t\t}\n\t\n\t\t\t/**\n\t   * Check if the registered event type matches the real event type. \"*\" is allowed as a wild card.\n\t   */\n\t\n\t\t}], [{\n\t\t\tkey: \"match\",\n\t\t\tvalue: function match(nsType, registeredType) {\n\t\t\t\tif (registeredType instanceof RegExp) return nsType.match(registeredType);\n\t\n\t\t\t\treturn nsType == registeredType;\n\t\t\t\t/*const arr = registeredType.split('*');\n\t   if (arr.length == 1)\n\t   \treturn nsType == registeredType;\n\t   \tlet substr, index = 0;\n\t   for (let i = 0; i < arr.length; i++) {\n\t   \tif (arr[i].length == 0) continue;\n\t   \tsubstr = nsType.slice(index);\n\t   \tindex = substr.indexOf(arr[i]);\n\t   \tif (index < 0)\n\t   \t\treturn false;\n\t   \tindex += arr[i].length;\n\t   }\n\t   return true;*/\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"mouse\",\n\t\t\tvalue: function mouse(container, e) {\n\t\t\t\tif (e.changedTouches) e = e.changedTouches[0];\n\t\t\t\tvar svg = container.ownerSVGElement || container;\n\t\t\t\tif (svg.createSVGPoint) {\n\t\t\t\t\tvar point = svg.createSVGPoint();\n\t\t\t\t\tpoint.x = e.clientX;point.y = e.clientY;\n\t\t\t\t\tpoint = point.matrixTransform(container.getScreenCTM().inverse());\n\t\t\t\t\treturn [point.x, point.y];\n\t\t\t\t}\n\t\t\t\tvar rect = container.getBoundingClientRect();\n\t\t\t\treturn [e.clientX - rect.left - container.clientLeft, e.clientY - rect.top - container.clientTop];\n\t\t\t}\n\t\t}]);\n\t\n\t\treturn EventDispatcher;\n\t}();\n\t\n\texports.default = EventDispatcher;\n\n/***/ },\n/* 14 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t\tvalue: true\n\t});\n\texports.getKeyEvent = getKeyEvent;\n\texports.getKeyData = getKeyData;\n\t\n\tvar _StringBuffer = __webpack_require__(8);\n\t\n\tvar _StringBuffer2 = _interopRequireDefault(_StringBuffer);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\t/**\n\t * KEY constant\n\t */\n\tvar KEY = {\n\t\tALT: 18,\n\t\tBACK_SPACE: 8,\n\t\tCAPS_LOCK: 20,\n\t\tCONTROL: 17,\n\t\tDELETE: 46,\n\t\tDOWN: 40,\n\t\tEND: 35,\n\t\tENTER: 13,\n\t\tESCAPE: 220,\n\t\tHOME: 36,\n\t\tLEFT: 37,\n\t\tMETA: 224,\n\t\tNUM_LOCK: 144,\n\t\tPAGE_DOWN: 34,\n\t\tPAGE_UP: 33,\n\t\tPAUSE: 19,\n\t\tPRINTSCREEN: 44,\n\t\tRIGHT: 39,\n\t\tSCROLL_LOCK: 145,\n\t\tSHIFT: 16,\n\t\tSPACE: 32,\n\t\tTAB: 9,\n\t\tUP: 38\n\t\t//ADD          : DomUtils.isFireFox ? 61  : 187,\n\t\t//SUBTRACT     : DomUtils.isFireFox ? 173 : 189\n\t}; ///////////////////////////////////////////////////////////////////////////////\n\t//                                                                           //\n\t//           The Key Utility CLass for the Event Dispatcher          \t     //\n\t//                                                                           //\n\t///////////////////////////////////////////////////////////////////////////////\n\t\n\tfunction getKeyEvent(event) {\n\t\tif (!event || !event instanceof KeyboardEvent) {\n\t\t\treturn null;\n\t\t}\n\t\n\t\tvar key = event.keyCode || event.which;\n\t\n\t\t// Need to find a way to avoid this\n\t\tif (key >= 16 && key <= 18) {\n\t\t\tkey = null;\n\t\t}\n\t\n\t\treturn getKeyData(event.ctrlKey, event.altKey, event.shiftKey, event.metaKey, key);\n\t}\n\t\n\tfunction getKeyData(ctrl, alt, shift, meta, key) {\n\t\tvar buf = new _StringBuffer2.default();\n\t\n\t\tif (ctrl) buf.append(\"CTRL\");\n\t\tif (alt) buf.append(\"ALT\");\n\t\tif (shift) buf.append(\"SHIFT\");\n\t\tif (meta) buf.append(\"META\");\n\t\tif (key) buf.append(key);\n\t\n\t\treturn buf.toString(\".\");\n\t}\n\n/***/ },\n/* 15 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t\tvalue: true\n\t});\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tvar _lodash = __webpack_require__(5);\n\t\n\tvar _lodash2 = _interopRequireDefault(_lodash);\n\t\n\tvar _Utils = __webpack_require__(2);\n\t\n\tvar _Utils2 = _interopRequireDefault(_Utils);\n\t\n\tvar _Node = __webpack_require__(16);\n\t\n\tvar _Node2 = _interopRequireDefault(_Node);\n\t\n\tvar _Edge = __webpack_require__(20);\n\t\n\tvar _Edge2 = _interopRequireDefault(_Edge);\n\t\n\tvar _Marker = __webpack_require__(21);\n\t\n\tvar _Marker2 = _interopRequireDefault(_Marker);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tvar nodeDefaults = {\n\t\tname: 'Default',\n\t\trole: 'node',\n\t\tdraggable: true,\n\t\tselectable: true,\n\t\teditable: true,\n\t\tresizable: false,\n\t\tsourceable: true,\n\t\ttargetable: true,\n\t\tvisible: true\n\t};\n\t\n\tvar edgeDefaults = {\n\t\tname: 'Default',\n\t\trole: 'edge',\n\t\tselectable: true,\n\t\tvisible: true,\n\t\tstartMarker: null,\n\t\tendMarker: {\n\t\t\tid: 'Default_EndMarker',\n\t\t\ttype: 'arrow',\n\t\t\tsize: 10,\n\t\t\tcolor: '#0ea117'\n\t\t},\n\t\t/* start and end is only used if the edge is not connected to a node */\n\t\tstart: [0, 0],\n\t\tend: [400, 200]\n\t};\n\t\n\tvar Graph = function () {\n\t\tfunction Graph() {\n\t\t\tvar id = arguments.length <= 0 || arguments[0] === undefined ? _lodash2.default.uniqueId(\"G\") : arguments[0];\n\t\t\tvar config = arguments.length <= 1 || arguments[1] === undefined ? {} : arguments[1];\n\t\t\tvar model = arguments[2];\n\t\n\t\t\t_classCallCheck(this, Graph);\n\t\n\t\t\tthis.id = id;\n\t\n\t\t\tthis.nodes = {};\n\t\t\tthis.edges = {};\n\t\n\t\t\tthis.selection = null;\n\t\t\tthis.destroyed = false;\n\t\n\t\t\t_Utils2.default.buildTypes(config.nodeTypes, \"Nodes\", nodeDefaults);\n\t\t\t_Utils2.default.buildTypes(config.edgeTypes, \"Edges\", edgeDefaults);\n\t\t\t// check for markers.\n\t\t\tthis.markers = [];\n\t\t\tvar edgeTypes = _Utils2.default.type(_Edge2.default.namespace),\n\t\t\t    marker = void 0,\n\t\t\t    markerConfig = void 0;\n\t\t\tedgeTypes.forEach(function (type) {\n\t\t\t\tmarkerConfig = type.prototype.startMarker;\n\t\t\t\tif (markerConfig) {\n\t\t\t\t\tmarker = _Marker2.default.getMarker(markerConfig, true);\n\t\t\t\t\tthis.markers.push(marker);\n\t\t\t\t}\n\t\t\t\tmarkerConfig = type.prototype.endMarker;\n\t\t\t\tif (markerConfig) {\n\t\t\t\t\tmarker = _Marker2.default.getMarker(markerConfig, false);\n\t\t\t\t\tthis.markers.push(marker);\n\t\t\t\t}\n\t\t\t}, this);\n\t\n\t\t\tdelete config.nodeTypes;\n\t\t\tdelete config.edgeTypes;\n\t\t\t_Utils2.default.initConfig(this, config);\n\t\t\tthis.root = null;\n\t\t\tif (model) this.loadModel(model);\n\t\t}\n\t\n\t\t_createClass(Graph, [{\n\t\t\tkey: \"addNode\",\n\t\n\t\n\t\t\t/**\n\t   * Create a new Node\n\t   */\n\t\t\tvalue: function addNode(config) {\n\t\t\t\tvar parent = arguments.length <= 1 || arguments[1] === undefined ? this.currentRoot : arguments[1];\n\t\t\t\tvar pos = arguments[2];\n\t\n\t\t\t\tvar NodeClass = Graph.getJSClass(config, _Node2.default);\n\t\t\t\tvar node = new NodeClass(this, config);\n\t\n\t\t\t\tif (parent) Graph.addChild(parent, node, pos);else {\n\t\t\t\t\tthis.root = node;\n\t\t\t\t\tthis.root.prop('role', 'root');\n\t\t\t\t}\n\t\n\t\t\t\tthis.nodes[node.id] = node;\n\t\t\t\treturn node;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"addEdge\",\n\t\t\tvalue: function addEdge(config) {\n\t\t\t\tvar parent = arguments.length <= 1 || arguments[1] === undefined ? this.currentRoot : arguments[1];\n\t\t\t\tvar from = arguments[2];\n\t\t\t\tvar to = arguments[3];\n\t\n\t\t\t\tvar EdgeClass = Graph.getJSClass(config, _Edge2.default);\n\t\t\t\tvar edge = new EdgeClass(this, config, from, to);\n\t\n\t\t\t\tGraph.addChild(parent, edge);\n\t\t\t\tthis.edges[edge.id] = edge;\n\t\t\t\treturn edge;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"loadModel\",\n\t\t\tvalue: function loadModel(model) {\n\t\t\t\tvar _this = this;\n\t\n\t\t\t\tvar parent = arguments.length <= 1 || arguments[1] === undefined ? this.currentRoot : arguments[1];\n\t\n\t\t\t\tvar nodes = model.nodes;\n\t\t\t\tvar edges = model.edges;\n\t\t\t\tdelete model.nodes;\n\t\t\t\tdelete model.edges;\n\t\n\t\t\t\tvar node = this.addNode(model, parent);\n\t\t\t\tif (nodes) {\n\t\t\t\t\t_lodash2.default.forEach(nodes, function (child) {\n\t\t\t\t\t\t_this.loadModel(child, node);\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\tif (edges) {\n\t\t\t\t\t_lodash2.default.forEach(edges, function (edge) {\n\t\t\t\t\t\tvar from = void 0,\n\t\t\t\t\t\t    to = void 0;\n\t\t\t\t\t\tif (edge.from) from = _this.nodes[edge.from];\n\t\t\t\t\t\tif (edge.to) to = _this.nodes[edge.to];\n\t\t\t\t\t\t_this.addEdge(edge, node, from, to);\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"reset\",\n\t\t\tvalue: function reset() {}\n\t\t}, {\n\t\t\tkey: \"destroy\",\n\t\t\tvalue: function destroy() {}\n\t\t}, {\n\t\t\tkey: \"currentRoot\",\n\t\t\tget: function get() {\n\t\t\t\treturn this.root;\n\t\t\t}\n\t\t}], [{\n\t\t\tkey: \"getJSClass\",\n\t\t\tvalue: function getJSClass(config, defaultClass) {\n\t\t\t\tvar jsClass = null;\n\t\t\t\tif (config && config.type) {\n\t\t\t\t\t// See if we can get the js class from config.\n\t\t\t\t\tvar type = _Utils2.default.type(defaultClass.namespace, config.type);\n\t\t\t\t\tif (type) jsClass = type.jsClass;\n\t\t\t\t}\n\t\n\t\t\t\treturn _Utils2.default.getConstructor(jsClass, defaultClass);\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"addChild\",\n\t\t\tvalue: function addChild(parent, child) {\n\t\t\t\tif (!parent.children) parent.children = [];\n\t\n\t\t\t\tif (child.parent != parent) {\n\t\t\t\t\tparent.children.push(child);\n\t\n\t\t\t\t\tif (child.parent && child.parent.children) child.parent.children = _lodash2.default.without(child.parent.children, child);\n\t\t\t\t}\n\t\t\t\tchild.parent = parent;\n\t\t\t}\n\t\t}]);\n\t\n\t\treturn Graph;\n\t}();\n\t\n\tGraph.DEFAULTS = {\n\t\tallowDanglingEdges: true,\n\t\tmultiConnect: false,\n\t\treadOnly: false,\n\t\tviewOnly: false\n\t};\n\t\n\texports.default = Graph;\n\n/***/ },\n/* 16 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t\tvalue: true\n\t});\n\t\n\tvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol ? \"symbol\" : typeof obj; };\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tvar _lodash = __webpack_require__(5);\n\t\n\tvar _lodash2 = _interopRequireDefault(_lodash);\n\t\n\tvar _StringBuffer = __webpack_require__(8);\n\t\n\tvar _StringBuffer2 = _interopRequireDefault(_StringBuffer);\n\t\n\tvar _Cell2 = __webpack_require__(17);\n\t\n\tvar _Cell3 = _interopRequireDefault(_Cell2);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\t\n\tfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\t\n\tvar Node = function (_Cell) {\n\t\t_inherits(Node, _Cell);\n\t\n\t\tfunction Node(graph) {\n\t\t\tvar config = arguments.length <= 1 || arguments[1] === undefined ? {} : arguments[1];\n\t\n\t\t\t_classCallCheck(this, Node);\n\t\n\t\t\tif (!config.id) config.id = _lodash2.default.uniqueId('N');\n\t\n\t\t\tvar _this = _possibleConstructorReturn(this, Object.getPrototypeOf(Node).call(this, graph, config));\n\t\n\t\t\t_this.inEdges = [];\n\t\t\t_this.outEdges = [];\n\t\t\t_this.ports = null;\n\t\t\t_this.parent = null;\n\t\t\treturn _this;\n\t\t}\n\t\n\t\t_createClass(Node, [{\n\t\t\tkey: \"isAncestor\",\n\t\t\tvalue: function isAncestor(n) {\n\t\t\t\t// TODO: should we move this to graph class ?\n\t\t\t\tvar node = n.parent;\n\t\t\t\twhile (node) {\n\t\t\t\t\tif (this == node) {\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t}\n\t\t\t\t\tnode = node.parent;\n\t\t\t\t}\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"removeEdge\",\n\t\t\tvalue: function removeEdge(edge) {\n\t\t\t\tvar edges = edge.source == this ? this.outEdges : this.inEdges;\n\t\t\t\tfor (var i = 0; i < edges.length; i++) {\n\t\t\t\t\tif (edge == edges[i]) {\n\t\t\t\t\t\tedges.splice(i, 1);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\n\t\t\t// Add a new incoming edge\n\t\n\t\t}, {\n\t\t\tkey: \"addInEdge\",\n\t\t\tvalue: function addInEdge(edge, pos) {\n\t\t\t\tif (pos == null || pos === undefined) this.inEdges.push(edge);else this.inEdges.splice(pos, 0, edge);\n\t\t\t}\n\t\n\t\t\t// Add a new outgoing edge\n\t\n\t\t}, {\n\t\t\tkey: \"addOutEdge\",\n\t\t\tvalue: function addOutEdge(edge, pos) {\n\t\t\t\tif (pos == null || pos === undefined || pos > edge.length - 1) this.outEdges.push(edge);else this.outEdges.splice(pos, 0, edge);\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"renderChildren\",\n\t\t\tvalue: function renderChildren(view) {\n\t\t\t\tvar _this2 = this;\n\t\n\t\t\t\tif (this.children) {\n\t\t\t\t\tvar _ret = function () {\n\t\t\t\t\t\tvar buf = new _StringBuffer2.default();\n\t\t\t\t\t\t_lodash2.default.forEach(_this2.children, function (child) {\n\t\t\t\t\t\t\tbuf.append(child.render(view));\n\t\t\t\t\t\t});\n\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\tv: buf.toString()\n\t\t\t\t\t\t};\n\t\t\t\t\t}();\n\t\n\t\t\t\t\tif ((typeof _ret === \"undefined\" ? \"undefined\" : _typeof(_ret)) === \"object\") return _ret.v;\n\t\t\t\t}\n\t\t\t\treturn '';\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"getPort\",\n\t\t\tvalue: function getPort(key) {\n\t\t\t\tvar portName = arguments.length <= 1 || arguments[1] === undefined ? 'auto' : arguments[1];\n\t\t\t\tvar endPt = arguments[2];\n\t\t\t\tvar orthogonal = arguments[3];\n\t\n\t\t\t\tvar shape = this.getShape(key);\n\t\t\t\tif (portName == 'auto') {\n\t\t\t\t\treturn shape.getPerimeter(endPt, orthogonal);\n\t\t\t\t}\n\t\t\t\treturn null;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"toString\",\n\t\t\tvalue: function toString() {\n\t\t\t\tvar label = this.prop(\"label\") ? this.prop(\"label\") : \"undefined\";\n\t\t\t\tif (_lodash2.default.isArray(label)) label = label[0];\n\t\t\t\treturn 'Node:{id:' + this.id + ';label:' + label + ';type:' + this.props.constructor.typeName + '}';\n\t\t\t}\n\t\t}]);\n\t\n\t\treturn Node;\n\t}(_Cell3.default);\n\t\n\tNode.namespace = \"Nodes\";\n\t\n\texports.default = Node;\n\t\n\t/*\n\n\t/**\n\t * The DrillDownParent is the parent that displays the vertex when drilled down.\n\t *\n\tVertex.prototype.getDrillDownParent = function() {\n\t\treturn this.parent;\n\t};\n\n\tVertex.prototype.isLocked = function() {\n\t\tvar mode = this.getProperty(\"mode\") || 3;\n\t\treturn !(mode & Graph.ALLOW_INTERACTIONS);\n\t};\n\n\tVertex.prototype.getCrumbText = function() {\n\t\tif (this.isLocked())\n\t\t\treturn '<span><img src=\"webwb/pzreadonly.png\" /></span><span>&nbsp;' + this.getProperty(\"label\") + '</span>';\n\t\treturn this.getProperty(\"label\");\n\t};\n\n\tVertex.prototype.canEdit = function() {\n\t\treturn (!this.parent || !this.parent.isLocked()) && Vertex.superclass.canEdit.call(this);\n\t};\n\n\tVertex.prototype.isContainer = function() {\n\t\treturn this.getProperty(\"container\");\n\t};\n\n\t*/\n\n/***/ },\n/* 17 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t\tvalue: true\n\t});\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tvar _lodash = __webpack_require__(5);\n\t\n\tvar _lodash2 = _interopRequireDefault(_lodash);\n\t\n\tvar _Utils = __webpack_require__(2);\n\t\n\tvar _Utils2 = _interopRequireDefault(_Utils);\n\t\n\tvar _Cache = __webpack_require__(18);\n\t\n\tvar _Cache2 = _interopRequireDefault(_Cache);\n\t\n\tvar _StringBuffer = __webpack_require__(8);\n\t\n\tvar _StringBuffer2 = _interopRequireDefault(_StringBuffer);\n\t\n\tvar _Shape = __webpack_require__(6);\n\t\n\tvar _Shape2 = _interopRequireDefault(_Shape);\n\t\n\tvar _Rectangle = __webpack_require__(4);\n\t\n\tvar _Rectangle2 = _interopRequireDefault(_Rectangle);\n\t\n\tvar _Label = __webpack_require__(19);\n\t\n\tvar _Label2 = _interopRequireDefault(_Label);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\t/**\n\t * The Cell is the common parent for Node and Edge.\n\t */\n\t\n\tvar Cell = function () {\n\t\tfunction Cell(graph) {\n\t\t\tvar config = arguments.length <= 1 || arguments[1] === undefined ? { id: _lodash2.default.uniqueId() } : arguments[1];\n\t\n\t\t\t_classCallCheck(this, Cell);\n\t\n\t\t\tthis.graph = graph;\n\t\t\tthis.id = config.id;\n\t\t\tdelete config.id;\n\t\n\t\t\t// Initialize decorators\n\t\t\tif (config.decorators) {\n\t\t\t\tthis.createDecorators(config.decorators);\n\t\t\t\tdelete config.decorators;\n\t\t\t}\n\t\n\t\t\t// Initialize View Properties\n\t\t\tif (config.views) {\n\t\t\t\tthis.viewProps = config.views;\n\t\t\t\tdelete config.views;\n\t\t\t}\n\t\n\t\t\t// Initialize type\n\t\t\tvar type = config.type || \"Default\";\n\t\t\ttype = _Utils2.default.type(this.constructor.namespace, type);\n\t\t\tif (!type) throw new Error(\"Type not found \" + config.type);\n\t\t\tdelete config.type;\n\t\t\tthis.props = new type(config);\n\t\t}\n\t\n\t\t_createClass(Cell, [{\n\t\t\tkey: \"prop\",\n\t\t\tvalue: function prop(name, value) {\n\t\t\t\tif (_lodash2.default.isUndefined(value)) return this.props[name];\n\t\t\t\tthis.props[name] = value;\n\t\t\t}\n\t\n\t\t\t/**\n\t   * Get/Set property stored by views.\n\t   * @param key\n\t   * @param name\n\t   * @param value\n\t   * @returns {*}\n\t   */\n\t\n\t\t}, {\n\t\t\tkey: \"viewProp\",\n\t\t\tvalue: function viewProp() {\n\t\t\t\tvar key = arguments.length <= 0 || arguments[0] === undefined ? 'default' : arguments[0];\n\t\t\t\tvar name = arguments[1];\n\t\t\t\tvar value = arguments[2];\n\t\n\t\t\t\tif (_lodash2.default.isUndefined(value)) {\n\t\t\t\t\tif (key == 'default') return this.prop(name, value);\n\t\t\t\t\treturn this.viewProps[key][name];\n\t\t\t\t}\n\t\t\t\tif (key == 'default') {\n\t\t\t\t\tthis.prop(name, value);\n\t\t\t\t} else {\n\t\t\t\t\tif (!this.viewProps[key]) this.viewProps[key] = {};\n\t\t\t\t\tthis.viewProps[key][name] = value;\n\t\t\t\t}\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"createDecorators\",\n\t\t\tvalue: function createDecorators(decorators) {}\n\t\n\t\t\t/**\n\t   * Get properties needed for rendering this element\n\t   * @returns {{key: (string|*), className: *, namespace: *, bounds: *}}\n\t   */\n\t\n\t\t}, {\n\t\t\tkey: \"getView\",\n\t\t\tvalue: function getView(key) {\n\t\t\t\tvar shape = this.getShape(key);\n\t\t\t\treturn _lodash2.default.assign({\n\t\t\t\t\tid: this.id,\n\t\t\t\t\tkey: key,\n\t\t\t\t\tclassName: this.computedClassName,\n\t\t\t\t\tstyle: this.viewProp(key, 'style'),\n\t\t\t\t\tnamespace: this.namespace\n\t\t\t\t}, shape);\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"getShape\",\n\t\t\tvalue: function getShape(key) {\n\t\t\t\tvar shape = _Cache2.default.get(this.id + \".shape\", key);\n\t\t\t\tif (shape) return shape;\n\t\n\t\t\t\tvar shapeConfig = this.viewProp(key, 'shape');\n\t\t\t\tvar shapeClass = shapeConfig ? _Shape2.default.getShape(shapeConfig.name) : _Shape2.default.getShape('Rectangle');\n\t\t\t\tvar x = this.viewProp(key, \"x\");\n\t\t\t\tvar y = this.viewProp(key, \"y\");\n\t\t\t\tvar width = this.viewProp(key, \"width\");\n\t\t\t\tvar height = this.viewProp(key, \"height\");\n\t\t\t\tshape = new shapeClass(x, y, width, height, shapeConfig);\n\t\t\t\t_Cache2.default.set(this.id + '.shape', shape, key);\n\t\t\t\treturn shape;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"render\",\n\t\t\tvalue: function render(view) {\n\t\t\t\tvar template = _Cache2.default.get(this.id + '.template', view.id);\n\t\t\t\tif (!template) {\n\t\t\t\t\t//create the template\n\t\t\t\t\tvar role = this.prop('role');\n\t\t\t\t\ttemplate = view.getTemplate('$' + role, null, this);\n\t\t\t\t\tif (_lodash2.default.isString(template)) template = _lodash2.default.template(template);\n\t\t\t\t\t_Cache2.default.set(this.id + '.template', template, view.id);\n\t\t\t\t}\n\t\t\t\treturn template(this.getView(view.id));\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"renderShape\",\n\t\t\tvalue: function renderShape(view) {\n\t\t\t\tvar shape = this.getShape(view.id);\n\t\t\t\tif (shape) return shape.render(view);\n\t\t\t\treturn '';\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"renderLabel\",\n\t\t\tvalue: function renderLabel(view) {\n\t\t\t\tif (this == this.graph.currentRoot) return null;\n\t\t\t\tvar box = this.getLabelBox(view.id);\n\t\t\t\tif (box) return view.renderLabel(box);\n\t\t\t\treturn '';\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"getLabelBox\",\n\t\t\tvalue: function getLabelBox(key) {\n\t\t\t\tvar box = _Cache2.default.get(this.id + '.labelBox', key);\n\t\t\t\tif (box) return box;\n\t\t\t\tvar shape = this.getShape(key);\n\t\t\t\t// Just get the config will have a positive performance boost for IE11 and IE10.\n\t\t\t\tbox = _Label2.default.getLabelBox(this.prop('label'), this.viewProp(key, 'labelConfig'), shape.width, shape.height);\n\t\t\t\t_Cache2.default.set(this.id + '.labelBox', box, key);\n\t\t\t\treturn box;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"destroy\",\n\t\t\tvalue: function destroy() {\n\t\t\t\tdelete this.graph;\n\t\t\t\tdelete this.decorators;\n\t\t\t\tdelete this.props;\n\t\t\t\tdelete this.viewProps;\n\t\t\t\tthis.destroyed = true;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"computedClassName\",\n\t\t\tget: function get() {\n\t\t\t\tif (!this._computedClassName) {\n\t\t\t\t\tvar buf = new _StringBuffer2.default(this.prop(\"role\"));\n\t\t\t\t\tvar props = this.props;\n\t\t\t\t\tif (props.hasOwnProperty(\"className\")) buf.append(props[\"className\"]);\n\t\t\t\t\tprops = props.constructor.prototype;\n\t\t\t\t\twhile (props) {\n\t\t\t\t\t\tif (props.hasOwnProperty(\"className\")) buf.append(props[\"className\"]);\n\t\t\t\t\t\tprops = Object.getPrototypeOf(props);\n\t\t\t\t\t}\n\t\t\t\t\tthis._computedClassName = buf.toString(' ');\n\t\t\t\t}\n\t\t\t\treturn this._computedClassName;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"namespace\",\n\t\t\tget: function get() {\n\t\t\t\tif (this == this.graph.currentRoot) return '';\n\t\t\t\treturn \"root.\" + this.prop(\"role\");\n\t\t\t}\n\t\t}]);\n\t\n\t\treturn Cell;\n\t}();\n\t\n\t/*\n\t\n\tCell.prototype.move = function(x, y) {\n\t\tthis.setProperty(\"x\", Math.round(x));\n\t\tthis.setProperty(\"y\", Math.round(y));\n\t\tdelete this.bounds;\n\t};\n\t\n\tCell.prototype.resize = function(w, h) {\n\t\tthis.setProperty(\"width\", w);\n\t\tthis.setProperty(\"height\", h);\n\t\tdelete this.bounds;\n\t};\n\t\n\tCell.prototype.canEdit = function() {\n\t\treturn (this.graph ? this.graph.canEdit() : true) && this.getProperty(\"editable\");\n\t};\n\t\n\tCell.prototype.canSelect = function() {\n\t\treturn (this.graph ? this.graph.canSelect() : true) && this.getProperty(\"selectable\");\n\t};\n\t\n\tCell.prototype.canMove = function() {\n\t\treturn (this.graph ? this.graph.canEdit() : true) && this.getProperty(\"draggable\");\n\t};\n\t\n\tCell.prototype.canResize = function() {\n\t\treturn (this.graph ? this.graph.canEdit() : true) && this.getProperty(\"resizable\");\n\t};\n\t\n\tCell.prototype.getTypeFromString = function(typeStr) {\n\t\treturn this.graph.getType(typeStr);\n\t};\n\t\n\tCell.prototype.createModifiers = function(modifiers) {\n\t\tthis.modifiers = null;\n\t\tvar modifierSettings = this.getProperty(\"modifierSettings\");\n\t\tif (modifierSettings) {\n\t\t\t_.each(modifiers, function(config) {\n\t\t\t\tconfig.type = this.graph.getModifierType(config.className);\n\t\t\t\tconfig.setting = modifierSettings[config.className];\n\t\t\t\tif (!config.type || !config.setting) return;\n\t\n\t\t\t\tthis.addModifier(config.className, new Modifier(this, config));\n\t\t\t}, this);\n\t\n\t\t\t// Check for showAlways settings\n\t\t\t_.each(modifierSettings, function(setting, name) {\n\t\t\t\tif (setting.showAlways && (!this.modifiers || !this.modifiers[name])) {\n\t\t\t\t\tvar config = {type: this.graph.getModifierType(name), setting: setting};\n\t\t\t\t\tif (!config.type) return;\n\t\t\t\t\tthis.addModifier(name, new Modifier(this, config));\n\t\t\t\t}\n\t\t\t}, this);\n\t\t}\n\t};\n\t\n\tCell.prototype.addModifier = function(name, modifier) {\n\t\tif (!this.modifiers)\n\t\t\tthis.modifiers = {};\n\t\n\t\tif (!modifier.hasOwnProperty(\"showHeader\"))\n\t\t\tmodifier.showHeader = true;\n\t\n\t\t// @hack preferably set it in configurations.\n\t\tif (modifier.name == \"HoverProcessModifier\" || modifier.name == \"HoverResults\")\n\t\t\tmodifier.showHeader = false;\n\t\n\t\tthis.modifiers[name] = modifier;\n\t};\n\t\n\tCell.prototype.getModifiers = function() {\n\t\tif (_.isUndefined(this.modifiers))\n\t\t\tthis.createModifiers();\n\t\treturn this.modifiers;\n\t};\n\t\n\tCell.prototype.getModifier = function(name) {\n\t\tvar modifiers = this.getModifiers();\n\t\tif (modifiers)\n\t\t\treturn modifiers[name];\n\t\treturn null;\n\t};\n\t\n\tCell.prototype.isVisible = function() {\n\t\treturn this.getProperty('visible');\n\t};\n\t\n\tCell.prototype.isContainer = function() {\n\t\treturn false;\n\t};\n\t*/\n\t\n\t\n\texports.default = Cell;\n\n/***/ },\n/* 18 */\n/***/ function(module, exports) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t\tvalue: true\n\t});\n\t/**\n\t * Created by tong on 6/7/2016.\n\t */\n\t\n\tvar caches = {};\n\t\n\tvar Cache = {\n\t\tget: function get(key, namespace) {\n\t\t\treturn this.getCache(namespace)[key];\n\t\t},\n\t\n\t\tset: function set(key, value, namespace) {\n\t\t\tthis.getCache(namespace)[key] = value;\n\t\t},\n\t\n\t\tcontains: function contains(key, namespace) {\n\t\t\treturn key in this.getCache(namespace);\n\t\t},\n\t\n\t\tremove: function remove(key, namespace) {\n\t\t\tdelete this.getCache(namespace)[key];\n\t\t},\n\t\n\t\tclear: function clear(namesapce) {\n\t\t\tif (!namespace) caches = {};else if (caches[namespace]) caches[namespace] = {};\n\t\t},\n\t\n\t\tgetCache: function getCache() {\n\t\t\tvar namespace = arguments.length <= 0 || arguments[0] === undefined ? 'default' : arguments[0];\n\t\n\t\t\tif (!caches[namespace]) caches[namespace] = {};\n\t\t\treturn caches[namespace];\n\t\t}\n\t};\n\t\n\texports.default = Cache;\n\n/***/ },\n/* 19 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t\tvalue: true\n\t});\n\t\n\tvar _lodash = __webpack_require__(5);\n\t\n\tvar _lodash2 = _interopRequireDefault(_lodash);\n\t\n\tvar _bean = __webpack_require__(12);\n\t\n\tvar _bean2 = _interopRequireDefault(_bean);\n\t\n\tvar _Utils = __webpack_require__(2);\n\t\n\tvar _Utils2 = _interopRequireDefault(_Utils);\n\t\n\tvar _DomUtils = __webpack_require__(7);\n\t\n\tvar _DomUtils2 = _interopRequireDefault(_DomUtils);\n\t\n\tvar _StringBuffer = __webpack_require__(8);\n\t\n\tvar _StringBuffer2 = _interopRequireDefault(_StringBuffer);\n\t\n\tvar _Rectangle = __webpack_require__(4);\n\t\n\tvar _Rectangle2 = _interopRequireDefault(_Rectangle);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tvar FONT_BOLD = 1,\n\t    FONT_ITALIC = 2,\n\t    FONT_UNDERLINE = 4,\n\t    FONT_SHADOW = 8;\n\t\n\tvar defaultConfig = {\n\t\tfontSize: 11,\n\t\tfontFamily: \"Arial\",\n\t\tfontStyle: 0,\n\t\tfontColor: 'black',\n\t\tpadding: 0,\n\t\tlinePadding: 0,\n\t\talign: \"left\",\n\t\twidth: 0,\n\t\theight: 0,\n\t\trotation: null,\n\t\tgeometry: { x: 0, y: 0, anchorY: 0, offsetX: 0, offsetY: 0 }\n\t};\n\t\n\t/**\n\t * The label object handles label sizing/positioning\n\t */\n\t\n\texports.default = function () {\n\t\tvar stringMeasureEl = null,\n\t\t    measureDiv = void 0,\n\t\t    baselineDiv = void 0;\n\t\n\t\t/**\n\t  * Calculate the size of the string.\n\t  */\n\t\tvar getStringSize = _lodash2.default.memoize(function (str, fontSize, fontFamily, bold) {\n\t\t\tfontSize = fontSize || 11;\n\t\t\tfontFamily = fontFamily || 'Arial,Helvetica';\n\t\t\tbold = !_lodash2.default.isUndefined(bold) ? bold : false;\n\t\n\t\t\t// first check if there is a string-measuring div available, if not, create now.\n\t\t\tif (!stringMeasureEl) {\n\t\t\t\tstringMeasureEl = _DomUtils2.default.createElement('iframe', { id: \"_ComputeStylesIframe\" }, { position: \"absolute\", visibility: \"hidden\", width: \"auto\" });\n\t\t\t\tdocument.body.appendChild(stringMeasureEl);\n\t\t\t\tvar doc = stringMeasureEl.contentWindow.document;\n\t\t\t\tdoc.open();\n\t\t\t\tdoc.write('<html><body>\\\n\t\t\t\t\t<div id=\"baselineDiv\" style=\"height:100px;\"><span style=\"line-height:0\">T</span><span style=\"height:100%;display:inline-block;\"></span></div>\\\n\t\t\t\t\t<div id=\"measureDiv\" style=\"position:absolute;width:auto;height:auto;padding:0;white-space:pre-wrap;word-wrap:break-word;display:inline-block;\"></div>\\\n\t\t\t\t\t</body></html>');\n\t\t\t\tdoc.close();\n\t\t\t\tmeasureDiv = doc.getElementById(\"measureDiv\");\n\t\t\t\tbaselineDiv = doc.getElementById(\"baselineDiv\");\n\t\t\t}\n\t\t\tbaselineDiv.style.fontSize = measureDiv.style.fontSize = fontSize;\n\t\t\tbaselineDiv.style.fontFamily = measureDiv.style.fontFamily = fontFamily;\n\t\t\tbaselineDiv.style.fontWeight = measureDiv.style.fontWeight = bold ? 'bold' : 'normal';\n\t\t\tmeasureDiv.innerHTML = str;\n\t\n\t\t\tvar strut = baselineDiv.firstChild;\n\t\t\tvar baselineHeight = strut.offsetTop + strut.offsetHeight - baselineDiv.offsetHeight - baselineDiv.offsetTop;\n\t\n\t\t\treturn { width: measureDiv.offsetWidth, height: measureDiv.offsetHeight, baseline: baselineHeight };\n\t\t}, function (str, fontSize, fontFamily, bold) {\n\t\t\treturn str + ';' + fontSize + ';' + fontFamily + ';' + bold;\n\t\t});\n\t\n\t\t/**\n\t  * Create a wrapped text.\n\t  * @param {String} string the string to wrap.\n\t  * @param {maxWidth} the maximum width this string can take.\n\t  * @param {fontSize}\n\t  * @param {fontFamily}\n\t  * @param {bold}\n\t  */\n\t\tvar wrap = _lodash2.default.memoize(function (string, maxWidth, fontSize, fontFamily, bold) {\n\t\t\tmaxWidth = maxWidth || 0;\n\t\t\tfontSize = fontSize || 11;\n\t\t\tfontFamily = fontFamily || 'Arial,Helvetica';\n\t\t\tbold = !_lodash2.default.isUndefined(bold) ? bold : false;\n\t\n\t\t\tvar arr = [];\n\t\t\tvar spaceSize = getStringSize(\"&nbsp;\", fontSize, fontFamily, bold),\n\t\t\t    space = spaceSize.width;\n\t\t\tarr.lineHeight = spaceSize.height;\n\t\t\tarr.baseline = spaceSize.baseline;\n\t\n\t\t\tif (!maxWidth || !string || string == \"\") {\n\t\t\t\tarr.push(string);\n\t\t\t\tarr.width = !string || string == \"\" ? space : getStringSize(string, fontSize, fontFamily, bold).width;\n\t\t\t\tarr.height = arr.lineHeight;\n\t\t\t\treturn arr;\n\t\t\t}\n\t\n\t\t\tvar width = 0;\n\t\t\t//split the text by lines\n\t\t\tvar lines = string.split('\\n');\n\t\n\t\t\tvar buf = new _StringBuffer2.default();\n\t\n\t\t\tfor (var j = 0; j < lines.length; j++) {\n\t\t\t\t//split each line by word\n\t\t\t\tvar words = lines[j].split(/\\s/);\n\t\t\t\tvar line = \"\",\n\t\t\t\t    currentWidth = 0,\n\t\t\t\t    wordWidth = 0,\n\t\t\t\t    newLine = true,\n\t\t\t\t    word;\n\t\n\t\t\t\tfor (var i = 0; i < words.length; i++) {\n\t\t\t\t\tword = words[i];\n\t\t\t\t\twordWidth = getStringSize(word, fontSize, fontFamily, bold).width;\n\t\n\t\t\t\t\tif ((newLine ? wordWidth : currentWidth + space + wordWidth) > maxWidth) {\n\t\t\t\t\t\tif (newLine) {\n\t\t\t\t\t\t\tbuf.append(word);\n\t\t\t\t\t\t\twidth = Math.max(width, wordWidth);\n\t\t\t\t\t\t\tif (i < words.length - 1) {\n\t\t\t\t\t\t\t\tarr.push(buf.toString());\n\t\t\t\t\t\t\t\tbuf.clear();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tarr.push(buf.append(line).toString());\n\t\t\t\t\t\t\twidth = Math.max(width, currentWidth + space + wordWidth);\n\t\t\t\t\t\t\tbuf.clear();\n\t\t\t\t\t\t}\n\t\t\t\t\t\tline = \"\";\n\t\t\t\t\t\tcurrentWidth = 0;\n\t\t\t\t\t\tif (!newLine) i--; // move back one word.\n\t\t\t\t\t\tnewLine = true;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tline = newLine ? word : line + \" \" + word;\n\t\t\t\t\t\tcurrentWidth = newLine ? wordWidth : currentWidth + space + wordWidth;\n\t\t\t\t\t\twidth = Math.max(width, currentWidth);\n\t\t\t\t\t\tnewLine = false;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (line != \"\") buf.append(line);\n\t\t\t\tif (j < lines.length - 1) {\n\t\t\t\t\tarr.push(buf.toString());\n\t\t\t\t\tbuf.clear();\n\t\t\t\t}\n\t\t\t}\n\t\n\t\t\tarr.push(buf.toString());\n\t\t\tarr.width = width;\n\t\t\tarr.height = arr.lineHeight * arr.length;\n\t\t\treturn arr;\n\t\t}, function (str, maxWidth, fontSize, fontFamily, bold) {\n\t\t\treturn str + ';' + maxWidth + ';' + fontSize + ';' + fontFamily + ';' + bold;\n\t\t});\n\t\n\t\t/**\n\t  *  Get the view information for how to display the label.\n\t  * @param label The string that needs to be displayed\n\t  * @param containerWidth The width of the parent container.\n\t  * @param containerHeight The height of the parent container.\n\t  * @param labelConfig The configuration on how to display label. It should be an object with the following parameters:\n\t  * {\n\t  *      fontSize, fontFamily, fontStyle, padding,\n\t  *      align: can be either \"left\", \"center\" or \"right\",\n\t  *      width: the maximum width of the label. if less than 1, then is treated as percentage. If 0, no wrapping will occur,\n\t  *      height,\n\t  *      geometry\n\t  * }\n\t  * @returns {*}\n\t  */\n\t\tfunction getLabelBox(label, labelConfig, containerWidth, containerHeight) {\n\t\t\treturn _getLabelBox.call(this, label, labelConfig, { width: containerWidth, height: containerHeight });\n\t\t}\n\t\n\t\tfunction getLabelBoxForLink(label, labelConfig, link) {\n\t\t\treturn _getLabelBox.call(this, label, labelConfig, link);\n\t\t}\n\t\n\t\tfunction _getLabelBox(label) {\n\t\t\tvar labelConfig = arguments.length <= 1 || arguments[1] === undefined ? {} : arguments[1];\n\t\t\tvar context = arguments[2];\n\t\n\t\t\tlabelConfig = _lodash2.default.defaultsDeep(labelConfig, defaultConfig);\n\t\t\tvar fontSize = labelConfig.fontSize;\n\t\t\tvar fontFamily = labelConfig.fontFamily;\n\t\t\tvar fontStyle = labelConfig.fontStyle;\n\t\t\tvar bold = (fontStyle & FONT_BOLD) == FONT_BOLD;\n\t\t\tvar padding = labelConfig.padding;\n\t\t\tvar linePadding = labelConfig.linePadding;\n\t\t\tvar align = labelConfig.align;\n\t\n\t\t\tvar w = labelConfig.width,\n\t\t\t    h = labelConfig.height;\n\t\t\tif (context.width) {\n\t\t\t\tw = w <= 5 ? context.width * w : w;\n\t\t\t\th = h <= 5 ? context.height * h : h;\n\t\t\t}\n\t\t\tw -= 2 * padding;\n\t\t\th -= 2 * padding;\n\t\t\tw = Math.max(0, w);\n\t\t\th = Math.max(0, h);\n\t\n\t\t\tvar geometry = _lodash2.default.clone(labelConfig.geometry);\n\t\t\tvar wrappedLabel = this.wrap(label, w, fontSize, fontFamily, bold);\n\t\t\tgeometry.width = wrappedLabel.width + 2 * padding;\n\t\t\tgeometry.height = wrappedLabel.height + 2 * padding + (wrappedLabel.length - 1) * linePadding;\n\t\t\tvar anchor = \"start\",\n\t\t\t    dx = 0,\n\t\t\t    setAnchorX = !_lodash2.default.has(geometry, \"anchorX\");\n\t\t\tswitch (align) {\n\t\t\t\tcase \"center\":\n\t\t\t\t\tanchor = \"middle\";\n\t\t\t\t\tif (setAnchorX) geometry.anchorX = 0;\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"right\":\n\t\t\t\t\tanchor = \"end\";\n\t\t\t\t\tdx = wrappedLabel.width / 2;\n\t\t\t\t\tif (setAnchorX) geometry.anchorX = -0.5;\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"left\":\n\t\t\t\t\tdx = -wrappedLabel.width / 2;\n\t\t\t\t\tif (setAnchorX) geometry.anchorX = 0.5;\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t\tvar pos = void 0;\n\t\t\tif (context.getRelativePosition) pos = context.getRelativePosition(geometry);else pos = _Utils2.default.getRelativePosition({ width: context.width, height: context.height }, geometry);\n\t\n\t\t\tvar bounds = new _Rectangle2.default(pos[0], pos[1], geometry.width, geometry.height);\n\t\t\t// the pivot is the center of rotation when the label has a rotation specified.\n\t\t\tvar pivot = align == 'center' ? [0, 0] : align == 'left' ? [-wrappedLabel.width / 2, 0] : [wrappedLabel.width / 2, 0];\n\t\n\t\t\t// the maximum bounds for the label, used to position inline editor\n\t\t\tgeometry.width = Math.max(w + 2 * padding, geometry.width);\n\t\t\tgeometry.height = Math.max(h + 2 * padding, geometry.height);\n\t\n\t\t\tif (context.getRelativePosition) pos = context.getRelativePosition(geometry);else pos = _Utils2.default.getRelativePosition({ width: context.width, height: context.height }, geometry);\n\t\n\t\t\tvar maxBounds = new _Rectangle2.default(pos[0], pos[1], geometry.width, geometry.height);\n\t\t\treturn {\n\t\t\t\tconfig: labelConfig, label: wrappedLabel, _label: label,\n\t\t\t\tbold: bold, underline: fontStyle & FONT_UNDERLINE, italic: fontStyle & FONT_ITALIC, shadow: fontStyle & FONT_SHADOW,\n\t\t\t\tdx: dx, dy: -geometry.height / 2 + padding + wrappedLabel.lineHeight - wrappedLabel.baseline, anchor: anchor, lineHeight: wrappedLabel.lineHeight + linePadding,\n\t\t\t\tpivot: pivot, bounds: bounds, maxBounds: maxBounds\n\t\t\t};\n\t\t}\n\t\n\t\tfunction render(view, box) {\n\t\t\treturn view.renderLabel(box);\n\t\t}\n\t\n\t\tvar editor = {\n\t\t\tstart: function start(key, container, box, refEl, textEl) {\n\t\t\t\tvar _this = this;\n\t\n\t\t\t\tvar scale = arguments.length <= 5 || arguments[5] === undefined ? 1.0 : arguments[5];\n\t\t\t\tvar singleLine = arguments.length <= 6 || arguments[6] === undefined ? true : arguments[6];\n\t\n\t\t\t\tif (this.input) {\n\t\t\t\t\tif (this.key != key) {\n\t\t\t\t\t\t// need to close the existing editor first\n\t\t\t\t\t\tthis.stop();\n\t\t\t\t\t} else return;\n\t\t\t\t}\n\t\t\t\tvar tag = singleLine ? 'input' : 'textarea';\n\t\t\t\tthis.input = _DomUtils2.default.createElement(tag, { id: \"inlineEditor\", unselectable: \"off\" }, { position: \"absolute\", overflow: \"hidden\", padding: \"0px\", margin: \"0px\", border: \"transparent\" });\n\t\t\t\tif (singleLine) {\n\t\t\t\t\t_bean2.default.on(this.input, 'keydown keyup', function (event) {\n\t\t\t\t\t\tif (event.keyCode == 13) {\n\t\t\t\t\t\t\t_bean2.default.off(_this.input, 'keydown keyup');\n\t\t\t\t\t\t\t_this.stop();\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\tcontainer.appendChild(this.input);\n\t\n\t\t\t\tthis.key = key;\n\t\t\t\tthis.box = box;\n\t\t\t\tthis.refEl = refEl;\n\t\t\t\tthis.textEl = textEl;\n\t\n\t\t\t\tvar labelConfig = box.config;\n\t\t\t\tvar maxBounds = new _Rectangle2.default(box.maxBounds.x, box.maxBounds.y, box.maxBounds.width * scale, box.maxBounds.height * scale);\n\t\t\t\tvar pos = _DomUtils2.default.getCenterPosition(refEl, container);\n\t\t\t\tpos = [pos[0] + maxBounds.left, pos[1] + maxBounds.top];\n\t\n\t\t\t\tif (textEl) textEl.style.visibility = 'hidden';\n\t\n\t\t\t\t_DomUtils2.default.setElement(this.input, null, {\n\t\t\t\t\tvisibility: 'visible',\n\t\t\t\t\tleft: pos[0] + \"px\",\n\t\t\t\t\ttop: pos[1] + \"px\",\n\t\t\t\t\twidth: maxBounds.width + 'px',\n\t\t\t\t\theight: maxBounds.height + 'px',\n\t\t\t\t\t\"font-family\": labelConfig.fontFamily,\n\t\t\t\t\t\"font-size\": labelConfig.fontSize * scale + 'px',\n\t\t\t\t\t\"font-weight\": (labelConfig.fontStyle & FONT_BOLD) == FONT_BOLD ? 'bold' : 'normal'\n\t\t\t\t\t/*\"color\": labelConfig.fontColor*/\n\t\t\t\t});\n\t\n\t\t\t\tthis.input.value = box._label;\n\t\t\t\tthis.input.focus();\n\t\t\t\tthis.input.select();\n\t\t\t\t_bean2.default.fire(this, 'editor.start', [this.key]);\n\t\t\t},\n\t\n\t\t\tstop: function stop(cancel) {\n\t\t\t\tif (!this.input) return;\n\t\n\t\t\t\tcancel = cancel || false;\n\t\t\t\tif (this.textEl) this.textEl.style.visibility = null;\n\t\n\t\t\t\tif (!cancel) _bean2.default.fire(this, 'editor.update', [this.key, this.input.value]);\n\t\n\t\t\t\t_bean2.default.fire(this, 'editor.stop', [this.key]);\n\t\n\t\t\t\t// remove the input\n\t\t\t\tthis.input.parentNode.removeChild(this.input);\n\t\t\t\tdelete this.input;\n\t\t\t\tdelete this.key;\n\t\t\t\tdelete this.box;\n\t\t\t\tdelete this.refEl;\n\t\t\t\tdelete this.textEl;\n\t\t\t}\n\t\t};\n\t\n\t\treturn {\n\t\t\tFONT_BOLD: FONT_BOLD,\n\t\t\tFONT_ITALIC: FONT_ITALIC,\n\t\t\tFONT_UNDERLINE: FONT_UNDERLINE,\n\t\t\tFONT_SHADOW: FONT_SHADOW,\n\t\t\tgetStringSize: getStringSize,\n\t\t\twrap: wrap,\n\t\t\tgetLabelBox: getLabelBox,\n\t\t\tgetLabelBoxForLink: getLabelBoxForLink,\n\t\t\trender: render,\n\t\t\teditor: editor\n\t\t};\n\t}();\n\n/***/ },\n/* 20 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t\tvalue: true\n\t});\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tvar _get = function get(object, property, receiver) { if (object === null) object = Function.prototype; var desc = Object.getOwnPropertyDescriptor(object, property); if (desc === undefined) { var parent = Object.getPrototypeOf(object); if (parent === null) { return undefined; } else { return get(parent, property, receiver); } } else if (\"value\" in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } };\n\t\n\tvar _lodash = __webpack_require__(5);\n\t\n\tvar _lodash2 = _interopRequireDefault(_lodash);\n\t\n\tvar _Cell2 = __webpack_require__(17);\n\t\n\tvar _Cell3 = _interopRequireDefault(_Cell2);\n\t\n\tvar _Rectangle = __webpack_require__(4);\n\t\n\tvar _Rectangle2 = _interopRequireDefault(_Rectangle);\n\t\n\tvar _Link = __webpack_require__(11);\n\t\n\tvar _Link2 = _interopRequireDefault(_Link);\n\t\n\tvar _Label = __webpack_require__(19);\n\t\n\tvar _Label2 = _interopRequireDefault(_Label);\n\t\n\tvar _Cache = __webpack_require__(18);\n\t\n\tvar _Cache2 = _interopRequireDefault(_Cache);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\t\n\tfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\t\n\tvar Edge = function (_Cell) {\n\t\t_inherits(Edge, _Cell);\n\t\n\t\tfunction Edge(graph) {\n\t\t\tvar config = arguments.length <= 1 || arguments[1] === undefined ? {} : arguments[1];\n\t\t\tvar source = arguments[2];\n\t\t\tvar target = arguments[3];\n\t\n\t\t\t_classCallCheck(this, Edge);\n\t\n\t\t\tif (!config.id) config.id = _lodash2.default.uniqueId('E');\n\t\n\t\t\tvar _this = _possibleConstructorReturn(this, Object.getPrototypeOf(Edge).call(this, graph, config));\n\t\n\t\t\t_this.source = _this.target = null;\n\t\t\t_this.setSource(source, config.sourcePos);\n\t\t\t_this.setTarget(target, config.targetPos);\n\t\t\treturn _this;\n\t\t}\n\t\n\t\t_createClass(Edge, [{\n\t\t\tkey: \"setSource\",\n\t\t\tvalue: function setSource(node, pos) {\n\t\t\t\tthis.setTerminal(node, pos, 'source');\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"setTarget\",\n\t\t\tvalue: function setTarget(node, pos) {\n\t\t\t\tthis.setTerminal(node, pos, 'target');\n\t\t\t}\n\t\n\t\t\t/**\n\t   * Internal methods to set either the source or target\n\t   */\n\t\n\t\t}, {\n\t\t\tkey: \"setTerminal\",\n\t\t\tvalue: function setTerminal(node, pos, dir) {\n\t\t\t\tvar end = dir == 'source' ? this.source : this.target;\n\t\t\t\tif (end == node) {\n\t\t\t\t\t// simply change the position of the edge.\n\t\t\t\t\tif (node) node.setEdgeAt(this, pos);\n\t\t\t\t} else {\n\t\t\t\t\tif (end) {\n\t\t\t\t\t\t// first remove the edge from the current end\n\t\t\t\t\t\tend.removeEdge(this);\n\t\t\t\t\t}\n\t\n\t\t\t\t\tif (node) {\n\t\t\t\t\t\tif (dir == 'source') node.addOutEdge(this, pos);else node.addInEdge(this, pos);\n\t\t\t\t\t}\n\t\t\t\t\tif (dir == 'source') this.source = node;else this.target = node;\n\t\t\t\t\t//this.clearPoints();\n\t\t\t\t}\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"getLabelBox\",\n\t\t\tvalue: function getLabelBox(key) {\n\t\t\t\tvar label = this.prop('label');\n\t\t\t\tif (label) return _Label2.default.getLabelBoxForLink(label, this.viewProp(key, 'labelConfig'), this.getShape(key));\n\t\t\t\treturn null;\n\t\t\t}\n\t\n\t\t\t/**\n\t   * Return a pair of points as reference to the calculation of start and end points.\n\t   */\n\t\n\t\t}, {\n\t\t\tkey: \"getReferencePoints\",\n\t\t\tvalue: function getReferencePoints(key) {\n\t\t\t\tvar pts = [];\n\t\t\t\tif (this.source) pts.push(this.source.getShape(key).center);else pts.push(this.viewProp(key, 'start'));\n\t\n\t\t\t\tif (this.target) pts.push(this.target.getShape(key).center);else pts.push(this.viewProp(key, 'end'));\n\t\n\t\t\t\treturn pts;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"getTerminalVisual\",\n\t\t\tvalue: function getTerminalVisual(key, orthogonal) {\n\t\t\t\tvar refPts = this.getReferencePoints(key);\n\t\t\t\tvar terminals = [];\n\t\n\t\t\t\tvar getBound = function getBound(pt) {\n\t\t\t\t\treturn new _Rectangle2.default(pt.x, pt.y, 3, 3);\n\t\t\t\t};\n\t\n\t\t\t\tif (this.source) {\n\t\t\t\t\tterminals.push(this.source.getPort(key, this.prop('sourcePort'), refPts[1], orthogonal));\n\t\t\t\t} else terminals.push({ point: refPts[0], direction: _Rectangle2.default.getDirection(getBound(refPts[0]), refPts[1], true) });\n\t\n\t\t\t\tif (this.target) {\n\t\t\t\t\tterminals.push(this.target.getPort(key, this.prop('targetPort'), refPts[0], orthogonal));\n\t\t\t\t} else terminals.push({ point: refPts[1], direction: _Rectangle2.default.getDirection(getBound(refPts[1]), refPts[0], true) });\n\t\t\t\treturn terminals;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"getShape\",\n\t\t\tvalue: function getShape(key) {\n\t\t\t\tvar shape = _Cache2.default.get(this.id + \".shape\", key);\n\t\t\t\tif (shape) return shape;\n\t\n\t\t\t\tvar config = this.viewProp(key, 'shape');\n\t\t\t\tshape = _Link2.default.getLink(this.getTerminalVisual(key, config.orthogonal), config, this.prop('startMarker'), this.prop('endMarker'));\n\t\t\t\t_Cache2.default.set(this.id + '.shape', shape, key);\n\t\t\t\treturn shape;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"toString\",\n\t\t\tvalue: function toString() {\n\t\t\t\treturn 'Edge:{' + (!this.source ? 'null' : this.source.id) + '--' + (!this.target ? 'null' : this.target.id) + '}';\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"destroy\",\n\t\t\tvalue: function destroy() {\n\t\t\t\t_get(Object.getPrototypeOf(Edge.prototype), \"destroy\", this).call(this);\n\t\t\t\tthis.setSource(null);\n\t\t\t\tthis.setTarget(null);\n\t\t\t}\n\t\t}]);\n\t\n\t\treturn Edge;\n\t}(_Cell3.default);\n\t\n\tEdge.namespace = \"Edges\";\n\t\n\texports.default = Edge;\n\t\n\t/*\n\n\tEdge.prototype.isVisible = function() {\n\t\tif (this.graph.getProperty(\"allowDanglingEdges\")) {\n\t\t\treturn (this.source ? this.source.isVisible() : true) && (this.target ? this.target.isVisible() : true) && this.getProperty(\"visible\");\n\t\t} else\n\t\t\treturn this.source && this.target && this.getProperty('visible') && this.source.isVisible() && this.target.isVisible();\n\t};\n\n\t*/\n\n/***/ },\n/* 21 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t\tvalue: true\n\t});\n\t\n\tvar _Rectangle = __webpack_require__(4);\n\t\n\tvar _Rectangle2 = _interopRequireDefault(_Rectangle);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tvar registry = {};\n\t\n\tvar Marker = function () {\n\t\n\t\t/** Begin Standard Marker Type **/\n\t\tfunction arrow(size, source, styles) {\n\t\t\tvar sign = source ? -1 : 1;\n\t\t\tvar marker = {\n\t\t\t\tviewBox: new _Rectangle2.default(-5, -5, 10, 10),\n\t\t\t\tsize: size,\n\t\t\t\tref: [4 * sign, 0],\n\t\t\t\tfill: styles.color\n\t\t\t};\n\t\t\tmarker.shape = {\n\t\t\t\tname: 'Polygon',\n\t\t\t\tpoints: [[-2 * sign, 0], [-4 * sign, 4], [4 * sign, 0], [-4 * sign, -4]]\n\t\t\t};\n\t\t\treturn marker;\n\t\t}\n\t\n\t\tfunction triangle(size, source, styles) {\n\t\t\tvar sign = source ? -1 : 1;\n\t\t\tvar marker = {\n\t\t\t\tviewBox: new _Rectangle2.default(-5, -5, 10, 10),\n\t\t\t\tsize: size,\n\t\t\t\tref: [4 * sign, 0],\n\t\t\t\tfill: styles.color\n\t\t\t};\n\t\t\tmarker.shape = {\n\t\t\t\tname: 'Polygon',\n\t\t\t\tpoints: [[-5 * sign, -5], [-5 * sign, 5], [4 * sign, 0]]\n\t\t\t};\n\t\t\treturn marker;\n\t\t}\n\t\n\t\tfunction oval(size, source, styles) {\n\t\t\tvar r = size / 2;\n\t\t\tvar marker = {\n\t\t\t\tviewBox: new _Rectangle2.default(-r, -r, size, size),\n\t\t\t\tsize: size,\n\t\t\t\tref: [0, 0],\n\t\t\t\tfill: styles.color\n\t\t\t};\n\t\t\tmarker.shape = '<ellipse cx=\"0\" cy=\"0\" rx=\"' + r + '\" ry=\"' + r + '\"></ellipse>';\n\t\t\treturn marker;\n\t\t}\n\t\n\t\tfunction diamond(size, source, styles) {\n\t\t\tvar sign = source ? -1 : 1;\n\t\t\tvar marker = {\n\t\t\t\tviewBox: new _Rectangle2.default(-5, -5, 10, 10),\n\t\t\t\tsize: size,\n\t\t\t\tref: [4 * sign, 0],\n\t\t\t\tfill: styles.color\n\t\t\t};\n\t\t\tmarker.shape = '';\n\t\t\treturn marker;\n\t\t}\n\t\t/** End Standard Marker Type **/\n\t\tfunction getMarker(config, source) {\n\t\t\tvar factory = registry[config.type];\n\t\t\tvar marker = factory(config.size, source, config);\n\t\t\tmarker.id = config.id;\n\t\t\treturn marker;\n\t\t}\n\t\n\t\tregistry['arrow'] = arrow;\n\t\tregistry['triangle'] = triangle;\n\t\tregistry['oval'] = oval;\n\t\tregistry['diamond'] = diamond;\n\t\n\t\treturn {\n\t\t\tregistry: registry,\n\t\t\tgetMarker: getMarker\n\t\t};\n\t}();\n\t\n\texports.default = Marker;\n\n/***/ },\n/* 22 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t\tvalue: true\n\t});\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tvar _lodash = __webpack_require__(5);\n\t\n\tvar _lodash2 = _interopRequireDefault(_lodash);\n\t\n\tvar _Utils = __webpack_require__(2);\n\t\n\tvar _Utils2 = _interopRequireDefault(_Utils);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tvar Layout = function () {\n\t\tfunction Layout() {\n\t\t\tvar config = arguments.length <= 0 || arguments[0] === undefined ? {} : arguments[0];\n\t\n\t\t\t_classCallCheck(this, Layout);\n\t\n\t\t\tif (config.hasOwnProperty(\"orientation\") && _lodash2.default.isString(config.orientation)) {\n\t\t\t\tif (config.orientation.toUpperCase() == \"HORIZONTAL\") config.orientation = Layout.HORIZONTAL;else delete config.orientation;\n\t\t\t}\n\t\t\t_Utils2.default.initConfig(this, config);\n\t\t}\n\t\n\t\t_createClass(Layout, [{\n\t\t\tkey: \"layout\",\n\t\t\tvalue: function layout(root, bounds) {}\n\t\t}, {\n\t\t\tkey: \"reset\",\n\t\t\tvalue: function reset() {}\n\t\t}, {\n\t\t\tkey: \"destroy\",\n\t\t\tvalue: function destroy() {}\n\t\t}]);\n\t\n\t\treturn Layout;\n\t}();\n\t\n\tLayout.VERTICAL = 0;\n\tLayout.HORIZONTAL = 1;\n\t\n\tLayout.DEFAULTS = {\n\t\torientation: Layout.VERTICAL\n\t};\n\t\n\texports.default = Layout;\n\n/***/ },\n/* 23 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t\tvalue: true\n\t});\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tvar _Layout2 = __webpack_require__(22);\n\t\n\tvar _Layout3 = _interopRequireDefault(_Layout2);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\t\n\tfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\t\n\tvar FlowLayout = function (_Layout) {\n\t\t_inherits(FlowLayout, _Layout);\n\t\n\t\tfunction FlowLayout() {\n\t\t\t_classCallCheck(this, FlowLayout);\n\t\n\t\t\treturn _possibleConstructorReturn(this, Object.getPrototypeOf(FlowLayout).apply(this, arguments));\n\t\t}\n\t\n\t\t_createClass(FlowLayout, [{\n\t\t\tkey: \"layout\",\n\t\t\tvalue: function layout(root, bounds) {\n\t\t\t\tvar items;\n\t\t\t\tif (!root) items = this.owner.childNodes;else if (_.isArray(root)) items = root;else items = root.getLinkedNodes('target');\n\t\t\t\tif (!items || items.length == 0) return;\n\t\n\t\t\t\tvar x = 0,\n\t\t\t\t    y = 0,\n\t\t\t\t    h = 0,\n\t\t\t\t    node;\n\t\t\t\tvar p1 = 0,\n\t\t\t\t    p2 = 0;\n\t\t\t\tfor (var i = 0; i < items.length; i++) {\n\t\t\t\t\tnode = items[i];\n\t\t\t\t\tif (x > 0 && x + this.hgap + node.getProperty(\"width\") > bounds.width) {\n\t\t\t\t\t\t// create new line\n\t\t\t\t\t\ty += h + this.vgap;\n\t\t\t\t\t\tx = 0;h = 0;p1 = 0;p2++;\n\t\t\t\t\t}\n\t\t\t\t\tnode._flPos = [p1, p2];\n\t\t\t\t\tnode.moveTo([bounds.x + x, bounds.y + y]);\n\t\t\t\t\tx += this.hgap + node.getProperty(\"width\");\n\t\t\t\t\tp1++;\n\t\t\t\t\th = h < node.getProperty(\"height\") ? node.getProperty(\"height\") : h;\n\t\t\t\t}\n\t\t\t\tthis.trigger(new Rectangle(bounds.x, bounds.y, bounds.width, y + h));\n\t\t\t}\n\t\t}]);\n\t\n\t\treturn FlowLayout;\n\t}(_Layout3.default);\n\t\n\tFlowLayout.DEFAULTS = {\n\t\thgap: 10,\n\t\tvgap: 10\n\t};\n\t\n\texports.default = FlowLayout;\n\n/***/ },\n/* 24 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t\tvalue: true\n\t});\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tvar _lodash = __webpack_require__(5);\n\t\n\tvar _lodash2 = _interopRequireDefault(_lodash);\n\t\n\tvar _bean = __webpack_require__(12);\n\t\n\tvar _bean2 = _interopRequireDefault(_bean);\n\t\n\tvar _Utils = __webpack_require__(2);\n\t\n\tvar _Utils2 = _interopRequireDefault(_Utils);\n\t\n\tvar _DomUtils = __webpack_require__(7);\n\t\n\tvar _DomUtils2 = _interopRequireDefault(_DomUtils);\n\t\n\tvar _Layout = __webpack_require__(22);\n\t\n\tvar _Layout2 = _interopRequireDefault(_Layout);\n\t\n\tvar _Rectangle = __webpack_require__(4);\n\t\n\tvar _Rectangle2 = _interopRequireDefault(_Rectangle);\n\t\n\tvar _EventDispatcher = __webpack_require__(13);\n\t\n\tvar _EventDispatcher2 = _interopRequireDefault(_EventDispatcher);\n\t\n\tvar _GraphBehavior = __webpack_require__(25);\n\t\n\tvar _GraphBehavior2 = _interopRequireDefault(_GraphBehavior);\n\t\n\tvar _SelectionBehavior = __webpack_require__(27);\n\t\n\tvar _SelectionBehavior2 = _interopRequireDefault(_SelectionBehavior);\n\t\n\tvar _Label = __webpack_require__(19);\n\t\n\tvar _Label2 = _interopRequireDefault(_Label);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tvar Renderer = function () {\n\t\tfunction Renderer(id, container) {\n\t\t\tvar config = arguments.length <= 2 || arguments[2] === undefined ? {} : arguments[2];\n\t\t\tvar graph = arguments.length <= 3 || arguments[3] === undefined ? null : arguments[3];\n\t\n\t\t\t_classCallCheck(this, Renderer);\n\t\n\t\t\tthis.id = id;\n\t\t\tthis.box = _DomUtils2.default.createElement('div', { id: this.id, tabindex: 0, ns: 'graph' }, { overflow: \"hidden\", width: \"100%\", height: \"100%\", position: 'relative' });\n\t\t\tcontainer.appendChild(this.box);\n\t\t\tif (config.layout) {\n\t\t\t\tvar layoutClass = _Utils2.default.getConstructor(config.layout.jsClass, _Layout2.default);\n\t\t\t\tthis.layout = new layoutClass(config.layout.config);\n\t\t\t\tdelete config.layout;\n\t\t\t}\n\t\t\tthis.clear = true;\n\t\t\tthis._translate = [0, 0];\n\t\t\tthis._scale = 1.0;\n\t\t\tthis.graph = graph;\n\t\t\tthis.dispatcher = null;\n\t\t\tthis.graphBehavior = null;\n\t\t\tthis.selectionBehavior = null;\n\t\t\tthis.nodeBehavior = null;\n\t\t\tthis.edgeBehavior = null;\n\t\t\tthis.connectionBehavior = null;\n\t\t\t_Utils2.default.initConfig(this, config);\n\t\n\t\t\t_bean2.default.on(_Label2.default.editor, 'editor.update.*', function (key, value) {\n\t\t\t\tconsole.log(key + '=' + value);\n\t\t\t});\n\t\t}\n\t\n\t\t_createClass(Renderer, [{\n\t\t\tkey: \"viewport\",\n\t\t\tvalue: function viewport(scaled, _viewport) {\n\t\t\t\tif (_lodash2.default.isUndefined(scaled) || _lodash2.default.isNull(scaled)) scaled = false;\n\t\t\t\tif (!_viewport) {\n\t\t\t\t\tvar vp = new _Rectangle2.default(0, 0, this.box.offsetWidth, this.box.offsetHeight);\n\t\t\t\t\tif (scaled) return _Utils2.default.scale(this.translate, this.scale, vp);\n\t\t\t\t\treturn vp;\n\t\t\t\t}\n\t\t\t\tif (!scaled) _viewport = _Utils2.default.scale(this.translate, this.scale, _viewport);\n\t\t\t\tvar w = this.box.offsetWidth;\n\t\t\t\tvar scale = w / _viewport.width;\n\t\t\t\tthis.transform(-_viewport.x * scale, -_viewport.y * scale, scale);\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"transform\",\n\t\t\tvalue: function transform() {\n\t\t\t\tvar x = arguments.length <= 0 || arguments[0] === undefined ? null : arguments[0];\n\t\t\t\tvar y = arguments.length <= 1 || arguments[1] === undefined ? null : arguments[1];\n\t\t\t\tvar scale = arguments.length <= 2 || arguments[2] === undefined ? null : arguments[2];\n\t\n\t\t\t\tvar graph = this.graph;\n\t\t\t\tvar root = graph ? graph.currentRoot : null;\n\t\t\t\tif (!_lodash2.default.isNull(x)) {\n\t\t\t\t\tthis._translate[0] = x;\n\t\t\t\t\tif (root) root.viewProp(this.id, 'x', x);\n\t\t\t\t}\n\t\t\t\tif (!_lodash2.default.isNull(y)) {\n\t\t\t\t\tthis._translate[1] = y;\n\t\t\t\t\tif (root) root.viewProp(this.id, 'y', y);\n\t\t\t\t}\n\t\t\t\tif (!_lodash2.default.isNull(scale)) {\n\t\t\t\t\tthis._scale = scale;\n\t\t\t\t\tif (root) root.viewProp(this.id, 'scale', scale);\n\t\t\t\t\t// sync the scale between the dispatcher and the graph\n\t\t\t\t\tvar s = this.dispatcher.scale;\n\t\t\t\t\tif (s != scale) this.dispatcher.scale = scale;\n\t\t\t\t}\n\t\t\t\tthis.refresh();\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"render\",\n\t\t\tvalue: function render() {\n\t\t\t\tif (!this._graph) return false;\n\t\t\t\tif (this.layout) this.layout.layout(this._graph.currentRoot, this.viewport());\n\t\n\t\t\t\tthis.initializeBehaviors();\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"renderLabel\",\n\t\t\tvalue: function renderLabel(box) {\n\t\t\t\treturn this.constructor.renderLabel(box);\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"renderLink\",\n\t\t\tvalue: function renderLink(shape) {\n\t\t\t\treturn this.constructor.renderLink(shape);\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"renderMarkers\",\n\t\t\tvalue: function renderMarkers(markers) {\n\t\t\t\treturn this.constructor.renderMarkers(markers);\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"initializeBehaviors\",\n\t\t\tvalue: function initializeBehaviors() {\n\t\t\t\t// create the event dispatcher if necessary.\n\t\t\t\tif (!this.dispatcher) {\n\t\t\t\t\tthis.dispatcher = new _EventDispatcher2.default(this.box, [this.prop('minZoom'), this.prop('maxZoom')]);\n\t\t\t\t\tvar jsClass = void 0;\n\t\t\t\t\tif (this.prop('graphBehavior')) {\n\t\t\t\t\t\tjsClass = _Utils2.default.getConstructor(this.prop('graphBehavior'));\n\t\t\t\t\t\tthis.graphBehavior = new jsClass(this);\n\t\t\t\t\t}\n\t\t\t\t\tif (this.prop('selectionBehavior')) {\n\t\t\t\t\t\tjsClass = _Utils2.default.getConstructor(this.prop('selectionBehavior'));\n\t\t\t\t\t\tthis.selectionBehavior = new jsClass(this);\n\t\t\t\t\t}\n\t\t\t\t\t/*this.dispatcher.register('mouseup.node.label', function(type, ns, target, pos, event) {\n\t    \tlet node = this._graph.nodes[target.getAttribute('id')];\n\t    \tif (!this.dispatcher.dragging && !node._firstSelection) {\n\t    \t\tLabel._delayEdit = _.delay(() => {\n\t    \t\t\tif (Label._delayEdit) {\n\t    \t\t\t\tdelete Label._delayEdit;\n\t    \t\t\t\tLabel.editor.start(node.id, this.box, node.getLabelBox(this.id), target, event.nsTarget, this.scale);\n\t    \t\t\t}\n\t    \t\t}, 250);\n\t    \t}\n\t    }, this);\n\t    this.dispatcher.register([/^mousedown/, /^zoom/], function(type, ns, target, pos, event) {\n\t    \tif (!DomUtils.eventFromInput(event)) {\n\t    \t\tLabel.editor.stop();\n\t    \t}\n\t    }, this);*/\n\t\t\t\t}\n\t\t\t\tthis.dispatcher.start();\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"refresh\",\n\t\t\tvalue: function refresh() {}\n\t\n\t\t\t/**\n\t   * Get the template for the specified key.\n\t   * @param key\n\t   * @param config if the template is a function, this config will be passed as the argument.\n\t   * @param preprocessor if the template contains preprossing elements, such as #{shape}, the preprocessor will be\n\t   * used to render them.\n\t   * @returns {*}\n\t   */\n\t\n\t\t}, {\n\t\t\tkey: \"getTemplate\",\n\t\t\tvalue: function getTemplate(key, config, preprocessor) {\n\t\t\t\tvar t = this.constructor.TEMPLATES[key];\n\t\t\t\tif (t && _lodash2.default.isFunction(t)) {\n\t\t\t\t\tt = t(config);\n\t\t\t\t}\n\t\t\t\t// check if there are any preprocessing tags.\n\t\t\t\tif (preprocessor) {\n\t\t\t\t\tvar parts = t.match(/(#{[^#]*})/g);\n\t\t\t\t\tvar obj = {};\n\t\t\t\t\tfor (var part in parts) {\n\t\t\t\t\t\tpart = parts[part];\n\t\t\t\t\t\tpart = part.substring(2, part.length - 1).trim();\n\t\t\t\t\t\tobj[part] = preprocessor[_lodash2.default.camelCase('render ' + part)](this);\n\t\t\t\t\t}\n\t\t\t\t\tt = _lodash2.default.template(t, { interpolate: /#{([\\s\\S]+?)}/g })(obj);\n\t\t\t\t}\n\t\t\t\treturn t;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"reset\",\n\t\t\tvalue: function reset() {}\n\t\t}, {\n\t\t\tkey: \"destroy\",\n\t\t\tvalue: function destroy() {\n\t\t\t\tdelete this._graph;\n\t\t\t\tdelete this.layout;\n\t\t\t\tif (this.dispatcher) {\n\t\t\t\t\tthis.dispatcher.stop();\n\t\t\t\t\tdelete this.dispatcher;\n\t\t\t\t}\n\t\t\t\tthis.box.innerHTML = '';\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"graph\",\n\t\t\tget: function get() {\n\t\t\t\treturn this._graph;\n\t\t\t},\n\t\t\tset: function set(graph) {\n\t\t\t\tthis._graph = graph;\n\t\t\t\tvar root = graph.currentRoot;\n\t\t\t\tif (root) {\n\t\t\t\t\tthis._translate = [root.viewProp(this.id, 'x') || 0, root.viewProp(this.id, 'y') || 0];\n\t\t\t\t\tthis._scale = root.viewProp(this.id, 'scale') || 1.0;\n\t\t\t\t}\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"translate\",\n\t\t\tget: function get() {\n\t\t\t\treturn this._translate;\n\t\t\t},\n\t\t\tset: function set(t) {\n\t\t\t\tthis.transform(t[0], t[1]);\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"scale\",\n\t\t\tget: function get() {\n\t\t\t\treturn this._scale;\n\t\t\t},\n\t\t\tset: function set(k) {\n\t\t\t\tswitch (k) {\n\t\t\t\t\tcase \"in\":\n\t\t\t\t\t\tk = this.scale * this.prop(\"zoomFactor\");\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase \"out\":\n\t\t\t\t\t\tk = this.scale / this.prop(\"zoomFactor\");\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase \"actual\":\n\t\t\t\t\t\tk = 1.0;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase \"fit\":\n\t\t\t\t\t\tvar gridSize = this.prop(\"gridSize\") * 2;\n\t\n\t\t\t\t\t\tvar gBounds = this.getBounds();\n\t\t\t\t\t\tvar vBounds = this.viewport();\n\t\n\t\t\t\t\t\tvBounds.width -= gridSize;\n\t\t\t\t\t\tvBounds.height -= gridSize;\n\t\n\t\t\t\t\t\t/* Do not zoom more than actual if graph already fits into the bounds */\n\t\t\t\t\t\tk = Math.min(vBounds.width / gBounds.width, vBounds.height / gBounds.height, 1.0);\n\t\n\t\t\t\t\t\t//TODO: Add centering code here or trigger an event for that\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tdefault:\n\t\t\t\t\t\tif (_lodash2.default.isString(k)) k = parseFloat(k);\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tthis.transform(null, null, k);\n\t\t\t}\n\t\t}]);\n\t\n\t\treturn Renderer;\n\t}();\n\t\n\tRenderer.DEFAULTS = {\n\t\tdefaultClickMode: \"pan\",\n\t\thideOutline: false,\n\t\tsingleSelect: true,\n\t\tdraggable: true,\n\t\tgridEnabled: false,\n\t\tguidesEnabled: true,\n\t\tgridSize: 30,\n\t\tmaxZoom: 4.0,\n\t\tminZoom: 0.2,\n\t\tzoomFactor: 1.2,\n\t\tmaskOpacity: 0.5,\n\t\tgraphBehavior: _GraphBehavior2.default,\n\t\tselectionBehavior: _SelectionBehavior2.default\n\t};\n\t\n\texports.default = Renderer;\n\n/***/ },\n/* 25 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t\tvalue: true\n\t});\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tvar _Behavior2 = __webpack_require__(26);\n\t\n\tvar _Behavior3 = _interopRequireDefault(_Behavior2);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\t\n\tfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; } /**\n\t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * Created by tong on 6/28/2016.\n\t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                */\n\t\n\t\n\t/**\n\t * Graph handler handles Panning and Zoom and rubber band selection\n\t */\n\t\n\tvar GraphBehavior = function (_Behavior) {\n\t\t_inherits(GraphBehavior, _Behavior);\n\t\n\t\tfunction GraphBehavior(renderer) {\n\t\t\t_classCallCheck(this, GraphBehavior);\n\t\n\t\t\tvar _this = _possibleConstructorReturn(this, Object.getPrototypeOf(GraphBehavior).call(this, renderer));\n\t\n\t\t\tvar dispatcher = renderer.dispatcher;\n\t\t\tvar f = function f(type, ns, graph, pos, event) {\n\t\t\t\t//Cursor.updateCursor(type, ns, graph, event);\n\t\t\t};\n\t\t\tdispatcher.register(/^drag.*\\.graph$/, _this.handleDrag, _this);\n\t\t\tdispatcher.register(/^zoom/, _this.handleZoom, _this);\n\t\t\t//dispatcher.register(['mousedown.graph', 'mouseenter.graph', 'mouseleave.graph'], f);\n\t\t\t_this.offset = null;\n\t\t\treturn _this;\n\t\t}\n\t\n\t\t_createClass(GraphBehavior, [{\n\t\t\tkey: \"handleZoom\",\n\t\t\tvalue: function handleZoom(type, ns, graph, pos, event) {\n\t\t\t\tthis.renderer.transform(null, null, event.scale);\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"handleDrag\",\n\t\t\tvalue: function handleDrag(type, ns, graph, pos, event) {\n\t\t\t\tif (type == 'dragstart') {\n\t\t\t\t\tvar pan = this.renderer.prop(\"defaultClickMode\") == \"pan\" ^ (event.ctrlKey || event.shiftKey);\n\t\t\t\t\tif (!pan) return;\n\t\t\t\t\tvar t = this.renderer.translate;\n\t\t\t\t\tthis.offset = [t[0] - pos[0], t[1] - pos[1]];\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tif (!this.offset) return;\n\t\t\t\tthis.renderer.transform(pos[0] + this.offset[0], pos[1] + this.offset[1]);\n\t\t\t\tif (type == 'dragend') {\n\t\t\t\t\t//Cursor.updateCursor('mouseup', ns, graph, event);\n\t\t\t\t\tdelete this.offset;\n\t\t\t\t}\n\t\t\t}\n\t\t}]);\n\t\n\t\treturn GraphBehavior;\n\t}(_Behavior3.default);\n\t\n\texports.default = GraphBehavior;\n\n/***/ },\n/* 26 */\n/***/ function(module, exports) {\n\n\t\"use strict\";\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t\tvalue: true\n\t});\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tvar Behavior = function () {\n\t\tfunction Behavior(renderer) {\n\t\t\t_classCallCheck(this, Behavior);\n\t\n\t\t\tthis.renderer = renderer;\n\t\t}\n\t\n\t\t_createClass(Behavior, [{\n\t\t\tkey: \"destroy\",\n\t\t\tvalue: function destroy() {\n\t\t\t\tdelete this.renderer;\n\t\t\t}\n\t\t}]);\n\t\n\t\treturn Behavior;\n\t}();\n\t\n\texports.default = Behavior;\n\n/***/ },\n/* 27 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t\tvalue: true\n\t});\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tvar _get = function get(object, property, receiver) { if (object === null) object = Function.prototype; var desc = Object.getOwnPropertyDescriptor(object, property); if (desc === undefined) { var parent = Object.getPrototypeOf(object); if (parent === null) { return undefined; } else { return get(parent, property, receiver); } } else if (\"value\" in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } };\n\t\n\tvar _Rectangle = __webpack_require__(4);\n\t\n\tvar _Rectangle2 = _interopRequireDefault(_Rectangle);\n\t\n\tvar _Cell = __webpack_require__(17);\n\t\n\tvar _Cell2 = _interopRequireDefault(_Cell);\n\t\n\tvar _Behavior2 = __webpack_require__(26);\n\t\n\tvar _Behavior3 = _interopRequireDefault(_Behavior2);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\t\n\tfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\t\n\tvar SelectionBehavior = function (_Behavior) {\n\t\t_inherits(SelectionBehavior, _Behavior);\n\t\n\t\tfunction SelectionBehavior(renderer) {\n\t\t\t_classCallCheck(this, SelectionBehavior);\n\t\n\t\t\tvar _this = _possibleConstructorReturn(this, Object.getPrototypeOf(SelectionBehavior).call(this, renderer));\n\t\n\t\t\tvar dispatcher = renderer.dispatcher;\n\t\t\tdispatcher.register('mousedown.*', _this.selectCell, _this);\n\t\t\tdispatcher.register('mouseup.*', _this.unselectCell, _this);\n\t\t\tdispatcher.register('drag*.graph', _this.handleMultiSelect, _this);\n\t\t\t//graph.on(Graph.EVENT_TYPES.SELECTION_CHANGE, this.updateSelections, this);\n\t\t\t_this.selectedNodes = null;\n\t\t\t_this.selectedLinks = null;\n\t\t\t_this.attachedLinks = null;\n\t\t\treturn _this;\n\t\t}\n\t\n\t\t_createClass(SelectionBehavior, [{\n\t\t\tkey: \"updateSelections\",\n\t\t\tvalue: function updateSelections() {\n\t\t\t\tif (this.selectedNodes) this.selectedNodes.classed('selected', false);\n\t\t\t\tif (this.selectedLinks) this.selectedLinks.classed('selected', false);\n\t\n\t\t\t\tthis.selectedNodes = null;\n\t\t\t\tthis.selectedLinks = null;\n\t\t\t\tthis.attachedLinks = null;\n\t\n\t\t\t\tif (this.graph.selectedVertices && this.graph.selectedVertices.length > 0) {\n\t\t\t\t\tthis.selectedNodes = this.graph.renderer.getShapes(this.graph.selectedVertices);\n\t\t\t\t\tthis.attachedLinks = this.graph.renderer.getShapes(this.graph.getAttachedEdges());\n\t\t\t\t\tthis.selectedNodes.classed('selected', true);\n\t\t\t\t}\n\t\n\t\t\t\tif (this.graph.selectedEdges && this.graph.selectedEdges.length > 0) {\n\t\t\t\t\tthis.selectedLinks = this.graph.renderer.getShapes(this.graph.selectedEdges);\n\t\t\t\t\tthis.selectedLinks.classed('selected', true);\n\t\t\t\t}\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"selectCell\",\n\t\t\tvalue: function selectCell(type, ns, data, pos, event) {\n\t\t\t\tvar cell = data == this.graph ? null : data;\n\t\t\t\tif (cell && !(cell instanceof _Cell2.default)) return;\n\t\t\t\tvar toggle = event.ctrlKey || event.shiftKey;\n\t\t\t\tif (cell && cell instanceof _Cell2.default) {\n\t\t\t\t\tif (!this.graph.isSelected(cell)) delete cell._firstSelection;else cell._firstSelection = true;\n\t\n\t\t\t\t\td3.select(event.dataTarget).moveToFront();\n\t\t\t\t\tthis.graph.setSelection(cell, toggle);\n\t\t\t\t}\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"unselectCell\",\n\t\t\tvalue: function unselectCell(type, ns, data, pos, event) {\n\t\t\t\tvar cell = data == this.graph ? null : data;\n\t\t\t\tif (cell && !(cell instanceof _Cell2.default)) return;\n\t\t\t\tvar ctrlKey = event.ctrlKey || event.shiftKey;\n\t\t\t\tif (!cell) {\n\t\t\t\t\tthis.graph.setSelection(cell, ctrlKey);\n\t\t\t\t}\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"handleMultiSelect\",\n\t\t\tvalue: function handleMultiSelect(type, ns, data, pos, event) {\n\t\t\t\tpos = util.scale(this.graph, pos);\n\t\n\t\t\t\tif (type == 'dragstart') {\n\t\t\t\t\tvar select = this.graph.getProperty(\"defaultClickMode\") == \"select\" ^ (event.ctrlKey || event.shiftKey);\n\t\t\t\t\tif (!select) return;\n\t\t\t\t\tthis.startPt = new Point(pos[0], pos[1]);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tif (!this.startPt) return;\n\t\t\t\tvar rect = _Rectangle2.default.getBoundingRectangle([new Point(pos[0], pos[1]), this.startPt]);\n\t\t\t\tvar renderer = this.graph.renderer;\n\t\t\t\tif (!this.rubberband) {\n\t\t\t\t\tthis.rubberband = d3.select(renderer.appendNode(renderer.getCellLayer(), {\n\t\t\t\t\t\ttemplate: _.template('<g><rect x=\"0\" y=\"0\" width=\"100\" height=\"100\" stroke=\"#000000\" fill=\"none\" stroke-dasharray=\"3 3\"/></g>')\n\t\t\t\t\t}, false));\n\t\t\t\t}\n\t\t\t\tif (type == 'dragend') {\n\t\t\t\t\tvar cells = this.graph.getCurrentRoot().children;\n\t\t\t\t\t// TODO: Define if we want to select vertexes / edges or both\n\t\t\t\t\tcells = _.filter(cells, function (cell) {\n\t\t\t\t\t\tvar box = cell.getBounds();\n\t\t\t\t\t\tif (rect.contains(box)) {\n\t\t\t\t\t\t\treturn true;\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t});\n\t\t\t\t\t// TODO: Set selection\n\t\t\t\t\tthis.graph.setSelection(cells, event.ctrlKey);\n\t\n\t\t\t\t\tthis.rubberband.remove();\n\t\t\t\t\tdelete this.startPt;\n\t\t\t\t\tdelete this.rubberband;\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tthis.rubberband.select(\"rect\").attr({ x: rect.x, y: rect.y, width: rect.width, height: rect.height });\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"destroy\",\n\t\t\tvalue: function destroy() {\n\t\t\t\t_get(Object.getPrototypeOf(SelectionBehavior.prototype), \"destroy\", this).call(this);\n\t\t\t\tdelete this.selectedNodes;\n\t\t\t\tdelete this.selectedLinks;\n\t\t\t\tdelete this.attachedLinks;\n\t\t\t}\n\t\t}]);\n\t\n\t\treturn SelectionBehavior;\n\t}(_Behavior3.default);\n\t\n\texports.default = SelectionBehavior;\n\n/***/ },\n/* 28 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t\tvalue: true\n\t});\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tvar _get = function get(object, property, receiver) { if (object === null) object = Function.prototype; var desc = Object.getOwnPropertyDescriptor(object, property); if (desc === undefined) { var parent = Object.getPrototypeOf(object); if (parent === null) { return undefined; } else { return get(parent, property, receiver); } } else if (\"value\" in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } };\n\t\n\tvar _lodash = __webpack_require__(5);\n\t\n\tvar _lodash2 = _interopRequireDefault(_lodash);\n\t\n\tvar _base = __webpack_require__(1);\n\t\n\tvar _base2 = _interopRequireDefault(_base);\n\t\n\tvar _DomUtils = __webpack_require__(7);\n\t\n\tvar _DomUtils2 = _interopRequireDefault(_DomUtils);\n\t\n\tvar _Renderer2 = __webpack_require__(24);\n\t\n\tvar _Renderer3 = _interopRequireDefault(_Renderer2);\n\t\n\tvar _StringBuffer = __webpack_require__(8);\n\t\n\tvar _StringBuffer2 = _interopRequireDefault(_StringBuffer);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\t\n\tfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\t\n\tvar NS = 'http://www.w3.org/2000/svg';\n\tif (typeof SVGElement != \"undefined\") {\n\t\tvar svg = document.createElementNS(NS, \"svg\");\n\t\tsvg.innerHTML = '<circle/>';\n\t\tif (svg.firstChild !== \"[object SVGCircleElement]\") {\n\t\t\tObject.defineProperties(SVGElement.prototype, {\n\t\t\t\t\"outerHTML\": {\n\t\t\t\t\tenumerable: false,\n\t\t\t\t\tconfigurable: true,\n\t\t\t\t\tget: function get() {\n\t\t\t\t\t\tvar $node, $temp;\n\t\t\t\t\t\t$temp = document.createElement('div');\n\t\t\t\t\t\t$node = this.cloneNode(true);\n\t\t\t\t\t\t$temp.appendChild($node);\n\t\t\t\t\t\treturn $temp.innerHTML;\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t\"innerHTML\": {\n\t\t\t\t\tenumerable: false,\n\t\t\t\t\tconfigurable: true,\n\t\t\t\t\tget: function get() {\n\t\t\t\t\t\tvar s = this.outerHTML;\n\t\t\t\t\t\tvar ropen = new RegExp(\"<\" + this.nodeName + '\\\\b(?:([\"\\'])[^\"]*?(\\\\1)|[^>])*>', \"i\");\n\t\t\t\t\t\tvar rclose = new RegExp(\"<\\/\" + this.nodeName + \">$\", \"i\");\n\t\t\t\t\t\treturn s.replace(ropen, \"\").replace(rclose, \"\");\n\t\t\t\t\t},\n\t\t\t\t\tset: function set(markup) {\n\t\t\t\t\t\t// empty el first.\n\t\t\t\t\t\tvar child = void 0;\n\t\t\t\t\t\twhile (child = this.lastChild) {\n\t\t\t\t\t\t\tthis.removeChild(child);\n\t\t\t\t\t\t}var buf = new _StringBuffer2.default();\n\t\t\t\t\t\tbuf.append('<svg>').append(markup).append('</svg');\n\t\t\t\t\t\tvar $temp = _DomUtils2.default.createElement('div', null, null, buf.toString()).firstElementChild;\n\t\t\t\t\t\twhile ($temp.firstChild) {\n\t\t\t\t\t\t\tthis.appendChild($temp.firstChild);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t\t// Define the toDataURL for SVG\n\t\tSVGElement.prototype.toDataURL = function (type) {\n\t\t\tvar options = arguments.length <= 1 || arguments[1] === undefined ? {} : arguments[1];\n\t\n\t\t\tvar _svg = this;\n\t\n\t\t\tvar debug = function debug(msg) {};\n\t\n\t\t\tif (options['debug'] == true && typeof console != 'undefined') debug = function debug(msg) {\n\t\t\t\tconsole.log(\"SVG.toDataURL:\", msg);\n\t\t\t};\n\t\n\t\t\tfunction exportSVG() {\n\t\t\t\tvar svg_xml = _svg.outerHTML;\n\t\t\t\tvar svg_dataurl = base64dataURLencode(svg_xml);\n\t\t\t\tdebug(type + \" length: \" + svg_dataurl.length);\n\t\n\t\t\t\t// NOTE double data carrier\n\t\t\t\tif (options.callback) options.callback(svg_dataurl);\n\t\t\t\treturn svg_dataurl;\n\t\t\t}\n\t\n\t\t\tfunction base64dataURLencode(s) {\n\t\t\t\tvar b64 = \"data:image/svg+xml;base64,\";\n\t\n\t\t\t\t// https://developer.mozilla.org/en/DOM/window.btoa\n\t\t\t\tif (window.btoa) {\n\t\t\t\t\tdebug(\"using window.btoa for base64 encoding\");\n\t\t\t\t\tb64 += btoa(s);\n\t\t\t\t} else {\n\t\t\t\t\tdebug(\"using custom base64 encoder\");\n\t\t\t\t\tb64 += _base2.default.encode(s);\n\t\t\t\t}\n\t\n\t\t\t\treturn b64;\n\t\t\t}\n\t\n\t\t\t// Native export doesn't work very well. should use canvg instead.\n\t\t\tfunction exportImage(type) {\n\t\t\t\tvar canvas = document.createElement(\"canvas\");\n\t\t\t\tvar ctx = canvas.getContext('2d');\n\t\n\t\t\t\t// TODO: if (options.keepOutsideViewport), do some translation magic?\n\t\n\t\t\t\tvar svg_img = new Image();\n\t\t\t\tvar svg_xml = _svg.outerHTML;\n\t\t\t\tsvg_img.src = base64dataURLencode(svg_xml);\n\t\n\t\t\t\tsvg_img.onload = function () {\n\t\t\t\t\tdebug(\"exported image size: \" + [svg_img.width, svg_img.height]);\n\t\t\t\t\tcanvas.width = svg_img.width;\n\t\t\t\t\tcanvas.height = svg_img.height;\n\t\t\t\t\tctx.drawImage(svg_img, 0, 0);\n\t\n\t\t\t\t\t// SECURITY_ERR WILL HAPPEN NOW\n\t\t\t\t\tvar image_dataurl = canvas.toDataURL(type);\n\t\t\t\t\tdebug(type + \" length: \" + image_dataurl.length);\n\t\n\t\t\t\t\tif (options.callback) options.callback(image_dataurl);else debug(\"WARNING: no callback set, so nothing happens.\");\n\t\t\t\t};\n\t\n\t\t\t\tsvg_img.onerror = function () {\n\t\t\t\t\tdebug(\"Can't export! Maybe your browser doesn't support \" + \"SVG in img element or SVG input for Canvas drawImage?\\n\" + \"http://en.wikipedia.org/wiki/SVG#Native_support\");\n\t\t\t\t};\n\t\n\t\t\t\t// NOTE: will not return anything\n\t\t\t}\n\t\n\t\t\tfunction exportImageCanvg(type) {\n\t\t\t\tif (!canvg) return null;\n\t\t\t\tvar canvas = _DomUtils2.default.createElement('canvas', null, { display: \"none\" });\n\t\t\t\tdocument.body.appendChild(canvas);\n\t\t\t\tif (type == 'javascript') {\n\t\t\t\t\tvar xcanvas = new jsCanvas('jscanvastest');\n\t\t\t\t\txcanvas.canvas.style.display = 'none';\n\t\t\t\t\t//xcanvas.canvas = canvas;\n\t\t\t\t}\n\t\n\t\t\t\tif (!options.keepOutsideViewport) {\n\t\t\t\t\tcanvg(canvas, _svg.outerHTML);\n\t\t\t\t} else {\n\t\t\t\t\tvar padding = options.padding || 0;\n\t\t\t\t\tvar scale = 1.0;\n\t\t\t\t\tvar translate = [0, 0];\n\t\t\t\t\tvar bbox = _svg.getBBox();\n\t\t\t\t\tdebug(\"detected svg dimensions \" + [bbox.x, bbox.y, bbox.width, bbox.height]);\n\t\t\t\t\tvar transform = _svg.firstElementChild.getAttribute('transform');\n\t\t\t\t\tif (transform) {\n\t\t\t\t\t\tdebug('detected svg transform ' + transform);\n\t\t\t\t\t\ttransform = SVGRenderer.transform(transform);\n\t\t\t\t\t\ttranslate = transform.translate;\n\t\t\t\t\t\tscale = transform.scale;\n\t\t\t\t\t}\n\t\t\t\t\tvar buf = new _StringBuffer2.default();\n\t\t\t\t\tbuf.append('<svg width=\"').append(bbox.width + 2 * padding).append('px\" height=\"').append(bbox.height + 2 * padding).append('px\"><g transform=\"translate(').append(-bbox.x + translate[0] + padding).append(',').append(-bbox.y + translate[1] + padding).append(')scale(').append(scale).append(')\">').append(_svg.firstElementChild.innerHTML).append('</g></svg>');\n\t\t\t\t\tif (type == 'javascript') {\n\t\t\t\t\t\txcanvas.compile(buf.toString(), function () {\n\t\t\t\t\t\t\tif (options.callback) options.callback(xcanvas.toString());\n\t\t\t\t\t\t});\n\t\t\t\t\t\treturn;\n\t\t\t\t\t} else canvg(canvas, buf.toString());\n\t\t\t\t}\n\t\t\t\tvar image_dataurl = canvas.toDataURL(type);\n\t\t\t\tif (options.callback) options.callback(image_dataurl);\n\t\t\t\tcanvas.parentNode.removeChild(canvas);\n\t\t\t\treturn image_dataurl;\n\t\t\t}\n\t\n\t\t\tif (!type) type = \"image/svg+xml\";\n\t\n\t\t\tif (options.keepNonSafe) debug(\"NOTE: keepNonSafe is NOT supported and will be ignored!\");\n\t\t\tif (options.keepOutsideViewport) debug(\"NOTE: keepOutsideViewport is only supported with canvg exporter.\");\n\t\n\t\t\tswitch (type) {\n\t\t\t\tcase \"image/svg+xml\":\n\t\t\t\t\treturn exportSVG();\n\t\t\t\tcase \"image/png\":\n\t\t\t\tcase \"image/jpeg\":\n\t\t\t\tcase \"javascript\":\n\t\t\t\t\tif (!options.renderer) {\n\t\t\t\t\t\tif (window.canvg) options.renderer = \"canvg\";else options.renderer = \"native\";\n\t\t\t\t\t}\n\t\t\t\t\tswitch (options.renderer) {\n\t\t\t\t\t\tcase \"canvg\":\n\t\t\t\t\t\t\tdebug(\"using canvg renderer for \" + type + \" image export\");\n\t\t\t\t\t\t\treturn exportImageCanvg(type);\n\t\t\t\t\t\tcase \"native\":\n\t\t\t\t\t\t\tdebug(\"using native renderer for \" + type + \" export. THIS MIGHT FAIL.\");\n\t\t\t\t\t\t\treturn exportImage(type);\n\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\tdebug(\"unknown image renderer given, doing noting (\" + options.renderer + \")\");\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\tdebug(\"Sorry! Exporting as '\" + type + \"' is not supported!\");\n\t\t\t}\n\t\t\treturn null;\n\t\t};\n\t}\n\t\n\tvar SVGRenderer = function (_Renderer) {\n\t\t_inherits(SVGRenderer, _Renderer);\n\t\n\t\tfunction SVGRenderer() {\n\t\t\t_classCallCheck(this, SVGRenderer);\n\t\n\t\t\treturn _possibleConstructorReturn(this, Object.getPrototypeOf(SVGRenderer).apply(this, arguments));\n\t\t}\n\t\n\t\t_createClass(SVGRenderer, [{\n\t\t\tkey: \"render\",\n\t\t\tvalue: function render() {\n\t\t\t\tvar result = _get(Object.getPrototypeOf(SVGRenderer.prototype), \"render\", this).call(this);\n\t\t\t\tif (result) {\n\t\t\t\t\tvar root = this.graph.currentRoot;\n\t\t\t\t\tvar buf = new _StringBuffer2.default('<svg width=\"100%\" height=\"100%\" xmlns=\"http://www.w3.org/2000/svg\">');\n\t\t\t\t\tvar t = this.translate;\n\t\t\t\t\tbuf.append('<g transform=\"translate(').append(t[0]).append(',').append(t[1]).append(')scale(').append(this.scale).append(')\">');\n\t\t\t\t\tbuf.append(this.renderDefs());\n\t\t\t\t\tbuf.append(root.render(this));\n\t\t\t\t\tbuf.append('</g></svg>');\n\t\t\t\t\tthis.box.innerHTML = buf.toString();\n\t\t\t\t\tthis.svg = this.box.firstElementChild;\n\t\t\t\t}\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"renderDefs\",\n\t\t\tvalue: function renderDefs() {\n\t\t\t\tvar buf = new _StringBuffer2.default('<defs>');\n\t\t\t\tbuf.append(this.getTemplate('Grid', this.prop(\"gridSize\")));\n\t\t\t\tvar markers = this.graph.markers;\n\t\t\t\tif (markers.length > 0) buf.append(SVGRenderer.renderMarkers(markers));\n\t\t\t\tbuf.append('</defs>');\n\t\t\t\treturn buf.toString();\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"refresh\",\n\t\t\tvalue: function refresh() {\n\t\t\t\tif (!this.svg) return;\n\t\t\t\tvar g = this.svg.querySelector('g');\n\t\t\t\tvar t = this.translate;\n\t\t\t\tg.setAttribute('transform', 'translate(' + t[0] + ',' + t[1] + ')scale(' + this.scale + ')');\n\t\t\t}\n\t\t}], [{\n\t\t\tkey: \"renderMarkers\",\n\t\t\tvalue: function renderMarkers(markers) {\n\t\t\t\tvar buf = new _StringBuffer2.default(),\n\t\t\t\t    str1 = void 0,\n\t\t\t\t    str2 = void 0;\n\t\t\t\tmarkers.forEach(function (marker) {\n\t\t\t\t\tstr1 = this.TEMPLATES['Marker'](marker);\n\t\t\t\t\tstr2 = marker.shape;\n\t\t\t\t\tif (!_lodash2.default.isString(str2)) str2 = this.renderShape(str2);\n\t\t\t\t\tstr1 = str1.replace(/\\#\\{shape\\}/, str2);\n\t\t\t\t\tbuf.append(str1);\n\t\t\t\t}, this);\n\t\t\t\treturn buf.toString();\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"renderLabel\",\n\t\t\tvalue: function renderLabel(box) {\n\t\t\t\treturn this.TEMPLATES['Label'](box);\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"renderShape\",\n\t\t\tvalue: function renderShape(shape) {\n\t\t\t\tvar template = this.TEMPLATES[shape.name];\n\t\t\t\tif (_lodash2.default.isString(template)) template = _lodash2.default.template(template);\n\t\t\t\treturn template(shape);\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"getPathData\",\n\t\t\tvalue: function getPathData(shape) {\n\t\t\t\tvar points = shape.points;\n\t\t\t\tvar controlPts = shape.controlPts;\n\t\t\t\tif (!points || points.length == 0) return '';\n\t\n\t\t\t\tif (!controlPts && shape.round) {\n\t\t\t\t\t// render rounded line joins.\n\t\t\t\t\tvar newPts = [];\n\t\t\t\t\tcontrolPts = [];\n\t\t\t\t\tvar prev = points[0],\n\t\t\t\t\t    next = void 0,\n\t\t\t\t\t    d1 = void 0,\n\t\t\t\t\t    d2 = void 0,\n\t\t\t\t\t    corner = void 0;\n\t\t\t\t\tnewPts.push(prev);\n\t\t\t\t\tfor (var i = 1; i < points.length - 1; i++) {\n\t\t\t\t\t\tnext = points[i];\n\t\t\t\t\t\t// set the control point first.\n\t\t\t\t\t\tcontrolPts[2 * i] = [next, next];\n\t\t\t\t\t\t// check the size of the corner.\n\t\t\t\t\t\td1 = prev.distance(next);\n\t\t\t\t\t\td2 = next.distance(points[i + 1]);\n\t\t\t\t\t\tcorner = Math.min(shape.round, d1 / 2, d2 / 2);\n\t\t\t\t\t\t// split the point into two.\n\t\t\t\t\t\tnewPts.push(next.getDirection(prev).scale(corner).translate(next));\n\t\t\t\t\t\tnewPts.push(next.getDirection(points[i + 1]).scale(corner).translate(next));\n\t\t\t\t\t\tprev = next;\n\t\t\t\t\t}\n\t\t\t\t\tnewPts.push(points[points.length - 1]);\n\t\t\t\t\tpoints = newPts;\n\t\t\t\t}\n\t\t\t\tvar buf = new _StringBuffer2.default('M'),\n\t\t\t\t    point = void 0;\n\t\t\t\tfor (var _i = 0; _i < points.length; _i++) {\n\t\t\t\t\tpoint = points[_i];\n\t\t\t\t\tif (_i == 0) buf.append(point);else {\n\t\t\t\t\t\tif (controlPts && controlPts[_i]) {\n\t\t\t\t\t\t\tbuf.append(' C ');\n\t\t\t\t\t\t\tfor (var j = 0; j < controlPts[_i].length; j++) {\n\t\t\t\t\t\t\t\tbuf.append(controlPts[_i][j]).append(' ');\n\t\t\t\t\t\t\t}buf.append(point);\n\t\t\t\t\t\t} else buf.append(' L ').append(point);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn buf.toString();\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"renderLink\",\n\t\t\tvalue: function renderLink(shape) {\n\t\t\t\tvar buf = new _StringBuffer2.default();\n\t\t\t\tvar d = SVGRenderer.getPathData(shape);\n\t\t\t\tif (shape.showGauge) buf.append('<path style=\"stroke: white; stroke-width: 9; visibility: hidden; pointer-events: stroke;\" d=\"').append(d).append('\"/>');\n\t\t\t\tbuf.append('<path d=\"').append(d).append('\"');\n\t\t\t\tif (shape.startMarker || shape.endMarker) {\n\t\t\t\t\tbuf.append(' style=\"');\n\t\t\t\t\tif (shape.startMarker) buf.append('marker-start: url(#').append(_lodash2.default.isString(shape.startMarker) ? shape.startMarker : shape.startMarker.id).append(');');\n\t\t\t\t\tif (shape.endMarker) buf.append('marker-end: url(#').append(_lodash2.default.isString(shape.endMarker) ? shape.endMarker : shape.endMarker.id).append(');');\n\t\t\t\t\tbuf.append('\"');\n\t\t\t\t}\n\t\t\t\tbuf.append('/>');\n\t\t\t\treturn buf.toString();\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"appendContent\",\n\t\t\tvalue: function appendContent(el, content) {\n\t\t\t\tvar buf = new _StringBuffer2.default();\n\t\t\t\tbuf.append('<svg>').append(content).append('</svg');\n\t\t\t\tvar temp = _DomUtils2.default.createElement('div', null, null, buf.toString()).firstElementChild;\n\t\n\t\t\t\twhile (temp.firstChild) {\n\t\t\t\t\tel.appendChild(temp.firstChild);\n\t\t\t\t}return el;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"transform\",\n\t\t\tvalue: function transform(_transform) {\n\t\t\t\tvar translate = [0, 0],\n\t\t\t\t    scale = 1.0;\n\t\t\t\t//\n\t\t\t\tvar parts = _transform.match(/translate\\(\\s*([^)]+)/);\n\t\t\t\tif (parts) {\n\t\t\t\t\tvar m = parts[1].trim().match(/([\\d.-]+)[ ,]([\\d.-]+)/);\n\t\t\t\t\tif (m) {\n\t\t\t\t\t\ttranslate[0] = parseFloat(m[1]) || 0;\n\t\t\t\t\t\ttranslate[1] = parseFloat(m[2]) || 0;\n\t\t\t\t\t} else translate[0] = translate[1] = parseFloat(parts[1]);\n\t\t\t\t}\n\t\t\t\tparts = _transform.match(/scale\\(\\s*([^)]+)/);\n\t\t\t\tif (parts) scale = parseFloat(parts[1]) || 1.0;\n\t\n\t\t\t\treturn { translate: translate, scale: scale };\n\t\t\t}\n\t\t}]);\n\t\n\t\treturn SVGRenderer;\n\t}(_Renderer3.default);\n\t\n\tSVGRenderer.TEMPLATES = {\n\t\t$root: '<g id=\"${id}\" class=\"${className}\">#{children}</g>',\n\t\t$node: '<g id=\"${id}\" class=\"${className}\" style=\"${style}\" ns=\"${namespace}\" transform=\"translate(${x},${y})\">#{shape}#{label}</g>',\n\t\t$edge: '<g id=\"${id}\" class=\"${className}\" style=\"${style}\" ns=\"${namespace}\">#{shape}#{label}</g>',\n\t\tEllipse: '<ellipse cx=\"0\" cy=\"0\" rx=\"${width/2}\" ry=\"${height/2}\"/>',\n\t\tRectangle: '<rect x=\"${-width/2}\" y=\"${-height/2}\" width=\"${width}\" height=\"${height}\" rx=\"9\" ry=\"9\"/>',\n\t\tTriangle: '<polygon points=\"${-width/2},${-height/2} ${width/2},${-height/2} 0,${height/2}\"/>',\n\t\tRhombus: '<polygon points=\"0,${-height/2} ${width/2},0 0,${height/2} ${-width/2},0\"/>',\n\t\tHexagon: function Hexagon(config) {\n\t\t\tvar vertical = config.direction == 'north' || config.direction == 'south';\n\t\t\tif (vertical) return '<polygon points=\"0,${-height/2} ${width/2},${-height/4} ${width/2},${height/4} 0,${height/2} ${-width/2},${height/4} ${-width/2},${-height/4}\"/>';else return '<polygon points=\"${-width/2},0 ${width/4},${-height/2} ${width/4},${-height/2} ${width/2},0 ${width/4},${height/2} ${-width/4},${height/2}\"/>';\n\t\t},\n\t\tPolygon: function Polygon(shape) {\n\t\t\tvar buf = new _StringBuffer2.default('<polygon points=\"');\n\t\t\tshape.points.forEach(function (pt) {\n\t\t\t\tbuf.append(pt[0]).append(',').append(pt[1]).append(' ');\n\t\t\t});\n\t\t\tbuf.removeLast();\n\t\t\tbuf.append('\"/>');\n\t\t\treturn buf.toString();\n\t\t},\n\t\tImage: function Image(config) {\n\t\t\treturn '<image x=\"${-width/2}\" y=\"${-height/2}\" width=\"${width}\" height=\"${height}\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" xlink:href=\"' + config.image + '\"/>';\n\t\t},\n\t\tMarker: function Marker(marker) {\n\t\t\treturn (\"\\n<marker id=\\\"\" + marker.id + \"\\\" markerWidth=\\\"\" + marker.size + \"\\\" markerHeight=\\\"\" + marker.size + \"\\\" refx=\\\"\" + marker.ref[0] + \"\\\" \\nrefy=\\\"\" + marker.ref[1] + \"\\\" orient=\\\"auto\\\" viewbox=\\\"\" + marker.viewBox.x + \" \" + marker.viewBox.y + \" \" + marker.viewBox.width + \" \" + marker.viewBox.height + \"\\\"\\nmarkerUnits=\\\"userSpaceOnUse\\\" \" + (marker.fill ? \"style=\\\"stroke: \" + marker.fill + \";fill:\" + marker.fill + \"\\\"\" : '') + \">#{shape}</marker>\\n\").trim();\n\t\t},\n\t\tGrid: function Grid(size) {\n\t\t\treturn (\"\\n<pattern id=\\\"GridPattern\\\" width=\\\"\" + size + \"\\\" height=\\\"\" + size + \"\\\" patternUnits=\\\"userSpaceOnUse\\\">\\n\\t<ellipse cx=\\\"0\\\" cy=\\\"0\\\" rx=\\\"1\\\" ry=\\\"1\\\" fill=\\\"#999999\\\"/>\\n\\t<ellipse cx=\\\"0\\\" cy=\\\"\" + size + \"\\\" rx=\\\"1\\\" ry=\\\"1\\\" fill=\\\"#999999\\\"/>\\n\\t<ellipse cx=\\\"\" + size + \"\\\" cy=\\\"0\\\" rx=\\\"1\\\" ry=\\\"1\\\" fill=\\\"#999999\\\"/>\\n\\t<ellipse cx=\\\"\" + size + \"\\\" cy=\\\"\" + size + \"\\\" rx=\\\"1\\\" ry=\\\"1\\\" fill=\\\"#999999\\\"/>\\n</pattern>\").trim();\n\t\t},\n\t\tLabel: _lodash2.default.template(\"\\n<% var box = _.has(data, \\\"dx\\\") ? data : (data.getLabelBox ? data.getLabelBox() : null); \\n   if (box) {%>\\n\\t<g <% if (box.config && box.config.class) {%>class=\\\"<%=box.config.class%>\\\"<%}%>\\t\\t<% if (box.config && box.config.ns) {%>ns=\\\"<%=box.config.ns%>\\\"<%}%>\\t\\t<% if (box.config && box.config.inlineStyle) {%>\\t\\t\\tfont-size=\\\"<%=box.config.fontSize%>\\\"\\t\\t\\tfont-family=\\\"<%=box.config.fontFamily%>\\\"\\t\\t\\tfont-weight=\\\"<% if (box.bold) {%>bold<%} else {%>normal<%}%>\\\"\\t\\t\\t<% if (box.underline) {%>text-decoration=\\\"underline\\\"<%}%>\\t\\t\\t<% if (box.italic) {%>font-style=\\\"italic\\\"<%}%>\\t\\t<%}%>\\t\\ttext-anchor=\\\"<%=box.anchor%>\\\"\\t\\ttransform=\\\"translate(<%=box.bounds.x%>,<%=box.bounds.y%>)<% if (box.config && box.config.rotation) {%>rotate(<%=box.config.rotation%> <%=box.pivot[0]%> <%=box.pivot[1]%>)<%}%>\\\">\\n\\t<% if (box.config.backgroundStyle) {%>\\n\\t\\t<rect x=\\\"<%=-box.bounds.width/2%>\\\" y=\\\"<%=-box.bounds.height/2%>\\\" width=\\\"<%=box.bounds.width%>\\\" height=\\\"<%=box.bounds.height%>\\\" style=\\\"<%=box.config.backgroundStyle%>\\\"/>\\n\\t<% } if (_.isArray(box.label)) { \\n\\t\\t_.each(box.label, function(value, line) {%>\\n\\t\\t\\t<text <% if (box.config && box.config.textStyle) {%>style=\\\"<%=box.config.textStyle%>\\\"<%}%>\\t\\t\\t\\tdx=\\\"<%=box.dx%>\\\" dy=\\\"<%=box.dy + box.lineHeight * line%>\\\"><%=value%></text>\\n\\t\\t<%});} else { %>\\n\\t\\t\\t<text><%=box.label%></text>\\n\\t\\t<%}%>\\n\\t</g>\\n<%}%>\\n\".trim(), { variable: \"data\" }) //TODO add more inline text styles.\n\t};\n\t\n\texports.default = SVGRenderer;\n\n/***/ }\n/******/ ])\n});\n;\n"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n/** WEBPACK FOOTER **\n ** webpack/bootstrap 23f5f316dd0fc5962c1b\n **/","import Base64 from \"./util/base64\";\nimport Cache from \"./util/Utils\";\nimport Utils from \"./util/Utils\";\nimport DomUtils from \"./util/DomUtils\";\nimport StringBuffer from \"./util/StringBuffer\";\nimport Point from \"./geometry/Point\";\nimport Line from \"./geometry/Line\";\nimport Shape from \"./geometry/Shape\";\nimport Rectangle from \"./geometry/Rectangle\";\nimport Ellipse from \"./geometry/Ellipse\";\nimport Link from \"./geometry/Link\";\nimport Events from \"bean\";\nimport EventDispatcher from \"./event/EventDispatcher\";\nimport Graph from \"./graph/Graph\";\nimport Cell from \"./graph/Cell\";\nimport Node from \"./graph/Node\";\nimport Edge from \"./graph/Edge\";\nimport Layout from \"./layout/Layout\";\nimport FlowLayout from \"./layout/FlowLayout\";\nimport Label from \"./view/Label\";\nimport Marker from \"./view/Marker\";\nimport Renderer from \"./view/Renderer\";\nimport SVGRenderer from \"./view/SVGRenderer\";\nimport GraphBehavior from \"./behavior/GraphBehavior\";\nimport SelectionBehavior from \"./behavior/SelectionBehavior\";\n\nShape.addShape(\"Rectangle\", Rectangle);\nShape.addShape(\"Ellipse\", Ellipse);\n\nexport default {\n\tEvents,\n\tBase64,\n\tCache,\n\tUtils,\n\tDomUtils,\n\tStringBuffer,\n\tPoint,\n\tLine,\n\tShape,\n\tRectangle,\n\tEllipse,\n\tLink,\n\tEventDispatcher,\n\tLabel,\n\tMarker,\n\tGraph,\n\tCell,\n\tNode,\n\tEdge,\n\tLayout,\n\tFlowLayout,\n\tRenderer,\n\tSVGRenderer,\n\tGraphBehavior,\n\tSelectionBehavior\n};\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/index.js\n **/","// http://www.webtoolkit.info/javascript-base64.html\n\nvar Base64 = {\n\n\t// private property\n\t_keyStr : \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=\",\n\n\t// public method for encoding\n\tencode : function (input) {\n\t\tvar output = \"\";\n\t\tvar chr1, chr2, chr3, enc1, enc2, enc3, enc4;\n\t\tvar i = 0;\n\n\t\tinput = Base64._utf8_encode(input);\n\n\t\twhile (i < input.length) {\n\n\t\t\tchr1 = input.charCodeAt(i++);\n\t\t\tchr2 = input.charCodeAt(i++);\n\t\t\tchr3 = input.charCodeAt(i++);\n\n\t\t\tenc1 = chr1 >> 2;\n\t\t\tenc2 = ((chr1 & 3) << 4) | (chr2 >> 4);\n\t\t\tenc3 = ((chr2 & 15) << 2) | (chr3 >> 6);\n\t\t\tenc4 = chr3 & 63;\n\n\t\t\tif (isNaN(chr2)) {\n\t\t\t\tenc3 = enc4 = 64;\n\t\t\t} else if (isNaN(chr3)) {\n\t\t\t\tenc4 = 64;\n\t\t\t}\n\n\t\t\toutput = output +\n\t\t\tthis._keyStr.charAt(enc1) + this._keyStr.charAt(enc2) +\n\t\t\tthis._keyStr.charAt(enc3) + this._keyStr.charAt(enc4);\n\n\t\t}\n\n\t\treturn output;\n\t},\n\n\t// public method for decoding\n\tdecode : function (input) {\n\t\tvar output = \"\";\n\t\tvar chr1, chr2, chr3;\n\t\tvar enc1, enc2, enc3, enc4;\n\t\tvar i = 0;\n\n\t\tinput = input.replace(/[^A-Za-z0-9\\+\\/\\=]/g, \"\");\n\n\t\twhile (i < input.length) {\n\n\t\t\tenc1 = this._keyStr.indexOf(input.charAt(i++));\n\t\t\tenc2 = this._keyStr.indexOf(input.charAt(i++));\n\t\t\tenc3 = this._keyStr.indexOf(input.charAt(i++));\n\t\t\tenc4 = this._keyStr.indexOf(input.charAt(i++));\n\n\t\t\tchr1 = (enc1 << 2) | (enc2 >> 4);\n\t\t\tchr2 = ((enc2 & 15) << 4) | (enc3 >> 2);\n\t\t\tchr3 = ((enc3 & 3) << 6) | enc4;\n\n\t\t\toutput = output + String.fromCharCode(chr1);\n\n\t\t\tif (enc3 != 64) {\n\t\t\t\toutput = output + String.fromCharCode(chr2);\n\t\t\t}\n\t\t\tif (enc4 != 64) {\n\t\t\t\toutput = output + String.fromCharCode(chr3);\n\t\t\t}\n\n\t\t}\n\n\t\toutput = Base64._utf8_decode(output);\n\n\t\treturn output;\n\n\t},\n\n\t// private method for UTF-8 encoding\n\t_utf8_encode : function (string) {\n\t\tstring = string.replace(/\\r\\n/g,\"\\n\");\n\t\tvar utftext = \"\";\n\n\t\tfor (var n = 0; n < string.length; n++) {\n\n\t\t\tvar c = string.charCodeAt(n);\n\n\t\t\tif (c < 128) {\n\t\t\t\tutftext += String.fromCharCode(c);\n\t\t\t}\n\t\t\telse if((c > 127) && (c < 2048)) {\n\t\t\t\tutftext += String.fromCharCode((c >> 6) | 192);\n\t\t\t\tutftext += String.fromCharCode((c & 63) | 128);\n\t\t\t}\n\t\t\telse {\n\t\t\t\tutftext += String.fromCharCode((c >> 12) | 224);\n\t\t\t\tutftext += String.fromCharCode(((c >> 6) & 63) | 128);\n\t\t\t\tutftext += String.fromCharCode((c & 63) | 128);\n\t\t\t}\n\n\t\t}\n\n\t\treturn utftext;\n\t},\n\n\t// private method for UTF-8 decoding\n\t_utf8_decode : function (utftext) {\n\t\tvar string = \"\";\n\t\tvar i = 0;\n\t\tvar c = c1 = c2 = 0;\n\n\t\twhile ( i < utftext.length ) {\n\n\t\t\tc = utftext.charCodeAt(i);\n\n\t\t\tif (c < 128) {\n\t\t\t\tstring += String.fromCharCode(c);\n\t\t\t\ti++;\n\t\t\t}\n\t\t\telse if((c > 191) && (c < 224)) {\n\t\t\t\tc2 = utftext.charCodeAt(i+1);\n\t\t\t\tstring += String.fromCharCode(((c & 31) << 6) | (c2 & 63));\n\t\t\t\ti += 2;\n\t\t\t}\n\t\t\telse {\n\t\t\t\tc2 = utftext.charCodeAt(i+1);\n\t\t\t\tc3 = utftext.charCodeAt(i+2);\n\t\t\t\tstring += String.fromCharCode(((c & 15) << 12) | ((c2 & 63) << 6) | (c3 & 63));\n\t\t\t\ti += 3;\n\t\t\t}\n\n\t\t}\n\n\t\treturn string;\n\t}\n\n};\n\nexport default Base64;\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/util/base64.js\n **/","import Point from \"../geometry/Point\";\nimport Rectangle from \"../geometry/Rectangle\";\n\n// bean requires the existence of window\nif (typeof window === 'undefined' && typeof global !== 'undefined') {\n\tglobal.window = { addEventHandler: function() {} };\n\tglobal.document = {};\n\tglobal.navigator = {};\n}\n\n// util variables\nlet _debugging = [], _debugAll = false, typeRegistry = {}, splice = Array.splice;\n\n/**\n * Utility functions\n */\nexport default {\n\ttype: function (namespace, name, type) {\n\t\tif (!typeRegistry[namespace])\n\t\t\ttypeRegistry[namespace] = new Map();\n\t\tif (!name)\n\t\t\treturn typeRegistry[namespace];\n\t\tif (!type)\n\t\t\treturn typeRegistry[namespace].get(name);\n\t\ttypeRegistry[namespace].set(name, type);\n\t},\n\n\tcreateType: function (namespace, props, defaultType) {\n\t\tlet name = props.name;\n\n\t\t// first check if type exists\n\t\tlet type = this.type(namespace, name);\n\t\tif (!type) {\n\t\t\tlet extend = props.extends ? this.type(namespace, props.extends) : null;\n\t\t\tif (!extend && defaultType)\n\t\t\t\textend = defaultType;\n\t\t\tif (extend)\n\t\t\t\ttype = class extends extend {\n\t\t\t\t};\n\t\t\telse {\n\t\t\t\ttype = class {\n\t\t\t\t\tconstructor(config) {\n\t\t\t\t\t\t_.assign(this, config);\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t}\n\t\t\tdelete props.name;\n\t\t\tdelete props.extends;\n\t\t\t_.assign(type.prototype, props);\n\t\t\ttype.typeName = name;\n\t\t\tthis.type(namespace, name, type);\n\t\t\tthis.log('Utils', 'Utils.createType - ' + namespace + '.' + name);\n\t\t}\n\t\treturn type;\n\t},\n\n\tbuildTypes: function (types, namespace, defaultType) {\n\t\tthis.log('Utils', 'Utils.buildTypes - ' + namespace);\n\n\t\tif (!types && defaultType) {\n\t\t\tthis.createType(namespace, defaultType);\n\t\t\tthis.log('Utils', 'Utils.buildTypes end');\n\t\t\treturn;\n\t\t}\n\t\tif (defaultType) {\n\t\t\tlet type = _.remove(types, {name: defaultType.name});\n\t\t\ttype = type.length > 0 ? type[0] : null;\n\t\t\tif (type)\n\t\t\t\tdefaultType = this.createType(namespace, _.defaultsDeep(type, defaultType));\n\t\t\telse\n\t\t\t\tdefaultType = this.createType(namespace, defaultType);\n\t\t}\n\n\t\t_.forEach(types, (type) => {\n\t\t\tthis.createType(namespace, type, defaultType);\n\t\t});\n\t\tthis.log('Utils', 'Utils.buildTypes end');\n\t},\n\n\t// Helper function to correctly set up the prototype chain, for subclasses.\n\t// Similar to `goog.inherits`, but uses a hash of prototype properties and\n\t// class properties to be extended.\n\textend: function (child, parent, protoProps, staticProps) {\n\t\t// Add static properties to the constructor function, if supplied.\n\t\t_.extend(child, parent, staticProps);\n\n\t\t// Set the prototype chain to inherit from `parent`, without calling\n\t\t// `parent`'s constructor function.\n\t\tvar Surrogate = function () {\n\t\t\tthis.constructor = child;\n\t\t};\n\t\tSurrogate.prototype = parent.prototype;\n\t\tchild.prototype = new Surrogate;\n\n\t\t// Add prototype properties (instance properties) to the subclass,\n\t\t// if supplied.\n\t\tif (protoProps) _.extend(child.prototype, protoProps);\n\n\t\t// Set a convenience property in case the parent's prototype is needed later.\n\t\tchild.superclass = parent.prototype;\n\n\t\treturn child;\n\t},\n\n\tinitConfig: function (obj, config) {\n\t\tlet props = {}, c = obj.constructor, cArr = [c];\n\t\twhile (c) {\n\t\t\tif (c.super) {\n\t\t\t\tc = c.super.constructor;\n\t\t\t\tsplice.apply(cArr, [0, 0, c]);\n\t\t\t} else\n\t\t\t\tc = null;\n\t\t}\n\n\t\tfor (let i = 0; i < cArr.length; i++) {\n\t\t\tc = cArr[i];\n\t\t\tif (c.DEFAULTS)\n\t\t\t\t_.assign(props, c.DEFAULTS);\n\t\t}\n\t\tobj.props = _.assign(props, config);\n\t\tc.prototype.prop = function (name, value) {\n\t\t\tif (!value)\n\t\t\t\treturn this.props[name];\n\t\t\tthis.props[name] = value;\n\t\t};\n\t},\n\n\t/**\n\t * Gets the JS class constructor.\n\t * @param {Object} jsClass\n\t * @param {Object} defaultClass\n\t */\n\tgetConstructor: function (jsClass, defaultClass) {\n\t\tif (!jsClass)\n\t\t\tjsClass = defaultClass;\n\n\t\tif (_.isString(jsClass))\n\t\t\tjsClass = eval(jsClass);\n\t\treturn jsClass;\n\t},\n\n\tdebug: function (moduleName) {\n\t\tif (moduleName) {\n\t\t\t_debugging.push(moduleName);\n\t\t} else {\n\t\t\t_debugAll = true;\n\t\t}\n\t},\n\n\tlog: function (name, message) {\n\t\tif (!window.console) {\n\t\t\treturn;\n\t\t}\n\t\tvar debug = _debugAll;\n\t\tif (!_debugAll) {\n\t\t\tdebug = false;\n\t\t\tfor (var i = 0; i < _debugging.length; i++) {\n\t\t\t\tif (_debugging[i] == name) debug = true;\n\t\t\t}\n\t\t}\n\t\tif (!debug) {\n\t\t\treturn;\n\t\t}\n\t\twhile (name.length < 10) {\n\t\t\tname = name + ' ';\n\t\t}\n\t\tname = name.substring(0, 10) + \" - \";\n\t\tconsole.info(name, message);\n\t},\n\n\t/**\n\t * Get the relative position of sub shapes within a parent share.\n\t * @param bounds\n\t * @param geometry The geometry information, the format of Geometry is:\n\t * {\n\t *      x: \"x coordinate of ref point, if less than 1, will be treated as the percentage of the parent width.\",\n\t *      y: \"y coordinate of ref point.\",\n\t *      anchorX: \"x pos of child relative to the ref point\",\n\t *      anchorY: \"y pos of child relative to the ref point\",\n\t *      offsetX: \"the offset in the x direction.\",\n\t *      offsetY: \"the offset in the y direction.\",\n\t *      width: \"the width of the child element\",\n\t *      height: \"the height of the child element\"\n\t * }\n\t * @returns {*[]}\n\t */\n\tgetRelativePosition: function (bounds, geometry) {\n\t\tlet x = Math.abs(geometry.x) <= 1 ? bounds.width * geometry.x : geometry.x;\n\t\tlet y = Math.abs(geometry.y) <= 1 ? bounds.height * geometry.y : geometry.y;\n\t\treturn this.offsetPosition([x, y], geometry);\n\t},\n\n\toffsetPosition: function (pos, geometry) {\n\t\treturn [pos[0] + geometry.width * geometry.anchorX + geometry.offsetX, pos[1] + geometry.height * geometry.anchorY + geometry.offsetY];\n\t},\n\n\t/**\n\t * Get the position relative to the graph that's unscaled, i.e., absolute position without considering translation and scale.\n\t * @param t the current translate\n\t * @param scale the current scale\n\t * @param o can be either a Point or a Rectangle or a Point array.\n\t */\n\tunscale: function (t, scale, o) {\n\t\tif (o instanceof Rectangle)\n\t\t\treturn new Rectangle(o.x * scale + t[0], o.y * scale + t[1], o.width * scale, o.height * scale);\n\t\telse if (o instanceof Point)\n\t\t\treturn new Point(o.x * scale + t[0], o.y * scale + t[1]);\n\t\telse\n\t\t\treturn [o[0] * scale + t[0], o[1] * scale + t[1]];\n\t},\n\n\t/**\n\t * Get the position relative to the graph that's scaled, i.e., relative position considering translation and scale.\n\t * @param t the current translation\n\t * @param scale the current scale\n\t * @param o can be either a Point or a Rectangle or a Point array.\n\t */\n\tscale: function (t, scale, o) {\n\t\tif (o instanceof Rectangle)\n\t\t\treturn new Rectangle((o.x - t[0]) / scale, (o.y - t[1]) / scale, o.width / scale, o.height / scale);\n\t\telse if (o instanceof Point)\n\t\t\treturn new Point((o.x - t[0]) / scale, (o.y - t[1]) / scale);\n\t\telse\n\t\t\treturn [(o[0] - t[0]) / scale, (o[1] - t[1]) / scale];\n\t},\n\n\t/**\n\t * Convenience method.\n\t */\n\tgetProperty: function (obj, prop) {\n\t\tif (!obj)\n\t\t\treturn null;\n\t\tif (_.has(obj, prop))\n\t\t\treturn obj[prop];\n\t\tif (obj.prop && _.isFunction(obj.prop))\n\t\t\treturn obj.prop(prop);\n\t\treturn null;\n\t}\n};\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/util/Utils.js\n **/","class Point {\n\tconstructor(x, y) {\n\t\tthis.x = x;\n\t\tthis.y = y;\n\t}\n\n\t/**\n\t * Make a clone of this point\n\t */\n\tclone() {\n\t\treturn new Point(this.x, this.y);\n\t}\n\n\t/**\n\t * Calculate the distance from this pt to the other pt.\n\t * @param aPt\n\t * @returns {number}\n\t */\n\tdistance(aPt) {\n\t\treturn Math.sqrt((this.x - aPt.x) * (this.x - aPt.x) + (this.y - aPt.y) * (this.y - aPt.y));\n\t}\n\n\t/**\n\t * Translate this point\n \t */\n\ttranslate(p2) {\n\t\tthis.x += p2.x;\n\t\tthis.y += p2.y;\n\t\treturn this;\n\t}\n\n\t/**\n\t * Scale this vector\n \t */\n\tscale(scale) {\n\t\tthis.x *= scale;\n\t\tthis.y *= scale;\n\t\treturn this;\n\t}\n\n\tgetScaled(scale) {\n\t\treturn new Point(this.x * scale, this.y * scale);\n\t}\n\n\tgetTranslated(p2) {\n\t\treturn new Point(this.x + p2.x, this.y + p2.y);\n\t}\n\n\t/**\n\t * Get the direction vector from this point to p2.\n\t * @param p2\n\t * @returns {Point}\n\t */\n\tgetDirection(p2) {\n\t\tvar dist = this.distance(p2);\n\t\treturn new Point((p2.x - this.x) / dist, (p2.y - this.y) / dist);\n\t}\n\n\t/**\n\t * rotate the point about the origin. With the specified angle.\n\t * @param angle the angle to rotate\n\t */\n\trotate(angle) {\n\t\tvar cos = Math.cos(angle * Math.PI / 180);\n\t\tvar sin = Math.sin(angle * Math.PI / 180);\n\t\tvar x = this.x, y = this.y;\n\t\tthis.x = x * cos - y * sin;\n\t\tthis.y = x * sin + y * cos;\n\t\treturn this;\n\t}\n\n\tgetRotated(angle) {\n\t\treturn this.clone().rotate(angle);\n\t}\n\n\t/**\n\t * Calculate the dot product, treating this and p2 as vectors.\n\t */\n\tdotProduct(p2) {\n\t\treturn this.x * p2.x + this.y * p2.y;\n\t}\n\n\t/**\n\t * Get the mid point between this and p2.\n \t */\n\tgetMidPoint(p2) {\n\t\treturn new Point((this.x + p2.x) / 2, (this.y + p2.y) / 2);\n\t}\n\n\treverse() {\n\t\tthis.x = -this.x;\n\t\tthis.y = -this.y;\n\t\treturn this;\n\t}\n\n\tequals(p2) {\n\t\tif (!p2 || p2.constructor != Point) return false;\n\n\t\treturn (this.x == p2.x && this.y == p2.y);\n\t}\n\n\t/**\n\t * Reflect this point w.r.t. the rectangle.\n\t * If vertical is true, it will reflect the point cross the vertical\n\t * central line of the rectangle, otherwise reflect cross the horizontal\n\t * central line.\n\t *\n\t * @param rect the rectangle\n\t * @param vertical whether is vertical reflection or horizontal reflection.\n\t */\n\treflect(rect, vertical) {\n\t\tif (vertical)\n\t\t\tthis.x = 2 * rect.x - this.x;\n\t\telse\n\t\t\tthis.y = 2 * rect.y - this.y;\n\t\treturn this;\n\t}\n\n\ttoString() {\n\t\treturn this.x + \",\" + this.y;\n\t}\n}\n\nPoint.W = new Point(-1, 0);\nPoint.N = new Point(0, -1);\nPoint.S = new Point(0, 1);\nPoint.E = new Point(1, 0);\nPoint.NE = new Point(1, -1);\nPoint.NW = new Point(-1, -1);\nPoint.SE = new Point(1, 1);\nPoint.SW = new Point(-1, 1);\n\nexport default Point;\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/geometry/Point.js\n **/","import _ from \"lodash\";\r\nimport Point from \"./Point\";\r\nimport Shape from \"./Shape\";\r\n\r\nexport default class Rectangle extends Shape {\r\n\t/**\r\n\t * Checks whether this rectangle contains a given point of a given rectangle\r\n\t */\r\n\tcontains(el) {\r\n\t\tlet w = el.width || 0;\r\n\t\tlet h = el.height || 0;\r\n\t\tlet left = el.x - w/2;\r\n\t\tlet right = el.x + w/2;\r\n\t\tlet top = el.y - h/2;\r\n\t\tlet bottom = el.y + h/2;\r\n\t\treturn (right <= this.right) && (left >= this.left) &&\r\n\t\t\t(top >= this.top) && (bottom <= this.bottom);\r\n\t}\r\n\r\n\t/**\r\n\t * Calcualte the distance to a point. 0 if this rectangle contains the point.\r\n\t */\r\n\tdistance(pt) {\r\n\t\tif (this.contains(pt)) return 0;\r\n\r\n\t\tif (pt.x < this.left) {\r\n\t\t\tif (pt.y < this.top)\r\n\t\t\t\treturn pt.distance(new Point(this.left, this.top));\r\n\t\t\tif (pt.y <= this.bottom)\r\n\t\t\t\treturn this.left - pt.x;\r\n\t\t\treturn pt.distance(new Point(this.left, this.bottom));\r\n\t\t}\r\n\t\tif (pt.x <= this.right) {\r\n\t\t\tif (pt.y <= this.top)\r\n\t\t\t\treturn this.top - pt.y;\r\n\t\t\treturn pt.y - this.bottom;\r\n\t\t}\r\n\t\tif (pt.y < this.top)\r\n\t\t\treturn pt.distance(new Point(this.right, this.top));\r\n\t\tif (pt.y <= this.bottom)\r\n\t\t\treturn pt.x - this.right;\r\n\t\treturn pt.distance(new Point(this.right, this.bottom));\r\n\t}\r\n\r\n\t/**\r\n\t * Given two points, we want to detect whether the line joining the pts intersect\r\n\t * with the rectangle or not. We assume only horizontal or vertical line segments.\r\n\t *\r\n\t * @return int the side of the intersection: -1: no intersection, 0: left, 1: top, 2: right, 3: bottom, 4: containment.\r\n\t */\r\n\tdetectIntersection(pt1, pt2) {\r\n\t\tlet horizontal = pt1.y == pt2.y;\r\n\t\tlet contains1 = this.contains(pt1);\r\n\t\tlet contains2 = this.contains(pt2);\r\n\t\tif (contains1 && contains2) return 4;\r\n\t\tif (!contains1 && !contains2) {\r\n\t\t\tif (horizontal && (pt1.y >= this.top && pt1.y <= this.bottom)) {\r\n\t\t\t\tif (pt1.x < this.left && pt2.x > this.right)\r\n\t\t\t\t\treturn 0;\r\n\t\t\t\tif (pt1.x > this.right && pt2.x < this.left)\r\n\t\t\t\t\treturn 2;\r\n\t\t\t}\r\n\t\t\tif (!horizontal && (pt1.x >= this.left && pt1.x <= this.right)) {\r\n\t\t\t\tif (pt1.y < this.top && pt2.y > this.bottom)\r\n\t\t\t\t\treturn 1;\r\n\t\t\t\tif (pt1.y > this.bottom && pt2.y < this.top)\r\n\t\t\t\t\treturn 3;\r\n\t\t\t}\r\n\t\t\treturn -1;\r\n\t\t}\r\n\r\n\t\tlet outPt = contains1 ? pt2 : pt1;\r\n\t\tif (horizontal) {\r\n\t\t\tif (outPt.x > this.right)\r\n\t\t\t\treturn 2;\r\n\t\t\treturn 0;\r\n\t\t} else {\r\n\t\t\tif (outPt.y < this.top)\r\n\t\t\t\treturn 1;\r\n\t\t\treturn 3;\r\n\t\t}\r\n\t}\r\n\r\n\ttoString() {\r\n\t\treturn 'Rectangle:{x=' + this.x + ';y=' + this.y + ';width=' + this.width + ';height=' + this.height + '}';\r\n\t}\r\n\r\n\tstatic getPerimeter(rect, pt, orthogonal = false) {\r\n\t\tlet x = rect.x;\r\n\t\tlet y = rect.y;\r\n\t\tlet dx = pt.x - x;\r\n\t\tlet dy = pt.y - y;\r\n\t\tlet alpha = Math.atan2(dy, dx);\r\n\t\tlet p = new Point(0, 0);\r\n\t\tlet pi = Math.PI;\r\n\t\tlet pi2 = Math.PI/2;\r\n\t\tlet beta = pi2 - alpha;\r\n\t\tlet t = Math.atan2(rect.height, rect.width);\r\n\r\n\t\tif (alpha < -pi + t || alpha > pi - t) {\r\n\t\t\t// Left edge\r\n\t\t\tp.x = rect.left;\r\n\t\t\tp.y = y - rect.width * Math.tan(alpha) / 2;\r\n\t\t} else if (alpha < -t) {\r\n\t\t\t// Top Edge\r\n\t\t\tp.y = rect.top;\r\n\t\t\tp.x = x - rect.height * Math.tan(beta) / 2;\r\n\t\t} else if (alpha < t) {\r\n\t\t\t// Right Edge\r\n\t\t\tp.x = rect.right;\r\n\t\t\tp.y = y + rect.width * Math.tan(alpha) / 2;\r\n\t\t} else {\r\n\t\t\t// Bottom Edge\r\n\t\t\tp.y = rect.bottom;\r\n\t\t\tp.x = x + rect.height * Math.tan(beta) / 2;\r\n\t\t}\r\n\r\n\t\tif (orthogonal) {\r\n\t\t\tif (alpha < -pi + t || alpha > pi - t) {\r\n\t\t\t\t// Left edge\r\n\t\t\t\tp.x = rect.left;\r\n\t\t\t\tp.y = y;\r\n\t\t\t} else if (alpha < -t) {\r\n\t\t\t\t// Top Edge\r\n\t\t\t\tp.y = rect.top;\r\n\t\t\t\tp.x = x;\r\n\t\t\t} else if (alpha < t) {\r\n\t\t\t\t// Right Edge\r\n\t\t\t\tp.x = rect.right;\r\n\t\t\t\tp.y = y;\r\n\t\t\t} else {\r\n\t\t\t\t// Bottom Edge\r\n\t\t\t\tp.y = rect.bottom;\r\n\t\t\t\tp.x = x;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tlet dir = Rectangle.getDirection(rect, p, orthogonal);\r\n\t\treturn {point: p, direction: dir};\r\n\t}\r\n\r\n\t/**\r\n\t * Return the bounding rectangle that contains p1 and p2\r\n\t */\r\n\tstatic getBoundingRectangle(pts, margin) {\r\n\t\tif (!pts || pts.length == 0) return null;\r\n\t\tmargin = margin || [0, 0, 0, 0];\r\n\t\tif (!_.isArray(margin))\r\n\t\t\tmargin = [margin, margin, margin, margin];\r\n\t\tlet min = [pts[0].x, pts[0].y];\r\n\t\tlet max = [pts[0].x, pts[0].y];\r\n\t\tfor (let i = 1; i < pts.length; i++) {\r\n\t\t\tlet p = pts[i];\r\n\t\t\tif (p.x < min[0]) {\r\n\t\t\t\tmin[0] = p.x;\r\n\t\t\t}\r\n\t\t\tif (p.y < min[1]) {\r\n\t\t\t\tmin[1] = p.y;\r\n\t\t\t}\r\n\t\t\tif (p.x > max[0]) {\r\n\t\t\t\tmax[0] = p.x;\r\n\t\t\t}\r\n\t\t\tif (p.y > max[1]) {\r\n\t\t\t\tmax[1] = p.y;\r\n\t\t\t}\r\n\t\t}\r\n\t\tmin[0] = min[0] - margin[0];\r\n\t\tmin[1] = min[1] - margin[1];\r\n\t\tmax[0] = max[0] + margin[2];\r\n\t\tmax[1] = max[1] + margin[3];\r\n\t\tlet w = Math.abs(max[0] - min[0]);\r\n\t\tlet h = Math.abs(max[1] - min[1]);\r\n\t\treturn new Rectangle(min[0] + w/2, min[1] + h/2, w, h);\r\n\t}\r\n\r\n\t/**\r\n\t * Create a union of all the rectangles.\r\n\t * @param rects\r\n\t */\r\n\tstatic union(rects) {\r\n\t\tlet minx = null, miny = null, maxx = -Infinity, maxy = -Infinity;\r\n\t\t_.each(rects, function (rect) {\r\n\t\t\tminx = minx || rect.x;\r\n\t\t\tminy = miny || rect.y;\r\n\t\t\tminx = Math.min(minx, rect.x);\r\n\t\t\tminy = Math.min(miny, rect.y);\r\n\t\t\tmaxx = Math.max(maxx, rect.right());\r\n\t\t\tmaxy = Math.max(maxy, rect.bottom());\r\n\t\t});\r\n\t\tminx = minx || 0;\r\n\t\tminy = miny || 0;\r\n\t\treturn new Rectangle(minx, miny, maxx - minx, maxy - miny);\r\n\t}\r\n\r\n\t/**\r\n\t * Returns the direction the point <i>p</i> is in relation to the given rectangle.\r\n\t * Possible values are WEST (-1,0), EAST (1,0), NORTH (0,-1) and SOUTH (0,1) if orthogonal is true, otherwise return\r\n\t * the direction connection the center of r and p.\r\n\t * @param r\r\n\t * @param p\r\n\t * @param orthogonal\r\n\t * @returns {Point|*}\r\n\t */\r\n\tstatic getDirection(r, p, orthogonal = false) {\r\n\t\tif (!orthogonal)\r\n\t\t\treturn new Point(r.x, r.y).getDirection(new Point(p.x, p.y));\r\n\r\n\t\tlet i, distance = Math.abs(r.left - p.x), direction = Point.W;\r\n\r\n\t\ti = Math.abs(r.top - p.y);\r\n\t\tif (i <= distance) {\r\n\t\t\tdistance = i;\r\n\t\t\tdirection = Point.N;\r\n\t\t}\r\n\r\n\t\ti = Math.abs(r.bottom - p.y);\r\n\t\tif (i <= distance) {\r\n\t\t\tdistance = i;\r\n\t\t\tdirection = Point.S;\r\n\t\t}\r\n\r\n\t\ti = Math.abs(r.right - p.x);\r\n\t\tif (i < distance) {\r\n\t\t\tdirection = Point.E;\r\n\t\t}\r\n\r\n\t\treturn direction;\r\n\t}\r\n}\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/geometry/Rectangle.js\n **/","module.exports = __WEBPACK_EXTERNAL_MODULE_5__;\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external {\"root\":\"_\",\"commonjs\":\"lodash\",\"commonjs2\":\"lodash\",\"amd\":\"lodash\"}\n ** module id = 5\n ** module chunks = 0\n **/","import _ from \"lodash\";\nimport Point from \"./Point\";\nimport Rectangle from \"./Rectangle\";\n\nlet registry = {};\n\nclass Shape {\n\tconstructor(x, y, width, height, config) {\n\t\tthis.x = x;\n\t\tthis.y = y;\n\t\tthis.width = width;\n\t\tthis.height = height;\n\t\t_.defaults(this, config, {x: 0, y: 0, width: 0, height: 0});\n\t}\n\n\t/**\n\t * Return the y-coord of the top side of this rectangle\n\t */\n\tget top() { return this.y - this.height/2; }\n\n\t/**\n\t * Returns the y-coordinate of the bottom of this Rectangle.\n\t */\n\tget bottom() { return this.y + this.height/2; }\n\n\t/**\n\t * Return the x-coord of left side of this rectangle\n\t */\n\tget left() { return this.x - this.width/2; }\n\n\t/**\n\t * Returns the x-coordinate of the right side of this Rectangle.\n\t */\n\tget right() { return this.x + this.width/2; }\n\n\tget center() { return new Point(this.x, this.y); }\n\n\tget bounds() { return new Rectangle(this.x, this.y, this.width, this.height); }\n\n\tcontains(el) { return false; }\n\n\t/**\n\t * This will generate n ports on the shape.\n\t */\n\tgetRegularPoints(n) {return null;}\n\n\t/**\n\t * Get the intersection between boundary of this shape and the line connecting (x,y) with the refPt.\n\t * @param refPt\n\t * @returns {null}\n\t */\n\tgetPerimeter(refPt, orthogonal = false) {\n\t\treturn this.constructor.getPerimeter(this, refPt, orthogonal);\n\t}\n\n\trender(view) {\n\t\tlet template = _.template(view.getTemplate(this.name, this));\n\t\treturn template(this);\n\t}\n\n\tstatic getShape(name) {\n\t\treturn registry[name];\n\t}\n\n\tstatic addShape(name, c) {\n\t\tregistry[name] = c;\n\t}\n\n\tstatic removeShape(name) {\n\t\tdelete registry[name];\n\t}\n}\n\nexport default Shape;\n\n\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/geometry/Shape.js\n **/","import _ from \"lodash\";\n\n/**\n * dom Utility functions\n */\nexport default {\n\tisIE: (function () {\n\t\tif (!window || !window.navigator || !navigator) return false;\n\t\tvar sAgent = window.navigator.userAgent;\n\t\tvar Idx = sAgent.indexOf(\"MSIE\");\n\n\t\t// If IE, return version number.\n\t\tif (Idx > 0)\n\t\t\treturn parseInt(sAgent.substring(Idx + 5, sAgent.indexOf(\".\", Idx)));\n\n\t\t// If IE 11 then look for Updated user agent string.\n\t\telse if (!!navigator.userAgent.match(/Trident\\/7\\./))\n\t\t\treturn 11;\n\t\telse if (!!navigator.userAgent.match(/Edge\\//))\n\t\t\treturn \"Edge\";\n\t\telse\n\t\t\treturn false;\n\t})(),\n\n\tisFireFox : (function(){\n\t\t// InstallTrigger: Firefox's API to install add-ons\n\t\treturn typeof InstallTrigger !== 'undefined';\n\t})(),\n\n\tisChrome: (function() {\n\t\tif (!window || !window.navigator || !navigator || navigator.userAgent.indexOf('Edge') >= 0) return false;\n\t\tvar raw = navigator.userAgent.match(/Chrom(e|ium)\\/([0-9]+)\\./);\n\t\treturn raw ? parseInt(raw[2], 10) : false;\n\t})(),\n\n\tisMac: (function() {\n\t\tif (!window || !window.navigator || !navigator) return false;\n\t\treturn navigator.platform.toUpperCase().indexOf('MAC') >= 0;\n\t})(),\n\n\tisWindows: (function() {\n\t\tif (!window || !window.navigator || !navigator) return false;\n\t\treturn navigator.appVersion.indexOf(\"Windows\") >= 0;\n\t})(),\n\n\tisLinux: (function() {\n\t\tif (!window || !window.navigator || !navigator) return false;\n\t\treturn navigator.appVersion.indexOf(\"Linux\") >= 0;\n\t})(),\n\n\tcreateElement: function (tag, attribs, styles, html) {\n\t\tlet el = document.createElement(tag);\n\t\tthis.setElement(el, attribs, styles);\n\t\tif (html)\n\t\t\tel.innerHTML = html;\n\t\treturn el;\n\t},\n\n\tcreateElementByString: function(str) {\n\t\tlet temp = this.createElement('div', null, null, str);\n\t\treturn temp.childNodes;\n\t},\n\n\tsetElement: function (el, attribs, styles) {\n\t\tif (attribs) {\n\t\t\t_.forEach(attribs, function(value, key) {\n\t\t\t    el.setAttribute(key, value);\n\t\t\t });\n\t\t}\n\t\tif (styles) {\n\t\t\t_.forEach(styles, function(value, key) {\n\t\t\t\tel.style[key] = value;\n\t\t\t});\n\t\t}\n\t},\n\n\ttestElement: function(node, method) {\n\t\treturn node && node.nodeType == 1 && ( !method || method(node) );\n\t},\n\n\tgetAncestorBy: function(node, method) {\n\t\twhile (node = node.parentNode)\n\t\t\tif (this.testElement(node, method) )\n\t\t\t\treturn node;\n\n\t\treturn null;\n\t},\n\n\t/**\n\t * Get the position of element relative to the context.\n\t * @param el the element\n\t * @param context\n\t * @returns {*[]}\n\t */\n\tgetPosition(el, context) {\n\t\tif (!context) context = document.body;\n\t\tlet elRect = el.getBoundingClientRect();\n\t\tlet contextRect = context.getBoundingClientRect();\n\n\t\treturn [elRect.left - contextRect.left, elRect.top - contextRect.top];\n\t},\n\n\tgetCenterPosition(el, context) {\n\t\tif (!context) context = document.body;\n\t\tlet elRect = el.getBoundingClientRect();\n\t\tlet contextRect = context.getBoundingClientRect();\n\t\tlet w = elRect.right - elRect.left;\n\t\tlet h = elRect.bottom - elRect.top;\n\n\t\treturn [elRect.left - contextRect.left + w/2, elRect.top - contextRect.top + h/2];\n\t},\n\n\tmove: function(el, x, y) {\n\t\tif (x) el.style.left = x + 'px';\n\t\tif (y) el.style.top = y + 'px';\n\t},\n\n\tgetSize: function(el) {\n\t\tvar w = parseInt(el.style.offsetWidth, 10);\n\t\tvar h = parseInt(el.style.offsetHeight, 10);\n\t\treturn [w, h];\n\t},\n\n\tresize: function(el, w, h) {\n\t\tif (w) el.style.width = w + \"px\";\n\t\tif (h) el.style.height = h + 'px';\n\t},\n\n\tpreloadImages: function(array) {\n\t\tif (!this.preloadImages.list) this.preloadImages.list = [];\n\t\tif (!this.preloadImages.loaded) this.preloadImages.loaded = {};\n\n\t\tvar list = this.preloadImages.list;\n\t\tvar img, that = this;\n\t\tfor (var i = 0; i < array.length; i++) {\n\t\t\timg = new Image();\n\t\t\timg.onload = function() {\n\t\t\t\tvar index = list.indexOf(this);\n\t\t\t\tif (index !== -1) {\n\t\t\t\t\tthat.preloadImages.loaded[this.name] = {width: this.width, height: this.height};\n\t\t\t\t\t// remove image from the array once it's loaded\n\t\t\t\t\t// for memory consumption reasons\n\t\t\t\t\tlist.splice(index, 1);\n\t\t\t\t}\n\t\t\t};\n\t\t\tlist.push(img);\n\t\t\timg.src = array[i];\n\t\t\timg.name = array[i];\n\t\t}\n\t},\n\n\t/**\n\t * Get's the image's information given the url. Must be preloaded by calling the preloadImage function.\n\t * @param src\n\t */\n\tgetImageInfo: function(src) {\n\t\tif (this.preloadImages.loaded) {\n\t\t\treturn this.preloadImages.loaded[src];\n\t\t}\n\t\treturn null;\n\t},\n\n\tdownloadFile: function(name, data) {\n\t\tif (!data) return;\n\t\tlet mime = data.match(/^data:([^;,]*)/)[1];\n\t\tif (name.indexOf('.') < 0) {\n\t\t\tif (!mime) mime = 'text/plain';\n\t\t\tif (mime == 'text/plain')\n\t\t\t\tname = name + '.txt';\n\t\t\telse {\n\t\t\t\tlet type = mime.split('/')[1];\n\t\t\t\tif (type.indexOf('+') > 0) type = type.split('+')[0];\n\t\t\t\tname = name + '.' + type;\n\t\t\t}\n\t\t}\n\t\tif (this.isIE) {\n\t\t\tlet encoded = data.indexOf(';base64') >= 0;\n\t\t\tif (encoded)\n\t\t\t\tdata = atob(data.replace('data:' + mime + ';base64,', ''));\n\t\t\telse\n\t\t\t\tdata = decodeURI(data.replace('data:' + mime + ',', ''));\n\t\t\tdata = this.GetBlob(data, mime);\n\t\t\tnavigator.msSaveBlob(data, name);\n\t\t} else {\n\t\t\tlet link = this.createElement('a', {href: data, download: name}, {display: \"none\"});\n\t\t\tdocument.body.appendChild(link);\n\t\t\tlink.click();\n\t\t\tlink.parentNode.removeChild(link);\n\t\t}\n\t},\n\n\t/**\n\t * Convert b54 to blob. IE only\n\t */\n\tGetBlob: function (data, contentType, sliceSize) {\n\t\tcontentType = contentType || '';\n\t\tsliceSize = sliceSize || 512;\n\n\t\tvar byteArrays = [];\n\n\t\tfor (var offset = 0; offset < data.length; offset += sliceSize) {\n\t\t\tvar slice = data.slice(offset, offset + sliceSize);\n\n\t\t\tvar byteNumbers = new Array(slice.length);\n\t\t\tfor (var i = 0; i < slice.length; i++) {\n\t\t\t\tbyteNumbers[i] = slice.charCodeAt(i);\n\t\t\t}\n\t\t\tvar byteArray = new Uint8Array(byteNumbers);\n\t\t\tbyteArrays.push(byteArray);\n\t\t}\n\t\treturn new Blob(byteArrays, {type: contentType});\n\t},\n\n\topenImage: function(name, image) {\n\t\tvar myWindow = window.open(\"\", \"_blank\", \"toolbar=yes, scrollbars=yes, resizable=yes, width=500, height=500\");\n\t\tvar myDocument = myWindow.document;\n\t\tvar img = myDocument.createElement(\"img\");\n\t\tthis.setElement(img, {src: image, name: name});\n\t\tmyDocument.body.appendChild(img);\n\t},\n\n\t/**\n\t * Check whether the key event is from input, textarea or select.\n\t * @param e  input event\n\t */\n\teventFromInput: function(e){\n\t\tvar tagName = e.target.tagName;\n\t\treturn (tagName == 'INPUT' || tagName == 'TEXTAREA' || tagName == 'SELECT');\n\t}\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/util/DomUtils.js\n **/","import _ from \"lodash\";\n\n/**\n * A string buffer for fast string manipulation\n */\nexport default class StringBuffer {\n\tconstructor(str) {\n\t\tthis.buffer = [];\n\t\tif (str)\n\t\t\tthis.buffer.push(str);\n\t}\n\n\tappend(stuff) {\n\t\tif (_.isString(stuff))\n\t\t\tthis.buffer.push(stuff);\n\t\telse if (_.isArray(stuff))\n\t\t\tthis.buffer = this.buffer.concat(stuff);\n\t\telse\n\t\t\tthis.buffer.push(\"\" + stuff);\n\t\treturn this;\n\t}\n\n\tprepend(stuff) {\n\t\tif (_.isString(stuff))\n\t\t\tthis.buffer.splice(0, 0, stuff);\n\t\telse if (_.isArray(stuff))\n\t\t\tthis.buffer = stuff.concat(this.buffer);\n\t\telse\n\t\t\tthis.buffer.splice(0, 0, \"\" + stuff);\n\t\treturn this;\n\t}\n\n\tclear() {\n\t\tthis.buffer = [];\n\t}\n\n\tremoveLast() {\n\t\tthis.buffer.pop();\n\t\treturn this;\n\t}\n\n\ttoString(sep) {\n\t\tif (!sep) sep = '';\n\t\treturn this.buffer.join(sep);\n\t}\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/util/StringBuffer.js\n **/","import Point from \"./Point\";\n\nexport default class Line {\n\tconstructor(start, end) {\n\t\tthis.start = start;\n\t\tthis.end = end;\n\t}\n\n\t/**\n\t * Calculate the length of this line\n\t */\n\tlength() {\n\t\treturn this.start.distance(this.end);\n\t}\n\n\t/**\n\t * Calculate the distance of this line to the point.\n\t */\n\tdistance(pt) {\n\t\tvar x = this.start.distance(pt);\n\t\tif (x == 0) return 0;\n\n\t\tvar l = this.length();\n\t\tvar cosa = new Point((this.end.x - this.start.x) / l, (this.end.y - this.start.y) / l).dotProduct(\n\t\t\tnew Point(pt.x / x, pt.y / x));\n\n\t\treturn x * Math.sqrt(1 - cosa * cosa);\n\t}\n\n\t/**\n\t * Function: intersection\n\t *\n\t * Returns the intersection of two lines as an <mxPoint>.\n\t *\n\t * Parameters:\n\t *\n\t * x0 - X-coordinate of the first line's startpoint.\n\t * y0 - X-coordinate of the first line's startpoint.\n\t * x1 - X-coordinate of the first line's endpoint.\n\t * y1 - Y-coordinate of the first line's endpoint.\n\t * x2 - X-coordinate of the second line's startpoint.\n\t * y2 - Y-coordinate of the second line's startpoint.\n\t * x3 - X-coordinate of the second line's endpoint.\n\t * y3 - Y-coordinate of the second line's endpoint.\n\t */\n\tstatic intersection(x0, y0, x1, y1, x2, y2, x3, y3) {\n\t\tvar denom = ((y3 - y2) * (x1 - x0)) - ((x3 - x2) * (y1 - y0));\n\t\tvar nume_a = ((x3 - x2) * (y0 - y2)) - ((y3 - y2) * (x0 - x2));\n\t\tvar nume_b = ((x1 - x0) * (y0 - y2)) - ((y1 - y0) * (x0 - x2));\n\n\t\tvar ua = nume_a / denom;\n\t\tvar ub = nume_b / denom;\n\n\t\tif (ua >= 0.0 && ua <= 1.0 && ub >= 0.0 && ub <= 1.0) {\n\t\t\t// Get the intersection point\n\t\t\tvar intersectionX = x0 + ua * (x1 - x0);\n\t\t\tvar intersectionY = y0 + ua * (y1 - y0);\n\n\t\t\treturn new Point(intersectionX, intersectionY);\n\t\t}\n\n\t\t// No intersection\n\t\treturn null;\n\t}\n\n\ttoString() {\n\t\treturn 'Line:{start=' + this.start + ';end=' + this.end + '}';\n\t}\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/geometry/Line.js\n **/","import Shape from \"./Shape\";\r\nimport Point from \"./Point\";\r\nimport Rectangle from \"./Rectangle\";\r\n\r\nexport default class Ellipse extends Shape {\r\n\ttoString() {\r\n\t\treturn 'Ellipse:{x=' + this.x + ';y=' + this.y + ';width=' + this.width + ';height=' + this.height + '}';\r\n\t}\r\n\r\n\tstatic getPerimeter(rect, pt, orthogonal = false) {\r\n\t\tvar a = rect.width / 2;\r\n\t\tvar b = rect.height / 2;\r\n\t\tvar cx = rect.x;\r\n\t\tvar cy = rect.y;\r\n\t\tvar px = pt.x;\r\n\t\tvar py = pt.y;\r\n\r\n\t\t// Calculates straight line equation through\r\n\t\t// point and ellipse center y = d * x + h\r\n\t\tvar dx = parseInt(px - cx);\r\n\t\tvar dy = parseInt(py - cy);\r\n\r\n\t\tvar tx, ty;\r\n\r\n\t\tif (dx == 0 && dy != 0) {\r\n\t\t\treturn new Point(cx, cy + b * dy / Math.abs(dy));\r\n\t\t} else if (dx == 0 && dy == 0) {\r\n\t\t\treturn new Point(px, py);\r\n\t\t}\r\n\r\n\t\t// Calculates intersection\r\n\t\tvar d = dy / dx;\r\n\t\tvar h = cy - d * cx;\r\n\t\tvar e = a * a * d * d + b * b;\r\n\t\tvar f = -2 * cx * e;\r\n\t\tvar g = a * a * d * d * cx * cx + b * b * cx * cx - a * a * b * b;\r\n\t\tvar det = Math.sqrt(f * f - 4 * e * g);\r\n\r\n\t\t// Two solutions (perimeter points)\r\n\t\tvar xout1 = (-f + det) / (2 * e);\r\n\t\tvar xout2 = (-f - det) / (2 * e);\r\n\t\tvar yout1 = d * xout1 + h;\r\n\t\tvar yout2 = d * xout2 + h;\r\n\t\tvar dist1 = Math.sqrt(Math.pow((xout1 - px), 2) + Math.pow((yout1 - py), 2));\r\n\t\tvar dist2 = Math.sqrt(Math.pow((xout2 - px), 2) + Math.pow((yout2 - py), 2));\r\n\r\n\t\t// Correct solution\r\n\t\tvar xout = 0;\r\n\t\tvar yout = 0;\r\n\r\n\t\tif (dist1 < dist2) {\r\n\t\t\txout = xout1;\r\n\t\t\tyout = yout1;\r\n\t\t} else {\r\n\t\t\txout = xout2;\r\n\t\t\tyout = yout2;\r\n\t\t}\r\n\r\n\t\tlet p = new Point(xout, yout);\r\n\t\tlet dir = Rectangle.getDirection(rect, p, orthogonal);\r\n\t\tif (orthogonal) {\r\n\t\t\tif (dir.x == -1) {\r\n\t\t\t\treturn {point: new Point(cx - a, cy), direction: dir};\r\n\t\t\t}\r\n\t\t\tif (dir.x == 1) {\r\n\t\t\t\treturn {point: new Point(cx + a, cy), direction: dir};\r\n\t\t\t}\r\n\t\t\tif (dir.y == -1) {\r\n\t\t\t\treturn {point: new Point(cx, cy - b), direction: dir};\r\n\t\t\t}\r\n\t\t\tif (dir.y == 1) {\r\n\t\t\t\treturn {point: new Point(cx, cy + b), direction: dir};\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn {point: p, direction: dir};\r\n\t}\r\n}\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/geometry/Ellipse.js\n **/","import _ from \"lodash\";\r\nimport Point from \"./Point\";\r\nimport Utils from \"../util/Utils\";\r\n\r\nlet defaultConfig = {\r\n\ttype: \"direct\",\r\n\tshowGauge: true,\r\n\torthogonal: false\r\n};\r\n\r\nlet defaultGeometry = {\r\n\twidth: 0,\r\n\theight: 0,\r\n\tanchorX: 0,\r\n\tanchorY: 0,\r\n\toffsetX: 0,\r\n\toffsetY: 0\r\n};\r\n\r\nlet linkTypes = {};\r\n\r\nclass Link {\r\n\tconstructor(terminalVisual, shapeConfig = {}, startMarker = null, endMarker = null) {\r\n\t\tthis.start = terminalVisual[0].point;\r\n\t\tthis.end = terminalVisual[1].point;\r\n\t\tthis.startNormal = terminalVisual[0].direction;\r\n\t\tthis.endNormal = terminalVisual[1].direction;\r\n\t\tthis.startMarker = startMarker;\r\n\t\tthis.endMarker = endMarker;\r\n\t\t_.assign(this, shapeConfig);\r\n\t}\r\n\r\n\trender(view) {\r\n\t\treturn view.renderLink(this);\r\n\t}\r\n\r\n\tget points() { return null; }\r\n\tget controlPts() { return null; }\r\n\tget length() {\r\n\t\tlet points = this.points;\r\n\t\tlet i, l = 0;\r\n\t\tfor (i = 0; i < points.length - 1; i++)\r\n\t\t\tl += points[i].distance(points[i+1]);\r\n\t\treturn l;\r\n\t}\r\n\r\n\t/**\r\n\t * Calculate the position where to put modifiers or label..\r\n\t *\r\n\t * @param geometry: defines how far along the edge should the point be placed.\r\n\t * @return *[] the relative position.\r\n\t */\r\n\tgetRelativePosition(geometry) {\r\n\t\tif (_.isNumber(geometry))\r\n\t\t\tgeometry = {x: geometry};\r\n\t\tgeometry = _.defaults(geometry, defaultGeometry);\r\n\t\tlet p = geometry.x, l = this.length;\r\n\t\tif (Math.abs(p) <= 1) p *= l;\r\n\t\tif (p < 0) p = l + p;\r\n\t\tif (p > l) p = l;\r\n\r\n\t\tlet points = this.points, d, point, dir;\r\n\t\tfor (let i = 0; i < points.length - 1; i++) {\r\n\t\t\td = points[i].distance(points[i+1]);\r\n\t\t\tif (p <= d) {\r\n\t\t\t\t// we've located the line segment.\r\n\t\t\t\tpoint = points[i].clone();\r\n\t\t\t\tdir = point.getDirection(points[i+1]);\r\n\t\t\t\tpoint.translate(dir.getScaled(p));\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t\tp -= d;\r\n\t\t}\r\n\r\n\t\t// return the last point.\r\n\t\tif (!point)\r\n\t\t\tpoint = points[points.length - 1];\r\n\t\treturn Utils.offsetPosition([point.x, point.y], geometry);\r\n\t}\r\n\r\n\ttoString() {\r\n\t\treturn 'Link';\r\n\t}\r\n\r\n\tstatic getLink(terminalVisual, shapeConfig = {}, startMarker = null, endMarker = null) {\r\n\t\tshapeConfig = _.defaultsDeep(shapeConfig, defaultConfig);\r\n\t\tlet linkClass = linkTypes[shapeConfig.type];\r\n\t\tif (linkClass)\r\n\t\t\treturn new linkClass(terminalVisual, shapeConfig, startMarker, endMarker);\r\n\t\tconsole.log('link type not supported: ' + shapeConfig.type);\r\n\t\treturn null;\r\n\t}\r\n}\r\n\r\nclass DirectLink extends Link {\r\n\tget points() {\r\n\t\treturn [this.start, this.end];\r\n\t}\r\n}\r\n\r\nclass BezierLink extends Link {\r\n\tget points() {\r\n\t\treturn [this.start, this.end];\r\n\t}\r\n\r\n\tget controlPts() {\r\n\t\tlet s = this.points[0], e = this.points[1];\r\n\t\tlet pts = [];\r\n\t\tpts[0] = null;\r\n\t\tpts[1] = [];\r\n\t\tif (this.startNormal.x == 0) {\r\n\t\t\tpts[1][0] = new Point(s.x, (s.y + e.y)/2);\r\n\t\t}\r\n\t\telse {\r\n\t\t\tpts[1][0] = new Point((s.x + e.x)/2, s.y);\r\n\t\t}\r\n\t\tif (this.endNormal.x == 0) {\r\n\t\t\tpts[1][1] = new Point(e.x, (s.y + e.y)/2);\r\n\t\t}\r\n\t\telse {\r\n\t\t\tpts[1][1] = new Point((s.x + e.x)/2, e.y);\r\n\t\t}\r\n\t\treturn pts;\r\n\t}\r\n\r\n\tgetRelativePosition(geometry) {\r\n\t\tif (_.isNumber(geometry))\r\n\t\t\tgeometry = {x: geometry};\r\n\t\tgeometry = _.defaults(geometry, defaultGeometry);\r\n\t\tlet p = geometry.x, l = this.length;\r\n\t\tif (Math.abs(p) > 1) p /= l;\r\n\t\tif (p < 0) p++;\r\n\t\tif (p > 1) p--;\r\n\r\n\t\tlet pts = this.points;\r\n\t\tlet ctrlpts = this.controlPts;\r\n\t\tlet p1 = pts[0];\r\n\t\tlet p2 = ctrlpts[1][0];\r\n\t\tlet p3 = ctrlpts[1][1];\r\n\t\tlet p4 = pts[1];\r\n\r\n\t\tlet point = [(1-p)*(1-p)*(1-p) * p1.x + 3*p*(1-p)*(1-p) * p2.x + 3*p*p*(1-p) * p3.x + p*p*p * p4.x, (1-p)*(1-p)*(1-p) * p1.y + 3*p*(1-p)*(1-p) * p2.y + 3*p*p*(1-p) * p3.y + p*p*p * p4.y];\r\n\t\treturn Utils.offsetPosition([point.x, point.y], geometry);\r\n\t}\r\n}\r\n\r\nclass EntityRelations extends Link {\r\n\tget points() {\r\n\t\tvar source = Port.getBounds(edge, true);\r\n\t\tvar target = Port.getBounds(edge, false);\r\n\t\tvar isSourceLeft = target.right() < source.x;\r\n\t\tvar isTargetLeft = source.right() < target.x;\r\n\t\tvar result = [];\r\n\r\n\t\tvar x0 = (isSourceLeft) ? source.x : source.x + source.width;\r\n\t\tvar y0 = source.getCenterY();\r\n\t\tresult.push(new Point(x0, y0));\r\n\r\n\t\tvar xe = (isTargetLeft) ? target.x : target.x + target.width;\r\n\t\tvar ye = target.getCenterY();\r\n\r\n\t\tvar seg = this.segment;\r\n\r\n\t\tvar dx = (isSourceLeft) ? -seg : seg;\r\n\t\tvar dep = new Point(x0 + dx, y0);\r\n\r\n\t\tdx = (isTargetLeft) ? -seg : seg;\r\n\t\tvar arr = new Point(xe + dx, ye);\r\n\r\n\t\t// Adds intermediate points if both go out on same side\r\n\t\tif (isSourceLeft == isTargetLeft)\r\n\t\t{\r\n\t\t\tvar x = (isSourceLeft) ?\r\n\t\t\tMath.min(x0, xe)-seg :\r\n\t\t\tMath.max(x0, xe)+seg;\r\n\r\n\t\t\tresult.push(new Point(x, y0));\r\n\t\t\tresult.push(new Point(x, ye));\r\n\t\t}\r\n\t\telse if ((dep.x < arr.x) == isSourceLeft)\r\n\t\t{\r\n\t\t\tvar midY = y0 + (ye - y0) / 2;\r\n\r\n\t\t\tresult.push(dep);\r\n\t\t\tresult.push(new Point(dep.x, midY));\r\n\t\t\tresult.push(new Point(arr.x, midY));\r\n\t\t\tresult.push(arr);\r\n\t\t}\r\n\t\telse\r\n\t\t{\r\n\t\t\tresult.push(dep);\r\n\t\t\tresult.push(arr);\r\n\t\t}\r\n\r\n\t\tresult.push(new Point(xe, ye));\r\n\t\treturn result;\r\n\t}\r\n}\r\n\r\n\r\nclass Manhattan extends Link {\r\n\tconstructor(terminalVisual, shapeConfig, startMarker, endMarker) {\r\n\t\tshapeConfig = _.defaults(shapeConfig, {\r\n\t\t\tMIN_BUFFER: 10,\r\n\t\t\tautoRoute: false,\r\n\t\t\tmaxChannelWidth: 100\r\n\t\t});\r\n\t\tsuper(terminalVisual, shapeConfig, startMarker, endMarker);\r\n\t}\r\n\r\n\tget points() {\r\n\t\t//let pos = Manhattan.routeInternal(this.start, this.end, this.startNormal, this.endNormal, this.MIN_BUFFER);\r\n\t\t//pos = Manhattan.processPositions(this.start, this.end, pos, this.startNormal.x!=0);\r\n\t\tlet pos = Manhattan.findPositions(this.start, this.end, this.startNormal, this.endNormal, this.MIN_BUFFER);\r\n\t\tif (this.autoRoute) {\r\n\t\t\tthis._mergeSegments(pos);\r\n\t\t\tvar boxes = [], node, startBox, endBox;\r\n\t\t\tvar container = edge.source.getCommonAncestor(edge.target);\r\n\t\t\tvar childNodes = container.getDescendants();\r\n\t\t\tvar index = 0;\r\n\t\t\tfor (var i = 0; i < childNodes.length; i++) {\r\n\t\t\t\tnode = childNodes[i];\r\n\t\t\t\t// Do not include source or target ancestors in routing.\r\n\t\t\t\tif (node.excludeFromRouting(edge) || node.isAncestor(edge.source) || node.isAncestor(edge.target)) continue;\r\n\t\t\t\tif (node == edge.source)\r\n\t\t\t\tstartBox = index;\r\n\t\t\t\tif (node == edge.target)\r\n\t\t\t\tendBox = index;\r\n\t\t\t\tboxes.push(node.getBounds(document));\r\n\t\t\t\tindex++;\r\n\t\t\t}\r\n\t\t\tif (boxes.length > 1)\r\n\t\t\t\tthis.autoRoute(pos, container.getBounds(document), boxes, startBox, endBox);\r\n\t\t}\r\n\t\tthis._mergeSegments(pos);\r\n\t\treturn pos;\r\n\t}\r\n\r\n\t//New function for finding route\r\n\tstatic findPositions(start, end, startNormal, endNormal, buffer) {\r\n\t\tvar startBuffer = new Point(start.x + startNormal.x * buffer, start.y + startNormal.y * buffer);\r\n\t\tvar endBuffer = new Point(end.x + endNormal.x * buffer, end.y + endNormal.y * buffer);\r\n\t\tvar startBufferNormal, endBufferNormal;\r\n\t\tvar pts;\r\n\t\tif (startNormal.x != 0) {\r\n\t\t\tif ((endBuffer.x - startBuffer.x) / startNormal.x > 0) {\r\n\t\t\t\tstartBufferNormal = startNormal;\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tstartBufferNormal = new Point(0, (endBuffer.y >= startBuffer.y) ? 1 : -1);\r\n\t\t\t}\r\n\t\t}\r\n\t\telse {\r\n\t\t\tif ((endBuffer.y - startBuffer.y) / startNormal.y > 0) {\r\n\t\t\t\tstartBufferNormal = startNormal;\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tstartBufferNormal = new Point((endBuffer.x >= startBuffer.x) ? 1 : -1, 0);\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (endNormal.x != 0) {\r\n\t\t\tif ((startBuffer.x - endBuffer.x) / endNormal.x > 0) {\r\n\t\t\t\tendBufferNormal = endNormal;\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tendBufferNormal = new Point(0, (startBuffer.y >= endBuffer.y) ? 1 : -1);\r\n\t\t\t}\r\n\t\t}\r\n\t\telse {\r\n\t\t\tif ((startBuffer.y - endBuffer.y) / endNormal.y > 0) {\r\n\t\t\t\tendBufferNormal = endNormal;\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tendBufferNormal = new Point((startBuffer.x >= endBuffer.x) ? 1 : -1, 0);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (startBufferNormal.dotProduct(endBufferNormal) == 0) {\r\n\t\t\tvar middle = (startBufferNormal.x == 0) ? new Point(startBuffer.x, endBuffer.y) : new Point(endBuffer.x, startBuffer.y);\r\n\t\t\tpts = [start, startBuffer, middle, endBuffer, end];\r\n\t\t}\r\n\t\telse if (startBufferNormal.dotProduct(endBufferNormal) < 0) {\r\n\t\t\tif (startBufferNormal.x == 0) {\r\n\t\t\t\tpts = [start, startBuffer, new Point(startBuffer.x, (start.y + end.y) / 2), new Point(endBuffer.x, (start.y + end.y) / 2), endBuffer, end];\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tpts = [start, startBuffer, new Point((start.x + end.x) / 2, startBuffer.y), new Point((start.x + end.x) / 2, endBuffer.y), endBuffer, end];\r\n\t\t\t}\r\n\t\t}\r\n\t\telse {\r\n\t\t\tpts = [start, startBuffer, new Point(startBuffer.x + startBufferNormal.x * buffer, startBuffer.y + startBufferNormal.y * buffer), new Point(endBuffer.x + endBufferNormal.x * buffer, endBuffer.y + endBufferNormal.y * buffer), endBuffer, end];\r\n\t\t}\r\n\r\n\t\tvar prunePts = [];\r\n\t\tprunePts[0] = pts[0];\r\n\t\tfor (var i = 1; i < pts.length - 1; i++) {\r\n\t\t\tif ((pts[i].x == pts[i-1].x && pts[i].x == pts[i+1].x) || (pts[i].y == pts[i-1].y && pts[i].y == pts[i+1].y)) {\r\n\t\t\t\tcontinue;\r\n\t\t\t}\r\n\t\t\tprunePts.push(pts[i]);\r\n\t\t}\r\n\t\tprunePts.push(pts[pts.length - 1]);\r\n\t\treturn prunePts;\r\n\t}\r\n\r\n\t/**\r\n\t * Make a route based on the start, end and startNormal and endNormal\r\n\t * None of the parameters can be null\r\n\t * TODO: This method could use some improvement...\r\n\t */\r\n\tstatic routeInternal(start, end, startNormal, endNormal, buffer) {\r\n\t\tvar direction = start.getDirection(end);\r\n\t\tvar average = start.getMidPoint(end);\r\n\t\tvar pos = [];\r\n\t\tvar startPositive = new Point(startNormal.x*startNormal.x, startNormal.y*startNormal.y);\r\n\t\tvar endPositive = new Point(endNormal.x*endNormal.x, endNormal.y*endNormal.y);\r\n\t\tvar horizontal = startNormal.x != 0;\r\n\t\tpos[0] = horizontal ? start.y : start.x;\r\n\r\n\t\thorizontal = !horizontal;\r\n\t\tvar i;\r\n\t\tif (startNormal.dotProduct(endNormal) == 0) {\r\n\t\t\tif ((startNormal.dotProduct(direction) >= 0)\r\n\t\t\t\t&& (endNormal.dotProduct(direction) <= 0)) {\r\n\t\t\t\t// 0\r\n\t\t\t} else {\r\n\t\t\t\t// 2\r\n\t\t\t\tif (startNormal.dotProduct(direction) < 0)\r\n\t\t\t\t\ti = startPositive.dotProduct(start.getTranslated(startNormal.getScaled(buffer)));\r\n\t\t\t\telse\r\n\t\t\t\t\ti = horizontal ? average.y : average.x;\r\n\r\n\t\t\t\tpos.push(i);\r\n\t\t\t\thorizontal = !horizontal;\r\n\r\n\t\t\t\tif (endNormal.dotProduct(direction) > 0)\r\n\t\t\t\t\ti = endPositive.dotProduct(end.getTranslated(endNormal.getScaled(buffer)));\r\n\t\t\t\telse\r\n\t\t\t\t\ti = horizontal ? average.y : average.x;\r\n\r\n\t\t\t\tpos.push(i);\r\n\t\t\t\thorizontal = !horizontal;\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tif (startNormal.dotProduct(endNormal) > 0) {\r\n\t\t\t\t//1\r\n\t\t\t\tif (startNormal.dotProduct(direction) >= 0)\r\n\t\t\t\t\ti = startPositive.dotProduct(start.getTranslated(startNormal.getScaled(buffer)));\r\n\t\t\t\telse\r\n\t\t\t\t\ti = endPositive.dotProduct(end.getTranslated(endNormal.getScaled(buffer)));\r\n\t\t\t\tpos.push(i);\r\n\t\t\t\thorizontal = !horizontal;\r\n\t\t\t} else {\r\n\t\t\t\t//3 or 1\r\n\t\t\t\tif (startNormal.dotProduct(direction) < 0) {\r\n\t\t\t\t\ti = startPositive.dotProduct(start.getTranslated(startNormal.getScaled(buffer)));\r\n\t\t\t\t\tpos.push(i);\r\n\t\t\t\t\thorizontal = !horizontal;\r\n\t\t\t\t}\r\n\r\n\t\t\t\ti = horizontal ? average.y : average.x;\r\n\t\t\t\tpos.push(i);\r\n\t\t\t\thorizontal = !horizontal;\r\n\r\n\t\t\t\tif (startNormal.dotProduct(direction) < 0) {\r\n\t\t\t\t\ti = endPositive.dotProduct(end.getTranslated(endNormal.getScaled(buffer)));\r\n\t\t\t\t\tpos.push(i);\r\n\t\t\t\t\thorizontal = !horizontal;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tpos.push(horizontal ? end.y : end.x);\r\n\r\n\t\treturn pos;\r\n\t}\r\n\r\n\t// Process the positions.\r\n\tstatic processPositions(start, end, positions, horizontal) {\r\n\t\tvar pos = [];\r\n\t\tpos[0] = horizontal ? start.x : start.y;\r\n\t\tvar i;\r\n\t\tfor (i = 0; i < positions.length; i++) {\r\n\t\t\tpos[i + 1] = positions[i];\r\n\t\t}\r\n\t\tpos.push((horizontal == (positions.length % 2 == 1)) ? end.x : end.y);\r\n\r\n\t\tvar pts = [];\r\n\t\tpts[0] = start;\r\n\t\tvar p;\r\n\t\tvar current, prev;\r\n\t\tfor (i = 2; i < pos.length - 1; i++) {\r\n\t\t\thorizontal = !horizontal;\r\n\t\t\tprev = pos[i - 1];\r\n\t\t\tcurrent = pos[i];\r\n\t\t\tp = horizontal ? new Point(prev, current) : new Point(current, prev);\r\n\t\t\tpts.push(p);\r\n\t\t}\r\n\t\tpts.push(end);\r\n\t\treturn pts;\r\n\t}\r\n\r\n\t/**\r\n\t * Automatically route the connection to avoid intersections with other vertices.\r\n\t */\r\n\tautoRoute(pts, container, boxes, startBox, endBox) {\r\n\t\tvar side, side2, d, box, intersect, j;\r\n\t\tvar channel, channel2, pt, dir;\r\n\r\n\t\tvar startPadding = 0, endPadding;\r\n\t\t// first get the start and end channel\r\n\t\tbox = boxes[endBox];\r\n\t\tpt = pts[pts.length - 2];\r\n\t\tif (pt.y < box.y)\r\n\t\t\tside = 1;\r\n\t\telse if (pt.y > box.y + box.height)\r\n\t\t\tside = 3;\r\n\t\telse if (pt.x < box.x)\r\n\t\t\tside = 0;\r\n\t\telse\r\n\t\t\tside = 2;\r\n\t\tchannel = _getChannel(container, endBox, boxes, side);\r\n\t\tendPadding = channel.horizontal ? (channel.right - channel.left)/2 : (channel.bottom - channel.top)/2;\r\n\r\n\t\tfor (var i = 0; i < pts.length - 1; i++) {\r\n\t\t\tif (pts[i+1].x == pts[i].x && pts[i+1].y == pts[i].y) continue;\r\n\t\t\tintersect = _getFirstIntersection(pts, i, boxes, startBox, endBox);\r\n\t\t\tif (!intersect) continue;\r\n\t\t\tj = intersect[0];\r\n\t\t\tside = intersect[1];\r\n\t\t\tbox = boxes[j];\r\n\t\t\tchannel = _getChannel(container, j, boxes, side);\r\n\t\t\tswitch(side) {\r\n\t\t\t\tcase 0:\r\n\t\t\t\tcase 2:\r\n\t\t\t\t\tpt = new Point((channel.right + channel.left)/2, pts[i].y);\r\n\t\t\t\t\tdir = _getRouteTendency(pts, i, pt, box, side);\r\n\t\t\t\t\tside2 = dir < 0 ? 1 : 3;\r\n\t\t\t\t\tchannel2 = _getChannel(container, j, boxes, side2);\r\n\t\t\t\t\t// if the previous point is in the channel2, use that point instead of center of the channel.\r\n\t\t\t\t\tif (i > 1 && (pts[i-2].y == pts[i-1].y) && (pts[i-1].y > channel2.top && pts[i-1].y < channel2.bottom))\r\n\t\t\t\t\t\td = pts[i-1].y - pt.y;\r\n\t\t\t\t\telse if (i < pts.length - 3 && (pts[i+2].y == pts[i+3].y) && (pts[i+2].y > channel2.top && pts[i+2].y < channel2.bottom))\r\n\t\t\t\t\t\td = pts[i+2].y - pt.y;\r\n\t\t\t\t\telse\r\n\t\t\t\t\t\td = (channel2.bottom + channel2.top)/2 - pt.y;\r\n\t\t\t\t\t// check if we need this pt.\r\n\t\t\t\t\tif ((side == 0 && pt.x <= pts[i].x) || (side == 2 && pt.x >= pts[i].x))\r\n\t\t\t\t\t\tpt = null;\r\n\t\t\t\t\telse if (i > 0) {\r\n\t\t\t\t\t\t// see if we can push the line out to where we started.\r\n\t\t\t\t\t\tif (!_hasIntersection(\r\n\t\t\t\t\t\t\t\t[new Point(pts[i].x, pts[i].y), new Point(pts[i].x, pts[i].y + d), new Point(pt.x, pt.y + d)],\r\n\t\t\t\t\t\t\t\tboxes))\r\n\t\t\t\t\t\t\tpt = null;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 1:\r\n\t\t\t\tcase 3:\r\n\t\t\t\t\tpt = new Point(pts[i].x, (channel.bottom + channel.top)/2);\r\n\t\t\t\t\tdir = _getRouteTendency(pts, i, pt, box, side);\r\n\t\t\t\t\tside2 = dir < 0 ? 0 : 2;\r\n\t\t\t\t\tchannel2 = _getChannel(container, j, boxes, side2);\r\n\t\t\t\t\t// if the previous point is in the channel2, use that point instead of center of the channel.\r\n\t\t\t\t\tif (i > 1 && (pts[i-2].x == pts[i-1].x) && (pts[i-1].x > channel2.left && pts[i-1].x < channel2.right))\r\n\t\t\t\t\t\td = pts[i-1].x - pt.x;\r\n\t\t\t\t\telse if (i < pts.length - 3 && (pts[i+2].x == pts[i+3].x) && (pts[i+2].x > channel2.left && pts[i+2].x < channel2.right))\r\n\t\t\t\t\t\td = pts[i+2].x - pt.x;\r\n\t\t\t\t\telse\r\n\t\t\t\t\t\td = (channel2.right + channel2.left)/2 - pt.x;\r\n\t\t\t\t\t// check if we need this pt.\r\n\t\t\t\t\tif ((side == 1 && pt.y <= pts[i].y) || (side == 3 && pt.y >= pts[i].y))\r\n\t\t\t\t\t\tpt = null;\r\n\t\t\t\t\telse if (i > 0) {\r\n\t\t\t\t\t\t// see if we can push the line out to where we started.\r\n\t\t\t\t\t\tif (!_hasIntersection(\r\n\t\t\t\t\t\t\t\t[new Point(pts[i].x, pts[i].y), new Point(pts[i].x + d, pts[i].y), new Point(pt.x + d, pt.y)],\r\n\t\t\t\t\t\t\t\tboxes))\r\n\t\t\t\t\t\t\tpt = null;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 4:\r\n\t\t\t\t\tcontinue;\r\n\t\t\t}\r\n\t\t\t// max points.\r\n\t\t\tif (i > 20) return;\r\n\t\t\tif (pt && (pt.x != pts[i].x || pt.y != pts[i].y)) {\r\n\t\t\t\tpts.splice(i+1, 0, pt);\r\n\t\t\t\t_moveSegment(pts, i+1, d, startPadding, endPadding);\r\n\t\t\t\ti++;\r\n\t\t\t} else\r\n\t\t\t\t_moveSegment(pts, i, d, startPadding, endPadding);\r\n\t\t}\r\n\t}\r\n\r\n\t_hasIntersection(pts, boxes) {\r\n\t\tfor (var i = 0; i < pts.length - 1; i++) {\r\n\t\t\tfor (var j = 0; j < boxes.length; j++) {\r\n\t\t\t\tif (boxes[j].detectIntersection(pts[i], pts[i+1]) >= 0)\r\n\t\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn false;\r\n\t}\r\n\r\n\t_getFirstIntersection(pts, i, boxes, startBox, endBox) {\r\n\t\tvar box, side, savedIndex = null, savedSide = null;\r\n\t\tfor (var j = 0; j < boxes.length; j++) {\r\n\t\t\tif ((i == 0 && j == startBox) || (i == pts.length - 2 && j == endBox))\r\n\t\t\t\tcontinue;\r\n\t\t\tbox = boxes[j];\r\n\t\t\tside = box.detectIntersection(pts[i], pts[i+1]);\r\n\t\t\tif (side >= 0) {\r\n\t\t\t\tif (savedIndex == null) {\r\n\t\t\t\t\tsavedIndex = j;\r\n\t\t\t\t\tsavedSide = side;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tif (boxes[savedIndex].distance(pts[i]) > box.distance(pts[i])) {\r\n\t\t\t\t\t\tsavedIndex = j;\r\n\t\t\t\t\t\tsavedSide = side;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (savedIndex != null)\r\n\t\t\treturn [savedIndex, savedSide];\r\n\t\treturn null;\r\n\t}\r\n\r\n\t_getRouteTendency(pts, i, breakPt, box, side) {\r\n\t\tvar dir;\r\n\t\tvar p;\r\n\t\tswitch (side) {\r\n\t\t\tcase 0:\r\n\t\t\tcase 2:\r\n\t\t\t\tp = \"y\";\r\n\t\t\t\tbreak;\r\n\t\t\tcase 1:\r\n\t\t\tcase 3:\r\n\t\t\t\tp = \"x\";\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\t\t//first try the breakpt.\r\n\t\tdir = _getRouteDirection(breakPt, pts[pts.length - 1])[p];\r\n\t\tif (dir == 0) {\r\n\t\t\tdir = -_getRouteDirection(pts[0], pts[pts.length - 1])[p];\r\n\t\t\tif (dir == 0) {\r\n\t\t\t\tif (breakPt[p] < box.getCenter()[p])\r\n\t\t\t\t\tdir = -1;\r\n\t\t\t\telse\r\n\t\t\t\t\tdir = 1;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn dir;\r\n\t}\r\n\r\n\t_getRouteDirection(pt1, pt2) {\r\n\t\tif (pt1.x == pt2.x) {\r\n\t\t\tif (pt1.y < pt2.y) return Point.S;\r\n\t\t\treturn Point.N;\r\n\t\t} else if (pt1.y == pt2.y) {\r\n\t\t\tif (pt1.x < pt2.x) return Point.E;\r\n\t\t\treturn Point.W;\r\n\t\t} else if (pt1.x < pt2.x) {\r\n\t\t\tif (pt1.y < pt2.y) return Point.SE;\r\n\t\t\treturn Point.NE;\r\n\t\t} else {\r\n\t\t\tif (pt1.y < pt2.y) return Point.SW;\r\n\t\t\treturn Point.NW;\r\n\t\t}\r\n\t}\r\n\r\n\t_getChannel(container, index, boxes, side) {\r\n\t\tvar maxChannelWidth = this.maxChannelWidth;\r\n\t\tvar box1 = boxes[index], box2;\r\n\t\tvar pt, i;\r\n\t\tvar channel = {}, l, t, b, r;\r\n\t\tswitch (side) {\r\n\t\t\tcase 0:\r\n\t\t\t\tpt = box1.getLeft();\r\n\t\t\t\tchannel.right = pt.x;\r\n\t\t\t\tchannel.horizontal = false;\r\n\t\t\t\tfor (i = 0; i < boxes.length; i++) {\r\n\t\t\t\t\tif (i == index) continue;\r\n\t\t\t\t\tr = boxes[i].getRight().x;\r\n\t\t\t\t\tif (r >= pt.x) continue;\r\n\t\t\t\t\tif (!channel.left || channel.left < r)\r\n\t\t\t\t\t\tchannel.left = r;\r\n\t\t\t\t}\r\n\t\t\t\tif (!channel.left) {\r\n\t\t\t\t\tchannel.left = container.getLeft().x;\r\n\t\t\t\t\tif (channel.right - channel.left > maxChannelWidth)\r\n\t\t\t\t\t\tchannel.left = channel.right - maxChannelWidth;\r\n\t\t\t\t}\r\n\t\t\t\tfor (i = 0; i < boxes.length; i++) {\r\n\t\t\t\t\tif (i == index) continue;\r\n\t\t\t\t\tbox2 = boxes[i];\r\n\t\t\t\t\tb = box2.getBottom().y;\r\n\t\t\t\t\tt = box2.getTop().y;\r\n\t\t\t\t\tif (b < pt.y && (box2.getRight() > channel.left && box2.getLeft() < channel.right)) {\r\n\t\t\t\t\t\tif (!channel.top || channel.top < b)\r\n\t\t\t\t\t\t\tchannel.top = b;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (t > pt.y && (box2.getRight() > channel.left && box2.getLeft() < channel.right)) {\r\n\t\t\t\t\t\tif (!channel.bottom || channel.bottom > t)\r\n\t\t\t\t\t\t\tchannel.bottom = t;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tif (!channel.top) channel.top = container.getTop().y;\r\n\t\t\t\tif (!channel.bottom) channel.bottom = container.getBottom().y;\r\n\t\t\t\tbreak;\r\n\t\t\tcase 1:\r\n\t\t\t\tpt = box1.getTop();\r\n\t\t\t\tchannel.horizontal = true;\r\n\t\t\t\tchannel.bottom = pt.y;\r\n\t\t\t\tfor (i = 0; i < boxes.length; i++) {\r\n\t\t\t\t\tif (i == index) continue;\r\n\t\t\t\t\tb = boxes[i].getBottom().y;\r\n\t\t\t\t\tif (b >= pt.y) continue;\r\n\t\t\t\t\tif (!channel.top || channel.top < b)\r\n\t\t\t\t\t\tchannel.top = b;\r\n\t\t\t\t}\r\n\t\t\t\tif (!channel.top) {\r\n\t\t\t\t\tchannel.top = container.getTop().y;\r\n\t\t\t\t\tif (channel.bottom - channel.top > maxChannelWidth)\r\n\t\t\t\t\t\tchannel.top = channel.bottom - maxChannelWidth;\r\n\t\t\t\t}\r\n\t\t\t\tfor (i = 0; i < boxes.length; i++) {\r\n\t\t\t\t\tif (i == index) continue;\r\n\t\t\t\t\tbox2 = boxes[i];\r\n\t\t\t\t\tl = box2.getLeft().x;\r\n\t\t\t\t\tr = box2.getRight().x;\r\n\t\t\t\t\tif (r < pt.x && (box2.getBottom() > channel.top && box2.getTop() < channel.bottom)) {\r\n\t\t\t\t\t\tif (!channel.left || channel.left < r)\r\n\t\t\t\t\t\t\tchannel.left = r;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (l > pt.x && (box2.getBottom() > channel.top && box2.getTop() < channel.bottom)) {\r\n\t\t\t\t\t\tif (!channel.right || channel.right > l)\r\n\t\t\t\t\t\t\tchannel.right = l;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tif (!channel.left) channel.left = container.getLeft().x;\r\n\t\t\t\tif (!channel.right) channel.right = container.getRight().x;\r\n\r\n\t\t\t\tbreak;\r\n\t\t\tcase 2:\r\n\t\t\t\tpt = box1.getRight();\r\n\t\t\t\tchannel.horizontal = false;\r\n\t\t\t\tchannel.left = pt.x;\r\n\t\t\t\tfor (i = 0; i < boxes.length; i++) {\r\n\t\t\t\t\tif (i == index) continue;\r\n\t\t\t\t\tl = boxes[i].getLeft().x;\r\n\t\t\t\t\tif (l <= pt.x) continue;\r\n\t\t\t\t\tif (!channel.right || channel.right > l)\r\n\t\t\t\t\t\tchannel.right = l;\r\n\t\t\t\t}\r\n\t\t\t\tif (!channel.right) {\r\n\t\t\t\t\tchannel.right = container.getRight().x;\r\n\t\t\t\t\tif (channel.right - channel.left > maxChannelWidth)\r\n\t\t\t\t\t\tchannel.right = channel.left + maxChannelWidth;\r\n\t\t\t\t}\r\n\t\t\t\tfor (i = 0; i < boxes.length; i++) {\r\n\t\t\t\t\tif (i == index) continue;\r\n\t\t\t\t\tbox2 = boxes[i];\r\n\t\t\t\t\tb = box2.getBottom().y;\r\n\t\t\t\t\tt = box2.getTop().y;\r\n\t\t\t\t\tif (b < pt.y && (box2.getRight() > channel.left && box2.getLeft() < channel.right)) {\r\n\t\t\t\t\t\tif (!channel.top || channel.top < b)\r\n\t\t\t\t\t\t\tchannel.top = b;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (t > pt.y && (box2.getRight() > channel.left && box2.getLeft() < channel.right)) {\r\n\t\t\t\t\t\tif (!channel.bottom || channel.bottom > t)\r\n\t\t\t\t\t\t\tchannel.bottom = t;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tif (!channel.top) channel.top = container.getTop().y;\r\n\t\t\t\tif (!channel.bottom) channel.bottom = container.getBottom().y;\r\n\t\t\t\tbreak;\r\n\t\t\tcase 3:\r\n\t\t\t\tpt = box1.getBottom();\r\n\t\t\t\tchannel.horizontal = true;\r\n\t\t\t\tchannel.top = pt.y;\r\n\t\t\t\tfor (i = 0; i < boxes.length; i++) {\r\n\t\t\t\t\tif (i == index) continue;\r\n\t\t\t\t\tbox2 = boxes[i];\r\n\t\t\t\t\tif (box2.getTop().y <= pt.y) continue;\r\n\t\t\t\t\tif (!channel.bottom || channel.bottom > box2.getTop().y)\r\n\t\t\t\t\t\tchannel.bottom = box2.getTop().y;\r\n\t\t\t\t}\r\n\t\t\t\tif (!channel.bottom) {\r\n\t\t\t\t\tchannel.bottom = container.getBottom().y;\r\n\t\t\t\t\tif (channel.bottom - channel.top > maxChannelWidth)\r\n\t\t\t\t\t\tchannel.bottom = channel.top + maxChannelWidth;\r\n\t\t\t\t}\r\n\t\t\t\tfor (i = 0; i < boxes.length; i++) {\r\n\t\t\t\t\tif (i == index) continue;\r\n\t\t\t\t\tbox2 = boxes[i];\r\n\t\t\t\t\tl = box2.getLeft().x;\r\n\t\t\t\t\tr = box2.getRight().x;\r\n\t\t\t\t\tif (r < pt.x && (box2.getBottom() > channel.top && box2.getTop() < channel.bottom)) {\r\n\t\t\t\t\t\tif (!channel.left || channel.left < r)\r\n\t\t\t\t\t\t\tchannel.left = r;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (l > pt.x && (box2.getBottom() > channel.top && box2.getTop() < channel.bottom)) {\r\n\t\t\t\t\t\tif (!channel.right || channel.right > l)\r\n\t\t\t\t\t\t\tchannel.right = l;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tif (!channel.left) channel.left = container.getLeft().x;\r\n\t\t\t\tif (!channel.right) channel.right = container.getRight().x;\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\t\treturn channel;\r\n\t}\r\n\r\n\t/**\r\n\t * Move a line segment by a specified distance.\r\n\t *\r\n\t * @param pts the list of points.\r\n\t * @param i the index of the segment.\r\n\t * @param d the distance to move.\r\n\t * @param startPadding\r\n\t * @param endPadding\r\n\t */\r\n\t_moveSegment(pts, i, d, startPadding, endPadding) {\r\n\t\t// first check if we need to add new line segments.\r\n\t\tvar dir, l, pt;\r\n\t\tif (i == 0) {\r\n\t\t\t// we need to break off the segment, since we can't change the starting point.\r\n\t\t\tdir = pts[0].getDirection(pts[1]);\r\n\t\t\tif (!startPadding)\r\n\t\t\t\tstartPadding = this.MIN_BUFFER;\r\n\t\t\tl = Math.min(startPadding, pts[0].distance(pts[1])/2);\r\n\t\t\tpt = pts[0].getTranslated(dir.scale(l));\r\n\t\t\tpts.splice(1, 0, pt);\r\n\t\t\t_moveSegment(pts, i+1, d);\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tif (i == pts.length - 2) {\r\n\t\t\t// we need to break off the segment, since we can't change the end point.\r\n\t\t\tdir = pts[pts.length-1].getDirection(pts[pts.length-2]);\r\n\t\t\tif (!endPadding)\r\n\t\t\t\tendPadding = this.MIN_BUFFER;\r\n\t\t\tl = Math.min(endPadding, pts[pts.length-1].distance(pts[pts.length-2])/2);\r\n\t\t\tpt = pts[pts.length - 1].getTranslated(dir.scale(l));\r\n\t\t\tpts.splice(pts.length - 1, 0, pt);\r\n\t\t\t_moveSegment(pts, i, d);\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tif (pts[i].y == pts[i+1].y) {\r\n\t\t\tif (i > 0 && pts[i - 1].y == pts[i].y) {\r\n\t\t\t\tpts.splice(i + 1, 0, pts[i].clone());\r\n\t\t\t\ti++;\r\n\t\t\t}\r\n\t\t\tif (i < pts.length - 2 && pts[i+1].y == pts[i+2].y)\r\n\t\t\t\tpts.splice(i + 1, 0, pts[i+1].clone());\r\n\t\t\tpts[i].y += d;\r\n\t\t\tpts[i+1].y += d;\r\n\t\t} else {\r\n\t\t\tif (i > 0 && pts[i - 1].x == pts[i].x) {\r\n\t\t\t\tpts.splice(i + 1, 0, pts[i].clone());\r\n\t\t\t\ti++;\r\n\t\t\t}\r\n\t\t\tif (i < pts.length - 2 && pts[i+1].x == pts[i+2].x)\r\n\t\t\t\tpts.splice(i + 1, 0, pts[i+1].clone());\r\n\t\t\tpts[i].x += d;\r\n\t\t\tpts[i+1].x += d;\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * This method will merge the redundant segments.\r\n\t */\r\n\t_mergeSegments(pts) {\r\n\t\tvar h1 = pts[pts.length-1].y == pts[pts.length-2].y;\r\n\t\tvar h2;\r\n\t\tfor (var i = pts.length - 2; i >= 1; i--) {\r\n\t\t\th2 = pts[i].y == pts[i-1].y;\r\n\t\t\tif (h2 == h1 || (pts[i].equals(pts[i-1])))\r\n\t\t\t\tpts.splice(i, 1);\r\n\t\t\telse\r\n\t\t\t\th1 = !h1;\r\n\t\t}\r\n\t}\r\n}\r\n\r\nlinkTypes['direct'] = DirectLink;\r\nlinkTypes['bezier'] = BezierLink;\r\nlinkTypes['entityRelations'] = EntityRelations;\r\nlinkTypes['manhattan'] = Manhattan;\r\n\r\nexport default Link;\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/geometry/Link.js\n **/","/*!\n  * Bean - copyright (c) Jacob Thornton 2011-2012\n  * https://github.com/fat/bean\n  * MIT license\n  */\n(function (name, context, definition) {\n  if (typeof module != 'undefined' && module.exports) module.exports = definition()\n  else if (typeof define == 'function' && define.amd) define(definition)\n  else context[name] = definition()\n})('bean', this, function (name, context) {\n  name    = name    || 'bean'\n  context = context || this\n\n  var win            = window\n    , old            = context[name]\n    , namespaceRegex = /[^\\.]*(?=\\..*)\\.|.*/\n    , nameRegex      = /\\..*/\n    , addEvent       = 'addEventListener'\n    , removeEvent    = 'removeEventListener'\n    , doc            = document || {}\n    , root           = doc.documentElement || {}\n    , W3C_MODEL      = root[addEvent]\n    , eventSupport   = W3C_MODEL ? addEvent : 'attachEvent'\n    , ONE            = {} // singleton for quick matching making add() do one()\n\n    , slice          = Array.prototype.slice\n    , str2arr        = function (s, d) { return s.split(d || ' ') }\n    , isString       = function (o) { return typeof o == 'string' }\n    , isFunction     = function (o) { return typeof o == 'function' }\n\n      // events that we consider to be 'native', anything not in this list will\n      // be treated as a custom event\n    , standardNativeEvents =\n        'click dblclick mouseup mousedown contextmenu '                  + // mouse buttons\n        'mousewheel mousemultiwheel DOMMouseScroll '                     + // mouse wheel\n        'mouseover mouseout mousemove selectstart selectend '            + // mouse movement\n        'keydown keypress keyup '                                        + // keyboard\n        'orientationchange '                                             + // mobile\n        'focus blur change reset select submit '                         + // form elements\n        'load unload beforeunload resize move DOMContentLoaded '         + // window\n        'readystatechange message '                                      + // window\n        'error abort scroll '                                              // misc\n      // element.fireEvent('onXYZ'... is not forgiving if we try to fire an event\n      // that doesn't actually exist, so make sure we only do these on newer browsers\n    , w3cNativeEvents =\n        'show '                                                          + // mouse buttons\n        'input invalid '                                                 + // form elements\n        'touchstart touchmove touchend touchcancel '                     + // touch\n        'gesturestart gesturechange gestureend '                         + // gesture\n        'textinput '                                                     + // TextEvent\n        'readystatechange pageshow pagehide popstate '                   + // window\n        'hashchange offline online '                                     + // window\n        'afterprint beforeprint '                                        + // printing\n        'dragstart dragenter dragover dragleave drag drop dragend '      + // dnd\n        'loadstart progress suspend emptied stalled loadmetadata '       + // media\n        'loadeddata canplay canplaythrough playing waiting seeking '     + // media\n        'seeked ended durationchange timeupdate play pause ratechange '  + // media\n        'volumechange cuechange '                                        + // media\n        'checking noupdate downloading cached updateready obsolete '       // appcache\n\n      // convert to a hash for quick lookups\n    , nativeEvents = (function (hash, events, i) {\n        for (i = 0; i < events.length; i++) events[i] && (hash[events[i]] = 1)\n        return hash\n      }({}, str2arr(standardNativeEvents + (W3C_MODEL ? w3cNativeEvents : ''))))\n\n      // custom events are events that we *fake*, they are not provided natively but\n      // we can use native events to generate them\n    , customEvents = (function () {\n        var isAncestor = 'compareDocumentPosition' in root\n              ? function (element, container) {\n                  return container.compareDocumentPosition && (container.compareDocumentPosition(element) & 16) === 16\n                }\n              : 'contains' in root\n                ? function (element, container) {\n                    container = container.nodeType === 9 || container === window ? root : container\n                    return container !== element && container.contains(element)\n                  }\n                : function (element, container) {\n                    while (element = element.parentNode) if (element === container) return 1\n                    return 0\n                  }\n          , check = function (event) {\n              var related = event.relatedTarget\n              return !related\n                ? related == null\n                : (related !== this && related.prefix !== 'xul' && !/document/.test(this.toString())\n                    && !isAncestor(related, this))\n            }\n\n        return {\n            mouseenter: { base: 'mouseover', condition: check }\n          , mouseleave: { base: 'mouseout', condition: check }\n          , mousewheel: { base: /Firefox/.test(navigator.userAgent) ? 'DOMMouseScroll' : 'mousewheel' }\n        }\n      }())\n\n      // we provide a consistent Event object across browsers by taking the actual DOM\n      // event object and generating a new one from its properties.\n    , Event = (function () {\n            // a whitelist of properties (for different event types) tells us what to check for and copy\n        var commonProps  = str2arr('altKey attrChange attrName bubbles cancelable ctrlKey currentTarget ' +\n              'detail eventPhase getModifierState isTrusted metaKey relatedNode relatedTarget shiftKey '  +\n              'srcElement target timeStamp type view which propertyName')\n          , mouseProps   = commonProps.concat(str2arr('button buttons clientX clientY dataTransfer '      +\n              'fromElement offsetX offsetY pageX pageY screenX screenY toElement'))\n          , mouseWheelProps = mouseProps.concat(str2arr('wheelDelta wheelDeltaX wheelDeltaY wheelDeltaZ ' +\n              'axis')) // 'axis' is FF specific\n          , keyProps     = commonProps.concat(str2arr('char charCode key keyCode keyIdentifier '          +\n              'keyLocation location'))\n          , textProps    = commonProps.concat(str2arr('data'))\n          , touchProps   = commonProps.concat(str2arr('touches targetTouches changedTouches scale rotation'))\n          , messageProps = commonProps.concat(str2arr('data origin source'))\n          , stateProps   = commonProps.concat(str2arr('state'))\n          , overOutRegex = /over|out/\n            // some event types need special handling and some need special properties, do that all here\n          , typeFixers   = [\n                { // key events\n                    reg: /key/i\n                  , fix: function (event, newEvent) {\n                      newEvent.keyCode = event.keyCode || event.which\n                      return keyProps\n                    }\n                }\n              , { // mouse events\n                    reg: /click|mouse(?!(.*wheel|scroll))|menu|drag|drop/i\n                  , fix: function (event, newEvent, type) {\n                      newEvent.rightClick = event.which === 3 || event.button === 2\n                      newEvent.pos = { x: 0, y: 0 }\n                      if (event.pageX || event.pageY) {\n                        newEvent.clientX = event.pageX\n                        newEvent.clientY = event.pageY\n                      } else if (event.clientX || event.clientY) {\n                        newEvent.clientX = event.clientX + doc.body.scrollLeft + root.scrollLeft\n                        newEvent.clientY = event.clientY + doc.body.scrollTop + root.scrollTop\n                      }\n                      if (overOutRegex.test(type)) {\n                        newEvent.relatedTarget = event.relatedTarget\n                          || event[(type == 'mouseover' ? 'from' : 'to') + 'Element']\n                      }\n                      return mouseProps\n                    }\n                }\n              , { // mouse wheel events\n                    reg: /mouse.*(wheel|scroll)/i\n                  , fix: function () { return mouseWheelProps }\n                }\n              , { // TextEvent\n                    reg: /^text/i\n                  , fix: function () { return textProps }\n                }\n              , { // touch and gesture events\n                    reg: /^touch|^gesture/i\n                  , fix: function () { return touchProps }\n                }\n              , { // message events\n                    reg: /^message$/i\n                  , fix: function () { return messageProps }\n                }\n              , { // popstate events\n                    reg: /^popstate$/i\n                  , fix: function () { return stateProps }\n                }\n              , { // everything else\n                    reg: /.*/\n                  , fix: function () { return commonProps }\n                }\n            ]\n          , typeFixerMap = {} // used to map event types to fixer functions (above), a basic cache mechanism\n\n          , Event = function (event, element, isNative) {\n              if (!arguments.length) return\n              event = event || ((element.ownerDocument || element.document || element).parentWindow || win).event\n              this.originalEvent = event\n              this.isNative       = isNative\n              this.isBean         = true\n\n              if (!event) return\n\n              var type   = event.type\n                , target = event.target || event.srcElement\n                , i, l, p, props, fixer\n\n              this.target = target && target.nodeType === 3 ? target.parentNode : target\n\n              if (isNative) { // we only need basic augmentation on custom events, the rest expensive & pointless\n                fixer = typeFixerMap[type]\n                if (!fixer) { // haven't encountered this event type before, map a fixer function for it\n                  for (i = 0, l = typeFixers.length; i < l; i++) {\n                    if (typeFixers[i].reg.test(type)) { // guaranteed to match at least one, last is .*\n                      typeFixerMap[type] = fixer = typeFixers[i].fix\n                      break\n                    }\n                  }\n                }\n\n                props = fixer(event, this, type)\n                for (i = props.length; i--;) {\n                  if (!((p = props[i]) in this) && p in event) this[p] = event[p]\n                }\n              }\n            }\n\n        // preventDefault() and stopPropagation() are a consistent interface to those functions\n        // on the DOM, stop() is an alias for both of them together\n        Event.prototype.preventDefault = function () {\n          if (this.originalEvent.preventDefault) this.originalEvent.preventDefault()\n          else this.originalEvent.returnValue = false\n        }\n        Event.prototype.stopPropagation = function () {\n          if (this.originalEvent.stopPropagation) this.originalEvent.stopPropagation()\n          else this.originalEvent.cancelBubble = true\n        }\n        Event.prototype.stop = function () {\n          this.preventDefault()\n          this.stopPropagation()\n          this.stopped = true\n        }\n        // stopImmediatePropagation() has to be handled internally because we manage the event list for\n        // each element\n        // note that originalElement may be a Bean#Event object in some situations\n        Event.prototype.stopImmediatePropagation = function () {\n          if (this.originalEvent.stopImmediatePropagation) this.originalEvent.stopImmediatePropagation()\n          this.isImmediatePropagationStopped = function () { return true }\n        }\n        Event.prototype.isImmediatePropagationStopped = function () {\n          return this.originalEvent.isImmediatePropagationStopped && this.originalEvent.isImmediatePropagationStopped()\n        }\n        Event.prototype.clone = function (currentTarget) {\n          //TODO: this is ripe for optimisation, new events are *expensive*\n          // improving this will speed up delegated events\n          var ne = new Event(this, this.element, this.isNative)\n          ne.currentTarget = currentTarget\n          return ne\n        }\n\n        return Event\n      }())\n\n      // if we're in old IE we can't do onpropertychange on doc or win so we use doc.documentElement for both\n    , targetElement = function (element, isNative) {\n        return !W3C_MODEL && !isNative && (element === doc || element === win) ? root : element\n      }\n\n      /**\n        * Bean maintains an internal registry for event listeners. We don't touch elements, objects\n        * or functions to identify them, instead we store everything in the registry.\n        * Each event listener has a RegEntry object, we have one 'registry' for the whole instance.\n        */\n    , RegEntry = (function () {\n        // each handler is wrapped so we can handle delegation and custom events\n        var wrappedHandler = function (element, fn, condition, args) {\n            var call = function (event, eargs) {\n                  return fn.apply(element, args ? slice.call(eargs, event ? 0 : 1).concat(args) : eargs)\n                }\n              , findTarget = function (event, eventElement) {\n                  return fn.__beanDel ? fn.__beanDel.ft(event.target, element) : eventElement\n                }\n              , handler = condition\n                  ? function (event) {\n                      var target = findTarget(event, this) // deleated event\n                      if (condition.apply(target, arguments)) {\n                        if (event) event.currentTarget = target\n                        return call(event, arguments)\n                      }\n                    }\n                  : function (event) {\n                      if (fn.__beanDel) event = event.clone(findTarget(event)) // delegated event, fix the fix\n                      return call(event, arguments)\n                    }\n            handler.__beanDel = fn.__beanDel\n            return handler\n          }\n\n        , RegEntry = function (element, type, handler, original, namespaces, args, root) {\n            var customType     = customEvents[type]\n              , isNative\n\n            if (type == 'unload') {\n              // self clean-up\n              handler = once(removeListener, element, type, handler, original)\n            }\n\n            if (customType) {\n              if (customType.condition) {\n                handler = wrappedHandler(element, handler, customType.condition, args)\n              }\n              type = customType.base || type\n            }\n\n            this.isNative      = isNative = nativeEvents[type] && !!element[eventSupport]\n            this.customType    = !W3C_MODEL && !isNative && type\n            this.element       = element\n            this.type          = type\n            this.original      = original\n            this.namespaces    = namespaces\n            this.eventType     = W3C_MODEL || isNative ? type : 'propertychange'\n            this.target        = targetElement(element, isNative)\n            this[eventSupport] = !!this.target[eventSupport]\n            this.root          = root\n            this.handler       = wrappedHandler(element, handler, null, args)\n          }\n\n        // given a list of namespaces, is our entry in any of them?\n        RegEntry.prototype.inNamespaces = function (checkNamespaces) {\n          var i, j, c = 0\n          if (!checkNamespaces) return true\n          if (!this.namespaces) return false\n          for (i = checkNamespaces.length; i--;) {\n            for (j = this.namespaces.length; j--;) {\n              if (checkNamespaces[i] == this.namespaces[j]) c++\n            }\n          }\n          return checkNamespaces.length === c\n        }\n\n        // match by element, original fn (opt), handler fn (opt)\n        RegEntry.prototype.matches = function (checkElement, checkOriginal, checkHandler) {\n          return this.element === checkElement &&\n            (!checkOriginal || this.original === checkOriginal) &&\n            (!checkHandler || this.handler === checkHandler)\n        }\n\n        return RegEntry\n      }())\n\n    , registry = (function () {\n        // our map stores arrays by event type, just because it's better than storing\n        // everything in a single array.\n        // uses '$' as a prefix for the keys for safety and 'r' as a special prefix for\n        // rootListeners so we can look them up fast\n        var map = {}\n\n          // generic functional search of our registry for matching listeners,\n          // `fn` returns false to break out of the loop\n          , forAll = function (element, type, original, handler, root, fn) {\n              var pfx = root ? 'r' : '$'\n              if (!type || type == '*') {\n                // search the whole registry\n                for (var t in map) {\n                  if (t.charAt(0) == pfx) {\n                    forAll(element, t.substr(1), original, handler, root, fn)\n                  }\n                }\n              } else {\n                var i = 0, l, list = map[pfx + type], all = element == '*'\n                if (!list) return\n                for (l = list.length; i < l; i++) {\n                  if ((all || list[i].matches(element, original, handler)) && !fn(list[i], list, i, type)) return\n                }\n              }\n            }\n\n          , has = function (element, type, original, root) {\n              // we're not using forAll here simply because it's a bit slower and this\n              // needs to be fast\n              var i, list = map[(root ? 'r' : '$') + type]\n              if (list) {\n                for (i = list.length; i--;) {\n                  if (!list[i].root && list[i].matches(element, original, null)) return true\n                }\n              }\n              return false\n            }\n\n          , get = function (element, type, original, root) {\n              var entries = []\n              forAll(element, type, original, null, root, function (entry) {\n                return entries.push(entry)\n              })\n              return entries\n            }\n\n          , put = function (entry) {\n              var has = !entry.root && !this.has(entry.element, entry.type, null, false)\n                , key = (entry.root ? 'r' : '$') + entry.type\n              ;(map[key] || (map[key] = [])).push(entry)\n              return has\n            }\n\n          , del = function (entry) {\n              forAll(entry.element, entry.type, null, entry.handler, entry.root, function (entry, list, i) {\n                list.splice(i, 1)\n                entry.removed = true\n                if (list.length === 0) delete map[(entry.root ? 'r' : '$') + entry.type]\n                return false\n              })\n            }\n\n            // dump all entries, used for onunload\n          , entries = function () {\n              var t, entries = []\n              for (t in map) {\n                if (t.charAt(0) == '$') entries = entries.concat(map[t])\n              }\n              return entries\n            }\n\n        return { has: has, get: get, put: put, del: del, entries: entries }\n      }())\n\n      // we need a selector engine for delegated events, use querySelectorAll if it exists\n      // but for older browsers we need Qwery, Sizzle or similar\n    , selectorEngine\n    , setSelectorEngine = function (e) {\n        if (!arguments.length) {\n          selectorEngine = doc.querySelectorAll\n            ? function (s, r) {\n                return r.querySelectorAll(s)\n              }\n            : function () {\n                throw new Error('Bean: No selector engine installed') // eeek\n              }\n        } else {\n          selectorEngine = e\n        }\n      }\n\n      // we attach this listener to each DOM event that we need to listen to, only once\n      // per event type per DOM element\n    , rootListener = function (event, type) {\n        if (!W3C_MODEL && type && event && event.propertyName != '_on' + type) return\n\n        var listeners = registry.get(this, type || event.type, null, false)\n          , l = listeners.length\n          , i = 0\n\n        event = new Event(event, this, true)\n        if (type) event.type = type\n\n        // iterate through all handlers registered for this type, calling them unless they have\n        // been removed by a previous handler or stopImmediatePropagation() has been called\n        for (; i < l && !event.isImmediatePropagationStopped(); i++) {\n          if (!listeners[i].removed) listeners[i].handler.call(this, event)\n        }\n      }\n\n      // add and remove listeners to DOM elements\n    , listener = W3C_MODEL\n        ? function (element, type, add) {\n            // new browsers\n            element[add ? addEvent : removeEvent](type, rootListener, false)\n          }\n        : function (element, type, add, custom) {\n            // IE8 and below, use attachEvent/detachEvent and we have to piggy-back propertychange events\n            // to simulate event bubbling etc.\n            var entry\n            if (add) {\n              registry.put(entry = new RegEntry(\n                  element\n                , custom || type\n                , function (event) { // handler\n                    rootListener.call(element, event, custom)\n                  }\n                , rootListener\n                , null\n                , null\n                , true // is root\n              ))\n              if (custom && element['_on' + custom] == null) element['_on' + custom] = 0\n              entry.target.attachEvent('on' + entry.eventType, entry.handler)\n            } else {\n              entry = registry.get(element, custom || type, rootListener, true)[0]\n              if (entry) {\n                entry.target.detachEvent('on' + entry.eventType, entry.handler)\n                registry.del(entry)\n              }\n            }\n          }\n\n    , once = function (rm, element, type, fn, originalFn) {\n        // wrap the handler in a handler that does a remove as well\n        return function () {\n          fn.apply(this, arguments)\n          rm(element, type, originalFn)\n        }\n      }\n\n    , removeListener = function (element, orgType, handler, namespaces) {\n        var type     = orgType && orgType.replace(nameRegex, '')\n          , handlers = registry.get(element, type, null, false)\n          , removed  = {}\n          , i, l\n\n        for (i = 0, l = handlers.length; i < l; i++) {\n          if ((!handler || handlers[i].original === handler) && handlers[i].inNamespaces(namespaces)) {\n            // TODO: this is problematic, we have a registry.get() and registry.del() that\n            // both do registry searches so we waste cycles doing this. Needs to be rolled into\n            // a single registry.forAll(fn) that removes while finding, but the catch is that\n            // we'll be splicing the arrays that we're iterating over. Needs extra tests to\n            // make sure we don't screw it up. @rvagg\n            registry.del(handlers[i])\n            if (!removed[handlers[i].eventType] && handlers[i][eventSupport])\n              removed[handlers[i].eventType] = { t: handlers[i].eventType, c: handlers[i].type }\n          }\n        }\n        // check each type/element for removed listeners and remove the rootListener where it's no longer needed\n        for (i in removed) {\n          if (!registry.has(element, removed[i].t, null, false)) {\n            // last listener of this type, remove the rootListener\n            listener(element, removed[i].t, false, removed[i].c)\n          }\n        }\n      }\n\n      // set up a delegate helper using the given selector, wrap the handler function\n    , delegate = function (selector, fn) {\n        //TODO: findTarget (therefore $) is called twice, once for match and once for\n        // setting e.currentTarget, fix this so it's only needed once\n        var findTarget = function (target, root) {\n              var i, array = isString(selector) ? selectorEngine(selector, root) : selector\n              for (; target && target !== root; target = target.parentNode) {\n                for (i = array.length; i--;) {\n                  if (array[i] === target) return target\n                }\n              }\n            }\n          , handler = function (e) {\n              var match = findTarget(e.target, this)\n              if (match) fn.apply(match, arguments)\n            }\n\n        // __beanDel isn't pleasant but it's a private function, not exposed outside of Bean\n        handler.__beanDel = {\n            ft       : findTarget // attach it here for customEvents to use too\n          , selector : selector\n        }\n        return handler\n      }\n\n    , fireListener = W3C_MODEL ? function (isNative, type, element) {\n        // modern browsers, do a proper dispatchEvent()\n        var evt = doc.createEvent(isNative ? 'HTMLEvents' : 'UIEvents')\n        evt[isNative ? 'initEvent' : 'initUIEvent'](type, true, true, win, 1)\n        element.dispatchEvent(evt)\n      } : function (isNative, type, element) {\n        // old browser use onpropertychange, just increment a custom property to trigger the event\n        element = targetElement(element, isNative)\n        isNative ? element.fireEvent('on' + type, doc.createEventObject()) : element['_on' + type]++\n      }\n\n      /**\n        * Public API: off(), on(), add(), (remove()), one(), fire(), clone()\n        */\n\n      /**\n        * off(element[, eventType(s)[, handler ]])\n        */\n    , off = function (element, typeSpec, fn) {\n        var isTypeStr = isString(typeSpec)\n          , k, type, namespaces, i\n\n        if (isTypeStr && typeSpec.indexOf(' ') > 0) {\n          // off(el, 't1 t2 t3', fn) or off(el, 't1 t2 t3')\n          typeSpec = str2arr(typeSpec)\n          for (i = typeSpec.length; i--;)\n            off(element, typeSpec[i], fn)\n          return element\n        }\n\n        type = isTypeStr && typeSpec.replace(nameRegex, '')\n        if (type && customEvents[type]) type = customEvents[type].base\n\n        if (!typeSpec || isTypeStr) {\n          // off(el) or off(el, t1.ns) or off(el, .ns) or off(el, .ns1.ns2.ns3)\n          if (namespaces = isTypeStr && typeSpec.replace(namespaceRegex, '')) namespaces = str2arr(namespaces, '.')\n          removeListener(element, type, fn, namespaces)\n        } else if (isFunction(typeSpec)) {\n          // off(el, fn)\n          removeListener(element, null, typeSpec)\n        } else {\n          // off(el, { t1: fn1, t2, fn2 })\n          for (k in typeSpec) {\n            if (typeSpec.hasOwnProperty(k)) off(element, k, typeSpec[k])\n          }\n        }\n\n        return element\n      }\n\n      /**\n        * on(element, eventType(s)[, selector], handler[, args ])\n        */\n    , on = function(element, events, selector, fn) {\n        var originalFn, type, types, i, args, entry, first\n\n        //TODO: the undefined check means you can't pass an 'args' argument, fix this perhaps?\n        if (selector === undefined && typeof events == 'object') {\n          //TODO: this can't handle delegated events\n          for (type in events) {\n            if (events.hasOwnProperty(type)) {\n              on.call(this, element, type, events[type])\n            }\n          }\n          return\n        }\n\n        if (!isFunction(selector)) {\n          // delegated event\n          originalFn = fn\n          args       = slice.call(arguments, 4)\n          fn         = delegate(selector, originalFn, selectorEngine)\n        } else {\n          args       = slice.call(arguments, 3)\n          fn         = originalFn = selector\n        }\n\n        types = str2arr(events)\n\n        // special case for one(), wrap in a self-removing handler\n        if (this === ONE) {\n          fn = once(off, element, events, fn, originalFn)\n        }\n\n        for (i = types.length; i--;) {\n          // add new handler to the registry and check if it's the first for this element/type\n          first = registry.put(entry = new RegEntry(\n              element\n            , types[i].replace(nameRegex, '') // event type\n            , fn\n            , originalFn\n            , str2arr(types[i].replace(namespaceRegex, ''), '.') // namespaces\n            , args\n            , false // not root\n          ))\n          if (entry[eventSupport] && first) {\n            // first event of this type on this element, add root listener\n            listener(element, entry.eventType, true, entry.customType)\n          }\n        }\n\n        return element\n      }\n\n      /**\n        * add(element[, selector], eventType(s), handler[, args ])\n        *\n        * Deprecated: kept (for now) for backward-compatibility\n        */\n    , add = function (element, events, fn, delfn) {\n        return on.apply(\n            null\n          , !isString(fn)\n              ? slice.call(arguments)\n              : [ element, fn, events, delfn ].concat(arguments.length > 3 ? slice.call(arguments, 5) : [])\n        )\n      }\n\n      /**\n        * one(element, eventType(s)[, selector], handler[, args ])\n        */\n    , one = function () {\n        return on.apply(ONE, arguments)\n      }\n\n      /**\n        * fire(element, eventType(s)[, args ])\n        *\n        * The optional 'args' argument must be an array, if no 'args' argument is provided\n        * then we can use the browser's DOM event system, otherwise we trigger handlers manually\n        */\n    , fire = function (element, type, args) {\n        var types = str2arr(type)\n          , i, j, l, names, handlers\n\n        for (i = types.length; i--;) {\n          type = types[i].replace(nameRegex, '')\n          if (names = types[i].replace(namespaceRegex, '')) names = str2arr(names, '.')\n          if (!names && !args && element[eventSupport]) {\n            fireListener(nativeEvents[type], type, element)\n          } else {\n            // non-native event, either because of a namespace, arguments or a non DOM element\n            // iterate over all listeners and manually 'fire'\n            handlers = registry.get(element, type, null, false)\n            args = [false].concat(args)\n            for (j = 0, l = handlers.length; j < l; j++) {\n              if (handlers[j].inNamespaces(names)) {\n                handlers[j].handler.apply(element, args)\n              }\n            }\n          }\n        }\n        return element\n      }\n\n      /**\n        * clone(dstElement, srcElement[, eventType ])\n        *\n        * TODO: perhaps for consistency we should allow the same flexibility in type specifiers?\n        */\n    , clone = function (element, from, type) {\n        var handlers = registry.get(from, type, null, false)\n          , l = handlers.length\n          , i = 0\n          , args, beanDel\n\n        for (; i < l; i++) {\n          if (handlers[i].original) {\n            args = [ element, handlers[i].type ]\n            if (beanDel = handlers[i].handler.__beanDel) args.push(beanDel.selector)\n            args.push(handlers[i].original)\n            on.apply(null, args)\n          }\n        }\n        return element\n      }\n\n    , bean = {\n          'on'                : on\n        , 'add'               : add\n        , 'one'               : one\n        , 'off'               : off\n        , 'remove'            : off\n        , 'clone'             : clone\n        , 'fire'              : fire\n        , 'Event'             : Event\n        , 'setSelectorEngine' : setSelectorEngine\n        , 'noConflict'        : function () {\n            context[name] = old\n            return this\n          }\n      }\n\n  // for IE, clean up on unload to avoid leaks\n  if (win.attachEvent) {\n    var cleanup = function () {\n      var i, entries = registry.entries()\n      for (i in entries) {\n        if (entries[i].type && entries[i].type !== 'unload') off(entries[i].element, entries[i].type)\n      }\n      win.detachEvent('onunload', cleanup)\n      win.CollectGarbage && win.CollectGarbage()\n    }\n    win.attachEvent('onunload', cleanup)\n  }\n\n  // initialize selector engine to internal default (qSA or throw Error)\n  setSelectorEngine()\n\n  return bean\n});\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/bean/bean.js\n ** module id = 12\n ** module chunks = 0\n **/","import _ from \"lodash\";\nimport Events from \"bean\";\nimport * as KeyUtils from \"./KeyUtils\";\nimport Utils from \"../util/Utils\";\nimport DomUtils from \"../util/DomUtils\";\nimport StringBuffer from \"./../util/StringBuffer\";\n\nconst DEFAULTS = {\n\tstopPropagation: false\n};\n\nexport default class EventDispatcher {\n\t/**\n\t * Constructor\n\t * @param root the root element that the manager will listen to.\n\t * @param zoomScale\n\t * @param config the configuraton for the event dispatcher.\n\t */\n\tconstructor(root, zoomScale = [0, Infinity], config = {}) {\n\t\tthis.root = root;\n\t\tthis.rootNS = root.getAttribute('ns') || 'root';\n\t\tthis.zoomScale = zoomScale;\n\t\t_.assign(this, DEFAULTS, config);\n\t\tthis.scale = 1.0;\n\t\tthis.listeners = {};\n\t\tthis.dragging = false;\n\t\tthis.handler = _.bind(this.handleEvent, this);\n\t\tthis.started = false;\n\n\t\t// Simulate mouseenter/mouseleave events\n\t\tthis.enterStack = [];\n\t}\n\n\t/**\n\t * Start listening for events.\n\t */\n\tstart() {\n\t\tif (this.started) return;\n\t\tEvents.on(this.root, 'mousedown mouseover mouseout mouseenter mouseleave dblclick click contextmenu mousewheel', this.handler);\n\t\tthis.startKeys();\n\t\tthis.started = true;\n\t}\n\n\t/**\n\t * Stop listening for events.\n\t */\n\tstop() {\n\t\tif (!this.started) return;\n\t\tEvents.off(this.root, 'mousedown mouseover mouseout mouseenter mouseleave dblclick click contextmenu mousewheel', this.handler);\n\t\tthis.stopKeys();\n\t\tthis.started = false;\n\t}\n\n\tstartKeys() {\n\t\tEvents.on(document, 'keydown keyup', this.handler);\n\t}\n\n\tstopKeys() {\n\t\tEvents.off(document, 'keydown keyup', this.handler);\n\t}\n\n\tzoomIn() {\n\t\tthis.scale *= 1.25;\n\t\tthis.scale = Math.max(Math.min(this.zoomScale[1], this.scale), this.zoomScale[0]);\n\t\treturn this.scale;\n\t}\n\n\tzoomOut() {\n\t\tthis.scale *= 0.8;\n\t\tthis.scale = Math.max(Math.min(this.zoomScale[1], this.scale), this.zoomScale[0]);\n\t\treturn this.scale;\n\t}\n\n\tgetEventInfo(event) {\n\t\tlet target = event.target;\n\t\tlet buf = new StringBuffer(), ns, stack = [], isRoot = false;\n\t\twhile (!isRoot && target && target != document) {\n\t\t\tns = target.getAttribute('ns');\n\t\t\tif (ns) {\n\t\t\t\tisRoot = _.startsWith(ns, \"root.\");\n\t\t\t\tif (isRoot) {\n\t\t\t\t\tns = ns.substring(5);\n\t\t\t\t\tevent.rootTarget = target;\n\t\t\t\t}\n\t\t\t\tif (!event.nsTarget) event.nsTarget = target;\n\t\t\t\tstack.splice(0, 0, target);\n\t\t\t\tbuf.prepend(ns);\n\t\t\t}\n\t\t\ttarget = target.parentNode;\n\t\t}\n\t\tif (!isRoot)\n\t\t\tevent.rootTarget = event.nsTarget;\n\n\t\t// target stack is a stack of all the ns targets up to the one with the data binding.\n\t\tevent.targetStack = stack;\n\t\tns = buf.toString('.');\n\t\tif (ns == '') ns = this.rootNS;\n\t\treturn {data: event.rootTarget, ns: ns};\n\t}\n\n\t/**\n\t * The main event handler method, it processes event and generate relevant events to dispatch.\n\t */\n\thandleEvent(event) {\n\t\tlet type = event.type;\n\n\t\t// Do not dispatch other events if we are dragging.\n\t\tif (this.dragging || DomUtils.eventFromInput(event)) return;\n\n\t\tlet data, ns, pos = this.getPosition(event), info, isKeyEvent = (type == 'keydown' || type =='keyup');\n\t\tif (isKeyEvent) {\n\t\t\tdata = this.root;\n\t\t\tns = KeyUtils.getKeyEvent(event);\n\t\t} else {\n\t\t\tinfo = this.getEventInfo(event);\n\t\t\tif (!info) return;\n\t\t\tdata = info.data;\n\t\t\tns = info.ns;\n\t\t}\n\n\t\t//Utils.log('EventDispatcher', \"handleEvent - \" + type + ';ns=' + ns);\n\n\t\tif (type == 'mousewheel') {\n\t\t\tthis.scale *= Math.pow(2, event.wheelDelta * 0.002);\n\t\t\tthis.scale = Math.max(Math.min(this.zoomScale[1], this.scale), this.zoomScale[0]);\n\t\t\tevent.scale = this.scale;\n\t\t\ttype = 'zoom';\n\t\t}\n\n\t\t// See if we should create drag events\n\t\tif (type == 'mousedown' && event.button == 0 /*only drag on left click*/) {\n\t\t\t// Create drag object.\n\t\t\tconst dragObject = {data: data, pos: ns == 'root' ? EventDispatcher.mouse(this.root, event) : pos};\n\t\t\tthis.dragging = false;\n\t\t\t// Start listening for mouse move.\n\t\t\tlet dragPos;\n\n\t\t\tconst mousemove = (event) => {\n\t\t\t\tlet currentPos = this.getPosition(event);\n\t\t\t\tif (!this.dragging) {\n\t\t\t\t\t// check if the mouse has moved. IE always fire mousemove after mousedown even if the mouse hasn't moved yet.\n\t\t\t\t\tif (dragObject.pos[0] == currentPos[0] && dragObject.pos[1] == currentPos[1]) return;\n\n\t\t\t\t\t// start dragging\n\t\t\t\t\tthis.dragging = true;\n\t\t\t\t\tevent.rootTarget = dragObject.data;\n\t\t\t\t\tthis.dispatch(event, 'dragstart', ns, dragObject.data, dragObject.pos);\n\t\t\t\t}\n\t\t\t\tif (ns == \"root\")\n\t\t\t\t\tdragPos = EventDispatcher.mouse(this.root, event);\n\t\t\t\telse\n\t\t\t\t\tdragPos = currentPos;\n\t\t\t\tthis.getEventInfo(event);\n\t\t\t\tthis.dispatch(event, 'drag', ns, dragObject.data, dragPos);\n\t\t\t};\n\t\t\tconst mouseup = (event) => {\n\t\t\t\tif (ns == \"root\")\n\t\t\t\t\tdragPos = EventDispatcher.mouse(this.root, event);\n\t\t\t\telse\n\t\t\t\t\tdragPos = this.getPosition(event);\n\n\t\t\t\tlet info = this.getEventInfo(event);\n\t\t\t\tif (this.dragging) {\n\t\t\t\t\tthis.dragging = false;\n\t\t\t\t\tthis.dispatch(event, 'dragend', ns, dragObject.data, dragPos);\n\t\t\t\t} else {\n\t\t\t\t\tthis.dispatch(event, 'mouseup', ns, info.data, dragPos);\n\t\t\t\t}\n\n\t\t\t\tEvents.off(window, 'mousemove', mousemove);\n\t\t\t\tEvents.off(window, 'mouseup', mouseup);\n\t\t\t};\n\t\t\tevent.preventDefault();\n\t\t\tEvents.on(window, 'mousemove', mousemove);\n\t\t\tEvents.on(window, 'mouseup', mouseup);\n\t\t}\n\n\t\tif (!isKeyEvent)\n\t\t\tthis.simulateEnterLeave(event, type, ns, data, pos);\n\t\tthis.dispatch(event, type, ns, data, pos);\n\n\t\t// disable the default context menu\n\t\t//if (type == 'contextmenu')\n\t\t//\tevent.preventDefault();\n\t}\n\n\t/**\n\t * try to simulate mouseenter/mouseleave events.\n\t */\n\tsimulateEnterLeave(event, type, ns, data, pos) {\n\t\tlet last, stack;\n\t\tconst clearEnterStack = (k) => {\n\t\t\tk = k || 0;\n\t\t\t// Clear off the enter stack.\n\t\t\twhile (this.enterStack.length >= k + 1) {\n\t\t\t\tlast = this.enterStack.pop();\n\t\t\t\tthis.dispatch(event, 'mouseleave', last.ns, last.data, pos);\n\t\t\t}\n\t\t};\n\t\tconst getNS = function(index) {\n\t\t\tlet buf = new StringBuffer();\n\t\t\tfor (let i = 0; i <= index; i++) {\n\t\t\t\tvar val = stack[i].getAttribute(\"ns\");\n\t\t\t\tif (_.startsWith(val, \"root.\"))\n\t\t\t\t\tval = val.substring(5);\n\t\t\t\tbuf.append(val);\n\t\t\t}\n\t\t\treturn buf.toString('.');\n\t\t};\n\n\t\tif (ns && ns != this.rootNS) {\n\t\t\tif (type == 'mouseover') {\n\t\t\t\tstack = event.targetStack;\n\t\t\t\tlet item;\n\t\t\t\tfor (let i = 0; i < stack.length; i++) {\n\t\t\t\t\tif (i < this.enterStack.length) {\n\t\t\t\t\t\tif (this.enterStack[i].target != stack[i]) {\n\t\t\t\t\t\t\tclearEnterStack(i);\n\t\t\t\t\t\t} else\n\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\t\t\t\t\titem = {data: data, ns: getNS(i), target: stack[i]};\n\t\t\t\t\tthis.enterStack.push(item);\n\t\t\t\t\tthis.dispatch(event, 'mouseenter', item.ns, data, pos);\n\t\t\t\t}\n\t\t\t\tif (stack.length < this.enterStack.length)\n\t\t\t\t\tclearEnterStack(stack.length);\n\t\t\t}\n\t\t}\n\t\tif (ns == this.rootNS && this.enterStack.length > 0)\n\t\t\tclearEnterStack();\n\t}\n\n\tdispatch(event, type, ns, data, pos) {\n\t\t//if (type != 'mouseover' && type != 'mouseout')\n\t\t//\tUtils.log('EventDispatcher', \"dispatch - \" + type + '.' + ns + ';' + pos + ';rootTarget=' + event.rootTarget + ';data=' + data);\n\t\tif (!this.started) return;\n\t\tconst nsType = ns ? type + '.' + ns : type;\n\t\t_.forEach(this.listeners, (listeners, key) => {\n\t\t\tif (EventDispatcher.match(nsType, listeners.regexp ? listeners.regexp : key)) {\n\t\t\t\t_.forEach(listeners, (listener) => {\n\t\t\t\t\tif (!listener.context)\n\t\t\t\t\t\tlistener.callback.apply(window, [type, ns, data, pos, event]);\n\t\t\t\t\telse\n\t\t\t\t\t\tlistener.callback.apply(listener.context, [type, ns, data, pos, event]);\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\n\t\t// after dispatching, do not propagate.\n\t\tif (this.stopPropagation && event.stopPropagation)\n\t\t\tevent.stopPropagation();\n\t}\n\n\tgetPosition(event) {\n\t\tconst pos = EventDispatcher.mouse(this.root, event);\n\t\tif(! _.isNaN(pos[0]) && ! _.isNaN(pos[1]))\n\t\t\tthis.lastPosition = pos;\n\t\treturn this.lastPosition;\n\t}\n\n\t/**\n\t * Registers a key event handler\n\t * // Key is object {ctrl, alt, shift, meta, code}\n\t */\n\tregisterKey(type, key, callback, context) {\n\t\tif (_.isArray(key)) {\n\t\t\t_.forEach(key, (k) => {\n\t\t\t\tthis.registerKey(type, k, callback, context);\n\t\t\t});\n\t\t\treturn;\n\t\t}\n\t\tkey = KeyUtils.getKeyData(key.ctrl, key.alt, key.shift, key.meta, key.code);\n\t\tif(!key.length) return;\n\t\tkey = new StringBuffer(type).append(key).toString('.');\n\n\t\tconst listener = {callback: callback, context: context};\n\t\tthis.listeners[key] || (this.listeners[key] = []);\n\t\tthis.listeners[key].push(listener);\n\t}\n\n\tunregisterKey(type, key, callback, context) {\n\t\tif (_.isArray(key)) {\n\t\t\t_.forEach(key, (k) => {\n\t\t\t\tthis.unregisterKey(type, k, callback, context);\n\t\t\t});\n\t\t\treturn;\n\t\t}\n\t\tkey = KeyUtils.getKeyData(key.ctrl, key.alt, key.shift, key.meta, key.code);\n\t\tif(!key.length) return;\n\t\tkey = new StringBuffer(type).append(key).toString('.');\n\n\t\tlet listeners = this.listeners[key], listener;\n\t\tif (!listeners) return;\n\t\tfor (let i = 0; i < listeners.length; i++) {\n\t\t\tlistener = listeners[i];\n\t\t\tif (listener.callback === callback && (!context || context === listener.context)) {\n\t\t\t\tlisteners.splice(i, 1);\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * Registers an event handler\n\t */\n\tregister(type, callback, context, zIndex) {\n\t\tif (_.isArray(type)) {\n\t\t\t_.forEach(type, (t) => {\n\t\t\t\tthis.register(t, callback, context, zIndex);\n\t\t\t});\n\t\t\treturn;\n\t\t}\n\t\tconst listener = {callback: callback, context: context, zIndex: zIndex};\n\t\tvar regexp = null;\n\t\tif (type instanceof RegExp) {\n\t\t\tregexp = type;\n\t\t\ttype = type + '';\n\t\t}\n\t\tthis.listeners[type] || (this.listeners[type] = []);\n\t\tif (regexp && !this.listeners[type].regexp)\n\t\t\tthis.listeners[type].regexp = regexp;\n\t\tthis.listeners[type].push(listener);\n\t}\n\n\tunregister(type, callback, context) {\n\t\tif (type instanceof RegExp)\n\t\t\ttype = type + '';\n\t\tlet listeners = this.listeners[type], listener;\n\t\tif (!listeners) return;\n\t\tfor (let i = 0; i < listeners.length; i++) {\n\t\t\tlistener = listeners[i];\n\t\t\tif (listener.callback === callback && (!context || context === listener.context)) {\n\t\t\t\tlisteners.splice(i, 1);\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t}\n\n\tdestroy() {\n\t\tthis.stop();\n\t\tdelete this.root;\n\t\tdelete this.listeners;\n\t\tdelete this.enterStack;\n\t}\n\n\t/**\n\t * Check if the registered event type matches the real event type. \"*\" is allowed as a wild card.\n\t */\n\tstatic match(nsType, registeredType) {\n\t\tif (registeredType instanceof RegExp)\n\t\t\treturn nsType.match(registeredType);\n\n\t\treturn nsType == registeredType;\n\t\t/*const arr = registeredType.split('*');\n\t\tif (arr.length == 1)\n\t\t\treturn nsType == registeredType;\n\n\t\tlet substr, index = 0;\n\t\tfor (let i = 0; i < arr.length; i++) {\n\t\t\tif (arr[i].length == 0) continue;\n\t\t\tsubstr = nsType.slice(index);\n\t\t\tindex = substr.indexOf(arr[i]);\n\t\t\tif (index < 0)\n\t\t\t\treturn false;\n\t\t\tindex += arr[i].length;\n\t\t}\n\t\treturn true;*/\n\t}\n\n\tstatic mouse(container, e) {\n\t\tif (e.changedTouches) e = e.changedTouches[0];\n\t\tvar svg = container.ownerSVGElement || container;\n\t\tif (svg.createSVGPoint) {\n\t\t\tvar point = svg.createSVGPoint();\n\t\t\tpoint.x = e.clientX; point.y = e.clientY;\n\t\t\tpoint = point.matrixTransform(container.getScreenCTM().inverse());\n\t\t\treturn [point.x, point.y];\n\t\t}\n\t\tvar rect = container.getBoundingClientRect();\n\t\treturn [e.clientX - rect.left - container.clientLeft, e.clientY - rect.top - container.clientTop];\n\t}\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/event/EventDispatcher.js\n **/","///////////////////////////////////////////////////////////////////////////////\n//                                                                           //\n//           The Key Utility CLass for the Event Dispatcher          \t     //\n//                                                                           //\n///////////////////////////////////////////////////////////////////////////////\n\nimport StringBuffer from \"./../util/StringBuffer\";\n\n/**\n * KEY constant\n */\nconst KEY = {\n\tALT          : 18,\n\tBACK_SPACE   : 8,\n\tCAPS_LOCK    : 20,\n\tCONTROL      : 17,\n\tDELETE       : 46,\n\tDOWN         : 40,\n\tEND          : 35,\n\tENTER        : 13,\n\tESCAPE       : 220,\n\tHOME         : 36,\n\tLEFT         : 37,\n\tMETA         : 224,\n\tNUM_LOCK     : 144,\n\tPAGE_DOWN    : 34,\n\tPAGE_UP      : 33,\n\tPAUSE        : 19,\n\tPRINTSCREEN  : 44,\n\tRIGHT        : 39,\n\tSCROLL_LOCK  : 145,\n\tSHIFT        : 16,\n\tSPACE        : 32,\n\tTAB          : 9,\n\tUP           : 38\n\t//ADD          : DomUtils.isFireFox ? 61  : 187,\n\t//SUBTRACT     : DomUtils.isFireFox ? 173 : 189\n};\n\nexport function getKeyEvent(event) {\n\tif (!event || !event instanceof KeyboardEvent) {\n\t\treturn null;\n\t}\n\n\tvar key = event.keyCode || event.which;\n\n\t// Need to find a way to avoid this\n\tif (key >= 16 && key <= 18) {\n\t\tkey = null;\n\t}\n\n\treturn getKeyData(event.ctrlKey, event.altKey, event.shiftKey, event.metaKey, key);\n}\n\nexport function getKeyData(ctrl, alt, shift, meta, key) {\n\tvar buf = new StringBuffer();\n\n\tif (ctrl) buf.append(\"CTRL\");\n\tif (alt) buf.append(\"ALT\");\n\tif (shift) buf.append(\"SHIFT\");\n\tif (meta) buf.append(\"META\");\n\tif (key) buf.append(key);\n\n\treturn buf.toString(\".\");\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/event/KeyUtils.js\n **/","import _ from \"lodash\";\nimport Utils from \"../util/Utils\";\nimport Node from \"./Node\";\nimport Edge from \"./Edge\";\nimport Marker from \"../view/Marker\";\n\nconst nodeDefaults = {\n\tname: 'Default',\n\trole: 'node',\n\tdraggable: true,\n\tselectable: true,\n\teditable: true,\n\tresizable: false,\n\tsourceable: true,\n\ttargetable: true,\n\tvisible: true\n};\n\nconst edgeDefaults = {\n\tname: 'Default',\n\trole: 'edge',\n\tselectable: true,\n\tvisible: true,\n\tstartMarker: null,\n\tendMarker: {\n\t\tid: 'Default_EndMarker',\n\t\ttype: 'arrow',\n\t\tsize: 10,\n\t\tcolor: '#0ea117'\n\t},\n\t/* start and end is only used if the edge is not connected to a node */\n\tstart: [0, 0],\n\tend: [400, 200]\n};\n\nclass Graph {\n\tconstructor(id = _.uniqueId(\"G\"), config = {}, model) {\n\t\tthis.id = id;\n\n\t\tthis.nodes = {};\n\t\tthis.edges = {};\n\n\t\tthis.selection = null;\n\t\tthis.destroyed = false;\n\n\t\tUtils.buildTypes(config.nodeTypes, \"Nodes\", nodeDefaults);\n\t\tUtils.buildTypes(config.edgeTypes, \"Edges\", edgeDefaults);\n\t\t// check for markers.\n\t\tthis.markers = [];\n\t\tlet edgeTypes = Utils.type(Edge.namespace), marker, markerConfig;\n\t\tedgeTypes.forEach(function(type) {\n\t\t\tmarkerConfig = type.prototype.startMarker;\n\t\t\tif (markerConfig) {\n\t\t\t\tmarker = Marker.getMarker(markerConfig, true);\n\t\t\t\tthis.markers.push(marker);\n\t\t\t}\n\t\t\tmarkerConfig = type.prototype.endMarker;\n\t\t\tif (markerConfig) {\n\t\t\t\tmarker = Marker.getMarker(markerConfig, false);\n\t\t\t\tthis.markers.push(marker);\n\t\t\t}\n\t\t}, this);\n\n\t\tdelete config.nodeTypes;\n\t\tdelete config.edgeTypes;\n\t\tUtils.initConfig(this, config);\n\t\tthis.root = null;\n\t\tif (model)\n\t\t\tthis.loadModel(model);\n\t}\n\n\tstatic getJSClass(config, defaultClass) {\n\t\tvar jsClass = null;\n\t\tif (config && config.type) {\n\t\t\t// See if we can get the js class from config.\n\t\t\tvar type = Utils.type(defaultClass.namespace, config.type);\n\t\t\tif (type)\n\t\t\t\tjsClass = type.jsClass;\n\t\t}\n\n\t\treturn Utils.getConstructor(jsClass, defaultClass);\n\t}\n\n\t/**\n\t * Create a new Node\n\t */\n\taddNode(config, parent = this.currentRoot, pos) {\n\t\tlet NodeClass = Graph.getJSClass(config, Node);\n\t\tlet node = new NodeClass(this, config);\n\n\t\tif (parent)\n\t\t\tGraph.addChild(parent, node, pos);\n\t\telse {\n\t\t\tthis.root = node;\n\t\t\tthis.root.prop('role', 'root');\n\t\t}\n\n\t\tthis.nodes[node.id] = node;\n\t\treturn node;\n\t}\n\n\taddEdge(config, parent = this.currentRoot, from, to) {\n\t\tlet EdgeClass = Graph.getJSClass(config, Edge);\n\t\tlet edge = new EdgeClass(this, config, from, to);\n\n\t\tGraph.addChild(parent, edge);\n\t\tthis.edges[edge.id] = edge;\n\t\treturn edge;\n\t}\n\n\tstatic addChild(parent, child) {\n\t\tif (!parent.children)\n\t\t\tparent.children = [];\n\n\t\tif (child.parent != parent) {\n\t\t\tparent.children.push(child);\n\n\t\t\tif (child.parent && child.parent.children)\n\t\t\t\tchild.parent.children = _.without(child.parent.children, child);\n\t\t}\n\t\tchild.parent = parent;\n\t}\n\n\tloadModel(model, parent = this.currentRoot) {\n\t\tvar nodes = model.nodes;\n\t\tvar edges = model.edges;\n\t\tdelete model.nodes;\n\t\tdelete model.edges;\n\n\t\tvar node = this.addNode(model, parent);\n\t\tif (nodes) {\n\t\t\t_.forEach(nodes, (child) => {\n\t\t\t\tthis.loadModel(child, node);\n\t\t\t});\n\t\t}\n\t\tif (edges) {\n\t\t\t_.forEach(edges, (edge) => {\n\t\t\t\tlet from, to;\n\t\t\t\tif (edge.from)\n\t\t\t\t\tfrom = this.nodes[edge.from];\n\t\t\t\tif (edge.to)\n\t\t\t\t\tto = this.nodes[edge.to];\n\t\t\t\tthis.addEdge(edge, node, from, to);\n\t\t\t});\n\t\t}\n\t}\n\n\tget currentRoot() {\n\t\treturn this.root;\n\t}\n\n\treset() {}\n\tdestroy() {}\n}\n\nGraph.DEFAULTS = {\n\tallowDanglingEdges: true,\n\tmultiConnect: false,\n\treadOnly: false,\n\tviewOnly: false\n};\n\nexport default Graph;\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/graph/Graph.js\n **/","import _ from \"lodash\";\nimport StringBuffer from \"../util/StringBuffer\";\nimport Cell from \"./Cell\";\n\nclass Node extends Cell {\n\tconstructor(graph, config = {}) {\n\t\tif (!config.id) config.id = _.uniqueId('N');\n\t\tsuper(graph, config);\n\n\t\tthis.inEdges = [];\n\t\tthis.outEdges = [];\n\t\tthis.ports = null;\n\t\tthis.parent = null;\n\t}\n\n\tisAncestor(n) {\n\t\t// TODO: should we move this to graph class ?\n\t\tvar node = n.parent;\n\t\twhile (node) {\n\t\t\tif (this == node) { return true; }\n\t\t\tnode = node.parent;\n\t\t}\n\t\treturn false;\n\t}\n\n\tremoveEdge(edge) {\n\t\tvar edges = edge.source == this ? this.outEdges : this.inEdges;\n\t\tfor (var i = 0; i < edges.length; i++) {\n\t\t\tif (edge == edges[i]) {\n\t\t\t\tedges.splice(i, 1);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\n\t// Add a new incoming edge\n\taddInEdge(edge, pos) {\n\t\tif (pos == null || pos === undefined)\n\t\t\tthis.inEdges.push(edge);\n\t\telse\n\t\t\tthis.inEdges.splice(pos, 0, edge);\n\t}\n\n\t// Add a new outgoing edge\n\taddOutEdge(edge, pos) {\n\t\tif (pos == null || pos === undefined || pos > edge.length - 1)\n\t\t\tthis.outEdges.push(edge);\n\t\telse\n\t\t\tthis.outEdges.splice(pos, 0, edge);\n\t}\n\n\trenderChildren(view) {\n\t\tif (this.children) {\n\t\t\tlet buf = new StringBuffer();\n\t\t\t_.forEach(this.children, (child) => {\n\t\t\t\tbuf.append(child.render(view));\n\t\t\t});\n\t\t\treturn buf.toString();\n\t\t}\n\t\treturn '';\n\t}\n\n\tgetPort(key, portName = 'auto', endPt, orthogonal) {\n\t\tlet shape = this.getShape(key);\n\t\tif (portName == 'auto') {\n\t\t\treturn shape.getPerimeter(endPt, orthogonal);\n\t\t}\n\t\treturn null;\n\t}\n\n\ttoString() {\n\t\tvar label = this.prop(\"label\") ? this.prop(\"label\") : \"undefined\";\n\t\tif (_.isArray(label))\n\t\t\tlabel = label[0];\n\t\treturn 'Node:{id:' + this.id + ';label:' + label + ';type:' + this.props.constructor.typeName + '}';\n\t}\n}\nNode.namespace = \"Nodes\";\n\nexport default Node;\n\n/*\n\n/**\n * The DrillDownParent is the parent that displays the vertex when drilled down.\n *\nVertex.prototype.getDrillDownParent = function() {\n\treturn this.parent;\n};\n\nVertex.prototype.isLocked = function() {\n\tvar mode = this.getProperty(\"mode\") || 3;\n\treturn !(mode & Graph.ALLOW_INTERACTIONS);\n};\n\nVertex.prototype.getCrumbText = function() {\n\tif (this.isLocked())\n\t\treturn '<span><img src=\"webwb/pzreadonly.png\" /></span><span>&nbsp;' + this.getProperty(\"label\") + '</span>';\n\treturn this.getProperty(\"label\");\n};\n\nVertex.prototype.canEdit = function() {\n\treturn (!this.parent || !this.parent.isLocked()) && Vertex.superclass.canEdit.call(this);\n};\n\nVertex.prototype.isContainer = function() {\n\treturn this.getProperty(\"container\");\n};\n\n*/\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/graph/Node.js\n **/","import _ from \"lodash\";\nimport Utils from \"../util/Utils\";\nimport Cache from \"../util/Cache\";\nimport StringBuffer from \"../util/StringBuffer\";\nimport Shape from \"../geometry/Shape\";\nimport Rectangle from \"../geometry/Rectangle\";\nimport Label from \"../view/Label\";\n\n/**\n * The Cell is the common parent for Node and Edge.\n */\nexport default class Cell {\n\tconstructor(graph, config = {id: _.uniqueId()}) {\n\t\tthis.graph = graph;\n\t\tthis.id = config.id;\n\t\tdelete config.id;\n\n\t\t// Initialize decorators\n\t\tif (config.decorators) {\n\t\t\tthis.createDecorators(config.decorators);\n\t\t\tdelete config.decorators;\n\t\t}\n\n\t\t// Initialize View Properties\n\t\tif (config.views) {\n\t\t\tthis.viewProps = config.views;\n\t\t\tdelete config.views;\n\t\t}\n\n\t\t// Initialize type\n\t\tvar type = config.type || \"Default\";\n\t\ttype = Utils.type(this.constructor.namespace, type);\n\t\tif (!type)\n\t\t\tthrow new Error(\"Type not found \" + config.type);\n\t\tdelete config.type;\n\t\tthis.props = new type(config);\n\t}\n\n\tprop(name, value) {\n\t\tif (_.isUndefined(value))\n\t\t\treturn this.props[name];\n\t\tthis.props[name] = value;\n\t}\n\n\t/**\n\t * Get/Set property stored by views.\n\t * @param key\n\t * @param name\n\t * @param value\n\t * @returns {*}\n\t */\n\tviewProp(key = 'default', name, value) {\n\t\tif (_.isUndefined(value)) {\n\t\t\tif (key == 'default')\n\t\t\t\treturn this.prop(name, value);\n\t\t\treturn this.viewProps[key][name];\n\t\t}\n\t\tif (key == 'default') {\n\t\t\tthis.prop(name, value);\n\t\t} else {\n\t\t\tif (!this.viewProps[key])\n\t\t\t\tthis.viewProps[key] = {};\n\t\t\tthis.viewProps[key][name] = value;\n\t\t}\n\t}\n\n\tcreateDecorators(decorators) {}\n\n\t/**\n\t * Get properties needed for rendering this element\n\t * @returns {{key: (string|*), className: *, namespace: *, bounds: *}}\n\t */\n\tgetView(key) {\n\t\tlet shape = this.getShape(key);\n\t\treturn _.assign({\n\t\t\tid: this.id,\n\t\t\tkey: key,\n\t\t\tclassName: this.computedClassName,\n\t\t\tstyle: this.viewProp(key, 'style'),\n\t\t\tnamespace: this.namespace\n\t\t}, shape);\n\t}\n\n\tgetShape(key) {\n\t\tlet shape = Cache.get(this.id + \".shape\", key);\n\t\tif (shape) return shape;\n\n\t\tlet shapeConfig = this.viewProp(key, 'shape');\n\t\tlet shapeClass = shapeConfig ? Shape.getShape(shapeConfig.name) : Shape.getShape('Rectangle');\n\t\tlet x = this.viewProp(key, \"x\");\n\t\tlet y = this.viewProp(key, \"y\");\n\t\tlet width = this.viewProp(key, \"width\");\n\t\tlet height = this.viewProp(key, \"height\");\n\t\tshape = new shapeClass(x, y, width, height, shapeConfig);\n\t\tCache.set(this.id + '.shape', shape, key);\n\t\treturn shape;\n\t}\n\n\trender(view) {\n\t\tlet template = Cache.get(this.id + '.template', view.id);\n\t\tif (!template) {\n\t\t\t//create the template\n\t\t\tlet role = this.prop('role');\n\t\t\ttemplate = view.getTemplate('$' + role, null, this);\n\t\t\tif (_.isString(template))\n\t\t\t\ttemplate = _.template(template);\n\t\t\tCache.set(this.id + '.template', template, view.id);\n\t\t}\n\t\treturn template(this.getView(view.id));\n\t}\n\n\trenderShape(view) {\n\t\tlet shape = this.getShape(view.id);\n\t\tif (shape)\n\t\t\treturn shape.render(view);\n\t\treturn '';\n\t}\n\n\trenderLabel(view) {\n\t\tif (this == this.graph.currentRoot)\n\t\t\treturn null;\n\t\tlet box = this.getLabelBox(view.id);\n\t\tif (box)\n\t\t\treturn view.renderLabel(box);\n\t\treturn '';\n\t}\n\n\tgetLabelBox(key) {\n\t\tlet box = Cache.get(this.id + '.labelBox', key);\n\t\tif (box) return box;\n\t\tlet shape = this.getShape(key);\n\t\t// Just get the config will have a positive performance boost for IE11 and IE10.\n\t\tbox = Label.getLabelBox(this.prop('label'), this.viewProp(key, 'labelConfig'), shape.width, shape.height);\n\t\tCache.set(this.id + '.labelBox', box, key);\n\t\treturn box;\n\t}\n\n\tget computedClassName() {\n\t\tif (!this._computedClassName) {\n\t\t\tvar buf = new StringBuffer(this.prop(\"role\"));\n\t\t\tlet props = this.props;\n\t\t\tif (props.hasOwnProperty(\"className\"))\n\t\t\t\tbuf.append(props[\"className\"]);\n\t\t\tprops = props.constructor.prototype;\n\t\t\twhile (props) {\n\t\t\t\tif (props.hasOwnProperty(\"className\"))\n\t\t\t\t\tbuf.append(props[\"className\"]);\n\t\t\t\tprops = Object.getPrototypeOf(props);\n\t\t\t}\n\t\t\tthis._computedClassName = buf.toString(' ');\n\t\t}\n\t\treturn this._computedClassName;\n\t}\n\n\tget namespace() {\n\t\tif (this == this.graph.currentRoot) return '';\n\t\treturn \"root.\" + this.prop(\"role\");\n\t}\n\n\tdestroy() {\n\t\tdelete this.graph;\n\t\tdelete this.decorators;\n\t\tdelete this.props;\n\t\tdelete this.viewProps;\n\t\tthis.destroyed = true;\n\t}\n}\n\n/*\n\nCell.prototype.move = function(x, y) {\n\tthis.setProperty(\"x\", Math.round(x));\n\tthis.setProperty(\"y\", Math.round(y));\n\tdelete this.bounds;\n};\n\nCell.prototype.resize = function(w, h) {\n\tthis.setProperty(\"width\", w);\n\tthis.setProperty(\"height\", h);\n\tdelete this.bounds;\n};\n\nCell.prototype.canEdit = function() {\n\treturn (this.graph ? this.graph.canEdit() : true) && this.getProperty(\"editable\");\n};\n\nCell.prototype.canSelect = function() {\n\treturn (this.graph ? this.graph.canSelect() : true) && this.getProperty(\"selectable\");\n};\n\nCell.prototype.canMove = function() {\n\treturn (this.graph ? this.graph.canEdit() : true) && this.getProperty(\"draggable\");\n};\n\nCell.prototype.canResize = function() {\n\treturn (this.graph ? this.graph.canEdit() : true) && this.getProperty(\"resizable\");\n};\n\nCell.prototype.getTypeFromString = function(typeStr) {\n\treturn this.graph.getType(typeStr);\n};\n\nCell.prototype.createModifiers = function(modifiers) {\n\tthis.modifiers = null;\n\tvar modifierSettings = this.getProperty(\"modifierSettings\");\n\tif (modifierSettings) {\n\t\t_.each(modifiers, function(config) {\n\t\t\tconfig.type = this.graph.getModifierType(config.className);\n\t\t\tconfig.setting = modifierSettings[config.className];\n\t\t\tif (!config.type || !config.setting) return;\n\n\t\t\tthis.addModifier(config.className, new Modifier(this, config));\n\t\t}, this);\n\n\t\t// Check for showAlways settings\n\t\t_.each(modifierSettings, function(setting, name) {\n\t\t\tif (setting.showAlways && (!this.modifiers || !this.modifiers[name])) {\n\t\t\t\tvar config = {type: this.graph.getModifierType(name), setting: setting};\n\t\t\t\tif (!config.type) return;\n\t\t\t\tthis.addModifier(name, new Modifier(this, config));\n\t\t\t}\n\t\t}, this);\n\t}\n};\n\nCell.prototype.addModifier = function(name, modifier) {\n\tif (!this.modifiers)\n\t\tthis.modifiers = {};\n\n\tif (!modifier.hasOwnProperty(\"showHeader\"))\n\t\tmodifier.showHeader = true;\n\n\t// @hack preferably set it in configurations.\n\tif (modifier.name == \"HoverProcessModifier\" || modifier.name == \"HoverResults\")\n\t\tmodifier.showHeader = false;\n\n\tthis.modifiers[name] = modifier;\n};\n\nCell.prototype.getModifiers = function() {\n\tif (_.isUndefined(this.modifiers))\n\t\tthis.createModifiers();\n\treturn this.modifiers;\n};\n\nCell.prototype.getModifier = function(name) {\n\tvar modifiers = this.getModifiers();\n\tif (modifiers)\n\t\treturn modifiers[name];\n\treturn null;\n};\n\nCell.prototype.isVisible = function() {\n\treturn this.getProperty('visible');\n};\n\nCell.prototype.isContainer = function() {\n\treturn false;\n};\n*/\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/graph/Cell.js\n **/","/**\n * Created by tong on 6/7/2016.\n */\n\nlet caches = {};\n\nlet Cache = {\n\tget: function(key, namespace) {\n\t\treturn this.getCache(namespace)[key];\n\t},\n\n\tset: function(key, value, namespace) {\n\t\tthis.getCache(namespace)[key] = value;\n\t},\n\n\tcontains: function(key, namespace) {\n\t\treturn key in this.getCache(namespace);\n\t},\n\n\tremove: function(key, namespace) {\n\t\tdelete this.getCache(namespace)[key];\n\t},\n\n\tclear: function(namesapce) {\n\t\tif (!namespace)\n\t\t\tcaches = {};\n\t\telse if (caches[namespace])\n\t\t\tcaches[namespace] = {};\n\t},\n\n\tgetCache: function(namespace = 'default') {\n\t\tif (!caches[namespace])\n\t\t\tcaches[namespace] = {};\n\t\treturn caches[namespace];\n\t}\n};\n\nexport default Cache;\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/util/Cache.js\n **/","import _ from \"lodash\";\nimport Events from \"bean\";\nimport Utils from \"../util/Utils\";\nimport DomUtils from \"../util/DomUtils\";\nimport StringBuffer from \"../util/StringBuffer\";\nimport Rectangle from \"../geometry/Rectangle\";\n\nconst FONT_BOLD = 1, FONT_ITALIC = 2, FONT_UNDERLINE = 4, FONT_SHADOW = 8;\n\nlet defaultConfig = {\n\tfontSize: 11,\n\tfontFamily: \"Arial\",\n\tfontStyle: 0,\n\tfontColor: 'black',\n\tpadding: 0,\n\tlinePadding: 0,\n\talign: \"left\",\n\twidth: 0,\n\theight: 0,\n\trotation: null,\n\tgeometry: {x: 0, y: 0, anchorY: 0, offsetX: 0, offsetY: 0}\n};\n\n/**\n * The label object handles label sizing/positioning\n */\nexport default (function() {\n\tlet stringMeasureEl = null, measureDiv, baselineDiv;\n\n\t/**\n\t * Calculate the size of the string.\n\t */\n\tlet getStringSize = _.memoize(function(str, fontSize, fontFamily, bold) {\n\t\tfontSize = fontSize || 11;\n\t\tfontFamily = fontFamily || 'Arial,Helvetica';\n\t\tbold = !_.isUndefined(bold) ? bold: false;\n\n\t\t// first check if there is a string-measuring div available, if not, create now.\n\t\tif (!stringMeasureEl) {\n\t\t\tstringMeasureEl = DomUtils.createElement('iframe', {id:\"_ComputeStylesIframe\"}, {position:\"absolute\", visibility:\"hidden\", width:\"auto\"});\n\t\t\tdocument.body.appendChild(stringMeasureEl);\n\t\t\tvar doc = stringMeasureEl.contentWindow.document;\n\t\t\tdoc.open();\n\t\t\tdoc.write('<html><body>\\\n\t\t\t\t<div id=\"baselineDiv\" style=\"height:100px;\"><span style=\"line-height:0\">T</span><span style=\"height:100%;display:inline-block;\"></span></div>\\\n\t\t\t\t<div id=\"measureDiv\" style=\"position:absolute;width:auto;height:auto;padding:0;white-space:pre-wrap;word-wrap:break-word;display:inline-block;\"></div>\\\n\t\t\t\t</body></html>');\n\t\t\tdoc.close();\n\t\t\tmeasureDiv = doc.getElementById(\"measureDiv\");\n\t\t\tbaselineDiv = doc.getElementById(\"baselineDiv\");\n\t\t}\n\t\tbaselineDiv.style.fontSize = measureDiv.style.fontSize = fontSize;\n\t\tbaselineDiv.style.fontFamily = measureDiv.style.fontFamily = fontFamily;\n\t\tbaselineDiv.style.fontWeight = measureDiv.style.fontWeight = bold ? 'bold' : 'normal';\n\t\tmeasureDiv.innerHTML = str;\n\n\t\tlet strut = baselineDiv.firstChild;\n\t\tlet baselineHeight = strut.offsetTop + strut.offsetHeight - baselineDiv.offsetHeight - baselineDiv.offsetTop;\n\n\t\treturn {width: measureDiv.offsetWidth, height: measureDiv.offsetHeight, baseline: baselineHeight};\n\t}, function(str, fontSize, fontFamily, bold) { return str + ';' + fontSize + ';' + fontFamily + ';' + bold; });\n\n\t/**\n\t * Create a wrapped text.\n\t * @param {String} string the string to wrap.\n\t * @param {maxWidth} the maximum width this string can take.\n\t * @param {fontSize}\n\t * @param {fontFamily}\n\t * @param {bold}\n\t */\n\tlet wrap = _.memoize(function(string, maxWidth, fontSize, fontFamily, bold) {\n\t\tmaxWidth = maxWidth || 0;\n\t\tfontSize = fontSize || 11;\n\t\tfontFamily = fontFamily || 'Arial,Helvetica';\n\t\tbold = !_.isUndefined(bold) ? bold: false;\n\n\t\tlet arr = [];\n\t\tlet spaceSize = getStringSize(\"&nbsp;\", fontSize, fontFamily, bold), space = spaceSize.width;\n\t\tarr.lineHeight = spaceSize.height;\n\t\tarr.baseline = spaceSize.baseline;\n\n\t\tif (!maxWidth || !string || string == \"\") {\n\t\t\tarr.push(string);\n\t\t\tarr.width = (!string || string == \"\") ? space : getStringSize(string, fontSize, fontFamily, bold).width;\n\t\t\tarr.height = arr.lineHeight;\n\t\t\treturn arr;\n\t\t}\n\n\t\tvar width = 0;\n\t\t//split the text by lines\n\t\tvar lines = string.split('\\n');\n\n\t\tvar buf = new StringBuffer();\n\n\t\tfor (var j = 0; j < lines.length; j++) {\n\t\t\t//split each line by word\n\t\t\tvar words = lines[j].split(/\\s/);\n\t\t\tvar line = \"\", currentWidth = 0, wordWidth = 0, newLine = true, word;\n\n\t\t\tfor (var i = 0; i < words.length; i++) {\n\t\t\t\tword = words[i];\n\t\t\t\twordWidth = getStringSize(word, fontSize, fontFamily, bold).width;\n\n\t\t\t\tif ((newLine ? wordWidth : currentWidth + space + wordWidth) > maxWidth) {\n\t\t\t\t\tif (newLine) {\n\t\t\t\t\t\tbuf.append(word);\n\t\t\t\t\t\twidth = Math.max(width, wordWidth);\n\t\t\t\t\t\tif (i < words.length - 1) {\n\t\t\t\t\t\t\tarr.push(buf.toString());\n\t\t\t\t\t\t\tbuf.clear();\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tarr.push(buf.append(line).toString());\n\t\t\t\t\t\twidth = Math.max(width, currentWidth + space + wordWidth);\n\t\t\t\t\t\tbuf.clear();\n\t\t\t\t\t}\n\t\t\t\t\tline = \"\";\n\t\t\t\t\tcurrentWidth = 0;\n\t\t\t\t\tif (!newLine)\n\t\t\t\t\t\ti--; // move back one word.\n\t\t\t\t\tnewLine = true;\n\t\t\t\t} else {\n\t\t\t\t\tline = newLine ? word : line + \" \" + word;\n\t\t\t\t\tcurrentWidth = newLine ? wordWidth : currentWidth + space + wordWidth;\n\t\t\t\t\twidth = Math.max(width, currentWidth);\n\t\t\t\t\tnewLine = false;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (line != \"\")\n\t\t\t\tbuf.append(line);\n\t\t\tif (j < lines.length - 1) {\n\t\t\t\tarr.push(buf.toString());\n\t\t\t\tbuf.clear();\n\t\t\t}\n\t\t}\n\n\t\tarr.push(buf.toString());\n\t\tarr.width = width;\n\t\tarr.height = arr.lineHeight * arr.length;\n\t\treturn arr;\n\t}, function(str, maxWidth, fontSize, fontFamily, bold) { return str + ';' + maxWidth + ';' + fontSize + ';' + fontFamily + ';' + bold; });\n\n\t/**\n\t *  Get the view information for how to display the label.\n\t * @param label The string that needs to be displayed\n\t * @param containerWidth The width of the parent container.\n\t * @param containerHeight The height of the parent container.\n\t * @param labelConfig The configuration on how to display label. It should be an object with the following parameters:\n\t * {\n\t *      fontSize, fontFamily, fontStyle, padding,\n\t *      align: can be either \"left\", \"center\" or \"right\",\n\t *      width: the maximum width of the label. if less than 1, then is treated as percentage. If 0, no wrapping will occur,\n\t *      height,\n\t *      geometry\n\t * }\n\t * @returns {*}\n\t */\n\tfunction getLabelBox(label, labelConfig, containerWidth, containerHeight) {\n\t\treturn _getLabelBox.call(this, label, labelConfig, {width: containerWidth, height: containerHeight});\n\t}\n\n\tfunction getLabelBoxForLink(label, labelConfig, link) {\n\t\treturn _getLabelBox.call(this, label, labelConfig, link);\n\t}\n\n\tfunction _getLabelBox(label, labelConfig = {}, context) {\n\t\tlabelConfig = _.defaultsDeep(labelConfig, defaultConfig);\n\t\tlet fontSize = labelConfig.fontSize;\n\t\tlet fontFamily = labelConfig.fontFamily;\n\t\tlet fontStyle = labelConfig.fontStyle;\n\t\tlet bold = (fontStyle & FONT_BOLD) == FONT_BOLD;\n\t\tlet padding = labelConfig.padding;\n\t\tlet linePadding = labelConfig.linePadding;\n\t\tlet align = labelConfig.align;\n\n\t\tlet w = labelConfig.width, h = labelConfig.height;\n\t\tif (context.width) {\n\t\t\tw = w <= 5 ? context.width * w : w;\n\t\t\th = h <= 5 ? context.height * h : h;\n\t\t}\n\t\tw -= 2 * padding;\n\t\th -= 2 * padding;\n\t\tw = Math.max(0, w);\n\t\th = Math.max(0, h);\n\n\t\tlet geometry = _.clone(labelConfig.geometry);\n\t\tlet wrappedLabel = this.wrap(label, w, fontSize, fontFamily, bold);\n\t\tgeometry.width = wrappedLabel.width + 2 * padding;\n\t\tgeometry.height = wrappedLabel.height + 2 * padding + (wrappedLabel.length - 1) * linePadding;\n\t\tlet anchor = \"start\", dx = 0, setAnchorX = !_.has(geometry, \"anchorX\");\n\t\tswitch (align) {\n\t\t\tcase \"center\":\n\t\t\t\tanchor = \"middle\";\n\t\t\t\tif (setAnchorX) geometry.anchorX = 0;\n\t\t\t\tbreak;\n\t\t\tcase \"right\":\n\t\t\t\tanchor = \"end\";\n\t\t\t\tdx = wrappedLabel.width/2;\n\t\t\t\tif (setAnchorX) geometry.anchorX = -0.5;\n\t\t\t\tbreak;\n\t\t\tcase \"left\":\n\t\t\t\tdx = -wrappedLabel.width/2;\n\t\t\t\tif (setAnchorX) geometry.anchorX = 0.5;\n\t\t\t\tbreak;\n\t\t}\n\t\tlet pos;\n\t\tif (context.getRelativePosition)\n\t\t\tpos = context.getRelativePosition(geometry);\n\t\telse\n\t\t\tpos = Utils.getRelativePosition({width: context.width, height: context.height}, geometry);\n\n\t\tlet bounds = new Rectangle(pos[0], pos[1], geometry.width, geometry.height);\n\t\t// the pivot is the center of rotation when the label has a rotation specified.\n\t\tlet pivot = align == 'center' ? [0, 0] : (align == 'left' ? [-wrappedLabel.width/2, 0] : [wrappedLabel.width/2, 0]);\n\n\t\t// the maximum bounds for the label, used to position inline editor\n\t\tgeometry.width = Math.max(w + 2 * padding, geometry.width);\n\t\tgeometry.height = Math.max(h + 2 * padding, geometry.height);\n\n\t\tif (context.getRelativePosition)\n\t\t\tpos = context.getRelativePosition(geometry);\n\t\telse\n\t\t\tpos = Utils.getRelativePosition({width: context.width, height: context.height}, geometry);\n\n\t\tlet maxBounds = new Rectangle(pos[0], pos[1], geometry.width, geometry.height);\n\t\treturn {\n\t\t\tconfig: labelConfig, label: wrappedLabel, _label: label,\n\t\t\tbold, underline: fontStyle & FONT_UNDERLINE, italic: fontStyle & FONT_ITALIC, shadow: fontStyle & FONT_SHADOW,\n\t\t\tdx, dy: -geometry.height/2 + padding + wrappedLabel.lineHeight - wrappedLabel.baseline, anchor, lineHeight: wrappedLabel.lineHeight + linePadding,\n\t\t\tpivot, bounds, maxBounds\n\t\t};\n\t}\n\n\tfunction render(view, box) {\n\t\treturn view.renderLabel(box);\n\t}\n\n\tlet editor = {\n\t\tstart: function(key, container, box, refEl, textEl, scale = 1.0, singleLine = true) {\n\t\t\tif (this.input) {\n\t\t\t\tif (this.key != key) {\n\t\t\t\t\t// need to close the existing editor first\n\t\t\t\t\tthis.stop();\n\t\t\t\t} else\n\t\t\t\t\treturn;\n\t\t\t}\n\t\t\tvar tag = singleLine ? 'input' : 'textarea';\n\t\t\tthis.input = DomUtils.createElement(tag, {id:\"inlineEditor\", unselectable:\"off\"}, {position:\"absolute\", overflow:\"hidden\", padding:\"0px\", margin:\"0px\", border:\"transparent\"});\n\t\t\tif (singleLine) {\n\t\t\t\tEvents.on(this.input, 'keydown keyup', (event) => {\n\t\t\t\t\tif (event.keyCode == 13) {\n\t\t\t\t\t\tEvents.off(this.input, 'keydown keyup');\n\t\t\t\t\t\tthis.stop();\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t\tcontainer.appendChild(this.input);\n\n\t\t\tthis.key = key;\n\t\t\tthis.box = box;\n\t\t\tthis.refEl = refEl;\n\t\t\tthis.textEl = textEl;\n\n\t\t\tlet labelConfig = box.config;\n\t\t\tlet maxBounds = new Rectangle(box.maxBounds.x, box.maxBounds.y, box.maxBounds.width * scale, box.maxBounds.height * scale);\n\t\t\tlet pos = DomUtils.getCenterPosition(refEl, container);\n\t\t\tpos = [pos[0] + maxBounds.left, pos[1] + maxBounds.top];\n\n\t\t\tif (textEl)\n\t\t\t\ttextEl.style.visibility = 'hidden';\n\n\t\t\tDomUtils.setElement(this.input, null, {\n\t\t\t\tvisibility: 'visible',\n\t\t\t\tleft: pos[0] + \"px\",\n\t\t\t\ttop: pos[1] + \"px\",\n\t\t\t\twidth: maxBounds.width + 'px',\n\t\t\t\theight: maxBounds.height + 'px',\n\t\t\t\t\"font-family\": labelConfig.fontFamily,\n\t\t\t\t\"font-size\": (labelConfig.fontSize * scale) + 'px',\n\t\t\t\t\"font-weight\": (labelConfig.fontStyle & FONT_BOLD) == FONT_BOLD ? 'bold' : 'normal'\n\t\t\t\t/*\"color\": labelConfig.fontColor*/\n\t\t\t});\n\n\t\t\tthis.input.value = box._label;\n\t\t\tthis.input.focus();\n\t\t\tthis.input.select();\n\t\t\tEvents.fire(this, 'editor.start', [this.key]);\n\t\t},\n\n\t\tstop: function(cancel) {\n\t\t\tif (!this.input) return;\n\n\t\t\tcancel = cancel || false;\n\t\t\tif (this.textEl)\n\t\t\t\tthis.textEl.style.visibility = null;\n\n\t\t\tif (!cancel)\n\t\t\t\tEvents.fire(this, 'editor.update', [this.key, this.input.value]);\n\n\t\t\tEvents.fire(this, 'editor.stop', [this.key]);\n\n\t\t\t// remove the input\n\t\t\tthis.input.parentNode.removeChild(this.input);\n\t\t\tdelete this.input;\n\t\t\tdelete this.key;\n\t\t\tdelete this.box;\n\t\t\tdelete this.refEl;\n\t\t\tdelete this.textEl;\n\t\t}\n\t};\n\n\treturn {\n\t\tFONT_BOLD,\n\t\tFONT_ITALIC,\n\t\tFONT_UNDERLINE,\n\t\tFONT_SHADOW,\n\t\tgetStringSize,\n\t\twrap,\n\t\tgetLabelBox,\n\t\tgetLabelBoxForLink,\n\t\trender,\n\t\teditor\n\t};\n})();\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/view/Label.js\n **/","import _ from \"lodash\";\nimport Cell from \"./Cell\";\nimport Rectangle from \"../geometry/Rectangle\";\nimport Link from \"../geometry/Link\";\nimport Label from \"../view/Label\";\nimport Cache from \"../util/Cache\";\n\nclass Edge extends Cell {\n\tconstructor(graph, config = {}, source, target) {\n\t\tif (!config.id) config.id = _.uniqueId('E');\n\t\tsuper(graph, config);\n\n\t\tthis.source = this.target = null;\n\t\tthis.setSource(source, config.sourcePos);\n\t\tthis.setTarget(target, config.targetPos);\n\t}\n\n\tsetSource(node, pos) {\n\t\tthis.setTerminal(node, pos, 'source');\n\t}\n\n\tsetTarget(node, pos) {\n\t\tthis.setTerminal(node, pos, 'target');\n\t}\n\n\t/**\n\t * Internal methods to set either the source or target\n\t */\n\t setTerminal(node, pos, dir) {\n\t\tvar end = dir == 'source' ? this.source : this.target;\n\t\tif (end == node) {\n\t\t\t// simply change the position of the edge.\n\t\t\tif (node)\n\t\t\t\tnode.setEdgeAt(this, pos);\n\t\t} else {\n\t\t\tif (end) {\n\t\t\t\t// first remove the edge from the current end\n\t\t\t\tend.removeEdge(this);\n\t\t\t}\n\n\t\t\tif (node) {\n\t\t\t\tif (dir == 'source')\n\t\t\t\t\tnode.addOutEdge(this, pos);\n\t\t\t\telse\n\t\t\t\t\tnode.addInEdge(this, pos);\n\t\t\t}\n\t\t\tif (dir == 'source')\n\t\t\t\tthis.source = node;\n\t\t\telse\n\t\t\t\tthis.target = node;\n\t\t\t//this.clearPoints();\n\t\t}\n\t}\n\n\tgetLabelBox(key) {\n\t\tvar label = this.prop('label');\n\t\tif (label)\n\t\t\treturn Label.getLabelBoxForLink(label, this.viewProp(key, 'labelConfig'), this.getShape(key));\n\t\treturn null;\n\t}\n\n\t/**\n\t * Return a pair of points as reference to the calculation of start and end points.\n\t */\n\tgetReferencePoints(key) {\n\t\tlet pts = [];\n\t\tif (this.source)\n\t\t\tpts.push(this.source.getShape(key).center);\n\t\telse\n\t\t\tpts.push(this.viewProp(key, 'start'));\n\n\t\tif (this.target)\n\t\t\tpts.push(this.target.getShape(key).center);\n\t\telse\n\t\t\tpts.push(this.viewProp(key, 'end'));\n\n\t\treturn pts;\n\t}\n\n\tgetTerminalVisual(key, orthogonal) {\n\t\tlet refPts = this.getReferencePoints(key);\n\t\tlet terminals = [];\n\n\t\tlet getBound = function(pt) {\n\t\t\treturn new Rectangle(pt.x, pt.y, 3, 3);\n\t\t};\n\n\t\tif (this.source) {\n\t\t\tterminals.push(this.source.getPort(key, this.prop('sourcePort'), refPts[1], orthogonal));\n\t\t} else\n\t\t\tterminals.push({point: refPts[0], direction: Rectangle.getDirection(getBound(refPts[0]), refPts[1], true)});\n\n\t\tif (this.target) {\n\t\t\tterminals.push(this.target.getPort(key, this.prop('targetPort'), refPts[0], orthogonal));\n\t\t} else\n\t\t\tterminals.push({point: refPts[1], direction: Rectangle.getDirection(getBound(refPts[1]), refPts[0], true)});\n\t\treturn terminals;\n\t}\n\n\tgetShape(key) {\n\t\tlet shape = Cache.get(this.id + \".shape\", key);\n\t\tif (shape) return shape;\n\n\t\tlet config = this.viewProp(key, 'shape');\n\t\tshape = Link.getLink(this.getTerminalVisual(key, config.orthogonal), config, this.prop('startMarker'), this.prop('endMarker'));\n\t\tCache.set(this.id + '.shape', shape, key);\n\t\treturn shape;\n\t}\n\n\ttoString() {\n\t\treturn 'Edge:{' + (!this.source ? 'null' : this.source.id) + '--' + (!this.target ? 'null' : this.target.id) + '}';\n\t}\n\n\tdestroy() {\n\t\tsuper.destroy();\n\t\tthis.setSource(null);\n\t\tthis.setTarget(null);\n\t}\n}\nEdge.namespace = \"Edges\";\n\nexport default Edge;\n\n/*\n\nEdge.prototype.isVisible = function() {\n\tif (this.graph.getProperty(\"allowDanglingEdges\")) {\n\t\treturn (this.source ? this.source.isVisible() : true) && (this.target ? this.target.isVisible() : true) && this.getProperty(\"visible\");\n\t} else\n\t\treturn this.source && this.target && this.getProperty('visible') && this.source.isVisible() && this.target.isVisible();\n};\n\n*/\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/graph/Edge.js\n **/","import Rectangle from \"../geometry/Rectangle\";\n\nlet registry = {};\n\nlet Marker = (function() {\n\n\t/** Begin Standard Marker Type **/\n\tfunction arrow(size, source, styles) {\n\t\tvar sign = source ? -1 : 1;\n\t\tvar marker = {\n\t\t\tviewBox: new Rectangle(-5, -5, 10, 10),\n\t\t\tsize: size,\n\t\t\tref: [4*sign, 0],\n\t\t\tfill: styles.color\n\t\t};\n\t\tmarker.shape = {\n\t\t\tname: 'Polygon',\n\t\t\tpoints: [[-2*sign, 0], [-4*sign, 4], [4*sign, 0], [-4*sign, -4]]\n\t\t};\n\t\treturn marker;\n\t}\n\n\tfunction triangle(size, source, styles) {\n\t\tvar sign = source ? -1 : 1;\n\t\tvar marker = {\n\t\t\tviewBox: new Rectangle(-5, -5, 10, 10),\n\t\t\tsize: size,\n\t\t\tref: [4*sign, 0],\n\t\t\tfill: styles.color\n\t\t};\n\t\tmarker.shape = {\n\t\t\tname: 'Polygon',\n\t\t\tpoints: [[-5*sign, -5], [-5*sign, 5], [4*sign, 0]]\n\t\t};\n\t\treturn marker;\n\t}\n\n\tfunction oval(size, source, styles) {\n\t\tvar r = size / 2;\n\t\tvar marker = {\n\t\t\tviewBox: new Rectangle(-r, -r, size, size),\n\t\t\tsize: size,\n\t\t\tref: [0, 0],\n\t\t\tfill: styles.color\n\t\t};\n\t\tmarker.shape = '<ellipse cx=\"0\" cy=\"0\" rx=\"' + r + '\" ry=\"' + r + '\"></ellipse>';\n\t\treturn marker;\n\t}\n\n\tfunction diamond(size, source, styles) {\n\t\tvar sign = source ? -1 : 1;\n\t\tvar marker = {\n\t\t\tviewBox: new Rectangle(-5, -5, 10, 10),\n\t\t\tsize: size,\n\t\t\tref: [4*sign, 0],\n\t\t\tfill: styles.color\n\t\t};\n\t\tmarker.shape = '';\n\t\treturn marker;\n\t}\n\t/** End Standard Marker Type **/\n\tfunction getMarker(config, source) {\n\t\tvar factory = registry[config.type];\n\t\tvar marker = factory(config.size, source, config);\n\t\tmarker.id = config.id;\n\t\treturn marker;\n\t}\n\n\tregistry['arrow'] = arrow;\n\tregistry['triangle'] = triangle;\n\tregistry['oval'] = oval;\n\tregistry['diamond'] = diamond;\n\n\treturn {\n\t\tregistry: registry,\n\t\tgetMarker: getMarker\n\t};\n})();\n\nexport default Marker;\n\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/view/Marker.js\n **/","import _ from \"lodash\";\nimport Utils from \"../util/Utils\";\n\nclass Layout {\n\tconstructor(config={}) {\n\t\tif (config.hasOwnProperty(\"orientation\") && _.isString(config.orientation)) {\n\t\t\tif (config.orientation.toUpperCase() == \"HORIZONTAL\")\n\t\t\t\tconfig.orientation = Layout.HORIZONTAL;\n\t\t\telse\n\t\t\t\tdelete config.orientation;\n\t\t}\n\t\tUtils.initConfig(this, config);\n\t}\n\n\tlayout(root, bounds) {}\n\treset() {}\n\tdestroy() {}\n}\nLayout.VERTICAL = 0;\nLayout.HORIZONTAL = 1;\n\nLayout.DEFAULTS = {\n\torientation: Layout.VERTICAL\n};\n\nexport default Layout;\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/layout/Layout.js\n **/","import Layout from \"./Layout\";\n\nclass FlowLayout extends Layout {\n\tlayout(root, bounds) {\n\t\tvar items;\n\t\tif (!root)\n\t\t\titems = this.owner.childNodes;\n\t\telse if (_.isArray(root))\n\t\t\titems = root;\n\t\telse\n\t\t\titems = root.getLinkedNodes('target');\n\t\tif (!items || items.length == 0) return;\n\n\t\tvar x = 0, y = 0, h = 0, node;\n\t\tvar p1 = 0, p2 = 0;\n\t\tfor (var i = 0; i < items.length; i++) {\n\t\t\tnode = items[i];\n\t\t\tif (x > 0 && x + this.hgap + node.getProperty(\"width\") > bounds.width) {\n\t\t\t\t// create new line\n\t\t\t\ty += h + this.vgap;\n\t\t\t\tx = 0;h = 0;p1 = 0;p2++;\n\t\t\t}\n\t\t\tnode._flPos = [p1, p2];\n\t\t\tnode.moveTo([bounds.x + x, bounds.y + y]);\n\t\t\tx += this.hgap + node.getProperty(\"width\");\n\t\t\tp1++;\n\t\t\th = h < node.getProperty(\"height\") ? node.getProperty(\"height\") : h;\n\t\t}\n\t\tthis.trigger(new Rectangle(bounds.x, bounds.y, bounds.width, y + h));\n\t}\n}\n\nFlowLayout.DEFAULTS = {\n\thgap: 10,\n\tvgap: 10\n};\n\nexport default FlowLayout;\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/layout/FlowLayout.js\n **/","import _ from \"lodash\";\nimport Events from \"bean\";\nimport Utils from \"../util/Utils\";\nimport DomUtils from \"../util/DomUtils\";\nimport Layout from \"../layout/Layout\";\nimport Rectangle from \"../geometry/Rectangle\";\nimport EventDispatcher from \"../event/EventDispatcher\";\nimport GraphBehavior from \"../behavior/GraphBehavior\";\nimport SelectionBehavior from \"../behavior/SelectionBehavior\";\nimport Label from \"./Label\";\n\nclass Renderer {\n\tconstructor(id, container, config = {}, graph = null) {\n\t\tthis.id = id;\n\t\tthis.box = DomUtils.createElement('div', {id: this.id, tabindex: 0, ns: 'graph'}, {overflow: \"hidden\", width: \"100%\", height: \"100%\", position: 'relative'});\n\t\tcontainer.appendChild(this.box);\n\t\tif (config.layout) {\n\t\t\tlet layoutClass = Utils.getConstructor(config.layout.jsClass, Layout);\n\t\t\tthis.layout = new layoutClass(config.layout.config);\n\t\t\tdelete config.layout;\n\t\t}\n\t\tthis.clear = true;\n\t\tthis._translate = [0, 0];\n\t\tthis._scale = 1.0;\n\t\tthis.graph = graph;\n\t\tthis.dispatcher = null;\n\t\tthis.graphBehavior = null;\n\t\tthis.selectionBehavior = null;\n\t\tthis.nodeBehavior = null;\n\t\tthis.edgeBehavior = null;\n\t\tthis.connectionBehavior = null;\n\t\tUtils.initConfig(this, config);\n\n\t\tEvents.on(Label.editor, 'editor.update.*', function(key, value) {\n\t\t\tconsole.log(key + '=' + value);\n\t\t});\n\t}\n\n\tget graph() {\n\t\treturn this._graph;\n\t}\n\n\tset graph(graph) {\n\t\tthis._graph = graph;\n\t\tlet root = graph.currentRoot;\n\t\tif (root) {\n\t\t\tthis._translate = [root.viewProp(this.id, 'x') || 0, root.viewProp(this.id, 'y') || 0];\n\t\t\tthis._scale = root.viewProp(this.id, 'scale') || 1.0;\n\t\t}\n\t}\n\n\tviewport(scaled, viewport) {\n\t\tif (_.isUndefined(scaled) || _.isNull(scaled)) scaled = false;\n\t\tif (!viewport) {\n\t\t\tvar vp = new Rectangle(0, 0, this.box.offsetWidth, this.box.offsetHeight);\n\t\t\tif (scaled)\n\t\t\t\treturn Utils.scale(this.translate, this.scale, vp);\n\t\t\treturn vp;\n\t\t}\n\t\tif (!scaled) viewport = Utils.scale(this.translate, this.scale, viewport);\n\t\tvar w = this.box.offsetWidth;\n\t\tvar scale = w / viewport.width;\n\t\tthis.transform(-viewport.x*scale, -viewport.y*scale, scale);\n\t}\n\n\tget translate() { return this._translate; }\n\tset translate(t) { this.transform(t[0], t[1]); }\n\tget scale() { return this._scale; }\n\tset scale(k) {\n\t\tswitch (k) {\n\t\t\tcase \"in\":\n\t\t\t\tk = this.scale * this.prop(\"zoomFactor\");\n\t\t\t\tbreak;\n\t\t\tcase \"out\":\n\t\t\t\tk = this.scale / this.prop(\"zoomFactor\");\n\t\t\t\tbreak;\n\t\t\tcase \"actual\":\n\t\t\t\tk = 1.0;\n\t\t\t\tbreak;\n\t\t\tcase \"fit\":\n\t\t\t\tvar gridSize = this.prop(\"gridSize\") * 2;\n\n\t\t\t\tvar gBounds = this.getBounds();\n\t\t\t\tvar vBounds = this.viewport();\n\n\t\t\t\tvBounds.width -= gridSize;\n\t\t\t\tvBounds.height -= gridSize;\n\n\t\t\t\t/* Do not zoom more than actual if graph already fits into the bounds */\n\t\t\t\tk = Math.min((vBounds.width / gBounds.width), (vBounds.height /gBounds.height), 1.0);\n\n\t\t\t\t//TODO: Add centering code here or trigger an event for that\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tif (_.isString(k)) k = parseFloat(k);\n\t\t\t\tbreak;\n\t\t}\n\t\tthis.transform(null, null, k);\n\t}\n\n\ttransform(x = null, y = null, scale = null) {\n\t\tlet graph = this.graph;\n\t\tlet root = graph ? graph.currentRoot : null;\n\t\tif (!_.isNull(x)) {\n\t\t\tthis._translate[0] = x;\n\t\t\tif (root)\n\t\t\t\troot.viewProp(this.id, 'x', x);\n\t\t}\n\t\tif (!_.isNull(y)) {\n\t\t\tthis._translate[1] = y;\n\t\t\tif (root)\n\t\t\t\troot.viewProp(this.id, 'y', y);\n\t\t}\n\t\tif (!_.isNull(scale)) {\n\t\t\tthis._scale = scale;\n\t\t\tif (root)\n\t\t\t\troot.viewProp(this.id, 'scale', scale);\n\t\t\t// sync the scale between the dispatcher and the graph\n\t\t\tlet s = this.dispatcher.scale;\n\t\t\tif (s != scale)\n\t\t\t\tthis.dispatcher.scale = scale;\n\t\t}\n\t\tthis.refresh();\n\t}\n\n\trender() {\n\t\tif (!this._graph) return false;\n\t\tif (this.layout)\n\t\t\tthis.layout.layout(this._graph.currentRoot, this.viewport());\n\n\t\tthis.initializeBehaviors();\n\t\treturn true;\n\t}\n\n\trenderLabel(box) {\n\t\treturn this.constructor.renderLabel(box);\n\t}\n\n\trenderLink(shape) {\n\t\treturn this.constructor.renderLink(shape);\n\t}\n\n\trenderMarkers(markers) {\n\t\treturn this.constructor.renderMarkers(markers);\n\t}\n\n\tinitializeBehaviors() {\n\t\t// create the event dispatcher if necessary.\n\t\tif (!this.dispatcher) {\n\t\t\tthis.dispatcher = new EventDispatcher(this.box, [this.prop('minZoom'), this.prop('maxZoom')]);\n\t\t\tlet jsClass;\n\t\t\tif (this.prop('graphBehavior')) {\n\t\t\t\tjsClass = Utils.getConstructor(this.prop('graphBehavior'));\n\t\t\t\tthis.graphBehavior = new jsClass(this);\n\t\t\t}\n\t\t\tif (this.prop('selectionBehavior')) {\n\t\t\t\tjsClass = Utils.getConstructor(this.prop('selectionBehavior'));\n\t\t\t\tthis.selectionBehavior = new jsClass(this);\n\t\t\t}\n\t\t\t/*this.dispatcher.register('mouseup.node.label', function(type, ns, target, pos, event) {\n\t\t\t\tlet node = this._graph.nodes[target.getAttribute('id')];\n\t\t\t\tif (!this.dispatcher.dragging && !node._firstSelection) {\n\t\t\t\t\tLabel._delayEdit = _.delay(() => {\n\t\t\t\t\t\tif (Label._delayEdit) {\n\t\t\t\t\t\t\tdelete Label._delayEdit;\n\t\t\t\t\t\t\tLabel.editor.start(node.id, this.box, node.getLabelBox(this.id), target, event.nsTarget, this.scale);\n\t\t\t\t\t\t}\n\t\t\t\t\t}, 250);\n\t\t\t\t}\n\t\t\t}, this);\n\t\t\tthis.dispatcher.register([/^mousedown/, /^zoom/], function(type, ns, target, pos, event) {\n\t\t\t\tif (!DomUtils.eventFromInput(event)) {\n\t\t\t\t\tLabel.editor.stop();\n\t\t\t\t}\n\t\t\t}, this);*/\n\t\t}\n\t\tthis.dispatcher.start();\n\t}\n\n\trefresh() {}\n\n\t/**\n\t * Get the template for the specified key.\n\t * @param key\n\t * @param config if the template is a function, this config will be passed as the argument.\n\t * @param preprocessor if the template contains preprossing elements, such as #{shape}, the preprocessor will be\n\t * used to render them.\n\t * @returns {*}\n\t */\n\tgetTemplate(key, config, preprocessor) {\n\t\tvar t = this.constructor.TEMPLATES[key];\n\t\tif (t && _.isFunction(t)) {\n\t\t\tt = t(config);\n\t\t}\n\t\t// check if there are any preprocessing tags.\n\t\tif (preprocessor) {\n\t\t\tvar parts = t.match(/(#{[^#]*})/g);\n\t\t\tvar obj = {};\n\t\t\tfor (let part in parts) {\n\t\t\t\tpart = parts[part];\n\t\t\t\tpart = part.substring(2, part.length -1).trim();\n\t\t\t\tobj[part] = preprocessor[_.camelCase('render ' + part)](this);\n\t\t\t}\n\t\t\tt = _.template(t, {interpolate: /#{([\\s\\S]+?)}/g})(obj);\n\t\t}\n\t\treturn t;\n\t}\n\n\treset() {}\n\n\tdestroy() {\n\t\tdelete this._graph;\n\t\tdelete this.layout;\n\t\tif (this.dispatcher) {\n\t\t\tthis.dispatcher.stop();\n\t\t\tdelete this.dispatcher;\n\t\t}\n\t\tthis.box.innerHTML = '';\n\t}\n}\nRenderer.DEFAULTS = {\n\tdefaultClickMode: \"pan\",\n\thideOutline: false,\n\tsingleSelect: true,\n\tdraggable: true,\n\tgridEnabled: false,\n\tguidesEnabled: true,\n\tgridSize: 30,\n\tmaxZoom: 4.0,\n\tminZoom: 0.2,\n\tzoomFactor: 1.2,\n\tmaskOpacity: 0.5,\n\tgraphBehavior: GraphBehavior,\n\tselectionBehavior: SelectionBehavior\n};\n\nexport default Renderer;\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/view/Renderer.js\n **/","/**\n * Created by tong on 6/28/2016.\n */\nimport Behavior from \"./Behavior\";\n\n/**\n * Graph handler handles Panning and Zoom and rubber band selection\n */\nclass GraphBehavior extends Behavior {\n\tconstructor(renderer) {\n\t\tsuper(renderer);\n\t\tlet dispatcher = renderer.dispatcher;\n\t\tlet f = function(type, ns, graph, pos, event) {\n\t\t\t//Cursor.updateCursor(type, ns, graph, event);\n\t\t};\n\t\tdispatcher.register(/^drag.*\\.graph$/, this.handleDrag, this);\n\t\tdispatcher.register(/^zoom/, this.handleZoom, this);\n\t\t//dispatcher.register(['mousedown.graph', 'mouseenter.graph', 'mouseleave.graph'], f);\n\t\tthis.offset = null;\n\t}\n\n\thandleZoom(type, ns, graph, pos, event) {\n\t\tthis.renderer.transform(null, null, event.scale);\n\t}\n\n\thandleDrag(type, ns, graph, pos, event) {\n\t\tif (type == 'dragstart') {\n\t\t\tlet pan = (this.renderer.prop(\"defaultClickMode\") == \"pan\") ^ (event.ctrlKey || event.shiftKey);\n\t\t\tif (!pan) return;\n\t\t\tlet t = this.renderer.translate;\n\t\t\tthis.offset = [t[0] - pos[0], t[1] - pos[1]];\n\t\t\treturn;\n\t\t}\n\t\tif (!this.offset) return;\n\t\tthis.renderer.transform(pos[0] + this.offset[0], pos[1] + this.offset[1]);\n\t\tif (type == 'dragend') {\n\t\t\t//Cursor.updateCursor('mouseup', ns, graph, event);\n\t\t\tdelete this.offset;\n\t\t}\n\t}\n}\n\nexport default GraphBehavior;\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/behavior/GraphBehavior.js\n **/","export default class Behavior {\n\tconstructor(renderer) {\n\t\tthis.renderer = renderer;\n\t}\n\n\tdestroy() {\n\t\tdelete this.renderer;\n\t}\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/behavior/Behavior.js\n **/","import Rectangle from \"../geometry/Rectangle\";\nimport Cell from \"../graph/Cell\";\nimport Behavior from \"./Behavior\";\n\nclass SelectionBehavior extends Behavior {\n\tconstructor(renderer) {\n\t\tsuper(renderer);\n\t\tlet dispatcher = renderer.dispatcher;\n\t\tdispatcher.register('mousedown.*', this.selectCell, this);\n\t\tdispatcher.register('mouseup.*', this.unselectCell, this);\n\t\tdispatcher.register('drag*.graph', this.handleMultiSelect, this);\n\t\t//graph.on(Graph.EVENT_TYPES.SELECTION_CHANGE, this.updateSelections, this);\n\t\tthis.selectedNodes = null;\n\t\tthis.selectedLinks = null;\n\t\tthis.attachedLinks = null;\n\t}\n\n\tupdateSelections() {\n\t\tif (this.selectedNodes)\n\t\t\tthis.selectedNodes.classed('selected', false);\n\t\tif (this.selectedLinks)\n\t\t\tthis.selectedLinks.classed('selected', false);\n\n\t\tthis.selectedNodes = null;\n\t\tthis.selectedLinks = null;\n\t\tthis.attachedLinks = null;\n\n\t\tif (this.graph.selectedVertices && this.graph.selectedVertices.length > 0) {\n\t\t\tthis.selectedNodes = this.graph.renderer.getShapes(this.graph.selectedVertices);\n\t\t\tthis.attachedLinks = this.graph.renderer.getShapes(this.graph.getAttachedEdges());\n\t\t\tthis.selectedNodes.classed('selected', true);\n\t\t}\n\n\t\tif (this.graph.selectedEdges && this.graph.selectedEdges.length > 0) {\n\t\t\tthis.selectedLinks = this.graph.renderer.getShapes(this.graph.selectedEdges);\n\t\t\tthis.selectedLinks.classed('selected', true);\n\t\t}\n\t}\n\n\tselectCell(type, ns, data, pos, event) {\n\t\tvar cell = data == this.graph ? null : data;\n\t\tif (cell && !(cell instanceof Cell)) return;\n\t\tvar toggle = event.ctrlKey || event.shiftKey;\n\t\tif (cell && (cell instanceof Cell)) {\n\t\t\tif (!this.graph.isSelected(cell))\n\t\t\t\tdelete cell._firstSelection;\n\t\t\telse\n\t\t\t\tcell._firstSelection = true;\n\n\t\t\td3.select(event.dataTarget).moveToFront();\n\t\t\tthis.graph.setSelection(cell, toggle);\n\t\t}\n\t}\n\n\tunselectCell(type, ns, data, pos, event) {\n\t\tvar cell = data == this.graph ? null : data;\n\t\tif (cell && !(cell instanceof Cell)) return;\n\t\tvar ctrlKey = event.ctrlKey || event.shiftKey;\n\t\tif (!cell) {\n\t\t\tthis.graph.setSelection(cell, ctrlKey);\n\t\t}\n\t}\n\n\thandleMultiSelect(type, ns, data, pos, event) {\n\t\tpos = util.scale(this.graph, pos);\n\n\t\tif (type == 'dragstart') {\n\t\t\tvar select = (this.graph.getProperty(\"defaultClickMode\") == \"select\") ^ (event.ctrlKey || event.shiftKey);\n\t\t\tif (!select) return;\n\t\t\tthis.startPt = new Point(pos[0], pos[1]);\n\t\t\treturn;\n\t\t}\n\t\tif (!this.startPt) return;\n\t\tvar rect = Rectangle.getBoundingRectangle([new Point(pos[0], pos[1]), this.startPt]);\n\t\tvar renderer = this.graph.renderer;\n\t\tif (!this.rubberband) {\n\t\t\tthis.rubberband = d3.select(renderer.appendNode(renderer.getCellLayer(), {\n\t\t\t\ttemplate: _.template('<g><rect x=\"0\" y=\"0\" width=\"100\" height=\"100\" stroke=\"#000000\" fill=\"none\" stroke-dasharray=\"3 3\"/></g>')\n\t\t\t}, false));\n\t\t}\n\t\tif (type == 'dragend') {\n\t\t\tvar cells = this.graph.getCurrentRoot().children;\n\t\t\t// TODO: Define if we want to select vertexes / edges or both\n\t\t\tcells = _.filter(cells, function (cell) {\n\t\t\t\tvar box = cell.getBounds();\n\t\t\t\tif (rect.contains(box)) {\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t\treturn false;\n\t\t\t});\n\t\t\t// TODO: Set selection\n\t\t\tthis.graph.setSelection(cells, event.ctrlKey);\n\n\t\t\tthis.rubberband.remove();\n\t\t\tdelete this.startPt;\n\t\t\tdelete this.rubberband;\n\t\t\treturn;\n\t\t}\n\t\tthis.rubberband.select(\"rect\").attr({x: rect.x, y: rect.y, width: rect.width, height: rect.height});\n\t}\n\n\tdestroy() {\n\t\tsuper.destroy();\n\t\tdelete this.selectedNodes;\n\t\tdelete this.selectedLinks;\n\t\tdelete this.attachedLinks;\n\t}\n}\n\nexport default SelectionBehavior;\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/behavior/SelectionBehavior.js\n **/","import _ from \"lodash\";\nimport Base64 from \"../util/base64\";\nimport DomUtils from \"../util/DomUtils\";\nimport Renderer from \"./Renderer\";\nimport StringBuffer from \"../util/StringBuffer\";\n\nconst NS = 'http://www.w3.org/2000/svg';\nif (typeof (SVGElement) != \"undefined\") {\n\tvar svg = document.createElementNS(NS, \"svg\");\n\tsvg.innerHTML = '<circle/>';\n\tif (svg.firstChild !== \"[object SVGCircleElement]\") {\n\t\tObject.defineProperties(SVGElement.prototype, {\n\t\t\t\"outerHTML\": {\n\t\t\t\tenumerable: false,\n\t\t\t\tconfigurable: true,\n\t\t\t\tget: function() {\n\t\t\t\t\tvar $node, $temp;\n\t\t\t\t\t$temp = document.createElement('div');\n\t\t\t\t\t$node = this.cloneNode(true);\n\t\t\t\t\t$temp.appendChild($node);\n\t\t\t\t\treturn $temp.innerHTML;\n\t\t\t\t}\n\t\t\t},\n\t\t\t\"innerHTML\": {\n\t\t\t\tenumerable: false,\n\t\t\t\tconfigurable: true,\n\t\t\t\tget: function() {\n\t\t\t\t\tvar s = this.outerHTML;\n\t\t\t\t\tvar ropen = new RegExp(\"<\" + this.nodeName + '\\\\b(?:([\"\\'])[^\"]*?(\\\\1)|[^>])*>', \"i\");\n\t\t\t\t\tvar rclose = new RegExp(\"<\\/\" + this.nodeName + \">$\", \"i\");\n\t\t\t\t\treturn  s.replace(ropen, \"\").replace(rclose, \"\");\n\t\t\t\t},\n\t\t\t\tset: function(markup) {\n\t\t\t\t\t// empty el first.\n\t\t\t\t\tlet child;\n\t\t\t\t\twhile (child = this.lastChild)\n\t\t\t\t\t\tthis.removeChild(child);\n\t\t\t\t\tlet buf = new StringBuffer();\n\t\t\t\t\tbuf.append('<svg>').append(markup).append('</svg');\n\t\t\t\t\tlet $temp = DomUtils.createElement('div', null, null, buf.toString()).firstElementChild;\n\t\t\t\t\twhile ($temp.firstChild)\n\t\t\t\t\t\tthis.appendChild($temp.firstChild);\n\t\t\t\t}\n\t\t\t}\n\t\t})\n\t}\n\t// Define the toDataURL for SVG\n\tSVGElement.prototype.toDataURL = function(type, options = {}) {\n\t\tlet _svg = this;\n\n\t\tlet debug = function(msg) {};\n\n\t\tif (options['debug'] == true && typeof(console) != 'undefined')\n\t\t\tdebug = function(msg) { console.log(\"SVG.toDataURL:\", msg); };\n\n\t\tfunction exportSVG() {\n\t\t\tvar svg_xml = _svg.outerHTML;\n\t\t\tvar svg_dataurl = base64dataURLencode(svg_xml);\n\t\t\tdebug(type + \" length: \" + svg_dataurl.length);\n\n\t\t\t// NOTE double data carrier\n\t\t\tif (options.callback) options.callback(svg_dataurl);\n\t\t\treturn svg_dataurl;\n\t\t}\n\n\t\tfunction base64dataURLencode(s) {\n\t\t\tvar b64 = \"data:image/svg+xml;base64,\";\n\n\t\t\t// https://developer.mozilla.org/en/DOM/window.btoa\n\t\t\tif (window.btoa) {\n\t\t\t\tdebug(\"using window.btoa for base64 encoding\");\n\t\t\t\tb64 += btoa(s);\n\t\t\t} else {\n\t\t\t\tdebug(\"using custom base64 encoder\");\n\t\t\t\tb64 += Base64.encode(s);\n\t\t\t}\n\n\t\t\treturn b64;\n\t\t}\n\n\t\t// Native export doesn't work very well. should use canvg instead.\n\t\tfunction exportImage(type) {\n\t\t\tvar canvas = document.createElement(\"canvas\");\n\t\t\tvar ctx = canvas.getContext('2d');\n\n\t\t\t// TODO: if (options.keepOutsideViewport), do some translation magic?\n\n\t\t\tvar svg_img = new Image();\n\t\t\tvar svg_xml = _svg.outerHTML;\n\t\t\tsvg_img.src = base64dataURLencode(svg_xml);\n\n\t\t\tsvg_img.onload = function() {\n\t\t\t\tdebug(\"exported image size: \" + [svg_img.width, svg_img.height]);\n\t\t\t\tcanvas.width = svg_img.width;\n\t\t\t\tcanvas.height = svg_img.height;\n\t\t\t\tctx.drawImage(svg_img, 0, 0);\n\n\t\t\t\t// SECURITY_ERR WILL HAPPEN NOW\n\t\t\t\tvar image_dataurl = canvas.toDataURL(type);\n\t\t\t\tdebug(type + \" length: \" + image_dataurl.length);\n\n\t\t\t\tif (options.callback) options.callback( image_dataurl );\n\t\t\t\telse debug(\"WARNING: no callback set, so nothing happens.\");\n\t\t\t};\n\n\t\t\tsvg_img.onerror = function() {\n\t\t\t\tdebug(\n\t\t\t\t\t\"Can't export! Maybe your browser doesn't support \" +\n\t\t\t\t\t\"SVG in img element or SVG input for Canvas drawImage?\\n\" +\n\t\t\t\t\t\"http://en.wikipedia.org/wiki/SVG#Native_support\"\n\t\t\t\t);\n\t\t\t};\n\n\t\t\t// NOTE: will not return anything\n\t\t}\n\n\t\tfunction exportImageCanvg(type) {\n\t\t\tif (!canvg) return null;\n\t\t\tlet canvas = DomUtils.createElement('canvas', null, {display: \"none\"});\n\t\t\tdocument.body.appendChild(canvas);\n\t\t\tif (type == 'javascript') {\n\t\t\t\tvar xcanvas = new jsCanvas ('jscanvastest');\n\t\t\t\txcanvas.canvas.style.display = 'none';\n\t\t\t\t//xcanvas.canvas = canvas;\n\t\t\t}\n\n\t\t\tif (!options.keepOutsideViewport) {\n\t\t\t\tcanvg(canvas, _svg.outerHTML);\n\t\t\t} else {\n\t\t\t\tlet padding = options.padding || 0;\n\t\t\t\tlet scale = 1.0;\n\t\t\t\tlet translate = [0, 0];\n\t\t\t\tlet bbox = _svg.getBBox();\n\t\t\t\tdebug(\"detected svg dimensions \" + [bbox.x, bbox.y, bbox.width, bbox.height]);\n\t\t\t\tlet transform = _svg.firstElementChild.getAttribute('transform');\n\t\t\t\tif (transform) {\n\t\t\t\t\tdebug('detected svg transform ' + transform);\n\t\t\t\t\ttransform = SVGRenderer.transform(transform);\n\t\t\t\t\ttranslate = transform.translate;\n\t\t\t\t\tscale = transform.scale;\n\t\t\t\t}\n\t\t\t\tlet buf = new StringBuffer();\n\t\t\t\tbuf.append('<svg width=\"').append(bbox.width + 2*padding).append('px\" height=\"').append(bbox.height + 2*padding).append('px\"><g transform=\"translate(')\n\t\t\t\t\t.append(-bbox.x+translate[0]+padding).append(',').append(-bbox.y+translate[1]+padding).append(')scale(').append(scale).append(')\">')\n\t\t\t\t\t.append(_svg.firstElementChild.innerHTML).append('</g></svg>');\n\t\t\t\tif (type == 'javascript') {\n\t\t\t\t\txcanvas.compile(buf.toString(), function () {\n\t\t\t\t\t\tif (options.callback) options.callback(xcanvas.toString());\n\t\t\t\t\t});\n\t\t\t\t\treturn;\n\t\t\t\t} else\n\t\t\t\t\tcanvg(canvas, buf.toString());\n\t\t\t}\n\t\t\tvar image_dataurl = canvas.toDataURL(type);\n\t\t\tif (options.callback) options.callback( image_dataurl );\n\t\t\tcanvas.parentNode.removeChild(canvas);\n\t\t\treturn image_dataurl;\n\t\t}\n\n\t\tif (!type) type = \"image/svg+xml\";\n\n\t\tif (options.keepNonSafe) debug(\"NOTE: keepNonSafe is NOT supported and will be ignored!\");\n\t\tif (options.keepOutsideViewport) debug(\"NOTE: keepOutsideViewport is only supported with canvg exporter.\");\n\n\t\tswitch (type) {\n\t\t\tcase \"image/svg+xml\":\n\t\t\t\treturn exportSVG();\n\t\t\tcase \"image/png\":\n\t\t\tcase \"image/jpeg\":\n\t\t\tcase \"javascript\":\n\t\t\t\tif (!options.renderer) {\n\t\t\t\t\tif (window.canvg) options.renderer = \"canvg\";\n\t\t\t\t\telse options.renderer=\"native\";\n\t\t\t\t}\n\t\t\t\tswitch (options.renderer) {\n\t\t\t\t\tcase \"canvg\":\n\t\t\t\t\t\tdebug(\"using canvg renderer for \" + type + \" image export\");\n\t\t\t\t\t\treturn exportImageCanvg(type);\n\t\t\t\t\tcase \"native\":\n\t\t\t\t\t\tdebug(\"using native renderer for \" + type + \" export. THIS MIGHT FAIL.\");\n\t\t\t\t\t\treturn exportImage(type);\n\t\t\t\t\tdefault:\n\t\t\t\t\t\tdebug(\"unknown image renderer given, doing noting (\" + options.renderer + \")\");\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tdebug(\"Sorry! Exporting as '\" + type + \"' is not supported!\");\n\t\t}\n\t\treturn null;\n\t}\n}\n\nclass SVGRenderer extends Renderer {\n\trender() {\n\t\tlet result = super.render();\n\t\tif (result) {\n\t\t\tlet root = this.graph.currentRoot;\n\t\t\tlet buf = new StringBuffer('<svg width=\"100%\" height=\"100%\" xmlns=\"http://www.w3.org/2000/svg\">');\n\t\t\tlet t = this.translate;\n\t\t\tbuf.append('<g transform=\"translate(').append(t[0]).append(',').append(t[1]).append(')scale(').append(this.scale).append(')\">');\n\t\t\tbuf.append(this.renderDefs());\n\t\t\tbuf.append(root.render(this));\n\t\t\tbuf.append('</g></svg>');\n\t\t\tthis.box.innerHTML = buf.toString();\n\t\t\tthis.svg = this.box.firstElementChild;\n\t\t}\n\t}\n\n\trenderDefs() {\n\t\tlet buf = new StringBuffer('<defs>');\n\t\tbuf.append(this.getTemplate('Grid', this.prop(\"gridSize\")));\n\t\tlet markers = this.graph.markers;\n\t\tif (markers.length > 0)\n\t\t\tbuf.append(SVGRenderer.renderMarkers(markers));\n\t\tbuf.append('</defs>');\n\t\treturn buf.toString();\n\t}\n\n\trefresh() {\n\t\tif (!this.svg) return;\n\t\tlet g = this.svg.querySelector('g');\n\t\tlet t = this.translate;\n\t\tg.setAttribute('transform', 'translate(' + t[0] + ',' + t[1] + ')scale(' + this.scale + ')');\n\t}\n\n\tstatic renderMarkers(markers) {\n\t\tlet buf = new StringBuffer(), str1, str2;\n\t\tmarkers.forEach(function(marker) {\n\t\t\tstr1 = this.TEMPLATES['Marker'](marker);\n\t\t\tstr2 = marker.shape;\n\t\t\tif (!_.isString(str2))\n\t\t\t\tstr2 = this.renderShape(str2);\n\t\t\tstr1 = str1.replace(/\\#\\{shape\\}/, str2);\n\t\t\tbuf.append(str1);\n\t\t}, this);\n\t\treturn buf.toString();\n\t}\n\n\tstatic renderLabel(box) {\n\t\treturn this.TEMPLATES['Label'](box);\n\t}\n\n\tstatic renderShape(shape) {\n\t\tlet template = this.TEMPLATES[shape.name];\n\t\tif (_.isString(template))\n\t\t\ttemplate = _.template(template);\n\t\treturn template(shape);\n\t}\n\n\tstatic getPathData(shape) {\n\t\tlet points = shape.points;\n\t\tlet controlPts = shape.controlPts;\n\t\tif (!points || points.length == 0) return '';\n\n\t\tif (!controlPts && shape.round) {\n\t\t\t// render rounded line joins.\n\t\t\tlet newPts = [];\n\t\t\tcontrolPts = [];\n\t\t\tlet prev = points[0], next, d1, d2, corner;\n\t\t\tnewPts.push(prev);\n\t\t\tfor (let i = 1; i < points.length - 1; i++) {\n\t\t\t\tnext = points[i];\n\t\t\t\t// set the control point first.\n\t\t\t\tcontrolPts[2*i] = [next, next];\n\t\t\t\t// check the size of the corner.\n\t\t\t\td1 = prev.distance(next);\n\t\t\t\td2 = next.distance(points[i+1]);\n\t\t\t\tcorner = Math.min(shape.round, d1/2, d2/2);\n\t\t\t\t// split the point into two.\n\t\t\t\tnewPts.push(next.getDirection(prev).scale(corner).translate(next));\n\t\t\t\tnewPts.push(next.getDirection(points[i+1]).scale(corner).translate(next));\n\t\t\t\tprev = next;\n\t\t\t}\n\t\t\tnewPts.push(points[points.length - 1]);\n\t\t\tpoints = newPts;\n\t\t}\n\t\tlet buf = new StringBuffer('M'), point;\n\t\tfor (let i = 0; i < points.length; i++) {\n\t\t\tpoint = points[i];\n\t\t\tif (i == 0)\n\t\t\t\tbuf.append(point);\n\t\t\telse {\n\t\t\t\tif (controlPts && controlPts[i]) {\n\t\t\t\t\tbuf.append(' C ');\n\t\t\t\t\tfor (let j = 0; j < controlPts[i].length; j++)\n\t\t\t\t\t\tbuf.append(controlPts[i][j]).append(' ');\n\t\t\t\t\tbuf.append(point);\n\t\t\t\t} else\n\t\t\t\t\tbuf.append(' L ').append(point);\n\t\t\t}\n\t\t}\n\t\treturn buf.toString();\n\t}\n\n\tstatic renderLink(shape) {\n\t\tlet buf = new StringBuffer();\n\t\tlet d = SVGRenderer.getPathData(shape);\n\t\tif (shape.showGauge)\n\t\t\tbuf.append('<path style=\"stroke: white; stroke-width: 9; visibility: hidden; pointer-events: stroke;\" d=\"')\n\t\t\t\t.append(d).append('\"/>');\n\t\tbuf.append('<path d=\"').append(d).append('\"');\n\t\tif (shape.startMarker || shape.endMarker) {\n\t\t\tbuf.append(' style=\"');\n\t\t\tif (shape.startMarker)\n\t\t\t\tbuf.append('marker-start: url(#').append(_.isString(shape.startMarker) ? shape.startMarker : shape.startMarker.id).append(');');\n\t\t\tif (shape.endMarker)\n\t\t\t\tbuf.append('marker-end: url(#').append(_.isString(shape.endMarker) ? shape.endMarker : shape.endMarker.id).append(');');\n\t\t\tbuf.append('\"');\n\t\t}\n\t\tbuf.append('/>');\n\t\treturn buf.toString();\n\t}\n\n\tstatic appendContent(el, content) {\n\t\tlet buf = new StringBuffer();\n\t\tbuf.append('<svg>').append(content).append('</svg');\n\t\tlet temp = DomUtils.createElement('div', null, null, buf.toString()).firstElementChild;\n\n\t\twhile (temp.firstChild)\n\t\t\tel.appendChild(temp.firstChild);\n\t\treturn el;\n\t}\n\n\tstatic transform(transform) {\n\t\tlet translate = [0, 0], scale = 1.0;\n\t\t//\n\t\tlet parts = transform.match(/translate\\(\\s*([^)]+)/);\n\t\tif (parts) {\n\t\t\tlet m = parts[1].trim().match(/([\\d.-]+)[ ,]([\\d.-]+)/);\n\t\t\tif (m) {\n\t\t\t\ttranslate[0] = parseFloat(m[1]) || 0;\n\t\t\t\ttranslate[1] = parseFloat(m[2]) || 0;\n\t\t\t} else\n\t\t\t\ttranslate[0] = translate[1] = parseFloat(parts[1]);\n\t\t}\n\t\tparts = transform.match(/scale\\(\\s*([^)]+)/);\n\t\tif (parts)\n\t\t\tscale = parseFloat(parts[1]) || 1.0;\n\n\t\treturn {translate, scale};\n\t}\n}\nSVGRenderer.TEMPLATES = {\n\t$root: '<g id=\"${id}\" class=\"${className}\">#{children}</g>',\n\t$node: '<g id=\"${id}\" class=\"${className}\" style=\"${style}\" ns=\"${namespace}\" transform=\"translate(${x},${y})\">#{shape}#{label}</g>',\n\t$edge: '<g id=\"${id}\" class=\"${className}\" style=\"${style}\" ns=\"${namespace}\">#{shape}#{label}</g>',\n\tEllipse: '<ellipse cx=\"0\" cy=\"0\" rx=\"${width/2}\" ry=\"${height/2}\"/>',\n\tRectangle: '<rect x=\"${-width/2}\" y=\"${-height/2}\" width=\"${width}\" height=\"${height}\" rx=\"9\" ry=\"9\"/>',\n\tTriangle: '<polygon points=\"${-width/2},${-height/2} ${width/2},${-height/2} 0,${height/2}\"/>',\n\tRhombus: '<polygon points=\"0,${-height/2} ${width/2},0 0,${height/2} ${-width/2},0\"/>',\n\tHexagon: function(config) {\n\t\tvar vertical = config.direction == 'north' || config.direction == 'south';\n\t\tif (vertical)\n\t\t\treturn '<polygon points=\"0,${-height/2} ${width/2},${-height/4} ${width/2},${height/4} 0,${height/2} ${-width/2},${height/4} ${-width/2},${-height/4}\"/>';\n\t\telse\n\t\t\treturn '<polygon points=\"${-width/2},0 ${width/4},${-height/2} ${width/4},${-height/2} ${width/2},0 ${width/4},${height/2} ${-width/4},${height/2}\"/>';\n\t},\n\tPolygon: function(shape) {\n\t\tlet buf = new StringBuffer('<polygon points=\"');\n\t\tshape.points.forEach(function(pt){\n\t\t\tbuf.append(pt[0]).append(',').append(pt[1]).append(' ');\n\t\t});\n\t\tbuf.removeLast();\n\t\tbuf.append('\"/>');\n\t\treturn buf.toString();\n\t},\n\tImage: function(config) {\n\t\treturn '<image x=\"${-width/2}\" y=\"${-height/2}\" width=\"${width}\" height=\"${height}\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" xlink:href=\"' + config.image + '\"/>';\n\t},\n\tMarker: function(marker) {\n\t\treturn `\n<marker id=\"${marker.id}\" markerWidth=\"${marker.size}\" markerHeight=\"${marker.size}\" refx=\"${marker.ref[0]}\" \nrefy=\"${marker.ref[1]}\" orient=\"auto\" viewbox=\"${marker.viewBox.x} ${marker.viewBox.y} ${marker.viewBox.width} ${marker.viewBox.height}\"\nmarkerUnits=\"userSpaceOnUse\" ${marker.fill ? `style=\"stroke: ${marker.fill};fill:${marker.fill}\"` : ''}>#{shape}</marker>\n`.trim();\n\t},\n\tGrid: function(size) {\n\t\treturn `\n<pattern id=\"GridPattern\" width=\"${size}\" height=\"${size}\" patternUnits=\"userSpaceOnUse\">\n\t<ellipse cx=\"0\" cy=\"0\" rx=\"1\" ry=\"1\" fill=\"#999999\"/>\n\t<ellipse cx=\"0\" cy=\"${size}\" rx=\"1\" ry=\"1\" fill=\"#999999\"/>\n\t<ellipse cx=\"${size}\" cy=\"0\" rx=\"1\" ry=\"1\" fill=\"#999999\"/>\n\t<ellipse cx=\"${size}\" cy=\"${size}\" rx=\"1\" ry=\"1\" fill=\"#999999\"/>\n</pattern>`.trim();\n\t},\n\tLabel: _.template(`\n<% var box = _.has(data, \"dx\") ? data : (data.getLabelBox ? data.getLabelBox() : null); \n   if (box) {%>\n\t<g <% if (box.config && box.config.class) {%>class=\"<%=box.config.class%>\"<%}%>\\\n\t\t<% if (box.config && box.config.ns) {%>ns=\"<%=box.config.ns%>\"<%}%>\\\n\t\t<% if (box.config && box.config.inlineStyle) {%>\\\n\t\t\tfont-size=\"<%=box.config.fontSize%>\"\\\n\t\t\tfont-family=\"<%=box.config.fontFamily%>\"\\\n\t\t\tfont-weight=\"<% if (box.bold) {%>bold<%} else {%>normal<%}%>\"\\\n\t\t\t<% if (box.underline) {%>text-decoration=\"underline\"<%}%>\\\n\t\t\t<% if (box.italic) {%>font-style=\"italic\"<%}%>\\\n\t\t<%}%>\\\n\t\ttext-anchor=\"<%=box.anchor%>\"\\\n\t\ttransform=\"translate(<%=box.bounds.x%>,<%=box.bounds.y%>)<% if (box.config && box.config.rotation) {%>rotate(<%=box.config.rotation%> <%=box.pivot[0]%> <%=box.pivot[1]%>)<%}%>\">\n\t<% if (box.config.backgroundStyle) {%>\n\t\t<rect x=\"<%=-box.bounds.width/2%>\" y=\"<%=-box.bounds.height/2%>\" width=\"<%=box.bounds.width%>\" height=\"<%=box.bounds.height%>\" style=\"<%=box.config.backgroundStyle%>\"/>\n\t<% } if (_.isArray(box.label)) { \n\t\t_.each(box.label, function(value, line) {%>\n\t\t\t<text <% if (box.config && box.config.textStyle) {%>style=\"<%=box.config.textStyle%>\"<%}%>\\\n\t\t\t\tdx=\"<%=box.dx%>\" dy=\"<%=box.dy + box.lineHeight * line%>\"><%=value%></text>\n\t\t<%});} else { %>\n\t\t\t<text><%=box.label%></text>\n\t\t<%}%>\n\t</g>\n<%}%>\n`.trim(), {variable: \"data\"})   //TODO add more inline text styles.\n};\n\nexport default SVGRenderer;\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/view/SVGRenderer.js\n **/"],"sourceRoot":"/source/"}