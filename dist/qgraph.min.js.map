{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","qgraph.js","webpack:/webpack/bootstrap 541429943e0b8e6ecc8f","webpack:///src/index.js","webpack:///src/util/base64.js","webpack:///src/util/Utils.js","webpack:///src/geometry/Point.js","webpack:///src/geometry/Rectangle.js","webpack:/external {\"root\":\"_\",\"commonjs\":\"lodash\",\"commonjs2\":\"lodash\",\"amd\":\"lodash\"}","webpack:///src/geometry/Shape.js","webpack:///src/util/DomUtils.js","webpack:///src/util/StringBuffer.js","webpack:///src/geometry/Line.js","webpack:///src/geometry/Ellipse.js","webpack:///src/geometry/Link.js","webpack:///~/bean/bean.js","webpack:///src/event/EventDispatcher.js","webpack:///src/event/KeyUtils.js","webpack:///src/graph/Graph.js","webpack:///src/graph/Node.js","webpack:///src/graph/Cell.js","webpack:///src/util/Cache.js","webpack:///src/view/Label.js","webpack:///src/graph/Edge.js","webpack:///src/view/Marker.js","webpack:///src/layout/Layout.js","webpack:///src/layout/FlowLayout.js","webpack:///src/view/Renderer.js","webpack:///src/behavior/GraphBehavior.js","webpack:///src/behavior/Behavior.js","webpack:///src/behavior/SelectionBehavior.js","webpack:///src/view/SVGRenderer.js"],"names":["root","factory","exports","module","require","define","amd","this","__WEBPACK_EXTERNAL_MODULE_5__","modules","__webpack_require__","moduleId","installedModules","id","loaded","call","m","c","p","_interopRequireDefault","obj","__esModule","default","Object","defineProperty","value","_base","_base2","_Utils","_Utils2","_DomUtils","_DomUtils2","_StringBuffer","_StringBuffer2","_Point","_Point2","_Line","_Line2","_Shape","_Shape2","_Rectangle","_Rectangle2","_Ellipse","_Ellipse2","_Link","_Link2","_bean","_bean2","_EventDispatcher","_EventDispatcher2","_Graph","_Graph2","_Cell","_Cell2","_Node","_Node2","_Edge","_Edge2","_Layout","_Layout2","_FlowLayout","_FlowLayout2","_Label","_Label2","_Marker","_Marker2","_Renderer","_Renderer2","_SVGRenderer","_SVGRenderer2","_GraphBehavior","_GraphBehavior2","_SelectionBehavior","_SelectionBehavior2","addShape","Events","Base64","Cache","Utils","DomUtils","StringBuffer","Point","Line","Shape","Rectangle","Ellipse","Link","EventDispatcher","Label","Marker","Graph","Cell","Node","Edge","Layout","FlowLayout","Renderer","SVGRenderer","GraphBehavior","SelectionBehavior","_keyStr","encode","input","chr1","chr2","chr3","enc1","enc2","enc3","enc4","output","i","_utf8_encode","length","charCodeAt","isNaN","charAt","decode","replace","indexOf","String","fromCharCode","_utf8_decode","string","utftext","n","c1","c2","c3","global","_classCallCheck","instance","Constructor","TypeError","_possibleConstructorReturn","self","ReferenceError","_inherits","subClass","superClass","prototype","create","constructor","enumerable","writable","configurable","setPrototypeOf","__proto__","window","addEventHandler","document","navigator","_debugging","_debugAll","typeRegistry","splice","Array","type","namespace","name","Map","set","get","createType","props","defaultType","extend","getPrototypeOf","apply","arguments","_extend","config","_","assign","typeName","log","buildTypes","types","_this2","remove","defaultsDeep","forEach","child","parent","protoProps","staticProps","Surrogate","superclass","initConfig","cArr","DEFAULTS","prop","getConstructor","jsClass","defaultClass","isString","eval","debug","moduleName","push","message","console","substring","info","getRelativePosition","bounds","geometry","x","Math","abs","width","y","height","offsetPosition","pos","anchorX","offsetX","anchorY","offsetY","unscale","t","scale","o","getProperty","has","isFunction","_createClass","defineProperties","target","descriptor","key","aPt","sqrt","p2","dist","distance","angle","cos","PI","sin","clone","rotate","rect","vertical","W","N","S","E","NE","NW","SE","SW","_lodash","_lodash2","_Shape3","el","w","h","left","right","top","bottom","pt","contains","pt1","pt2","horizontal","contains1","contains2","outPt","orthogonal","undefined","dx","dy","alpha","atan2","pi","pi2","beta","tan","dir","getDirection","point","direction","pts","margin","isArray","min","max","rects","minx","miny","maxx","Infinity","maxy","each","r","registry","defaults","refPt","getPerimeter","view","template","getTemplate","isIE","sAgent","userAgent","Idx","parseInt","match","isFireFox","InstallTrigger","isChrome","raw","isMac","platform","toUpperCase","isWindows","appVersion","isLinux","createElement","tag","attribs","styles","html","setElement","innerHTML","createElementByString","str","temp","childNodes","setAttribute","style","testElement","node","method","nodeType","getAncestorBy","parentNode","getPosition","context","body","elRect","getBoundingClientRect","contextRect","getCenterPosition","move","getSize","offsetWidth","offsetHeight","resize","preloadImages","array","list","img","that","Image","onload","index","src","getImageInfo","downloadFile","data","mime","split","encoded","atob","decodeURI","GetBlob","msSaveBlob","link","href","download","display","appendChild","click","removeChild","contentType","sliceSize","byteArrays","offset","slice","byteNumbers","byteArray","Uint8Array","Blob","openImage","image","myWindow","open","myDocument","eventFromInput","e","tagName","buffer","stuff","concat","pop","sep","join","start","end","l","cosa","dotProduct","x0","y0","x1","y1","x2","y2","x3","y3","denom","nume_a","nume_b","ua","ub","intersectionX","intersectionY","a","b","cx","cy","px","py","d","f","g","det","xout1","xout2","yout1","yout2","dist1","pow","dist2","xout","yout","defaultConfig","showGauge","defaultGeometry","linkTypes","terminalVisual","shapeConfig","startMarker","endMarker","startNormal","endNormal","renderLink","isNumber","points","translate","getScaled","linkClass","DirectLink","BezierLink","ctrlpts","controlPts","p1","p3","p4","s","EntityRelations","_Link3","source","Port","getBounds","edge","isSourceLeft","isTargetLeft","result","getCenterY","xe","ye","seg","segment","dep","arr","midY","Manhattan","_Link4","MIN_BUFFER","autoRoute","randomNoise","step","maxChannelWidth","container","boxes","startBox","endBox","side","side2","box","intersect","j","channel","channel2","endPadding","startPadding","_getChannel","_getFirstIntersection","_getRouteTendency","_hasIntersection","_moveSegment","breakPt","_getRouteDirection","getCenter","box2","box1","getLeft","getRight","getBottom","getTop","getTranslated","route","_mergeSegments","getCommonAncestor","getDescendants","excludeFromRouting","isAncestor","range","randomNumber","floor","random","startBufferNormal","endBufferNormal","startBuffer","endBuffer","middle","prunePts","detectIntersection","savedIndex","savedSide","h2","h1","equals","__WEBPACK_AMD_DEFINE_FACTORY__","__WEBPACK_AMD_DEFINE_RESULT__","definition","selectorEngine","win","old","namespaceRegex","nameRegex","addEvent","removeEvent","doc","documentElement","W3C_MODEL","eventSupport","ONE","str2arr","standardNativeEvents","w3cNativeEvents","nativeEvents","hash","events","customEvents","element","compareDocumentPosition","check","event","related","relatedTarget","prefix","test","toString","mouseenter","base","condition","mouseleave","mousewheel","Event","commonProps","mouseProps","mouseWheelProps","keyProps","textProps","touchProps","messageProps","stateProps","overOutRegex","typeFixers","reg","fix","newEvent","keyCode","which","rightClick","button","pageX","pageY","clientX","clientY","scrollLeft","scrollTop","typeFixerMap","isNative","ownerDocument","parentWindow","originalEvent","isBean","fixer","srcElement","preventDefault","returnValue","stopPropagation","cancelBubble","stop","stopped","stopImmediatePropagation","isImmediatePropagationStopped","currentTarget","ne","targetElement","RegEntry","wrappedHandler","fn","args","eargs","findTarget","eventElement","__beanDel","ft","handler","original","namespaces","customType","once","removeListener","eventType","inNamespaces","checkNamespaces","matches","checkElement","checkOriginal","checkHandler","map","forAll","pfx","all","substr","entries","entry","put","del","removed","setSelectorEngine","querySelectorAll","Error","rootListener","propertyName","listeners","listener","add","custom","attachEvent","detachEvent","rm","originalFn","orgType","handlers","delegate","selector","fireListener","evt","createEvent","dispatchEvent","fireEvent","createEventObject","off","typeSpec","k","isTypeStr","hasOwnProperty","on","first","delfn","one","fire","names","from","beanDel","bean","noConflict","cleanup","CollectGarbage","_interopRequireWildcard","newObj","_KeyUtils","KeyUtils","zoomScale","rootNS","getAttribute","dragging","bind","handleEvent","started","enterStack","startKeys","stopKeys","buf","ns","stack","isRoot","startsWith","rootTarget","nsTarget","prepend","targetStack","_this","isKeyEvent","getKeyEvent","getEventInfo","wheelDelta","dragObject","mouse","dragPos","mousemove","currentPos","dispatch","mouseup","simulateEnterLeave","last","clearEnterStack","getNS","val","append","item","nsType","regexp","callback","lastPosition","_this3","registerKey","getKeyData","ctrl","alt","shift","meta","code","_this4","unregisterKey","zIndex","_this5","register","RegExp","registeredType","changedTouches","svg","ownerSVGElement","createSVGPoint","matrixTransform","getScreenCTM","inverse","clientLeft","clientTop","KeyboardEvent","ctrlKey","altKey","shiftKey","metaKey","nodeDefaults","role","draggable","selectable","editable","resizable","sourceable","targetable","visible","edgeDefaults","size","color","uniqueId","model","nodes","edges","selection","destroyed","nodeTypes","edgeTypes","markers","marker","markerConfig","getMarker","loadModel","currentRoot","NodeClass","getJSClass","addChild","to","EdgeClass","addNode","addEdge","children","without","allowDanglingEdges","multiConnect","readOnly","viewOnly","_typeof","Symbol","iterator","_Cell3","graph","inEdges","outEdges","ports","_ret","render","v","portName","endPt","shape","getShape","label","_Cache","_Cache2","decorators","createDecorators","views","viewProps","isUndefined","className","computedClassName","viewProp","shapeClass","getView","getLabelBox","renderLabel","_computedClassName","caches","getCache","clear","namesapce","FONT_BOLD","FONT_ITALIC","FONT_UNDERLINE","FONT_SHADOW","fontSize","fontFamily","fontStyle","fontColor","padding","linePadding","align","rotation","labelConfig","containerWidth","containerHeight","_getLabelBox","getLabelBoxForLink","bold","wrappedLabel","anchor","wrap","setAnchorX","underline","italic","pivot","maxBounds","shadow","lineHeight","baseline","editor","stringMeasureEl","measureDiv","baselineDiv","getStringSize","memoize","position","visibility","contentWindow","write","close","firstChild","fontWeight","baselineHeight","strut","offsetTop","maxWidth","spaceSize","space","line","lines","word","wordWidth","newLine","words","currentWidth","refEl","textEl","singleLine","unselectable","overflow","border","font-family","font-size","font-weight","_label","focus","select","cancel","_get","object","property","receiver","Function","desc","getOwnPropertyDescriptor","getter","setSource","sourcePos","setTarget","targetPos","setTerminal","setEdgeAt","addOutEdge","addInEdge","center","terminals","getBound","getReferencePoints","getPort","refPts","getLink","getTerminalVisual","arrow","viewBox","ref","fill","sign","triangle","oval","diamond","orientation","HORIZONTAL","VERTICAL","_Layout3","items","getLinkedNodes","owner","_flPos","moveTo","hgap","trigger","vgap","layoutClass","layout","_translate","dispatcher","graphBehavior","selectionBehavior","nodeBehavior","edgeBehavior","connectionBehavior","vp","scaled","_viewport","isNull","viewport","transform","_scale","refresh","initializeBehaviors","_graph","renderMarkers","preprocessor","TEMPLATES","parts","part","interpolate","camelCase","gridSize","gBounds","vBounds","parseFloat","singleSelect","gridEnabled","guidesEnabled","maxZoom","minZoom","zoomFactor","maskOpacity","_Behavior2","_Behavior3","renderer","handleDrag","handleZoom","_Behavior","pan","Behavior","selectCell","selectedNodes","unselectCell","selectedLinks","handleMultiSelect","attachedLinks","classed","selectedVertices","getShapes","getAttachedEdges","selectedEdges","cell","toggle","setSelection","_firstSelection","d3","dataTarget","moveToFront","startPt","rubberband","getCellLayer","cells","appendNode","filter","attr","SVGElement","_Renderer3","$temp","$node","cloneNode","rclose","ropen","nodeName","markup","firstElementChild","_svg","toDataURL","svg_xml","outerHTML","svg_dataurl","base64dataURLencode","options","btoa","b64","exportImage","canvas","ctx","getContext","svg_img","drawImage","image_dataurl","onerror","xcanvas","jsCanvas","bbox","getBBox","compile","canvg","msg","exportSVG","keepOutsideViewport","keepNonSafe","exportImageCanvg","querySelector","str1","str2","renderShape","round","next","d2","corner","newPts","prev","d1","_i","content","_transform","$root","$edge","Triangle","Rhombus","Hexagon","Polygon","removeLast","Grid","trim","variable"],"mappings":"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","file":"qgraph.min.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory(require(\"lodash\"));\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([\"lodash\"], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"qgraph\"] = factory(require(\"lodash\"));\n\telse\n\t\troot[\"qgraph\"] = factory(root[\"_\"]);\n})(this, function(__WEBPACK_EXTERNAL_MODULE_5__) {\nreturn \n\n\n/** WEBPACK FOOTER **\n ** webpack/universalModuleDefinition\n **/","/*!\n * \n * \tqgraph - A Graph Manipulation and Visualization Library\n * \tAuthor: Tong Zou\n * \tVersion: v0.1.3\n * \tUrl: https://github.com/tongzou/qgraph\n * \tLicense(s): MIT\n * \n */\n(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory(require(\"lodash\"));\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([\"lodash\"], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"qgraph\"] = factory(require(\"lodash\"));\n\telse\n\t\troot[\"qgraph\"] = factory(root[\"_\"]);\n})(this, function(__WEBPACK_EXTERNAL_MODULE_5__) {\nreturn /******/ (function(modules) { // webpackBootstrap\n/******/ \t// The module cache\n/******/ \tvar installedModules = {};\n/******/\n/******/ \t// The require function\n/******/ \tfunction __webpack_require__(moduleId) {\n/******/\n/******/ \t\t// Check if module is in cache\n/******/ \t\tif(installedModules[moduleId])\n/******/ \t\t\treturn installedModules[moduleId].exports;\n/******/\n/******/ \t\t// Create a new module (and put it into the cache)\n/******/ \t\tvar module = installedModules[moduleId] = {\n/******/ \t\t\texports: {},\n/******/ \t\t\tid: moduleId,\n/******/ \t\t\tloaded: false\n/******/ \t\t};\n/******/\n/******/ \t\t// Execute the module function\n/******/ \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n/******/\n/******/ \t\t// Flag the module as loaded\n/******/ \t\tmodule.loaded = true;\n/******/\n/******/ \t\t// Return the exports of the module\n/******/ \t\treturn module.exports;\n/******/ \t}\n/******/\n/******/\n/******/ \t// expose the modules object (__webpack_modules__)\n/******/ \t__webpack_require__.m = modules;\n/******/\n/******/ \t// expose the module cache\n/******/ \t__webpack_require__.c = installedModules;\n/******/\n/******/ \t// __webpack_public_path__\n/******/ \t__webpack_require__.p = \"\";\n/******/\n/******/ \t// Load entry module and return exports\n/******/ \treturn __webpack_require__(0);\n/******/ })\n/************************************************************************/\n/******/ ([\n/* 0 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t\tvalue: true\n\t});\n\t\n\tvar _base = __webpack_require__(1);\n\t\n\tvar _base2 = _interopRequireDefault(_base);\n\t\n\tvar _Utils = __webpack_require__(2);\n\t\n\tvar _Utils2 = _interopRequireDefault(_Utils);\n\t\n\tvar _DomUtils = __webpack_require__(7);\n\t\n\tvar _DomUtils2 = _interopRequireDefault(_DomUtils);\n\t\n\tvar _StringBuffer = __webpack_require__(8);\n\t\n\tvar _StringBuffer2 = _interopRequireDefault(_StringBuffer);\n\t\n\tvar _Point = __webpack_require__(3);\n\t\n\tvar _Point2 = _interopRequireDefault(_Point);\n\t\n\tvar _Line = __webpack_require__(9);\n\t\n\tvar _Line2 = _interopRequireDefault(_Line);\n\t\n\tvar _Shape = __webpack_require__(6);\n\t\n\tvar _Shape2 = _interopRequireDefault(_Shape);\n\t\n\tvar _Rectangle = __webpack_require__(4);\n\t\n\tvar _Rectangle2 = _interopRequireDefault(_Rectangle);\n\t\n\tvar _Ellipse = __webpack_require__(10);\n\t\n\tvar _Ellipse2 = _interopRequireDefault(_Ellipse);\n\t\n\tvar _Link = __webpack_require__(11);\n\t\n\tvar _Link2 = _interopRequireDefault(_Link);\n\t\n\tvar _bean = __webpack_require__(12);\n\t\n\tvar _bean2 = _interopRequireDefault(_bean);\n\t\n\tvar _EventDispatcher = __webpack_require__(13);\n\t\n\tvar _EventDispatcher2 = _interopRequireDefault(_EventDispatcher);\n\t\n\tvar _Graph = __webpack_require__(15);\n\t\n\tvar _Graph2 = _interopRequireDefault(_Graph);\n\t\n\tvar _Cell = __webpack_require__(17);\n\t\n\tvar _Cell2 = _interopRequireDefault(_Cell);\n\t\n\tvar _Node = __webpack_require__(16);\n\t\n\tvar _Node2 = _interopRequireDefault(_Node);\n\t\n\tvar _Edge = __webpack_require__(20);\n\t\n\tvar _Edge2 = _interopRequireDefault(_Edge);\n\t\n\tvar _Layout = __webpack_require__(22);\n\t\n\tvar _Layout2 = _interopRequireDefault(_Layout);\n\t\n\tvar _FlowLayout = __webpack_require__(23);\n\t\n\tvar _FlowLayout2 = _interopRequireDefault(_FlowLayout);\n\t\n\tvar _Label = __webpack_require__(19);\n\t\n\tvar _Label2 = _interopRequireDefault(_Label);\n\t\n\tvar _Marker = __webpack_require__(21);\n\t\n\tvar _Marker2 = _interopRequireDefault(_Marker);\n\t\n\tvar _Renderer = __webpack_require__(24);\n\t\n\tvar _Renderer2 = _interopRequireDefault(_Renderer);\n\t\n\tvar _SVGRenderer = __webpack_require__(28);\n\t\n\tvar _SVGRenderer2 = _interopRequireDefault(_SVGRenderer);\n\t\n\tvar _GraphBehavior = __webpack_require__(25);\n\t\n\tvar _GraphBehavior2 = _interopRequireDefault(_GraphBehavior);\n\t\n\tvar _SelectionBehavior = __webpack_require__(27);\n\t\n\tvar _SelectionBehavior2 = _interopRequireDefault(_SelectionBehavior);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\t_Shape2.default.addShape(\"Rectangle\", _Rectangle2.default);\n\t_Shape2.default.addShape(\"Ellipse\", _Ellipse2.default);\n\t\n\texports.default = {\n\t\tEvents: _bean2.default,\n\t\tBase64: _base2.default,\n\t\tCache: _Utils2.default,\n\t\tUtils: _Utils2.default,\n\t\tDomUtils: _DomUtils2.default,\n\t\tStringBuffer: _StringBuffer2.default,\n\t\tPoint: _Point2.default,\n\t\tLine: _Line2.default,\n\t\tShape: _Shape2.default,\n\t\tRectangle: _Rectangle2.default,\n\t\tEllipse: _Ellipse2.default,\n\t\tLink: _Link2.default,\n\t\tEventDispatcher: _EventDispatcher2.default,\n\t\tLabel: _Label2.default,\n\t\tMarker: _Marker2.default,\n\t\tGraph: _Graph2.default,\n\t\tCell: _Cell2.default,\n\t\tNode: _Node2.default,\n\t\tEdge: _Edge2.default,\n\t\tLayout: _Layout2.default,\n\t\tFlowLayout: _FlowLayout2.default,\n\t\tRenderer: _Renderer2.default,\n\t\tSVGRenderer: _SVGRenderer2.default,\n\t\tGraphBehavior: _GraphBehavior2.default,\n\t\tSelectionBehavior: _SelectionBehavior2.default\n\t};\n\n/***/ },\n/* 1 */\n/***/ function(module, exports) {\n\n\t\"use strict\";\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t\tvalue: true\n\t});\n\t// http://www.webtoolkit.info/javascript-base64.html\n\t\n\tvar Base64 = {\n\t\n\t\t// private property\n\t\t_keyStr: \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=\",\n\t\n\t\t// public method for encoding\n\t\tencode: function encode(input) {\n\t\t\tvar output = \"\";\n\t\t\tvar chr1, chr2, chr3, enc1, enc2, enc3, enc4;\n\t\t\tvar i = 0;\n\t\n\t\t\tinput = Base64._utf8_encode(input);\n\t\n\t\t\twhile (i < input.length) {\n\t\n\t\t\t\tchr1 = input.charCodeAt(i++);\n\t\t\t\tchr2 = input.charCodeAt(i++);\n\t\t\t\tchr3 = input.charCodeAt(i++);\n\t\n\t\t\t\tenc1 = chr1 >> 2;\n\t\t\t\tenc2 = (chr1 & 3) << 4 | chr2 >> 4;\n\t\t\t\tenc3 = (chr2 & 15) << 2 | chr3 >> 6;\n\t\t\t\tenc4 = chr3 & 63;\n\t\n\t\t\t\tif (isNaN(chr2)) {\n\t\t\t\t\tenc3 = enc4 = 64;\n\t\t\t\t} else if (isNaN(chr3)) {\n\t\t\t\t\tenc4 = 64;\n\t\t\t\t}\n\t\n\t\t\t\toutput = output + this._keyStr.charAt(enc1) + this._keyStr.charAt(enc2) + this._keyStr.charAt(enc3) + this._keyStr.charAt(enc4);\n\t\t\t}\n\t\n\t\t\treturn output;\n\t\t},\n\t\n\t\t// public method for decoding\n\t\tdecode: function decode(input) {\n\t\t\tvar output = \"\";\n\t\t\tvar chr1, chr2, chr3;\n\t\t\tvar enc1, enc2, enc3, enc4;\n\t\t\tvar i = 0;\n\t\n\t\t\tinput = input.replace(/[^A-Za-z0-9\\+\\/\\=]/g, \"\");\n\t\n\t\t\twhile (i < input.length) {\n\t\n\t\t\t\tenc1 = this._keyStr.indexOf(input.charAt(i++));\n\t\t\t\tenc2 = this._keyStr.indexOf(input.charAt(i++));\n\t\t\t\tenc3 = this._keyStr.indexOf(input.charAt(i++));\n\t\t\t\tenc4 = this._keyStr.indexOf(input.charAt(i++));\n\t\n\t\t\t\tchr1 = enc1 << 2 | enc2 >> 4;\n\t\t\t\tchr2 = (enc2 & 15) << 4 | enc3 >> 2;\n\t\t\t\tchr3 = (enc3 & 3) << 6 | enc4;\n\t\n\t\t\t\toutput = output + String.fromCharCode(chr1);\n\t\n\t\t\t\tif (enc3 != 64) {\n\t\t\t\t\toutput = output + String.fromCharCode(chr2);\n\t\t\t\t}\n\t\t\t\tif (enc4 != 64) {\n\t\t\t\t\toutput = output + String.fromCharCode(chr3);\n\t\t\t\t}\n\t\t\t}\n\t\n\t\t\toutput = Base64._utf8_decode(output);\n\t\n\t\t\treturn output;\n\t\t},\n\t\n\t\t// private method for UTF-8 encoding\n\t\t_utf8_encode: function _utf8_encode(string) {\n\t\t\tstring = string.replace(/\\r\\n/g, \"\\n\");\n\t\t\tvar utftext = \"\";\n\t\n\t\t\tfor (var n = 0; n < string.length; n++) {\n\t\n\t\t\t\tvar c = string.charCodeAt(n);\n\t\n\t\t\t\tif (c < 128) {\n\t\t\t\t\tutftext += String.fromCharCode(c);\n\t\t\t\t} else if (c > 127 && c < 2048) {\n\t\t\t\t\tutftext += String.fromCharCode(c >> 6 | 192);\n\t\t\t\t\tutftext += String.fromCharCode(c & 63 | 128);\n\t\t\t\t} else {\n\t\t\t\t\tutftext += String.fromCharCode(c >> 12 | 224);\n\t\t\t\t\tutftext += String.fromCharCode(c >> 6 & 63 | 128);\n\t\t\t\t\tutftext += String.fromCharCode(c & 63 | 128);\n\t\t\t\t}\n\t\t\t}\n\t\n\t\t\treturn utftext;\n\t\t},\n\t\n\t\t// private method for UTF-8 decoding\n\t\t_utf8_decode: function _utf8_decode(utftext) {\n\t\t\tvar string = \"\";\n\t\t\tvar i = 0;\n\t\t\tvar c = c1 = c2 = 0;\n\t\n\t\t\twhile (i < utftext.length) {\n\t\n\t\t\t\tc = utftext.charCodeAt(i);\n\t\n\t\t\t\tif (c < 128) {\n\t\t\t\t\tstring += String.fromCharCode(c);\n\t\t\t\t\ti++;\n\t\t\t\t} else if (c > 191 && c < 224) {\n\t\t\t\t\tc2 = utftext.charCodeAt(i + 1);\n\t\t\t\t\tstring += String.fromCharCode((c & 31) << 6 | c2 & 63);\n\t\t\t\t\ti += 2;\n\t\t\t\t} else {\n\t\t\t\t\tc2 = utftext.charCodeAt(i + 1);\n\t\t\t\t\tc3 = utftext.charCodeAt(i + 2);\n\t\t\t\t\tstring += String.fromCharCode((c & 15) << 12 | (c2 & 63) << 6 | c3 & 63);\n\t\t\t\t\ti += 3;\n\t\t\t\t}\n\t\t\t}\n\t\n\t\t\treturn string;\n\t\t}\n\t\n\t};\n\t\n\texports.default = Base64;\n\n/***/ },\n/* 2 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t/* WEBPACK VAR INJECTION */(function(global) {\"use strict\";\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t\tvalue: true\n\t});\n\t\n\tvar _Point = __webpack_require__(3);\n\t\n\tvar _Point2 = _interopRequireDefault(_Point);\n\t\n\tvar _Rectangle = __webpack_require__(4);\n\t\n\tvar _Rectangle2 = _interopRequireDefault(_Rectangle);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\t\n\tfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\t\n\t// bean requires the existence of window\n\tif (typeof window === 'undefined' && typeof global !== 'undefined') {\n\t\tglobal.window = { addEventHandler: function addEventHandler() {} };\n\t\tglobal.document = {};\n\t\tglobal.navigator = {};\n\t}\n\t\n\t// util variables\n\tvar _debugging = [],\n\t    _debugAll = false,\n\t    typeRegistry = {},\n\t    splice = Array.splice;\n\t\n\t/**\r\n\t * Utility functions\r\n\t */\n\texports.default = {\n\t\ttype: function type(namespace, name, _type) {\n\t\t\tif (!typeRegistry[namespace]) typeRegistry[namespace] = new Map();\n\t\t\tif (!name) return typeRegistry[namespace];\n\t\t\tif (!_type) return typeRegistry[namespace].get(name);\n\t\t\ttypeRegistry[namespace].set(name, _type);\n\t\t},\n\t\n\t\tcreateType: function createType(namespace, props, defaultType) {\n\t\t\tvar name = props.name;\n\t\n\t\t\t// first check if type exists\n\t\t\tvar type = this.type(namespace, name);\n\t\t\tif (!type) {\n\t\t\t\tvar extend = props.extends ? this.type(namespace, props.extends) : null;\n\t\t\t\tif (!extend && defaultType) extend = defaultType;\n\t\t\t\tif (extend) type = function (_extend) {\n\t\t\t\t\t_inherits(type, _extend);\n\t\n\t\t\t\t\tfunction type() {\n\t\t\t\t\t\t_classCallCheck(this, type);\n\t\n\t\t\t\t\t\treturn _possibleConstructorReturn(this, (type.__proto__ || Object.getPrototypeOf(type)).apply(this, arguments));\n\t\t\t\t\t}\n\t\n\t\t\t\t\treturn type;\n\t\t\t\t}(extend);else {\n\t\t\t\t\ttype = function type(config) {\n\t\t\t\t\t\t_classCallCheck(this, type);\n\t\n\t\t\t\t\t\t_.assign(this, config);\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t\tdelete props.name;\n\t\t\t\tdelete props.extends;\n\t\t\t\t_.assign(type.prototype, props);\n\t\t\t\ttype.typeName = name;\n\t\t\t\tthis.type(namespace, name, type);\n\t\t\t\tthis.log('Utils', 'Utils.createType - ' + namespace + '.' + name);\n\t\t\t}\n\t\t\treturn type;\n\t\t},\n\t\n\t\tbuildTypes: function buildTypes(types, namespace, defaultType) {\n\t\t\tvar _this2 = this;\n\t\n\t\t\tthis.log('Utils', 'Utils.buildTypes - ' + namespace);\n\t\n\t\t\tif (!types && defaultType) {\n\t\t\t\tthis.createType(namespace, defaultType);\n\t\t\t\tthis.log('Utils', 'Utils.buildTypes end');\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tif (defaultType) {\n\t\t\t\tvar type = _.remove(types, { name: defaultType.name });\n\t\t\t\ttype = type.length > 0 ? type[0] : null;\n\t\t\t\tif (type) defaultType = this.createType(namespace, _.defaultsDeep(type, defaultType));else defaultType = this.createType(namespace, defaultType);\n\t\t\t}\n\t\n\t\t\t_.forEach(types, function (type) {\n\t\t\t\t_this2.createType(namespace, type, defaultType);\n\t\t\t});\n\t\t\tthis.log('Utils', 'Utils.buildTypes end');\n\t\t},\n\t\n\t\t// Helper function to correctly set up the prototype chain, for subclasses.\n\t\t// Similar to `goog.inherits`, but uses a hash of prototype properties and\n\t\t// class properties to be extended.\n\t\textend: function extend(child, parent, protoProps, staticProps) {\n\t\t\t// Add static properties to the constructor function, if supplied.\n\t\t\t_.extend(child, parent, staticProps);\n\t\n\t\t\t// Set the prototype chain to inherit from `parent`, without calling\n\t\t\t// `parent`'s constructor function.\n\t\t\tvar Surrogate = function Surrogate() {\n\t\t\t\tthis.constructor = child;\n\t\t\t};\n\t\t\tSurrogate.prototype = parent.prototype;\n\t\t\tchild.prototype = new Surrogate();\n\t\n\t\t\t// Add prototype properties (instance properties) to the subclass,\n\t\t\t// if supplied.\n\t\t\tif (protoProps) _.extend(child.prototype, protoProps);\n\t\n\t\t\t// Set a convenience property in case the parent's prototype is needed later.\n\t\t\tchild.superclass = parent.prototype;\n\t\n\t\t\treturn child;\n\t\t},\n\t\n\t\tinitConfig: function initConfig(obj, config) {\n\t\t\tvar props = {},\n\t\t\t    c = obj.constructor,\n\t\t\t    cArr = [c];\n\t\t\twhile (c) {\n\t\t\t\tif (c.super) {\n\t\t\t\t\tc = c.super.constructor;\n\t\t\t\t\tsplice.apply(cArr, [0, 0, c]);\n\t\t\t\t} else c = null;\n\t\t\t}\n\t\n\t\t\tfor (var i = 0; i < cArr.length; i++) {\n\t\t\t\tc = cArr[i];\n\t\t\t\tif (c.DEFAULTS) _.assign(props, c.DEFAULTS);\n\t\t\t}\n\t\t\tobj.props = _.assign(props, config);\n\t\t\tc.prototype.prop = function (name, value) {\n\t\t\t\tif (!value) return this.props[name];\n\t\t\t\tthis.props[name] = value;\n\t\t\t};\n\t\t},\n\t\n\t\t/**\r\n\t  * Gets the JS class constructor.\r\n\t  * @param {Object} jsClass\r\n\t  * @param {Object} defaultClass\r\n\t  */\n\t\tgetConstructor: function getConstructor(jsClass, defaultClass) {\n\t\t\tif (!jsClass) jsClass = defaultClass;\n\t\n\t\t\tif (_.isString(jsClass)) jsClass = eval(jsClass);\n\t\t\treturn jsClass;\n\t\t},\n\t\n\t\tdebug: function debug(moduleName) {\n\t\t\tif (moduleName) {\n\t\t\t\t_debugging.push(moduleName);\n\t\t\t} else {\n\t\t\t\t_debugAll = true;\n\t\t\t}\n\t\t},\n\t\n\t\tlog: function log(name, message) {\n\t\t\tif (!window.console) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tvar debug = _debugAll;\n\t\t\tif (!_debugAll) {\n\t\t\t\tdebug = false;\n\t\t\t\tfor (var i = 0; i < _debugging.length; i++) {\n\t\t\t\t\tif (_debugging[i] == name) debug = true;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (!debug) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\twhile (name.length < 10) {\n\t\t\t\tname = name + ' ';\n\t\t\t}\n\t\t\tname = name.substring(0, 10) + \" - \";\n\t\t\tconsole.info(name, message);\n\t\t},\n\t\n\t\t/**\r\n\t  * Get the relative position of sub shapes within a parent share.\r\n\t  * @param bounds\r\n\t  * @param geometry The geometry information, the format of Geometry is:\r\n\t  * {\r\n\t  *      x: \"x coordinate of ref point, if less than 1, will be treated as the percentage of the parent width.\",\r\n\t  *      y: \"y coordinate of ref point.\",\r\n\t  *      anchorX: \"x pos of child relative to the ref point\",\r\n\t  *      anchorY: \"y pos of child relative to the ref point\",\r\n\t  *      offsetX: \"the offset in the x direction.\",\r\n\t  *      offsetY: \"the offset in the y direction.\",\r\n\t  *      width: \"the width of the child element\",\r\n\t  *      height: \"the height of the child element\"\r\n\t  * }\r\n\t  * @returns {*[]}\r\n\t  */\n\t\tgetRelativePosition: function getRelativePosition(bounds, geometry) {\n\t\t\tvar x = Math.abs(geometry.x) <= 1 ? bounds.width * geometry.x : geometry.x;\n\t\t\tvar y = Math.abs(geometry.y) <= 1 ? bounds.height * geometry.y : geometry.y;\n\t\t\treturn this.offsetPosition([x, y], geometry);\n\t\t},\n\t\n\t\toffsetPosition: function offsetPosition(pos, geometry) {\n\t\t\treturn [pos[0] + geometry.width * geometry.anchorX + geometry.offsetX, pos[1] + geometry.height * geometry.anchorY + geometry.offsetY];\n\t\t},\n\t\n\t\t/**\r\n\t  * Get the position relative to the graph that's unscaled, i.e., absolute position without considering translation and scale.\r\n\t  * @param t the current translate\r\n\t  * @param scale the current scale\r\n\t  * @param o can be either a Point or a Rectangle or a Point array.\r\n\t  */\n\t\tunscale: function unscale(t, scale, o) {\n\t\t\tif (o instanceof _Rectangle2.default) return new _Rectangle2.default(o.x * scale + t[0], o.y * scale + t[1], o.width * scale, o.height * scale);else if (o instanceof _Point2.default) return new _Point2.default(o.x * scale + t[0], o.y * scale + t[1]);else return [o[0] * scale + t[0], o[1] * scale + t[1]];\n\t\t},\n\t\n\t\t/**\r\n\t  * Get the position relative to the graph that's scaled, i.e., relative position considering translation and scale.\r\n\t  * @param t the current translation\r\n\t  * @param scale the current scale\r\n\t  * @param o can be either a Point or a Rectangle or a Point array.\r\n\t  */\n\t\tscale: function scale(t, _scale, o) {\n\t\t\tif (o instanceof _Rectangle2.default) return new _Rectangle2.default((o.x - t[0]) / _scale, (o.y - t[1]) / _scale, o.width / _scale, o.height / _scale);else if (o instanceof _Point2.default) return new _Point2.default((o.x - t[0]) / _scale, (o.y - t[1]) / _scale);else return [(o[0] - t[0]) / _scale, (o[1] - t[1]) / _scale];\n\t\t},\n\t\n\t\t/**\r\n\t  * Convenience method.\r\n\t  */\n\t\tgetProperty: function getProperty(obj, prop) {\n\t\t\tif (!obj) return null;\n\t\t\tif (_.has(obj, prop)) return obj[prop];\n\t\t\tif (obj.prop && _.isFunction(obj.prop)) return obj.prop(prop);\n\t\t\treturn null;\n\t\t}\n\t};\n\t/* WEBPACK VAR INJECTION */}.call(exports, (function() { return this; }())))\n\n/***/ },\n/* 3 */\n/***/ function(module, exports) {\n\n\t\"use strict\";\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t\tvalue: true\n\t});\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tvar Point = function () {\n\t\tfunction Point(x, y) {\n\t\t\t_classCallCheck(this, Point);\n\t\n\t\t\tthis.x = x;\n\t\t\tthis.y = y;\n\t\t}\n\t\n\t\t/**\r\n\t  * Make a clone of this point\r\n\t  */\n\t\n\t\n\t\t_createClass(Point, [{\n\t\t\tkey: \"clone\",\n\t\t\tvalue: function clone() {\n\t\t\t\treturn new Point(this.x, this.y);\n\t\t\t}\n\t\n\t\t\t/**\r\n\t   * Calculate the distance from this pt to the other pt.\r\n\t   * @param aPt\r\n\t   * @returns {number}\r\n\t   */\n\t\n\t\t}, {\n\t\t\tkey: \"distance\",\n\t\t\tvalue: function distance(aPt) {\n\t\t\t\treturn Math.sqrt((this.x - aPt.x) * (this.x - aPt.x) + (this.y - aPt.y) * (this.y - aPt.y));\n\t\t\t}\n\t\n\t\t\t/**\r\n\t   * Translate this point\r\n\t  \t */\n\t\n\t\t}, {\n\t\t\tkey: \"translate\",\n\t\t\tvalue: function translate(p2) {\n\t\t\t\tthis.x += p2.x;\n\t\t\t\tthis.y += p2.y;\n\t\t\t\treturn this;\n\t\t\t}\n\t\n\t\t\t/**\r\n\t   * Scale this vector\r\n\t  \t */\n\t\n\t\t}, {\n\t\t\tkey: \"scale\",\n\t\t\tvalue: function scale(_scale) {\n\t\t\t\tthis.x *= _scale;\n\t\t\t\tthis.y *= _scale;\n\t\t\t\treturn this;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"getScaled\",\n\t\t\tvalue: function getScaled(scale) {\n\t\t\t\treturn new Point(this.x * scale, this.y * scale);\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"getTranslated\",\n\t\t\tvalue: function getTranslated(p2) {\n\t\t\t\treturn new Point(this.x + p2.x, this.y + p2.y);\n\t\t\t}\n\t\n\t\t\t/**\r\n\t   * Get the direction vector from this point to p2.\r\n\t   * @param p2\r\n\t   * @returns {Point}\r\n\t   */\n\t\n\t\t}, {\n\t\t\tkey: \"getDirection\",\n\t\t\tvalue: function getDirection(p2) {\n\t\t\t\tvar dist = this.distance(p2);\n\t\t\t\treturn new Point((p2.x - this.x) / dist, (p2.y - this.y) / dist);\n\t\t\t}\n\t\n\t\t\t/**\r\n\t   * rotate the point about the origin. With the specified angle.\r\n\t   * @param angle the angle to rotate\r\n\t   */\n\t\n\t\t}, {\n\t\t\tkey: \"rotate\",\n\t\t\tvalue: function rotate(angle) {\n\t\t\t\tvar cos = Math.cos(angle * Math.PI / 180);\n\t\t\t\tvar sin = Math.sin(angle * Math.PI / 180);\n\t\t\t\tvar x = this.x,\n\t\t\t\t    y = this.y;\n\t\t\t\tthis.x = x * cos - y * sin;\n\t\t\t\tthis.y = x * sin + y * cos;\n\t\t\t\treturn this;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"getRotated\",\n\t\t\tvalue: function getRotated(angle) {\n\t\t\t\treturn this.clone().rotate(angle);\n\t\t\t}\n\t\n\t\t\t/**\r\n\t   * Calculate the dot product, treating this and p2 as vectors.\r\n\t   */\n\t\n\t\t}, {\n\t\t\tkey: \"dotProduct\",\n\t\t\tvalue: function dotProduct(p2) {\n\t\t\t\treturn this.x * p2.x + this.y * p2.y;\n\t\t\t}\n\t\n\t\t\t/**\r\n\t   * Get the mid point between this and p2.\r\n\t  \t */\n\t\n\t\t}, {\n\t\t\tkey: \"getMidPoint\",\n\t\t\tvalue: function getMidPoint(p2) {\n\t\t\t\treturn new Point((this.x + p2.x) / 2, (this.y + p2.y) / 2);\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"reverse\",\n\t\t\tvalue: function reverse() {\n\t\t\t\tthis.x = -this.x;\n\t\t\t\tthis.y = -this.y;\n\t\t\t\treturn this;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"equals\",\n\t\t\tvalue: function equals(p2) {\n\t\t\t\tif (!p2 || p2.constructor != Point) return false;\n\t\n\t\t\t\treturn this.x == p2.x && this.y == p2.y;\n\t\t\t}\n\t\n\t\t\t/**\r\n\t   * Reflect this point w.r.t. the rectangle.\r\n\t   * If vertical is true, it will reflect the point cross the vertical\r\n\t   * central line of the rectangle, otherwise reflect cross the horizontal\r\n\t   * central line.\r\n\t   *\r\n\t   * @param rect the rectangle\r\n\t   * @param vertical whether is vertical reflection or horizontal reflection.\r\n\t   */\n\t\n\t\t}, {\n\t\t\tkey: \"reflect\",\n\t\t\tvalue: function reflect(rect, vertical) {\n\t\t\t\tif (vertical) this.x = 2 * rect.x - this.x;else this.y = 2 * rect.y - this.y;\n\t\t\t\treturn this;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"toString\",\n\t\t\tvalue: function toString() {\n\t\t\t\treturn this.x + \",\" + this.y;\n\t\t\t}\n\t\t}]);\n\t\n\t\treturn Point;\n\t}();\n\t\n\tPoint.W = new Point(-1, 0);\n\tPoint.N = new Point(0, -1);\n\tPoint.S = new Point(0, 1);\n\tPoint.E = new Point(1, 0);\n\tPoint.NE = new Point(1, -1);\n\tPoint.NW = new Point(-1, -1);\n\tPoint.SE = new Point(1, 1);\n\tPoint.SW = new Point(-1, 1);\n\t\n\texports.default = Point;\n\n/***/ },\n/* 4 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t\tvalue: true\n\t});\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tvar _lodash = __webpack_require__(5);\n\t\n\tvar _lodash2 = _interopRequireDefault(_lodash);\n\t\n\tvar _Point = __webpack_require__(3);\n\t\n\tvar _Point2 = _interopRequireDefault(_Point);\n\t\n\tvar _Shape2 = __webpack_require__(6);\n\t\n\tvar _Shape3 = _interopRequireDefault(_Shape2);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\t\n\tfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\t\n\tvar Rectangle = function (_Shape) {\n\t\t_inherits(Rectangle, _Shape);\n\t\n\t\tfunction Rectangle() {\n\t\t\t_classCallCheck(this, Rectangle);\n\t\n\t\t\treturn _possibleConstructorReturn(this, (Rectangle.__proto__ || Object.getPrototypeOf(Rectangle)).apply(this, arguments));\n\t\t}\n\t\n\t\t_createClass(Rectangle, [{\n\t\t\tkey: \"contains\",\n\t\n\t\t\t/**\r\n\t   * Checks whether this rectangle contains a given point of a given rectangle\r\n\t   */\n\t\t\tvalue: function contains(el) {\n\t\t\t\tvar w = el.width || 0;\n\t\t\t\tvar h = el.height || 0;\n\t\t\t\tvar left = el.x - w / 2;\n\t\t\t\tvar right = el.x + w / 2;\n\t\t\t\tvar top = el.y - h / 2;\n\t\t\t\tvar bottom = el.y + h / 2;\n\t\t\t\treturn right <= this.right && left >= this.left && top >= this.top && bottom <= this.bottom;\n\t\t\t}\n\t\n\t\t\t/**\r\n\t   * Calcualte the distance to a point. 0 if this rectangle contains the point.\r\n\t   */\n\t\n\t\t}, {\n\t\t\tkey: \"distance\",\n\t\t\tvalue: function distance(pt) {\n\t\t\t\tif (this.contains(pt)) return 0;\n\t\n\t\t\t\tif (pt.x < this.left) {\n\t\t\t\t\tif (pt.y < this.top) return pt.distance(new _Point2.default(this.left, this.top));\n\t\t\t\t\tif (pt.y <= this.bottom) return this.left - pt.x;\n\t\t\t\t\treturn pt.distance(new _Point2.default(this.left, this.bottom));\n\t\t\t\t}\n\t\t\t\tif (pt.x <= this.right) {\n\t\t\t\t\tif (pt.y <= this.top) return this.top - pt.y;\n\t\t\t\t\treturn pt.y - this.bottom;\n\t\t\t\t}\n\t\t\t\tif (pt.y < this.top) return pt.distance(new _Point2.default(this.right, this.top));\n\t\t\t\tif (pt.y <= this.bottom) return pt.x - this.right;\n\t\t\t\treturn pt.distance(new _Point2.default(this.right, this.bottom));\n\t\t\t}\n\t\n\t\t\t/**\r\n\t   * Given two points, we want to detect whether the line joining the pts intersect\r\n\t   * with the rectangle or not. We assume only horizontal or vertical line segments.\r\n\t   *\r\n\t   * @return int the side of the intersection: -1: no intersection, 0: left, 1: top, 2: right, 3: bottom, 4: containment.\r\n\t   */\n\t\n\t\t}, {\n\t\t\tkey: \"detectIntersection\",\n\t\t\tvalue: function detectIntersection(pt1, pt2) {\n\t\t\t\tvar horizontal = pt1.y == pt2.y;\n\t\t\t\tvar contains1 = this.contains(pt1);\n\t\t\t\tvar contains2 = this.contains(pt2);\n\t\t\t\tif (contains1 && contains2) return 4;\n\t\t\t\tif (!contains1 && !contains2) {\n\t\t\t\t\tif (horizontal && pt1.y >= this.top && pt1.y <= this.bottom) {\n\t\t\t\t\t\tif (pt1.x < this.left && pt2.x > this.right) return 0;\n\t\t\t\t\t\tif (pt1.x > this.right && pt2.x < this.left) return 2;\n\t\t\t\t\t}\n\t\t\t\t\tif (!horizontal && pt1.x >= this.left && pt1.x <= this.right) {\n\t\t\t\t\t\tif (pt1.y < this.top && pt2.y > this.bottom) return 1;\n\t\t\t\t\t\tif (pt1.y > this.bottom && pt2.y < this.top) return 3;\n\t\t\t\t\t}\n\t\t\t\t\treturn -1;\n\t\t\t\t}\n\t\n\t\t\t\tvar outPt = contains1 ? pt2 : pt1;\n\t\t\t\tif (horizontal) {\n\t\t\t\t\tif (outPt.x > this.right) return 2;\n\t\t\t\t\treturn 0;\n\t\t\t\t} else {\n\t\t\t\t\tif (outPt.y < this.top) return 1;\n\t\t\t\t\treturn 3;\n\t\t\t\t}\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"toString\",\n\t\t\tvalue: function toString() {\n\t\t\t\treturn 'Rectangle:{x=' + this.x + ';y=' + this.y + ';width=' + this.width + ';height=' + this.height + '}';\n\t\t\t}\n\t\t}], [{\n\t\t\tkey: \"getPerimeter\",\n\t\t\tvalue: function getPerimeter(rect, pt) {\n\t\t\t\tvar orthogonal = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;\n\t\n\t\t\t\tvar x = rect.x;\n\t\t\t\tvar y = rect.y;\n\t\t\t\tvar dx = pt.x - x;\n\t\t\t\tvar dy = pt.y - y;\n\t\t\t\tvar alpha = Math.atan2(dy, dx);\n\t\t\t\tvar p = new _Point2.default(0, 0);\n\t\t\t\tvar pi = Math.PI;\n\t\t\t\tvar pi2 = Math.PI / 2;\n\t\t\t\tvar beta = pi2 - alpha;\n\t\t\t\tvar t = Math.atan2(rect.height, rect.width);\n\t\n\t\t\t\tif (alpha < -pi + t || alpha > pi - t) {\n\t\t\t\t\t// Left edge\n\t\t\t\t\tp.x = rect.left;\n\t\t\t\t\tp.y = y - rect.width * Math.tan(alpha) / 2;\n\t\t\t\t} else if (alpha < -t) {\n\t\t\t\t\t// Top Edge\n\t\t\t\t\tp.y = rect.top;\n\t\t\t\t\tp.x = x - rect.height * Math.tan(beta) / 2;\n\t\t\t\t} else if (alpha < t) {\n\t\t\t\t\t// Right Edge\n\t\t\t\t\tp.x = rect.right;\n\t\t\t\t\tp.y = y + rect.width * Math.tan(alpha) / 2;\n\t\t\t\t} else {\n\t\t\t\t\t// Bottom Edge\n\t\t\t\t\tp.y = rect.bottom;\n\t\t\t\t\tp.x = x + rect.height * Math.tan(beta) / 2;\n\t\t\t\t}\n\t\n\t\t\t\tif (orthogonal) {\n\t\t\t\t\tif (alpha < -pi + t || alpha > pi - t) {\n\t\t\t\t\t\t// Left edge\n\t\t\t\t\t\tp.x = rect.left;\n\t\t\t\t\t\tp.y = y;\n\t\t\t\t\t} else if (alpha < -t) {\n\t\t\t\t\t\t// Top Edge\n\t\t\t\t\t\tp.y = rect.top;\n\t\t\t\t\t\tp.x = x;\n\t\t\t\t\t} else if (alpha < t) {\n\t\t\t\t\t\t// Right Edge\n\t\t\t\t\t\tp.x = rect.right;\n\t\t\t\t\t\tp.y = y;\n\t\t\t\t\t} else {\n\t\t\t\t\t\t// Bottom Edge\n\t\t\t\t\t\tp.y = rect.bottom;\n\t\t\t\t\t\tp.x = x;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\n\t\t\t\tvar dir = Rectangle.getDirection(rect, p, orthogonal);\n\t\t\t\treturn { point: p, direction: dir };\n\t\t\t}\n\t\n\t\t\t/**\r\n\t   * Return the bounding rectangle that contains p1 and p2\r\n\t   */\n\t\n\t\t}, {\n\t\t\tkey: \"getBoundingRectangle\",\n\t\t\tvalue: function getBoundingRectangle(pts, margin) {\n\t\t\t\tif (!pts || pts.length == 0) return null;\n\t\t\t\tmargin = margin || [0, 0, 0, 0];\n\t\t\t\tif (!_lodash2.default.isArray(margin)) margin = [margin, margin, margin, margin];\n\t\t\t\tvar min = [pts[0].x, pts[0].y];\n\t\t\t\tvar max = [pts[0].x, pts[0].y];\n\t\t\t\tfor (var i = 1; i < pts.length; i++) {\n\t\t\t\t\tvar p = pts[i];\n\t\t\t\t\tif (p.x < min[0]) {\n\t\t\t\t\t\tmin[0] = p.x;\n\t\t\t\t\t}\n\t\t\t\t\tif (p.y < min[1]) {\n\t\t\t\t\t\tmin[1] = p.y;\n\t\t\t\t\t}\n\t\t\t\t\tif (p.x > max[0]) {\n\t\t\t\t\t\tmax[0] = p.x;\n\t\t\t\t\t}\n\t\t\t\t\tif (p.y > max[1]) {\n\t\t\t\t\t\tmax[1] = p.y;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tmin[0] = min[0] - margin[0];\n\t\t\t\tmin[1] = min[1] - margin[1];\n\t\t\t\tmax[0] = max[0] + margin[2];\n\t\t\t\tmax[1] = max[1] + margin[3];\n\t\t\t\tvar w = Math.abs(max[0] - min[0]);\n\t\t\t\tvar h = Math.abs(max[1] - min[1]);\n\t\t\t\treturn new Rectangle(min[0] + w / 2, min[1] + h / 2, w, h);\n\t\t\t}\n\t\n\t\t\t/**\r\n\t   * Create a union of all the rectangles.\r\n\t   * @param rects\r\n\t   */\n\t\n\t\t}, {\n\t\t\tkey: \"union\",\n\t\t\tvalue: function union(rects) {\n\t\t\t\tvar minx = null,\n\t\t\t\t    miny = null,\n\t\t\t\t    maxx = -Infinity,\n\t\t\t\t    maxy = -Infinity;\n\t\t\t\t_lodash2.default.each(rects, function (rect) {\n\t\t\t\t\tminx = minx || rect.x;\n\t\t\t\t\tminy = miny || rect.y;\n\t\t\t\t\tminx = Math.min(minx, rect.x);\n\t\t\t\t\tminy = Math.min(miny, rect.y);\n\t\t\t\t\tmaxx = Math.max(maxx, rect.right());\n\t\t\t\t\tmaxy = Math.max(maxy, rect.bottom());\n\t\t\t\t});\n\t\t\t\tminx = minx || 0;\n\t\t\t\tminy = miny || 0;\n\t\t\t\treturn new Rectangle(minx, miny, maxx - minx, maxy - miny);\n\t\t\t}\n\t\n\t\t\t/**\r\n\t   * Returns the direction the point <i>p</i> is in relation to the given rectangle.\r\n\t   * Possible values are WEST (-1,0), EAST (1,0), NORTH (0,-1) and SOUTH (0,1) if orthogonal is true, otherwise return\r\n\t   * the direction connection the center of r and p.\r\n\t   * @param r\r\n\t   * @param p\r\n\t   * @param orthogonal\r\n\t   * @returns {Point|*}\r\n\t   */\n\t\n\t\t}, {\n\t\t\tkey: \"getDirection\",\n\t\t\tvalue: function getDirection(r, p) {\n\t\t\t\tvar orthogonal = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;\n\t\n\t\t\t\tif (!orthogonal) return new _Point2.default(r.x, r.y).getDirection(new _Point2.default(p.x, p.y));\n\t\n\t\t\t\tvar i = void 0,\n\t\t\t\t    distance = Math.abs(r.left - p.x),\n\t\t\t\t    direction = _Point2.default.W;\n\t\n\t\t\t\ti = Math.abs(r.top - p.y);\n\t\t\t\tif (i <= distance) {\n\t\t\t\t\tdistance = i;\n\t\t\t\t\tdirection = _Point2.default.N;\n\t\t\t\t}\n\t\n\t\t\t\ti = Math.abs(r.bottom - p.y);\n\t\t\t\tif (i <= distance) {\n\t\t\t\t\tdistance = i;\n\t\t\t\t\tdirection = _Point2.default.S;\n\t\t\t\t}\n\t\n\t\t\t\ti = Math.abs(r.right - p.x);\n\t\t\t\tif (i < distance) {\n\t\t\t\t\tdirection = _Point2.default.E;\n\t\t\t\t}\n\t\n\t\t\t\treturn direction;\n\t\t\t}\n\t\t}]);\n\t\n\t\treturn Rectangle;\n\t}(_Shape3.default);\n\t\n\texports.default = Rectangle;\n\n/***/ },\n/* 5 */\n/***/ function(module, exports) {\n\n\tmodule.exports = __WEBPACK_EXTERNAL_MODULE_5__;\n\n/***/ },\n/* 6 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t\tvalue: true\n\t});\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tvar _lodash = __webpack_require__(5);\n\t\n\tvar _lodash2 = _interopRequireDefault(_lodash);\n\t\n\tvar _Point = __webpack_require__(3);\n\t\n\tvar _Point2 = _interopRequireDefault(_Point);\n\t\n\tvar _Rectangle = __webpack_require__(4);\n\t\n\tvar _Rectangle2 = _interopRequireDefault(_Rectangle);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tvar registry = {};\n\t\n\tvar Shape = function () {\n\t\tfunction Shape(x, y, width, height, config) {\n\t\t\t_classCallCheck(this, Shape);\n\t\n\t\t\tthis.x = x;\n\t\t\tthis.y = y;\n\t\t\tthis.width = width;\n\t\t\tthis.height = height;\n\t\t\t_lodash2.default.defaults(this, config, { x: 0, y: 0, width: 0, height: 0 });\n\t\t}\n\t\n\t\t/**\r\n\t  * Return the y-coord of the top side of this rectangle\r\n\t  */\n\t\n\t\n\t\t_createClass(Shape, [{\n\t\t\tkey: \"contains\",\n\t\t\tvalue: function contains(el) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\n\t\t\t/**\r\n\t   * This will generate n ports on the shape.\r\n\t   */\n\t\n\t\t}, {\n\t\t\tkey: \"getRegularPoints\",\n\t\t\tvalue: function getRegularPoints(n) {\n\t\t\t\treturn null;\n\t\t\t}\n\t\n\t\t\t/**\r\n\t   * Get the intersection between boundary of this shape and the line connecting (x,y) with the refPt.\r\n\t   * @param refPt\r\n\t   * @returns {null}\r\n\t   */\n\t\n\t\t}, {\n\t\t\tkey: \"getPerimeter\",\n\t\t\tvalue: function getPerimeter(refPt) {\n\t\t\t\tvar orthogonal = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n\t\n\t\t\t\treturn this.constructor.getPerimeter(this, refPt, orthogonal);\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"render\",\n\t\t\tvalue: function render(view) {\n\t\t\t\tvar template = _lodash2.default.template(view.getTemplate(this.name, this));\n\t\t\t\treturn template(this);\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"top\",\n\t\t\tget: function get() {\n\t\t\t\treturn this.y - this.height / 2;\n\t\t\t}\n\t\n\t\t\t/**\r\n\t   * Returns the y-coordinate of the bottom of this Rectangle.\r\n\t   */\n\t\n\t\t}, {\n\t\t\tkey: \"bottom\",\n\t\t\tget: function get() {\n\t\t\t\treturn this.y + this.height / 2;\n\t\t\t}\n\t\n\t\t\t/**\r\n\t   * Return the x-coord of left side of this rectangle\r\n\t   */\n\t\n\t\t}, {\n\t\t\tkey: \"left\",\n\t\t\tget: function get() {\n\t\t\t\treturn this.x - this.width / 2;\n\t\t\t}\n\t\n\t\t\t/**\r\n\t   * Returns the x-coordinate of the right side of this Rectangle.\r\n\t   */\n\t\n\t\t}, {\n\t\t\tkey: \"right\",\n\t\t\tget: function get() {\n\t\t\t\treturn this.x + this.width / 2;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"center\",\n\t\t\tget: function get() {\n\t\t\t\treturn new _Point2.default(this.x, this.y);\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"bounds\",\n\t\t\tget: function get() {\n\t\t\t\treturn new _Rectangle2.default(this.x, this.y, this.width, this.height);\n\t\t\t}\n\t\t}], [{\n\t\t\tkey: \"getShape\",\n\t\t\tvalue: function getShape(name) {\n\t\t\t\treturn registry[name];\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"addShape\",\n\t\t\tvalue: function addShape(name, c) {\n\t\t\t\tregistry[name] = c;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"removeShape\",\n\t\t\tvalue: function removeShape(name) {\n\t\t\t\tdelete registry[name];\n\t\t\t}\n\t\t}]);\n\t\n\t\treturn Shape;\n\t}();\n\t\n\texports.default = Shape;\n\n/***/ },\n/* 7 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t\tvalue: true\n\t});\n\t\n\tvar _lodash = __webpack_require__(5);\n\t\n\tvar _lodash2 = _interopRequireDefault(_lodash);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\t/**\r\n\t * dom Utility functions\r\n\t */\n\texports.default = {\n\t\tisIE: function () {\n\t\t\tif (!window || !window.navigator || !navigator) return false;\n\t\t\tvar sAgent = window.navigator.userAgent;\n\t\t\tvar Idx = sAgent.indexOf(\"MSIE\");\n\t\n\t\t\t// If IE, return version number.\n\t\t\tif (Idx > 0) return parseInt(sAgent.substring(Idx + 5, sAgent.indexOf(\".\", Idx)));\n\t\n\t\t\t// If IE 11 then look for Updated user agent string.\n\t\t\telse if (!!navigator.userAgent.match(/Trident\\/7\\./)) return 11;else if (!!navigator.userAgent.match(/Edge\\//)) return \"Edge\";else return false;\n\t\t}(),\n\t\n\t\tisFireFox: function () {\n\t\t\t// InstallTrigger: Firefox's API to install add-ons\n\t\t\treturn typeof InstallTrigger !== 'undefined';\n\t\t}(),\n\t\n\t\tisChrome: function () {\n\t\t\tif (!window || !window.navigator || !navigator || navigator.userAgent.indexOf('Edge') >= 0) return false;\n\t\t\tvar raw = navigator.userAgent.match(/Chrom(e|ium)\\/([0-9]+)\\./);\n\t\t\treturn raw ? parseInt(raw[2], 10) : false;\n\t\t}(),\n\t\n\t\tisMac: function () {\n\t\t\tif (!window || !window.navigator || !navigator) return false;\n\t\t\treturn navigator.platform.toUpperCase().indexOf('MAC') >= 0;\n\t\t}(),\n\t\n\t\tisWindows: function () {\n\t\t\tif (!window || !window.navigator || !navigator) return false;\n\t\t\treturn navigator.appVersion.indexOf(\"Windows\") >= 0;\n\t\t}(),\n\t\n\t\tisLinux: function () {\n\t\t\tif (!window || !window.navigator || !navigator) return false;\n\t\t\treturn navigator.appVersion.indexOf(\"Linux\") >= 0;\n\t\t}(),\n\t\n\t\tcreateElement: function createElement(tag, attribs, styles, html) {\n\t\t\tvar el = document.createElement(tag);\n\t\t\tthis.setElement(el, attribs, styles);\n\t\t\tif (html) el.innerHTML = html;\n\t\t\treturn el;\n\t\t},\n\t\n\t\tcreateElementByString: function createElementByString(str) {\n\t\t\tvar temp = this.createElement('div', null, null, str);\n\t\t\treturn temp.childNodes;\n\t\t},\n\t\n\t\tsetElement: function setElement(el, attribs, styles) {\n\t\t\tif (attribs) {\n\t\t\t\t_lodash2.default.forEach(attribs, function (value, key) {\n\t\t\t\t\tel.setAttribute(key, value);\n\t\t\t\t});\n\t\t\t}\n\t\t\tif (styles) {\n\t\t\t\t_lodash2.default.forEach(styles, function (value, key) {\n\t\t\t\t\tel.style[key] = value;\n\t\t\t\t});\n\t\t\t}\n\t\t},\n\t\n\t\ttestElement: function testElement(node, method) {\n\t\t\treturn node && node.nodeType == 1 && (!method || method(node));\n\t\t},\n\t\n\t\tgetAncestorBy: function getAncestorBy(node, method) {\n\t\t\twhile (node = node.parentNode) {\n\t\t\t\tif (this.testElement(node, method)) return node;\n\t\t\t}return null;\n\t\t},\n\t\n\t\t/**\r\n\t  * Get the position of element relative to the context.\r\n\t  * @param el the element\r\n\t  * @param context\r\n\t  * @returns {*[]}\r\n\t  */\n\t\tgetPosition: function getPosition(el, context) {\n\t\t\tif (!context) context = document.body;\n\t\t\tvar elRect = el.getBoundingClientRect();\n\t\t\tvar contextRect = context.getBoundingClientRect();\n\t\n\t\t\treturn [elRect.left - contextRect.left, elRect.top - contextRect.top];\n\t\t},\n\t\tgetCenterPosition: function getCenterPosition(el, context) {\n\t\t\tif (!context) context = document.body;\n\t\t\tvar elRect = el.getBoundingClientRect();\n\t\t\tvar contextRect = context.getBoundingClientRect();\n\t\t\tvar w = elRect.right - elRect.left;\n\t\t\tvar h = elRect.bottom - elRect.top;\n\t\n\t\t\treturn [elRect.left - contextRect.left + w / 2, elRect.top - contextRect.top + h / 2];\n\t\t},\n\t\n\t\n\t\tmove: function move(el, x, y) {\n\t\t\tif (x) el.style.left = x + 'px';\n\t\t\tif (y) el.style.top = y + 'px';\n\t\t},\n\t\n\t\tgetSize: function getSize(el) {\n\t\t\tvar w = parseInt(el.style.offsetWidth, 10);\n\t\t\tvar h = parseInt(el.style.offsetHeight, 10);\n\t\t\treturn [w, h];\n\t\t},\n\t\n\t\tresize: function resize(el, w, h) {\n\t\t\tif (w) el.style.width = w + \"px\";\n\t\t\tif (h) el.style.height = h + 'px';\n\t\t},\n\t\n\t\tpreloadImages: function preloadImages(array) {\n\t\t\tif (!this.preloadImages.list) this.preloadImages.list = [];\n\t\t\tif (!this.preloadImages.loaded) this.preloadImages.loaded = {};\n\t\n\t\t\tvar list = this.preloadImages.list;\n\t\t\tvar img,\n\t\t\t    that = this;\n\t\t\tfor (var i = 0; i < array.length; i++) {\n\t\t\t\timg = new Image();\n\t\t\t\timg.onload = function () {\n\t\t\t\t\tvar index = list.indexOf(this);\n\t\t\t\t\tif (index !== -1) {\n\t\t\t\t\t\tthat.preloadImages.loaded[this.name] = { width: this.width, height: this.height };\n\t\t\t\t\t\t// remove image from the array once it's loaded\n\t\t\t\t\t\t// for memory consumption reasons\n\t\t\t\t\t\tlist.splice(index, 1);\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t\tlist.push(img);\n\t\t\t\timg.src = array[i];\n\t\t\t\timg.name = array[i];\n\t\t\t}\n\t\t},\n\t\n\t\t/**\r\n\t  * Get's the image's information given the url. Must be preloaded by calling the preloadImage function.\r\n\t  * @param src\r\n\t  */\n\t\tgetImageInfo: function getImageInfo(src) {\n\t\t\tif (this.preloadImages.loaded) {\n\t\t\t\treturn this.preloadImages.loaded[src];\n\t\t\t}\n\t\t\treturn null;\n\t\t},\n\t\n\t\tdownloadFile: function downloadFile(name, data) {\n\t\t\tif (!data) return;\n\t\t\tvar mime = data.match(/^data:([^;,]*)/)[1];\n\t\t\tif (name.indexOf('.') < 0) {\n\t\t\t\tif (!mime) mime = 'text/plain';\n\t\t\t\tif (mime == 'text/plain') name = name + '.txt';else {\n\t\t\t\t\tvar type = mime.split('/')[1];\n\t\t\t\t\tif (type.indexOf('+') > 0) type = type.split('+')[0];\n\t\t\t\t\tname = name + '.' + type;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (this.isIE) {\n\t\t\t\tvar encoded = data.indexOf(';base64') >= 0;\n\t\t\t\tif (encoded) data = atob(data.replace('data:' + mime + ';base64,', ''));else data = decodeURI(data.replace('data:' + mime + ',', ''));\n\t\t\t\tdata = this.GetBlob(data, mime);\n\t\t\t\tnavigator.msSaveBlob(data, name);\n\t\t\t} else {\n\t\t\t\tvar link = this.createElement('a', { href: data, download: name }, { display: \"none\" });\n\t\t\t\tdocument.body.appendChild(link);\n\t\t\t\tlink.click();\n\t\t\t\tlink.parentNode.removeChild(link);\n\t\t\t}\n\t\t},\n\t\n\t\t/**\r\n\t  * Convert b54 to blob. IE only\r\n\t  */\n\t\tGetBlob: function GetBlob(data, contentType, sliceSize) {\n\t\t\tcontentType = contentType || '';\n\t\t\tsliceSize = sliceSize || 512;\n\t\n\t\t\tvar byteArrays = [];\n\t\n\t\t\tfor (var offset = 0; offset < data.length; offset += sliceSize) {\n\t\t\t\tvar slice = data.slice(offset, offset + sliceSize);\n\t\n\t\t\t\tvar byteNumbers = new Array(slice.length);\n\t\t\t\tfor (var i = 0; i < slice.length; i++) {\n\t\t\t\t\tbyteNumbers[i] = slice.charCodeAt(i);\n\t\t\t\t}\n\t\t\t\tvar byteArray = new Uint8Array(byteNumbers);\n\t\t\t\tbyteArrays.push(byteArray);\n\t\t\t}\n\t\t\treturn new Blob(byteArrays, { type: contentType });\n\t\t},\n\t\n\t\topenImage: function openImage(name, image) {\n\t\t\tvar myWindow = window.open(\"\", \"_blank\", \"toolbar=yes, scrollbars=yes, resizable=yes, width=500, height=500\");\n\t\t\tvar myDocument = myWindow.document;\n\t\t\tvar img = myDocument.createElement(\"img\");\n\t\t\tthis.setElement(img, { src: image, name: name });\n\t\t\tmyDocument.body.appendChild(img);\n\t\t},\n\t\n\t\t/**\r\n\t  * Check whether the key event is from input, textarea or select.\r\n\t  * @param e  input event\r\n\t  */\n\t\teventFromInput: function eventFromInput(e) {\n\t\t\tvar tagName = e.target.tagName;\n\t\t\treturn tagName == 'INPUT' || tagName == 'TEXTAREA' || tagName == 'SELECT';\n\t\t}\n\t};\n\n/***/ },\n/* 8 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t\tvalue: true\n\t});\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tvar _lodash = __webpack_require__(5);\n\t\n\tvar _lodash2 = _interopRequireDefault(_lodash);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\t/**\r\n\t * A string buffer for fast string manipulation\r\n\t */\n\tvar StringBuffer = function () {\n\t\tfunction StringBuffer(str) {\n\t\t\t_classCallCheck(this, StringBuffer);\n\t\n\t\t\tthis.buffer = [];\n\t\t\tif (str) this.buffer.push(str);\n\t\t}\n\t\n\t\t_createClass(StringBuffer, [{\n\t\t\tkey: \"append\",\n\t\t\tvalue: function append(stuff) {\n\t\t\t\tif (_lodash2.default.isString(stuff)) this.buffer.push(stuff);else if (_lodash2.default.isArray(stuff)) this.buffer = this.buffer.concat(stuff);else this.buffer.push(\"\" + stuff);\n\t\t\t\treturn this;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"prepend\",\n\t\t\tvalue: function prepend(stuff) {\n\t\t\t\tif (_lodash2.default.isString(stuff)) this.buffer.splice(0, 0, stuff);else if (_lodash2.default.isArray(stuff)) this.buffer = stuff.concat(this.buffer);else this.buffer.splice(0, 0, \"\" + stuff);\n\t\t\t\treturn this;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"clear\",\n\t\t\tvalue: function clear() {\n\t\t\t\tthis.buffer = [];\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"removeLast\",\n\t\t\tvalue: function removeLast() {\n\t\t\t\tthis.buffer.pop();\n\t\t\t\treturn this;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"toString\",\n\t\t\tvalue: function toString(sep) {\n\t\t\t\tif (!sep) sep = '';\n\t\t\t\treturn this.buffer.join(sep);\n\t\t\t}\n\t\t}]);\n\t\n\t\treturn StringBuffer;\n\t}();\n\t\n\texports.default = StringBuffer;\n\n/***/ },\n/* 9 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t\tvalue: true\n\t});\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tvar _Point = __webpack_require__(3);\n\t\n\tvar _Point2 = _interopRequireDefault(_Point);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tvar Line = function () {\n\t\tfunction Line(start, end) {\n\t\t\t_classCallCheck(this, Line);\n\t\n\t\t\tthis.start = start;\n\t\t\tthis.end = end;\n\t\t}\n\t\n\t\t/**\r\n\t  * Calculate the length of this line\r\n\t  */\n\t\n\t\n\t\t_createClass(Line, [{\n\t\t\tkey: 'length',\n\t\t\tvalue: function length() {\n\t\t\t\treturn this.start.distance(this.end);\n\t\t\t}\n\t\n\t\t\t/**\r\n\t   * Calculate the distance of this line to the point.\r\n\t   */\n\t\n\t\t}, {\n\t\t\tkey: 'distance',\n\t\t\tvalue: function distance(pt) {\n\t\t\t\tvar x = this.start.distance(pt);\n\t\t\t\tif (x == 0) return 0;\n\t\n\t\t\t\tvar l = this.length();\n\t\t\t\tvar cosa = new _Point2.default((this.end.x - this.start.x) / l, (this.end.y - this.start.y) / l).dotProduct(new _Point2.default(pt.x / x, pt.y / x));\n\t\n\t\t\t\treturn x * Math.sqrt(1 - cosa * cosa);\n\t\t\t}\n\t\n\t\t\t/**\r\n\t   * Function: intersection\r\n\t   *\r\n\t   * Returns the intersection of two lines as an <mxPoint>.\r\n\t   *\r\n\t   * Parameters:\r\n\t   *\r\n\t   * x0 - X-coordinate of the first line's startpoint.\r\n\t   * y0 - X-coordinate of the first line's startpoint.\r\n\t   * x1 - X-coordinate of the first line's endpoint.\r\n\t   * y1 - Y-coordinate of the first line's endpoint.\r\n\t   * x2 - X-coordinate of the second line's startpoint.\r\n\t   * y2 - Y-coordinate of the second line's startpoint.\r\n\t   * x3 - X-coordinate of the second line's endpoint.\r\n\t   * y3 - Y-coordinate of the second line's endpoint.\r\n\t   */\n\t\n\t\t}, {\n\t\t\tkey: 'toString',\n\t\t\tvalue: function toString() {\n\t\t\t\treturn 'Line:{start=' + this.start + ';end=' + this.end + '}';\n\t\t\t}\n\t\t}], [{\n\t\t\tkey: 'intersection',\n\t\t\tvalue: function intersection(x0, y0, x1, y1, x2, y2, x3, y3) {\n\t\t\t\tvar denom = (y3 - y2) * (x1 - x0) - (x3 - x2) * (y1 - y0);\n\t\t\t\tvar nume_a = (x3 - x2) * (y0 - y2) - (y3 - y2) * (x0 - x2);\n\t\t\t\tvar nume_b = (x1 - x0) * (y0 - y2) - (y1 - y0) * (x0 - x2);\n\t\n\t\t\t\tvar ua = nume_a / denom;\n\t\t\t\tvar ub = nume_b / denom;\n\t\n\t\t\t\tif (ua >= 0.0 && ua <= 1.0 && ub >= 0.0 && ub <= 1.0) {\n\t\t\t\t\t// Get the intersection point\n\t\t\t\t\tvar intersectionX = x0 + ua * (x1 - x0);\n\t\t\t\t\tvar intersectionY = y0 + ua * (y1 - y0);\n\t\n\t\t\t\t\treturn new _Point2.default(intersectionX, intersectionY);\n\t\t\t\t}\n\t\n\t\t\t\t// No intersection\n\t\t\t\treturn null;\n\t\t\t}\n\t\t}]);\n\t\n\t\treturn Line;\n\t}();\n\t\n\texports.default = Line;\n\n/***/ },\n/* 10 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t\tvalue: true\n\t});\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tvar _Shape2 = __webpack_require__(6);\n\t\n\tvar _Shape3 = _interopRequireDefault(_Shape2);\n\t\n\tvar _Point = __webpack_require__(3);\n\t\n\tvar _Point2 = _interopRequireDefault(_Point);\n\t\n\tvar _Rectangle = __webpack_require__(4);\n\t\n\tvar _Rectangle2 = _interopRequireDefault(_Rectangle);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\t\n\tfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\t\n\tvar Ellipse = function (_Shape) {\n\t\t_inherits(Ellipse, _Shape);\n\t\n\t\tfunction Ellipse() {\n\t\t\t_classCallCheck(this, Ellipse);\n\t\n\t\t\treturn _possibleConstructorReturn(this, (Ellipse.__proto__ || Object.getPrototypeOf(Ellipse)).apply(this, arguments));\n\t\t}\n\t\n\t\t_createClass(Ellipse, [{\n\t\t\tkey: \"toString\",\n\t\t\tvalue: function toString() {\n\t\t\t\treturn 'Ellipse:{x=' + this.x + ';y=' + this.y + ';width=' + this.width + ';height=' + this.height + '}';\n\t\t\t}\n\t\t}], [{\n\t\t\tkey: \"getPerimeter\",\n\t\t\tvalue: function getPerimeter(rect, pt) {\n\t\t\t\tvar orthogonal = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;\n\t\n\t\t\t\tvar a = rect.width / 2;\n\t\t\t\tvar b = rect.height / 2;\n\t\t\t\tvar cx = rect.x;\n\t\t\t\tvar cy = rect.y;\n\t\t\t\tvar px = pt.x;\n\t\t\t\tvar py = pt.y;\n\t\n\t\t\t\t// Calculates straight line equation through\n\t\t\t\t// point and ellipse center y = d * x + h\n\t\t\t\tvar dx = parseInt(px - cx);\n\t\t\t\tvar dy = parseInt(py - cy);\n\t\n\t\t\t\tvar tx, ty;\n\t\n\t\t\t\tif (dx == 0 && dy != 0) {\n\t\t\t\t\treturn new _Point2.default(cx, cy + b * dy / Math.abs(dy));\n\t\t\t\t} else if (dx == 0 && dy == 0) {\n\t\t\t\t\treturn new _Point2.default(px, py);\n\t\t\t\t}\n\t\n\t\t\t\t// Calculates intersection\n\t\t\t\tvar d = dy / dx;\n\t\t\t\tvar h = cy - d * cx;\n\t\t\t\tvar e = a * a * d * d + b * b;\n\t\t\t\tvar f = -2 * cx * e;\n\t\t\t\tvar g = a * a * d * d * cx * cx + b * b * cx * cx - a * a * b * b;\n\t\t\t\tvar det = Math.sqrt(f * f - 4 * e * g);\n\t\n\t\t\t\t// Two solutions (perimeter points)\n\t\t\t\tvar xout1 = (-f + det) / (2 * e);\n\t\t\t\tvar xout2 = (-f - det) / (2 * e);\n\t\t\t\tvar yout1 = d * xout1 + h;\n\t\t\t\tvar yout2 = d * xout2 + h;\n\t\t\t\tvar dist1 = Math.sqrt(Math.pow(xout1 - px, 2) + Math.pow(yout1 - py, 2));\n\t\t\t\tvar dist2 = Math.sqrt(Math.pow(xout2 - px, 2) + Math.pow(yout2 - py, 2));\n\t\n\t\t\t\t// Correct solution\n\t\t\t\tvar xout = 0;\n\t\t\t\tvar yout = 0;\n\t\n\t\t\t\tif (dist1 < dist2) {\n\t\t\t\t\txout = xout1;\n\t\t\t\t\tyout = yout1;\n\t\t\t\t} else {\n\t\t\t\t\txout = xout2;\n\t\t\t\t\tyout = yout2;\n\t\t\t\t}\n\t\n\t\t\t\tvar p = new _Point2.default(xout, yout);\n\t\t\t\tvar dir = _Rectangle2.default.getDirection(rect, p, orthogonal);\n\t\t\t\tif (orthogonal) {\n\t\t\t\t\tif (dir.x == -1) {\n\t\t\t\t\t\treturn { point: new _Point2.default(cx - a, cy), direction: dir };\n\t\t\t\t\t}\n\t\t\t\t\tif (dir.x == 1) {\n\t\t\t\t\t\treturn { point: new _Point2.default(cx + a, cy), direction: dir };\n\t\t\t\t\t}\n\t\t\t\t\tif (dir.y == -1) {\n\t\t\t\t\t\treturn { point: new _Point2.default(cx, cy - b), direction: dir };\n\t\t\t\t\t}\n\t\t\t\t\tif (dir.y == 1) {\n\t\t\t\t\t\treturn { point: new _Point2.default(cx, cy + b), direction: dir };\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn { point: p, direction: dir };\n\t\t\t}\n\t\t}]);\n\t\n\t\treturn Ellipse;\n\t}(_Shape3.default);\n\t\n\texports.default = Ellipse;\n\n/***/ },\n/* 11 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t\tvalue: true\n\t});\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tvar _lodash = __webpack_require__(5);\n\t\n\tvar _lodash2 = _interopRequireDefault(_lodash);\n\t\n\tvar _Point = __webpack_require__(3);\n\t\n\tvar _Point2 = _interopRequireDefault(_Point);\n\t\n\tvar _Utils = __webpack_require__(2);\n\t\n\tvar _Utils2 = _interopRequireDefault(_Utils);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\t\n\tfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tvar defaultConfig = {\n\t\ttype: \"direct\",\n\t\tshowGauge: true,\n\t\torthogonal: false\n\t};\n\t\n\tvar defaultGeometry = {\n\t\twidth: 0,\n\t\theight: 0,\n\t\tanchorX: 0,\n\t\tanchorY: 0,\n\t\toffsetX: 0,\n\t\toffsetY: 0\n\t};\n\t\n\tvar linkTypes = {};\n\t\n\tvar Link = function () {\n\t\tfunction Link(terminalVisual) {\n\t\t\tvar shapeConfig = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n\t\t\tvar startMarker = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : null;\n\t\t\tvar endMarker = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : null;\n\t\n\t\t\t_classCallCheck(this, Link);\n\t\n\t\t\tthis.start = terminalVisual[0].point;\n\t\t\tthis.end = terminalVisual[1].point;\n\t\t\tthis.startNormal = terminalVisual[0].direction;\n\t\t\tthis.endNormal = terminalVisual[1].direction;\n\t\t\tthis.startMarker = startMarker;\n\t\t\tthis.endMarker = endMarker;\n\t\t\t_lodash2.default.assign(this, shapeConfig);\n\t\t}\n\t\n\t\t_createClass(Link, [{\n\t\t\tkey: \"render\",\n\t\t\tvalue: function render(view) {\n\t\t\t\treturn view.renderLink(this);\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"getRelativePosition\",\n\t\n\t\n\t\t\t/**\n\t   * Calculate the position where to put modifiers or label..\n\t   *\n\t   * @param geometry: defines how far along the edge should the point be placed.\n\t   * @return *[] the relative position.\n\t   */\n\t\t\tvalue: function getRelativePosition(geometry) {\n\t\t\t\tif (_lodash2.default.isNumber(geometry)) geometry = { x: geometry };\n\t\t\t\tgeometry = _lodash2.default.defaults(geometry, defaultGeometry);\n\t\t\t\tvar p = geometry.x,\n\t\t\t\t    l = this.length;\n\t\t\t\tif (Math.abs(p) <= 1) p *= l;\n\t\t\t\tif (p < 0) p = l + p;\n\t\t\t\tif (p > l) p = l;\n\t\n\t\t\t\tvar points = this.points,\n\t\t\t\t    d = void 0,\n\t\t\t\t    point = void 0,\n\t\t\t\t    dir = void 0;\n\t\t\t\tfor (var i = 0; i < points.length - 1; i++) {\n\t\t\t\t\td = points[i].distance(points[i + 1]);\n\t\t\t\t\tif (p <= d) {\n\t\t\t\t\t\t// we've located the line segment.\n\t\t\t\t\t\tpoint = points[i].clone();\n\t\t\t\t\t\tdir = point.getDirection(points[i + 1]);\n\t\t\t\t\t\tpoint.translate(dir.getScaled(p));\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\tp -= d;\n\t\t\t\t}\n\t\n\t\t\t\t// return the last point.\n\t\t\t\tif (!point) point = points[points.length - 1];\n\t\t\t\treturn _Utils2.default.offsetPosition([point.x, point.y], geometry);\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"toString\",\n\t\t\tvalue: function toString() {\n\t\t\t\treturn 'Link';\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"points\",\n\t\t\tget: function get() {\n\t\t\t\treturn null;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"controlPts\",\n\t\t\tget: function get() {\n\t\t\t\treturn null;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"length\",\n\t\t\tget: function get() {\n\t\t\t\tvar points = this.points;\n\t\t\t\tvar i = void 0,\n\t\t\t\t    l = 0;\n\t\t\t\tfor (i = 0; i < points.length - 1; i++) {\n\t\t\t\t\tl += points[i].distance(points[i + 1]);\n\t\t\t\t}return l;\n\t\t\t}\n\t\t}], [{\n\t\t\tkey: \"getLink\",\n\t\t\tvalue: function getLink(terminalVisual) {\n\t\t\t\tvar shapeConfig = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n\t\t\t\tvar startMarker = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : null;\n\t\t\t\tvar endMarker = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : null;\n\t\n\t\t\t\tshapeConfig = _lodash2.default.defaultsDeep(shapeConfig, defaultConfig);\n\t\t\t\tvar linkClass = linkTypes[shapeConfig.type];\n\t\t\t\tif (linkClass) return new linkClass(terminalVisual, shapeConfig, startMarker, endMarker);\n\t\t\t\tconsole.log('link type not supported: ' + shapeConfig.type);\n\t\t\t\treturn null;\n\t\t\t}\n\t\t}]);\n\t\n\t\treturn Link;\n\t}();\n\t\n\tvar DirectLink = function (_Link) {\n\t\t_inherits(DirectLink, _Link);\n\t\n\t\tfunction DirectLink() {\n\t\t\t_classCallCheck(this, DirectLink);\n\t\n\t\t\treturn _possibleConstructorReturn(this, (DirectLink.__proto__ || Object.getPrototypeOf(DirectLink)).apply(this, arguments));\n\t\t}\n\t\n\t\t_createClass(DirectLink, [{\n\t\t\tkey: \"points\",\n\t\t\tget: function get() {\n\t\t\t\treturn [this.start, this.end];\n\t\t\t}\n\t\t}]);\n\t\n\t\treturn DirectLink;\n\t}(Link);\n\t\n\tvar BezierLink = function (_Link2) {\n\t\t_inherits(BezierLink, _Link2);\n\t\n\t\tfunction BezierLink() {\n\t\t\t_classCallCheck(this, BezierLink);\n\t\n\t\t\treturn _possibleConstructorReturn(this, (BezierLink.__proto__ || Object.getPrototypeOf(BezierLink)).apply(this, arguments));\n\t\t}\n\t\n\t\t_createClass(BezierLink, [{\n\t\t\tkey: \"getRelativePosition\",\n\t\t\tvalue: function getRelativePosition(geometry) {\n\t\t\t\tif (_lodash2.default.isNumber(geometry)) geometry = { x: geometry };\n\t\t\t\tgeometry = _lodash2.default.defaults(geometry, defaultGeometry);\n\t\t\t\tvar p = geometry.x,\n\t\t\t\t    l = this.length;\n\t\t\t\tif (Math.abs(p) > 1) p /= l;\n\t\t\t\tif (p < 0) p++;\n\t\t\t\tif (p > 1) p--;\n\t\n\t\t\t\tvar pts = this.points;\n\t\t\t\tvar ctrlpts = this.controlPts;\n\t\t\t\tvar p1 = pts[0];\n\t\t\t\tvar p2 = ctrlpts[1][0];\n\t\t\t\tvar p3 = ctrlpts[1][1];\n\t\t\t\tvar p4 = pts[1];\n\t\n\t\t\t\tvar point = [(1 - p) * (1 - p) * (1 - p) * p1.x + 3 * p * (1 - p) * (1 - p) * p2.x + 3 * p * p * (1 - p) * p3.x + p * p * p * p4.x, (1 - p) * (1 - p) * (1 - p) * p1.y + 3 * p * (1 - p) * (1 - p) * p2.y + 3 * p * p * (1 - p) * p3.y + p * p * p * p4.y];\n\t\t\t\treturn _Utils2.default.offsetPosition([point.x, point.y], geometry);\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"points\",\n\t\t\tget: function get() {\n\t\t\t\treturn [this.start, this.end];\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"controlPts\",\n\t\t\tget: function get() {\n\t\t\t\tvar s = this.points[0],\n\t\t\t\t    e = this.points[1];\n\t\t\t\tvar pts = [];\n\t\t\t\tpts[0] = null;\n\t\t\t\tpts[1] = [];\n\t\t\t\tif (this.startNormal.x == 0) {\n\t\t\t\t\tpts[1][0] = new _Point2.default(s.x, (s.y + e.y) / 2);\n\t\t\t\t} else {\n\t\t\t\t\tpts[1][0] = new _Point2.default((s.x + e.x) / 2, s.y);\n\t\t\t\t}\n\t\t\t\tif (this.endNormal.x == 0) {\n\t\t\t\t\tpts[1][1] = new _Point2.default(e.x, (s.y + e.y) / 2);\n\t\t\t\t} else {\n\t\t\t\t\tpts[1][1] = new _Point2.default((s.x + e.x) / 2, e.y);\n\t\t\t\t}\n\t\t\t\treturn pts;\n\t\t\t}\n\t\t}]);\n\t\n\t\treturn BezierLink;\n\t}(Link);\n\t\n\tvar EntityRelations = function (_Link3) {\n\t\t_inherits(EntityRelations, _Link3);\n\t\n\t\tfunction EntityRelations() {\n\t\t\t_classCallCheck(this, EntityRelations);\n\t\n\t\t\treturn _possibleConstructorReturn(this, (EntityRelations.__proto__ || Object.getPrototypeOf(EntityRelations)).apply(this, arguments));\n\t\t}\n\t\n\t\t_createClass(EntityRelations, [{\n\t\t\tkey: \"points\",\n\t\t\tget: function get() {\n\t\t\t\tvar source = Port.getBounds(edge, true);\n\t\t\t\tvar target = Port.getBounds(edge, false);\n\t\t\t\tvar isSourceLeft = target.right() < source.x;\n\t\t\t\tvar isTargetLeft = source.right() < target.x;\n\t\t\t\tvar result = [];\n\t\n\t\t\t\tvar x0 = isSourceLeft ? source.x : source.x + source.width;\n\t\t\t\tvar y0 = source.getCenterY();\n\t\t\t\tresult.push(new _Point2.default(x0, y0));\n\t\n\t\t\t\tvar xe = isTargetLeft ? target.x : target.x + target.width;\n\t\t\t\tvar ye = target.getCenterY();\n\t\n\t\t\t\tvar seg = this.segment;\n\t\n\t\t\t\tvar dx = isSourceLeft ? -seg : seg;\n\t\t\t\tvar dep = new _Point2.default(x0 + dx, y0);\n\t\n\t\t\t\tdx = isTargetLeft ? -seg : seg;\n\t\t\t\tvar arr = new _Point2.default(xe + dx, ye);\n\t\n\t\t\t\t// Adds intermediate points if both go out on same side\n\t\t\t\tif (isSourceLeft == isTargetLeft) {\n\t\t\t\t\tvar x = isSourceLeft ? Math.min(x0, xe) - seg : Math.max(x0, xe) + seg;\n\t\n\t\t\t\t\tresult.push(new _Point2.default(x, y0));\n\t\t\t\t\tresult.push(new _Point2.default(x, ye));\n\t\t\t\t} else if (dep.x < arr.x == isSourceLeft) {\n\t\t\t\t\tvar midY = y0 + (ye - y0) / 2;\n\t\n\t\t\t\t\tresult.push(dep);\n\t\t\t\t\tresult.push(new _Point2.default(dep.x, midY));\n\t\t\t\t\tresult.push(new _Point2.default(arr.x, midY));\n\t\t\t\t\tresult.push(arr);\n\t\t\t\t} else {\n\t\t\t\t\tresult.push(dep);\n\t\t\t\t\tresult.push(arr);\n\t\t\t\t}\n\t\n\t\t\t\tresult.push(new _Point2.default(xe, ye));\n\t\t\t\treturn result;\n\t\t\t}\n\t\t}]);\n\t\n\t\treturn EntityRelations;\n\t}(Link);\n\t\n\tvar Manhattan = function (_Link4) {\n\t\t_inherits(Manhattan, _Link4);\n\t\n\t\tfunction Manhattan(terminalVisual, shapeConfig, startMarker, endMarker) {\n\t\t\t_classCallCheck(this, Manhattan);\n\t\n\t\t\tshapeConfig = _lodash2.default.defaults(shapeConfig, {\n\t\t\t\tMIN_BUFFER: 10,\n\t\t\t\tautoRoute: false,\n\t\t\t\trandomNoise: 0,\n\t\t\t\tstep: 1,\n\t\t\t\tmaxChannelWidth: 100\n\t\t\t});\n\t\t\treturn _possibleConstructorReturn(this, (Manhattan.__proto__ || Object.getPrototypeOf(Manhattan)).call(this, terminalVisual, shapeConfig, startMarker, endMarker));\n\t\t}\n\t\n\t\t_createClass(Manhattan, [{\n\t\t\tkey: \"autoRoute\",\n\t\n\t\n\t\t\t/**\n\t   * Automatically route the connection to avoid intersections with other vertices.\n\t   */\n\t\t\tvalue: function autoRoute(pts, container, boxes, startBox, endBox) {\n\t\t\t\tvar side, side2, d, box, intersect, j;\n\t\t\t\tvar channel, channel2, pt, dir;\n\t\n\t\t\t\tvar startPadding = 0,\n\t\t\t\t    endPadding;\n\t\t\t\t// first get the start and end channel\n\t\t\t\tbox = boxes[endBox];\n\t\t\t\tpt = pts[pts.length - 2];\n\t\t\t\tif (pt.y < box.y) side = 1;else if (pt.y > box.y + box.height) side = 3;else if (pt.x < box.x) side = 0;else side = 2;\n\t\t\t\tchannel = _getChannel(container, endBox, boxes, side);\n\t\t\t\tendPadding = channel.horizontal ? (channel.right - channel.left) / 2 : (channel.bottom - channel.top) / 2;\n\t\n\t\t\t\tfor (var i = 0; i < pts.length - 1; i++) {\n\t\t\t\t\tif (pts[i + 1].x == pts[i].x && pts[i + 1].y == pts[i].y) continue;\n\t\t\t\t\tintersect = _getFirstIntersection(pts, i, boxes, startBox, endBox);\n\t\t\t\t\tif (!intersect) continue;\n\t\t\t\t\tj = intersect[0];\n\t\t\t\t\tside = intersect[1];\n\t\t\t\t\tbox = boxes[j];\n\t\t\t\t\tchannel = _getChannel(container, j, boxes, side);\n\t\t\t\t\tswitch (side) {\n\t\t\t\t\t\tcase 0:\n\t\t\t\t\t\tcase 2:\n\t\t\t\t\t\t\tpt = new _Point2.default((channel.right + channel.left) / 2, pts[i].y);\n\t\t\t\t\t\t\tdir = _getRouteTendency(pts, i, pt, box, side);\n\t\t\t\t\t\t\tside2 = dir < 0 ? 1 : 3;\n\t\t\t\t\t\t\tchannel2 = _getChannel(container, j, boxes, side2);\n\t\t\t\t\t\t\t// if the previous point is in the channel2, use that point instead of center of the channel.\n\t\t\t\t\t\t\tif (i > 1 && pts[i - 2].y == pts[i - 1].y && pts[i - 1].y > channel2.top && pts[i - 1].y < channel2.bottom) d = pts[i - 1].y - pt.y;else if (i < pts.length - 3 && pts[i + 2].y == pts[i + 3].y && pts[i + 2].y > channel2.top && pts[i + 2].y < channel2.bottom) d = pts[i + 2].y - pt.y;else d = (channel2.bottom + channel2.top) / 2 - pt.y;\n\t\t\t\t\t\t\t// check if we need this pt.\n\t\t\t\t\t\t\tif (side == 0 && pt.x <= pts[i].x || side == 2 && pt.x >= pts[i].x) pt = null;else if (i > 0) {\n\t\t\t\t\t\t\t\t// see if we can push the line out to where we started.\n\t\t\t\t\t\t\t\tif (!_hasIntersection([new _Point2.default(pts[i].x, pts[i].y), new _Point2.default(pts[i].x, pts[i].y + d), new _Point2.default(pt.x, pt.y + d)], boxes)) pt = null;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 1:\n\t\t\t\t\t\tcase 3:\n\t\t\t\t\t\t\tpt = new _Point2.default(pts[i].x, (channel.bottom + channel.top) / 2);\n\t\t\t\t\t\t\tdir = _getRouteTendency(pts, i, pt, box, side);\n\t\t\t\t\t\t\tside2 = dir < 0 ? 0 : 2;\n\t\t\t\t\t\t\tchannel2 = _getChannel(container, j, boxes, side2);\n\t\t\t\t\t\t\t// if the previous point is in the channel2, use that point instead of center of the channel.\n\t\t\t\t\t\t\tif (i > 1 && pts[i - 2].x == pts[i - 1].x && pts[i - 1].x > channel2.left && pts[i - 1].x < channel2.right) d = pts[i - 1].x - pt.x;else if (i < pts.length - 3 && pts[i + 2].x == pts[i + 3].x && pts[i + 2].x > channel2.left && pts[i + 2].x < channel2.right) d = pts[i + 2].x - pt.x;else d = (channel2.right + channel2.left) / 2 - pt.x;\n\t\t\t\t\t\t\t// check if we need this pt.\n\t\t\t\t\t\t\tif (side == 1 && pt.y <= pts[i].y || side == 3 && pt.y >= pts[i].y) pt = null;else if (i > 0) {\n\t\t\t\t\t\t\t\t// see if we can push the line out to where we started.\n\t\t\t\t\t\t\t\tif (!_hasIntersection([new _Point2.default(pts[i].x, pts[i].y), new _Point2.default(pts[i].x + d, pts[i].y), new _Point2.default(pt.x + d, pt.y)], boxes)) pt = null;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 4:\n\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\t\t\t\t\t// max points.\n\t\t\t\t\tif (i > 20) return;\n\t\t\t\t\tif (pt && (pt.x != pts[i].x || pt.y != pts[i].y)) {\n\t\t\t\t\t\tpts.splice(i + 1, 0, pt);\n\t\t\t\t\t\t_moveSegment(pts, i + 1, d, startPadding, endPadding);\n\t\t\t\t\t\ti++;\n\t\t\t\t\t} else _moveSegment(pts, i, d, startPadding, endPadding);\n\t\t\t\t}\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"_getRouteTendency\",\n\t\t\tvalue: function _getRouteTendency(pts, i, breakPt, box, side) {\n\t\t\t\tvar dir;\n\t\t\t\tvar p;\n\t\t\t\tswitch (side) {\n\t\t\t\t\tcase 0:\n\t\t\t\t\tcase 2:\n\t\t\t\t\t\tp = \"y\";\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 1:\n\t\t\t\t\tcase 3:\n\t\t\t\t\t\tp = \"x\";\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\t//first try the breakpt.\n\t\t\t\tdir = _getRouteDirection(breakPt, pts[pts.length - 1])[p];\n\t\t\t\tif (dir == 0) {\n\t\t\t\t\tdir = -_getRouteDirection(pts[0], pts[pts.length - 1])[p];\n\t\t\t\t\tif (dir == 0) {\n\t\t\t\t\t\tif (breakPt[p] < box.getCenter()[p]) dir = -1;else dir = 1;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn dir;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"_getChannel\",\n\t\t\tvalue: function _getChannel(container, index, boxes, side) {\n\t\t\t\tvar maxChannelWidth = this.maxChannelWidth;\n\t\t\t\tvar box1 = boxes[index],\n\t\t\t\t    box2;\n\t\t\t\tvar pt, i;\n\t\t\t\tvar channel = {},\n\t\t\t\t    l,\n\t\t\t\t    t,\n\t\t\t\t    b,\n\t\t\t\t    r;\n\t\t\t\tswitch (side) {\n\t\t\t\t\tcase 0:\n\t\t\t\t\t\tpt = box1.getLeft();\n\t\t\t\t\t\tchannel.right = pt.x;\n\t\t\t\t\t\tchannel.horizontal = false;\n\t\t\t\t\t\tfor (i = 0; i < boxes.length; i++) {\n\t\t\t\t\t\t\tif (i == index) continue;\n\t\t\t\t\t\t\tr = boxes[i].getRight().x;\n\t\t\t\t\t\t\tif (r >= pt.x) continue;\n\t\t\t\t\t\t\tif (!channel.left || channel.left < r) channel.left = r;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (!channel.left) {\n\t\t\t\t\t\t\tchannel.left = container.getLeft().x;\n\t\t\t\t\t\t\tif (channel.right - channel.left > maxChannelWidth) channel.left = channel.right - maxChannelWidth;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tfor (i = 0; i < boxes.length; i++) {\n\t\t\t\t\t\t\tif (i == index) continue;\n\t\t\t\t\t\t\tbox2 = boxes[i];\n\t\t\t\t\t\t\tb = box2.getBottom().y;\n\t\t\t\t\t\t\tt = box2.getTop().y;\n\t\t\t\t\t\t\tif (b < pt.y && box2.getRight() > channel.left && box2.getLeft() < channel.right) {\n\t\t\t\t\t\t\t\tif (!channel.top || channel.top < b) channel.top = b;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (t > pt.y && box2.getRight() > channel.left && box2.getLeft() < channel.right) {\n\t\t\t\t\t\t\t\tif (!channel.bottom || channel.bottom > t) channel.bottom = t;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (!channel.top) channel.top = container.getTop().y;\n\t\t\t\t\t\tif (!channel.bottom) channel.bottom = container.getBottom().y;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 1:\n\t\t\t\t\t\tpt = box1.getTop();\n\t\t\t\t\t\tchannel.horizontal = true;\n\t\t\t\t\t\tchannel.bottom = pt.y;\n\t\t\t\t\t\tfor (i = 0; i < boxes.length; i++) {\n\t\t\t\t\t\t\tif (i == index) continue;\n\t\t\t\t\t\t\tb = boxes[i].getBottom().y;\n\t\t\t\t\t\t\tif (b >= pt.y) continue;\n\t\t\t\t\t\t\tif (!channel.top || channel.top < b) channel.top = b;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (!channel.top) {\n\t\t\t\t\t\t\tchannel.top = container.getTop().y;\n\t\t\t\t\t\t\tif (channel.bottom - channel.top > maxChannelWidth) channel.top = channel.bottom - maxChannelWidth;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tfor (i = 0; i < boxes.length; i++) {\n\t\t\t\t\t\t\tif (i == index) continue;\n\t\t\t\t\t\t\tbox2 = boxes[i];\n\t\t\t\t\t\t\tl = box2.getLeft().x;\n\t\t\t\t\t\t\tr = box2.getRight().x;\n\t\t\t\t\t\t\tif (r < pt.x && box2.getBottom() > channel.top && box2.getTop() < channel.bottom) {\n\t\t\t\t\t\t\t\tif (!channel.left || channel.left < r) channel.left = r;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (l > pt.x && box2.getBottom() > channel.top && box2.getTop() < channel.bottom) {\n\t\t\t\t\t\t\t\tif (!channel.right || channel.right > l) channel.right = l;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (!channel.left) channel.left = container.getLeft().x;\n\t\t\t\t\t\tif (!channel.right) channel.right = container.getRight().x;\n\t\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 2:\n\t\t\t\t\t\tpt = box1.getRight();\n\t\t\t\t\t\tchannel.horizontal = false;\n\t\t\t\t\t\tchannel.left = pt.x;\n\t\t\t\t\t\tfor (i = 0; i < boxes.length; i++) {\n\t\t\t\t\t\t\tif (i == index) continue;\n\t\t\t\t\t\t\tl = boxes[i].getLeft().x;\n\t\t\t\t\t\t\tif (l <= pt.x) continue;\n\t\t\t\t\t\t\tif (!channel.right || channel.right > l) channel.right = l;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (!channel.right) {\n\t\t\t\t\t\t\tchannel.right = container.getRight().x;\n\t\t\t\t\t\t\tif (channel.right - channel.left > maxChannelWidth) channel.right = channel.left + maxChannelWidth;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tfor (i = 0; i < boxes.length; i++) {\n\t\t\t\t\t\t\tif (i == index) continue;\n\t\t\t\t\t\t\tbox2 = boxes[i];\n\t\t\t\t\t\t\tb = box2.getBottom().y;\n\t\t\t\t\t\t\tt = box2.getTop().y;\n\t\t\t\t\t\t\tif (b < pt.y && box2.getRight() > channel.left && box2.getLeft() < channel.right) {\n\t\t\t\t\t\t\t\tif (!channel.top || channel.top < b) channel.top = b;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (t > pt.y && box2.getRight() > channel.left && box2.getLeft() < channel.right) {\n\t\t\t\t\t\t\t\tif (!channel.bottom || channel.bottom > t) channel.bottom = t;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (!channel.top) channel.top = container.getTop().y;\n\t\t\t\t\t\tif (!channel.bottom) channel.bottom = container.getBottom().y;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 3:\n\t\t\t\t\t\tpt = box1.getBottom();\n\t\t\t\t\t\tchannel.horizontal = true;\n\t\t\t\t\t\tchannel.top = pt.y;\n\t\t\t\t\t\tfor (i = 0; i < boxes.length; i++) {\n\t\t\t\t\t\t\tif (i == index) continue;\n\t\t\t\t\t\t\tbox2 = boxes[i];\n\t\t\t\t\t\t\tif (box2.getTop().y <= pt.y) continue;\n\t\t\t\t\t\t\tif (!channel.bottom || channel.bottom > box2.getTop().y) channel.bottom = box2.getTop().y;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (!channel.bottom) {\n\t\t\t\t\t\t\tchannel.bottom = container.getBottom().y;\n\t\t\t\t\t\t\tif (channel.bottom - channel.top > maxChannelWidth) channel.bottom = channel.top + maxChannelWidth;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tfor (i = 0; i < boxes.length; i++) {\n\t\t\t\t\t\t\tif (i == index) continue;\n\t\t\t\t\t\t\tbox2 = boxes[i];\n\t\t\t\t\t\t\tl = box2.getLeft().x;\n\t\t\t\t\t\t\tr = box2.getRight().x;\n\t\t\t\t\t\t\tif (r < pt.x && box2.getBottom() > channel.top && box2.getTop() < channel.bottom) {\n\t\t\t\t\t\t\t\tif (!channel.left || channel.left < r) channel.left = r;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (l > pt.x && box2.getBottom() > channel.top && box2.getTop() < channel.bottom) {\n\t\t\t\t\t\t\t\tif (!channel.right || channel.right > l) channel.right = l;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (!channel.left) channel.left = container.getLeft().x;\n\t\t\t\t\t\tif (!channel.right) channel.right = container.getRight().x;\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\treturn channel;\n\t\t\t}\n\t\n\t\t\t/**\n\t   * Move a line segment by a specified distance.\n\t   *\n\t   * @param pts the list of points.\n\t   * @param i the index of the segment.\n\t   * @param d the distance to move.\n\t   * @param startPadding\n\t   * @param endPadding\n\t   */\n\t\n\t\t}, {\n\t\t\tkey: \"_moveSegment\",\n\t\t\tvalue: function _moveSegment(pts, i, d, startPadding, endPadding) {\n\t\t\t\t// first check if we need to add new line segments.\n\t\t\t\tvar dir, l, pt;\n\t\t\t\tif (i == 0) {\n\t\t\t\t\t// we need to break off the segment, since we can't change the starting point.\n\t\t\t\t\tdir = pts[0].getDirection(pts[1]);\n\t\t\t\t\tif (!startPadding) startPadding = this.MIN_BUFFER;\n\t\t\t\t\tl = Math.min(startPadding, pts[0].distance(pts[1]) / 2);\n\t\t\t\t\tpt = pts[0].getTranslated(dir.scale(l));\n\t\t\t\t\tpts.splice(1, 0, pt);\n\t\t\t\t\tthis._moveSegment(pts, i + 1, d);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tif (i == pts.length - 2) {\n\t\t\t\t\t// we need to break off the segment, since we can't change the end point.\n\t\t\t\t\tdir = pts[pts.length - 1].getDirection(pts[pts.length - 2]);\n\t\t\t\t\tif (!endPadding) endPadding = this.MIN_BUFFER;\n\t\t\t\t\tl = Math.min(endPadding, pts[pts.length - 1].distance(pts[pts.length - 2]) / 2);\n\t\t\t\t\tpt = pts[pts.length - 1].getTranslated(dir.scale(l));\n\t\t\t\t\tpts.splice(pts.length - 1, 0, pt);\n\t\t\t\t\tthis._moveSegment(pts, i, d);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\n\t\t\t\tif (pts[i].y == pts[i + 1].y) {\n\t\t\t\t\tif (i > 0 && pts[i - 1].y == pts[i].y) {\n\t\t\t\t\t\tpts.splice(i + 1, 0, pts[i].clone());\n\t\t\t\t\t\ti++;\n\t\t\t\t\t}\n\t\t\t\t\tif (i < pts.length - 2 && pts[i + 1].y == pts[i + 2].y) pts.splice(i + 1, 0, pts[i + 1].clone());\n\t\t\t\t\tpts[i].y += d;\n\t\t\t\t\tpts[i + 1].y += d;\n\t\t\t\t} else {\n\t\t\t\t\tif (i > 0 && pts[i - 1].x == pts[i].x) {\n\t\t\t\t\t\tpts.splice(i + 1, 0, pts[i].clone());\n\t\t\t\t\t\ti++;\n\t\t\t\t\t}\n\t\t\t\t\tif (i < pts.length - 2 && pts[i + 1].x == pts[i + 2].x) pts.splice(i + 1, 0, pts[i + 1].clone());\n\t\t\t\t\tpts[i].x += d;\n\t\t\t\t\tpts[i + 1].x += d;\n\t\t\t\t}\n\t\t\t}\n\t\n\t\t\t/**\n\t   * This method will merge the redundant segments.\n\t   */\n\t\n\t\t}, {\n\t\t\tkey: \"points\",\n\t\t\tget: function get() {\n\t\t\t\tvar pos = Manhattan.route(this.start, this.end, this.startNormal, this.endNormal, this.MIN_BUFFER);\n\t\t\t\tif (this.autoRoute) {\n\t\t\t\t\tthis._mergeSegments(pos);\n\t\t\t\t\tvar boxes = [],\n\t\t\t\t\t    node,\n\t\t\t\t\t    startBox,\n\t\t\t\t\t    endBox;\n\t\t\t\t\tvar container = edge.source.getCommonAncestor(edge.target);\n\t\t\t\t\tvar childNodes = container.getDescendants();\n\t\t\t\t\tvar index = 0;\n\t\t\t\t\tfor (var i = 0; i < childNodes.length; i++) {\n\t\t\t\t\t\tnode = childNodes[i];\n\t\t\t\t\t\t// Do not include source or target ancestors in routing.\n\t\t\t\t\t\tif (node.excludeFromRouting(edge) || node.isAncestor(edge.source) || node.isAncestor(edge.target)) continue;\n\t\t\t\t\t\tif (node == edge.source) startBox = index;\n\t\t\t\t\t\tif (node == edge.target) endBox = index;\n\t\t\t\t\t\tboxes.push(node.getBounds(document));\n\t\t\t\t\t\tindex++;\n\t\t\t\t\t}\n\t\t\t\t\tif (boxes.length > 1) this.autoRoute(pos, container.getBounds(document), boxes, startBox, endBox);\n\t\t\t\t}\n\t\t\t\tManhattan._mergeSegments(pos);\n\t\t\t\tif (this.randomNoise && pos.length > 3) {\n\t\t\t\t\tfor (var i = 1; i < pos.length - 2; i++) {\n\t\t\t\t\t\tvar range = this.randomNoise / this.step;\n\t\t\t\t\t\tvar randomNumber = Math.floor(Math.random() * range * 2 - range + 1) * this.step;\n\t\t\t\t\t\tthis._moveSegment(pos, i, randomNumber, 1, 1);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn pos;\n\t\t\t}\n\t\n\t\t\t//New function for finding route\n\t\n\t\t}], [{\n\t\t\tkey: \"route\",\n\t\t\tvalue: function route(start, end, startNormal, endNormal, buffer) {\n\t\t\t\tvar startBuffer = new _Point2.default(start.x + startNormal.x * buffer, start.y + startNormal.y * buffer);\n\t\t\t\tvar endBuffer = new _Point2.default(end.x + endNormal.x * buffer, end.y + endNormal.y * buffer);\n\t\t\t\tvar startBufferNormal, endBufferNormal;\n\t\t\t\tvar pts;\n\t\t\t\tif (startNormal.x != 0) {\n\t\t\t\t\tif ((endBuffer.x - startBuffer.x) / startNormal.x > 0) {\n\t\t\t\t\t\tstartBufferNormal = startNormal;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tstartBufferNormal = new _Point2.default(0, endBuffer.y >= startBuffer.y ? 1 : -1);\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tif ((endBuffer.y - startBuffer.y) / startNormal.y > 0) {\n\t\t\t\t\t\tstartBufferNormal = startNormal;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tstartBufferNormal = new _Point2.default(endBuffer.x >= startBuffer.x ? 1 : -1, 0);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (endNormal.x != 0) {\n\t\t\t\t\tif ((startBuffer.x - endBuffer.x) / endNormal.x > 0) {\n\t\t\t\t\t\tendBufferNormal = endNormal;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tendBufferNormal = new _Point2.default(0, startBuffer.y >= endBuffer.y ? 1 : -1);\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tif ((startBuffer.y - endBuffer.y) / endNormal.y > 0) {\n\t\t\t\t\t\tendBufferNormal = endNormal;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tendBufferNormal = new _Point2.default(startBuffer.x >= endBuffer.x ? 1 : -1, 0);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\n\t\t\t\tif (startBufferNormal.dotProduct(endBufferNormal) == 0) {\n\t\t\t\t\tvar middle = startBufferNormal.x == 0 ? new _Point2.default(startBuffer.x, endBuffer.y) : new _Point2.default(endBuffer.x, startBuffer.y);\n\t\t\t\t\tpts = [start, startBuffer, middle, endBuffer, end];\n\t\t\t\t} else if (startBufferNormal.dotProduct(endBufferNormal) < 0) {\n\t\t\t\t\tif (startBufferNormal.x == 0) {\n\t\t\t\t\t\tpts = [start, startBuffer, new _Point2.default(startBuffer.x, (start.y + end.y) / 2), new _Point2.default(endBuffer.x, (start.y + end.y) / 2), endBuffer, end];\n\t\t\t\t\t} else {\n\t\t\t\t\t\tpts = [start, startBuffer, new _Point2.default((start.x + end.x) / 2, startBuffer.y), new _Point2.default((start.x + end.x) / 2, endBuffer.y), endBuffer, end];\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tpts = [start, startBuffer, new _Point2.default(startBuffer.x + startBufferNormal.x * buffer, startBuffer.y + startBufferNormal.y * buffer), new _Point2.default(endBuffer.x + endBufferNormal.x * buffer, endBuffer.y + endBufferNormal.y * buffer), endBuffer, end];\n\t\t\t\t}\n\t\n\t\t\t\tvar prunePts = [];\n\t\t\t\tprunePts[0] = pts[0];\n\t\t\t\tfor (var i = 1; i < pts.length - 1; i++) {\n\t\t\t\t\tif (pts[i].x == pts[i - 1].x && pts[i].x == pts[i + 1].x || pts[i].y == pts[i - 1].y && pts[i].y == pts[i + 1].y) {\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\t\t\t\t\tprunePts.push(pts[i]);\n\t\t\t\t}\n\t\t\t\tprunePts.push(pts[pts.length - 1]);\n\t\t\t\treturn prunePts;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"_hasIntersection\",\n\t\t\tvalue: function _hasIntersection(pts, boxes) {\n\t\t\t\tfor (var i = 0; i < pts.length - 1; i++) {\n\t\t\t\t\tfor (var j = 0; j < boxes.length; j++) {\n\t\t\t\t\t\tif (boxes[j].detectIntersection(pts[i], pts[i + 1]) >= 0) return true;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"_getFirstIntersection\",\n\t\t\tvalue: function _getFirstIntersection(pts, i, boxes, startBox, endBox) {\n\t\t\t\tvar box,\n\t\t\t\t    side,\n\t\t\t\t    savedIndex = null,\n\t\t\t\t    savedSide = null;\n\t\t\t\tfor (var j = 0; j < boxes.length; j++) {\n\t\t\t\t\tif (i == 0 && j == startBox || i == pts.length - 2 && j == endBox) continue;\n\t\t\t\t\tbox = boxes[j];\n\t\t\t\t\tside = box.detectIntersection(pts[i], pts[i + 1]);\n\t\t\t\t\tif (side >= 0) {\n\t\t\t\t\t\tif (savedIndex == null) {\n\t\t\t\t\t\t\tsavedIndex = j;\n\t\t\t\t\t\t\tsavedSide = side;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tif (boxes[savedIndex].distance(pts[i]) > box.distance(pts[i])) {\n\t\t\t\t\t\t\t\tsavedIndex = j;\n\t\t\t\t\t\t\t\tsavedSide = side;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (savedIndex != null) return [savedIndex, savedSide];\n\t\t\t\treturn null;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"_getRouteDirection\",\n\t\t\tvalue: function _getRouteDirection(pt1, pt2) {\n\t\t\t\tif (pt1.x == pt2.x) {\n\t\t\t\t\tif (pt1.y < pt2.y) return _Point2.default.S;\n\t\t\t\t\treturn _Point2.default.N;\n\t\t\t\t} else if (pt1.y == pt2.y) {\n\t\t\t\t\tif (pt1.x < pt2.x) return _Point2.default.E;\n\t\t\t\t\treturn _Point2.default.W;\n\t\t\t\t} else if (pt1.x < pt2.x) {\n\t\t\t\t\tif (pt1.y < pt2.y) return _Point2.default.SE;\n\t\t\t\t\treturn _Point2.default.NE;\n\t\t\t\t} else {\n\t\t\t\t\tif (pt1.y < pt2.y) return _Point2.default.SW;\n\t\t\t\t\treturn _Point2.default.NW;\n\t\t\t\t}\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"_mergeSegments\",\n\t\t\tvalue: function _mergeSegments(pts) {\n\t\t\t\tvar h1 = pts[pts.length - 1].y == pts[pts.length - 2].y;\n\t\t\t\tvar h2;\n\t\t\t\tfor (var i = pts.length - 2; i >= 1; i--) {\n\t\t\t\t\th2 = pts[i].y == pts[i - 1].y;\n\t\t\t\t\tif (h2 == h1 || pts[i].equals(pts[i - 1])) pts.splice(i, 1);else h1 = !h1;\n\t\t\t\t}\n\t\t\t}\n\t\t}]);\n\t\n\t\treturn Manhattan;\n\t}(Link);\n\t\n\tlinkTypes['direct'] = DirectLink;\n\tlinkTypes['bezier'] = BezierLink;\n\tlinkTypes['entityRelations'] = EntityRelations;\n\tlinkTypes['manhattan'] = Manhattan;\n\t\n\texports.default = Link;\n\n/***/ },\n/* 12 */\n/***/ function(module, exports, __webpack_require__) {\n\n\tvar __WEBPACK_AMD_DEFINE_FACTORY__, __WEBPACK_AMD_DEFINE_RESULT__;/*!\n\t  * Bean - copyright (c) Jacob Thornton 2011-2012\n\t  * https://github.com/fat/bean\n\t  * MIT license\n\t  */\n\t(function (name, context, definition) {\n\t  if (typeof module != 'undefined' && module.exports) module.exports = definition()\n\t  else if (true) !(__WEBPACK_AMD_DEFINE_FACTORY__ = (definition), __WEBPACK_AMD_DEFINE_RESULT__ = (typeof __WEBPACK_AMD_DEFINE_FACTORY__ === 'function' ? (__WEBPACK_AMD_DEFINE_FACTORY__.call(exports, __webpack_require__, exports, module)) : __WEBPACK_AMD_DEFINE_FACTORY__), __WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__))\n\t  else context[name] = definition()\n\t})('bean', this, function (name, context) {\n\t  name    = name    || 'bean'\n\t  context = context || this\n\t\n\t  var win            = window\n\t    , old            = context[name]\n\t    , namespaceRegex = /[^\\.]*(?=\\..*)\\.|.*/\n\t    , nameRegex      = /\\..*/\n\t    , addEvent       = 'addEventListener'\n\t    , removeEvent    = 'removeEventListener'\n\t    , doc            = document || {}\n\t    , root           = doc.documentElement || {}\n\t    , W3C_MODEL      = root[addEvent]\n\t    , eventSupport   = W3C_MODEL ? addEvent : 'attachEvent'\n\t    , ONE            = {} // singleton for quick matching making add() do one()\n\t\n\t    , slice          = Array.prototype.slice\n\t    , str2arr        = function (s, d) { return s.split(d || ' ') }\n\t    , isString       = function (o) { return typeof o == 'string' }\n\t    , isFunction     = function (o) { return typeof o == 'function' }\n\t\n\t      // events that we consider to be 'native', anything not in this list will\n\t      // be treated as a custom event\n\t    , standardNativeEvents =\n\t        'click dblclick mouseup mousedown contextmenu '                  + // mouse buttons\n\t        'mousewheel mousemultiwheel DOMMouseScroll '                     + // mouse wheel\n\t        'mouseover mouseout mousemove selectstart selectend '            + // mouse movement\n\t        'keydown keypress keyup '                                        + // keyboard\n\t        'orientationchange '                                             + // mobile\n\t        'focus blur change reset select submit '                         + // form elements\n\t        'load unload beforeunload resize move DOMContentLoaded '         + // window\n\t        'readystatechange message '                                      + // window\n\t        'error abort scroll '                                              // misc\n\t      // element.fireEvent('onXYZ'... is not forgiving if we try to fire an event\n\t      // that doesn't actually exist, so make sure we only do these on newer browsers\n\t    , w3cNativeEvents =\n\t        'show '                                                          + // mouse buttons\n\t        'input invalid '                                                 + // form elements\n\t        'touchstart touchmove touchend touchcancel '                     + // touch\n\t        'gesturestart gesturechange gestureend '                         + // gesture\n\t        'textinput '                                                     + // TextEvent\n\t        'readystatechange pageshow pagehide popstate '                   + // window\n\t        'hashchange offline online '                                     + // window\n\t        'afterprint beforeprint '                                        + // printing\n\t        'dragstart dragenter dragover dragleave drag drop dragend '      + // dnd\n\t        'loadstart progress suspend emptied stalled loadmetadata '       + // media\n\t        'loadeddata canplay canplaythrough playing waiting seeking '     + // media\n\t        'seeked ended durationchange timeupdate play pause ratechange '  + // media\n\t        'volumechange cuechange '                                        + // media\n\t        'checking noupdate downloading cached updateready obsolete '       // appcache\n\t\n\t      // convert to a hash for quick lookups\n\t    , nativeEvents = (function (hash, events, i) {\n\t        for (i = 0; i < events.length; i++) events[i] && (hash[events[i]] = 1)\n\t        return hash\n\t      }({}, str2arr(standardNativeEvents + (W3C_MODEL ? w3cNativeEvents : ''))))\n\t\n\t      // custom events are events that we *fake*, they are not provided natively but\n\t      // we can use native events to generate them\n\t    , customEvents = (function () {\n\t        var isAncestor = 'compareDocumentPosition' in root\n\t              ? function (element, container) {\n\t                  return container.compareDocumentPosition && (container.compareDocumentPosition(element) & 16) === 16\n\t                }\n\t              : 'contains' in root\n\t                ? function (element, container) {\n\t                    container = container.nodeType === 9 || container === window ? root : container\n\t                    return container !== element && container.contains(element)\n\t                  }\n\t                : function (element, container) {\n\t                    while (element = element.parentNode) if (element === container) return 1\n\t                    return 0\n\t                  }\n\t          , check = function (event) {\n\t              var related = event.relatedTarget\n\t              return !related\n\t                ? related == null\n\t                : (related !== this && related.prefix !== 'xul' && !/document/.test(this.toString())\n\t                    && !isAncestor(related, this))\n\t            }\n\t\n\t        return {\n\t            mouseenter: { base: 'mouseover', condition: check }\n\t          , mouseleave: { base: 'mouseout', condition: check }\n\t          , mousewheel: { base: /Firefox/.test(navigator.userAgent) ? 'DOMMouseScroll' : 'mousewheel' }\n\t        }\n\t      }())\n\t\n\t      // we provide a consistent Event object across browsers by taking the actual DOM\n\t      // event object and generating a new one from its properties.\n\t    , Event = (function () {\n\t            // a whitelist of properties (for different event types) tells us what to check for and copy\n\t        var commonProps  = str2arr('altKey attrChange attrName bubbles cancelable ctrlKey currentTarget ' +\n\t              'detail eventPhase getModifierState isTrusted metaKey relatedNode relatedTarget shiftKey '  +\n\t              'srcElement target timeStamp type view which propertyName')\n\t          , mouseProps   = commonProps.concat(str2arr('button buttons clientX clientY dataTransfer '      +\n\t              'fromElement offsetX offsetY pageX pageY screenX screenY toElement'))\n\t          , mouseWheelProps = mouseProps.concat(str2arr('wheelDelta wheelDeltaX wheelDeltaY wheelDeltaZ ' +\n\t              'axis')) // 'axis' is FF specific\n\t          , keyProps     = commonProps.concat(str2arr('char charCode key keyCode keyIdentifier '          +\n\t              'keyLocation location'))\n\t          , textProps    = commonProps.concat(str2arr('data'))\n\t          , touchProps   = commonProps.concat(str2arr('touches targetTouches changedTouches scale rotation'))\n\t          , messageProps = commonProps.concat(str2arr('data origin source'))\n\t          , stateProps   = commonProps.concat(str2arr('state'))\n\t          , overOutRegex = /over|out/\n\t            // some event types need special handling and some need special properties, do that all here\n\t          , typeFixers   = [\n\t                { // key events\n\t                    reg: /key/i\n\t                  , fix: function (event, newEvent) {\n\t                      newEvent.keyCode = event.keyCode || event.which\n\t                      return keyProps\n\t                    }\n\t                }\n\t              , { // mouse events\n\t                    reg: /click|mouse(?!(.*wheel|scroll))|menu|drag|drop/i\n\t                  , fix: function (event, newEvent, type) {\n\t                      newEvent.rightClick = event.which === 3 || event.button === 2\n\t                      newEvent.pos = { x: 0, y: 0 }\n\t                      if (event.pageX || event.pageY) {\n\t                        newEvent.clientX = event.pageX\n\t                        newEvent.clientY = event.pageY\n\t                      } else if (event.clientX || event.clientY) {\n\t                        newEvent.clientX = event.clientX + doc.body.scrollLeft + root.scrollLeft\n\t                        newEvent.clientY = event.clientY + doc.body.scrollTop + root.scrollTop\n\t                      }\n\t                      if (overOutRegex.test(type)) {\n\t                        newEvent.relatedTarget = event.relatedTarget\n\t                          || event[(type == 'mouseover' ? 'from' : 'to') + 'Element']\n\t                      }\n\t                      return mouseProps\n\t                    }\n\t                }\n\t              , { // mouse wheel events\n\t                    reg: /mouse.*(wheel|scroll)/i\n\t                  , fix: function () { return mouseWheelProps }\n\t                }\n\t              , { // TextEvent\n\t                    reg: /^text/i\n\t                  , fix: function () { return textProps }\n\t                }\n\t              , { // touch and gesture events\n\t                    reg: /^touch|^gesture/i\n\t                  , fix: function () { return touchProps }\n\t                }\n\t              , { // message events\n\t                    reg: /^message$/i\n\t                  , fix: function () { return messageProps }\n\t                }\n\t              , { // popstate events\n\t                    reg: /^popstate$/i\n\t                  , fix: function () { return stateProps }\n\t                }\n\t              , { // everything else\n\t                    reg: /.*/\n\t                  , fix: function () { return commonProps }\n\t                }\n\t            ]\n\t          , typeFixerMap = {} // used to map event types to fixer functions (above), a basic cache mechanism\n\t\n\t          , Event = function (event, element, isNative) {\n\t              if (!arguments.length) return\n\t              event = event || ((element.ownerDocument || element.document || element).parentWindow || win).event\n\t              this.originalEvent = event\n\t              this.isNative       = isNative\n\t              this.isBean         = true\n\t\n\t              if (!event) return\n\t\n\t              var type   = event.type\n\t                , target = event.target || event.srcElement\n\t                , i, l, p, props, fixer\n\t\n\t              this.target = target && target.nodeType === 3 ? target.parentNode : target\n\t\n\t              if (isNative) { // we only need basic augmentation on custom events, the rest expensive & pointless\n\t                fixer = typeFixerMap[type]\n\t                if (!fixer) { // haven't encountered this event type before, map a fixer function for it\n\t                  for (i = 0, l = typeFixers.length; i < l; i++) {\n\t                    if (typeFixers[i].reg.test(type)) { // guaranteed to match at least one, last is .*\n\t                      typeFixerMap[type] = fixer = typeFixers[i].fix\n\t                      break\n\t                    }\n\t                  }\n\t                }\n\t\n\t                props = fixer(event, this, type)\n\t                for (i = props.length; i--;) {\n\t                  if (!((p = props[i]) in this) && p in event) this[p] = event[p]\n\t                }\n\t              }\n\t            }\n\t\n\t        // preventDefault() and stopPropagation() are a consistent interface to those functions\n\t        // on the DOM, stop() is an alias for both of them together\n\t        Event.prototype.preventDefault = function () {\n\t          if (this.originalEvent.preventDefault) this.originalEvent.preventDefault()\n\t          else this.originalEvent.returnValue = false\n\t        }\n\t        Event.prototype.stopPropagation = function () {\n\t          if (this.originalEvent.stopPropagation) this.originalEvent.stopPropagation()\n\t          else this.originalEvent.cancelBubble = true\n\t        }\n\t        Event.prototype.stop = function () {\n\t          this.preventDefault()\n\t          this.stopPropagation()\n\t          this.stopped = true\n\t        }\n\t        // stopImmediatePropagation() has to be handled internally because we manage the event list for\n\t        // each element\n\t        // note that originalElement may be a Bean#Event object in some situations\n\t        Event.prototype.stopImmediatePropagation = function () {\n\t          if (this.originalEvent.stopImmediatePropagation) this.originalEvent.stopImmediatePropagation()\n\t          this.isImmediatePropagationStopped = function () { return true }\n\t        }\n\t        Event.prototype.isImmediatePropagationStopped = function () {\n\t          return this.originalEvent.isImmediatePropagationStopped && this.originalEvent.isImmediatePropagationStopped()\n\t        }\n\t        Event.prototype.clone = function (currentTarget) {\n\t          //TODO: this is ripe for optimisation, new events are *expensive*\n\t          // improving this will speed up delegated events\n\t          var ne = new Event(this, this.element, this.isNative)\n\t          ne.currentTarget = currentTarget\n\t          return ne\n\t        }\n\t\n\t        return Event\n\t      }())\n\t\n\t      // if we're in old IE we can't do onpropertychange on doc or win so we use doc.documentElement for both\n\t    , targetElement = function (element, isNative) {\n\t        return !W3C_MODEL && !isNative && (element === doc || element === win) ? root : element\n\t      }\n\t\n\t      /**\n\t        * Bean maintains an internal registry for event listeners. We don't touch elements, objects\n\t        * or functions to identify them, instead we store everything in the registry.\n\t        * Each event listener has a RegEntry object, we have one 'registry' for the whole instance.\n\t        */\n\t    , RegEntry = (function () {\n\t        // each handler is wrapped so we can handle delegation and custom events\n\t        var wrappedHandler = function (element, fn, condition, args) {\n\t            var call = function (event, eargs) {\n\t                  return fn.apply(element, args ? slice.call(eargs, event ? 0 : 1).concat(args) : eargs)\n\t                }\n\t              , findTarget = function (event, eventElement) {\n\t                  return fn.__beanDel ? fn.__beanDel.ft(event.target, element) : eventElement\n\t                }\n\t              , handler = condition\n\t                  ? function (event) {\n\t                      var target = findTarget(event, this) // deleated event\n\t                      if (condition.apply(target, arguments)) {\n\t                        if (event) event.currentTarget = target\n\t                        return call(event, arguments)\n\t                      }\n\t                    }\n\t                  : function (event) {\n\t                      if (fn.__beanDel) event = event.clone(findTarget(event)) // delegated event, fix the fix\n\t                      return call(event, arguments)\n\t                    }\n\t            handler.__beanDel = fn.__beanDel\n\t            return handler\n\t          }\n\t\n\t        , RegEntry = function (element, type, handler, original, namespaces, args, root) {\n\t            var customType     = customEvents[type]\n\t              , isNative\n\t\n\t            if (type == 'unload') {\n\t              // self clean-up\n\t              handler = once(removeListener, element, type, handler, original)\n\t            }\n\t\n\t            if (customType) {\n\t              if (customType.condition) {\n\t                handler = wrappedHandler(element, handler, customType.condition, args)\n\t              }\n\t              type = customType.base || type\n\t            }\n\t\n\t            this.isNative      = isNative = nativeEvents[type] && !!element[eventSupport]\n\t            this.customType    = !W3C_MODEL && !isNative && type\n\t            this.element       = element\n\t            this.type          = type\n\t            this.original      = original\n\t            this.namespaces    = namespaces\n\t            this.eventType     = W3C_MODEL || isNative ? type : 'propertychange'\n\t            this.target        = targetElement(element, isNative)\n\t            this[eventSupport] = !!this.target[eventSupport]\n\t            this.root          = root\n\t            this.handler       = wrappedHandler(element, handler, null, args)\n\t          }\n\t\n\t        // given a list of namespaces, is our entry in any of them?\n\t        RegEntry.prototype.inNamespaces = function (checkNamespaces) {\n\t          var i, j, c = 0\n\t          if (!checkNamespaces) return true\n\t          if (!this.namespaces) return false\n\t          for (i = checkNamespaces.length; i--;) {\n\t            for (j = this.namespaces.length; j--;) {\n\t              if (checkNamespaces[i] == this.namespaces[j]) c++\n\t            }\n\t          }\n\t          return checkNamespaces.length === c\n\t        }\n\t\n\t        // match by element, original fn (opt), handler fn (opt)\n\t        RegEntry.prototype.matches = function (checkElement, checkOriginal, checkHandler) {\n\t          return this.element === checkElement &&\n\t            (!checkOriginal || this.original === checkOriginal) &&\n\t            (!checkHandler || this.handler === checkHandler)\n\t        }\n\t\n\t        return RegEntry\n\t      }())\n\t\n\t    , registry = (function () {\n\t        // our map stores arrays by event type, just because it's better than storing\n\t        // everything in a single array.\n\t        // uses '$' as a prefix for the keys for safety and 'r' as a special prefix for\n\t        // rootListeners so we can look them up fast\n\t        var map = {}\n\t\n\t          // generic functional search of our registry for matching listeners,\n\t          // `fn` returns false to break out of the loop\n\t          , forAll = function (element, type, original, handler, root, fn) {\n\t              var pfx = root ? 'r' : '$'\n\t              if (!type || type == '*') {\n\t                // search the whole registry\n\t                for (var t in map) {\n\t                  if (t.charAt(0) == pfx) {\n\t                    forAll(element, t.substr(1), original, handler, root, fn)\n\t                  }\n\t                }\n\t              } else {\n\t                var i = 0, l, list = map[pfx + type], all = element == '*'\n\t                if (!list) return\n\t                for (l = list.length; i < l; i++) {\n\t                  if ((all || list[i].matches(element, original, handler)) && !fn(list[i], list, i, type)) return\n\t                }\n\t              }\n\t            }\n\t\n\t          , has = function (element, type, original, root) {\n\t              // we're not using forAll here simply because it's a bit slower and this\n\t              // needs to be fast\n\t              var i, list = map[(root ? 'r' : '$') + type]\n\t              if (list) {\n\t                for (i = list.length; i--;) {\n\t                  if (!list[i].root && list[i].matches(element, original, null)) return true\n\t                }\n\t              }\n\t              return false\n\t            }\n\t\n\t          , get = function (element, type, original, root) {\n\t              var entries = []\n\t              forAll(element, type, original, null, root, function (entry) {\n\t                return entries.push(entry)\n\t              })\n\t              return entries\n\t            }\n\t\n\t          , put = function (entry) {\n\t              var has = !entry.root && !this.has(entry.element, entry.type, null, false)\n\t                , key = (entry.root ? 'r' : '$') + entry.type\n\t              ;(map[key] || (map[key] = [])).push(entry)\n\t              return has\n\t            }\n\t\n\t          , del = function (entry) {\n\t              forAll(entry.element, entry.type, null, entry.handler, entry.root, function (entry, list, i) {\n\t                list.splice(i, 1)\n\t                entry.removed = true\n\t                if (list.length === 0) delete map[(entry.root ? 'r' : '$') + entry.type]\n\t                return false\n\t              })\n\t            }\n\t\n\t            // dump all entries, used for onunload\n\t          , entries = function () {\n\t              var t, entries = []\n\t              for (t in map) {\n\t                if (t.charAt(0) == '$') entries = entries.concat(map[t])\n\t              }\n\t              return entries\n\t            }\n\t\n\t        return { has: has, get: get, put: put, del: del, entries: entries }\n\t      }())\n\t\n\t      // we need a selector engine for delegated events, use querySelectorAll if it exists\n\t      // but for older browsers we need Qwery, Sizzle or similar\n\t    , selectorEngine\n\t    , setSelectorEngine = function (e) {\n\t        if (!arguments.length) {\n\t          selectorEngine = doc.querySelectorAll\n\t            ? function (s, r) {\n\t                return r.querySelectorAll(s)\n\t              }\n\t            : function () {\n\t                throw new Error('Bean: No selector engine installed') // eeek\n\t              }\n\t        } else {\n\t          selectorEngine = e\n\t        }\n\t      }\n\t\n\t      // we attach this listener to each DOM event that we need to listen to, only once\n\t      // per event type per DOM element\n\t    , rootListener = function (event, type) {\n\t        if (!W3C_MODEL && type && event && event.propertyName != '_on' + type) return\n\t\n\t        var listeners = registry.get(this, type || event.type, null, false)\n\t          , l = listeners.length\n\t          , i = 0\n\t\n\t        event = new Event(event, this, true)\n\t        if (type) event.type = type\n\t\n\t        // iterate through all handlers registered for this type, calling them unless they have\n\t        // been removed by a previous handler or stopImmediatePropagation() has been called\n\t        for (; i < l && !event.isImmediatePropagationStopped(); i++) {\n\t          if (!listeners[i].removed) listeners[i].handler.call(this, event)\n\t        }\n\t      }\n\t\n\t      // add and remove listeners to DOM elements\n\t    , listener = W3C_MODEL\n\t        ? function (element, type, add) {\n\t            // new browsers\n\t            element[add ? addEvent : removeEvent](type, rootListener, false)\n\t          }\n\t        : function (element, type, add, custom) {\n\t            // IE8 and below, use attachEvent/detachEvent and we have to piggy-back propertychange events\n\t            // to simulate event bubbling etc.\n\t            var entry\n\t            if (add) {\n\t              registry.put(entry = new RegEntry(\n\t                  element\n\t                , custom || type\n\t                , function (event) { // handler\n\t                    rootListener.call(element, event, custom)\n\t                  }\n\t                , rootListener\n\t                , null\n\t                , null\n\t                , true // is root\n\t              ))\n\t              if (custom && element['_on' + custom] == null) element['_on' + custom] = 0\n\t              entry.target.attachEvent('on' + entry.eventType, entry.handler)\n\t            } else {\n\t              entry = registry.get(element, custom || type, rootListener, true)[0]\n\t              if (entry) {\n\t                entry.target.detachEvent('on' + entry.eventType, entry.handler)\n\t                registry.del(entry)\n\t              }\n\t            }\n\t          }\n\t\n\t    , once = function (rm, element, type, fn, originalFn) {\n\t        // wrap the handler in a handler that does a remove as well\n\t        return function () {\n\t          fn.apply(this, arguments)\n\t          rm(element, type, originalFn)\n\t        }\n\t      }\n\t\n\t    , removeListener = function (element, orgType, handler, namespaces) {\n\t        var type     = orgType && orgType.replace(nameRegex, '')\n\t          , handlers = registry.get(element, type, null, false)\n\t          , removed  = {}\n\t          , i, l\n\t\n\t        for (i = 0, l = handlers.length; i < l; i++) {\n\t          if ((!handler || handlers[i].original === handler) && handlers[i].inNamespaces(namespaces)) {\n\t            // TODO: this is problematic, we have a registry.get() and registry.del() that\n\t            // both do registry searches so we waste cycles doing this. Needs to be rolled into\n\t            // a single registry.forAll(fn) that removes while finding, but the catch is that\n\t            // we'll be splicing the arrays that we're iterating over. Needs extra tests to\n\t            // make sure we don't screw it up. @rvagg\n\t            registry.del(handlers[i])\n\t            if (!removed[handlers[i].eventType] && handlers[i][eventSupport])\n\t              removed[handlers[i].eventType] = { t: handlers[i].eventType, c: handlers[i].type }\n\t          }\n\t        }\n\t        // check each type/element for removed listeners and remove the rootListener where it's no longer needed\n\t        for (i in removed) {\n\t          if (!registry.has(element, removed[i].t, null, false)) {\n\t            // last listener of this type, remove the rootListener\n\t            listener(element, removed[i].t, false, removed[i].c)\n\t          }\n\t        }\n\t      }\n\t\n\t      // set up a delegate helper using the given selector, wrap the handler function\n\t    , delegate = function (selector, fn) {\n\t        //TODO: findTarget (therefore $) is called twice, once for match and once for\n\t        // setting e.currentTarget, fix this so it's only needed once\n\t        var findTarget = function (target, root) {\n\t              var i, array = isString(selector) ? selectorEngine(selector, root) : selector\n\t              for (; target && target !== root; target = target.parentNode) {\n\t                for (i = array.length; i--;) {\n\t                  if (array[i] === target) return target\n\t                }\n\t              }\n\t            }\n\t          , handler = function (e) {\n\t              var match = findTarget(e.target, this)\n\t              if (match) fn.apply(match, arguments)\n\t            }\n\t\n\t        // __beanDel isn't pleasant but it's a private function, not exposed outside of Bean\n\t        handler.__beanDel = {\n\t            ft       : findTarget // attach it here for customEvents to use too\n\t          , selector : selector\n\t        }\n\t        return handler\n\t      }\n\t\n\t    , fireListener = W3C_MODEL ? function (isNative, type, element) {\n\t        // modern browsers, do a proper dispatchEvent()\n\t        var evt = doc.createEvent(isNative ? 'HTMLEvents' : 'UIEvents')\n\t        evt[isNative ? 'initEvent' : 'initUIEvent'](type, true, true, win, 1)\n\t        element.dispatchEvent(evt)\n\t      } : function (isNative, type, element) {\n\t        // old browser use onpropertychange, just increment a custom property to trigger the event\n\t        element = targetElement(element, isNative)\n\t        isNative ? element.fireEvent('on' + type, doc.createEventObject()) : element['_on' + type]++\n\t      }\n\t\n\t      /**\n\t        * Public API: off(), on(), add(), (remove()), one(), fire(), clone()\n\t        */\n\t\n\t      /**\n\t        * off(element[, eventType(s)[, handler ]])\n\t        */\n\t    , off = function (element, typeSpec, fn) {\n\t        var isTypeStr = isString(typeSpec)\n\t          , k, type, namespaces, i\n\t\n\t        if (isTypeStr && typeSpec.indexOf(' ') > 0) {\n\t          // off(el, 't1 t2 t3', fn) or off(el, 't1 t2 t3')\n\t          typeSpec = str2arr(typeSpec)\n\t          for (i = typeSpec.length; i--;)\n\t            off(element, typeSpec[i], fn)\n\t          return element\n\t        }\n\t\n\t        type = isTypeStr && typeSpec.replace(nameRegex, '')\n\t        if (type && customEvents[type]) type = customEvents[type].base\n\t\n\t        if (!typeSpec || isTypeStr) {\n\t          // off(el) or off(el, t1.ns) or off(el, .ns) or off(el, .ns1.ns2.ns3)\n\t          if (namespaces = isTypeStr && typeSpec.replace(namespaceRegex, '')) namespaces = str2arr(namespaces, '.')\n\t          removeListener(element, type, fn, namespaces)\n\t        } else if (isFunction(typeSpec)) {\n\t          // off(el, fn)\n\t          removeListener(element, null, typeSpec)\n\t        } else {\n\t          // off(el, { t1: fn1, t2, fn2 })\n\t          for (k in typeSpec) {\n\t            if (typeSpec.hasOwnProperty(k)) off(element, k, typeSpec[k])\n\t          }\n\t        }\n\t\n\t        return element\n\t      }\n\t\n\t      /**\n\t        * on(element, eventType(s)[, selector], handler[, args ])\n\t        */\n\t    , on = function(element, events, selector, fn) {\n\t        var originalFn, type, types, i, args, entry, first\n\t\n\t        //TODO: the undefined check means you can't pass an 'args' argument, fix this perhaps?\n\t        if (selector === undefined && typeof events == 'object') {\n\t          //TODO: this can't handle delegated events\n\t          for (type in events) {\n\t            if (events.hasOwnProperty(type)) {\n\t              on.call(this, element, type, events[type])\n\t            }\n\t          }\n\t          return\n\t        }\n\t\n\t        if (!isFunction(selector)) {\n\t          // delegated event\n\t          originalFn = fn\n\t          args       = slice.call(arguments, 4)\n\t          fn         = delegate(selector, originalFn, selectorEngine)\n\t        } else {\n\t          args       = slice.call(arguments, 3)\n\t          fn         = originalFn = selector\n\t        }\n\t\n\t        types = str2arr(events)\n\t\n\t        // special case for one(), wrap in a self-removing handler\n\t        if (this === ONE) {\n\t          fn = once(off, element, events, fn, originalFn)\n\t        }\n\t\n\t        for (i = types.length; i--;) {\n\t          // add new handler to the registry and check if it's the first for this element/type\n\t          first = registry.put(entry = new RegEntry(\n\t              element\n\t            , types[i].replace(nameRegex, '') // event type\n\t            , fn\n\t            , originalFn\n\t            , str2arr(types[i].replace(namespaceRegex, ''), '.') // namespaces\n\t            , args\n\t            , false // not root\n\t          ))\n\t          if (entry[eventSupport] && first) {\n\t            // first event of this type on this element, add root listener\n\t            listener(element, entry.eventType, true, entry.customType)\n\t          }\n\t        }\n\t\n\t        return element\n\t      }\n\t\n\t      /**\n\t        * add(element[, selector], eventType(s), handler[, args ])\n\t        *\n\t        * Deprecated: kept (for now) for backward-compatibility\n\t        */\n\t    , add = function (element, events, fn, delfn) {\n\t        return on.apply(\n\t            null\n\t          , !isString(fn)\n\t              ? slice.call(arguments)\n\t              : [ element, fn, events, delfn ].concat(arguments.length > 3 ? slice.call(arguments, 5) : [])\n\t        )\n\t      }\n\t\n\t      /**\n\t        * one(element, eventType(s)[, selector], handler[, args ])\n\t        */\n\t    , one = function () {\n\t        return on.apply(ONE, arguments)\n\t      }\n\t\n\t      /**\n\t        * fire(element, eventType(s)[, args ])\n\t        *\n\t        * The optional 'args' argument must be an array, if no 'args' argument is provided\n\t        * then we can use the browser's DOM event system, otherwise we trigger handlers manually\n\t        */\n\t    , fire = function (element, type, args) {\n\t        var types = str2arr(type)\n\t          , i, j, l, names, handlers\n\t\n\t        for (i = types.length; i--;) {\n\t          type = types[i].replace(nameRegex, '')\n\t          if (names = types[i].replace(namespaceRegex, '')) names = str2arr(names, '.')\n\t          if (!names && !args && element[eventSupport]) {\n\t            fireListener(nativeEvents[type], type, element)\n\t          } else {\n\t            // non-native event, either because of a namespace, arguments or a non DOM element\n\t            // iterate over all listeners and manually 'fire'\n\t            handlers = registry.get(element, type, null, false)\n\t            args = [false].concat(args)\n\t            for (j = 0, l = handlers.length; j < l; j++) {\n\t              if (handlers[j].inNamespaces(names)) {\n\t                handlers[j].handler.apply(element, args)\n\t              }\n\t            }\n\t          }\n\t        }\n\t        return element\n\t      }\n\t\n\t      /**\n\t        * clone(dstElement, srcElement[, eventType ])\n\t        *\n\t        * TODO: perhaps for consistency we should allow the same flexibility in type specifiers?\n\t        */\n\t    , clone = function (element, from, type) {\n\t        var handlers = registry.get(from, type, null, false)\n\t          , l = handlers.length\n\t          , i = 0\n\t          , args, beanDel\n\t\n\t        for (; i < l; i++) {\n\t          if (handlers[i].original) {\n\t            args = [ element, handlers[i].type ]\n\t            if (beanDel = handlers[i].handler.__beanDel) args.push(beanDel.selector)\n\t            args.push(handlers[i].original)\n\t            on.apply(null, args)\n\t          }\n\t        }\n\t        return element\n\t      }\n\t\n\t    , bean = {\n\t          'on'                : on\n\t        , 'add'               : add\n\t        , 'one'               : one\n\t        , 'off'               : off\n\t        , 'remove'            : off\n\t        , 'clone'             : clone\n\t        , 'fire'              : fire\n\t        , 'Event'             : Event\n\t        , 'setSelectorEngine' : setSelectorEngine\n\t        , 'noConflict'        : function () {\n\t            context[name] = old\n\t            return this\n\t          }\n\t      }\n\t\n\t  // for IE, clean up on unload to avoid leaks\n\t  if (win.attachEvent) {\n\t    var cleanup = function () {\n\t      var i, entries = registry.entries()\n\t      for (i in entries) {\n\t        if (entries[i].type && entries[i].type !== 'unload') off(entries[i].element, entries[i].type)\n\t      }\n\t      win.detachEvent('onunload', cleanup)\n\t      win.CollectGarbage && win.CollectGarbage()\n\t    }\n\t    win.attachEvent('onunload', cleanup)\n\t  }\n\t\n\t  // initialize selector engine to internal default (qSA or throw Error)\n\t  setSelectorEngine()\n\t\n\t  return bean\n\t});\n\n\n/***/ },\n/* 13 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t\tvalue: true\n\t});\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tvar _lodash = __webpack_require__(5);\n\t\n\tvar _lodash2 = _interopRequireDefault(_lodash);\n\t\n\tvar _bean = __webpack_require__(12);\n\t\n\tvar _bean2 = _interopRequireDefault(_bean);\n\t\n\tvar _KeyUtils = __webpack_require__(14);\n\t\n\tvar KeyUtils = _interopRequireWildcard(_KeyUtils);\n\t\n\tvar _Utils = __webpack_require__(2);\n\t\n\tvar _Utils2 = _interopRequireDefault(_Utils);\n\t\n\tvar _DomUtils = __webpack_require__(7);\n\t\n\tvar _DomUtils2 = _interopRequireDefault(_DomUtils);\n\t\n\tvar _StringBuffer = __webpack_require__(8);\n\t\n\tvar _StringBuffer2 = _interopRequireDefault(_StringBuffer);\n\t\n\tfunction _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj.default = obj; return newObj; } }\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tvar DEFAULTS = {\n\t\tstopPropagation: false\n\t};\n\t\n\tvar EventDispatcher = function () {\n\t\t/**\r\n\t  * Constructor\r\n\t  * @param root the root element that the manager will listen to.\r\n\t  * @param zoomScale\r\n\t  * @param config the configuraton for the event dispatcher.\r\n\t  */\n\t\tfunction EventDispatcher(root) {\n\t\t\tvar zoomScale = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : [0, Infinity];\n\t\t\tvar config = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n\t\n\t\t\t_classCallCheck(this, EventDispatcher);\n\t\n\t\t\tthis.root = root;\n\t\t\tthis.rootNS = root.getAttribute('ns') || 'root';\n\t\t\tthis.zoomScale = zoomScale;\n\t\t\t_lodash2.default.assign(this, DEFAULTS, config);\n\t\t\tthis.scale = 1.0;\n\t\t\tthis.listeners = {};\n\t\t\tthis.dragging = false;\n\t\t\tthis.handler = _lodash2.default.bind(this.handleEvent, this);\n\t\t\tthis.started = false;\n\t\n\t\t\t// Simulate mouseenter/mouseleave events\n\t\t\tthis.enterStack = [];\n\t\t}\n\t\n\t\t/**\r\n\t  * Start listening for events.\r\n\t  */\n\t\n\t\n\t\t_createClass(EventDispatcher, [{\n\t\t\tkey: \"start\",\n\t\t\tvalue: function start() {\n\t\t\t\tif (this.started) return;\n\t\t\t\t_bean2.default.on(this.root, 'mousedown mouseover mouseout mouseenter mouseleave dblclick click contextmenu mousewheel', this.handler);\n\t\t\t\tthis.startKeys();\n\t\t\t\tthis.started = true;\n\t\t\t}\n\t\n\t\t\t/**\r\n\t   * Stop listening for events.\r\n\t   */\n\t\n\t\t}, {\n\t\t\tkey: \"stop\",\n\t\t\tvalue: function stop() {\n\t\t\t\tif (!this.started) return;\n\t\t\t\t_bean2.default.off(this.root, 'mousedown mouseover mouseout mouseenter mouseleave dblclick click contextmenu mousewheel', this.handler);\n\t\t\t\tthis.stopKeys();\n\t\t\t\tthis.started = false;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"startKeys\",\n\t\t\tvalue: function startKeys() {\n\t\t\t\t_bean2.default.on(document, 'keydown keyup', this.handler);\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"stopKeys\",\n\t\t\tvalue: function stopKeys() {\n\t\t\t\t_bean2.default.off(document, 'keydown keyup', this.handler);\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"zoomIn\",\n\t\t\tvalue: function zoomIn() {\n\t\t\t\tthis.scale *= 1.25;\n\t\t\t\tthis.scale = Math.max(Math.min(this.zoomScale[1], this.scale), this.zoomScale[0]);\n\t\t\t\treturn this.scale;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"zoomOut\",\n\t\t\tvalue: function zoomOut() {\n\t\t\t\tthis.scale *= 0.8;\n\t\t\t\tthis.scale = Math.max(Math.min(this.zoomScale[1], this.scale), this.zoomScale[0]);\n\t\t\t\treturn this.scale;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"getEventInfo\",\n\t\t\tvalue: function getEventInfo(event) {\n\t\t\t\tvar target = event.target;\n\t\t\t\tvar buf = new _StringBuffer2.default(),\n\t\t\t\t    ns = void 0,\n\t\t\t\t    stack = [],\n\t\t\t\t    isRoot = false;\n\t\t\t\twhile (!isRoot && target && target != document) {\n\t\t\t\t\tns = target.getAttribute('ns');\n\t\t\t\t\tif (ns) {\n\t\t\t\t\t\tisRoot = _lodash2.default.startsWith(ns, \"root.\");\n\t\t\t\t\t\tif (isRoot) {\n\t\t\t\t\t\t\tns = ns.substring(5);\n\t\t\t\t\t\t\tevent.rootTarget = target;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (!event.nsTarget) event.nsTarget = target;\n\t\t\t\t\t\tstack.splice(0, 0, target);\n\t\t\t\t\t\tbuf.prepend(ns);\n\t\t\t\t\t}\n\t\t\t\t\ttarget = target.parentNode;\n\t\t\t\t}\n\t\t\t\tif (!isRoot) event.rootTarget = event.nsTarget;\n\t\n\t\t\t\t// target stack is a stack of all the ns targets up to the one with the data binding.\n\t\t\t\tevent.targetStack = stack;\n\t\t\t\tns = buf.toString('.');\n\t\t\t\tif (ns == '') ns = this.rootNS;\n\t\t\t\treturn { data: event.rootTarget, ns: ns };\n\t\t\t}\n\t\n\t\t\t/**\r\n\t   * The main event handler method, it processes event and generate relevant events to dispatch.\r\n\t   */\n\t\n\t\t}, {\n\t\t\tkey: \"handleEvent\",\n\t\t\tvalue: function handleEvent(event) {\n\t\t\t\tvar _this = this;\n\t\n\t\t\t\tvar type = event.type;\n\t\n\t\t\t\t// Do not dispatch other events if we are dragging.\n\t\t\t\tif (this.dragging || _DomUtils2.default.eventFromInput(event)) return;\n\t\n\t\t\t\tvar data = void 0,\n\t\t\t\t    ns = void 0,\n\t\t\t\t    pos = this.getPosition(event),\n\t\t\t\t    info = void 0,\n\t\t\t\t    isKeyEvent = type == 'keydown' || type == 'keyup';\n\t\t\t\tif (isKeyEvent) {\n\t\t\t\t\tdata = this.root;\n\t\t\t\t\tns = KeyUtils.getKeyEvent(event);\n\t\t\t\t} else {\n\t\t\t\t\tinfo = this.getEventInfo(event);\n\t\t\t\t\tif (!info) return;\n\t\t\t\t\tdata = info.data;\n\t\t\t\t\tns = info.ns;\n\t\t\t\t}\n\t\n\t\t\t\t//Utils.log('EventDispatcher', \"handleEvent - \" + type + ';ns=' + ns);\n\t\n\t\t\t\tif (type == 'mousewheel') {\n\t\t\t\t\tthis.scale *= Math.pow(2, event.wheelDelta * 0.002);\n\t\t\t\t\tthis.scale = Math.max(Math.min(this.zoomScale[1], this.scale), this.zoomScale[0]);\n\t\t\t\t\tevent.scale = this.scale;\n\t\t\t\t\ttype = 'zoom';\n\t\t\t\t}\n\t\n\t\t\t\t// See if we should create drag events\n\t\t\t\tif (type == 'mousedown' && event.button == 0 /*only drag on left click*/) {\n\t\t\t\t\t\t(function () {\n\t\t\t\t\t\t\t// Create drag object.\n\t\t\t\t\t\t\tvar dragObject = { data: data, pos: ns == 'root' ? EventDispatcher.mouse(_this.root, event) : pos };\n\t\t\t\t\t\t\t_this.dragging = false;\n\t\t\t\t\t\t\t// Start listening for mouse move.\n\t\t\t\t\t\t\tvar dragPos = void 0;\n\t\n\t\t\t\t\t\t\tvar mousemove = function mousemove(event) {\n\t\t\t\t\t\t\t\tvar currentPos = _this.getPosition(event);\n\t\t\t\t\t\t\t\tif (!_this.dragging) {\n\t\t\t\t\t\t\t\t\t// check if the mouse has moved. IE always fire mousemove after mousedown even if the mouse hasn't moved yet.\n\t\t\t\t\t\t\t\t\tif (dragObject.pos[0] == currentPos[0] && dragObject.pos[1] == currentPos[1]) return;\n\t\n\t\t\t\t\t\t\t\t\t// start dragging\n\t\t\t\t\t\t\t\t\t_this.dragging = true;\n\t\t\t\t\t\t\t\t\tevent.rootTarget = dragObject.data;\n\t\t\t\t\t\t\t\t\t_this.dispatch(event, 'dragstart', ns, dragObject.data, dragObject.pos);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tif (ns == \"root\") dragPos = EventDispatcher.mouse(_this.root, event);else dragPos = currentPos;\n\t\t\t\t\t\t\t\t_this.getEventInfo(event);\n\t\t\t\t\t\t\t\t_this.dispatch(event, 'drag', ns, dragObject.data, dragPos);\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\tvar mouseup = function mouseup(event) {\n\t\t\t\t\t\t\t\tif (ns == \"root\") dragPos = EventDispatcher.mouse(_this.root, event);else dragPos = _this.getPosition(event);\n\t\n\t\t\t\t\t\t\t\tvar info = _this.getEventInfo(event);\n\t\t\t\t\t\t\t\tif (_this.dragging) {\n\t\t\t\t\t\t\t\t\t_this.dragging = false;\n\t\t\t\t\t\t\t\t\t_this.dispatch(event, 'dragend', ns, dragObject.data, dragPos);\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t_this.dispatch(event, 'mouseup', ns, info.data, dragPos);\n\t\t\t\t\t\t\t\t}\n\t\n\t\t\t\t\t\t\t\t_bean2.default.off(window, 'mousemove', mousemove);\n\t\t\t\t\t\t\t\t_bean2.default.off(window, 'mouseup', mouseup);\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\tevent.preventDefault();\n\t\t\t\t\t\t\t_bean2.default.on(window, 'mousemove', mousemove);\n\t\t\t\t\t\t\t_bean2.default.on(window, 'mouseup', mouseup);\n\t\t\t\t\t\t})();\n\t\t\t\t\t}\n\t\n\t\t\t\tif (!isKeyEvent) this.simulateEnterLeave(event, type, ns, data, pos);\n\t\t\t\tthis.dispatch(event, type, ns, data, pos);\n\t\n\t\t\t\t// disable the default context menu\n\t\t\t\t//if (type == 'contextmenu')\n\t\t\t\t//\tevent.preventDefault();\n\t\t\t}\n\t\n\t\t\t/**\r\n\t   * try to simulate mouseenter/mouseleave events.\r\n\t   */\n\t\n\t\t}, {\n\t\t\tkey: \"simulateEnterLeave\",\n\t\t\tvalue: function simulateEnterLeave(event, type, ns, data, pos) {\n\t\t\t\tvar _this2 = this;\n\t\n\t\t\t\tvar last = void 0,\n\t\t\t\t    stack = void 0;\n\t\t\t\tvar clearEnterStack = function clearEnterStack(k) {\n\t\t\t\t\tk = k || 0;\n\t\t\t\t\t// Clear off the enter stack.\n\t\t\t\t\twhile (_this2.enterStack.length >= k + 1) {\n\t\t\t\t\t\tlast = _this2.enterStack.pop();\n\t\t\t\t\t\t_this2.dispatch(event, 'mouseleave', last.ns, last.data, pos);\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t\tvar getNS = function getNS(index) {\n\t\t\t\t\tvar buf = new _StringBuffer2.default();\n\t\t\t\t\tfor (var i = 0; i <= index; i++) {\n\t\t\t\t\t\tvar val = stack[i].getAttribute(\"ns\");\n\t\t\t\t\t\tif (_lodash2.default.startsWith(val, \"root.\")) val = val.substring(5);\n\t\t\t\t\t\tbuf.append(val);\n\t\t\t\t\t}\n\t\t\t\t\treturn buf.toString('.');\n\t\t\t\t};\n\t\n\t\t\t\tif (ns && ns != this.rootNS) {\n\t\t\t\t\tif (type == 'mouseover') {\n\t\t\t\t\t\tstack = event.targetStack;\n\t\t\t\t\t\tvar item = void 0;\n\t\t\t\t\t\tfor (var i = 0; i < stack.length; i++) {\n\t\t\t\t\t\t\tif (i < this.enterStack.length) {\n\t\t\t\t\t\t\t\tif (this.enterStack[i].target != stack[i]) {\n\t\t\t\t\t\t\t\t\tclearEnterStack(i);\n\t\t\t\t\t\t\t\t} else continue;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\titem = { data: data, ns: getNS(i), target: stack[i] };\n\t\t\t\t\t\t\tthis.enterStack.push(item);\n\t\t\t\t\t\t\tthis.dispatch(event, 'mouseenter', item.ns, data, pos);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (stack.length < this.enterStack.length) clearEnterStack(stack.length);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (ns == this.rootNS && this.enterStack.length > 0) clearEnterStack();\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"dispatch\",\n\t\t\tvalue: function dispatch(event, type, ns, data, pos) {\n\t\t\t\t//if (type != 'mouseover' && type != 'mouseout')\n\t\t\t\t//\tUtils.log('EventDispatcher', \"dispatch - \" + type + '.' + ns + ';' + pos + ';rootTarget=' + event.rootTarget + ';data=' + data);\n\t\t\t\tif (!this.started) return;\n\t\t\t\tvar nsType = ns ? type + '.' + ns : type;\n\t\t\t\t_lodash2.default.forEach(this.listeners, function (listeners, key) {\n\t\t\t\t\tif (EventDispatcher.match(nsType, listeners.regexp ? listeners.regexp : key)) {\n\t\t\t\t\t\t_lodash2.default.forEach(listeners, function (listener) {\n\t\t\t\t\t\t\tif (!listener.context) listener.callback.apply(window, [type, ns, data, pos, event]);else listener.callback.apply(listener.context, [type, ns, data, pos, event]);\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t});\n\t\n\t\t\t\t// after dispatching, do not propagate.\n\t\t\t\tif (this.stopPropagation && event.stopPropagation) event.stopPropagation();\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"getPosition\",\n\t\t\tvalue: function getPosition(event) {\n\t\t\t\tvar pos = EventDispatcher.mouse(this.root, event);\n\t\t\t\tif (!_lodash2.default.isNaN(pos[0]) && !_lodash2.default.isNaN(pos[1])) this.lastPosition = pos;\n\t\t\t\treturn this.lastPosition;\n\t\t\t}\n\t\n\t\t\t/**\r\n\t   * Registers a key event handler\r\n\t   * // Key is object {ctrl, alt, shift, meta, code}\r\n\t   */\n\t\n\t\t}, {\n\t\t\tkey: \"registerKey\",\n\t\t\tvalue: function registerKey(type, key, callback, context) {\n\t\t\t\tvar _this3 = this;\n\t\n\t\t\t\tif (_lodash2.default.isArray(key)) {\n\t\t\t\t\t_lodash2.default.forEach(key, function (k) {\n\t\t\t\t\t\t_this3.registerKey(type, k, callback, context);\n\t\t\t\t\t});\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tkey = KeyUtils.getKeyData(key.ctrl, key.alt, key.shift, key.meta, key.code);\n\t\t\t\tif (!key.length) return;\n\t\t\t\tkey = new _StringBuffer2.default(type).append(key).toString('.');\n\t\n\t\t\t\tvar listener = { callback: callback, context: context };\n\t\t\t\tthis.listeners[key] || (this.listeners[key] = []);\n\t\t\t\tthis.listeners[key].push(listener);\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"unregisterKey\",\n\t\t\tvalue: function unregisterKey(type, key, callback, context) {\n\t\t\t\tvar _this4 = this;\n\t\n\t\t\t\tif (_lodash2.default.isArray(key)) {\n\t\t\t\t\t_lodash2.default.forEach(key, function (k) {\n\t\t\t\t\t\t_this4.unregisterKey(type, k, callback, context);\n\t\t\t\t\t});\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tkey = KeyUtils.getKeyData(key.ctrl, key.alt, key.shift, key.meta, key.code);\n\t\t\t\tif (!key.length) return;\n\t\t\t\tkey = new _StringBuffer2.default(type).append(key).toString('.');\n\t\n\t\t\t\tvar listeners = this.listeners[key],\n\t\t\t\t    listener = void 0;\n\t\t\t\tif (!listeners) return;\n\t\t\t\tfor (var i = 0; i < listeners.length; i++) {\n\t\t\t\t\tlistener = listeners[i];\n\t\t\t\t\tif (listener.callback === callback && (!context || context === listener.context)) {\n\t\t\t\t\t\tlisteners.splice(i, 1);\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\n\t\t\t/**\r\n\t   * Registers an event handler\r\n\t   */\n\t\n\t\t}, {\n\t\t\tkey: \"register\",\n\t\t\tvalue: function register(type, callback, context, zIndex) {\n\t\t\t\tvar _this5 = this;\n\t\n\t\t\t\tif (_lodash2.default.isArray(type)) {\n\t\t\t\t\t_lodash2.default.forEach(type, function (t) {\n\t\t\t\t\t\t_this5.register(t, callback, context, zIndex);\n\t\t\t\t\t});\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tvar listener = { callback: callback, context: context, zIndex: zIndex };\n\t\t\t\tvar regexp = null;\n\t\t\t\tif (type instanceof RegExp) {\n\t\t\t\t\tregexp = type;\n\t\t\t\t\ttype = type + '';\n\t\t\t\t}\n\t\t\t\tthis.listeners[type] || (this.listeners[type] = []);\n\t\t\t\tif (regexp && !this.listeners[type].regexp) this.listeners[type].regexp = regexp;\n\t\t\t\tthis.listeners[type].push(listener);\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"unregister\",\n\t\t\tvalue: function unregister(type, callback, context) {\n\t\t\t\tif (type instanceof RegExp) type = type + '';\n\t\t\t\tvar listeners = this.listeners[type],\n\t\t\t\t    listener = void 0;\n\t\t\t\tif (!listeners) return;\n\t\t\t\tfor (var i = 0; i < listeners.length; i++) {\n\t\t\t\t\tlistener = listeners[i];\n\t\t\t\t\tif (listener.callback === callback && (!context || context === listener.context)) {\n\t\t\t\t\t\tlisteners.splice(i, 1);\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"destroy\",\n\t\t\tvalue: function destroy() {\n\t\t\t\tthis.stop();\n\t\t\t\tdelete this.root;\n\t\t\t\tdelete this.listeners;\n\t\t\t\tdelete this.enterStack;\n\t\t\t}\n\t\n\t\t\t/**\r\n\t   * Check if the registered event type matches the real event type. \"*\" is allowed as a wild card.\r\n\t   */\n\t\n\t\t}], [{\n\t\t\tkey: \"match\",\n\t\t\tvalue: function match(nsType, registeredType) {\n\t\t\t\tif (registeredType instanceof RegExp) return nsType.match(registeredType);\n\t\n\t\t\t\treturn nsType == registeredType;\n\t\t\t\t/*const arr = registeredType.split('*');\r\n\t   if (arr.length == 1)\r\n\t   \treturn nsType == registeredType;\r\n\t   \t\tlet substr, index = 0;\r\n\t   for (let i = 0; i < arr.length; i++) {\r\n\t   \tif (arr[i].length == 0) continue;\r\n\t   \tsubstr = nsType.slice(index);\r\n\t   \tindex = substr.indexOf(arr[i]);\r\n\t   \tif (index < 0)\r\n\t   \t\treturn false;\r\n\t   \tindex += arr[i].length;\r\n\t   }\r\n\t   return true;*/\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"mouse\",\n\t\t\tvalue: function mouse(container, e) {\n\t\t\t\tif (e.changedTouches) e = e.changedTouches[0];\n\t\t\t\tvar svg = container.ownerSVGElement || container;\n\t\t\t\tif (svg.createSVGPoint) {\n\t\t\t\t\tvar point = svg.createSVGPoint();\n\t\t\t\t\tpoint.x = e.clientX;point.y = e.clientY;\n\t\t\t\t\tpoint = point.matrixTransform(container.getScreenCTM().inverse());\n\t\t\t\t\treturn [point.x, point.y];\n\t\t\t\t}\n\t\t\t\tvar rect = container.getBoundingClientRect();\n\t\t\t\treturn [e.clientX - rect.left - container.clientLeft, e.clientY - rect.top - container.clientTop];\n\t\t\t}\n\t\t}]);\n\t\n\t\treturn EventDispatcher;\n\t}();\n\t\n\texports.default = EventDispatcher;\n\n/***/ },\n/* 14 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t\tvalue: true\n\t});\n\texports.getKeyEvent = getKeyEvent;\n\texports.getKeyData = getKeyData;\n\t\n\tvar _StringBuffer = __webpack_require__(8);\n\t\n\tvar _StringBuffer2 = _interopRequireDefault(_StringBuffer);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\t/**\r\n\t * KEY constant\r\n\t */\n\tvar KEY = {\n\t\tALT: 18,\n\t\tBACK_SPACE: 8,\n\t\tCAPS_LOCK: 20,\n\t\tCONTROL: 17,\n\t\tDELETE: 46,\n\t\tDOWN: 40,\n\t\tEND: 35,\n\t\tENTER: 13,\n\t\tESCAPE: 220,\n\t\tHOME: 36,\n\t\tLEFT: 37,\n\t\tMETA: 224,\n\t\tNUM_LOCK: 144,\n\t\tPAGE_DOWN: 34,\n\t\tPAGE_UP: 33,\n\t\tPAUSE: 19,\n\t\tPRINTSCREEN: 44,\n\t\tRIGHT: 39,\n\t\tSCROLL_LOCK: 145,\n\t\tSHIFT: 16,\n\t\tSPACE: 32,\n\t\tTAB: 9,\n\t\tUP: 38\n\t\t//ADD          : DomUtils.isFireFox ? 61  : 187,\n\t\t//SUBTRACT     : DomUtils.isFireFox ? 173 : 189\n\t}; ///////////////////////////////////////////////////////////////////////////////\n\t//                                                                           //\n\t//           The Key Utility CLass for the Event Dispatcher          \t     //\n\t//                                                                           //\n\t///////////////////////////////////////////////////////////////////////////////\n\t\n\tfunction getKeyEvent(event) {\n\t\tif (!event || !event instanceof KeyboardEvent) {\n\t\t\treturn null;\n\t\t}\n\t\n\t\tvar key = event.keyCode || event.which;\n\t\n\t\t// Need to find a way to avoid this\n\t\tif (key >= 16 && key <= 18) {\n\t\t\tkey = null;\n\t\t}\n\t\n\t\treturn getKeyData(event.ctrlKey, event.altKey, event.shiftKey, event.metaKey, key);\n\t}\n\t\n\tfunction getKeyData(ctrl, alt, shift, meta, key) {\n\t\tvar buf = new _StringBuffer2.default();\n\t\n\t\tif (ctrl) buf.append(\"CTRL\");\n\t\tif (alt) buf.append(\"ALT\");\n\t\tif (shift) buf.append(\"SHIFT\");\n\t\tif (meta) buf.append(\"META\");\n\t\tif (key) buf.append(key);\n\t\n\t\treturn buf.toString(\".\");\n\t}\n\n/***/ },\n/* 15 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t\tvalue: true\n\t});\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tvar _lodash = __webpack_require__(5);\n\t\n\tvar _lodash2 = _interopRequireDefault(_lodash);\n\t\n\tvar _Utils = __webpack_require__(2);\n\t\n\tvar _Utils2 = _interopRequireDefault(_Utils);\n\t\n\tvar _Node = __webpack_require__(16);\n\t\n\tvar _Node2 = _interopRequireDefault(_Node);\n\t\n\tvar _Edge = __webpack_require__(20);\n\t\n\tvar _Edge2 = _interopRequireDefault(_Edge);\n\t\n\tvar _Marker = __webpack_require__(21);\n\t\n\tvar _Marker2 = _interopRequireDefault(_Marker);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tvar nodeDefaults = {\n\t\tname: 'Default',\n\t\trole: 'node',\n\t\tdraggable: true,\n\t\tselectable: true,\n\t\teditable: true,\n\t\tresizable: false,\n\t\tsourceable: true,\n\t\ttargetable: true,\n\t\tvisible: true\n\t};\n\t\n\tvar edgeDefaults = {\n\t\tname: 'Default',\n\t\trole: 'edge',\n\t\tselectable: true,\n\t\tvisible: true,\n\t\tstartMarker: null,\n\t\tendMarker: {\n\t\t\tid: 'Default_EndMarker',\n\t\t\ttype: 'arrow',\n\t\t\tsize: 10,\n\t\t\tcolor: '#0ea117'\n\t\t},\n\t\t/* start and end is only used if the edge is not connected to a node */\n\t\tstart: [0, 0],\n\t\tend: [400, 200]\n\t};\n\t\n\tvar Graph = function () {\n\t\tfunction Graph() {\n\t\t\tvar id = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : _lodash2.default.uniqueId(\"G\");\n\t\t\tvar config = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n\t\t\tvar model = arguments[2];\n\t\n\t\t\t_classCallCheck(this, Graph);\n\t\n\t\t\tthis.id = id;\n\t\n\t\t\tthis.nodes = {};\n\t\t\tthis.edges = {};\n\t\n\t\t\tthis.selection = null;\n\t\t\tthis.destroyed = false;\n\t\n\t\t\t_Utils2.default.buildTypes(config.nodeTypes, \"Nodes\", nodeDefaults);\n\t\t\t_Utils2.default.buildTypes(config.edgeTypes, \"Edges\", edgeDefaults);\n\t\t\t// check for markers.\n\t\t\tthis.markers = [];\n\t\t\tvar edgeTypes = _Utils2.default.type(_Edge2.default.namespace),\n\t\t\t    marker = void 0,\n\t\t\t    markerConfig = void 0;\n\t\t\tedgeTypes.forEach(function (type) {\n\t\t\t\tmarkerConfig = type.prototype.startMarker;\n\t\t\t\tif (markerConfig) {\n\t\t\t\t\tmarker = _Marker2.default.getMarker(markerConfig, true);\n\t\t\t\t\tthis.markers.push(marker);\n\t\t\t\t}\n\t\t\t\tmarkerConfig = type.prototype.endMarker;\n\t\t\t\tif (markerConfig) {\n\t\t\t\t\tmarker = _Marker2.default.getMarker(markerConfig, false);\n\t\t\t\t\tthis.markers.push(marker);\n\t\t\t\t}\n\t\t\t}, this);\n\t\n\t\t\tdelete config.nodeTypes;\n\t\t\tdelete config.edgeTypes;\n\t\t\t_Utils2.default.initConfig(this, config);\n\t\t\tthis.root = null;\n\t\t\tif (model) this.loadModel(model);\n\t\t}\n\t\n\t\t_createClass(Graph, [{\n\t\t\tkey: \"addNode\",\n\t\n\t\n\t\t\t/**\r\n\t   * Create a new Node\r\n\t   */\n\t\t\tvalue: function addNode(config) {\n\t\t\t\tvar parent = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : this.currentRoot;\n\t\t\t\tvar pos = arguments[2];\n\t\n\t\t\t\tvar NodeClass = Graph.getJSClass(config, _Node2.default);\n\t\t\t\tvar node = new NodeClass(this, config);\n\t\n\t\t\t\tif (parent) Graph.addChild(parent, node, pos);else {\n\t\t\t\t\tthis.root = node;\n\t\t\t\t\tthis.root.prop('role', 'root');\n\t\t\t\t}\n\t\n\t\t\t\tthis.nodes[node.id] = node;\n\t\t\t\treturn node;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"addEdge\",\n\t\t\tvalue: function addEdge(config) {\n\t\t\t\tvar parent = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : this.currentRoot;\n\t\t\t\tvar from = arguments[2];\n\t\t\t\tvar to = arguments[3];\n\t\n\t\t\t\tvar EdgeClass = Graph.getJSClass(config, _Edge2.default);\n\t\t\t\tvar edge = new EdgeClass(this, config, from, to);\n\t\n\t\t\t\tGraph.addChild(parent, edge);\n\t\t\t\tthis.edges[edge.id] = edge;\n\t\t\t\treturn edge;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"loadModel\",\n\t\t\tvalue: function loadModel(model) {\n\t\t\t\tvar _this = this;\n\t\n\t\t\t\tvar parent = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : this.currentRoot;\n\t\n\t\t\t\tvar nodes = model.nodes;\n\t\t\t\tvar edges = model.edges;\n\t\t\t\tdelete model.nodes;\n\t\t\t\tdelete model.edges;\n\t\n\t\t\t\tvar node = this.addNode(model, parent);\n\t\t\t\tif (nodes) {\n\t\t\t\t\t_lodash2.default.forEach(nodes, function (child) {\n\t\t\t\t\t\t_this.loadModel(child, node);\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\tif (edges) {\n\t\t\t\t\t_lodash2.default.forEach(edges, function (edge) {\n\t\t\t\t\t\tvar from = void 0,\n\t\t\t\t\t\t    to = void 0;\n\t\t\t\t\t\tif (edge.from) from = _this.nodes[edge.from];\n\t\t\t\t\t\tif (edge.to) to = _this.nodes[edge.to];\n\t\t\t\t\t\t_this.addEdge(edge, node, from, to);\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"reset\",\n\t\t\tvalue: function reset() {}\n\t\t}, {\n\t\t\tkey: \"destroy\",\n\t\t\tvalue: function destroy() {}\n\t\t}, {\n\t\t\tkey: \"currentRoot\",\n\t\t\tget: function get() {\n\t\t\t\treturn this.root;\n\t\t\t}\n\t\t}], [{\n\t\t\tkey: \"getJSClass\",\n\t\t\tvalue: function getJSClass(config, defaultClass) {\n\t\t\t\tvar jsClass = null;\n\t\t\t\tif (config && config.type) {\n\t\t\t\t\t// See if we can get the js class from config.\n\t\t\t\t\tvar type = _Utils2.default.type(defaultClass.namespace, config.type);\n\t\t\t\t\tif (type) jsClass = type.jsClass;\n\t\t\t\t}\n\t\n\t\t\t\treturn _Utils2.default.getConstructor(jsClass, defaultClass);\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"addChild\",\n\t\t\tvalue: function addChild(parent, child) {\n\t\t\t\tif (!parent.children) parent.children = [];\n\t\n\t\t\t\tif (child.parent != parent) {\n\t\t\t\t\tparent.children.push(child);\n\t\n\t\t\t\t\tif (child.parent && child.parent.children) child.parent.children = _lodash2.default.without(child.parent.children, child);\n\t\t\t\t}\n\t\t\t\tchild.parent = parent;\n\t\t\t}\n\t\t}]);\n\t\n\t\treturn Graph;\n\t}();\n\t\n\tGraph.DEFAULTS = {\n\t\tallowDanglingEdges: true,\n\t\tmultiConnect: false,\n\t\treadOnly: false,\n\t\tviewOnly: false\n\t};\n\t\n\texports.default = Graph;\n\n/***/ },\n/* 16 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t\tvalue: true\n\t});\n\t\n\tvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; };\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tvar _lodash = __webpack_require__(5);\n\t\n\tvar _lodash2 = _interopRequireDefault(_lodash);\n\t\n\tvar _StringBuffer = __webpack_require__(8);\n\t\n\tvar _StringBuffer2 = _interopRequireDefault(_StringBuffer);\n\t\n\tvar _Cell2 = __webpack_require__(17);\n\t\n\tvar _Cell3 = _interopRequireDefault(_Cell2);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\t\n\tfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\t\n\tvar Node = function (_Cell) {\n\t\t_inherits(Node, _Cell);\n\t\n\t\tfunction Node(graph) {\n\t\t\tvar config = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n\t\n\t\t\t_classCallCheck(this, Node);\n\t\n\t\t\tif (!config.id) config.id = _lodash2.default.uniqueId('N');\n\t\n\t\t\tvar _this = _possibleConstructorReturn(this, (Node.__proto__ || Object.getPrototypeOf(Node)).call(this, graph, config));\n\t\n\t\t\t_this.inEdges = [];\n\t\t\t_this.outEdges = [];\n\t\t\t_this.ports = null;\n\t\t\t_this.parent = null;\n\t\t\treturn _this;\n\t\t}\n\t\n\t\t_createClass(Node, [{\n\t\t\tkey: \"isAncestor\",\n\t\t\tvalue: function isAncestor(n) {\n\t\t\t\t// TODO: should we move this to graph class ?\n\t\t\t\tvar node = n.parent;\n\t\t\t\twhile (node) {\n\t\t\t\t\tif (this == node) {\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t}\n\t\t\t\t\tnode = node.parent;\n\t\t\t\t}\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"removeEdge\",\n\t\t\tvalue: function removeEdge(edge) {\n\t\t\t\tvar edges = edge.source == this ? this.outEdges : this.inEdges;\n\t\t\t\tfor (var i = 0; i < edges.length; i++) {\n\t\t\t\t\tif (edge == edges[i]) {\n\t\t\t\t\t\tedges.splice(i, 1);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\n\t\t\t// Add a new incoming edge\n\t\n\t\t}, {\n\t\t\tkey: \"addInEdge\",\n\t\t\tvalue: function addInEdge(edge, pos) {\n\t\t\t\tif (pos == null || pos === undefined) this.inEdges.push(edge);else this.inEdges.splice(pos, 0, edge);\n\t\t\t}\n\t\n\t\t\t// Add a new outgoing edge\n\t\n\t\t}, {\n\t\t\tkey: \"addOutEdge\",\n\t\t\tvalue: function addOutEdge(edge, pos) {\n\t\t\t\tif (pos == null || pos === undefined || pos > edge.length - 1) this.outEdges.push(edge);else this.outEdges.splice(pos, 0, edge);\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"renderChildren\",\n\t\t\tvalue: function renderChildren(view) {\n\t\t\t\tvar _this2 = this;\n\t\n\t\t\t\tif (this.children) {\n\t\t\t\t\tvar _ret = function () {\n\t\t\t\t\t\tvar buf = new _StringBuffer2.default();\n\t\t\t\t\t\t_lodash2.default.forEach(_this2.children, function (child) {\n\t\t\t\t\t\t\tbuf.append(child.render(view));\n\t\t\t\t\t\t});\n\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\tv: buf.toString()\n\t\t\t\t\t\t};\n\t\t\t\t\t}();\n\t\n\t\t\t\t\tif ((typeof _ret === \"undefined\" ? \"undefined\" : _typeof(_ret)) === \"object\") return _ret.v;\n\t\t\t\t}\n\t\t\t\treturn '';\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"getPort\",\n\t\t\tvalue: function getPort(key) {\n\t\t\t\tvar portName = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 'auto';\n\t\t\t\tvar endPt = arguments[2];\n\t\t\t\tvar orthogonal = arguments[3];\n\t\n\t\t\t\tvar shape = this.getShape(key);\n\t\t\t\tif (portName == 'auto') {\n\t\t\t\t\treturn shape.getPerimeter(endPt, orthogonal);\n\t\t\t\t}\n\t\t\t\treturn null;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"toString\",\n\t\t\tvalue: function toString() {\n\t\t\t\tvar label = this.prop(\"label\") ? this.prop(\"label\") : \"undefined\";\n\t\t\t\tif (_lodash2.default.isArray(label)) label = label[0];\n\t\t\t\treturn 'Node:{id:' + this.id + ';label:' + label + ';type:' + this.props.constructor.typeName + '}';\n\t\t\t}\n\t\t}]);\n\t\n\t\treturn Node;\n\t}(_Cell3.default);\n\t\n\tNode.namespace = \"Nodes\";\n\t\n\texports.default = Node;\n\t\n\t/*\r\n\t\r\n\t/**\r\n\t * The DrillDownParent is the parent that displays the vertex when drilled down.\r\n\t *\r\n\tVertex.prototype.getDrillDownParent = function() {\r\n\t\treturn this.parent;\r\n\t};\r\n\r\n\tVertex.prototype.isLocked = function() {\r\n\t\tvar mode = this.getProperty(\"mode\") || 3;\r\n\t\treturn !(mode & Graph.ALLOW_INTERACTIONS);\r\n\t};\r\n\r\n\tVertex.prototype.getCrumbText = function() {\r\n\t\tif (this.isLocked())\r\n\t\t\treturn '<span><img src=\"webwb/pzreadonly.png\" /></span><span>&nbsp;' + this.getProperty(\"label\") + '</span>';\r\n\t\treturn this.getProperty(\"label\");\r\n\t};\r\n\r\n\tVertex.prototype.canEdit = function() {\r\n\t\treturn (!this.parent || !this.parent.isLocked()) && Vertex.superclass.canEdit.call(this);\r\n\t};\r\n\r\n\tVertex.prototype.isContainer = function() {\r\n\t\treturn this.getProperty(\"container\");\r\n\t};\r\n\r\n\t*/\n\n/***/ },\n/* 17 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t\tvalue: true\n\t});\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tvar _lodash = __webpack_require__(5);\n\t\n\tvar _lodash2 = _interopRequireDefault(_lodash);\n\t\n\tvar _Utils = __webpack_require__(2);\n\t\n\tvar _Utils2 = _interopRequireDefault(_Utils);\n\t\n\tvar _Cache = __webpack_require__(18);\n\t\n\tvar _Cache2 = _interopRequireDefault(_Cache);\n\t\n\tvar _StringBuffer = __webpack_require__(8);\n\t\n\tvar _StringBuffer2 = _interopRequireDefault(_StringBuffer);\n\t\n\tvar _Shape = __webpack_require__(6);\n\t\n\tvar _Shape2 = _interopRequireDefault(_Shape);\n\t\n\tvar _Rectangle = __webpack_require__(4);\n\t\n\tvar _Rectangle2 = _interopRequireDefault(_Rectangle);\n\t\n\tvar _Label = __webpack_require__(19);\n\t\n\tvar _Label2 = _interopRequireDefault(_Label);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\t/**\r\n\t * The Cell is the common parent for Node and Edge.\r\n\t */\n\tvar Cell = function () {\n\t\tfunction Cell(graph) {\n\t\t\tvar config = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : { id: _lodash2.default.uniqueId() };\n\t\n\t\t\t_classCallCheck(this, Cell);\n\t\n\t\t\tthis.graph = graph;\n\t\t\tthis.id = config.id;\n\t\t\tdelete config.id;\n\t\n\t\t\t// Initialize decorators\n\t\t\tif (config.decorators) {\n\t\t\t\tthis.createDecorators(config.decorators);\n\t\t\t\tdelete config.decorators;\n\t\t\t}\n\t\n\t\t\t// Initialize View Properties\n\t\t\tif (config.views) {\n\t\t\t\tthis.viewProps = config.views;\n\t\t\t\tdelete config.views;\n\t\t\t}\n\t\n\t\t\t// Initialize type\n\t\t\tvar type = config.type || \"Default\";\n\t\t\ttype = _Utils2.default.type(this.constructor.namespace, type);\n\t\t\tif (!type) throw new Error(\"Type not found \" + config.type);\n\t\t\tdelete config.type;\n\t\t\tthis.props = new type(config);\n\t\t}\n\t\n\t\t_createClass(Cell, [{\n\t\t\tkey: \"prop\",\n\t\t\tvalue: function prop(name, value) {\n\t\t\t\tif (_lodash2.default.isUndefined(value)) return this.props[name];\n\t\t\t\tthis.props[name] = value;\n\t\t\t}\n\t\n\t\t\t/**\r\n\t   * Get/Set property stored by views.\r\n\t   * @param key\r\n\t   * @param name\r\n\t   * @param value\r\n\t   * @returns {*}\r\n\t   */\n\t\n\t\t}, {\n\t\t\tkey: \"viewProp\",\n\t\t\tvalue: function viewProp() {\n\t\t\t\tvar key = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 'default';\n\t\t\t\tvar name = arguments[1];\n\t\t\t\tvar value = arguments[2];\n\t\n\t\t\t\tif (_lodash2.default.isUndefined(value)) {\n\t\t\t\t\tif (key == 'default') return this.prop(name, value);\n\t\t\t\t\treturn this.viewProps[key][name];\n\t\t\t\t}\n\t\t\t\tif (key == 'default') {\n\t\t\t\t\tthis.prop(name, value);\n\t\t\t\t} else {\n\t\t\t\t\tif (!this.viewProps[key]) this.viewProps[key] = {};\n\t\t\t\t\tthis.viewProps[key][name] = value;\n\t\t\t\t}\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"createDecorators\",\n\t\t\tvalue: function createDecorators(decorators) {}\n\t\n\t\t\t/**\r\n\t   * Get properties needed for rendering this element\r\n\t   * @returns {{key: (string|*), className: *, namespace: *, bounds: *}}\r\n\t   */\n\t\n\t\t}, {\n\t\t\tkey: \"getView\",\n\t\t\tvalue: function getView(key) {\n\t\t\t\tvar shape = this.getShape(key);\n\t\t\t\treturn _lodash2.default.assign({\n\t\t\t\t\tid: this.id,\n\t\t\t\t\tkey: key,\n\t\t\t\t\tclassName: this.computedClassName,\n\t\t\t\t\tstyle: this.viewProp(key, 'style'),\n\t\t\t\t\tnamespace: this.namespace\n\t\t\t\t}, shape);\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"getShape\",\n\t\t\tvalue: function getShape(key) {\n\t\t\t\tvar shape = _Cache2.default.get(this.id + \".shape\", key);\n\t\t\t\tif (shape) return shape;\n\t\n\t\t\t\tvar shapeConfig = this.viewProp(key, 'shape');\n\t\t\t\tvar shapeClass = shapeConfig ? _Shape2.default.getShape(shapeConfig.name) : _Shape2.default.getShape('Rectangle');\n\t\t\t\tvar x = this.viewProp(key, \"x\");\n\t\t\t\tvar y = this.viewProp(key, \"y\");\n\t\t\t\tvar width = this.viewProp(key, \"width\");\n\t\t\t\tvar height = this.viewProp(key, \"height\");\n\t\t\t\tshape = new shapeClass(x, y, width, height, shapeConfig);\n\t\t\t\t_Cache2.default.set(this.id + '.shape', shape, key);\n\t\t\t\treturn shape;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"render\",\n\t\t\tvalue: function render(view) {\n\t\t\t\tvar template = _Cache2.default.get(this.id + '.template', view.id);\n\t\t\t\tif (!template) {\n\t\t\t\t\t//create the template\n\t\t\t\t\tvar role = this.prop('role');\n\t\t\t\t\ttemplate = view.getTemplate('$' + role, null, this);\n\t\t\t\t\tif (_lodash2.default.isString(template)) template = _lodash2.default.template(template);\n\t\t\t\t\t_Cache2.default.set(this.id + '.template', template, view.id);\n\t\t\t\t}\n\t\t\t\treturn template(this.getView(view.id));\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"renderShape\",\n\t\t\tvalue: function renderShape(view) {\n\t\t\t\tvar shape = this.getShape(view.id);\n\t\t\t\tif (shape) return shape.render(view);\n\t\t\t\treturn '';\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"renderLabel\",\n\t\t\tvalue: function renderLabel(view) {\n\t\t\t\tif (this == this.graph.currentRoot) return null;\n\t\t\t\tvar box = this.getLabelBox(view.id);\n\t\t\t\tif (box) return view.renderLabel(box);\n\t\t\t\treturn '';\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"getLabelBox\",\n\t\t\tvalue: function getLabelBox(key) {\n\t\t\t\tvar box = _Cache2.default.get(this.id + '.labelBox', key);\n\t\t\t\tif (box) return box;\n\t\t\t\tvar shape = this.getShape(key);\n\t\t\t\t// Just get the config will have a positive performance boost for IE11 and IE10.\n\t\t\t\tbox = _Label2.default.getLabelBox(this.prop('label'), this.viewProp(key, 'labelConfig'), shape.width, shape.height);\n\t\t\t\t_Cache2.default.set(this.id + '.labelBox', box, key);\n\t\t\t\treturn box;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"destroy\",\n\t\t\tvalue: function destroy() {\n\t\t\t\tdelete this.graph;\n\t\t\t\tdelete this.decorators;\n\t\t\t\tdelete this.props;\n\t\t\t\tdelete this.viewProps;\n\t\t\t\tthis.destroyed = true;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"computedClassName\",\n\t\t\tget: function get() {\n\t\t\t\tif (!this._computedClassName) {\n\t\t\t\t\tvar buf = new _StringBuffer2.default(this.prop(\"role\"));\n\t\t\t\t\tvar props = this.props;\n\t\t\t\t\tif (props.hasOwnProperty(\"className\")) buf.append(props[\"className\"]);\n\t\t\t\t\tprops = props.constructor.prototype;\n\t\t\t\t\twhile (props) {\n\t\t\t\t\t\tif (props.hasOwnProperty(\"className\")) buf.append(props[\"className\"]);\n\t\t\t\t\t\tprops = Object.getPrototypeOf(props);\n\t\t\t\t\t}\n\t\t\t\t\tthis._computedClassName = buf.toString(' ');\n\t\t\t\t}\n\t\t\t\treturn this._computedClassName;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"namespace\",\n\t\t\tget: function get() {\n\t\t\t\tif (this == this.graph.currentRoot) return '';\n\t\t\t\treturn \"root.\" + this.prop(\"role\");\n\t\t\t}\n\t\t}]);\n\t\n\t\treturn Cell;\n\t}();\n\t\n\t/*\r\n\t\r\n\tCell.prototype.move = function(x, y) {\r\n\t\tthis.setProperty(\"x\", Math.round(x));\r\n\t\tthis.setProperty(\"y\", Math.round(y));\r\n\t\tdelete this.bounds;\r\n\t};\r\n\t\r\n\tCell.prototype.resize = function(w, h) {\r\n\t\tthis.setProperty(\"width\", w);\r\n\t\tthis.setProperty(\"height\", h);\r\n\t\tdelete this.bounds;\r\n\t};\r\n\t\r\n\tCell.prototype.canEdit = function() {\r\n\t\treturn (this.graph ? this.graph.canEdit() : true) && this.getProperty(\"editable\");\r\n\t};\r\n\t\r\n\tCell.prototype.canSelect = function() {\r\n\t\treturn (this.graph ? this.graph.canSelect() : true) && this.getProperty(\"selectable\");\r\n\t};\r\n\t\r\n\tCell.prototype.canMove = function() {\r\n\t\treturn (this.graph ? this.graph.canEdit() : true) && this.getProperty(\"draggable\");\r\n\t};\r\n\t\r\n\tCell.prototype.canResize = function() {\r\n\t\treturn (this.graph ? this.graph.canEdit() : true) && this.getProperty(\"resizable\");\r\n\t};\r\n\t\r\n\tCell.prototype.getTypeFromString = function(typeStr) {\r\n\t\treturn this.graph.getType(typeStr);\r\n\t};\r\n\t\r\n\tCell.prototype.createModifiers = function(modifiers) {\r\n\t\tthis.modifiers = null;\r\n\t\tvar modifierSettings = this.getProperty(\"modifierSettings\");\r\n\t\tif (modifierSettings) {\r\n\t\t\t_.each(modifiers, function(config) {\r\n\t\t\t\tconfig.type = this.graph.getModifierType(config.className);\r\n\t\t\t\tconfig.setting = modifierSettings[config.className];\r\n\t\t\t\tif (!config.type || !config.setting) return;\r\n\t\r\n\t\t\t\tthis.addModifier(config.className, new Modifier(this, config));\r\n\t\t\t}, this);\r\n\t\r\n\t\t\t// Check for showAlways settings\r\n\t\t\t_.each(modifierSettings, function(setting, name) {\r\n\t\t\t\tif (setting.showAlways && (!this.modifiers || !this.modifiers[name])) {\r\n\t\t\t\t\tvar config = {type: this.graph.getModifierType(name), setting: setting};\r\n\t\t\t\t\tif (!config.type) return;\r\n\t\t\t\t\tthis.addModifier(name, new Modifier(this, config));\r\n\t\t\t\t}\r\n\t\t\t}, this);\r\n\t\t}\r\n\t};\r\n\t\r\n\tCell.prototype.addModifier = function(name, modifier) {\r\n\t\tif (!this.modifiers)\r\n\t\t\tthis.modifiers = {};\r\n\t\r\n\t\tif (!modifier.hasOwnProperty(\"showHeader\"))\r\n\t\t\tmodifier.showHeader = true;\r\n\t\r\n\t\t// @hack preferably set it in configurations.\r\n\t\tif (modifier.name == \"HoverProcessModifier\" || modifier.name == \"HoverResults\")\r\n\t\t\tmodifier.showHeader = false;\r\n\t\r\n\t\tthis.modifiers[name] = modifier;\r\n\t};\r\n\t\r\n\tCell.prototype.getModifiers = function() {\r\n\t\tif (_.isUndefined(this.modifiers))\r\n\t\t\tthis.createModifiers();\r\n\t\treturn this.modifiers;\r\n\t};\r\n\t\r\n\tCell.prototype.getModifier = function(name) {\r\n\t\tvar modifiers = this.getModifiers();\r\n\t\tif (modifiers)\r\n\t\t\treturn modifiers[name];\r\n\t\treturn null;\r\n\t};\r\n\t\r\n\tCell.prototype.isVisible = function() {\r\n\t\treturn this.getProperty('visible');\r\n\t};\r\n\t\r\n\tCell.prototype.isContainer = function() {\r\n\t\treturn false;\r\n\t};\r\n\t*/\n\t\n\t\n\texports.default = Cell;\n\n/***/ },\n/* 18 */\n/***/ function(module, exports) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t\tvalue: true\n\t});\n\t/**\r\n\t * Created by tong on 6/7/2016.\r\n\t */\n\t\n\tvar caches = {};\n\t\n\tvar Cache = {\n\t\tget: function get(key, namespace) {\n\t\t\treturn this.getCache(namespace)[key];\n\t\t},\n\t\n\t\tset: function set(key, value, namespace) {\n\t\t\tthis.getCache(namespace)[key] = value;\n\t\t},\n\t\n\t\tcontains: function contains(key, namespace) {\n\t\t\treturn key in this.getCache(namespace);\n\t\t},\n\t\n\t\tremove: function remove(key, namespace) {\n\t\t\tdelete this.getCache(namespace)[key];\n\t\t},\n\t\n\t\tclear: function clear(namesapce) {\n\t\t\tif (!namespace) caches = {};else if (caches[namespace]) caches[namespace] = {};\n\t\t},\n\t\n\t\tgetCache: function getCache() {\n\t\t\tvar namespace = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 'default';\n\t\n\t\t\tif (!caches[namespace]) caches[namespace] = {};\n\t\t\treturn caches[namespace];\n\t\t}\n\t};\n\t\n\texports.default = Cache;\n\n/***/ },\n/* 19 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t\tvalue: true\n\t});\n\t\n\tvar _lodash = __webpack_require__(5);\n\t\n\tvar _lodash2 = _interopRequireDefault(_lodash);\n\t\n\tvar _bean = __webpack_require__(12);\n\t\n\tvar _bean2 = _interopRequireDefault(_bean);\n\t\n\tvar _Utils = __webpack_require__(2);\n\t\n\tvar _Utils2 = _interopRequireDefault(_Utils);\n\t\n\tvar _DomUtils = __webpack_require__(7);\n\t\n\tvar _DomUtils2 = _interopRequireDefault(_DomUtils);\n\t\n\tvar _StringBuffer = __webpack_require__(8);\n\t\n\tvar _StringBuffer2 = _interopRequireDefault(_StringBuffer);\n\t\n\tvar _Rectangle = __webpack_require__(4);\n\t\n\tvar _Rectangle2 = _interopRequireDefault(_Rectangle);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tvar FONT_BOLD = 1,\n\t    FONT_ITALIC = 2,\n\t    FONT_UNDERLINE = 4,\n\t    FONT_SHADOW = 8;\n\t\n\tvar defaultConfig = {\n\t\tfontSize: 11,\n\t\tfontFamily: \"Arial\",\n\t\tfontStyle: 0,\n\t\tfontColor: 'black',\n\t\tpadding: 0,\n\t\tlinePadding: 0,\n\t\talign: \"left\",\n\t\twidth: 0,\n\t\theight: 0,\n\t\trotation: null,\n\t\tgeometry: { x: 0, y: 0, anchorY: 0, offsetX: 0, offsetY: 0 }\n\t};\n\t\n\t/**\r\n\t * The label object handles label sizing/positioning\r\n\t */\n\t\n\texports.default = function () {\n\t\tvar stringMeasureEl = null,\n\t\t    measureDiv = void 0,\n\t\t    baselineDiv = void 0;\n\t\n\t\t/**\r\n\t  * Calculate the size of the string.\r\n\t  */\n\t\tvar getStringSize = _lodash2.default.memoize(function (str, fontSize, fontFamily, bold) {\n\t\t\tfontSize = fontSize || 11;\n\t\t\tfontFamily = fontFamily || 'Arial,Helvetica';\n\t\t\tbold = !_lodash2.default.isUndefined(bold) ? bold : false;\n\t\n\t\t\t// first check if there is a string-measuring div available, if not, create now.\n\t\t\tif (!stringMeasureEl) {\n\t\t\t\tstringMeasureEl = _DomUtils2.default.createElement('iframe', { id: \"_ComputeStylesIframe\" }, { position: \"absolute\", visibility: \"hidden\", width: \"auto\" });\n\t\t\t\tdocument.body.appendChild(stringMeasureEl);\n\t\t\t\tvar doc = stringMeasureEl.contentWindow.document;\n\t\t\t\tdoc.open();\n\t\t\t\tdoc.write('<html><body>\\\r\n\t\t\t\t\t<div id=\"baselineDiv\" style=\"height:100px;\"><span style=\"line-height:0\">T</span><span style=\"height:100%;display:inline-block;\"></span></div>\\\r\n\t\t\t\t\t<div id=\"measureDiv\" style=\"position:absolute;width:auto;height:auto;padding:0;white-space:pre-wrap;word-wrap:break-word;display:inline-block;\"></div>\\\r\n\t\t\t\t\t</body></html>');\n\t\t\t\tdoc.close();\n\t\t\t\tmeasureDiv = doc.getElementById(\"measureDiv\");\n\t\t\t\tbaselineDiv = doc.getElementById(\"baselineDiv\");\n\t\t\t}\n\t\t\tbaselineDiv.style.fontSize = measureDiv.style.fontSize = fontSize;\n\t\t\tbaselineDiv.style.fontFamily = measureDiv.style.fontFamily = fontFamily;\n\t\t\tbaselineDiv.style.fontWeight = measureDiv.style.fontWeight = bold ? 'bold' : 'normal';\n\t\t\tmeasureDiv.innerHTML = str;\n\t\n\t\t\tvar strut = baselineDiv.firstChild;\n\t\t\tvar baselineHeight = strut.offsetTop + strut.offsetHeight - baselineDiv.offsetHeight - baselineDiv.offsetTop;\n\t\n\t\t\treturn { width: measureDiv.offsetWidth, height: measureDiv.offsetHeight, baseline: baselineHeight };\n\t\t}, function (str, fontSize, fontFamily, bold) {\n\t\t\treturn str + ';' + fontSize + ';' + fontFamily + ';' + bold;\n\t\t});\n\t\n\t\t/**\r\n\t  * Create a wrapped text.\r\n\t  * @param {String} string the string to wrap.\r\n\t  * @param {maxWidth} the maximum width this string can take.\r\n\t  * @param {fontSize}\r\n\t  * @param {fontFamily}\r\n\t  * @param {bold}\r\n\t  */\n\t\tvar wrap = _lodash2.default.memoize(function (string, maxWidth, fontSize, fontFamily, bold) {\n\t\t\tmaxWidth = maxWidth || 0;\n\t\t\tfontSize = fontSize || 11;\n\t\t\tfontFamily = fontFamily || 'Arial,Helvetica';\n\t\t\tbold = !_lodash2.default.isUndefined(bold) ? bold : false;\n\t\n\t\t\tvar arr = [];\n\t\t\tvar spaceSize = getStringSize(\"&nbsp;\", fontSize, fontFamily, bold),\n\t\t\t    space = spaceSize.width;\n\t\t\tarr.lineHeight = spaceSize.height;\n\t\t\tarr.baseline = spaceSize.baseline;\n\t\n\t\t\tif (!maxWidth || !string || string == \"\") {\n\t\t\t\tarr.push(string);\n\t\t\t\tarr.width = !string || string == \"\" ? space : getStringSize(string, fontSize, fontFamily, bold).width;\n\t\t\t\tarr.height = arr.lineHeight;\n\t\t\t\treturn arr;\n\t\t\t}\n\t\n\t\t\tvar width = 0;\n\t\t\t//split the text by lines\n\t\t\tvar lines = string.split('\\n');\n\t\n\t\t\tvar buf = new _StringBuffer2.default();\n\t\n\t\t\tfor (var j = 0; j < lines.length; j++) {\n\t\t\t\t//split each line by word\n\t\t\t\tvar words = lines[j].split(/\\s/);\n\t\t\t\tvar line = \"\",\n\t\t\t\t    currentWidth = 0,\n\t\t\t\t    wordWidth = 0,\n\t\t\t\t    newLine = true,\n\t\t\t\t    word;\n\t\n\t\t\t\tfor (var i = 0; i < words.length; i++) {\n\t\t\t\t\tword = words[i];\n\t\t\t\t\twordWidth = getStringSize(word, fontSize, fontFamily, bold).width;\n\t\n\t\t\t\t\tif ((newLine ? wordWidth : currentWidth + space + wordWidth) > maxWidth) {\n\t\t\t\t\t\tif (newLine) {\n\t\t\t\t\t\t\tbuf.append(word);\n\t\t\t\t\t\t\twidth = Math.max(width, wordWidth);\n\t\t\t\t\t\t\tif (i < words.length - 1) {\n\t\t\t\t\t\t\t\tarr.push(buf.toString());\n\t\t\t\t\t\t\t\tbuf.clear();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tarr.push(buf.append(line).toString());\n\t\t\t\t\t\t\twidth = Math.max(width, currentWidth + space + wordWidth);\n\t\t\t\t\t\t\tbuf.clear();\n\t\t\t\t\t\t}\n\t\t\t\t\t\tline = \"\";\n\t\t\t\t\t\tcurrentWidth = 0;\n\t\t\t\t\t\tif (!newLine) i--; // move back one word.\n\t\t\t\t\t\tnewLine = true;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tline = newLine ? word : line + \" \" + word;\n\t\t\t\t\t\tcurrentWidth = newLine ? wordWidth : currentWidth + space + wordWidth;\n\t\t\t\t\t\twidth = Math.max(width, currentWidth);\n\t\t\t\t\t\tnewLine = false;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (line != \"\") buf.append(line);\n\t\t\t\tif (j < lines.length - 1) {\n\t\t\t\t\tarr.push(buf.toString());\n\t\t\t\t\tbuf.clear();\n\t\t\t\t}\n\t\t\t}\n\t\n\t\t\tarr.push(buf.toString());\n\t\t\tarr.width = width;\n\t\t\tarr.height = arr.lineHeight * arr.length;\n\t\t\treturn arr;\n\t\t}, function (str, maxWidth, fontSize, fontFamily, bold) {\n\t\t\treturn str + ';' + maxWidth + ';' + fontSize + ';' + fontFamily + ';' + bold;\n\t\t});\n\t\n\t\t/**\r\n\t  *  Get the view information for how to display the label.\r\n\t  * @param label The string that needs to be displayed\r\n\t  * @param containerWidth The width of the parent container.\r\n\t  * @param containerHeight The height of the parent container.\r\n\t  * @param labelConfig The configuration on how to display label. It should be an object with the following parameters:\r\n\t  * {\r\n\t  *      fontSize, fontFamily, fontStyle, padding,\r\n\t  *      align: can be either \"left\", \"center\" or \"right\",\r\n\t  *      width: the maximum width of the label. if less than 1, then is treated as percentage. If 0, no wrapping will occur,\r\n\t  *      height,\r\n\t  *      geometry\r\n\t  * }\r\n\t  * @returns {*}\r\n\t  */\n\t\tfunction getLabelBox(label, labelConfig, containerWidth, containerHeight) {\n\t\t\treturn _getLabelBox.call(this, label, labelConfig, { width: containerWidth, height: containerHeight });\n\t\t}\n\t\n\t\tfunction getLabelBoxForLink(label, labelConfig, link) {\n\t\t\treturn _getLabelBox.call(this, label, labelConfig, link);\n\t\t}\n\t\n\t\tfunction _getLabelBox(label) {\n\t\t\tvar labelConfig = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n\t\t\tvar context = arguments[2];\n\t\n\t\t\tlabelConfig = _lodash2.default.defaultsDeep(labelConfig, defaultConfig);\n\t\t\tvar fontSize = labelConfig.fontSize;\n\t\t\tvar fontFamily = labelConfig.fontFamily;\n\t\t\tvar fontStyle = labelConfig.fontStyle;\n\t\t\tvar bold = (fontStyle & FONT_BOLD) == FONT_BOLD;\n\t\t\tvar padding = labelConfig.padding;\n\t\t\tvar linePadding = labelConfig.linePadding;\n\t\t\tvar align = labelConfig.align;\n\t\n\t\t\tvar w = labelConfig.width,\n\t\t\t    h = labelConfig.height;\n\t\t\tif (context.width) {\n\t\t\t\tw = w <= 5 ? context.width * w : w;\n\t\t\t\th = h <= 5 ? context.height * h : h;\n\t\t\t}\n\t\t\tw -= 2 * padding;\n\t\t\th -= 2 * padding;\n\t\t\tw = Math.max(0, w);\n\t\t\th = Math.max(0, h);\n\t\n\t\t\tvar geometry = _lodash2.default.clone(labelConfig.geometry);\n\t\t\tvar wrappedLabel = this.wrap(label, w, fontSize, fontFamily, bold);\n\t\t\tgeometry.width = wrappedLabel.width + 2 * padding;\n\t\t\tgeometry.height = wrappedLabel.height + 2 * padding + (wrappedLabel.length - 1) * linePadding;\n\t\t\tvar anchor = \"start\",\n\t\t\t    dx = 0,\n\t\t\t    setAnchorX = !_lodash2.default.has(geometry, \"anchorX\");\n\t\t\tswitch (align) {\n\t\t\t\tcase \"center\":\n\t\t\t\t\tanchor = \"middle\";\n\t\t\t\t\tif (setAnchorX) geometry.anchorX = 0;\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"right\":\n\t\t\t\t\tanchor = \"end\";\n\t\t\t\t\tdx = wrappedLabel.width / 2;\n\t\t\t\t\tif (setAnchorX) geometry.anchorX = -0.5;\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"left\":\n\t\t\t\t\tdx = -wrappedLabel.width / 2;\n\t\t\t\t\tif (setAnchorX) geometry.anchorX = 0.5;\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t\tvar pos = void 0;\n\t\t\tif (context.getRelativePosition) pos = context.getRelativePosition(geometry);else pos = _Utils2.default.getRelativePosition({ width: context.width, height: context.height }, geometry);\n\t\n\t\t\tvar bounds = new _Rectangle2.default(pos[0], pos[1], geometry.width, geometry.height);\n\t\t\t// the pivot is the center of rotation when the label has a rotation specified.\n\t\t\tvar pivot = align == 'center' ? [0, 0] : align == 'left' ? [-wrappedLabel.width / 2, 0] : [wrappedLabel.width / 2, 0];\n\t\n\t\t\t// the maximum bounds for the label, used to position inline editor\n\t\t\tgeometry.width = Math.max(w + 2 * padding, geometry.width);\n\t\t\tgeometry.height = Math.max(h + 2 * padding, geometry.height);\n\t\n\t\t\tif (context.getRelativePosition) pos = context.getRelativePosition(geometry);else pos = _Utils2.default.getRelativePosition({ width: context.width, height: context.height }, geometry);\n\t\n\t\t\tvar maxBounds = new _Rectangle2.default(pos[0], pos[1], geometry.width, geometry.height);\n\t\t\treturn {\n\t\t\t\tconfig: labelConfig, label: wrappedLabel, _label: label,\n\t\t\t\tbold: bold, underline: fontStyle & FONT_UNDERLINE, italic: fontStyle & FONT_ITALIC, shadow: fontStyle & FONT_SHADOW,\n\t\t\t\tdx: dx, dy: -geometry.height / 2 + padding + wrappedLabel.lineHeight - wrappedLabel.baseline, anchor: anchor, lineHeight: wrappedLabel.lineHeight + linePadding,\n\t\t\t\tpivot: pivot, bounds: bounds, maxBounds: maxBounds\n\t\t\t};\n\t\t}\n\t\n\t\tfunction render(view, box) {\n\t\t\treturn view.renderLabel(box);\n\t\t}\n\t\n\t\tvar editor = {\n\t\t\tstart: function start(key, container, box, refEl, textEl) {\n\t\t\t\tvar _this = this;\n\t\n\t\t\t\tvar scale = arguments.length > 5 && arguments[5] !== undefined ? arguments[5] : 1.0;\n\t\t\t\tvar singleLine = arguments.length > 6 && arguments[6] !== undefined ? arguments[6] : true;\n\t\n\t\t\t\tif (this.input) {\n\t\t\t\t\tif (this.key != key) {\n\t\t\t\t\t\t// need to close the existing editor first\n\t\t\t\t\t\tthis.stop();\n\t\t\t\t\t} else return;\n\t\t\t\t}\n\t\t\t\tvar tag = singleLine ? 'input' : 'textarea';\n\t\t\t\tthis.input = _DomUtils2.default.createElement(tag, { id: \"inlineEditor\", unselectable: \"off\" }, { position: \"absolute\", overflow: \"hidden\", padding: \"0px\", margin: \"0px\", border: \"transparent\" });\n\t\t\t\tif (singleLine) {\n\t\t\t\t\t_bean2.default.on(this.input, 'keydown keyup', function (event) {\n\t\t\t\t\t\tif (event.keyCode == 13) {\n\t\t\t\t\t\t\t_bean2.default.off(_this.input, 'keydown keyup');\n\t\t\t\t\t\t\t_this.stop();\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\tcontainer.appendChild(this.input);\n\t\n\t\t\t\tthis.key = key;\n\t\t\t\tthis.box = box;\n\t\t\t\tthis.refEl = refEl;\n\t\t\t\tthis.textEl = textEl;\n\t\n\t\t\t\tvar labelConfig = box.config;\n\t\t\t\tvar maxBounds = new _Rectangle2.default(box.maxBounds.x, box.maxBounds.y, box.maxBounds.width * scale, box.maxBounds.height * scale);\n\t\t\t\tvar pos = _DomUtils2.default.getCenterPosition(refEl, container);\n\t\t\t\tpos = [pos[0] + maxBounds.left, pos[1] + maxBounds.top];\n\t\n\t\t\t\tif (textEl) textEl.style.visibility = 'hidden';\n\t\n\t\t\t\t_DomUtils2.default.setElement(this.input, null, {\n\t\t\t\t\tvisibility: 'visible',\n\t\t\t\t\tleft: pos[0] + \"px\",\n\t\t\t\t\ttop: pos[1] + \"px\",\n\t\t\t\t\twidth: maxBounds.width + 'px',\n\t\t\t\t\theight: maxBounds.height + 'px',\n\t\t\t\t\t\"font-family\": labelConfig.fontFamily,\n\t\t\t\t\t\"font-size\": labelConfig.fontSize * scale + 'px',\n\t\t\t\t\t\"font-weight\": (labelConfig.fontStyle & FONT_BOLD) == FONT_BOLD ? 'bold' : 'normal'\n\t\t\t\t\t/*\"color\": labelConfig.fontColor*/\n\t\t\t\t});\n\t\n\t\t\t\tthis.input.value = box._label;\n\t\t\t\tthis.input.focus();\n\t\t\t\tthis.input.select();\n\t\t\t\t_bean2.default.fire(this, 'editor.start', [this.key]);\n\t\t\t},\n\t\n\t\t\tstop: function stop(cancel) {\n\t\t\t\tif (!this.input) return;\n\t\n\t\t\t\tcancel = cancel || false;\n\t\t\t\tif (this.textEl) this.textEl.style.visibility = null;\n\t\n\t\t\t\tif (!cancel) _bean2.default.fire(this, 'editor.update', [this.key, this.input.value]);\n\t\n\t\t\t\t_bean2.default.fire(this, 'editor.stop', [this.key]);\n\t\n\t\t\t\t// remove the input\n\t\t\t\tthis.input.parentNode.removeChild(this.input);\n\t\t\t\tdelete this.input;\n\t\t\t\tdelete this.key;\n\t\t\t\tdelete this.box;\n\t\t\t\tdelete this.refEl;\n\t\t\t\tdelete this.textEl;\n\t\t\t}\n\t\t};\n\t\n\t\treturn {\n\t\t\tFONT_BOLD: FONT_BOLD,\n\t\t\tFONT_ITALIC: FONT_ITALIC,\n\t\t\tFONT_UNDERLINE: FONT_UNDERLINE,\n\t\t\tFONT_SHADOW: FONT_SHADOW,\n\t\t\tgetStringSize: getStringSize,\n\t\t\twrap: wrap,\n\t\t\tgetLabelBox: getLabelBox,\n\t\t\tgetLabelBoxForLink: getLabelBoxForLink,\n\t\t\trender: render,\n\t\t\teditor: editor\n\t\t};\n\t}();\n\n/***/ },\n/* 20 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t\tvalue: true\n\t});\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tvar _get = function get(object, property, receiver) { if (object === null) object = Function.prototype; var desc = Object.getOwnPropertyDescriptor(object, property); if (desc === undefined) { var parent = Object.getPrototypeOf(object); if (parent === null) { return undefined; } else { return get(parent, property, receiver); } } else if (\"value\" in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } };\n\t\n\tvar _lodash = __webpack_require__(5);\n\t\n\tvar _lodash2 = _interopRequireDefault(_lodash);\n\t\n\tvar _Cell2 = __webpack_require__(17);\n\t\n\tvar _Cell3 = _interopRequireDefault(_Cell2);\n\t\n\tvar _Rectangle = __webpack_require__(4);\n\t\n\tvar _Rectangle2 = _interopRequireDefault(_Rectangle);\n\t\n\tvar _Link = __webpack_require__(11);\n\t\n\tvar _Link2 = _interopRequireDefault(_Link);\n\t\n\tvar _Label = __webpack_require__(19);\n\t\n\tvar _Label2 = _interopRequireDefault(_Label);\n\t\n\tvar _Cache = __webpack_require__(18);\n\t\n\tvar _Cache2 = _interopRequireDefault(_Cache);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\t\n\tfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\t\n\tvar Edge = function (_Cell) {\n\t\t_inherits(Edge, _Cell);\n\t\n\t\tfunction Edge(graph) {\n\t\t\tvar config = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n\t\t\tvar source = arguments[2];\n\t\t\tvar target = arguments[3];\n\t\n\t\t\t_classCallCheck(this, Edge);\n\t\n\t\t\tif (!config.id) config.id = _lodash2.default.uniqueId('E');\n\t\n\t\t\tvar _this = _possibleConstructorReturn(this, (Edge.__proto__ || Object.getPrototypeOf(Edge)).call(this, graph, config));\n\t\n\t\t\t_this.source = _this.target = null;\n\t\t\t_this.setSource(source, config.sourcePos);\n\t\t\t_this.setTarget(target, config.targetPos);\n\t\t\treturn _this;\n\t\t}\n\t\n\t\t_createClass(Edge, [{\n\t\t\tkey: \"setSource\",\n\t\t\tvalue: function setSource(node, pos) {\n\t\t\t\tthis.setTerminal(node, pos, 'source');\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"setTarget\",\n\t\t\tvalue: function setTarget(node, pos) {\n\t\t\t\tthis.setTerminal(node, pos, 'target');\n\t\t\t}\n\t\n\t\t\t/**\r\n\t   * Internal methods to set either the source or target\r\n\t   */\n\t\n\t\t}, {\n\t\t\tkey: \"setTerminal\",\n\t\t\tvalue: function setTerminal(node, pos, dir) {\n\t\t\t\tvar end = dir == 'source' ? this.source : this.target;\n\t\t\t\tif (end == node) {\n\t\t\t\t\t// simply change the position of the edge.\n\t\t\t\t\tif (node) node.setEdgeAt(this, pos);\n\t\t\t\t} else {\n\t\t\t\t\tif (end) {\n\t\t\t\t\t\t// first remove the edge from the current end\n\t\t\t\t\t\tend.removeEdge(this);\n\t\t\t\t\t}\n\t\n\t\t\t\t\tif (node) {\n\t\t\t\t\t\tif (dir == 'source') node.addOutEdge(this, pos);else node.addInEdge(this, pos);\n\t\t\t\t\t}\n\t\t\t\t\tif (dir == 'source') this.source = node;else this.target = node;\n\t\t\t\t\t//this.clearPoints();\n\t\t\t\t}\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"getLabelBox\",\n\t\t\tvalue: function getLabelBox(key) {\n\t\t\t\tvar label = this.prop('label');\n\t\t\t\tif (label) return _Label2.default.getLabelBoxForLink(label, this.viewProp(key, 'labelConfig'), this.getShape(key));\n\t\t\t\treturn null;\n\t\t\t}\n\t\n\t\t\t/**\r\n\t   * Return a pair of points as reference to the calculation of start and end points.\r\n\t   */\n\t\n\t\t}, {\n\t\t\tkey: \"getReferencePoints\",\n\t\t\tvalue: function getReferencePoints(key) {\n\t\t\t\tvar pts = [];\n\t\t\t\tif (this.source) pts.push(this.source.getShape(key).center);else pts.push(this.viewProp(key, 'start'));\n\t\n\t\t\t\tif (this.target) pts.push(this.target.getShape(key).center);else pts.push(this.viewProp(key, 'end'));\n\t\n\t\t\t\treturn pts;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"getTerminalVisual\",\n\t\t\tvalue: function getTerminalVisual(key, orthogonal) {\n\t\t\t\tvar refPts = this.getReferencePoints(key);\n\t\t\t\tvar terminals = [];\n\t\n\t\t\t\tvar getBound = function getBound(pt) {\n\t\t\t\t\treturn new _Rectangle2.default(pt.x, pt.y, 3, 3);\n\t\t\t\t};\n\t\n\t\t\t\tif (this.source) {\n\t\t\t\t\tterminals.push(this.source.getPort(key, this.prop('sourcePort'), refPts[1], orthogonal));\n\t\t\t\t} else terminals.push({ point: refPts[0], direction: _Rectangle2.default.getDirection(getBound(refPts[0]), refPts[1], true) });\n\t\n\t\t\t\tif (this.target) {\n\t\t\t\t\tterminals.push(this.target.getPort(key, this.prop('targetPort'), refPts[0], orthogonal));\n\t\t\t\t} else terminals.push({ point: refPts[1], direction: _Rectangle2.default.getDirection(getBound(refPts[1]), refPts[0], true) });\n\t\t\t\treturn terminals;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"getShape\",\n\t\t\tvalue: function getShape(key) {\n\t\t\t\tvar shape = _Cache2.default.get(this.id + \".shape\", key);\n\t\t\t\tif (shape) return shape;\n\t\n\t\t\t\tvar config = this.viewProp(key, 'shape');\n\t\t\t\tshape = _Link2.default.getLink(this.getTerminalVisual(key, config.orthogonal), config, this.prop('startMarker'), this.prop('endMarker'));\n\t\t\t\t_Cache2.default.set(this.id + '.shape', shape, key);\n\t\t\t\treturn shape;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"toString\",\n\t\t\tvalue: function toString() {\n\t\t\t\treturn 'Edge:{' + (!this.source ? 'null' : this.source.id) + '--' + (!this.target ? 'null' : this.target.id) + '}';\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"destroy\",\n\t\t\tvalue: function destroy() {\n\t\t\t\t_get(Edge.prototype.__proto__ || Object.getPrototypeOf(Edge.prototype), \"destroy\", this).call(this);\n\t\t\t\tthis.setSource(null);\n\t\t\t\tthis.setTarget(null);\n\t\t\t}\n\t\t}]);\n\t\n\t\treturn Edge;\n\t}(_Cell3.default);\n\t\n\tEdge.namespace = \"Edges\";\n\t\n\texports.default = Edge;\n\t\n\t/*\r\n\t\r\n\tEdge.prototype.isVisible = function() {\r\n\t\tif (this.graph.getProperty(\"allowDanglingEdges\")) {\r\n\t\t\treturn (this.source ? this.source.isVisible() : true) && (this.target ? this.target.isVisible() : true) && this.getProperty(\"visible\");\r\n\t\t} else\r\n\t\t\treturn this.source && this.target && this.getProperty('visible') && this.source.isVisible() && this.target.isVisible();\r\n\t};\r\n\r\n\t*/\n\n/***/ },\n/* 21 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t\tvalue: true\n\t});\n\t\n\tvar _Rectangle = __webpack_require__(4);\n\t\n\tvar _Rectangle2 = _interopRequireDefault(_Rectangle);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tvar registry = {};\n\t\n\tvar Marker = function () {\n\t\n\t\t/** Begin Standard Marker Type **/\n\t\tfunction arrow(size, source, styles) {\n\t\t\tvar sign = source ? -1 : 1;\n\t\t\tvar marker = {\n\t\t\t\tviewBox: new _Rectangle2.default(-5, -5, 10, 10),\n\t\t\t\tsize: size,\n\t\t\t\tref: [4 * sign, 0],\n\t\t\t\tfill: styles.color\n\t\t\t};\n\t\t\tmarker.shape = {\n\t\t\t\tname: 'Polygon',\n\t\t\t\tpoints: [[-2 * sign, 0], [-4 * sign, 4], [4 * sign, 0], [-4 * sign, -4]]\n\t\t\t};\n\t\t\treturn marker;\n\t\t}\n\t\n\t\tfunction triangle(size, source, styles) {\n\t\t\tvar sign = source ? -1 : 1;\n\t\t\tvar marker = {\n\t\t\t\tviewBox: new _Rectangle2.default(-5, -5, 10, 10),\n\t\t\t\tsize: size,\n\t\t\t\tref: [4 * sign, 0],\n\t\t\t\tfill: styles.color\n\t\t\t};\n\t\t\tmarker.shape = {\n\t\t\t\tname: 'Polygon',\n\t\t\t\tpoints: [[-5 * sign, -5], [-5 * sign, 5], [4 * sign, 0]]\n\t\t\t};\n\t\t\treturn marker;\n\t\t}\n\t\n\t\tfunction oval(size, source, styles) {\n\t\t\tvar r = size / 2;\n\t\t\tvar marker = {\n\t\t\t\tviewBox: new _Rectangle2.default(-r, -r, size, size),\n\t\t\t\tsize: size,\n\t\t\t\tref: [0, 0],\n\t\t\t\tfill: styles.color\n\t\t\t};\n\t\t\tmarker.shape = '<ellipse cx=\"0\" cy=\"0\" rx=\"' + r + '\" ry=\"' + r + '\"></ellipse>';\n\t\t\treturn marker;\n\t\t}\n\t\n\t\tfunction diamond(size, source, styles) {\n\t\t\tvar sign = source ? -1 : 1;\n\t\t\tvar marker = {\n\t\t\t\tviewBox: new _Rectangle2.default(-5, -5, 10, 10),\n\t\t\t\tsize: size,\n\t\t\t\tref: [4 * sign, 0],\n\t\t\t\tfill: styles.color\n\t\t\t};\n\t\t\tmarker.shape = '';\n\t\t\treturn marker;\n\t\t}\n\t\t/** End Standard Marker Type **/\n\t\tfunction getMarker(config, source) {\n\t\t\tvar factory = registry[config.type];\n\t\t\tvar marker = factory(config.size, source, config);\n\t\t\tmarker.id = config.id;\n\t\t\treturn marker;\n\t\t}\n\t\n\t\tregistry['arrow'] = arrow;\n\t\tregistry['triangle'] = triangle;\n\t\tregistry['oval'] = oval;\n\t\tregistry['diamond'] = diamond;\n\t\n\t\treturn {\n\t\t\tregistry: registry,\n\t\t\tgetMarker: getMarker\n\t\t};\n\t}();\n\t\n\texports.default = Marker;\n\n/***/ },\n/* 22 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t\tvalue: true\n\t});\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tvar _lodash = __webpack_require__(5);\n\t\n\tvar _lodash2 = _interopRequireDefault(_lodash);\n\t\n\tvar _Utils = __webpack_require__(2);\n\t\n\tvar _Utils2 = _interopRequireDefault(_Utils);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tvar Layout = function () {\n\t\tfunction Layout() {\n\t\t\tvar config = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n\t\n\t\t\t_classCallCheck(this, Layout);\n\t\n\t\t\tif (config.hasOwnProperty(\"orientation\") && _lodash2.default.isString(config.orientation)) {\n\t\t\t\tif (config.orientation.toUpperCase() == \"HORIZONTAL\") config.orientation = Layout.HORIZONTAL;else delete config.orientation;\n\t\t\t}\n\t\t\t_Utils2.default.initConfig(this, config);\n\t\t}\n\t\n\t\t_createClass(Layout, [{\n\t\t\tkey: \"layout\",\n\t\t\tvalue: function layout(root, bounds) {}\n\t\t}, {\n\t\t\tkey: \"reset\",\n\t\t\tvalue: function reset() {}\n\t\t}, {\n\t\t\tkey: \"destroy\",\n\t\t\tvalue: function destroy() {}\n\t\t}]);\n\t\n\t\treturn Layout;\n\t}();\n\t\n\tLayout.VERTICAL = 0;\n\tLayout.HORIZONTAL = 1;\n\t\n\tLayout.DEFAULTS = {\n\t\torientation: Layout.VERTICAL\n\t};\n\t\n\texports.default = Layout;\n\n/***/ },\n/* 23 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t\tvalue: true\n\t});\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tvar _Layout2 = __webpack_require__(22);\n\t\n\tvar _Layout3 = _interopRequireDefault(_Layout2);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\t\n\tfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\t\n\tvar FlowLayout = function (_Layout) {\n\t\t_inherits(FlowLayout, _Layout);\n\t\n\t\tfunction FlowLayout() {\n\t\t\t_classCallCheck(this, FlowLayout);\n\t\n\t\t\treturn _possibleConstructorReturn(this, (FlowLayout.__proto__ || Object.getPrototypeOf(FlowLayout)).apply(this, arguments));\n\t\t}\n\t\n\t\t_createClass(FlowLayout, [{\n\t\t\tkey: \"layout\",\n\t\t\tvalue: function layout(root, bounds) {\n\t\t\t\tvar items;\n\t\t\t\tif (!root) items = this.owner.childNodes;else if (_.isArray(root)) items = root;else items = root.getLinkedNodes('target');\n\t\t\t\tif (!items || items.length == 0) return;\n\t\n\t\t\t\tvar x = 0,\n\t\t\t\t    y = 0,\n\t\t\t\t    h = 0,\n\t\t\t\t    node;\n\t\t\t\tvar p1 = 0,\n\t\t\t\t    p2 = 0;\n\t\t\t\tfor (var i = 0; i < items.length; i++) {\n\t\t\t\t\tnode = items[i];\n\t\t\t\t\tif (x > 0 && x + this.hgap + node.getProperty(\"width\") > bounds.width) {\n\t\t\t\t\t\t// create new line\n\t\t\t\t\t\ty += h + this.vgap;\n\t\t\t\t\t\tx = 0;h = 0;p1 = 0;p2++;\n\t\t\t\t\t}\n\t\t\t\t\tnode._flPos = [p1, p2];\n\t\t\t\t\tnode.moveTo([bounds.x + x, bounds.y + y]);\n\t\t\t\t\tx += this.hgap + node.getProperty(\"width\");\n\t\t\t\t\tp1++;\n\t\t\t\t\th = h < node.getProperty(\"height\") ? node.getProperty(\"height\") : h;\n\t\t\t\t}\n\t\t\t\tthis.trigger(new Rectangle(bounds.x, bounds.y, bounds.width, y + h));\n\t\t\t}\n\t\t}]);\n\t\n\t\treturn FlowLayout;\n\t}(_Layout3.default);\n\t\n\tFlowLayout.DEFAULTS = {\n\t\thgap: 10,\n\t\tvgap: 10\n\t};\n\t\n\texports.default = FlowLayout;\n\n/***/ },\n/* 24 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t\tvalue: true\n\t});\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tvar _lodash = __webpack_require__(5);\n\t\n\tvar _lodash2 = _interopRequireDefault(_lodash);\n\t\n\tvar _bean = __webpack_require__(12);\n\t\n\tvar _bean2 = _interopRequireDefault(_bean);\n\t\n\tvar _Utils = __webpack_require__(2);\n\t\n\tvar _Utils2 = _interopRequireDefault(_Utils);\n\t\n\tvar _DomUtils = __webpack_require__(7);\n\t\n\tvar _DomUtils2 = _interopRequireDefault(_DomUtils);\n\t\n\tvar _Layout = __webpack_require__(22);\n\t\n\tvar _Layout2 = _interopRequireDefault(_Layout);\n\t\n\tvar _Rectangle = __webpack_require__(4);\n\t\n\tvar _Rectangle2 = _interopRequireDefault(_Rectangle);\n\t\n\tvar _EventDispatcher = __webpack_require__(13);\n\t\n\tvar _EventDispatcher2 = _interopRequireDefault(_EventDispatcher);\n\t\n\tvar _GraphBehavior = __webpack_require__(25);\n\t\n\tvar _GraphBehavior2 = _interopRequireDefault(_GraphBehavior);\n\t\n\tvar _SelectionBehavior = __webpack_require__(27);\n\t\n\tvar _SelectionBehavior2 = _interopRequireDefault(_SelectionBehavior);\n\t\n\tvar _Label = __webpack_require__(19);\n\t\n\tvar _Label2 = _interopRequireDefault(_Label);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tvar Renderer = function () {\n\t\tfunction Renderer(id, container) {\n\t\t\tvar config = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n\t\t\tvar graph = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : null;\n\t\n\t\t\t_classCallCheck(this, Renderer);\n\t\n\t\t\tthis.id = id;\n\t\t\tthis.box = _DomUtils2.default.createElement('div', { id: this.id, tabindex: 0, ns: 'graph' }, { overflow: \"hidden\", width: \"100%\", height: \"100%\", position: 'relative' });\n\t\t\tcontainer.appendChild(this.box);\n\t\t\tif (config.layout) {\n\t\t\t\tvar layoutClass = _Utils2.default.getConstructor(config.layout.jsClass, _Layout2.default);\n\t\t\t\tthis.layout = new layoutClass(config.layout.config);\n\t\t\t\tdelete config.layout;\n\t\t\t}\n\t\t\tthis.clear = true;\n\t\t\tthis._translate = [0, 0];\n\t\t\tthis._scale = 1.0;\n\t\t\tthis.graph = graph;\n\t\t\tthis.dispatcher = null;\n\t\t\tthis.graphBehavior = null;\n\t\t\tthis.selectionBehavior = null;\n\t\t\tthis.nodeBehavior = null;\n\t\t\tthis.edgeBehavior = null;\n\t\t\tthis.connectionBehavior = null;\n\t\t\t_Utils2.default.initConfig(this, config);\n\t\n\t\t\t_bean2.default.on(_Label2.default.editor, 'editor.update.*', function (key, value) {\n\t\t\t\tconsole.log(key + '=' + value);\n\t\t\t});\n\t\t}\n\t\n\t\t_createClass(Renderer, [{\n\t\t\tkey: \"viewport\",\n\t\t\tvalue: function viewport(scaled, _viewport) {\n\t\t\t\tif (_lodash2.default.isUndefined(scaled) || _lodash2.default.isNull(scaled)) scaled = false;\n\t\t\t\tif (!_viewport) {\n\t\t\t\t\tvar vp = new _Rectangle2.default(0, 0, this.box.offsetWidth, this.box.offsetHeight);\n\t\t\t\t\tif (scaled) return _Utils2.default.scale(this.translate, this.scale, vp);\n\t\t\t\t\treturn vp;\n\t\t\t\t}\n\t\t\t\tif (!scaled) _viewport = _Utils2.default.scale(this.translate, this.scale, _viewport);\n\t\t\t\tvar w = this.box.offsetWidth;\n\t\t\t\tvar scale = w / _viewport.width;\n\t\t\t\tthis.transform(-_viewport.x * scale, -_viewport.y * scale, scale);\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"transform\",\n\t\t\tvalue: function transform() {\n\t\t\t\tvar x = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : null;\n\t\t\t\tvar y = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : null;\n\t\t\t\tvar scale = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : null;\n\t\n\t\t\t\tvar graph = this.graph;\n\t\t\t\tvar root = graph ? graph.currentRoot : null;\n\t\t\t\tif (!_lodash2.default.isNull(x)) {\n\t\t\t\t\tthis._translate[0] = x;\n\t\t\t\t\tif (root) root.viewProp(this.id, 'x', x);\n\t\t\t\t}\n\t\t\t\tif (!_lodash2.default.isNull(y)) {\n\t\t\t\t\tthis._translate[1] = y;\n\t\t\t\t\tif (root) root.viewProp(this.id, 'y', y);\n\t\t\t\t}\n\t\t\t\tif (!_lodash2.default.isNull(scale)) {\n\t\t\t\t\tthis._scale = scale;\n\t\t\t\t\tif (root) root.viewProp(this.id, 'scale', scale);\n\t\t\t\t\t// sync the scale between the dispatcher and the graph\n\t\t\t\t\tvar s = this.dispatcher.scale;\n\t\t\t\t\tif (s != scale) this.dispatcher.scale = scale;\n\t\t\t\t}\n\t\t\t\tthis.refresh();\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"render\",\n\t\t\tvalue: function render() {\n\t\t\t\tif (!this._graph) return false;\n\t\t\t\tif (this.layout) this.layout.layout(this._graph.currentRoot, this.viewport());\n\t\n\t\t\t\tthis.initializeBehaviors();\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"renderLabel\",\n\t\t\tvalue: function renderLabel(box) {\n\t\t\t\treturn this.constructor.renderLabel(box);\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"renderLink\",\n\t\t\tvalue: function renderLink(shape) {\n\t\t\t\treturn this.constructor.renderLink(shape);\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"renderMarkers\",\n\t\t\tvalue: function renderMarkers(markers) {\n\t\t\t\treturn this.constructor.renderMarkers(markers);\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"initializeBehaviors\",\n\t\t\tvalue: function initializeBehaviors() {\n\t\t\t\t// create the event dispatcher if necessary.\n\t\t\t\tif (!this.dispatcher) {\n\t\t\t\t\tthis.dispatcher = new _EventDispatcher2.default(this.box, [this.prop('minZoom'), this.prop('maxZoom')]);\n\t\t\t\t\tvar jsClass = void 0;\n\t\t\t\t\tif (this.prop('graphBehavior')) {\n\t\t\t\t\t\tjsClass = _Utils2.default.getConstructor(this.prop('graphBehavior'));\n\t\t\t\t\t\tthis.graphBehavior = new jsClass(this);\n\t\t\t\t\t}\n\t\t\t\t\tif (this.prop('selectionBehavior')) {\n\t\t\t\t\t\tjsClass = _Utils2.default.getConstructor(this.prop('selectionBehavior'));\n\t\t\t\t\t\tthis.selectionBehavior = new jsClass(this);\n\t\t\t\t\t}\n\t\t\t\t\t/*this.dispatcher.register('mouseup.node.label', function(type, ns, target, pos, event) {\r\n\t    \tlet node = this._graph.nodes[target.getAttribute('id')];\r\n\t    \tif (!this.dispatcher.dragging && !node._firstSelection) {\r\n\t    \t\tLabel._delayEdit = _.delay(() => {\r\n\t    \t\t\tif (Label._delayEdit) {\r\n\t    \t\t\t\tdelete Label._delayEdit;\r\n\t    \t\t\t\tLabel.editor.start(node.id, this.box, node.getLabelBox(this.id), target, event.nsTarget, this.scale);\r\n\t    \t\t\t}\r\n\t    \t\t}, 250);\r\n\t    \t}\r\n\t    }, this);\r\n\t    this.dispatcher.register([/^mousedown/, /^zoom/], function(type, ns, target, pos, event) {\r\n\t    \tif (!DomUtils.eventFromInput(event)) {\r\n\t    \t\tLabel.editor.stop();\r\n\t    \t}\r\n\t    }, this);*/\n\t\t\t\t}\n\t\t\t\tthis.dispatcher.start();\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"refresh\",\n\t\t\tvalue: function refresh() {}\n\t\n\t\t\t/**\r\n\t   * Get the template for the specified key.\r\n\t   * @param key\r\n\t   * @param config if the template is a function, this config will be passed as the argument.\r\n\t   * @param preprocessor if the template contains preprossing elements, such as #{shape}, the preprocessor will be\r\n\t   * used to render them.\r\n\t   * @returns {*}\r\n\t   */\n\t\n\t\t}, {\n\t\t\tkey: \"getTemplate\",\n\t\t\tvalue: function getTemplate(key, config, preprocessor) {\n\t\t\t\tvar t = this.constructor.TEMPLATES[key];\n\t\t\t\tif (t && _lodash2.default.isFunction(t)) {\n\t\t\t\t\tt = t(config);\n\t\t\t\t}\n\t\t\t\t// check if there are any preprocessing tags.\n\t\t\t\tif (preprocessor) {\n\t\t\t\t\tvar parts = t.match(/(#{[^#]*})/g);\n\t\t\t\t\tvar obj = {};\n\t\t\t\t\tfor (var part in parts) {\n\t\t\t\t\t\tpart = parts[part];\n\t\t\t\t\t\tpart = part.substring(2, part.length - 1).trim();\n\t\t\t\t\t\tobj[part] = preprocessor[_lodash2.default.camelCase('render ' + part)](this);\n\t\t\t\t\t}\n\t\t\t\t\tt = _lodash2.default.template(t, { interpolate: /#{([\\s\\S]+?)}/g })(obj);\n\t\t\t\t}\n\t\t\t\treturn t;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"reset\",\n\t\t\tvalue: function reset() {}\n\t\t}, {\n\t\t\tkey: \"destroy\",\n\t\t\tvalue: function destroy() {\n\t\t\t\tdelete this._graph;\n\t\t\t\tdelete this.layout;\n\t\t\t\tif (this.dispatcher) {\n\t\t\t\t\tthis.dispatcher.stop();\n\t\t\t\t\tdelete this.dispatcher;\n\t\t\t\t}\n\t\t\t\tthis.box.innerHTML = '';\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"graph\",\n\t\t\tget: function get() {\n\t\t\t\treturn this._graph;\n\t\t\t},\n\t\t\tset: function set(graph) {\n\t\t\t\tthis._graph = graph;\n\t\t\t\tvar root = graph.currentRoot;\n\t\t\t\tif (root) {\n\t\t\t\t\tthis._translate = [root.viewProp(this.id, 'x') || 0, root.viewProp(this.id, 'y') || 0];\n\t\t\t\t\tthis._scale = root.viewProp(this.id, 'scale') || 1.0;\n\t\t\t\t}\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"translate\",\n\t\t\tget: function get() {\n\t\t\t\treturn this._translate;\n\t\t\t},\n\t\t\tset: function set(t) {\n\t\t\t\tthis.transform(t[0], t[1]);\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"scale\",\n\t\t\tget: function get() {\n\t\t\t\treturn this._scale;\n\t\t\t},\n\t\t\tset: function set(k) {\n\t\t\t\tswitch (k) {\n\t\t\t\t\tcase \"in\":\n\t\t\t\t\t\tk = this.scale * this.prop(\"zoomFactor\");\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase \"out\":\n\t\t\t\t\t\tk = this.scale / this.prop(\"zoomFactor\");\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase \"actual\":\n\t\t\t\t\t\tk = 1.0;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase \"fit\":\n\t\t\t\t\t\tvar gridSize = this.prop(\"gridSize\") * 2;\n\t\n\t\t\t\t\t\tvar gBounds = this.getBounds();\n\t\t\t\t\t\tvar vBounds = this.viewport();\n\t\n\t\t\t\t\t\tvBounds.width -= gridSize;\n\t\t\t\t\t\tvBounds.height -= gridSize;\n\t\n\t\t\t\t\t\t/* Do not zoom more than actual if graph already fits into the bounds */\n\t\t\t\t\t\tk = Math.min(vBounds.width / gBounds.width, vBounds.height / gBounds.height, 1.0);\n\t\n\t\t\t\t\t\t//TODO: Add centering code here or trigger an event for that\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tdefault:\n\t\t\t\t\t\tif (_lodash2.default.isString(k)) k = parseFloat(k);\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tthis.transform(null, null, k);\n\t\t\t}\n\t\t}]);\n\t\n\t\treturn Renderer;\n\t}();\n\t\n\tRenderer.DEFAULTS = {\n\t\tdefaultClickMode: \"pan\",\n\t\thideOutline: false,\n\t\tsingleSelect: true,\n\t\tdraggable: true,\n\t\tgridEnabled: false,\n\t\tguidesEnabled: true,\n\t\tgridSize: 30,\n\t\tmaxZoom: 4.0,\n\t\tminZoom: 0.2,\n\t\tzoomFactor: 1.2,\n\t\tmaskOpacity: 0.5,\n\t\tgraphBehavior: _GraphBehavior2.default,\n\t\tselectionBehavior: _SelectionBehavior2.default\n\t};\n\t\n\texports.default = Renderer;\n\n/***/ },\n/* 25 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t\tvalue: true\n\t});\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tvar _Behavior2 = __webpack_require__(26);\n\t\n\tvar _Behavior3 = _interopRequireDefault(_Behavior2);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\t\n\tfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; } /**\r\n\t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * Created by tong on 6/28/2016.\r\n\t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                */\n\t\n\t\n\t/**\r\n\t * Graph handler handles Panning and Zoom and rubber band selection\r\n\t */\n\tvar GraphBehavior = function (_Behavior) {\n\t\t_inherits(GraphBehavior, _Behavior);\n\t\n\t\tfunction GraphBehavior(renderer) {\n\t\t\t_classCallCheck(this, GraphBehavior);\n\t\n\t\t\tvar _this = _possibleConstructorReturn(this, (GraphBehavior.__proto__ || Object.getPrototypeOf(GraphBehavior)).call(this, renderer));\n\t\n\t\t\tvar dispatcher = renderer.dispatcher;\n\t\t\tvar f = function f(type, ns, graph, pos, event) {\n\t\t\t\t//Cursor.updateCursor(type, ns, graph, event);\n\t\t\t};\n\t\t\tdispatcher.register(/^drag.*\\.graph$/, _this.handleDrag, _this);\n\t\t\tdispatcher.register(/^zoom/, _this.handleZoom, _this);\n\t\t\t//dispatcher.register(['mousedown.graph', 'mouseenter.graph', 'mouseleave.graph'], f);\n\t\t\t_this.offset = null;\n\t\t\treturn _this;\n\t\t}\n\t\n\t\t_createClass(GraphBehavior, [{\n\t\t\tkey: \"handleZoom\",\n\t\t\tvalue: function handleZoom(type, ns, graph, pos, event) {\n\t\t\t\tthis.renderer.transform(null, null, event.scale);\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"handleDrag\",\n\t\t\tvalue: function handleDrag(type, ns, graph, pos, event) {\n\t\t\t\tif (type == 'dragstart') {\n\t\t\t\t\tvar pan = this.renderer.prop(\"defaultClickMode\") == \"pan\" ^ (event.ctrlKey || event.shiftKey);\n\t\t\t\t\tif (!pan) return;\n\t\t\t\t\tvar t = this.renderer.translate;\n\t\t\t\t\tthis.offset = [t[0] - pos[0], t[1] - pos[1]];\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tif (!this.offset) return;\n\t\t\t\tthis.renderer.transform(pos[0] + this.offset[0], pos[1] + this.offset[1]);\n\t\t\t\tif (type == 'dragend') {\n\t\t\t\t\t//Cursor.updateCursor('mouseup', ns, graph, event);\n\t\t\t\t\tdelete this.offset;\n\t\t\t\t}\n\t\t\t}\n\t\t}]);\n\t\n\t\treturn GraphBehavior;\n\t}(_Behavior3.default);\n\t\n\texports.default = GraphBehavior;\n\n/***/ },\n/* 26 */\n/***/ function(module, exports) {\n\n\t\"use strict\";\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t\tvalue: true\n\t});\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tvar Behavior = function () {\n\t\tfunction Behavior(renderer) {\n\t\t\t_classCallCheck(this, Behavior);\n\t\n\t\t\tthis.renderer = renderer;\n\t\t}\n\t\n\t\t_createClass(Behavior, [{\n\t\t\tkey: \"destroy\",\n\t\t\tvalue: function destroy() {\n\t\t\t\tdelete this.renderer;\n\t\t\t}\n\t\t}]);\n\t\n\t\treturn Behavior;\n\t}();\n\t\n\texports.default = Behavior;\n\n/***/ },\n/* 27 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t\tvalue: true\n\t});\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tvar _get = function get(object, property, receiver) { if (object === null) object = Function.prototype; var desc = Object.getOwnPropertyDescriptor(object, property); if (desc === undefined) { var parent = Object.getPrototypeOf(object); if (parent === null) { return undefined; } else { return get(parent, property, receiver); } } else if (\"value\" in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } };\n\t\n\tvar _Rectangle = __webpack_require__(4);\n\t\n\tvar _Rectangle2 = _interopRequireDefault(_Rectangle);\n\t\n\tvar _Cell = __webpack_require__(17);\n\t\n\tvar _Cell2 = _interopRequireDefault(_Cell);\n\t\n\tvar _Behavior2 = __webpack_require__(26);\n\t\n\tvar _Behavior3 = _interopRequireDefault(_Behavior2);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\t\n\tfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\t\n\tvar SelectionBehavior = function (_Behavior) {\n\t\t_inherits(SelectionBehavior, _Behavior);\n\t\n\t\tfunction SelectionBehavior(renderer) {\n\t\t\t_classCallCheck(this, SelectionBehavior);\n\t\n\t\t\tvar _this = _possibleConstructorReturn(this, (SelectionBehavior.__proto__ || Object.getPrototypeOf(SelectionBehavior)).call(this, renderer));\n\t\n\t\t\tvar dispatcher = renderer.dispatcher;\n\t\t\tdispatcher.register('mousedown.*', _this.selectCell, _this);\n\t\t\tdispatcher.register('mouseup.*', _this.unselectCell, _this);\n\t\t\tdispatcher.register('drag*.graph', _this.handleMultiSelect, _this);\n\t\t\t//graph.on(Graph.EVENT_TYPES.SELECTION_CHANGE, this.updateSelections, this);\n\t\t\t_this.selectedNodes = null;\n\t\t\t_this.selectedLinks = null;\n\t\t\t_this.attachedLinks = null;\n\t\t\treturn _this;\n\t\t}\n\t\n\t\t_createClass(SelectionBehavior, [{\n\t\t\tkey: \"updateSelections\",\n\t\t\tvalue: function updateSelections() {\n\t\t\t\tif (this.selectedNodes) this.selectedNodes.classed('selected', false);\n\t\t\t\tif (this.selectedLinks) this.selectedLinks.classed('selected', false);\n\t\n\t\t\t\tthis.selectedNodes = null;\n\t\t\t\tthis.selectedLinks = null;\n\t\t\t\tthis.attachedLinks = null;\n\t\n\t\t\t\tif (this.graph.selectedVertices && this.graph.selectedVertices.length > 0) {\n\t\t\t\t\tthis.selectedNodes = this.graph.renderer.getShapes(this.graph.selectedVertices);\n\t\t\t\t\tthis.attachedLinks = this.graph.renderer.getShapes(this.graph.getAttachedEdges());\n\t\t\t\t\tthis.selectedNodes.classed('selected', true);\n\t\t\t\t}\n\t\n\t\t\t\tif (this.graph.selectedEdges && this.graph.selectedEdges.length > 0) {\n\t\t\t\t\tthis.selectedLinks = this.graph.renderer.getShapes(this.graph.selectedEdges);\n\t\t\t\t\tthis.selectedLinks.classed('selected', true);\n\t\t\t\t}\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"selectCell\",\n\t\t\tvalue: function selectCell(type, ns, data, pos, event) {\n\t\t\t\tvar cell = data == this.graph ? null : data;\n\t\t\t\tif (cell && !(cell instanceof _Cell2.default)) return;\n\t\t\t\tvar toggle = event.ctrlKey || event.shiftKey;\n\t\t\t\tif (cell && cell instanceof _Cell2.default) {\n\t\t\t\t\tif (!this.graph.isSelected(cell)) delete cell._firstSelection;else cell._firstSelection = true;\n\t\n\t\t\t\t\td3.select(event.dataTarget).moveToFront();\n\t\t\t\t\tthis.graph.setSelection(cell, toggle);\n\t\t\t\t}\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"unselectCell\",\n\t\t\tvalue: function unselectCell(type, ns, data, pos, event) {\n\t\t\t\tvar cell = data == this.graph ? null : data;\n\t\t\t\tif (cell && !(cell instanceof _Cell2.default)) return;\n\t\t\t\tvar ctrlKey = event.ctrlKey || event.shiftKey;\n\t\t\t\tif (!cell) {\n\t\t\t\t\tthis.graph.setSelection(cell, ctrlKey);\n\t\t\t\t}\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"handleMultiSelect\",\n\t\t\tvalue: function handleMultiSelect(type, ns, data, pos, event) {\n\t\t\t\tpos = util.scale(this.graph, pos);\n\t\n\t\t\t\tif (type == 'dragstart') {\n\t\t\t\t\tvar select = this.graph.getProperty(\"defaultClickMode\") == \"select\" ^ (event.ctrlKey || event.shiftKey);\n\t\t\t\t\tif (!select) return;\n\t\t\t\t\tthis.startPt = new Point(pos[0], pos[1]);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tif (!this.startPt) return;\n\t\t\t\tvar rect = _Rectangle2.default.getBoundingRectangle([new Point(pos[0], pos[1]), this.startPt]);\n\t\t\t\tvar renderer = this.graph.renderer;\n\t\t\t\tif (!this.rubberband) {\n\t\t\t\t\tthis.rubberband = d3.select(renderer.appendNode(renderer.getCellLayer(), {\n\t\t\t\t\t\ttemplate: _.template('<g><rect x=\"0\" y=\"0\" width=\"100\" height=\"100\" stroke=\"#000000\" fill=\"none\" stroke-dasharray=\"3 3\"/></g>')\n\t\t\t\t\t}, false));\n\t\t\t\t}\n\t\t\t\tif (type == 'dragend') {\n\t\t\t\t\tvar cells = this.graph.getCurrentRoot().children;\n\t\t\t\t\t// TODO: Define if we want to select vertexes / edges or both\n\t\t\t\t\tcells = _.filter(cells, function (cell) {\n\t\t\t\t\t\tvar box = cell.getBounds();\n\t\t\t\t\t\tif (rect.contains(box)) {\n\t\t\t\t\t\t\treturn true;\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t});\n\t\t\t\t\t// TODO: Set selection\n\t\t\t\t\tthis.graph.setSelection(cells, event.ctrlKey);\n\t\n\t\t\t\t\tthis.rubberband.remove();\n\t\t\t\t\tdelete this.startPt;\n\t\t\t\t\tdelete this.rubberband;\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tthis.rubberband.select(\"rect\").attr({ x: rect.x, y: rect.y, width: rect.width, height: rect.height });\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"destroy\",\n\t\t\tvalue: function destroy() {\n\t\t\t\t_get(SelectionBehavior.prototype.__proto__ || Object.getPrototypeOf(SelectionBehavior.prototype), \"destroy\", this).call(this);\n\t\t\t\tdelete this.selectedNodes;\n\t\t\t\tdelete this.selectedLinks;\n\t\t\t\tdelete this.attachedLinks;\n\t\t\t}\n\t\t}]);\n\t\n\t\treturn SelectionBehavior;\n\t}(_Behavior3.default);\n\t\n\texports.default = SelectionBehavior;\n\n/***/ },\n/* 28 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t\tvalue: true\n\t});\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tvar _get = function get(object, property, receiver) { if (object === null) object = Function.prototype; var desc = Object.getOwnPropertyDescriptor(object, property); if (desc === undefined) { var parent = Object.getPrototypeOf(object); if (parent === null) { return undefined; } else { return get(parent, property, receiver); } } else if (\"value\" in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } };\n\t\n\tvar _lodash = __webpack_require__(5);\n\t\n\tvar _lodash2 = _interopRequireDefault(_lodash);\n\t\n\tvar _base = __webpack_require__(1);\n\t\n\tvar _base2 = _interopRequireDefault(_base);\n\t\n\tvar _DomUtils = __webpack_require__(7);\n\t\n\tvar _DomUtils2 = _interopRequireDefault(_DomUtils);\n\t\n\tvar _Renderer2 = __webpack_require__(24);\n\t\n\tvar _Renderer3 = _interopRequireDefault(_Renderer2);\n\t\n\tvar _StringBuffer = __webpack_require__(8);\n\t\n\tvar _StringBuffer2 = _interopRequireDefault(_StringBuffer);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\t\n\tfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\t\n\tvar NS = 'http://www.w3.org/2000/svg';\n\tif (typeof SVGElement != \"undefined\") {\n\t\tvar svg = document.createElementNS(NS, \"svg\");\n\t\tsvg.innerHTML = '<circle/>';\n\t\tif (svg.firstChild !== \"[object SVGCircleElement]\") {\n\t\t\tObject.defineProperties(SVGElement.prototype, {\n\t\t\t\t\"outerHTML\": {\n\t\t\t\t\tenumerable: false,\n\t\t\t\t\tconfigurable: true,\n\t\t\t\t\tget: function get() {\n\t\t\t\t\t\tvar $node, $temp;\n\t\t\t\t\t\t$temp = document.createElement('div');\n\t\t\t\t\t\t$node = this.cloneNode(true);\n\t\t\t\t\t\t$temp.appendChild($node);\n\t\t\t\t\t\treturn $temp.innerHTML;\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t\"innerHTML\": {\n\t\t\t\t\tenumerable: false,\n\t\t\t\t\tconfigurable: true,\n\t\t\t\t\tget: function get() {\n\t\t\t\t\t\tvar s = this.outerHTML;\n\t\t\t\t\t\tvar ropen = new RegExp(\"<\" + this.nodeName + '\\\\b(?:([\"\\'])[^\"]*?(\\\\1)|[^>])*>', \"i\");\n\t\t\t\t\t\tvar rclose = new RegExp(\"<\\/\" + this.nodeName + \">$\", \"i\");\n\t\t\t\t\t\treturn s.replace(ropen, \"\").replace(rclose, \"\");\n\t\t\t\t\t},\n\t\t\t\t\tset: function set(markup) {\n\t\t\t\t\t\t// empty el first.\n\t\t\t\t\t\tvar child = void 0;\n\t\t\t\t\t\twhile (child = this.lastChild) {\n\t\t\t\t\t\t\tthis.removeChild(child);\n\t\t\t\t\t\t}var buf = new _StringBuffer2.default();\n\t\t\t\t\t\tbuf.append('<svg>').append(markup).append('</svg');\n\t\t\t\t\t\tvar $temp = _DomUtils2.default.createElement('div', null, null, buf.toString()).firstElementChild;\n\t\t\t\t\t\twhile ($temp.firstChild) {\n\t\t\t\t\t\t\tthis.appendChild($temp.firstChild);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t\t// Define the toDataURL for SVG\n\t\tSVGElement.prototype.toDataURL = function (type) {\n\t\t\tvar options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n\t\n\t\t\tvar _svg = this;\n\t\n\t\t\tvar debug = function debug(msg) {};\n\t\n\t\t\tif (options['debug'] == true && typeof console != 'undefined') debug = function debug(msg) {\n\t\t\t\tconsole.log(\"SVG.toDataURL:\", msg);\n\t\t\t};\n\t\n\t\t\tfunction exportSVG() {\n\t\t\t\tvar svg_xml = _svg.outerHTML;\n\t\t\t\tvar svg_dataurl = base64dataURLencode(svg_xml);\n\t\t\t\tdebug(type + \" length: \" + svg_dataurl.length);\n\t\n\t\t\t\t// NOTE double data carrier\n\t\t\t\tif (options.callback) options.callback(svg_dataurl);\n\t\t\t\treturn svg_dataurl;\n\t\t\t}\n\t\n\t\t\tfunction base64dataURLencode(s) {\n\t\t\t\tvar b64 = \"data:image/svg+xml;base64,\";\n\t\n\t\t\t\t// https://developer.mozilla.org/en/DOM/window.btoa\n\t\t\t\tif (window.btoa) {\n\t\t\t\t\tdebug(\"using window.btoa for base64 encoding\");\n\t\t\t\t\tb64 += btoa(s);\n\t\t\t\t} else {\n\t\t\t\t\tdebug(\"using custom base64 encoder\");\n\t\t\t\t\tb64 += _base2.default.encode(s);\n\t\t\t\t}\n\t\n\t\t\t\treturn b64;\n\t\t\t}\n\t\n\t\t\t// Native export doesn't work very well. should use canvg instead.\n\t\t\tfunction exportImage(type) {\n\t\t\t\tvar canvas = document.createElement(\"canvas\");\n\t\t\t\tvar ctx = canvas.getContext('2d');\n\t\n\t\t\t\t// TODO: if (options.keepOutsideViewport), do some translation magic?\n\t\n\t\t\t\tvar svg_img = new Image();\n\t\t\t\tvar svg_xml = _svg.outerHTML;\n\t\t\t\tsvg_img.src = base64dataURLencode(svg_xml);\n\t\n\t\t\t\tsvg_img.onload = function () {\n\t\t\t\t\tdebug(\"exported image size: \" + [svg_img.width, svg_img.height]);\n\t\t\t\t\tcanvas.width = svg_img.width;\n\t\t\t\t\tcanvas.height = svg_img.height;\n\t\t\t\t\tctx.drawImage(svg_img, 0, 0);\n\t\n\t\t\t\t\t// SECURITY_ERR WILL HAPPEN NOW\n\t\t\t\t\tvar image_dataurl = canvas.toDataURL(type);\n\t\t\t\t\tdebug(type + \" length: \" + image_dataurl.length);\n\t\n\t\t\t\t\tif (options.callback) options.callback(image_dataurl);else debug(\"WARNING: no callback set, so nothing happens.\");\n\t\t\t\t};\n\t\n\t\t\t\tsvg_img.onerror = function () {\n\t\t\t\t\tdebug(\"Can't export! Maybe your browser doesn't support \" + \"SVG in img element or SVG input for Canvas drawImage?\\n\" + \"http://en.wikipedia.org/wiki/SVG#Native_support\");\n\t\t\t\t};\n\t\n\t\t\t\t// NOTE: will not return anything\n\t\t\t}\n\t\n\t\t\tfunction exportImageCanvg(type) {\n\t\t\t\tif (!canvg) return null;\n\t\t\t\tvar canvas = _DomUtils2.default.createElement('canvas', null, { display: \"none\" });\n\t\t\t\tdocument.body.appendChild(canvas);\n\t\t\t\tif (type == 'javascript') {\n\t\t\t\t\tvar xcanvas = new jsCanvas('jscanvastest');\n\t\t\t\t\txcanvas.canvas.style.display = 'none';\n\t\t\t\t\t//xcanvas.canvas = canvas;\n\t\t\t\t}\n\t\n\t\t\t\tif (!options.keepOutsideViewport) {\n\t\t\t\t\tcanvg(canvas, _svg.outerHTML);\n\t\t\t\t} else {\n\t\t\t\t\tvar padding = options.padding || 0;\n\t\t\t\t\tvar scale = 1.0;\n\t\t\t\t\tvar translate = [0, 0];\n\t\t\t\t\tvar bbox = _svg.getBBox();\n\t\t\t\t\tdebug(\"detected svg dimensions \" + [bbox.x, bbox.y, bbox.width, bbox.height]);\n\t\t\t\t\tvar transform = _svg.firstElementChild.getAttribute('transform');\n\t\t\t\t\tif (transform) {\n\t\t\t\t\t\tdebug('detected svg transform ' + transform);\n\t\t\t\t\t\ttransform = SVGRenderer.transform(transform);\n\t\t\t\t\t\ttranslate = transform.translate;\n\t\t\t\t\t\tscale = transform.scale;\n\t\t\t\t\t}\n\t\t\t\t\tvar buf = new _StringBuffer2.default();\n\t\t\t\t\tbuf.append('<svg width=\"').append(bbox.width + 2 * padding).append('px\" height=\"').append(bbox.height + 2 * padding).append('px\"><g transform=\"translate(').append(-bbox.x + translate[0] + padding).append(',').append(-bbox.y + translate[1] + padding).append(')scale(').append(scale).append(')\">').append(_svg.firstElementChild.innerHTML).append('</g></svg>');\n\t\t\t\t\tif (type == 'javascript') {\n\t\t\t\t\t\txcanvas.compile(buf.toString(), function () {\n\t\t\t\t\t\t\tif (options.callback) options.callback(xcanvas.toString());\n\t\t\t\t\t\t});\n\t\t\t\t\t\treturn;\n\t\t\t\t\t} else canvg(canvas, buf.toString());\n\t\t\t\t}\n\t\t\t\tvar image_dataurl = canvas.toDataURL(type);\n\t\t\t\tif (options.callback) options.callback(image_dataurl);\n\t\t\t\tcanvas.parentNode.removeChild(canvas);\n\t\t\t\treturn image_dataurl;\n\t\t\t}\n\t\n\t\t\tif (!type) type = \"image/svg+xml\";\n\t\n\t\t\tif (options.keepNonSafe) debug(\"NOTE: keepNonSafe is NOT supported and will be ignored!\");\n\t\t\tif (options.keepOutsideViewport) debug(\"NOTE: keepOutsideViewport is only supported with canvg exporter.\");\n\t\n\t\t\tswitch (type) {\n\t\t\t\tcase \"image/svg+xml\":\n\t\t\t\t\treturn exportSVG();\n\t\t\t\tcase \"image/png\":\n\t\t\t\tcase \"image/jpeg\":\n\t\t\t\tcase \"javascript\":\n\t\t\t\t\tif (!options.renderer) {\n\t\t\t\t\t\tif (window.canvg) options.renderer = \"canvg\";else options.renderer = \"native\";\n\t\t\t\t\t}\n\t\t\t\t\tswitch (options.renderer) {\n\t\t\t\t\t\tcase \"canvg\":\n\t\t\t\t\t\t\tdebug(\"using canvg renderer for \" + type + \" image export\");\n\t\t\t\t\t\t\treturn exportImageCanvg(type);\n\t\t\t\t\t\tcase \"native\":\n\t\t\t\t\t\t\tdebug(\"using native renderer for \" + type + \" export. THIS MIGHT FAIL.\");\n\t\t\t\t\t\t\treturn exportImage(type);\n\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\tdebug(\"unknown image renderer given, doing noting (\" + options.renderer + \")\");\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\tdebug(\"Sorry! Exporting as '\" + type + \"' is not supported!\");\n\t\t\t}\n\t\t\treturn null;\n\t\t};\n\t}\n\t\n\tvar SVGRenderer = function (_Renderer) {\n\t\t_inherits(SVGRenderer, _Renderer);\n\t\n\t\tfunction SVGRenderer() {\n\t\t\t_classCallCheck(this, SVGRenderer);\n\t\n\t\t\treturn _possibleConstructorReturn(this, (SVGRenderer.__proto__ || Object.getPrototypeOf(SVGRenderer)).apply(this, arguments));\n\t\t}\n\t\n\t\t_createClass(SVGRenderer, [{\n\t\t\tkey: \"render\",\n\t\t\tvalue: function render() {\n\t\t\t\tvar result = _get(SVGRenderer.prototype.__proto__ || Object.getPrototypeOf(SVGRenderer.prototype), \"render\", this).call(this);\n\t\t\t\tif (result) {\n\t\t\t\t\tvar root = this.graph.currentRoot;\n\t\t\t\t\tvar buf = new _StringBuffer2.default('<svg width=\"100%\" height=\"100%\" xmlns=\"http://www.w3.org/2000/svg\">');\n\t\t\t\t\tvar t = this.translate;\n\t\t\t\t\tbuf.append('<g transform=\"translate(').append(t[0]).append(',').append(t[1]).append(')scale(').append(this.scale).append(')\">');\n\t\t\t\t\tbuf.append(this.renderDefs());\n\t\t\t\t\tbuf.append(root.render(this));\n\t\t\t\t\tbuf.append('</g></svg>');\n\t\t\t\t\tthis.box.innerHTML = buf.toString();\n\t\t\t\t\tthis.svg = this.box.firstElementChild;\n\t\t\t\t}\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"renderDefs\",\n\t\t\tvalue: function renderDefs() {\n\t\t\t\tvar buf = new _StringBuffer2.default('<defs>');\n\t\t\t\tbuf.append(this.getTemplate('Grid', this.prop(\"gridSize\")));\n\t\t\t\tvar markers = this.graph.markers;\n\t\t\t\tif (markers.length > 0) buf.append(SVGRenderer.renderMarkers(markers));\n\t\t\t\tbuf.append('</defs>');\n\t\t\t\treturn buf.toString();\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"refresh\",\n\t\t\tvalue: function refresh() {\n\t\t\t\tif (!this.svg) return;\n\t\t\t\tvar g = this.svg.querySelector('g');\n\t\t\t\tvar t = this.translate;\n\t\t\t\tg.setAttribute('transform', 'translate(' + t[0] + ',' + t[1] + ')scale(' + this.scale + ')');\n\t\t\t}\n\t\t}], [{\n\t\t\tkey: \"renderMarkers\",\n\t\t\tvalue: function renderMarkers(markers) {\n\t\t\t\tvar buf = new _StringBuffer2.default(),\n\t\t\t\t    str1 = void 0,\n\t\t\t\t    str2 = void 0;\n\t\t\t\tmarkers.forEach(function (marker) {\n\t\t\t\t\tstr1 = this.TEMPLATES['Marker'](marker);\n\t\t\t\t\tstr2 = marker.shape;\n\t\t\t\t\tif (!_lodash2.default.isString(str2)) str2 = this.renderShape(str2);\n\t\t\t\t\tstr1 = str1.replace(/\\#\\{shape\\}/, str2);\n\t\t\t\t\tbuf.append(str1);\n\t\t\t\t}, this);\n\t\t\t\treturn buf.toString();\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"renderLabel\",\n\t\t\tvalue: function renderLabel(box) {\n\t\t\t\treturn this.TEMPLATES['Label'](box);\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"renderShape\",\n\t\t\tvalue: function renderShape(shape) {\n\t\t\t\tvar template = this.TEMPLATES[shape.name];\n\t\t\t\tif (_lodash2.default.isString(template)) template = _lodash2.default.template(template);\n\t\t\t\treturn template(shape);\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"getPathData\",\n\t\t\tvalue: function getPathData(shape) {\n\t\t\t\tvar points = shape.points;\n\t\t\t\tvar controlPts = shape.controlPts;\n\t\t\t\tif (!points || points.length == 0) return '';\n\t\n\t\t\t\tif (!controlPts && shape.round) {\n\t\t\t\t\t// render rounded line joins.\n\t\t\t\t\tvar newPts = [];\n\t\t\t\t\tcontrolPts = [];\n\t\t\t\t\tvar prev = points[0],\n\t\t\t\t\t    next = void 0,\n\t\t\t\t\t    d1 = void 0,\n\t\t\t\t\t    d2 = void 0,\n\t\t\t\t\t    corner = void 0;\n\t\t\t\t\tnewPts.push(prev);\n\t\t\t\t\tfor (var i = 1; i < points.length - 1; i++) {\n\t\t\t\t\t\tnext = points[i];\n\t\t\t\t\t\t// set the control point first.\n\t\t\t\t\t\tcontrolPts[2 * i] = [next, next];\n\t\t\t\t\t\t// check the size of the corner.\n\t\t\t\t\t\td1 = prev.distance(next);\n\t\t\t\t\t\td2 = next.distance(points[i + 1]);\n\t\t\t\t\t\tcorner = Math.min(shape.round, d1 / 2, d2 / 2);\n\t\t\t\t\t\t// split the point into two.\n\t\t\t\t\t\tnewPts.push(next.getDirection(prev).scale(corner).translate(next));\n\t\t\t\t\t\tnewPts.push(next.getDirection(points[i + 1]).scale(corner).translate(next));\n\t\t\t\t\t\tprev = next;\n\t\t\t\t\t}\n\t\t\t\t\tnewPts.push(points[points.length - 1]);\n\t\t\t\t\tpoints = newPts;\n\t\t\t\t}\n\t\t\t\tvar buf = new _StringBuffer2.default('M'),\n\t\t\t\t    point = void 0;\n\t\t\t\tfor (var _i = 0; _i < points.length; _i++) {\n\t\t\t\t\tpoint = points[_i];\n\t\t\t\t\tif (_i == 0) buf.append(point);else {\n\t\t\t\t\t\tif (controlPts && controlPts[_i]) {\n\t\t\t\t\t\t\tbuf.append(' C ');\n\t\t\t\t\t\t\tfor (var j = 0; j < controlPts[_i].length; j++) {\n\t\t\t\t\t\t\t\tbuf.append(controlPts[_i][j]).append(' ');\n\t\t\t\t\t\t\t}buf.append(point);\n\t\t\t\t\t\t} else buf.append(' L ').append(point);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn buf.toString();\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"renderLink\",\n\t\t\tvalue: function renderLink(shape) {\n\t\t\t\tvar buf = new _StringBuffer2.default();\n\t\t\t\tvar d = SVGRenderer.getPathData(shape);\n\t\t\t\tif (shape.showGauge) buf.append('<path style=\"stroke: white; stroke-width: 9; visibility: hidden; pointer-events: stroke;\" d=\"').append(d).append('\"/>');\n\t\t\t\tbuf.append('<path d=\"').append(d).append('\"');\n\t\t\t\tif (shape.startMarker || shape.endMarker) {\n\t\t\t\t\tbuf.append(' style=\"');\n\t\t\t\t\tif (shape.startMarker) buf.append('marker-start: url(#').append(_lodash2.default.isString(shape.startMarker) ? shape.startMarker : shape.startMarker.id).append(');');\n\t\t\t\t\tif (shape.endMarker) buf.append('marker-end: url(#').append(_lodash2.default.isString(shape.endMarker) ? shape.endMarker : shape.endMarker.id).append(');');\n\t\t\t\t\tbuf.append('\"');\n\t\t\t\t}\n\t\t\t\tbuf.append('/>');\n\t\t\t\treturn buf.toString();\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"appendContent\",\n\t\t\tvalue: function appendContent(el, content) {\n\t\t\t\tvar buf = new _StringBuffer2.default();\n\t\t\t\tbuf.append('<svg>').append(content).append('</svg');\n\t\t\t\tvar temp = _DomUtils2.default.createElement('div', null, null, buf.toString()).firstElementChild;\n\t\n\t\t\t\twhile (temp.firstChild) {\n\t\t\t\t\tel.appendChild(temp.firstChild);\n\t\t\t\t}return el;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"transform\",\n\t\t\tvalue: function transform(_transform) {\n\t\t\t\tvar translate = [0, 0],\n\t\t\t\t    scale = 1.0;\n\t\t\t\t//\n\t\t\t\tvar parts = _transform.match(/translate\\(\\s*([^)]+)/);\n\t\t\t\tif (parts) {\n\t\t\t\t\tvar m = parts[1].trim().match(/([\\d.-]+)[ ,]([\\d.-]+)/);\n\t\t\t\t\tif (m) {\n\t\t\t\t\t\ttranslate[0] = parseFloat(m[1]) || 0;\n\t\t\t\t\t\ttranslate[1] = parseFloat(m[2]) || 0;\n\t\t\t\t\t} else translate[0] = translate[1] = parseFloat(parts[1]);\n\t\t\t\t}\n\t\t\t\tparts = _transform.match(/scale\\(\\s*([^)]+)/);\n\t\t\t\tif (parts) scale = parseFloat(parts[1]) || 1.0;\n\t\n\t\t\t\treturn { translate: translate, scale: scale };\n\t\t\t}\n\t\t}]);\n\t\n\t\treturn SVGRenderer;\n\t}(_Renderer3.default);\n\t\n\tSVGRenderer.TEMPLATES = {\n\t\t$root: '<g id=\"${id}\" class=\"${className}\">#{children}</g>',\n\t\t$node: '<g id=\"${id}\" class=\"${className}\" style=\"${style}\" ns=\"${namespace}\" transform=\"translate(${x},${y})\">#{shape}#{label}</g>',\n\t\t$edge: '<g id=\"${id}\" class=\"${className}\" style=\"${style}\" ns=\"${namespace}\">#{shape}#{label}</g>',\n\t\tEllipse: '<ellipse cx=\"0\" cy=\"0\" rx=\"${width/2}\" ry=\"${height/2}\"/>',\n\t\tRectangle: '<rect x=\"${-width/2}\" y=\"${-height/2}\" width=\"${width}\" height=\"${height}\" rx=\"9\" ry=\"9\"/>',\n\t\tTriangle: '<polygon points=\"${-width/2},${-height/2} ${width/2},${-height/2} 0,${height/2}\"/>',\n\t\tRhombus: '<polygon points=\"0,${-height/2} ${width/2},0 0,${height/2} ${-width/2},0\"/>',\n\t\tHexagon: function Hexagon(config) {\n\t\t\tvar vertical = config.direction == 'north' || config.direction == 'south';\n\t\t\tif (vertical) return '<polygon points=\"0,${-height/2} ${width/2},${-height/4} ${width/2},${height/4} 0,${height/2} ${-width/2},${height/4} ${-width/2},${-height/4}\"/>';else return '<polygon points=\"${-width/2},0 ${width/4},${-height/2} ${width/4},${-height/2} ${width/2},0 ${width/4},${height/2} ${-width/4},${height/2}\"/>';\n\t\t},\n\t\tPolygon: function Polygon(shape) {\n\t\t\tvar buf = new _StringBuffer2.default('<polygon points=\"');\n\t\t\tshape.points.forEach(function (pt) {\n\t\t\t\tbuf.append(pt[0]).append(',').append(pt[1]).append(' ');\n\t\t\t});\n\t\t\tbuf.removeLast();\n\t\t\tbuf.append('\"/>');\n\t\t\treturn buf.toString();\n\t\t},\n\t\tImage: function Image(config) {\n\t\t\treturn '<image x=\"${-width/2}\" y=\"${-height/2}\" width=\"${width}\" height=\"${height}\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" xlink:href=\"' + config.image + '\"/>';\n\t\t},\n\t\tMarker: function Marker(marker) {\n\t\t\treturn (\"\\n<marker id=\\\"\" + marker.id + \"\\\" markerWidth=\\\"\" + marker.size + \"\\\" markerHeight=\\\"\" + marker.size + \"\\\" refx=\\\"\" + marker.ref[0] + \"\\\" \\nrefy=\\\"\" + marker.ref[1] + \"\\\" orient=\\\"auto\\\" viewbox=\\\"\" + marker.viewBox.x + \" \" + marker.viewBox.y + \" \" + marker.viewBox.width + \" \" + marker.viewBox.height + \"\\\"\\nmarkerUnits=\\\"userSpaceOnUse\\\" \" + (marker.fill ? \"style=\\\"stroke: \" + marker.fill + \";fill:\" + marker.fill + \"\\\"\" : '') + \">#{shape}</marker>\\n\").trim();\n\t\t},\n\t\tGrid: function Grid(size) {\n\t\t\treturn (\"\\n<pattern id=\\\"GridPattern\\\" width=\\\"\" + size + \"\\\" height=\\\"\" + size + \"\\\" patternUnits=\\\"userSpaceOnUse\\\">\\n\\t<ellipse cx=\\\"0\\\" cy=\\\"0\\\" rx=\\\"1\\\" ry=\\\"1\\\" fill=\\\"#999999\\\"/>\\n\\t<ellipse cx=\\\"0\\\" cy=\\\"\" + size + \"\\\" rx=\\\"1\\\" ry=\\\"1\\\" fill=\\\"#999999\\\"/>\\n\\t<ellipse cx=\\\"\" + size + \"\\\" cy=\\\"0\\\" rx=\\\"1\\\" ry=\\\"1\\\" fill=\\\"#999999\\\"/>\\n\\t<ellipse cx=\\\"\" + size + \"\\\" cy=\\\"\" + size + \"\\\" rx=\\\"1\\\" ry=\\\"1\\\" fill=\\\"#999999\\\"/>\\n</pattern>\").trim();\n\t\t},\n\t\tLabel: _lodash2.default.template(\"\\n<% var box = _.has(data, \\\"dx\\\") ? data : (data.getLabelBox ? data.getLabelBox() : null); \\n   if (box) {%>\\n\\t<g <% if (box.config && box.config.class) {%>class=\\\"<%=box.config.class%>\\\"<%}%>\\t\\t<% if (box.config && box.config.ns) {%>ns=\\\"<%=box.config.ns%>\\\"<%}%>\\t\\t<% if (box.config && box.config.inlineStyle) {%>\\t\\t\\tfont-size=\\\"<%=box.config.fontSize%>\\\"\\t\\t\\tfont-family=\\\"<%=box.config.fontFamily%>\\\"\\t\\t\\tfont-weight=\\\"<% if (box.bold) {%>bold<%} else {%>normal<%}%>\\\"\\t\\t\\t<% if (box.underline) {%>text-decoration=\\\"underline\\\"<%}%>\\t\\t\\t<% if (box.italic) {%>font-style=\\\"italic\\\"<%}%>\\t\\t<%}%>\\t\\ttext-anchor=\\\"<%=box.anchor%>\\\"\\t\\ttransform=\\\"translate(<%=box.bounds.x%>,<%=box.bounds.y%>)<% if (box.config && box.config.rotation) {%>rotate(<%=box.config.rotation%> <%=box.pivot[0]%> <%=box.pivot[1]%>)<%}%>\\\">\\n\\t<% if (box.config.backgroundStyle) {%>\\n\\t\\t<rect x=\\\"<%=-box.bounds.width/2%>\\\" y=\\\"<%=-box.bounds.height/2%>\\\" width=\\\"<%=box.bounds.width%>\\\" height=\\\"<%=box.bounds.height%>\\\" style=\\\"<%=box.config.backgroundStyle%>\\\"/>\\n\\t<% } if (_.isArray(box.label)) { \\n\\t\\t_.each(box.label, function(value, line) {%>\\n\\t\\t\\t<text <% if (box.config && box.config.textStyle) {%>style=\\\"<%=box.config.textStyle%>\\\"<%}%>\\t\\t\\t\\tdx=\\\"<%=box.dx%>\\\" dy=\\\"<%=box.dy + box.lineHeight * line%>\\\"><%=value%></text>\\n\\t\\t<%});} else { %>\\n\\t\\t\\t<text><%=box.label%></text>\\n\\t\\t<%}%>\\n\\t\\t<% if (box.config.title) {%>\\n\\t\\t\\t<title><%=box.config.title%></title>\\n\\t\\t<%}%>\\n\\t</g>\\n<%}%>\\n\".trim(), { variable: \"data\" }) //TODO add more inline text styles.\n\t};\n\t\n\texports.default = SVGRenderer;\n\n/***/ }\n/******/ ])\n});\n;\n"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n/** WEBPACK FOOTER **\n ** webpack/bootstrap 541429943e0b8e6ecc8f\n **/","import Base64 from \"./util/base64\";\r\nimport Cache from \"./util/Utils\";\r\nimport Utils from \"./util/Utils\";\r\nimport DomUtils from \"./util/DomUtils\";\r\nimport StringBuffer from \"./util/StringBuffer\";\r\nimport Point from \"./geometry/Point\";\r\nimport Line from \"./geometry/Line\";\r\nimport Shape from \"./geometry/Shape\";\r\nimport Rectangle from \"./geometry/Rectangle\";\r\nimport Ellipse from \"./geometry/Ellipse\";\r\nimport Link from \"./geometry/Link\";\r\nimport Events from \"bean\";\r\nimport EventDispatcher from \"./event/EventDispatcher\";\r\nimport Graph from \"./graph/Graph\";\r\nimport Cell from \"./graph/Cell\";\r\nimport Node from \"./graph/Node\";\r\nimport Edge from \"./graph/Edge\";\r\nimport Layout from \"./layout/Layout\";\r\nimport FlowLayout from \"./layout/FlowLayout\";\r\nimport Label from \"./view/Label\";\r\nimport Marker from \"./view/Marker\";\r\nimport Renderer from \"./view/Renderer\";\r\nimport SVGRenderer from \"./view/SVGRenderer\";\r\nimport GraphBehavior from \"./behavior/GraphBehavior\";\r\nimport SelectionBehavior from \"./behavior/SelectionBehavior\";\r\n\r\nShape.addShape(\"Rectangle\", Rectangle);\r\nShape.addShape(\"Ellipse\", Ellipse);\r\n\r\nexport default {\r\n\tEvents,\r\n\tBase64,\r\n\tCache,\r\n\tUtils,\r\n\tDomUtils,\r\n\tStringBuffer,\r\n\tPoint,\r\n\tLine,\r\n\tShape,\r\n\tRectangle,\r\n\tEllipse,\r\n\tLink,\r\n\tEventDispatcher,\r\n\tLabel,\r\n\tMarker,\r\n\tGraph,\r\n\tCell,\r\n\tNode,\r\n\tEdge,\r\n\tLayout,\r\n\tFlowLayout,\r\n\tRenderer,\r\n\tSVGRenderer,\r\n\tGraphBehavior,\r\n\tSelectionBehavior\r\n};\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/index.js\n **/","// http://www.webtoolkit.info/javascript-base64.html\r\n\r\nvar Base64 = {\r\n\r\n\t// private property\r\n\t_keyStr : \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=\",\r\n\r\n\t// public method for encoding\r\n\tencode : function (input) {\r\n\t\tvar output = \"\";\r\n\t\tvar chr1, chr2, chr3, enc1, enc2, enc3, enc4;\r\n\t\tvar i = 0;\r\n\r\n\t\tinput = Base64._utf8_encode(input);\r\n\r\n\t\twhile (i < input.length) {\r\n\r\n\t\t\tchr1 = input.charCodeAt(i++);\r\n\t\t\tchr2 = input.charCodeAt(i++);\r\n\t\t\tchr3 = input.charCodeAt(i++);\r\n\r\n\t\t\tenc1 = chr1 >> 2;\r\n\t\t\tenc2 = ((chr1 & 3) << 4) | (chr2 >> 4);\r\n\t\t\tenc3 = ((chr2 & 15) << 2) | (chr3 >> 6);\r\n\t\t\tenc4 = chr3 & 63;\r\n\r\n\t\t\tif (isNaN(chr2)) {\r\n\t\t\t\tenc3 = enc4 = 64;\r\n\t\t\t} else if (isNaN(chr3)) {\r\n\t\t\t\tenc4 = 64;\r\n\t\t\t}\r\n\r\n\t\t\toutput = output +\r\n\t\t\tthis._keyStr.charAt(enc1) + this._keyStr.charAt(enc2) +\r\n\t\t\tthis._keyStr.charAt(enc3) + this._keyStr.charAt(enc4);\r\n\r\n\t\t}\r\n\r\n\t\treturn output;\r\n\t},\r\n\r\n\t// public method for decoding\r\n\tdecode : function (input) {\r\n\t\tvar output = \"\";\r\n\t\tvar chr1, chr2, chr3;\r\n\t\tvar enc1, enc2, enc3, enc4;\r\n\t\tvar i = 0;\r\n\r\n\t\tinput = input.replace(/[^A-Za-z0-9\\+\\/\\=]/g, \"\");\r\n\r\n\t\twhile (i < input.length) {\r\n\r\n\t\t\tenc1 = this._keyStr.indexOf(input.charAt(i++));\r\n\t\t\tenc2 = this._keyStr.indexOf(input.charAt(i++));\r\n\t\t\tenc3 = this._keyStr.indexOf(input.charAt(i++));\r\n\t\t\tenc4 = this._keyStr.indexOf(input.charAt(i++));\r\n\r\n\t\t\tchr1 = (enc1 << 2) | (enc2 >> 4);\r\n\t\t\tchr2 = ((enc2 & 15) << 4) | (enc3 >> 2);\r\n\t\t\tchr3 = ((enc3 & 3) << 6) | enc4;\r\n\r\n\t\t\toutput = output + String.fromCharCode(chr1);\r\n\r\n\t\t\tif (enc3 != 64) {\r\n\t\t\t\toutput = output + String.fromCharCode(chr2);\r\n\t\t\t}\r\n\t\t\tif (enc4 != 64) {\r\n\t\t\t\toutput = output + String.fromCharCode(chr3);\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\toutput = Base64._utf8_decode(output);\r\n\r\n\t\treturn output;\r\n\r\n\t},\r\n\r\n\t// private method for UTF-8 encoding\r\n\t_utf8_encode : function (string) {\r\n\t\tstring = string.replace(/\\r\\n/g,\"\\n\");\r\n\t\tvar utftext = \"\";\r\n\r\n\t\tfor (var n = 0; n < string.length; n++) {\r\n\r\n\t\t\tvar c = string.charCodeAt(n);\r\n\r\n\t\t\tif (c < 128) {\r\n\t\t\t\tutftext += String.fromCharCode(c);\r\n\t\t\t}\r\n\t\t\telse if((c > 127) && (c < 2048)) {\r\n\t\t\t\tutftext += String.fromCharCode((c >> 6) | 192);\r\n\t\t\t\tutftext += String.fromCharCode((c & 63) | 128);\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tutftext += String.fromCharCode((c >> 12) | 224);\r\n\t\t\t\tutftext += String.fromCharCode(((c >> 6) & 63) | 128);\r\n\t\t\t\tutftext += String.fromCharCode((c & 63) | 128);\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\treturn utftext;\r\n\t},\r\n\r\n\t// private method for UTF-8 decoding\r\n\t_utf8_decode : function (utftext) {\r\n\t\tvar string = \"\";\r\n\t\tvar i = 0;\r\n\t\tvar c = c1 = c2 = 0;\r\n\r\n\t\twhile ( i < utftext.length ) {\r\n\r\n\t\t\tc = utftext.charCodeAt(i);\r\n\r\n\t\t\tif (c < 128) {\r\n\t\t\t\tstring += String.fromCharCode(c);\r\n\t\t\t\ti++;\r\n\t\t\t}\r\n\t\t\telse if((c > 191) && (c < 224)) {\r\n\t\t\t\tc2 = utftext.charCodeAt(i+1);\r\n\t\t\t\tstring += String.fromCharCode(((c & 31) << 6) | (c2 & 63));\r\n\t\t\t\ti += 2;\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tc2 = utftext.charCodeAt(i+1);\r\n\t\t\t\tc3 = utftext.charCodeAt(i+2);\r\n\t\t\t\tstring += String.fromCharCode(((c & 15) << 12) | ((c2 & 63) << 6) | (c3 & 63));\r\n\t\t\t\ti += 3;\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\treturn string;\r\n\t}\r\n\r\n};\r\n\r\nexport default Base64;\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/util/base64.js\n **/","import Point from \"../geometry/Point\";\r\nimport Rectangle from \"../geometry/Rectangle\";\r\n\r\n// bean requires the existence of window\r\nif (typeof window === 'undefined' && typeof global !== 'undefined') {\r\n\tglobal.window = { addEventHandler: function() {} };\r\n\tglobal.document = {};\r\n\tglobal.navigator = {};\r\n}\r\n\r\n// util variables\r\nlet _debugging = [], _debugAll = false, typeRegistry = {}, splice = Array.splice;\r\n\r\n/**\r\n * Utility functions\r\n */\r\nexport default {\r\n\ttype: function (namespace, name, type) {\r\n\t\tif (!typeRegistry[namespace])\r\n\t\t\ttypeRegistry[namespace] = new Map();\r\n\t\tif (!name)\r\n\t\t\treturn typeRegistry[namespace];\r\n\t\tif (!type)\r\n\t\t\treturn typeRegistry[namespace].get(name);\r\n\t\ttypeRegistry[namespace].set(name, type);\r\n\t},\r\n\r\n\tcreateType: function (namespace, props, defaultType) {\r\n\t\tlet name = props.name;\r\n\r\n\t\t// first check if type exists\r\n\t\tlet type = this.type(namespace, name);\r\n\t\tif (!type) {\r\n\t\t\tlet extend = props.extends ? this.type(namespace, props.extends) : null;\r\n\t\t\tif (!extend && defaultType)\r\n\t\t\t\textend = defaultType;\r\n\t\t\tif (extend)\r\n\t\t\t\ttype = class extends extend {\r\n\t\t\t\t};\r\n\t\t\telse {\r\n\t\t\t\ttype = class {\r\n\t\t\t\t\tconstructor(config) {\r\n\t\t\t\t\t\t_.assign(this, config);\r\n\t\t\t\t\t}\r\n\t\t\t\t};\r\n\t\t\t}\r\n\t\t\tdelete props.name;\r\n\t\t\tdelete props.extends;\r\n\t\t\t_.assign(type.prototype, props);\r\n\t\t\ttype.typeName = name;\r\n\t\t\tthis.type(namespace, name, type);\r\n\t\t\tthis.log('Utils', 'Utils.createType - ' + namespace + '.' + name);\r\n\t\t}\r\n\t\treturn type;\r\n\t},\r\n\r\n\tbuildTypes: function (types, namespace, defaultType) {\r\n\t\tthis.log('Utils', 'Utils.buildTypes - ' + namespace);\r\n\r\n\t\tif (!types && defaultType) {\r\n\t\t\tthis.createType(namespace, defaultType);\r\n\t\t\tthis.log('Utils', 'Utils.buildTypes end');\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tif (defaultType) {\r\n\t\t\tlet type = _.remove(types, {name: defaultType.name});\r\n\t\t\ttype = type.length > 0 ? type[0] : null;\r\n\t\t\tif (type)\r\n\t\t\t\tdefaultType = this.createType(namespace, _.defaultsDeep(type, defaultType));\r\n\t\t\telse\r\n\t\t\t\tdefaultType = this.createType(namespace, defaultType);\r\n\t\t}\r\n\r\n\t\t_.forEach(types, (type) => {\r\n\t\t\tthis.createType(namespace, type, defaultType);\r\n\t\t});\r\n\t\tthis.log('Utils', 'Utils.buildTypes end');\r\n\t},\r\n\r\n\t// Helper function to correctly set up the prototype chain, for subclasses.\r\n\t// Similar to `goog.inherits`, but uses a hash of prototype properties and\r\n\t// class properties to be extended.\r\n\textend: function (child, parent, protoProps, staticProps) {\r\n\t\t// Add static properties to the constructor function, if supplied.\r\n\t\t_.extend(child, parent, staticProps);\r\n\r\n\t\t// Set the prototype chain to inherit from `parent`, without calling\r\n\t\t// `parent`'s constructor function.\r\n\t\tvar Surrogate = function () {\r\n\t\t\tthis.constructor = child;\r\n\t\t};\r\n\t\tSurrogate.prototype = parent.prototype;\r\n\t\tchild.prototype = new Surrogate;\r\n\r\n\t\t// Add prototype properties (instance properties) to the subclass,\r\n\t\t// if supplied.\r\n\t\tif (protoProps) _.extend(child.prototype, protoProps);\r\n\r\n\t\t// Set a convenience property in case the parent's prototype is needed later.\r\n\t\tchild.superclass = parent.prototype;\r\n\r\n\t\treturn child;\r\n\t},\r\n\r\n\tinitConfig: function (obj, config) {\r\n\t\tlet props = {}, c = obj.constructor, cArr = [c];\r\n\t\twhile (c) {\r\n\t\t\tif (c.super) {\r\n\t\t\t\tc = c.super.constructor;\r\n\t\t\t\tsplice.apply(cArr, [0, 0, c]);\r\n\t\t\t} else\r\n\t\t\t\tc = null;\r\n\t\t}\r\n\r\n\t\tfor (let i = 0; i < cArr.length; i++) {\r\n\t\t\tc = cArr[i];\r\n\t\t\tif (c.DEFAULTS)\r\n\t\t\t\t_.assign(props, c.DEFAULTS);\r\n\t\t}\r\n\t\tobj.props = _.assign(props, config);\r\n\t\tc.prototype.prop = function (name, value) {\r\n\t\t\tif (!value)\r\n\t\t\t\treturn this.props[name];\r\n\t\t\tthis.props[name] = value;\r\n\t\t};\r\n\t},\r\n\r\n\t/**\r\n\t * Gets the JS class constructor.\r\n\t * @param {Object} jsClass\r\n\t * @param {Object} defaultClass\r\n\t */\r\n\tgetConstructor: function (jsClass, defaultClass) {\r\n\t\tif (!jsClass)\r\n\t\t\tjsClass = defaultClass;\r\n\r\n\t\tif (_.isString(jsClass))\r\n\t\t\tjsClass = eval(jsClass);\r\n\t\treturn jsClass;\r\n\t},\r\n\r\n\tdebug: function (moduleName) {\r\n\t\tif (moduleName) {\r\n\t\t\t_debugging.push(moduleName);\r\n\t\t} else {\r\n\t\t\t_debugAll = true;\r\n\t\t}\r\n\t},\r\n\r\n\tlog: function (name, message) {\r\n\t\tif (!window.console) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tvar debug = _debugAll;\r\n\t\tif (!_debugAll) {\r\n\t\t\tdebug = false;\r\n\t\t\tfor (var i = 0; i < _debugging.length; i++) {\r\n\t\t\t\tif (_debugging[i] == name) debug = true;\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (!debug) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\twhile (name.length < 10) {\r\n\t\t\tname = name + ' ';\r\n\t\t}\r\n\t\tname = name.substring(0, 10) + \" - \";\r\n\t\tconsole.info(name, message);\r\n\t},\r\n\r\n\t/**\r\n\t * Get the relative position of sub shapes within a parent share.\r\n\t * @param bounds\r\n\t * @param geometry The geometry information, the format of Geometry is:\r\n\t * {\r\n\t *      x: \"x coordinate of ref point, if less than 1, will be treated as the percentage of the parent width.\",\r\n\t *      y: \"y coordinate of ref point.\",\r\n\t *      anchorX: \"x pos of child relative to the ref point\",\r\n\t *      anchorY: \"y pos of child relative to the ref point\",\r\n\t *      offsetX: \"the offset in the x direction.\",\r\n\t *      offsetY: \"the offset in the y direction.\",\r\n\t *      width: \"the width of the child element\",\r\n\t *      height: \"the height of the child element\"\r\n\t * }\r\n\t * @returns {*[]}\r\n\t */\r\n\tgetRelativePosition: function (bounds, geometry) {\r\n\t\tlet x = Math.abs(geometry.x) <= 1 ? bounds.width * geometry.x : geometry.x;\r\n\t\tlet y = Math.abs(geometry.y) <= 1 ? bounds.height * geometry.y : geometry.y;\r\n\t\treturn this.offsetPosition([x, y], geometry);\r\n\t},\r\n\r\n\toffsetPosition: function (pos, geometry) {\r\n\t\treturn [pos[0] + geometry.width * geometry.anchorX + geometry.offsetX, pos[1] + geometry.height * geometry.anchorY + geometry.offsetY];\r\n\t},\r\n\r\n\t/**\r\n\t * Get the position relative to the graph that's unscaled, i.e., absolute position without considering translation and scale.\r\n\t * @param t the current translate\r\n\t * @param scale the current scale\r\n\t * @param o can be either a Point or a Rectangle or a Point array.\r\n\t */\r\n\tunscale: function (t, scale, o) {\r\n\t\tif (o instanceof Rectangle)\r\n\t\t\treturn new Rectangle(o.x * scale + t[0], o.y * scale + t[1], o.width * scale, o.height * scale);\r\n\t\telse if (o instanceof Point)\r\n\t\t\treturn new Point(o.x * scale + t[0], o.y * scale + t[1]);\r\n\t\telse\r\n\t\t\treturn [o[0] * scale + t[0], o[1] * scale + t[1]];\r\n\t},\r\n\r\n\t/**\r\n\t * Get the position relative to the graph that's scaled, i.e., relative position considering translation and scale.\r\n\t * @param t the current translation\r\n\t * @param scale the current scale\r\n\t * @param o can be either a Point or a Rectangle or a Point array.\r\n\t */\r\n\tscale: function (t, scale, o) {\r\n\t\tif (o instanceof Rectangle)\r\n\t\t\treturn new Rectangle((o.x - t[0]) / scale, (o.y - t[1]) / scale, o.width / scale, o.height / scale);\r\n\t\telse if (o instanceof Point)\r\n\t\t\treturn new Point((o.x - t[0]) / scale, (o.y - t[1]) / scale);\r\n\t\telse\r\n\t\t\treturn [(o[0] - t[0]) / scale, (o[1] - t[1]) / scale];\r\n\t},\r\n\r\n\t/**\r\n\t * Convenience method.\r\n\t */\r\n\tgetProperty: function (obj, prop) {\r\n\t\tif (!obj)\r\n\t\t\treturn null;\r\n\t\tif (_.has(obj, prop))\r\n\t\t\treturn obj[prop];\r\n\t\tif (obj.prop && _.isFunction(obj.prop))\r\n\t\t\treturn obj.prop(prop);\r\n\t\treturn null;\r\n\t}\r\n};\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/util/Utils.js\n **/","class Point {\r\n\tconstructor(x, y) {\r\n\t\tthis.x = x;\r\n\t\tthis.y = y;\r\n\t}\r\n\r\n\t/**\r\n\t * Make a clone of this point\r\n\t */\r\n\tclone() {\r\n\t\treturn new Point(this.x, this.y);\r\n\t}\r\n\r\n\t/**\r\n\t * Calculate the distance from this pt to the other pt.\r\n\t * @param aPt\r\n\t * @returns {number}\r\n\t */\r\n\tdistance(aPt) {\r\n\t\treturn Math.sqrt((this.x - aPt.x) * (this.x - aPt.x) + (this.y - aPt.y) * (this.y - aPt.y));\r\n\t}\r\n\r\n\t/**\r\n\t * Translate this point\r\n \t */\r\n\ttranslate(p2) {\r\n\t\tthis.x += p2.x;\r\n\t\tthis.y += p2.y;\r\n\t\treturn this;\r\n\t}\r\n\r\n\t/**\r\n\t * Scale this vector\r\n \t */\r\n\tscale(scale) {\r\n\t\tthis.x *= scale;\r\n\t\tthis.y *= scale;\r\n\t\treturn this;\r\n\t}\r\n\r\n\tgetScaled(scale) {\r\n\t\treturn new Point(this.x * scale, this.y * scale);\r\n\t}\r\n\r\n\tgetTranslated(p2) {\r\n\t\treturn new Point(this.x + p2.x, this.y + p2.y);\r\n\t}\r\n\r\n\t/**\r\n\t * Get the direction vector from this point to p2.\r\n\t * @param p2\r\n\t * @returns {Point}\r\n\t */\r\n\tgetDirection(p2) {\r\n\t\tvar dist = this.distance(p2);\r\n\t\treturn new Point((p2.x - this.x) / dist, (p2.y - this.y) / dist);\r\n\t}\r\n\r\n\t/**\r\n\t * rotate the point about the origin. With the specified angle.\r\n\t * @param angle the angle to rotate\r\n\t */\r\n\trotate(angle) {\r\n\t\tvar cos = Math.cos(angle * Math.PI / 180);\r\n\t\tvar sin = Math.sin(angle * Math.PI / 180);\r\n\t\tvar x = this.x, y = this.y;\r\n\t\tthis.x = x * cos - y * sin;\r\n\t\tthis.y = x * sin + y * cos;\r\n\t\treturn this;\r\n\t}\r\n\r\n\tgetRotated(angle) {\r\n\t\treturn this.clone().rotate(angle);\r\n\t}\r\n\r\n\t/**\r\n\t * Calculate the dot product, treating this and p2 as vectors.\r\n\t */\r\n\tdotProduct(p2) {\r\n\t\treturn this.x * p2.x + this.y * p2.y;\r\n\t}\r\n\r\n\t/**\r\n\t * Get the mid point between this and p2.\r\n \t */\r\n\tgetMidPoint(p2) {\r\n\t\treturn new Point((this.x + p2.x) / 2, (this.y + p2.y) / 2);\r\n\t}\r\n\r\n\treverse() {\r\n\t\tthis.x = -this.x;\r\n\t\tthis.y = -this.y;\r\n\t\treturn this;\r\n\t}\r\n\r\n\tequals(p2) {\r\n\t\tif (!p2 || p2.constructor != Point) return false;\r\n\r\n\t\treturn (this.x == p2.x && this.y == p2.y);\r\n\t}\r\n\r\n\t/**\r\n\t * Reflect this point w.r.t. the rectangle.\r\n\t * If vertical is true, it will reflect the point cross the vertical\r\n\t * central line of the rectangle, otherwise reflect cross the horizontal\r\n\t * central line.\r\n\t *\r\n\t * @param rect the rectangle\r\n\t * @param vertical whether is vertical reflection or horizontal reflection.\r\n\t */\r\n\treflect(rect, vertical) {\r\n\t\tif (vertical)\r\n\t\t\tthis.x = 2 * rect.x - this.x;\r\n\t\telse\r\n\t\t\tthis.y = 2 * rect.y - this.y;\r\n\t\treturn this;\r\n\t}\r\n\r\n\ttoString() {\r\n\t\treturn this.x + \",\" + this.y;\r\n\t}\r\n}\r\n\r\nPoint.W = new Point(-1, 0);\r\nPoint.N = new Point(0, -1);\r\nPoint.S = new Point(0, 1);\r\nPoint.E = new Point(1, 0);\r\nPoint.NE = new Point(1, -1);\r\nPoint.NW = new Point(-1, -1);\r\nPoint.SE = new Point(1, 1);\r\nPoint.SW = new Point(-1, 1);\r\n\r\nexport default Point;\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/geometry/Point.js\n **/","import _ from \"lodash\";\r\nimport Point from \"./Point\";\r\nimport Shape from \"./Shape\";\r\n\r\nexport default class Rectangle extends Shape {\r\n\t/**\r\n\t * Checks whether this rectangle contains a given point of a given rectangle\r\n\t */\r\n\tcontains(el) {\r\n\t\tlet w = el.width || 0;\r\n\t\tlet h = el.height || 0;\r\n\t\tlet left = el.x - w/2;\r\n\t\tlet right = el.x + w/2;\r\n\t\tlet top = el.y - h/2;\r\n\t\tlet bottom = el.y + h/2;\r\n\t\treturn (right <= this.right) && (left >= this.left) &&\r\n\t\t\t(top >= this.top) && (bottom <= this.bottom);\r\n\t}\r\n\r\n\t/**\r\n\t * Calcualte the distance to a point. 0 if this rectangle contains the point.\r\n\t */\r\n\tdistance(pt) {\r\n\t\tif (this.contains(pt)) return 0;\r\n\r\n\t\tif (pt.x < this.left) {\r\n\t\t\tif (pt.y < this.top)\r\n\t\t\t\treturn pt.distance(new Point(this.left, this.top));\r\n\t\t\tif (pt.y <= this.bottom)\r\n\t\t\t\treturn this.left - pt.x;\r\n\t\t\treturn pt.distance(new Point(this.left, this.bottom));\r\n\t\t}\r\n\t\tif (pt.x <= this.right) {\r\n\t\t\tif (pt.y <= this.top)\r\n\t\t\t\treturn this.top - pt.y;\r\n\t\t\treturn pt.y - this.bottom;\r\n\t\t}\r\n\t\tif (pt.y < this.top)\r\n\t\t\treturn pt.distance(new Point(this.right, this.top));\r\n\t\tif (pt.y <= this.bottom)\r\n\t\t\treturn pt.x - this.right;\r\n\t\treturn pt.distance(new Point(this.right, this.bottom));\r\n\t}\r\n\r\n\t/**\r\n\t * Given two points, we want to detect whether the line joining the pts intersect\r\n\t * with the rectangle or not. We assume only horizontal or vertical line segments.\r\n\t *\r\n\t * @return int the side of the intersection: -1: no intersection, 0: left, 1: top, 2: right, 3: bottom, 4: containment.\r\n\t */\r\n\tdetectIntersection(pt1, pt2) {\r\n\t\tlet horizontal = pt1.y == pt2.y;\r\n\t\tlet contains1 = this.contains(pt1);\r\n\t\tlet contains2 = this.contains(pt2);\r\n\t\tif (contains1 && contains2) return 4;\r\n\t\tif (!contains1 && !contains2) {\r\n\t\t\tif (horizontal && (pt1.y >= this.top && pt1.y <= this.bottom)) {\r\n\t\t\t\tif (pt1.x < this.left && pt2.x > this.right)\r\n\t\t\t\t\treturn 0;\r\n\t\t\t\tif (pt1.x > this.right && pt2.x < this.left)\r\n\t\t\t\t\treturn 2;\r\n\t\t\t}\r\n\t\t\tif (!horizontal && (pt1.x >= this.left && pt1.x <= this.right)) {\r\n\t\t\t\tif (pt1.y < this.top && pt2.y > this.bottom)\r\n\t\t\t\t\treturn 1;\r\n\t\t\t\tif (pt1.y > this.bottom && pt2.y < this.top)\r\n\t\t\t\t\treturn 3;\r\n\t\t\t}\r\n\t\t\treturn -1;\r\n\t\t}\r\n\r\n\t\tlet outPt = contains1 ? pt2 : pt1;\r\n\t\tif (horizontal) {\r\n\t\t\tif (outPt.x > this.right)\r\n\t\t\t\treturn 2;\r\n\t\t\treturn 0;\r\n\t\t} else {\r\n\t\t\tif (outPt.y < this.top)\r\n\t\t\t\treturn 1;\r\n\t\t\treturn 3;\r\n\t\t}\r\n\t}\r\n\r\n\ttoString() {\r\n\t\treturn 'Rectangle:{x=' + this.x + ';y=' + this.y + ';width=' + this.width + ';height=' + this.height + '}';\r\n\t}\r\n\r\n\tstatic getPerimeter(rect, pt, orthogonal = false) {\r\n\t\tlet x = rect.x;\r\n\t\tlet y = rect.y;\r\n\t\tlet dx = pt.x - x;\r\n\t\tlet dy = pt.y - y;\r\n\t\tlet alpha = Math.atan2(dy, dx);\r\n\t\tlet p = new Point(0, 0);\r\n\t\tlet pi = Math.PI;\r\n\t\tlet pi2 = Math.PI/2;\r\n\t\tlet beta = pi2 - alpha;\r\n\t\tlet t = Math.atan2(rect.height, rect.width);\r\n\r\n\t\tif (alpha < -pi + t || alpha > pi - t) {\r\n\t\t\t// Left edge\r\n\t\t\tp.x = rect.left;\r\n\t\t\tp.y = y - rect.width * Math.tan(alpha) / 2;\r\n\t\t} else if (alpha < -t) {\r\n\t\t\t// Top Edge\r\n\t\t\tp.y = rect.top;\r\n\t\t\tp.x = x - rect.height * Math.tan(beta) / 2;\r\n\t\t} else if (alpha < t) {\r\n\t\t\t// Right Edge\r\n\t\t\tp.x = rect.right;\r\n\t\t\tp.y = y + rect.width * Math.tan(alpha) / 2;\r\n\t\t} else {\r\n\t\t\t// Bottom Edge\r\n\t\t\tp.y = rect.bottom;\r\n\t\t\tp.x = x + rect.height * Math.tan(beta) / 2;\r\n\t\t}\r\n\r\n\t\tif (orthogonal) {\r\n\t\t\tif (alpha < -pi + t || alpha > pi - t) {\r\n\t\t\t\t// Left edge\r\n\t\t\t\tp.x = rect.left;\r\n\t\t\t\tp.y = y;\r\n\t\t\t} else if (alpha < -t) {\r\n\t\t\t\t// Top Edge\r\n\t\t\t\tp.y = rect.top;\r\n\t\t\t\tp.x = x;\r\n\t\t\t} else if (alpha < t) {\r\n\t\t\t\t// Right Edge\r\n\t\t\t\tp.x = rect.right;\r\n\t\t\t\tp.y = y;\r\n\t\t\t} else {\r\n\t\t\t\t// Bottom Edge\r\n\t\t\t\tp.y = rect.bottom;\r\n\t\t\t\tp.x = x;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tlet dir = Rectangle.getDirection(rect, p, orthogonal);\r\n\t\treturn {point: p, direction: dir};\r\n\t}\r\n\r\n\t/**\r\n\t * Return the bounding rectangle that contains p1 and p2\r\n\t */\r\n\tstatic getBoundingRectangle(pts, margin) {\r\n\t\tif (!pts || pts.length == 0) return null;\r\n\t\tmargin = margin || [0, 0, 0, 0];\r\n\t\tif (!_.isArray(margin))\r\n\t\t\tmargin = [margin, margin, margin, margin];\r\n\t\tlet min = [pts[0].x, pts[0].y];\r\n\t\tlet max = [pts[0].x, pts[0].y];\r\n\t\tfor (let i = 1; i < pts.length; i++) {\r\n\t\t\tlet p = pts[i];\r\n\t\t\tif (p.x < min[0]) {\r\n\t\t\t\tmin[0] = p.x;\r\n\t\t\t}\r\n\t\t\tif (p.y < min[1]) {\r\n\t\t\t\tmin[1] = p.y;\r\n\t\t\t}\r\n\t\t\tif (p.x > max[0]) {\r\n\t\t\t\tmax[0] = p.x;\r\n\t\t\t}\r\n\t\t\tif (p.y > max[1]) {\r\n\t\t\t\tmax[1] = p.y;\r\n\t\t\t}\r\n\t\t}\r\n\t\tmin[0] = min[0] - margin[0];\r\n\t\tmin[1] = min[1] - margin[1];\r\n\t\tmax[0] = max[0] + margin[2];\r\n\t\tmax[1] = max[1] + margin[3];\r\n\t\tlet w = Math.abs(max[0] - min[0]);\r\n\t\tlet h = Math.abs(max[1] - min[1]);\r\n\t\treturn new Rectangle(min[0] + w/2, min[1] + h/2, w, h);\r\n\t}\r\n\r\n\t/**\r\n\t * Create a union of all the rectangles.\r\n\t * @param rects\r\n\t */\r\n\tstatic union(rects) {\r\n\t\tlet minx = null, miny = null, maxx = -Infinity, maxy = -Infinity;\r\n\t\t_.each(rects, function (rect) {\r\n\t\t\tminx = minx || rect.x;\r\n\t\t\tminy = miny || rect.y;\r\n\t\t\tminx = Math.min(minx, rect.x);\r\n\t\t\tminy = Math.min(miny, rect.y);\r\n\t\t\tmaxx = Math.max(maxx, rect.right());\r\n\t\t\tmaxy = Math.max(maxy, rect.bottom());\r\n\t\t});\r\n\t\tminx = minx || 0;\r\n\t\tminy = miny || 0;\r\n\t\treturn new Rectangle(minx, miny, maxx - minx, maxy - miny);\r\n\t}\r\n\r\n\t/**\r\n\t * Returns the direction the point <i>p</i> is in relation to the given rectangle.\r\n\t * Possible values are WEST (-1,0), EAST (1,0), NORTH (0,-1) and SOUTH (0,1) if orthogonal is true, otherwise return\r\n\t * the direction connection the center of r and p.\r\n\t * @param r\r\n\t * @param p\r\n\t * @param orthogonal\r\n\t * @returns {Point|*}\r\n\t */\r\n\tstatic getDirection(r, p, orthogonal = false) {\r\n\t\tif (!orthogonal)\r\n\t\t\treturn new Point(r.x, r.y).getDirection(new Point(p.x, p.y));\r\n\r\n\t\tlet i, distance = Math.abs(r.left - p.x), direction = Point.W;\r\n\r\n\t\ti = Math.abs(r.top - p.y);\r\n\t\tif (i <= distance) {\r\n\t\t\tdistance = i;\r\n\t\t\tdirection = Point.N;\r\n\t\t}\r\n\r\n\t\ti = Math.abs(r.bottom - p.y);\r\n\t\tif (i <= distance) {\r\n\t\t\tdistance = i;\r\n\t\t\tdirection = Point.S;\r\n\t\t}\r\n\r\n\t\ti = Math.abs(r.right - p.x);\r\n\t\tif (i < distance) {\r\n\t\t\tdirection = Point.E;\r\n\t\t}\r\n\r\n\t\treturn direction;\r\n\t}\r\n}\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/geometry/Rectangle.js\n **/","module.exports = __WEBPACK_EXTERNAL_MODULE_5__;\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external {\"root\":\"_\",\"commonjs\":\"lodash\",\"commonjs2\":\"lodash\",\"amd\":\"lodash\"}\n ** module id = 5\n ** module chunks = 0\n **/","import _ from \"lodash\";\r\nimport Point from \"./Point\";\r\nimport Rectangle from \"./Rectangle\";\r\n\r\nlet registry = {};\r\n\r\nclass Shape {\r\n\tconstructor(x, y, width, height, config) {\r\n\t\tthis.x = x;\r\n\t\tthis.y = y;\r\n\t\tthis.width = width;\r\n\t\tthis.height = height;\r\n\t\t_.defaults(this, config, {x: 0, y: 0, width: 0, height: 0});\r\n\t}\r\n\r\n\t/**\r\n\t * Return the y-coord of the top side of this rectangle\r\n\t */\r\n\tget top() { return this.y - this.height/2; }\r\n\r\n\t/**\r\n\t * Returns the y-coordinate of the bottom of this Rectangle.\r\n\t */\r\n\tget bottom() { return this.y + this.height/2; }\r\n\r\n\t/**\r\n\t * Return the x-coord of left side of this rectangle\r\n\t */\r\n\tget left() { return this.x - this.width/2; }\r\n\r\n\t/**\r\n\t * Returns the x-coordinate of the right side of this Rectangle.\r\n\t */\r\n\tget right() { return this.x + this.width/2; }\r\n\r\n\tget center() { return new Point(this.x, this.y); }\r\n\r\n\tget bounds() { return new Rectangle(this.x, this.y, this.width, this.height); }\r\n\r\n\tcontains(el) { return false; }\r\n\r\n\t/**\r\n\t * This will generate n ports on the shape.\r\n\t */\r\n\tgetRegularPoints(n) {return null;}\r\n\r\n\t/**\r\n\t * Get the intersection between boundary of this shape and the line connecting (x,y) with the refPt.\r\n\t * @param refPt\r\n\t * @returns {null}\r\n\t */\r\n\tgetPerimeter(refPt, orthogonal = false) {\r\n\t\treturn this.constructor.getPerimeter(this, refPt, orthogonal);\r\n\t}\r\n\r\n\trender(view) {\r\n\t\tlet template = _.template(view.getTemplate(this.name, this));\r\n\t\treturn template(this);\r\n\t}\r\n\r\n\tstatic getShape(name) {\r\n\t\treturn registry[name];\r\n\t}\r\n\r\n\tstatic addShape(name, c) {\r\n\t\tregistry[name] = c;\r\n\t}\r\n\r\n\tstatic removeShape(name) {\r\n\t\tdelete registry[name];\r\n\t}\r\n}\r\n\r\nexport default Shape;\r\n\r\n\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/geometry/Shape.js\n **/","import _ from \"lodash\";\r\n\r\n/**\r\n * dom Utility functions\r\n */\r\nexport default {\r\n\tisIE: (function () {\r\n\t\tif (!window || !window.navigator || !navigator) return false;\r\n\t\tvar sAgent = window.navigator.userAgent;\r\n\t\tvar Idx = sAgent.indexOf(\"MSIE\");\r\n\r\n\t\t// If IE, return version number.\r\n\t\tif (Idx > 0)\r\n\t\t\treturn parseInt(sAgent.substring(Idx + 5, sAgent.indexOf(\".\", Idx)));\r\n\r\n\t\t// If IE 11 then look for Updated user agent string.\r\n\t\telse if (!!navigator.userAgent.match(/Trident\\/7\\./))\r\n\t\t\treturn 11;\r\n\t\telse if (!!navigator.userAgent.match(/Edge\\//))\r\n\t\t\treturn \"Edge\";\r\n\t\telse\r\n\t\t\treturn false;\r\n\t})(),\r\n\r\n\tisFireFox : (function(){\r\n\t\t// InstallTrigger: Firefox's API to install add-ons\r\n\t\treturn typeof InstallTrigger !== 'undefined';\r\n\t})(),\r\n\r\n\tisChrome: (function() {\r\n\t\tif (!window || !window.navigator || !navigator || navigator.userAgent.indexOf('Edge') >= 0) return false;\r\n\t\tvar raw = navigator.userAgent.match(/Chrom(e|ium)\\/([0-9]+)\\./);\r\n\t\treturn raw ? parseInt(raw[2], 10) : false;\r\n\t})(),\r\n\r\n\tisMac: (function() {\r\n\t\tif (!window || !window.navigator || !navigator) return false;\r\n\t\treturn navigator.platform.toUpperCase().indexOf('MAC') >= 0;\r\n\t})(),\r\n\r\n\tisWindows: (function() {\r\n\t\tif (!window || !window.navigator || !navigator) return false;\r\n\t\treturn navigator.appVersion.indexOf(\"Windows\") >= 0;\r\n\t})(),\r\n\r\n\tisLinux: (function() {\r\n\t\tif (!window || !window.navigator || !navigator) return false;\r\n\t\treturn navigator.appVersion.indexOf(\"Linux\") >= 0;\r\n\t})(),\r\n\r\n\tcreateElement: function (tag, attribs, styles, html) {\r\n\t\tlet el = document.createElement(tag);\r\n\t\tthis.setElement(el, attribs, styles);\r\n\t\tif (html)\r\n\t\t\tel.innerHTML = html;\r\n\t\treturn el;\r\n\t},\r\n\r\n\tcreateElementByString: function(str) {\r\n\t\tlet temp = this.createElement('div', null, null, str);\r\n\t\treturn temp.childNodes;\r\n\t},\r\n\r\n\tsetElement: function (el, attribs, styles) {\r\n\t\tif (attribs) {\r\n\t\t\t_.forEach(attribs, function(value, key) {\r\n\t\t\t    el.setAttribute(key, value);\r\n\t\t\t });\r\n\t\t}\r\n\t\tif (styles) {\r\n\t\t\t_.forEach(styles, function(value, key) {\r\n\t\t\t\tel.style[key] = value;\r\n\t\t\t});\r\n\t\t}\r\n\t},\r\n\r\n\ttestElement: function(node, method) {\r\n\t\treturn node && node.nodeType == 1 && ( !method || method(node) );\r\n\t},\r\n\r\n\tgetAncestorBy: function(node, method) {\r\n\t\twhile (node = node.parentNode)\r\n\t\t\tif (this.testElement(node, method) )\r\n\t\t\t\treturn node;\r\n\r\n\t\treturn null;\r\n\t},\r\n\r\n\t/**\r\n\t * Get the position of element relative to the context.\r\n\t * @param el the element\r\n\t * @param context\r\n\t * @returns {*[]}\r\n\t */\r\n\tgetPosition(el, context) {\r\n\t\tif (!context) context = document.body;\r\n\t\tlet elRect = el.getBoundingClientRect();\r\n\t\tlet contextRect = context.getBoundingClientRect();\r\n\r\n\t\treturn [elRect.left - contextRect.left, elRect.top - contextRect.top];\r\n\t},\r\n\r\n\tgetCenterPosition(el, context) {\r\n\t\tif (!context) context = document.body;\r\n\t\tlet elRect = el.getBoundingClientRect();\r\n\t\tlet contextRect = context.getBoundingClientRect();\r\n\t\tlet w = elRect.right - elRect.left;\r\n\t\tlet h = elRect.bottom - elRect.top;\r\n\r\n\t\treturn [elRect.left - contextRect.left + w/2, elRect.top - contextRect.top + h/2];\r\n\t},\r\n\r\n\tmove: function(el, x, y) {\r\n\t\tif (x) el.style.left = x + 'px';\r\n\t\tif (y) el.style.top = y + 'px';\r\n\t},\r\n\r\n\tgetSize: function(el) {\r\n\t\tvar w = parseInt(el.style.offsetWidth, 10);\r\n\t\tvar h = parseInt(el.style.offsetHeight, 10);\r\n\t\treturn [w, h];\r\n\t},\r\n\r\n\tresize: function(el, w, h) {\r\n\t\tif (w) el.style.width = w + \"px\";\r\n\t\tif (h) el.style.height = h + 'px';\r\n\t},\r\n\r\n\tpreloadImages: function(array) {\r\n\t\tif (!this.preloadImages.list) this.preloadImages.list = [];\r\n\t\tif (!this.preloadImages.loaded) this.preloadImages.loaded = {};\r\n\r\n\t\tvar list = this.preloadImages.list;\r\n\t\tvar img, that = this;\r\n\t\tfor (var i = 0; i < array.length; i++) {\r\n\t\t\timg = new Image();\r\n\t\t\timg.onload = function() {\r\n\t\t\t\tvar index = list.indexOf(this);\r\n\t\t\t\tif (index !== -1) {\r\n\t\t\t\t\tthat.preloadImages.loaded[this.name] = {width: this.width, height: this.height};\r\n\t\t\t\t\t// remove image from the array once it's loaded\r\n\t\t\t\t\t// for memory consumption reasons\r\n\t\t\t\t\tlist.splice(index, 1);\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t\tlist.push(img);\r\n\t\t\timg.src = array[i];\r\n\t\t\timg.name = array[i];\r\n\t\t}\r\n\t},\r\n\r\n\t/**\r\n\t * Get's the image's information given the url. Must be preloaded by calling the preloadImage function.\r\n\t * @param src\r\n\t */\r\n\tgetImageInfo: function(src) {\r\n\t\tif (this.preloadImages.loaded) {\r\n\t\t\treturn this.preloadImages.loaded[src];\r\n\t\t}\r\n\t\treturn null;\r\n\t},\r\n\r\n\tdownloadFile: function(name, data) {\r\n\t\tif (!data) return;\r\n\t\tlet mime = data.match(/^data:([^;,]*)/)[1];\r\n\t\tif (name.indexOf('.') < 0) {\r\n\t\t\tif (!mime) mime = 'text/plain';\r\n\t\t\tif (mime == 'text/plain')\r\n\t\t\t\tname = name + '.txt';\r\n\t\t\telse {\r\n\t\t\t\tlet type = mime.split('/')[1];\r\n\t\t\t\tif (type.indexOf('+') > 0) type = type.split('+')[0];\r\n\t\t\t\tname = name + '.' + type;\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (this.isIE) {\r\n\t\t\tlet encoded = data.indexOf(';base64') >= 0;\r\n\t\t\tif (encoded)\r\n\t\t\t\tdata = atob(data.replace('data:' + mime + ';base64,', ''));\r\n\t\t\telse\r\n\t\t\t\tdata = decodeURI(data.replace('data:' + mime + ',', ''));\r\n\t\t\tdata = this.GetBlob(data, mime);\r\n\t\t\tnavigator.msSaveBlob(data, name);\r\n\t\t} else {\r\n\t\t\tlet link = this.createElement('a', {href: data, download: name}, {display: \"none\"});\r\n\t\t\tdocument.body.appendChild(link);\r\n\t\t\tlink.click();\r\n\t\t\tlink.parentNode.removeChild(link);\r\n\t\t}\r\n\t},\r\n\r\n\t/**\r\n\t * Convert b54 to blob. IE only\r\n\t */\r\n\tGetBlob: function (data, contentType, sliceSize) {\r\n\t\tcontentType = contentType || '';\r\n\t\tsliceSize = sliceSize || 512;\r\n\r\n\t\tvar byteArrays = [];\r\n\r\n\t\tfor (var offset = 0; offset < data.length; offset += sliceSize) {\r\n\t\t\tvar slice = data.slice(offset, offset + sliceSize);\r\n\r\n\t\t\tvar byteNumbers = new Array(slice.length);\r\n\t\t\tfor (var i = 0; i < slice.length; i++) {\r\n\t\t\t\tbyteNumbers[i] = slice.charCodeAt(i);\r\n\t\t\t}\r\n\t\t\tvar byteArray = new Uint8Array(byteNumbers);\r\n\t\t\tbyteArrays.push(byteArray);\r\n\t\t}\r\n\t\treturn new Blob(byteArrays, {type: contentType});\r\n\t},\r\n\r\n\topenImage: function(name, image) {\r\n\t\tvar myWindow = window.open(\"\", \"_blank\", \"toolbar=yes, scrollbars=yes, resizable=yes, width=500, height=500\");\r\n\t\tvar myDocument = myWindow.document;\r\n\t\tvar img = myDocument.createElement(\"img\");\r\n\t\tthis.setElement(img, {src: image, name: name});\r\n\t\tmyDocument.body.appendChild(img);\r\n\t},\r\n\r\n\t/**\r\n\t * Check whether the key event is from input, textarea or select.\r\n\t * @param e  input event\r\n\t */\r\n\teventFromInput: function(e){\r\n\t\tvar tagName = e.target.tagName;\r\n\t\treturn (tagName == 'INPUT' || tagName == 'TEXTAREA' || tagName == 'SELECT');\r\n\t}\r\n}\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/util/DomUtils.js\n **/","import _ from \"lodash\";\r\n\r\n/**\r\n * A string buffer for fast string manipulation\r\n */\r\nexport default class StringBuffer {\r\n\tconstructor(str) {\r\n\t\tthis.buffer = [];\r\n\t\tif (str)\r\n\t\t\tthis.buffer.push(str);\r\n\t}\r\n\r\n\tappend(stuff) {\r\n\t\tif (_.isString(stuff))\r\n\t\t\tthis.buffer.push(stuff);\r\n\t\telse if (_.isArray(stuff))\r\n\t\t\tthis.buffer = this.buffer.concat(stuff);\r\n\t\telse\r\n\t\t\tthis.buffer.push(\"\" + stuff);\r\n\t\treturn this;\r\n\t}\r\n\r\n\tprepend(stuff) {\r\n\t\tif (_.isString(stuff))\r\n\t\t\tthis.buffer.splice(0, 0, stuff);\r\n\t\telse if (_.isArray(stuff))\r\n\t\t\tthis.buffer = stuff.concat(this.buffer);\r\n\t\telse\r\n\t\t\tthis.buffer.splice(0, 0, \"\" + stuff);\r\n\t\treturn this;\r\n\t}\r\n\r\n\tclear() {\r\n\t\tthis.buffer = [];\r\n\t}\r\n\r\n\tremoveLast() {\r\n\t\tthis.buffer.pop();\r\n\t\treturn this;\r\n\t}\r\n\r\n\ttoString(sep) {\r\n\t\tif (!sep) sep = '';\r\n\t\treturn this.buffer.join(sep);\r\n\t}\r\n}\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/util/StringBuffer.js\n **/","import Point from \"./Point\";\r\n\r\nexport default class Line {\r\n\tconstructor(start, end) {\r\n\t\tthis.start = start;\r\n\t\tthis.end = end;\r\n\t}\r\n\r\n\t/**\r\n\t * Calculate the length of this line\r\n\t */\r\n\tlength() {\r\n\t\treturn this.start.distance(this.end);\r\n\t}\r\n\r\n\t/**\r\n\t * Calculate the distance of this line to the point.\r\n\t */\r\n\tdistance(pt) {\r\n\t\tvar x = this.start.distance(pt);\r\n\t\tif (x == 0) return 0;\r\n\r\n\t\tvar l = this.length();\r\n\t\tvar cosa = new Point((this.end.x - this.start.x) / l, (this.end.y - this.start.y) / l).dotProduct(\r\n\t\t\tnew Point(pt.x / x, pt.y / x));\r\n\r\n\t\treturn x * Math.sqrt(1 - cosa * cosa);\r\n\t}\r\n\r\n\t/**\r\n\t * Function: intersection\r\n\t *\r\n\t * Returns the intersection of two lines as an <mxPoint>.\r\n\t *\r\n\t * Parameters:\r\n\t *\r\n\t * x0 - X-coordinate of the first line's startpoint.\r\n\t * y0 - X-coordinate of the first line's startpoint.\r\n\t * x1 - X-coordinate of the first line's endpoint.\r\n\t * y1 - Y-coordinate of the first line's endpoint.\r\n\t * x2 - X-coordinate of the second line's startpoint.\r\n\t * y2 - Y-coordinate of the second line's startpoint.\r\n\t * x3 - X-coordinate of the second line's endpoint.\r\n\t * y3 - Y-coordinate of the second line's endpoint.\r\n\t */\r\n\tstatic intersection(x0, y0, x1, y1, x2, y2, x3, y3) {\r\n\t\tvar denom = ((y3 - y2) * (x1 - x0)) - ((x3 - x2) * (y1 - y0));\r\n\t\tvar nume_a = ((x3 - x2) * (y0 - y2)) - ((y3 - y2) * (x0 - x2));\r\n\t\tvar nume_b = ((x1 - x0) * (y0 - y2)) - ((y1 - y0) * (x0 - x2));\r\n\r\n\t\tvar ua = nume_a / denom;\r\n\t\tvar ub = nume_b / denom;\r\n\r\n\t\tif (ua >= 0.0 && ua <= 1.0 && ub >= 0.0 && ub <= 1.0) {\r\n\t\t\t// Get the intersection point\r\n\t\t\tvar intersectionX = x0 + ua * (x1 - x0);\r\n\t\t\tvar intersectionY = y0 + ua * (y1 - y0);\r\n\r\n\t\t\treturn new Point(intersectionX, intersectionY);\r\n\t\t}\r\n\r\n\t\t// No intersection\r\n\t\treturn null;\r\n\t}\r\n\r\n\ttoString() {\r\n\t\treturn 'Line:{start=' + this.start + ';end=' + this.end + '}';\r\n\t}\r\n}\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/geometry/Line.js\n **/","import Shape from \"./Shape\";\r\nimport Point from \"./Point\";\r\nimport Rectangle from \"./Rectangle\";\r\n\r\nexport default class Ellipse extends Shape {\r\n\ttoString() {\r\n\t\treturn 'Ellipse:{x=' + this.x + ';y=' + this.y + ';width=' + this.width + ';height=' + this.height + '}';\r\n\t}\r\n\r\n\tstatic getPerimeter(rect, pt, orthogonal = false) {\r\n\t\tvar a = rect.width / 2;\r\n\t\tvar b = rect.height / 2;\r\n\t\tvar cx = rect.x;\r\n\t\tvar cy = rect.y;\r\n\t\tvar px = pt.x;\r\n\t\tvar py = pt.y;\r\n\r\n\t\t// Calculates straight line equation through\r\n\t\t// point and ellipse center y = d * x + h\r\n\t\tvar dx = parseInt(px - cx);\r\n\t\tvar dy = parseInt(py - cy);\r\n\r\n\t\tvar tx, ty;\r\n\r\n\t\tif (dx == 0 && dy != 0) {\r\n\t\t\treturn new Point(cx, cy + b * dy / Math.abs(dy));\r\n\t\t} else if (dx == 0 && dy == 0) {\r\n\t\t\treturn new Point(px, py);\r\n\t\t}\r\n\r\n\t\t// Calculates intersection\r\n\t\tvar d = dy / dx;\r\n\t\tvar h = cy - d * cx;\r\n\t\tvar e = a * a * d * d + b * b;\r\n\t\tvar f = -2 * cx * e;\r\n\t\tvar g = a * a * d * d * cx * cx + b * b * cx * cx - a * a * b * b;\r\n\t\tvar det = Math.sqrt(f * f - 4 * e * g);\r\n\r\n\t\t// Two solutions (perimeter points)\r\n\t\tvar xout1 = (-f + det) / (2 * e);\r\n\t\tvar xout2 = (-f - det) / (2 * e);\r\n\t\tvar yout1 = d * xout1 + h;\r\n\t\tvar yout2 = d * xout2 + h;\r\n\t\tvar dist1 = Math.sqrt(Math.pow((xout1 - px), 2) + Math.pow((yout1 - py), 2));\r\n\t\tvar dist2 = Math.sqrt(Math.pow((xout2 - px), 2) + Math.pow((yout2 - py), 2));\r\n\r\n\t\t// Correct solution\r\n\t\tvar xout = 0;\r\n\t\tvar yout = 0;\r\n\r\n\t\tif (dist1 < dist2) {\r\n\t\t\txout = xout1;\r\n\t\t\tyout = yout1;\r\n\t\t} else {\r\n\t\t\txout = xout2;\r\n\t\t\tyout = yout2;\r\n\t\t}\r\n\r\n\t\tlet p = new Point(xout, yout);\r\n\t\tlet dir = Rectangle.getDirection(rect, p, orthogonal);\r\n\t\tif (orthogonal) {\r\n\t\t\tif (dir.x == -1) {\r\n\t\t\t\treturn {point: new Point(cx - a, cy), direction: dir};\r\n\t\t\t}\r\n\t\t\tif (dir.x == 1) {\r\n\t\t\t\treturn {point: new Point(cx + a, cy), direction: dir};\r\n\t\t\t}\r\n\t\t\tif (dir.y == -1) {\r\n\t\t\t\treturn {point: new Point(cx, cy - b), direction: dir};\r\n\t\t\t}\r\n\t\t\tif (dir.y == 1) {\r\n\t\t\t\treturn {point: new Point(cx, cy + b), direction: dir};\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn {point: p, direction: dir};\r\n\t}\r\n}\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/geometry/Ellipse.js\n **/","import _ from \"lodash\";\nimport Point from \"./Point\";\nimport Utils from \"../util/Utils\";\n\nlet defaultConfig = {\n\ttype: \"direct\",\n\tshowGauge: true,\n\torthogonal: false\n};\n\nlet defaultGeometry = {\n\twidth: 0,\n\theight: 0,\n\tanchorX: 0,\n\tanchorY: 0,\n\toffsetX: 0,\n\toffsetY: 0\n};\n\nlet linkTypes = {};\n\nclass Link {\n\tconstructor(terminalVisual, shapeConfig = {}, startMarker = null, endMarker = null) {\n\t\tthis.start = terminalVisual[0].point;\n\t\tthis.end = terminalVisual[1].point;\n\t\tthis.startNormal = terminalVisual[0].direction;\n\t\tthis.endNormal = terminalVisual[1].direction;\n\t\tthis.startMarker = startMarker;\n\t\tthis.endMarker = endMarker;\n\t\t_.assign(this, shapeConfig);\n\t}\n\n\trender(view) {\n\t\treturn view.renderLink(this);\n\t}\n\n\tget points() { return null; }\n\tget controlPts() { return null; }\n\tget length() {\n\t\tlet points = this.points;\n\t\tlet i, l = 0;\n\t\tfor (i = 0; i < points.length - 1; i++)\n\t\t\tl += points[i].distance(points[i+1]);\n\t\treturn l;\n\t}\n\n\t/**\n\t * Calculate the position where to put modifiers or label..\n\t *\n\t * @param geometry: defines how far along the edge should the point be placed.\n\t * @return *[] the relative position.\n\t */\n\tgetRelativePosition(geometry) {\n\t\tif (_.isNumber(geometry))\n\t\t\tgeometry = {x: geometry};\n\t\tgeometry = _.defaults(geometry, defaultGeometry);\n\t\tlet p = geometry.x, l = this.length;\n\t\tif (Math.abs(p) <= 1) p *= l;\n\t\tif (p < 0) p = l + p;\n\t\tif (p > l) p = l;\n\n\t\tlet points = this.points, d, point, dir;\n\t\tfor (let i = 0; i < points.length - 1; i++) {\n\t\t\td = points[i].distance(points[i+1]);\n\t\t\tif (p <= d) {\n\t\t\t\t// we've located the line segment.\n\t\t\t\tpoint = points[i].clone();\n\t\t\t\tdir = point.getDirection(points[i+1]);\n\t\t\t\tpoint.translate(dir.getScaled(p));\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tp -= d;\n\t\t}\n\n\t\t// return the last point.\n\t\tif (!point)\n\t\t\tpoint = points[points.length - 1];\n\t\treturn Utils.offsetPosition([point.x, point.y], geometry);\n\t}\n\n\ttoString() {\n\t\treturn 'Link';\n\t}\n\n\tstatic getLink(terminalVisual, shapeConfig = {}, startMarker = null, endMarker = null) {\n\t\tshapeConfig = _.defaultsDeep(shapeConfig, defaultConfig);\n\t\tlet linkClass = linkTypes[shapeConfig.type];\n\t\tif (linkClass)\n\t\t\treturn new linkClass(terminalVisual, shapeConfig, startMarker, endMarker);\n\t\tconsole.log('link type not supported: ' + shapeConfig.type);\n\t\treturn null;\n\t}\n}\n\nclass DirectLink extends Link {\n\tget points() {\n\t\treturn [this.start, this.end];\n\t}\n}\n\nclass BezierLink extends Link {\n\tget points() {\n\t\treturn [this.start, this.end];\n\t}\n\n\tget controlPts() {\n\t\tlet s = this.points[0], e = this.points[1];\n\t\tlet pts = [];\n\t\tpts[0] = null;\n\t\tpts[1] = [];\n\t\tif (this.startNormal.x == 0) {\n\t\t\tpts[1][0] = new Point(s.x, (s.y + e.y)/2);\n\t\t}\n\t\telse {\n\t\t\tpts[1][0] = new Point((s.x + e.x)/2, s.y);\n\t\t}\n\t\tif (this.endNormal.x == 0) {\n\t\t\tpts[1][1] = new Point(e.x, (s.y + e.y)/2);\n\t\t}\n\t\telse {\n\t\t\tpts[1][1] = new Point((s.x + e.x)/2, e.y);\n\t\t}\n\t\treturn pts;\n\t}\n\n\tgetRelativePosition(geometry) {\n\t\tif (_.isNumber(geometry))\n\t\t\tgeometry = {x: geometry};\n\t\tgeometry = _.defaults(geometry, defaultGeometry);\n\t\tlet p = geometry.x, l = this.length;\n\t\tif (Math.abs(p) > 1) p /= l;\n\t\tif (p < 0) p++;\n\t\tif (p > 1) p--;\n\n\t\tlet pts = this.points;\n\t\tlet ctrlpts = this.controlPts;\n\t\tlet p1 = pts[0];\n\t\tlet p2 = ctrlpts[1][0];\n\t\tlet p3 = ctrlpts[1][1];\n\t\tlet p4 = pts[1];\n\n\t\tlet point = [(1-p)*(1-p)*(1-p) * p1.x + 3*p*(1-p)*(1-p) * p2.x + 3*p*p*(1-p) * p3.x + p*p*p * p4.x, (1-p)*(1-p)*(1-p) * p1.y + 3*p*(1-p)*(1-p) * p2.y + 3*p*p*(1-p) * p3.y + p*p*p * p4.y];\n\t\treturn Utils.offsetPosition([point.x, point.y], geometry);\n\t}\n}\n\nclass EntityRelations extends Link {\n\tget points() {\n\t\tvar source = Port.getBounds(edge, true);\n\t\tvar target = Port.getBounds(edge, false);\n\t\tvar isSourceLeft = target.right() < source.x;\n\t\tvar isTargetLeft = source.right() < target.x;\n\t\tvar result = [];\n\n\t\tvar x0 = (isSourceLeft) ? source.x : source.x + source.width;\n\t\tvar y0 = source.getCenterY();\n\t\tresult.push(new Point(x0, y0));\n\n\t\tvar xe = (isTargetLeft) ? target.x : target.x + target.width;\n\t\tvar ye = target.getCenterY();\n\n\t\tvar seg = this.segment;\n\n\t\tvar dx = (isSourceLeft) ? -seg : seg;\n\t\tvar dep = new Point(x0 + dx, y0);\n\n\t\tdx = (isTargetLeft) ? -seg : seg;\n\t\tvar arr = new Point(xe + dx, ye);\n\n\t\t// Adds intermediate points if both go out on same side\n\t\tif (isSourceLeft == isTargetLeft)\n\t\t{\n\t\t\tvar x = (isSourceLeft) ?\n\t\t\tMath.min(x0, xe)-seg :\n\t\t\tMath.max(x0, xe)+seg;\n\n\t\t\tresult.push(new Point(x, y0));\n\t\t\tresult.push(new Point(x, ye));\n\t\t}\n\t\telse if ((dep.x < arr.x) == isSourceLeft)\n\t\t{\n\t\t\tvar midY = y0 + (ye - y0) / 2;\n\n\t\t\tresult.push(dep);\n\t\t\tresult.push(new Point(dep.x, midY));\n\t\t\tresult.push(new Point(arr.x, midY));\n\t\t\tresult.push(arr);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tresult.push(dep);\n\t\t\tresult.push(arr);\n\t\t}\n\n\t\tresult.push(new Point(xe, ye));\n\t\treturn result;\n\t}\n}\n\n\nclass Manhattan extends Link {\n\tconstructor(terminalVisual, shapeConfig, startMarker, endMarker) {\n\t\tshapeConfig = _.defaults(shapeConfig, {\n\t\t\tMIN_BUFFER: 10,\n\t\t\tautoRoute: false,\n\t\t\trandomNoise: 0,\n\t\t\tstep: 1,\n\t\t\tmaxChannelWidth: 100\n\t\t});\n\t\tsuper(terminalVisual, shapeConfig, startMarker, endMarker);\n\t}\n\n\tget points() {\n\t\tlet pos = Manhattan.route(this.start, this.end, this.startNormal, this.endNormal, this.MIN_BUFFER);\n\t\tif (this.autoRoute) {\n\t\t\tthis._mergeSegments(pos);\n\t\t\tvar boxes = [], node, startBox, endBox;\n\t\t\tvar container = edge.source.getCommonAncestor(edge.target);\n\t\t\tvar childNodes = container.getDescendants();\n\t\t\tvar index = 0;\n\t\t\tfor (var i = 0; i < childNodes.length; i++) {\n\t\t\t\tnode = childNodes[i];\n\t\t\t\t// Do not include source or target ancestors in routing.\n\t\t\t\tif (node.excludeFromRouting(edge) || node.isAncestor(edge.source) || node.isAncestor(edge.target)) continue;\n\t\t\t\tif (node == edge.source)\n\t\t\t\tstartBox = index;\n\t\t\t\tif (node == edge.target)\n\t\t\t\tendBox = index;\n\t\t\t\tboxes.push(node.getBounds(document));\n\t\t\t\tindex++;\n\t\t\t}\n\t\t\tif (boxes.length > 1)\n\t\t\t\tthis.autoRoute(pos, container.getBounds(document), boxes, startBox, endBox);\n\t\t}\n\t\tManhattan._mergeSegments(pos);\n\t\tif (this.randomNoise && pos.length > 3) {\n\t\t\tfor (var i = 1; i < pos.length - 2; i++) {\n\t\t\t\tvar range = this.randomNoise / this.step;\n\t\t\t\tvar randomNumber = Math.floor(Math.random() * range * 2 - range + 1) * this.step;\n\t\t\t\tthis._moveSegment(pos, i, randomNumber, 1, 1);\n\t\t\t}\n\t\t}\n\t\treturn pos;\n\t}\n\n\t//New function for finding route\n\tstatic route(start, end, startNormal, endNormal, buffer) {\n\t\tvar startBuffer = new Point(start.x + startNormal.x * buffer, start.y + startNormal.y * buffer);\n\t\tvar endBuffer = new Point(end.x + endNormal.x * buffer, end.y + endNormal.y * buffer);\n\t\tvar startBufferNormal, endBufferNormal;\n\t\tvar pts;\n\t\tif (startNormal.x != 0) {\n\t\t\tif ((endBuffer.x - startBuffer.x) / startNormal.x > 0) {\n\t\t\t\tstartBufferNormal = startNormal;\n\t\t\t}\n\t\t\telse {\n\t\t\t\tstartBufferNormal = new Point(0, (endBuffer.y >= startBuffer.y) ? 1 : -1);\n\t\t\t}\n\t\t}\n\t\telse {\n\t\t\tif ((endBuffer.y - startBuffer.y) / startNormal.y > 0) {\n\t\t\t\tstartBufferNormal = startNormal;\n\t\t\t}\n\t\t\telse {\n\t\t\t\tstartBufferNormal = new Point((endBuffer.x >= startBuffer.x) ? 1 : -1, 0);\n\t\t\t}\n\t\t}\n\t\tif (endNormal.x != 0) {\n\t\t\tif ((startBuffer.x - endBuffer.x) / endNormal.x > 0) {\n\t\t\t\tendBufferNormal = endNormal;\n\t\t\t}\n\t\t\telse {\n\t\t\t\tendBufferNormal = new Point(0, (startBuffer.y >= endBuffer.y) ? 1 : -1);\n\t\t\t}\n\t\t}\n\t\telse {\n\t\t\tif ((startBuffer.y - endBuffer.y) / endNormal.y > 0) {\n\t\t\t\tendBufferNormal = endNormal;\n\t\t\t}\n\t\t\telse {\n\t\t\t\tendBufferNormal = new Point((startBuffer.x >= endBuffer.x) ? 1 : -1, 0);\n\t\t\t}\n\t\t}\n\n\t\tif (startBufferNormal.dotProduct(endBufferNormal) == 0) {\n\t\t\tvar middle = (startBufferNormal.x == 0) ? new Point(startBuffer.x, endBuffer.y) : new Point(endBuffer.x, startBuffer.y);\n\t\t\tpts = [start, startBuffer, middle, endBuffer, end];\n\t\t}\n\t\telse if (startBufferNormal.dotProduct(endBufferNormal) < 0) {\n\t\t\tif (startBufferNormal.x == 0) {\n\t\t\t\tpts = [start, startBuffer, new Point(startBuffer.x, (start.y + end.y) / 2), new Point(endBuffer.x, (start.y + end.y) / 2), endBuffer, end];\n\t\t\t}\n\t\t\telse {\n\t\t\t\tpts = [start, startBuffer, new Point((start.x + end.x) / 2, startBuffer.y), new Point((start.x + end.x) / 2, endBuffer.y), endBuffer, end];\n\t\t\t}\n\t\t}\n\t\telse {\n\t\t\tpts = [start, startBuffer, new Point(startBuffer.x + startBufferNormal.x * buffer, startBuffer.y + startBufferNormal.y * buffer), new Point(endBuffer.x + endBufferNormal.x * buffer, endBuffer.y + endBufferNormal.y * buffer), endBuffer, end];\n\t\t}\n\n\t\tvar prunePts = [];\n\t\tprunePts[0] = pts[0];\n\t\tfor (var i = 1; i < pts.length - 1; i++) {\n\t\t\tif ((pts[i].x == pts[i-1].x && pts[i].x == pts[i+1].x) || (pts[i].y == pts[i-1].y && pts[i].y == pts[i+1].y)) {\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tprunePts.push(pts[i]);\n\t\t}\n\t\tprunePts.push(pts[pts.length - 1]);\n\t\treturn prunePts;\n\t}\n\n\t/**\n\t * Automatically route the connection to avoid intersections with other vertices.\n\t */\n\tautoRoute(pts, container, boxes, startBox, endBox) {\n\t\tvar side, side2, d, box, intersect, j;\n\t\tvar channel, channel2, pt, dir;\n\n\t\tvar startPadding = 0, endPadding;\n\t\t// first get the start and end channel\n\t\tbox = boxes[endBox];\n\t\tpt = pts[pts.length - 2];\n\t\tif (pt.y < box.y)\n\t\t\tside = 1;\n\t\telse if (pt.y > box.y + box.height)\n\t\t\tside = 3;\n\t\telse if (pt.x < box.x)\n\t\t\tside = 0;\n\t\telse\n\t\t\tside = 2;\n\t\tchannel = _getChannel(container, endBox, boxes, side);\n\t\tendPadding = channel.horizontal ? (channel.right - channel.left)/2 : (channel.bottom - channel.top)/2;\n\n\t\tfor (var i = 0; i < pts.length - 1; i++) {\n\t\t\tif (pts[i+1].x == pts[i].x && pts[i+1].y == pts[i].y) continue;\n\t\t\tintersect = _getFirstIntersection(pts, i, boxes, startBox, endBox);\n\t\t\tif (!intersect) continue;\n\t\t\tj = intersect[0];\n\t\t\tside = intersect[1];\n\t\t\tbox = boxes[j];\n\t\t\tchannel = _getChannel(container, j, boxes, side);\n\t\t\tswitch(side) {\n\t\t\t\tcase 0:\n\t\t\t\tcase 2:\n\t\t\t\t\tpt = new Point((channel.right + channel.left)/2, pts[i].y);\n\t\t\t\t\tdir = _getRouteTendency(pts, i, pt, box, side);\n\t\t\t\t\tside2 = dir < 0 ? 1 : 3;\n\t\t\t\t\tchannel2 = _getChannel(container, j, boxes, side2);\n\t\t\t\t\t// if the previous point is in the channel2, use that point instead of center of the channel.\n\t\t\t\t\tif (i > 1 && (pts[i-2].y == pts[i-1].y) && (pts[i-1].y > channel2.top && pts[i-1].y < channel2.bottom))\n\t\t\t\t\t\td = pts[i-1].y - pt.y;\n\t\t\t\t\telse if (i < pts.length - 3 && (pts[i+2].y == pts[i+3].y) && (pts[i+2].y > channel2.top && pts[i+2].y < channel2.bottom))\n\t\t\t\t\t\td = pts[i+2].y - pt.y;\n\t\t\t\t\telse\n\t\t\t\t\t\td = (channel2.bottom + channel2.top)/2 - pt.y;\n\t\t\t\t\t// check if we need this pt.\n\t\t\t\t\tif ((side == 0 && pt.x <= pts[i].x) || (side == 2 && pt.x >= pts[i].x))\n\t\t\t\t\t\tpt = null;\n\t\t\t\t\telse if (i > 0) {\n\t\t\t\t\t\t// see if we can push the line out to where we started.\n\t\t\t\t\t\tif (!_hasIntersection(\n\t\t\t\t\t\t\t\t[new Point(pts[i].x, pts[i].y), new Point(pts[i].x, pts[i].y + d), new Point(pt.x, pt.y + d)],\n\t\t\t\t\t\t\t\tboxes))\n\t\t\t\t\t\t\tpt = null;\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tcase 1:\n\t\t\t\tcase 3:\n\t\t\t\t\tpt = new Point(pts[i].x, (channel.bottom + channel.top)/2);\n\t\t\t\t\tdir = _getRouteTendency(pts, i, pt, box, side);\n\t\t\t\t\tside2 = dir < 0 ? 0 : 2;\n\t\t\t\t\tchannel2 = _getChannel(container, j, boxes, side2);\n\t\t\t\t\t// if the previous point is in the channel2, use that point instead of center of the channel.\n\t\t\t\t\tif (i > 1 && (pts[i-2].x == pts[i-1].x) && (pts[i-1].x > channel2.left && pts[i-1].x < channel2.right))\n\t\t\t\t\t\td = pts[i-1].x - pt.x;\n\t\t\t\t\telse if (i < pts.length - 3 && (pts[i+2].x == pts[i+3].x) && (pts[i+2].x > channel2.left && pts[i+2].x < channel2.right))\n\t\t\t\t\t\td = pts[i+2].x - pt.x;\n\t\t\t\t\telse\n\t\t\t\t\t\td = (channel2.right + channel2.left)/2 - pt.x;\n\t\t\t\t\t// check if we need this pt.\n\t\t\t\t\tif ((side == 1 && pt.y <= pts[i].y) || (side == 3 && pt.y >= pts[i].y))\n\t\t\t\t\t\tpt = null;\n\t\t\t\t\telse if (i > 0) {\n\t\t\t\t\t\t// see if we can push the line out to where we started.\n\t\t\t\t\t\tif (!_hasIntersection(\n\t\t\t\t\t\t\t\t[new Point(pts[i].x, pts[i].y), new Point(pts[i].x + d, pts[i].y), new Point(pt.x + d, pt.y)],\n\t\t\t\t\t\t\t\tboxes))\n\t\t\t\t\t\t\tpt = null;\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tcase 4:\n\t\t\t\t\tcontinue;\n\t\t\t}\n\t\t\t// max points.\n\t\t\tif (i > 20) return;\n\t\t\tif (pt && (pt.x != pts[i].x || pt.y != pts[i].y)) {\n\t\t\t\tpts.splice(i+1, 0, pt);\n\t\t\t\t_moveSegment(pts, i+1, d, startPadding, endPadding);\n\t\t\t\ti++;\n\t\t\t} else\n\t\t\t\t_moveSegment(pts, i, d, startPadding, endPadding);\n\t\t}\n\t}\n\n\tstatic _hasIntersection(pts, boxes) {\n\t\tfor (var i = 0; i < pts.length - 1; i++) {\n\t\t\tfor (var j = 0; j < boxes.length; j++) {\n\t\t\t\tif (boxes[j].detectIntersection(pts[i], pts[i+1]) >= 0)\n\t\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t}\n\n\tstatic _getFirstIntersection(pts, i, boxes, startBox, endBox) {\n\t\tvar box, side, savedIndex = null, savedSide = null;\n\t\tfor (var j = 0; j < boxes.length; j++) {\n\t\t\tif ((i == 0 && j == startBox) || (i == pts.length - 2 && j == endBox))\n\t\t\t\tcontinue;\n\t\t\tbox = boxes[j];\n\t\t\tside = box.detectIntersection(pts[i], pts[i+1]);\n\t\t\tif (side >= 0) {\n\t\t\t\tif (savedIndex == null) {\n\t\t\t\t\tsavedIndex = j;\n\t\t\t\t\tsavedSide = side;\n\t\t\t\t} else {\n\t\t\t\t\tif (boxes[savedIndex].distance(pts[i]) > box.distance(pts[i])) {\n\t\t\t\t\t\tsavedIndex = j;\n\t\t\t\t\t\tsavedSide = side;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tif (savedIndex != null)\n\t\t\treturn [savedIndex, savedSide];\n\t\treturn null;\n\t}\n\n\t_getRouteTendency(pts, i, breakPt, box, side) {\n\t\tvar dir;\n\t\tvar p;\n\t\tswitch (side) {\n\t\t\tcase 0:\n\t\t\tcase 2:\n\t\t\t\tp = \"y\";\n\t\t\t\tbreak;\n\t\t\tcase 1:\n\t\t\tcase 3:\n\t\t\t\tp = \"x\";\n\t\t\t\tbreak;\n\t\t}\n\t\t//first try the breakpt.\n\t\tdir = _getRouteDirection(breakPt, pts[pts.length - 1])[p];\n\t\tif (dir == 0) {\n\t\t\tdir = -_getRouteDirection(pts[0], pts[pts.length - 1])[p];\n\t\t\tif (dir == 0) {\n\t\t\t\tif (breakPt[p] < box.getCenter()[p])\n\t\t\t\t\tdir = -1;\n\t\t\t\telse\n\t\t\t\t\tdir = 1;\n\t\t\t}\n\t\t}\n\t\treturn dir;\n\t}\n\n\tstatic _getRouteDirection(pt1, pt2) {\n\t\tif (pt1.x == pt2.x) {\n\t\t\tif (pt1.y < pt2.y) return Point.S;\n\t\t\treturn Point.N;\n\t\t} else if (pt1.y == pt2.y) {\n\t\t\tif (pt1.x < pt2.x) return Point.E;\n\t\t\treturn Point.W;\n\t\t} else if (pt1.x < pt2.x) {\n\t\t\tif (pt1.y < pt2.y) return Point.SE;\n\t\t\treturn Point.NE;\n\t\t} else {\n\t\t\tif (pt1.y < pt2.y) return Point.SW;\n\t\t\treturn Point.NW;\n\t\t}\n\t}\n\n\t_getChannel(container, index, boxes, side) {\n\t\tvar maxChannelWidth = this.maxChannelWidth;\n\t\tvar box1 = boxes[index], box2;\n\t\tvar pt, i;\n\t\tvar channel = {}, l, t, b, r;\n\t\tswitch (side) {\n\t\t\tcase 0:\n\t\t\t\tpt = box1.getLeft();\n\t\t\t\tchannel.right = pt.x;\n\t\t\t\tchannel.horizontal = false;\n\t\t\t\tfor (i = 0; i < boxes.length; i++) {\n\t\t\t\t\tif (i == index) continue;\n\t\t\t\t\tr = boxes[i].getRight().x;\n\t\t\t\t\tif (r >= pt.x) continue;\n\t\t\t\t\tif (!channel.left || channel.left < r)\n\t\t\t\t\t\tchannel.left = r;\n\t\t\t\t}\n\t\t\t\tif (!channel.left) {\n\t\t\t\t\tchannel.left = container.getLeft().x;\n\t\t\t\t\tif (channel.right - channel.left > maxChannelWidth)\n\t\t\t\t\t\tchannel.left = channel.right - maxChannelWidth;\n\t\t\t\t}\n\t\t\t\tfor (i = 0; i < boxes.length; i++) {\n\t\t\t\t\tif (i == index) continue;\n\t\t\t\t\tbox2 = boxes[i];\n\t\t\t\t\tb = box2.getBottom().y;\n\t\t\t\t\tt = box2.getTop().y;\n\t\t\t\t\tif (b < pt.y && (box2.getRight() > channel.left && box2.getLeft() < channel.right)) {\n\t\t\t\t\t\tif (!channel.top || channel.top < b)\n\t\t\t\t\t\t\tchannel.top = b;\n\t\t\t\t\t}\n\t\t\t\t\tif (t > pt.y && (box2.getRight() > channel.left && box2.getLeft() < channel.right)) {\n\t\t\t\t\t\tif (!channel.bottom || channel.bottom > t)\n\t\t\t\t\t\t\tchannel.bottom = t;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (!channel.top) channel.top = container.getTop().y;\n\t\t\t\tif (!channel.bottom) channel.bottom = container.getBottom().y;\n\t\t\t\tbreak;\n\t\t\tcase 1:\n\t\t\t\tpt = box1.getTop();\n\t\t\t\tchannel.horizontal = true;\n\t\t\t\tchannel.bottom = pt.y;\n\t\t\t\tfor (i = 0; i < boxes.length; i++) {\n\t\t\t\t\tif (i == index) continue;\n\t\t\t\t\tb = boxes[i].getBottom().y;\n\t\t\t\t\tif (b >= pt.y) continue;\n\t\t\t\t\tif (!channel.top || channel.top < b)\n\t\t\t\t\t\tchannel.top = b;\n\t\t\t\t}\n\t\t\t\tif (!channel.top) {\n\t\t\t\t\tchannel.top = container.getTop().y;\n\t\t\t\t\tif (channel.bottom - channel.top > maxChannelWidth)\n\t\t\t\t\t\tchannel.top = channel.bottom - maxChannelWidth;\n\t\t\t\t}\n\t\t\t\tfor (i = 0; i < boxes.length; i++) {\n\t\t\t\t\tif (i == index) continue;\n\t\t\t\t\tbox2 = boxes[i];\n\t\t\t\t\tl = box2.getLeft().x;\n\t\t\t\t\tr = box2.getRight().x;\n\t\t\t\t\tif (r < pt.x && (box2.getBottom() > channel.top && box2.getTop() < channel.bottom)) {\n\t\t\t\t\t\tif (!channel.left || channel.left < r)\n\t\t\t\t\t\t\tchannel.left = r;\n\t\t\t\t\t}\n\t\t\t\t\tif (l > pt.x && (box2.getBottom() > channel.top && box2.getTop() < channel.bottom)) {\n\t\t\t\t\t\tif (!channel.right || channel.right > l)\n\t\t\t\t\t\t\tchannel.right = l;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (!channel.left) channel.left = container.getLeft().x;\n\t\t\t\tif (!channel.right) channel.right = container.getRight().x;\n\n\t\t\t\tbreak;\n\t\t\tcase 2:\n\t\t\t\tpt = box1.getRight();\n\t\t\t\tchannel.horizontal = false;\n\t\t\t\tchannel.left = pt.x;\n\t\t\t\tfor (i = 0; i < boxes.length; i++) {\n\t\t\t\t\tif (i == index) continue;\n\t\t\t\t\tl = boxes[i].getLeft().x;\n\t\t\t\t\tif (l <= pt.x) continue;\n\t\t\t\t\tif (!channel.right || channel.right > l)\n\t\t\t\t\t\tchannel.right = l;\n\t\t\t\t}\n\t\t\t\tif (!channel.right) {\n\t\t\t\t\tchannel.right = container.getRight().x;\n\t\t\t\t\tif (channel.right - channel.left > maxChannelWidth)\n\t\t\t\t\t\tchannel.right = channel.left + maxChannelWidth;\n\t\t\t\t}\n\t\t\t\tfor (i = 0; i < boxes.length; i++) {\n\t\t\t\t\tif (i == index) continue;\n\t\t\t\t\tbox2 = boxes[i];\n\t\t\t\t\tb = box2.getBottom().y;\n\t\t\t\t\tt = box2.getTop().y;\n\t\t\t\t\tif (b < pt.y && (box2.getRight() > channel.left && box2.getLeft() < channel.right)) {\n\t\t\t\t\t\tif (!channel.top || channel.top < b)\n\t\t\t\t\t\t\tchannel.top = b;\n\t\t\t\t\t}\n\t\t\t\t\tif (t > pt.y && (box2.getRight() > channel.left && box2.getLeft() < channel.right)) {\n\t\t\t\t\t\tif (!channel.bottom || channel.bottom > t)\n\t\t\t\t\t\t\tchannel.bottom = t;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (!channel.top) channel.top = container.getTop().y;\n\t\t\t\tif (!channel.bottom) channel.bottom = container.getBottom().y;\n\t\t\t\tbreak;\n\t\t\tcase 3:\n\t\t\t\tpt = box1.getBottom();\n\t\t\t\tchannel.horizontal = true;\n\t\t\t\tchannel.top = pt.y;\n\t\t\t\tfor (i = 0; i < boxes.length; i++) {\n\t\t\t\t\tif (i == index) continue;\n\t\t\t\t\tbox2 = boxes[i];\n\t\t\t\t\tif (box2.getTop().y <= pt.y) continue;\n\t\t\t\t\tif (!channel.bottom || channel.bottom > box2.getTop().y)\n\t\t\t\t\t\tchannel.bottom = box2.getTop().y;\n\t\t\t\t}\n\t\t\t\tif (!channel.bottom) {\n\t\t\t\t\tchannel.bottom = container.getBottom().y;\n\t\t\t\t\tif (channel.bottom - channel.top > maxChannelWidth)\n\t\t\t\t\t\tchannel.bottom = channel.top + maxChannelWidth;\n\t\t\t\t}\n\t\t\t\tfor (i = 0; i < boxes.length; i++) {\n\t\t\t\t\tif (i == index) continue;\n\t\t\t\t\tbox2 = boxes[i];\n\t\t\t\t\tl = box2.getLeft().x;\n\t\t\t\t\tr = box2.getRight().x;\n\t\t\t\t\tif (r < pt.x && (box2.getBottom() > channel.top && box2.getTop() < channel.bottom)) {\n\t\t\t\t\t\tif (!channel.left || channel.left < r)\n\t\t\t\t\t\t\tchannel.left = r;\n\t\t\t\t\t}\n\t\t\t\t\tif (l > pt.x && (box2.getBottom() > channel.top && box2.getTop() < channel.bottom)) {\n\t\t\t\t\t\tif (!channel.right || channel.right > l)\n\t\t\t\t\t\t\tchannel.right = l;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (!channel.left) channel.left = container.getLeft().x;\n\t\t\t\tif (!channel.right) channel.right = container.getRight().x;\n\t\t\t\tbreak;\n\t\t}\n\t\treturn channel;\n\t}\n\n\t/**\n\t * Move a line segment by a specified distance.\n\t *\n\t * @param pts the list of points.\n\t * @param i the index of the segment.\n\t * @param d the distance to move.\n\t * @param startPadding\n\t * @param endPadding\n\t */\n\t_moveSegment(pts, i, d, startPadding, endPadding) {\n\t\t// first check if we need to add new line segments.\n\t\tvar dir, l, pt;\n\t\tif (i == 0) {\n\t\t\t// we need to break off the segment, since we can't change the starting point.\n\t\t\tdir = pts[0].getDirection(pts[1]);\n\t\t\tif (!startPadding)\n\t\t\t\tstartPadding = this.MIN_BUFFER;\n\t\t\tl = Math.min(startPadding, pts[0].distance(pts[1])/2);\n\t\t\tpt = pts[0].getTranslated(dir.scale(l));\n\t\t\tpts.splice(1, 0, pt);\n\t\t\tthis._moveSegment(pts, i+1, d);\n\t\t\treturn;\n\t\t}\n\t\tif (i == pts.length - 2) {\n\t\t\t// we need to break off the segment, since we can't change the end point.\n\t\t\tdir = pts[pts.length-1].getDirection(pts[pts.length-2]);\n\t\t\tif (!endPadding)\n\t\t\t\tendPadding = this.MIN_BUFFER;\n\t\t\tl = Math.min(endPadding, pts[pts.length-1].distance(pts[pts.length-2])/2);\n\t\t\tpt = pts[pts.length - 1].getTranslated(dir.scale(l));\n\t\t\tpts.splice(pts.length - 1, 0, pt);\n\t\t\tthis._moveSegment(pts, i, d);\n\t\t\treturn;\n\t\t}\n\n\t\tif (pts[i].y == pts[i+1].y) {\n\t\t\tif (i > 0 && pts[i - 1].y == pts[i].y) {\n\t\t\t\tpts.splice(i + 1, 0, pts[i].clone());\n\t\t\t\ti++;\n\t\t\t}\n\t\t\tif (i < pts.length - 2 && pts[i+1].y == pts[i+2].y)\n\t\t\t\tpts.splice(i + 1, 0, pts[i+1].clone());\n\t\t\tpts[i].y += d;\n\t\t\tpts[i+1].y += d;\n\t\t} else {\n\t\t\tif (i > 0 && pts[i - 1].x == pts[i].x) {\n\t\t\t\tpts.splice(i + 1, 0, pts[i].clone());\n\t\t\t\ti++;\n\t\t\t}\n\t\t\tif (i < pts.length - 2 && pts[i+1].x == pts[i+2].x)\n\t\t\t\tpts.splice(i + 1, 0, pts[i+1].clone());\n\t\t\tpts[i].x += d;\n\t\t\tpts[i+1].x += d;\n\t\t}\n\t}\n\n\t/**\n\t * This method will merge the redundant segments.\n\t */\n\tstatic _mergeSegments(pts) {\n\t\tvar h1 = pts[pts.length-1].y == pts[pts.length-2].y;\n\t\tvar h2;\n\t\tfor (var i = pts.length - 2; i >= 1; i--) {\n\t\t\th2 = pts[i].y == pts[i-1].y;\n\t\t\tif (h2 == h1 || (pts[i].equals(pts[i-1])))\n\t\t\t\tpts.splice(i, 1);\n\t\t\telse\n\t\t\t\th1 = !h1;\n\t\t}\n\t}\n}\n\nlinkTypes['direct'] = DirectLink;\nlinkTypes['bezier'] = BezierLink;\nlinkTypes['entityRelations'] = EntityRelations;\nlinkTypes['manhattan'] = Manhattan;\n\nexport default Link;\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/geometry/Link.js\n **/","/*!\n  * Bean - copyright (c) Jacob Thornton 2011-2012\n  * https://github.com/fat/bean\n  * MIT license\n  */\n(function (name, context, definition) {\n  if (typeof module != 'undefined' && module.exports) module.exports = definition()\n  else if (typeof define == 'function' && define.amd) define(definition)\n  else context[name] = definition()\n})('bean', this, function (name, context) {\n  name    = name    || 'bean'\n  context = context || this\n\n  var win            = window\n    , old            = context[name]\n    , namespaceRegex = /[^\\.]*(?=\\..*)\\.|.*/\n    , nameRegex      = /\\..*/\n    , addEvent       = 'addEventListener'\n    , removeEvent    = 'removeEventListener'\n    , doc            = document || {}\n    , root           = doc.documentElement || {}\n    , W3C_MODEL      = root[addEvent]\n    , eventSupport   = W3C_MODEL ? addEvent : 'attachEvent'\n    , ONE            = {} // singleton for quick matching making add() do one()\n\n    , slice          = Array.prototype.slice\n    , str2arr        = function (s, d) { return s.split(d || ' ') }\n    , isString       = function (o) { return typeof o == 'string' }\n    , isFunction     = function (o) { return typeof o == 'function' }\n\n      // events that we consider to be 'native', anything not in this list will\n      // be treated as a custom event\n    , standardNativeEvents =\n        'click dblclick mouseup mousedown contextmenu '                  + // mouse buttons\n        'mousewheel mousemultiwheel DOMMouseScroll '                     + // mouse wheel\n        'mouseover mouseout mousemove selectstart selectend '            + // mouse movement\n        'keydown keypress keyup '                                        + // keyboard\n        'orientationchange '                                             + // mobile\n        'focus blur change reset select submit '                         + // form elements\n        'load unload beforeunload resize move DOMContentLoaded '         + // window\n        'readystatechange message '                                      + // window\n        'error abort scroll '                                              // misc\n      // element.fireEvent('onXYZ'... is not forgiving if we try to fire an event\n      // that doesn't actually exist, so make sure we only do these on newer browsers\n    , w3cNativeEvents =\n        'show '                                                          + // mouse buttons\n        'input invalid '                                                 + // form elements\n        'touchstart touchmove touchend touchcancel '                     + // touch\n        'gesturestart gesturechange gestureend '                         + // gesture\n        'textinput '                                                     + // TextEvent\n        'readystatechange pageshow pagehide popstate '                   + // window\n        'hashchange offline online '                                     + // window\n        'afterprint beforeprint '                                        + // printing\n        'dragstart dragenter dragover dragleave drag drop dragend '      + // dnd\n        'loadstart progress suspend emptied stalled loadmetadata '       + // media\n        'loadeddata canplay canplaythrough playing waiting seeking '     + // media\n        'seeked ended durationchange timeupdate play pause ratechange '  + // media\n        'volumechange cuechange '                                        + // media\n        'checking noupdate downloading cached updateready obsolete '       // appcache\n\n      // convert to a hash for quick lookups\n    , nativeEvents = (function (hash, events, i) {\n        for (i = 0; i < events.length; i++) events[i] && (hash[events[i]] = 1)\n        return hash\n      }({}, str2arr(standardNativeEvents + (W3C_MODEL ? w3cNativeEvents : ''))))\n\n      // custom events are events that we *fake*, they are not provided natively but\n      // we can use native events to generate them\n    , customEvents = (function () {\n        var isAncestor = 'compareDocumentPosition' in root\n              ? function (element, container) {\n                  return container.compareDocumentPosition && (container.compareDocumentPosition(element) & 16) === 16\n                }\n              : 'contains' in root\n                ? function (element, container) {\n                    container = container.nodeType === 9 || container === window ? root : container\n                    return container !== element && container.contains(element)\n                  }\n                : function (element, container) {\n                    while (element = element.parentNode) if (element === container) return 1\n                    return 0\n                  }\n          , check = function (event) {\n              var related = event.relatedTarget\n              return !related\n                ? related == null\n                : (related !== this && related.prefix !== 'xul' && !/document/.test(this.toString())\n                    && !isAncestor(related, this))\n            }\n\n        return {\n            mouseenter: { base: 'mouseover', condition: check }\n          , mouseleave: { base: 'mouseout', condition: check }\n          , mousewheel: { base: /Firefox/.test(navigator.userAgent) ? 'DOMMouseScroll' : 'mousewheel' }\n        }\n      }())\n\n      // we provide a consistent Event object across browsers by taking the actual DOM\n      // event object and generating a new one from its properties.\n    , Event = (function () {\n            // a whitelist of properties (for different event types) tells us what to check for and copy\n        var commonProps  = str2arr('altKey attrChange attrName bubbles cancelable ctrlKey currentTarget ' +\n              'detail eventPhase getModifierState isTrusted metaKey relatedNode relatedTarget shiftKey '  +\n              'srcElement target timeStamp type view which propertyName')\n          , mouseProps   = commonProps.concat(str2arr('button buttons clientX clientY dataTransfer '      +\n              'fromElement offsetX offsetY pageX pageY screenX screenY toElement'))\n          , mouseWheelProps = mouseProps.concat(str2arr('wheelDelta wheelDeltaX wheelDeltaY wheelDeltaZ ' +\n              'axis')) // 'axis' is FF specific\n          , keyProps     = commonProps.concat(str2arr('char charCode key keyCode keyIdentifier '          +\n              'keyLocation location'))\n          , textProps    = commonProps.concat(str2arr('data'))\n          , touchProps   = commonProps.concat(str2arr('touches targetTouches changedTouches scale rotation'))\n          , messageProps = commonProps.concat(str2arr('data origin source'))\n          , stateProps   = commonProps.concat(str2arr('state'))\n          , overOutRegex = /over|out/\n            // some event types need special handling and some need special properties, do that all here\n          , typeFixers   = [\n                { // key events\n                    reg: /key/i\n                  , fix: function (event, newEvent) {\n                      newEvent.keyCode = event.keyCode || event.which\n                      return keyProps\n                    }\n                }\n              , { // mouse events\n                    reg: /click|mouse(?!(.*wheel|scroll))|menu|drag|drop/i\n                  , fix: function (event, newEvent, type) {\n                      newEvent.rightClick = event.which === 3 || event.button === 2\n                      newEvent.pos = { x: 0, y: 0 }\n                      if (event.pageX || event.pageY) {\n                        newEvent.clientX = event.pageX\n                        newEvent.clientY = event.pageY\n                      } else if (event.clientX || event.clientY) {\n                        newEvent.clientX = event.clientX + doc.body.scrollLeft + root.scrollLeft\n                        newEvent.clientY = event.clientY + doc.body.scrollTop + root.scrollTop\n                      }\n                      if (overOutRegex.test(type)) {\n                        newEvent.relatedTarget = event.relatedTarget\n                          || event[(type == 'mouseover' ? 'from' : 'to') + 'Element']\n                      }\n                      return mouseProps\n                    }\n                }\n              , { // mouse wheel events\n                    reg: /mouse.*(wheel|scroll)/i\n                  , fix: function () { return mouseWheelProps }\n                }\n              , { // TextEvent\n                    reg: /^text/i\n                  , fix: function () { return textProps }\n                }\n              , { // touch and gesture events\n                    reg: /^touch|^gesture/i\n                  , fix: function () { return touchProps }\n                }\n              , { // message events\n                    reg: /^message$/i\n                  , fix: function () { return messageProps }\n                }\n              , { // popstate events\n                    reg: /^popstate$/i\n                  , fix: function () { return stateProps }\n                }\n              , { // everything else\n                    reg: /.*/\n                  , fix: function () { return commonProps }\n                }\n            ]\n          , typeFixerMap = {} // used to map event types to fixer functions (above), a basic cache mechanism\n\n          , Event = function (event, element, isNative) {\n              if (!arguments.length) return\n              event = event || ((element.ownerDocument || element.document || element).parentWindow || win).event\n              this.originalEvent = event\n              this.isNative       = isNative\n              this.isBean         = true\n\n              if (!event) return\n\n              var type   = event.type\n                , target = event.target || event.srcElement\n                , i, l, p, props, fixer\n\n              this.target = target && target.nodeType === 3 ? target.parentNode : target\n\n              if (isNative) { // we only need basic augmentation on custom events, the rest expensive & pointless\n                fixer = typeFixerMap[type]\n                if (!fixer) { // haven't encountered this event type before, map a fixer function for it\n                  for (i = 0, l = typeFixers.length; i < l; i++) {\n                    if (typeFixers[i].reg.test(type)) { // guaranteed to match at least one, last is .*\n                      typeFixerMap[type] = fixer = typeFixers[i].fix\n                      break\n                    }\n                  }\n                }\n\n                props = fixer(event, this, type)\n                for (i = props.length; i--;) {\n                  if (!((p = props[i]) in this) && p in event) this[p] = event[p]\n                }\n              }\n            }\n\n        // preventDefault() and stopPropagation() are a consistent interface to those functions\n        // on the DOM, stop() is an alias for both of them together\n        Event.prototype.preventDefault = function () {\n          if (this.originalEvent.preventDefault) this.originalEvent.preventDefault()\n          else this.originalEvent.returnValue = false\n        }\n        Event.prototype.stopPropagation = function () {\n          if (this.originalEvent.stopPropagation) this.originalEvent.stopPropagation()\n          else this.originalEvent.cancelBubble = true\n        }\n        Event.prototype.stop = function () {\n          this.preventDefault()\n          this.stopPropagation()\n          this.stopped = true\n        }\n        // stopImmediatePropagation() has to be handled internally because we manage the event list for\n        // each element\n        // note that originalElement may be a Bean#Event object in some situations\n        Event.prototype.stopImmediatePropagation = function () {\n          if (this.originalEvent.stopImmediatePropagation) this.originalEvent.stopImmediatePropagation()\n          this.isImmediatePropagationStopped = function () { return true }\n        }\n        Event.prototype.isImmediatePropagationStopped = function () {\n          return this.originalEvent.isImmediatePropagationStopped && this.originalEvent.isImmediatePropagationStopped()\n        }\n        Event.prototype.clone = function (currentTarget) {\n          //TODO: this is ripe for optimisation, new events are *expensive*\n          // improving this will speed up delegated events\n          var ne = new Event(this, this.element, this.isNative)\n          ne.currentTarget = currentTarget\n          return ne\n        }\n\n        return Event\n      }())\n\n      // if we're in old IE we can't do onpropertychange on doc or win so we use doc.documentElement for both\n    , targetElement = function (element, isNative) {\n        return !W3C_MODEL && !isNative && (element === doc || element === win) ? root : element\n      }\n\n      /**\n        * Bean maintains an internal registry for event listeners. We don't touch elements, objects\n        * or functions to identify them, instead we store everything in the registry.\n        * Each event listener has a RegEntry object, we have one 'registry' for the whole instance.\n        */\n    , RegEntry = (function () {\n        // each handler is wrapped so we can handle delegation and custom events\n        var wrappedHandler = function (element, fn, condition, args) {\n            var call = function (event, eargs) {\n                  return fn.apply(element, args ? slice.call(eargs, event ? 0 : 1).concat(args) : eargs)\n                }\n              , findTarget = function (event, eventElement) {\n                  return fn.__beanDel ? fn.__beanDel.ft(event.target, element) : eventElement\n                }\n              , handler = condition\n                  ? function (event) {\n                      var target = findTarget(event, this) // deleated event\n                      if (condition.apply(target, arguments)) {\n                        if (event) event.currentTarget = target\n                        return call(event, arguments)\n                      }\n                    }\n                  : function (event) {\n                      if (fn.__beanDel) event = event.clone(findTarget(event)) // delegated event, fix the fix\n                      return call(event, arguments)\n                    }\n            handler.__beanDel = fn.__beanDel\n            return handler\n          }\n\n        , RegEntry = function (element, type, handler, original, namespaces, args, root) {\n            var customType     = customEvents[type]\n              , isNative\n\n            if (type == 'unload') {\n              // self clean-up\n              handler = once(removeListener, element, type, handler, original)\n            }\n\n            if (customType) {\n              if (customType.condition) {\n                handler = wrappedHandler(element, handler, customType.condition, args)\n              }\n              type = customType.base || type\n            }\n\n            this.isNative      = isNative = nativeEvents[type] && !!element[eventSupport]\n            this.customType    = !W3C_MODEL && !isNative && type\n            this.element       = element\n            this.type          = type\n            this.original      = original\n            this.namespaces    = namespaces\n            this.eventType     = W3C_MODEL || isNative ? type : 'propertychange'\n            this.target        = targetElement(element, isNative)\n            this[eventSupport] = !!this.target[eventSupport]\n            this.root          = root\n            this.handler       = wrappedHandler(element, handler, null, args)\n          }\n\n        // given a list of namespaces, is our entry in any of them?\n        RegEntry.prototype.inNamespaces = function (checkNamespaces) {\n          var i, j, c = 0\n          if (!checkNamespaces) return true\n          if (!this.namespaces) return false\n          for (i = checkNamespaces.length; i--;) {\n            for (j = this.namespaces.length; j--;) {\n              if (checkNamespaces[i] == this.namespaces[j]) c++\n            }\n          }\n          return checkNamespaces.length === c\n        }\n\n        // match by element, original fn (opt), handler fn (opt)\n        RegEntry.prototype.matches = function (checkElement, checkOriginal, checkHandler) {\n          return this.element === checkElement &&\n            (!checkOriginal || this.original === checkOriginal) &&\n            (!checkHandler || this.handler === checkHandler)\n        }\n\n        return RegEntry\n      }())\n\n    , registry = (function () {\n        // our map stores arrays by event type, just because it's better than storing\n        // everything in a single array.\n        // uses '$' as a prefix for the keys for safety and 'r' as a special prefix for\n        // rootListeners so we can look them up fast\n        var map = {}\n\n          // generic functional search of our registry for matching listeners,\n          // `fn` returns false to break out of the loop\n          , forAll = function (element, type, original, handler, root, fn) {\n              var pfx = root ? 'r' : '$'\n              if (!type || type == '*') {\n                // search the whole registry\n                for (var t in map) {\n                  if (t.charAt(0) == pfx) {\n                    forAll(element, t.substr(1), original, handler, root, fn)\n                  }\n                }\n              } else {\n                var i = 0, l, list = map[pfx + type], all = element == '*'\n                if (!list) return\n                for (l = list.length; i < l; i++) {\n                  if ((all || list[i].matches(element, original, handler)) && !fn(list[i], list, i, type)) return\n                }\n              }\n            }\n\n          , has = function (element, type, original, root) {\n              // we're not using forAll here simply because it's a bit slower and this\n              // needs to be fast\n              var i, list = map[(root ? 'r' : '$') + type]\n              if (list) {\n                for (i = list.length; i--;) {\n                  if (!list[i].root && list[i].matches(element, original, null)) return true\n                }\n              }\n              return false\n            }\n\n          , get = function (element, type, original, root) {\n              var entries = []\n              forAll(element, type, original, null, root, function (entry) {\n                return entries.push(entry)\n              })\n              return entries\n            }\n\n          , put = function (entry) {\n              var has = !entry.root && !this.has(entry.element, entry.type, null, false)\n                , key = (entry.root ? 'r' : '$') + entry.type\n              ;(map[key] || (map[key] = [])).push(entry)\n              return has\n            }\n\n          , del = function (entry) {\n              forAll(entry.element, entry.type, null, entry.handler, entry.root, function (entry, list, i) {\n                list.splice(i, 1)\n                entry.removed = true\n                if (list.length === 0) delete map[(entry.root ? 'r' : '$') + entry.type]\n                return false\n              })\n            }\n\n            // dump all entries, used for onunload\n          , entries = function () {\n              var t, entries = []\n              for (t in map) {\n                if (t.charAt(0) == '$') entries = entries.concat(map[t])\n              }\n              return entries\n            }\n\n        return { has: has, get: get, put: put, del: del, entries: entries }\n      }())\n\n      // we need a selector engine for delegated events, use querySelectorAll if it exists\n      // but for older browsers we need Qwery, Sizzle or similar\n    , selectorEngine\n    , setSelectorEngine = function (e) {\n        if (!arguments.length) {\n          selectorEngine = doc.querySelectorAll\n            ? function (s, r) {\n                return r.querySelectorAll(s)\n              }\n            : function () {\n                throw new Error('Bean: No selector engine installed') // eeek\n              }\n        } else {\n          selectorEngine = e\n        }\n      }\n\n      // we attach this listener to each DOM event that we need to listen to, only once\n      // per event type per DOM element\n    , rootListener = function (event, type) {\n        if (!W3C_MODEL && type && event && event.propertyName != '_on' + type) return\n\n        var listeners = registry.get(this, type || event.type, null, false)\n          , l = listeners.length\n          , i = 0\n\n        event = new Event(event, this, true)\n        if (type) event.type = type\n\n        // iterate through all handlers registered for this type, calling them unless they have\n        // been removed by a previous handler or stopImmediatePropagation() has been called\n        for (; i < l && !event.isImmediatePropagationStopped(); i++) {\n          if (!listeners[i].removed) listeners[i].handler.call(this, event)\n        }\n      }\n\n      // add and remove listeners to DOM elements\n    , listener = W3C_MODEL\n        ? function (element, type, add) {\n            // new browsers\n            element[add ? addEvent : removeEvent](type, rootListener, false)\n          }\n        : function (element, type, add, custom) {\n            // IE8 and below, use attachEvent/detachEvent and we have to piggy-back propertychange events\n            // to simulate event bubbling etc.\n            var entry\n            if (add) {\n              registry.put(entry = new RegEntry(\n                  element\n                , custom || type\n                , function (event) { // handler\n                    rootListener.call(element, event, custom)\n                  }\n                , rootListener\n                , null\n                , null\n                , true // is root\n              ))\n              if (custom && element['_on' + custom] == null) element['_on' + custom] = 0\n              entry.target.attachEvent('on' + entry.eventType, entry.handler)\n            } else {\n              entry = registry.get(element, custom || type, rootListener, true)[0]\n              if (entry) {\n                entry.target.detachEvent('on' + entry.eventType, entry.handler)\n                registry.del(entry)\n              }\n            }\n          }\n\n    , once = function (rm, element, type, fn, originalFn) {\n        // wrap the handler in a handler that does a remove as well\n        return function () {\n          fn.apply(this, arguments)\n          rm(element, type, originalFn)\n        }\n      }\n\n    , removeListener = function (element, orgType, handler, namespaces) {\n        var type     = orgType && orgType.replace(nameRegex, '')\n          , handlers = registry.get(element, type, null, false)\n          , removed  = {}\n          , i, l\n\n        for (i = 0, l = handlers.length; i < l; i++) {\n          if ((!handler || handlers[i].original === handler) && handlers[i].inNamespaces(namespaces)) {\n            // TODO: this is problematic, we have a registry.get() and registry.del() that\n            // both do registry searches so we waste cycles doing this. Needs to be rolled into\n            // a single registry.forAll(fn) that removes while finding, but the catch is that\n            // we'll be splicing the arrays that we're iterating over. Needs extra tests to\n            // make sure we don't screw it up. @rvagg\n            registry.del(handlers[i])\n            if (!removed[handlers[i].eventType] && handlers[i][eventSupport])\n              removed[handlers[i].eventType] = { t: handlers[i].eventType, c: handlers[i].type }\n          }\n        }\n        // check each type/element for removed listeners and remove the rootListener where it's no longer needed\n        for (i in removed) {\n          if (!registry.has(element, removed[i].t, null, false)) {\n            // last listener of this type, remove the rootListener\n            listener(element, removed[i].t, false, removed[i].c)\n          }\n        }\n      }\n\n      // set up a delegate helper using the given selector, wrap the handler function\n    , delegate = function (selector, fn) {\n        //TODO: findTarget (therefore $) is called twice, once for match and once for\n        // setting e.currentTarget, fix this so it's only needed once\n        var findTarget = function (target, root) {\n              var i, array = isString(selector) ? selectorEngine(selector, root) : selector\n              for (; target && target !== root; target = target.parentNode) {\n                for (i = array.length; i--;) {\n                  if (array[i] === target) return target\n                }\n              }\n            }\n          , handler = function (e) {\n              var match = findTarget(e.target, this)\n              if (match) fn.apply(match, arguments)\n            }\n\n        // __beanDel isn't pleasant but it's a private function, not exposed outside of Bean\n        handler.__beanDel = {\n            ft       : findTarget // attach it here for customEvents to use too\n          , selector : selector\n        }\n        return handler\n      }\n\n    , fireListener = W3C_MODEL ? function (isNative, type, element) {\n        // modern browsers, do a proper dispatchEvent()\n        var evt = doc.createEvent(isNative ? 'HTMLEvents' : 'UIEvents')\n        evt[isNative ? 'initEvent' : 'initUIEvent'](type, true, true, win, 1)\n        element.dispatchEvent(evt)\n      } : function (isNative, type, element) {\n        // old browser use onpropertychange, just increment a custom property to trigger the event\n        element = targetElement(element, isNative)\n        isNative ? element.fireEvent('on' + type, doc.createEventObject()) : element['_on' + type]++\n      }\n\n      /**\n        * Public API: off(), on(), add(), (remove()), one(), fire(), clone()\n        */\n\n      /**\n        * off(element[, eventType(s)[, handler ]])\n        */\n    , off = function (element, typeSpec, fn) {\n        var isTypeStr = isString(typeSpec)\n          , k, type, namespaces, i\n\n        if (isTypeStr && typeSpec.indexOf(' ') > 0) {\n          // off(el, 't1 t2 t3', fn) or off(el, 't1 t2 t3')\n          typeSpec = str2arr(typeSpec)\n          for (i = typeSpec.length; i--;)\n            off(element, typeSpec[i], fn)\n          return element\n        }\n\n        type = isTypeStr && typeSpec.replace(nameRegex, '')\n        if (type && customEvents[type]) type = customEvents[type].base\n\n        if (!typeSpec || isTypeStr) {\n          // off(el) or off(el, t1.ns) or off(el, .ns) or off(el, .ns1.ns2.ns3)\n          if (namespaces = isTypeStr && typeSpec.replace(namespaceRegex, '')) namespaces = str2arr(namespaces, '.')\n          removeListener(element, type, fn, namespaces)\n        } else if (isFunction(typeSpec)) {\n          // off(el, fn)\n          removeListener(element, null, typeSpec)\n        } else {\n          // off(el, { t1: fn1, t2, fn2 })\n          for (k in typeSpec) {\n            if (typeSpec.hasOwnProperty(k)) off(element, k, typeSpec[k])\n          }\n        }\n\n        return element\n      }\n\n      /**\n        * on(element, eventType(s)[, selector], handler[, args ])\n        */\n    , on = function(element, events, selector, fn) {\n        var originalFn, type, types, i, args, entry, first\n\n        //TODO: the undefined check means you can't pass an 'args' argument, fix this perhaps?\n        if (selector === undefined && typeof events == 'object') {\n          //TODO: this can't handle delegated events\n          for (type in events) {\n            if (events.hasOwnProperty(type)) {\n              on.call(this, element, type, events[type])\n            }\n          }\n          return\n        }\n\n        if (!isFunction(selector)) {\n          // delegated event\n          originalFn = fn\n          args       = slice.call(arguments, 4)\n          fn         = delegate(selector, originalFn, selectorEngine)\n        } else {\n          args       = slice.call(arguments, 3)\n          fn         = originalFn = selector\n        }\n\n        types = str2arr(events)\n\n        // special case for one(), wrap in a self-removing handler\n        if (this === ONE) {\n          fn = once(off, element, events, fn, originalFn)\n        }\n\n        for (i = types.length; i--;) {\n          // add new handler to the registry and check if it's the first for this element/type\n          first = registry.put(entry = new RegEntry(\n              element\n            , types[i].replace(nameRegex, '') // event type\n            , fn\n            , originalFn\n            , str2arr(types[i].replace(namespaceRegex, ''), '.') // namespaces\n            , args\n            , false // not root\n          ))\n          if (entry[eventSupport] && first) {\n            // first event of this type on this element, add root listener\n            listener(element, entry.eventType, true, entry.customType)\n          }\n        }\n\n        return element\n      }\n\n      /**\n        * add(element[, selector], eventType(s), handler[, args ])\n        *\n        * Deprecated: kept (for now) for backward-compatibility\n        */\n    , add = function (element, events, fn, delfn) {\n        return on.apply(\n            null\n          , !isString(fn)\n              ? slice.call(arguments)\n              : [ element, fn, events, delfn ].concat(arguments.length > 3 ? slice.call(arguments, 5) : [])\n        )\n      }\n\n      /**\n        * one(element, eventType(s)[, selector], handler[, args ])\n        */\n    , one = function () {\n        return on.apply(ONE, arguments)\n      }\n\n      /**\n        * fire(element, eventType(s)[, args ])\n        *\n        * The optional 'args' argument must be an array, if no 'args' argument is provided\n        * then we can use the browser's DOM event system, otherwise we trigger handlers manually\n        */\n    , fire = function (element, type, args) {\n        var types = str2arr(type)\n          , i, j, l, names, handlers\n\n        for (i = types.length; i--;) {\n          type = types[i].replace(nameRegex, '')\n          if (names = types[i].replace(namespaceRegex, '')) names = str2arr(names, '.')\n          if (!names && !args && element[eventSupport]) {\n            fireListener(nativeEvents[type], type, element)\n          } else {\n            // non-native event, either because of a namespace, arguments or a non DOM element\n            // iterate over all listeners and manually 'fire'\n            handlers = registry.get(element, type, null, false)\n            args = [false].concat(args)\n            for (j = 0, l = handlers.length; j < l; j++) {\n              if (handlers[j].inNamespaces(names)) {\n                handlers[j].handler.apply(element, args)\n              }\n            }\n          }\n        }\n        return element\n      }\n\n      /**\n        * clone(dstElement, srcElement[, eventType ])\n        *\n        * TODO: perhaps for consistency we should allow the same flexibility in type specifiers?\n        */\n    , clone = function (element, from, type) {\n        var handlers = registry.get(from, type, null, false)\n          , l = handlers.length\n          , i = 0\n          , args, beanDel\n\n        for (; i < l; i++) {\n          if (handlers[i].original) {\n            args = [ element, handlers[i].type ]\n            if (beanDel = handlers[i].handler.__beanDel) args.push(beanDel.selector)\n            args.push(handlers[i].original)\n            on.apply(null, args)\n          }\n        }\n        return element\n      }\n\n    , bean = {\n          'on'                : on\n        , 'add'               : add\n        , 'one'               : one\n        , 'off'               : off\n        , 'remove'            : off\n        , 'clone'             : clone\n        , 'fire'              : fire\n        , 'Event'             : Event\n        , 'setSelectorEngine' : setSelectorEngine\n        , 'noConflict'        : function () {\n            context[name] = old\n            return this\n          }\n      }\n\n  // for IE, clean up on unload to avoid leaks\n  if (win.attachEvent) {\n    var cleanup = function () {\n      var i, entries = registry.entries()\n      for (i in entries) {\n        if (entries[i].type && entries[i].type !== 'unload') off(entries[i].element, entries[i].type)\n      }\n      win.detachEvent('onunload', cleanup)\n      win.CollectGarbage && win.CollectGarbage()\n    }\n    win.attachEvent('onunload', cleanup)\n  }\n\n  // initialize selector engine to internal default (qSA or throw Error)\n  setSelectorEngine()\n\n  return bean\n});\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/bean/bean.js\n ** module id = 12\n ** module chunks = 0\n **/","import _ from \"lodash\";\r\nimport Events from \"bean\";\r\nimport * as KeyUtils from \"./KeyUtils\";\r\nimport Utils from \"../util/Utils\";\r\nimport DomUtils from \"../util/DomUtils\";\r\nimport StringBuffer from \"./../util/StringBuffer\";\r\n\r\nconst DEFAULTS = {\r\n\tstopPropagation: false\r\n};\r\n\r\nexport default class EventDispatcher {\r\n\t/**\r\n\t * Constructor\r\n\t * @param root the root element that the manager will listen to.\r\n\t * @param zoomScale\r\n\t * @param config the configuraton for the event dispatcher.\r\n\t */\r\n\tconstructor(root, zoomScale = [0, Infinity], config = {}) {\r\n\t\tthis.root = root;\r\n\t\tthis.rootNS = root.getAttribute('ns') || 'root';\r\n\t\tthis.zoomScale = zoomScale;\r\n\t\t_.assign(this, DEFAULTS, config);\r\n\t\tthis.scale = 1.0;\r\n\t\tthis.listeners = {};\r\n\t\tthis.dragging = false;\r\n\t\tthis.handler = _.bind(this.handleEvent, this);\r\n\t\tthis.started = false;\r\n\r\n\t\t// Simulate mouseenter/mouseleave events\r\n\t\tthis.enterStack = [];\r\n\t}\r\n\r\n\t/**\r\n\t * Start listening for events.\r\n\t */\r\n\tstart() {\r\n\t\tif (this.started) return;\r\n\t\tEvents.on(this.root, 'mousedown mouseover mouseout mouseenter mouseleave dblclick click contextmenu mousewheel', this.handler);\r\n\t\tthis.startKeys();\r\n\t\tthis.started = true;\r\n\t}\r\n\r\n\t/**\r\n\t * Stop listening for events.\r\n\t */\r\n\tstop() {\r\n\t\tif (!this.started) return;\r\n\t\tEvents.off(this.root, 'mousedown mouseover mouseout mouseenter mouseleave dblclick click contextmenu mousewheel', this.handler);\r\n\t\tthis.stopKeys();\r\n\t\tthis.started = false;\r\n\t}\r\n\r\n\tstartKeys() {\r\n\t\tEvents.on(document, 'keydown keyup', this.handler);\r\n\t}\r\n\r\n\tstopKeys() {\r\n\t\tEvents.off(document, 'keydown keyup', this.handler);\r\n\t}\r\n\r\n\tzoomIn() {\r\n\t\tthis.scale *= 1.25;\r\n\t\tthis.scale = Math.max(Math.min(this.zoomScale[1], this.scale), this.zoomScale[0]);\r\n\t\treturn this.scale;\r\n\t}\r\n\r\n\tzoomOut() {\r\n\t\tthis.scale *= 0.8;\r\n\t\tthis.scale = Math.max(Math.min(this.zoomScale[1], this.scale), this.zoomScale[0]);\r\n\t\treturn this.scale;\r\n\t}\r\n\r\n\tgetEventInfo(event) {\r\n\t\tlet target = event.target;\r\n\t\tlet buf = new StringBuffer(), ns, stack = [], isRoot = false;\r\n\t\twhile (!isRoot && target && target != document) {\r\n\t\t\tns = target.getAttribute('ns');\r\n\t\t\tif (ns) {\r\n\t\t\t\tisRoot = _.startsWith(ns, \"root.\");\r\n\t\t\t\tif (isRoot) {\r\n\t\t\t\t\tns = ns.substring(5);\r\n\t\t\t\t\tevent.rootTarget = target;\r\n\t\t\t\t}\r\n\t\t\t\tif (!event.nsTarget) event.nsTarget = target;\r\n\t\t\t\tstack.splice(0, 0, target);\r\n\t\t\t\tbuf.prepend(ns);\r\n\t\t\t}\r\n\t\t\ttarget = target.parentNode;\r\n\t\t}\r\n\t\tif (!isRoot)\r\n\t\t\tevent.rootTarget = event.nsTarget;\r\n\r\n\t\t// target stack is a stack of all the ns targets up to the one with the data binding.\r\n\t\tevent.targetStack = stack;\r\n\t\tns = buf.toString('.');\r\n\t\tif (ns == '') ns = this.rootNS;\r\n\t\treturn {data: event.rootTarget, ns: ns};\r\n\t}\r\n\r\n\t/**\r\n\t * The main event handler method, it processes event and generate relevant events to dispatch.\r\n\t */\r\n\thandleEvent(event) {\r\n\t\tlet type = event.type;\r\n\r\n\t\t// Do not dispatch other events if we are dragging.\r\n\t\tif (this.dragging || DomUtils.eventFromInput(event)) return;\r\n\r\n\t\tlet data, ns, pos = this.getPosition(event), info, isKeyEvent = (type == 'keydown' || type =='keyup');\r\n\t\tif (isKeyEvent) {\r\n\t\t\tdata = this.root;\r\n\t\t\tns = KeyUtils.getKeyEvent(event);\r\n\t\t} else {\r\n\t\t\tinfo = this.getEventInfo(event);\r\n\t\t\tif (!info) return;\r\n\t\t\tdata = info.data;\r\n\t\t\tns = info.ns;\r\n\t\t}\r\n\r\n\t\t//Utils.log('EventDispatcher', \"handleEvent - \" + type + ';ns=' + ns);\r\n\r\n\t\tif (type == 'mousewheel') {\r\n\t\t\tthis.scale *= Math.pow(2, event.wheelDelta * 0.002);\r\n\t\t\tthis.scale = Math.max(Math.min(this.zoomScale[1], this.scale), this.zoomScale[0]);\r\n\t\t\tevent.scale = this.scale;\r\n\t\t\ttype = 'zoom';\r\n\t\t}\r\n\r\n\t\t// See if we should create drag events\r\n\t\tif (type == 'mousedown' && event.button == 0 /*only drag on left click*/) {\r\n\t\t\t// Create drag object.\r\n\t\t\tconst dragObject = {data: data, pos: ns == 'root' ? EventDispatcher.mouse(this.root, event) : pos};\r\n\t\t\tthis.dragging = false;\r\n\t\t\t// Start listening for mouse move.\r\n\t\t\tlet dragPos;\r\n\r\n\t\t\tconst mousemove = (event) => {\r\n\t\t\t\tlet currentPos = this.getPosition(event);\r\n\t\t\t\tif (!this.dragging) {\r\n\t\t\t\t\t// check if the mouse has moved. IE always fire mousemove after mousedown even if the mouse hasn't moved yet.\r\n\t\t\t\t\tif (dragObject.pos[0] == currentPos[0] && dragObject.pos[1] == currentPos[1]) return;\r\n\r\n\t\t\t\t\t// start dragging\r\n\t\t\t\t\tthis.dragging = true;\r\n\t\t\t\t\tevent.rootTarget = dragObject.data;\r\n\t\t\t\t\tthis.dispatch(event, 'dragstart', ns, dragObject.data, dragObject.pos);\r\n\t\t\t\t}\r\n\t\t\t\tif (ns == \"root\")\r\n\t\t\t\t\tdragPos = EventDispatcher.mouse(this.root, event);\r\n\t\t\t\telse\r\n\t\t\t\t\tdragPos = currentPos;\r\n\t\t\t\tthis.getEventInfo(event);\r\n\t\t\t\tthis.dispatch(event, 'drag', ns, dragObject.data, dragPos);\r\n\t\t\t};\r\n\t\t\tconst mouseup = (event) => {\r\n\t\t\t\tif (ns == \"root\")\r\n\t\t\t\t\tdragPos = EventDispatcher.mouse(this.root, event);\r\n\t\t\t\telse\r\n\t\t\t\t\tdragPos = this.getPosition(event);\r\n\r\n\t\t\t\tlet info = this.getEventInfo(event);\r\n\t\t\t\tif (this.dragging) {\r\n\t\t\t\t\tthis.dragging = false;\r\n\t\t\t\t\tthis.dispatch(event, 'dragend', ns, dragObject.data, dragPos);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.dispatch(event, 'mouseup', ns, info.data, dragPos);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tEvents.off(window, 'mousemove', mousemove);\r\n\t\t\t\tEvents.off(window, 'mouseup', mouseup);\r\n\t\t\t};\r\n\t\t\tevent.preventDefault();\r\n\t\t\tEvents.on(window, 'mousemove', mousemove);\r\n\t\t\tEvents.on(window, 'mouseup', mouseup);\r\n\t\t}\r\n\r\n\t\tif (!isKeyEvent)\r\n\t\t\tthis.simulateEnterLeave(event, type, ns, data, pos);\r\n\t\tthis.dispatch(event, type, ns, data, pos);\r\n\r\n\t\t// disable the default context menu\r\n\t\t//if (type == 'contextmenu')\r\n\t\t//\tevent.preventDefault();\r\n\t}\r\n\r\n\t/**\r\n\t * try to simulate mouseenter/mouseleave events.\r\n\t */\r\n\tsimulateEnterLeave(event, type, ns, data, pos) {\r\n\t\tlet last, stack;\r\n\t\tconst clearEnterStack = (k) => {\r\n\t\t\tk = k || 0;\r\n\t\t\t// Clear off the enter stack.\r\n\t\t\twhile (this.enterStack.length >= k + 1) {\r\n\t\t\t\tlast = this.enterStack.pop();\r\n\t\t\t\tthis.dispatch(event, 'mouseleave', last.ns, last.data, pos);\r\n\t\t\t}\r\n\t\t};\r\n\t\tconst getNS = function(index) {\r\n\t\t\tlet buf = new StringBuffer();\r\n\t\t\tfor (let i = 0; i <= index; i++) {\r\n\t\t\t\tvar val = stack[i].getAttribute(\"ns\");\r\n\t\t\t\tif (_.startsWith(val, \"root.\"))\r\n\t\t\t\t\tval = val.substring(5);\r\n\t\t\t\tbuf.append(val);\r\n\t\t\t}\r\n\t\t\treturn buf.toString('.');\r\n\t\t};\r\n\r\n\t\tif (ns && ns != this.rootNS) {\r\n\t\t\tif (type == 'mouseover') {\r\n\t\t\t\tstack = event.targetStack;\r\n\t\t\t\tlet item;\r\n\t\t\t\tfor (let i = 0; i < stack.length; i++) {\r\n\t\t\t\t\tif (i < this.enterStack.length) {\r\n\t\t\t\t\t\tif (this.enterStack[i].target != stack[i]) {\r\n\t\t\t\t\t\t\tclearEnterStack(i);\r\n\t\t\t\t\t\t} else\r\n\t\t\t\t\t\t\tcontinue;\r\n\t\t\t\t\t}\r\n\t\t\t\t\titem = {data: data, ns: getNS(i), target: stack[i]};\r\n\t\t\t\t\tthis.enterStack.push(item);\r\n\t\t\t\t\tthis.dispatch(event, 'mouseenter', item.ns, data, pos);\r\n\t\t\t\t}\r\n\t\t\t\tif (stack.length < this.enterStack.length)\r\n\t\t\t\t\tclearEnterStack(stack.length);\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (ns == this.rootNS && this.enterStack.length > 0)\r\n\t\t\tclearEnterStack();\r\n\t}\r\n\r\n\tdispatch(event, type, ns, data, pos) {\r\n\t\t//if (type != 'mouseover' && type != 'mouseout')\r\n\t\t//\tUtils.log('EventDispatcher', \"dispatch - \" + type + '.' + ns + ';' + pos + ';rootTarget=' + event.rootTarget + ';data=' + data);\r\n\t\tif (!this.started) return;\r\n\t\tconst nsType = ns ? type + '.' + ns : type;\r\n\t\t_.forEach(this.listeners, (listeners, key) => {\r\n\t\t\tif (EventDispatcher.match(nsType, listeners.regexp ? listeners.regexp : key)) {\r\n\t\t\t\t_.forEach(listeners, (listener) => {\r\n\t\t\t\t\tif (!listener.context)\r\n\t\t\t\t\t\tlistener.callback.apply(window, [type, ns, data, pos, event]);\r\n\t\t\t\t\telse\r\n\t\t\t\t\t\tlistener.callback.apply(listener.context, [type, ns, data, pos, event]);\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\t// after dispatching, do not propagate.\r\n\t\tif (this.stopPropagation && event.stopPropagation)\r\n\t\t\tevent.stopPropagation();\r\n\t}\r\n\r\n\tgetPosition(event) {\r\n\t\tconst pos = EventDispatcher.mouse(this.root, event);\r\n\t\tif(! _.isNaN(pos[0]) && ! _.isNaN(pos[1]))\r\n\t\t\tthis.lastPosition = pos;\r\n\t\treturn this.lastPosition;\r\n\t}\r\n\r\n\t/**\r\n\t * Registers a key event handler\r\n\t * // Key is object {ctrl, alt, shift, meta, code}\r\n\t */\r\n\tregisterKey(type, key, callback, context) {\r\n\t\tif (_.isArray(key)) {\r\n\t\t\t_.forEach(key, (k) => {\r\n\t\t\t\tthis.registerKey(type, k, callback, context);\r\n\t\t\t});\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tkey = KeyUtils.getKeyData(key.ctrl, key.alt, key.shift, key.meta, key.code);\r\n\t\tif(!key.length) return;\r\n\t\tkey = new StringBuffer(type).append(key).toString('.');\r\n\r\n\t\tconst listener = {callback: callback, context: context};\r\n\t\tthis.listeners[key] || (this.listeners[key] = []);\r\n\t\tthis.listeners[key].push(listener);\r\n\t}\r\n\r\n\tunregisterKey(type, key, callback, context) {\r\n\t\tif (_.isArray(key)) {\r\n\t\t\t_.forEach(key, (k) => {\r\n\t\t\t\tthis.unregisterKey(type, k, callback, context);\r\n\t\t\t});\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tkey = KeyUtils.getKeyData(key.ctrl, key.alt, key.shift, key.meta, key.code);\r\n\t\tif(!key.length) return;\r\n\t\tkey = new StringBuffer(type).append(key).toString('.');\r\n\r\n\t\tlet listeners = this.listeners[key], listener;\r\n\t\tif (!listeners) return;\r\n\t\tfor (let i = 0; i < listeners.length; i++) {\r\n\t\t\tlistener = listeners[i];\r\n\t\t\tif (listener.callback === callback && (!context || context === listener.context)) {\r\n\t\t\t\tlisteners.splice(i, 1);\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * Registers an event handler\r\n\t */\r\n\tregister(type, callback, context, zIndex) {\r\n\t\tif (_.isArray(type)) {\r\n\t\t\t_.forEach(type, (t) => {\r\n\t\t\t\tthis.register(t, callback, context, zIndex);\r\n\t\t\t});\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tconst listener = {callback: callback, context: context, zIndex: zIndex};\r\n\t\tvar regexp = null;\r\n\t\tif (type instanceof RegExp) {\r\n\t\t\tregexp = type;\r\n\t\t\ttype = type + '';\r\n\t\t}\r\n\t\tthis.listeners[type] || (this.listeners[type] = []);\r\n\t\tif (regexp && !this.listeners[type].regexp)\r\n\t\t\tthis.listeners[type].regexp = regexp;\r\n\t\tthis.listeners[type].push(listener);\r\n\t}\r\n\r\n\tunregister(type, callback, context) {\r\n\t\tif (type instanceof RegExp)\r\n\t\t\ttype = type + '';\r\n\t\tlet listeners = this.listeners[type], listener;\r\n\t\tif (!listeners) return;\r\n\t\tfor (let i = 0; i < listeners.length; i++) {\r\n\t\t\tlistener = listeners[i];\r\n\t\t\tif (listener.callback === callback && (!context || context === listener.context)) {\r\n\t\t\t\tlisteners.splice(i, 1);\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tdestroy() {\r\n\t\tthis.stop();\r\n\t\tdelete this.root;\r\n\t\tdelete this.listeners;\r\n\t\tdelete this.enterStack;\r\n\t}\r\n\r\n\t/**\r\n\t * Check if the registered event type matches the real event type. \"*\" is allowed as a wild card.\r\n\t */\r\n\tstatic match(nsType, registeredType) {\r\n\t\tif (registeredType instanceof RegExp)\r\n\t\t\treturn nsType.match(registeredType);\r\n\r\n\t\treturn nsType == registeredType;\r\n\t\t/*const arr = registeredType.split('*');\r\n\t\tif (arr.length == 1)\r\n\t\t\treturn nsType == registeredType;\r\n\r\n\t\tlet substr, index = 0;\r\n\t\tfor (let i = 0; i < arr.length; i++) {\r\n\t\t\tif (arr[i].length == 0) continue;\r\n\t\t\tsubstr = nsType.slice(index);\r\n\t\t\tindex = substr.indexOf(arr[i]);\r\n\t\t\tif (index < 0)\r\n\t\t\t\treturn false;\r\n\t\t\tindex += arr[i].length;\r\n\t\t}\r\n\t\treturn true;*/\r\n\t}\r\n\r\n\tstatic mouse(container, e) {\r\n\t\tif (e.changedTouches) e = e.changedTouches[0];\r\n\t\tvar svg = container.ownerSVGElement || container;\r\n\t\tif (svg.createSVGPoint) {\r\n\t\t\tvar point = svg.createSVGPoint();\r\n\t\t\tpoint.x = e.clientX; point.y = e.clientY;\r\n\t\t\tpoint = point.matrixTransform(container.getScreenCTM().inverse());\r\n\t\t\treturn [point.x, point.y];\r\n\t\t}\r\n\t\tvar rect = container.getBoundingClientRect();\r\n\t\treturn [e.clientX - rect.left - container.clientLeft, e.clientY - rect.top - container.clientTop];\r\n\t}\r\n}\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/event/EventDispatcher.js\n **/","///////////////////////////////////////////////////////////////////////////////\r\n//                                                                           //\r\n//           The Key Utility CLass for the Event Dispatcher          \t     //\r\n//                                                                           //\r\n///////////////////////////////////////////////////////////////////////////////\r\n\r\nimport StringBuffer from \"./../util/StringBuffer\";\r\n\r\n/**\r\n * KEY constant\r\n */\r\nconst KEY = {\r\n\tALT          : 18,\r\n\tBACK_SPACE   : 8,\r\n\tCAPS_LOCK    : 20,\r\n\tCONTROL      : 17,\r\n\tDELETE       : 46,\r\n\tDOWN         : 40,\r\n\tEND          : 35,\r\n\tENTER        : 13,\r\n\tESCAPE       : 220,\r\n\tHOME         : 36,\r\n\tLEFT         : 37,\r\n\tMETA         : 224,\r\n\tNUM_LOCK     : 144,\r\n\tPAGE_DOWN    : 34,\r\n\tPAGE_UP      : 33,\r\n\tPAUSE        : 19,\r\n\tPRINTSCREEN  : 44,\r\n\tRIGHT        : 39,\r\n\tSCROLL_LOCK  : 145,\r\n\tSHIFT        : 16,\r\n\tSPACE        : 32,\r\n\tTAB          : 9,\r\n\tUP           : 38\r\n\t//ADD          : DomUtils.isFireFox ? 61  : 187,\r\n\t//SUBTRACT     : DomUtils.isFireFox ? 173 : 189\r\n};\r\n\r\nexport function getKeyEvent(event) {\r\n\tif (!event || !event instanceof KeyboardEvent) {\r\n\t\treturn null;\r\n\t}\r\n\r\n\tvar key = event.keyCode || event.which;\r\n\r\n\t// Need to find a way to avoid this\r\n\tif (key >= 16 && key <= 18) {\r\n\t\tkey = null;\r\n\t}\r\n\r\n\treturn getKeyData(event.ctrlKey, event.altKey, event.shiftKey, event.metaKey, key);\r\n}\r\n\r\nexport function getKeyData(ctrl, alt, shift, meta, key) {\r\n\tvar buf = new StringBuffer();\r\n\r\n\tif (ctrl) buf.append(\"CTRL\");\r\n\tif (alt) buf.append(\"ALT\");\r\n\tif (shift) buf.append(\"SHIFT\");\r\n\tif (meta) buf.append(\"META\");\r\n\tif (key) buf.append(key);\r\n\r\n\treturn buf.toString(\".\");\r\n}\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/event/KeyUtils.js\n **/","import _ from \"lodash\";\r\nimport Utils from \"../util/Utils\";\r\nimport Node from \"./Node\";\r\nimport Edge from \"./Edge\";\r\nimport Marker from \"../view/Marker\";\r\n\r\nconst nodeDefaults = {\r\n\tname: 'Default',\r\n\trole: 'node',\r\n\tdraggable: true,\r\n\tselectable: true,\r\n\teditable: true,\r\n\tresizable: false,\r\n\tsourceable: true,\r\n\ttargetable: true,\r\n\tvisible: true\r\n};\r\n\r\nconst edgeDefaults = {\r\n\tname: 'Default',\r\n\trole: 'edge',\r\n\tselectable: true,\r\n\tvisible: true,\r\n\tstartMarker: null,\r\n\tendMarker: {\r\n\t\tid: 'Default_EndMarker',\r\n\t\ttype: 'arrow',\r\n\t\tsize: 10,\r\n\t\tcolor: '#0ea117'\r\n\t},\r\n\t/* start and end is only used if the edge is not connected to a node */\r\n\tstart: [0, 0],\r\n\tend: [400, 200]\r\n};\r\n\r\nclass Graph {\r\n\tconstructor(id = _.uniqueId(\"G\"), config = {}, model) {\r\n\t\tthis.id = id;\r\n\r\n\t\tthis.nodes = {};\r\n\t\tthis.edges = {};\r\n\r\n\t\tthis.selection = null;\r\n\t\tthis.destroyed = false;\r\n\r\n\t\tUtils.buildTypes(config.nodeTypes, \"Nodes\", nodeDefaults);\r\n\t\tUtils.buildTypes(config.edgeTypes, \"Edges\", edgeDefaults);\r\n\t\t// check for markers.\r\n\t\tthis.markers = [];\r\n\t\tlet edgeTypes = Utils.type(Edge.namespace), marker, markerConfig;\r\n\t\tedgeTypes.forEach(function(type) {\r\n\t\t\tmarkerConfig = type.prototype.startMarker;\r\n\t\t\tif (markerConfig) {\r\n\t\t\t\tmarker = Marker.getMarker(markerConfig, true);\r\n\t\t\t\tthis.markers.push(marker);\r\n\t\t\t}\r\n\t\t\tmarkerConfig = type.prototype.endMarker;\r\n\t\t\tif (markerConfig) {\r\n\t\t\t\tmarker = Marker.getMarker(markerConfig, false);\r\n\t\t\t\tthis.markers.push(marker);\r\n\t\t\t}\r\n\t\t}, this);\r\n\r\n\t\tdelete config.nodeTypes;\r\n\t\tdelete config.edgeTypes;\r\n\t\tUtils.initConfig(this, config);\r\n\t\tthis.root = null;\r\n\t\tif (model)\r\n\t\t\tthis.loadModel(model);\r\n\t}\r\n\r\n\tstatic getJSClass(config, defaultClass) {\r\n\t\tvar jsClass = null;\r\n\t\tif (config && config.type) {\r\n\t\t\t// See if we can get the js class from config.\r\n\t\t\tvar type = Utils.type(defaultClass.namespace, config.type);\r\n\t\t\tif (type)\r\n\t\t\t\tjsClass = type.jsClass;\r\n\t\t}\r\n\r\n\t\treturn Utils.getConstructor(jsClass, defaultClass);\r\n\t}\r\n\r\n\t/**\r\n\t * Create a new Node\r\n\t */\r\n\taddNode(config, parent = this.currentRoot, pos) {\r\n\t\tlet NodeClass = Graph.getJSClass(config, Node);\r\n\t\tlet node = new NodeClass(this, config);\r\n\r\n\t\tif (parent)\r\n\t\t\tGraph.addChild(parent, node, pos);\r\n\t\telse {\r\n\t\t\tthis.root = node;\r\n\t\t\tthis.root.prop('role', 'root');\r\n\t\t}\r\n\r\n\t\tthis.nodes[node.id] = node;\r\n\t\treturn node;\r\n\t}\r\n\r\n\taddEdge(config, parent = this.currentRoot, from, to) {\r\n\t\tlet EdgeClass = Graph.getJSClass(config, Edge);\r\n\t\tlet edge = new EdgeClass(this, config, from, to);\r\n\r\n\t\tGraph.addChild(parent, edge);\r\n\t\tthis.edges[edge.id] = edge;\r\n\t\treturn edge;\r\n\t}\r\n\r\n\tstatic addChild(parent, child) {\r\n\t\tif (!parent.children)\r\n\t\t\tparent.children = [];\r\n\r\n\t\tif (child.parent != parent) {\r\n\t\t\tparent.children.push(child);\r\n\r\n\t\t\tif (child.parent && child.parent.children)\r\n\t\t\t\tchild.parent.children = _.without(child.parent.children, child);\r\n\t\t}\r\n\t\tchild.parent = parent;\r\n\t}\r\n\r\n\tloadModel(model, parent = this.currentRoot) {\r\n\t\tvar nodes = model.nodes;\r\n\t\tvar edges = model.edges;\r\n\t\tdelete model.nodes;\r\n\t\tdelete model.edges;\r\n\r\n\t\tvar node = this.addNode(model, parent);\r\n\t\tif (nodes) {\r\n\t\t\t_.forEach(nodes, (child) => {\r\n\t\t\t\tthis.loadModel(child, node);\r\n\t\t\t});\r\n\t\t}\r\n\t\tif (edges) {\r\n\t\t\t_.forEach(edges, (edge) => {\r\n\t\t\t\tlet from, to;\r\n\t\t\t\tif (edge.from)\r\n\t\t\t\t\tfrom = this.nodes[edge.from];\r\n\t\t\t\tif (edge.to)\r\n\t\t\t\t\tto = this.nodes[edge.to];\r\n\t\t\t\tthis.addEdge(edge, node, from, to);\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\r\n\tget currentRoot() {\r\n\t\treturn this.root;\r\n\t}\r\n\r\n\treset() {}\r\n\tdestroy() {}\r\n}\r\n\r\nGraph.DEFAULTS = {\r\n\tallowDanglingEdges: true,\r\n\tmultiConnect: false,\r\n\treadOnly: false,\r\n\tviewOnly: false\r\n};\r\n\r\nexport default Graph;\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/graph/Graph.js\n **/","import _ from \"lodash\";\r\nimport StringBuffer from \"../util/StringBuffer\";\r\nimport Cell from \"./Cell\";\r\n\r\nclass Node extends Cell {\r\n\tconstructor(graph, config = {}) {\r\n\t\tif (!config.id) config.id = _.uniqueId('N');\r\n\t\tsuper(graph, config);\r\n\r\n\t\tthis.inEdges = [];\r\n\t\tthis.outEdges = [];\r\n\t\tthis.ports = null;\r\n\t\tthis.parent = null;\r\n\t}\r\n\r\n\tisAncestor(n) {\r\n\t\t// TODO: should we move this to graph class ?\r\n\t\tvar node = n.parent;\r\n\t\twhile (node) {\r\n\t\t\tif (this == node) { return true; }\r\n\t\t\tnode = node.parent;\r\n\t\t}\r\n\t\treturn false;\r\n\t}\r\n\r\n\tremoveEdge(edge) {\r\n\t\tvar edges = edge.source == this ? this.outEdges : this.inEdges;\r\n\t\tfor (var i = 0; i < edges.length; i++) {\r\n\t\t\tif (edge == edges[i]) {\r\n\t\t\t\tedges.splice(i, 1);\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\t// Add a new incoming edge\r\n\taddInEdge(edge, pos) {\r\n\t\tif (pos == null || pos === undefined)\r\n\t\t\tthis.inEdges.push(edge);\r\n\t\telse\r\n\t\t\tthis.inEdges.splice(pos, 0, edge);\r\n\t}\r\n\r\n\t// Add a new outgoing edge\r\n\taddOutEdge(edge, pos) {\r\n\t\tif (pos == null || pos === undefined || pos > edge.length - 1)\r\n\t\t\tthis.outEdges.push(edge);\r\n\t\telse\r\n\t\t\tthis.outEdges.splice(pos, 0, edge);\r\n\t}\r\n\r\n\trenderChildren(view) {\r\n\t\tif (this.children) {\r\n\t\t\tlet buf = new StringBuffer();\r\n\t\t\t_.forEach(this.children, (child) => {\r\n\t\t\t\tbuf.append(child.render(view));\r\n\t\t\t});\r\n\t\t\treturn buf.toString();\r\n\t\t}\r\n\t\treturn '';\r\n\t}\r\n\r\n\tgetPort(key, portName = 'auto', endPt, orthogonal) {\r\n\t\tlet shape = this.getShape(key);\r\n\t\tif (portName == 'auto') {\r\n\t\t\treturn shape.getPerimeter(endPt, orthogonal);\r\n\t\t}\r\n\t\treturn null;\r\n\t}\r\n\r\n\ttoString() {\r\n\t\tvar label = this.prop(\"label\") ? this.prop(\"label\") : \"undefined\";\r\n\t\tif (_.isArray(label))\r\n\t\t\tlabel = label[0];\r\n\t\treturn 'Node:{id:' + this.id + ';label:' + label + ';type:' + this.props.constructor.typeName + '}';\r\n\t}\r\n}\r\nNode.namespace = \"Nodes\";\r\n\r\nexport default Node;\r\n\r\n/*\r\n\r\n/**\r\n * The DrillDownParent is the parent that displays the vertex when drilled down.\r\n *\r\nVertex.prototype.getDrillDownParent = function() {\r\n\treturn this.parent;\r\n};\r\n\r\nVertex.prototype.isLocked = function() {\r\n\tvar mode = this.getProperty(\"mode\") || 3;\r\n\treturn !(mode & Graph.ALLOW_INTERACTIONS);\r\n};\r\n\r\nVertex.prototype.getCrumbText = function() {\r\n\tif (this.isLocked())\r\n\t\treturn '<span><img src=\"webwb/pzreadonly.png\" /></span><span>&nbsp;' + this.getProperty(\"label\") + '</span>';\r\n\treturn this.getProperty(\"label\");\r\n};\r\n\r\nVertex.prototype.canEdit = function() {\r\n\treturn (!this.parent || !this.parent.isLocked()) && Vertex.superclass.canEdit.call(this);\r\n};\r\n\r\nVertex.prototype.isContainer = function() {\r\n\treturn this.getProperty(\"container\");\r\n};\r\n\r\n*/\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/graph/Node.js\n **/","import _ from \"lodash\";\r\nimport Utils from \"../util/Utils\";\r\nimport Cache from \"../util/Cache\";\r\nimport StringBuffer from \"../util/StringBuffer\";\r\nimport Shape from \"../geometry/Shape\";\r\nimport Rectangle from \"../geometry/Rectangle\";\r\nimport Label from \"../view/Label\";\r\n\r\n/**\r\n * The Cell is the common parent for Node and Edge.\r\n */\r\nexport default class Cell {\r\n\tconstructor(graph, config = {id: _.uniqueId()}) {\r\n\t\tthis.graph = graph;\r\n\t\tthis.id = config.id;\r\n\t\tdelete config.id;\r\n\r\n\t\t// Initialize decorators\r\n\t\tif (config.decorators) {\r\n\t\t\tthis.createDecorators(config.decorators);\r\n\t\t\tdelete config.decorators;\r\n\t\t}\r\n\r\n\t\t// Initialize View Properties\r\n\t\tif (config.views) {\r\n\t\t\tthis.viewProps = config.views;\r\n\t\t\tdelete config.views;\r\n\t\t}\r\n\r\n\t\t// Initialize type\r\n\t\tvar type = config.type || \"Default\";\r\n\t\ttype = Utils.type(this.constructor.namespace, type);\r\n\t\tif (!type)\r\n\t\t\tthrow new Error(\"Type not found \" + config.type);\r\n\t\tdelete config.type;\r\n\t\tthis.props = new type(config);\r\n\t}\r\n\r\n\tprop(name, value) {\r\n\t\tif (_.isUndefined(value))\r\n\t\t\treturn this.props[name];\r\n\t\tthis.props[name] = value;\r\n\t}\r\n\r\n\t/**\r\n\t * Get/Set property stored by views.\r\n\t * @param key\r\n\t * @param name\r\n\t * @param value\r\n\t * @returns {*}\r\n\t */\r\n\tviewProp(key = 'default', name, value) {\r\n\t\tif (_.isUndefined(value)) {\r\n\t\t\tif (key == 'default')\r\n\t\t\t\treturn this.prop(name, value);\r\n\t\t\treturn this.viewProps[key][name];\r\n\t\t}\r\n\t\tif (key == 'default') {\r\n\t\t\tthis.prop(name, value);\r\n\t\t} else {\r\n\t\t\tif (!this.viewProps[key])\r\n\t\t\t\tthis.viewProps[key] = {};\r\n\t\t\tthis.viewProps[key][name] = value;\r\n\t\t}\r\n\t}\r\n\r\n\tcreateDecorators(decorators) {}\r\n\r\n\t/**\r\n\t * Get properties needed for rendering this element\r\n\t * @returns {{key: (string|*), className: *, namespace: *, bounds: *}}\r\n\t */\r\n\tgetView(key) {\r\n\t\tlet shape = this.getShape(key);\r\n\t\treturn _.assign({\r\n\t\t\tid: this.id,\r\n\t\t\tkey: key,\r\n\t\t\tclassName: this.computedClassName,\r\n\t\t\tstyle: this.viewProp(key, 'style'),\r\n\t\t\tnamespace: this.namespace\r\n\t\t}, shape);\r\n\t}\r\n\r\n\tgetShape(key) {\r\n\t\tlet shape = Cache.get(this.id + \".shape\", key);\r\n\t\tif (shape) return shape;\r\n\r\n\t\tlet shapeConfig = this.viewProp(key, 'shape');\r\n\t\tlet shapeClass = shapeConfig ? Shape.getShape(shapeConfig.name) : Shape.getShape('Rectangle');\r\n\t\tlet x = this.viewProp(key, \"x\");\r\n\t\tlet y = this.viewProp(key, \"y\");\r\n\t\tlet width = this.viewProp(key, \"width\");\r\n\t\tlet height = this.viewProp(key, \"height\");\r\n\t\tshape = new shapeClass(x, y, width, height, shapeConfig);\r\n\t\tCache.set(this.id + '.shape', shape, key);\r\n\t\treturn shape;\r\n\t}\r\n\r\n\trender(view) {\r\n\t\tlet template = Cache.get(this.id + '.template', view.id);\r\n\t\tif (!template) {\r\n\t\t\t//create the template\r\n\t\t\tlet role = this.prop('role');\r\n\t\t\ttemplate = view.getTemplate('$' + role, null, this);\r\n\t\t\tif (_.isString(template))\r\n\t\t\t\ttemplate = _.template(template);\r\n\t\t\tCache.set(this.id + '.template', template, view.id);\r\n\t\t}\r\n\t\treturn template(this.getView(view.id));\r\n\t}\r\n\r\n\trenderShape(view) {\r\n\t\tlet shape = this.getShape(view.id);\r\n\t\tif (shape)\r\n\t\t\treturn shape.render(view);\r\n\t\treturn '';\r\n\t}\r\n\r\n\trenderLabel(view) {\r\n\t\tif (this == this.graph.currentRoot)\r\n\t\t\treturn null;\r\n\t\tlet box = this.getLabelBox(view.id);\r\n\t\tif (box)\r\n\t\t\treturn view.renderLabel(box);\r\n\t\treturn '';\r\n\t}\r\n\r\n\tgetLabelBox(key) {\r\n\t\tlet box = Cache.get(this.id + '.labelBox', key);\r\n\t\tif (box) return box;\r\n\t\tlet shape = this.getShape(key);\r\n\t\t// Just get the config will have a positive performance boost for IE11 and IE10.\r\n\t\tbox = Label.getLabelBox(this.prop('label'), this.viewProp(key, 'labelConfig'), shape.width, shape.height);\r\n\t\tCache.set(this.id + '.labelBox', box, key);\r\n\t\treturn box;\r\n\t}\r\n\r\n\tget computedClassName() {\r\n\t\tif (!this._computedClassName) {\r\n\t\t\tvar buf = new StringBuffer(this.prop(\"role\"));\r\n\t\t\tlet props = this.props;\r\n\t\t\tif (props.hasOwnProperty(\"className\"))\r\n\t\t\t\tbuf.append(props[\"className\"]);\r\n\t\t\tprops = props.constructor.prototype;\r\n\t\t\twhile (props) {\r\n\t\t\t\tif (props.hasOwnProperty(\"className\"))\r\n\t\t\t\t\tbuf.append(props[\"className\"]);\r\n\t\t\t\tprops = Object.getPrototypeOf(props);\r\n\t\t\t}\r\n\t\t\tthis._computedClassName = buf.toString(' ');\r\n\t\t}\r\n\t\treturn this._computedClassName;\r\n\t}\r\n\r\n\tget namespace() {\r\n\t\tif (this == this.graph.currentRoot) return '';\r\n\t\treturn \"root.\" + this.prop(\"role\");\r\n\t}\r\n\r\n\tdestroy() {\r\n\t\tdelete this.graph;\r\n\t\tdelete this.decorators;\r\n\t\tdelete this.props;\r\n\t\tdelete this.viewProps;\r\n\t\tthis.destroyed = true;\r\n\t}\r\n}\r\n\r\n/*\r\n\r\nCell.prototype.move = function(x, y) {\r\n\tthis.setProperty(\"x\", Math.round(x));\r\n\tthis.setProperty(\"y\", Math.round(y));\r\n\tdelete this.bounds;\r\n};\r\n\r\nCell.prototype.resize = function(w, h) {\r\n\tthis.setProperty(\"width\", w);\r\n\tthis.setProperty(\"height\", h);\r\n\tdelete this.bounds;\r\n};\r\n\r\nCell.prototype.canEdit = function() {\r\n\treturn (this.graph ? this.graph.canEdit() : true) && this.getProperty(\"editable\");\r\n};\r\n\r\nCell.prototype.canSelect = function() {\r\n\treturn (this.graph ? this.graph.canSelect() : true) && this.getProperty(\"selectable\");\r\n};\r\n\r\nCell.prototype.canMove = function() {\r\n\treturn (this.graph ? this.graph.canEdit() : true) && this.getProperty(\"draggable\");\r\n};\r\n\r\nCell.prototype.canResize = function() {\r\n\treturn (this.graph ? this.graph.canEdit() : true) && this.getProperty(\"resizable\");\r\n};\r\n\r\nCell.prototype.getTypeFromString = function(typeStr) {\r\n\treturn this.graph.getType(typeStr);\r\n};\r\n\r\nCell.prototype.createModifiers = function(modifiers) {\r\n\tthis.modifiers = null;\r\n\tvar modifierSettings = this.getProperty(\"modifierSettings\");\r\n\tif (modifierSettings) {\r\n\t\t_.each(modifiers, function(config) {\r\n\t\t\tconfig.type = this.graph.getModifierType(config.className);\r\n\t\t\tconfig.setting = modifierSettings[config.className];\r\n\t\t\tif (!config.type || !config.setting) return;\r\n\r\n\t\t\tthis.addModifier(config.className, new Modifier(this, config));\r\n\t\t}, this);\r\n\r\n\t\t// Check for showAlways settings\r\n\t\t_.each(modifierSettings, function(setting, name) {\r\n\t\t\tif (setting.showAlways && (!this.modifiers || !this.modifiers[name])) {\r\n\t\t\t\tvar config = {type: this.graph.getModifierType(name), setting: setting};\r\n\t\t\t\tif (!config.type) return;\r\n\t\t\t\tthis.addModifier(name, new Modifier(this, config));\r\n\t\t\t}\r\n\t\t}, this);\r\n\t}\r\n};\r\n\r\nCell.prototype.addModifier = function(name, modifier) {\r\n\tif (!this.modifiers)\r\n\t\tthis.modifiers = {};\r\n\r\n\tif (!modifier.hasOwnProperty(\"showHeader\"))\r\n\t\tmodifier.showHeader = true;\r\n\r\n\t// @hack preferably set it in configurations.\r\n\tif (modifier.name == \"HoverProcessModifier\" || modifier.name == \"HoverResults\")\r\n\t\tmodifier.showHeader = false;\r\n\r\n\tthis.modifiers[name] = modifier;\r\n};\r\n\r\nCell.prototype.getModifiers = function() {\r\n\tif (_.isUndefined(this.modifiers))\r\n\t\tthis.createModifiers();\r\n\treturn this.modifiers;\r\n};\r\n\r\nCell.prototype.getModifier = function(name) {\r\n\tvar modifiers = this.getModifiers();\r\n\tif (modifiers)\r\n\t\treturn modifiers[name];\r\n\treturn null;\r\n};\r\n\r\nCell.prototype.isVisible = function() {\r\n\treturn this.getProperty('visible');\r\n};\r\n\r\nCell.prototype.isContainer = function() {\r\n\treturn false;\r\n};\r\n*/\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/graph/Cell.js\n **/","/**\r\n * Created by tong on 6/7/2016.\r\n */\r\n\r\nlet caches = {};\r\n\r\nlet Cache = {\r\n\tget: function(key, namespace) {\r\n\t\treturn this.getCache(namespace)[key];\r\n\t},\r\n\r\n\tset: function(key, value, namespace) {\r\n\t\tthis.getCache(namespace)[key] = value;\r\n\t},\r\n\r\n\tcontains: function(key, namespace) {\r\n\t\treturn key in this.getCache(namespace);\r\n\t},\r\n\r\n\tremove: function(key, namespace) {\r\n\t\tdelete this.getCache(namespace)[key];\r\n\t},\r\n\r\n\tclear: function(namesapce) {\r\n\t\tif (!namespace)\r\n\t\t\tcaches = {};\r\n\t\telse if (caches[namespace])\r\n\t\t\tcaches[namespace] = {};\r\n\t},\r\n\r\n\tgetCache: function(namespace = 'default') {\r\n\t\tif (!caches[namespace])\r\n\t\t\tcaches[namespace] = {};\r\n\t\treturn caches[namespace];\r\n\t}\r\n};\r\n\r\nexport default Cache;\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/util/Cache.js\n **/","import _ from \"lodash\";\r\nimport Events from \"bean\";\r\nimport Utils from \"../util/Utils\";\r\nimport DomUtils from \"../util/DomUtils\";\r\nimport StringBuffer from \"../util/StringBuffer\";\r\nimport Rectangle from \"../geometry/Rectangle\";\r\n\r\nconst FONT_BOLD = 1, FONT_ITALIC = 2, FONT_UNDERLINE = 4, FONT_SHADOW = 8;\r\n\r\nlet defaultConfig = {\r\n\tfontSize: 11,\r\n\tfontFamily: \"Arial\",\r\n\tfontStyle: 0,\r\n\tfontColor: 'black',\r\n\tpadding: 0,\r\n\tlinePadding: 0,\r\n\talign: \"left\",\r\n\twidth: 0,\r\n\theight: 0,\r\n\trotation: null,\r\n\tgeometry: {x: 0, y: 0, anchorY: 0, offsetX: 0, offsetY: 0}\r\n};\r\n\r\n/**\r\n * The label object handles label sizing/positioning\r\n */\r\nexport default (function() {\r\n\tlet stringMeasureEl = null, measureDiv, baselineDiv;\r\n\r\n\t/**\r\n\t * Calculate the size of the string.\r\n\t */\r\n\tlet getStringSize = _.memoize(function(str, fontSize, fontFamily, bold) {\r\n\t\tfontSize = fontSize || 11;\r\n\t\tfontFamily = fontFamily || 'Arial,Helvetica';\r\n\t\tbold = !_.isUndefined(bold) ? bold: false;\r\n\r\n\t\t// first check if there is a string-measuring div available, if not, create now.\r\n\t\tif (!stringMeasureEl) {\r\n\t\t\tstringMeasureEl = DomUtils.createElement('iframe', {id:\"_ComputeStylesIframe\"}, {position:\"absolute\", visibility:\"hidden\", width:\"auto\"});\r\n\t\t\tdocument.body.appendChild(stringMeasureEl);\r\n\t\t\tvar doc = stringMeasureEl.contentWindow.document;\r\n\t\t\tdoc.open();\r\n\t\t\tdoc.write('<html><body>\\\r\n\t\t\t\t<div id=\"baselineDiv\" style=\"height:100px;\"><span style=\"line-height:0\">T</span><span style=\"height:100%;display:inline-block;\"></span></div>\\\r\n\t\t\t\t<div id=\"measureDiv\" style=\"position:absolute;width:auto;height:auto;padding:0;white-space:pre-wrap;word-wrap:break-word;display:inline-block;\"></div>\\\r\n\t\t\t\t</body></html>');\r\n\t\t\tdoc.close();\r\n\t\t\tmeasureDiv = doc.getElementById(\"measureDiv\");\r\n\t\t\tbaselineDiv = doc.getElementById(\"baselineDiv\");\r\n\t\t}\r\n\t\tbaselineDiv.style.fontSize = measureDiv.style.fontSize = fontSize;\r\n\t\tbaselineDiv.style.fontFamily = measureDiv.style.fontFamily = fontFamily;\r\n\t\tbaselineDiv.style.fontWeight = measureDiv.style.fontWeight = bold ? 'bold' : 'normal';\r\n\t\tmeasureDiv.innerHTML = str;\r\n\r\n\t\tlet strut = baselineDiv.firstChild;\r\n\t\tlet baselineHeight = strut.offsetTop + strut.offsetHeight - baselineDiv.offsetHeight - baselineDiv.offsetTop;\r\n\r\n\t\treturn {width: measureDiv.offsetWidth, height: measureDiv.offsetHeight, baseline: baselineHeight};\r\n\t}, function(str, fontSize, fontFamily, bold) { return str + ';' + fontSize + ';' + fontFamily + ';' + bold; });\r\n\r\n\t/**\r\n\t * Create a wrapped text.\r\n\t * @param {String} string the string to wrap.\r\n\t * @param {maxWidth} the maximum width this string can take.\r\n\t * @param {fontSize}\r\n\t * @param {fontFamily}\r\n\t * @param {bold}\r\n\t */\r\n\tlet wrap = _.memoize(function(string, maxWidth, fontSize, fontFamily, bold) {\r\n\t\tmaxWidth = maxWidth || 0;\r\n\t\tfontSize = fontSize || 11;\r\n\t\tfontFamily = fontFamily || 'Arial,Helvetica';\r\n\t\tbold = !_.isUndefined(bold) ? bold: false;\r\n\r\n\t\tlet arr = [];\r\n\t\tlet spaceSize = getStringSize(\"&nbsp;\", fontSize, fontFamily, bold), space = spaceSize.width;\r\n\t\tarr.lineHeight = spaceSize.height;\r\n\t\tarr.baseline = spaceSize.baseline;\r\n\r\n\t\tif (!maxWidth || !string || string == \"\") {\r\n\t\t\tarr.push(string);\r\n\t\t\tarr.width = (!string || string == \"\") ? space : getStringSize(string, fontSize, fontFamily, bold).width;\r\n\t\t\tarr.height = arr.lineHeight;\r\n\t\t\treturn arr;\r\n\t\t}\r\n\r\n\t\tvar width = 0;\r\n\t\t//split the text by lines\r\n\t\tvar lines = string.split('\\n');\r\n\r\n\t\tvar buf = new StringBuffer();\r\n\r\n\t\tfor (var j = 0; j < lines.length; j++) {\r\n\t\t\t//split each line by word\r\n\t\t\tvar words = lines[j].split(/\\s/);\r\n\t\t\tvar line = \"\", currentWidth = 0, wordWidth = 0, newLine = true, word;\r\n\r\n\t\t\tfor (var i = 0; i < words.length; i++) {\r\n\t\t\t\tword = words[i];\r\n\t\t\t\twordWidth = getStringSize(word, fontSize, fontFamily, bold).width;\r\n\r\n\t\t\t\tif ((newLine ? wordWidth : currentWidth + space + wordWidth) > maxWidth) {\r\n\t\t\t\t\tif (newLine) {\r\n\t\t\t\t\t\tbuf.append(word);\r\n\t\t\t\t\t\twidth = Math.max(width, wordWidth);\r\n\t\t\t\t\t\tif (i < words.length - 1) {\r\n\t\t\t\t\t\t\tarr.push(buf.toString());\r\n\t\t\t\t\t\t\tbuf.clear();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tarr.push(buf.append(line).toString());\r\n\t\t\t\t\t\twidth = Math.max(width, currentWidth + space + wordWidth);\r\n\t\t\t\t\t\tbuf.clear();\r\n\t\t\t\t\t}\r\n\t\t\t\t\tline = \"\";\r\n\t\t\t\t\tcurrentWidth = 0;\r\n\t\t\t\t\tif (!newLine)\r\n\t\t\t\t\t\ti--; // move back one word.\r\n\t\t\t\t\tnewLine = true;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tline = newLine ? word : line + \" \" + word;\r\n\t\t\t\t\tcurrentWidth = newLine ? wordWidth : currentWidth + space + wordWidth;\r\n\t\t\t\t\twidth = Math.max(width, currentWidth);\r\n\t\t\t\t\tnewLine = false;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (line != \"\")\r\n\t\t\t\tbuf.append(line);\r\n\t\t\tif (j < lines.length - 1) {\r\n\t\t\t\tarr.push(buf.toString());\r\n\t\t\t\tbuf.clear();\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tarr.push(buf.toString());\r\n\t\tarr.width = width;\r\n\t\tarr.height = arr.lineHeight * arr.length;\r\n\t\treturn arr;\r\n\t}, function(str, maxWidth, fontSize, fontFamily, bold) { return str + ';' + maxWidth + ';' + fontSize + ';' + fontFamily + ';' + bold; });\r\n\r\n\t/**\r\n\t *  Get the view information for how to display the label.\r\n\t * @param label The string that needs to be displayed\r\n\t * @param containerWidth The width of the parent container.\r\n\t * @param containerHeight The height of the parent container.\r\n\t * @param labelConfig The configuration on how to display label. It should be an object with the following parameters:\r\n\t * {\r\n\t *      fontSize, fontFamily, fontStyle, padding,\r\n\t *      align: can be either \"left\", \"center\" or \"right\",\r\n\t *      width: the maximum width of the label. if less than 1, then is treated as percentage. If 0, no wrapping will occur,\r\n\t *      height,\r\n\t *      geometry\r\n\t * }\r\n\t * @returns {*}\r\n\t */\r\n\tfunction getLabelBox(label, labelConfig, containerWidth, containerHeight) {\r\n\t\treturn _getLabelBox.call(this, label, labelConfig, {width: containerWidth, height: containerHeight});\r\n\t}\r\n\r\n\tfunction getLabelBoxForLink(label, labelConfig, link) {\r\n\t\treturn _getLabelBox.call(this, label, labelConfig, link);\r\n\t}\r\n\r\n\tfunction _getLabelBox(label, labelConfig = {}, context) {\r\n\t\tlabelConfig = _.defaultsDeep(labelConfig, defaultConfig);\r\n\t\tlet fontSize = labelConfig.fontSize;\r\n\t\tlet fontFamily = labelConfig.fontFamily;\r\n\t\tlet fontStyle = labelConfig.fontStyle;\r\n\t\tlet bold = (fontStyle & FONT_BOLD) == FONT_BOLD;\r\n\t\tlet padding = labelConfig.padding;\r\n\t\tlet linePadding = labelConfig.linePadding;\r\n\t\tlet align = labelConfig.align;\r\n\r\n\t\tlet w = labelConfig.width, h = labelConfig.height;\r\n\t\tif (context.width) {\r\n\t\t\tw = w <= 5 ? context.width * w : w;\r\n\t\t\th = h <= 5 ? context.height * h : h;\r\n\t\t}\r\n\t\tw -= 2 * padding;\r\n\t\th -= 2 * padding;\r\n\t\tw = Math.max(0, w);\r\n\t\th = Math.max(0, h);\r\n\r\n\t\tlet geometry = _.clone(labelConfig.geometry);\r\n\t\tlet wrappedLabel = this.wrap(label, w, fontSize, fontFamily, bold);\r\n\t\tgeometry.width = wrappedLabel.width + 2 * padding;\r\n\t\tgeometry.height = wrappedLabel.height + 2 * padding + (wrappedLabel.length - 1) * linePadding;\r\n\t\tlet anchor = \"start\", dx = 0, setAnchorX = !_.has(geometry, \"anchorX\");\r\n\t\tswitch (align) {\r\n\t\t\tcase \"center\":\r\n\t\t\t\tanchor = \"middle\";\r\n\t\t\t\tif (setAnchorX) geometry.anchorX = 0;\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"right\":\r\n\t\t\t\tanchor = \"end\";\r\n\t\t\t\tdx = wrappedLabel.width/2;\r\n\t\t\t\tif (setAnchorX) geometry.anchorX = -0.5;\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"left\":\r\n\t\t\t\tdx = -wrappedLabel.width/2;\r\n\t\t\t\tif (setAnchorX) geometry.anchorX = 0.5;\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\t\tlet pos;\r\n\t\tif (context.getRelativePosition)\r\n\t\t\tpos = context.getRelativePosition(geometry);\r\n\t\telse\r\n\t\t\tpos = Utils.getRelativePosition({width: context.width, height: context.height}, geometry);\r\n\r\n\t\tlet bounds = new Rectangle(pos[0], pos[1], geometry.width, geometry.height);\r\n\t\t// the pivot is the center of rotation when the label has a rotation specified.\r\n\t\tlet pivot = align == 'center' ? [0, 0] : (align == 'left' ? [-wrappedLabel.width/2, 0] : [wrappedLabel.width/2, 0]);\r\n\r\n\t\t// the maximum bounds for the label, used to position inline editor\r\n\t\tgeometry.width = Math.max(w + 2 * padding, geometry.width);\r\n\t\tgeometry.height = Math.max(h + 2 * padding, geometry.height);\r\n\r\n\t\tif (context.getRelativePosition)\r\n\t\t\tpos = context.getRelativePosition(geometry);\r\n\t\telse\r\n\t\t\tpos = Utils.getRelativePosition({width: context.width, height: context.height}, geometry);\r\n\r\n\t\tlet maxBounds = new Rectangle(pos[0], pos[1], geometry.width, geometry.height);\r\n\t\treturn {\r\n\t\t\tconfig: labelConfig, label: wrappedLabel, _label: label,\r\n\t\t\tbold, underline: fontStyle & FONT_UNDERLINE, italic: fontStyle & FONT_ITALIC, shadow: fontStyle & FONT_SHADOW,\r\n\t\t\tdx, dy: -geometry.height/2 + padding + wrappedLabel.lineHeight - wrappedLabel.baseline, anchor, lineHeight: wrappedLabel.lineHeight + linePadding,\r\n\t\t\tpivot, bounds, maxBounds\r\n\t\t};\r\n\t}\r\n\r\n\tfunction render(view, box) {\r\n\t\treturn view.renderLabel(box);\r\n\t}\r\n\r\n\tlet editor = {\r\n\t\tstart: function(key, container, box, refEl, textEl, scale = 1.0, singleLine = true) {\r\n\t\t\tif (this.input) {\r\n\t\t\t\tif (this.key != key) {\r\n\t\t\t\t\t// need to close the existing editor first\r\n\t\t\t\t\tthis.stop();\r\n\t\t\t\t} else\r\n\t\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tvar tag = singleLine ? 'input' : 'textarea';\r\n\t\t\tthis.input = DomUtils.createElement(tag, {id:\"inlineEditor\", unselectable:\"off\"}, {position:\"absolute\", overflow:\"hidden\", padding:\"0px\", margin:\"0px\", border:\"transparent\"});\r\n\t\t\tif (singleLine) {\r\n\t\t\t\tEvents.on(this.input, 'keydown keyup', (event) => {\r\n\t\t\t\t\tif (event.keyCode == 13) {\r\n\t\t\t\t\t\tEvents.off(this.input, 'keydown keyup');\r\n\t\t\t\t\t\tthis.stop();\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t\tcontainer.appendChild(this.input);\r\n\r\n\t\t\tthis.key = key;\r\n\t\t\tthis.box = box;\r\n\t\t\tthis.refEl = refEl;\r\n\t\t\tthis.textEl = textEl;\r\n\r\n\t\t\tlet labelConfig = box.config;\r\n\t\t\tlet maxBounds = new Rectangle(box.maxBounds.x, box.maxBounds.y, box.maxBounds.width * scale, box.maxBounds.height * scale);\r\n\t\t\tlet pos = DomUtils.getCenterPosition(refEl, container);\r\n\t\t\tpos = [pos[0] + maxBounds.left, pos[1] + maxBounds.top];\r\n\r\n\t\t\tif (textEl)\r\n\t\t\t\ttextEl.style.visibility = 'hidden';\r\n\r\n\t\t\tDomUtils.setElement(this.input, null, {\r\n\t\t\t\tvisibility: 'visible',\r\n\t\t\t\tleft: pos[0] + \"px\",\r\n\t\t\t\ttop: pos[1] + \"px\",\r\n\t\t\t\twidth: maxBounds.width + 'px',\r\n\t\t\t\theight: maxBounds.height + 'px',\r\n\t\t\t\t\"font-family\": labelConfig.fontFamily,\r\n\t\t\t\t\"font-size\": (labelConfig.fontSize * scale) + 'px',\r\n\t\t\t\t\"font-weight\": (labelConfig.fontStyle & FONT_BOLD) == FONT_BOLD ? 'bold' : 'normal'\r\n\t\t\t\t/*\"color\": labelConfig.fontColor*/\r\n\t\t\t});\r\n\r\n\t\t\tthis.input.value = box._label;\r\n\t\t\tthis.input.focus();\r\n\t\t\tthis.input.select();\r\n\t\t\tEvents.fire(this, 'editor.start', [this.key]);\r\n\t\t},\r\n\r\n\t\tstop: function(cancel) {\r\n\t\t\tif (!this.input) return;\r\n\r\n\t\t\tcancel = cancel || false;\r\n\t\t\tif (this.textEl)\r\n\t\t\t\tthis.textEl.style.visibility = null;\r\n\r\n\t\t\tif (!cancel)\r\n\t\t\t\tEvents.fire(this, 'editor.update', [this.key, this.input.value]);\r\n\r\n\t\t\tEvents.fire(this, 'editor.stop', [this.key]);\r\n\r\n\t\t\t// remove the input\r\n\t\t\tthis.input.parentNode.removeChild(this.input);\r\n\t\t\tdelete this.input;\r\n\t\t\tdelete this.key;\r\n\t\t\tdelete this.box;\r\n\t\t\tdelete this.refEl;\r\n\t\t\tdelete this.textEl;\r\n\t\t}\r\n\t};\r\n\r\n\treturn {\r\n\t\tFONT_BOLD,\r\n\t\tFONT_ITALIC,\r\n\t\tFONT_UNDERLINE,\r\n\t\tFONT_SHADOW,\r\n\t\tgetStringSize,\r\n\t\twrap,\r\n\t\tgetLabelBox,\r\n\t\tgetLabelBoxForLink,\r\n\t\trender,\r\n\t\teditor\r\n\t};\r\n})();\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/view/Label.js\n **/","import _ from \"lodash\";\r\nimport Cell from \"./Cell\";\r\nimport Rectangle from \"../geometry/Rectangle\";\r\nimport Link from \"../geometry/Link\";\r\nimport Label from \"../view/Label\";\r\nimport Cache from \"../util/Cache\";\r\n\r\nclass Edge extends Cell {\r\n\tconstructor(graph, config = {}, source, target) {\r\n\t\tif (!config.id) config.id = _.uniqueId('E');\r\n\t\tsuper(graph, config);\r\n\r\n\t\tthis.source = this.target = null;\r\n\t\tthis.setSource(source, config.sourcePos);\r\n\t\tthis.setTarget(target, config.targetPos);\r\n\t}\r\n\r\n\tsetSource(node, pos) {\r\n\t\tthis.setTerminal(node, pos, 'source');\r\n\t}\r\n\r\n\tsetTarget(node, pos) {\r\n\t\tthis.setTerminal(node, pos, 'target');\r\n\t}\r\n\r\n\t/**\r\n\t * Internal methods to set either the source or target\r\n\t */\r\n\t setTerminal(node, pos, dir) {\r\n\t\tvar end = dir == 'source' ? this.source : this.target;\r\n\t\tif (end == node) {\r\n\t\t\t// simply change the position of the edge.\r\n\t\t\tif (node)\r\n\t\t\t\tnode.setEdgeAt(this, pos);\r\n\t\t} else {\r\n\t\t\tif (end) {\r\n\t\t\t\t// first remove the edge from the current end\r\n\t\t\t\tend.removeEdge(this);\r\n\t\t\t}\r\n\r\n\t\t\tif (node) {\r\n\t\t\t\tif (dir == 'source')\r\n\t\t\t\t\tnode.addOutEdge(this, pos);\r\n\t\t\t\telse\r\n\t\t\t\t\tnode.addInEdge(this, pos);\r\n\t\t\t}\r\n\t\t\tif (dir == 'source')\r\n\t\t\t\tthis.source = node;\r\n\t\t\telse\r\n\t\t\t\tthis.target = node;\r\n\t\t\t//this.clearPoints();\r\n\t\t}\r\n\t}\r\n\r\n\tgetLabelBox(key) {\r\n\t\tvar label = this.prop('label');\r\n\t\tif (label)\r\n\t\t\treturn Label.getLabelBoxForLink(label, this.viewProp(key, 'labelConfig'), this.getShape(key));\r\n\t\treturn null;\r\n\t}\r\n\r\n\t/**\r\n\t * Return a pair of points as reference to the calculation of start and end points.\r\n\t */\r\n\tgetReferencePoints(key) {\r\n\t\tlet pts = [];\r\n\t\tif (this.source)\r\n\t\t\tpts.push(this.source.getShape(key).center);\r\n\t\telse\r\n\t\t\tpts.push(this.viewProp(key, 'start'));\r\n\r\n\t\tif (this.target)\r\n\t\t\tpts.push(this.target.getShape(key).center);\r\n\t\telse\r\n\t\t\tpts.push(this.viewProp(key, 'end'));\r\n\r\n\t\treturn pts;\r\n\t}\r\n\r\n\tgetTerminalVisual(key, orthogonal) {\r\n\t\tlet refPts = this.getReferencePoints(key);\r\n\t\tlet terminals = [];\r\n\r\n\t\tlet getBound = function(pt) {\r\n\t\t\treturn new Rectangle(pt.x, pt.y, 3, 3);\r\n\t\t};\r\n\r\n\t\tif (this.source) {\r\n\t\t\tterminals.push(this.source.getPort(key, this.prop('sourcePort'), refPts[1], orthogonal));\r\n\t\t} else\r\n\t\t\tterminals.push({point: refPts[0], direction: Rectangle.getDirection(getBound(refPts[0]), refPts[1], true)});\r\n\r\n\t\tif (this.target) {\r\n\t\t\tterminals.push(this.target.getPort(key, this.prop('targetPort'), refPts[0], orthogonal));\r\n\t\t} else\r\n\t\t\tterminals.push({point: refPts[1], direction: Rectangle.getDirection(getBound(refPts[1]), refPts[0], true)});\r\n\t\treturn terminals;\r\n\t}\r\n\r\n\tgetShape(key) {\r\n\t\tlet shape = Cache.get(this.id + \".shape\", key);\r\n\t\tif (shape) return shape;\r\n\r\n\t\tlet config = this.viewProp(key, 'shape');\r\n\t\tshape = Link.getLink(this.getTerminalVisual(key, config.orthogonal), config, this.prop('startMarker'), this.prop('endMarker'));\r\n\t\tCache.set(this.id + '.shape', shape, key);\r\n\t\treturn shape;\r\n\t}\r\n\r\n\ttoString() {\r\n\t\treturn 'Edge:{' + (!this.source ? 'null' : this.source.id) + '--' + (!this.target ? 'null' : this.target.id) + '}';\r\n\t}\r\n\r\n\tdestroy() {\r\n\t\tsuper.destroy();\r\n\t\tthis.setSource(null);\r\n\t\tthis.setTarget(null);\r\n\t}\r\n}\r\nEdge.namespace = \"Edges\";\r\n\r\nexport default Edge;\r\n\r\n/*\r\n\r\nEdge.prototype.isVisible = function() {\r\n\tif (this.graph.getProperty(\"allowDanglingEdges\")) {\r\n\t\treturn (this.source ? this.source.isVisible() : true) && (this.target ? this.target.isVisible() : true) && this.getProperty(\"visible\");\r\n\t} else\r\n\t\treturn this.source && this.target && this.getProperty('visible') && this.source.isVisible() && this.target.isVisible();\r\n};\r\n\r\n*/\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/graph/Edge.js\n **/","import Rectangle from \"../geometry/Rectangle\";\r\n\r\nlet registry = {};\r\n\r\nlet Marker = (function() {\r\n\r\n\t/** Begin Standard Marker Type **/\r\n\tfunction arrow(size, source, styles) {\r\n\t\tvar sign = source ? -1 : 1;\r\n\t\tvar marker = {\r\n\t\t\tviewBox: new Rectangle(-5, -5, 10, 10),\r\n\t\t\tsize: size,\r\n\t\t\tref: [4*sign, 0],\r\n\t\t\tfill: styles.color\r\n\t\t};\r\n\t\tmarker.shape = {\r\n\t\t\tname: 'Polygon',\r\n\t\t\tpoints: [[-2*sign, 0], [-4*sign, 4], [4*sign, 0], [-4*sign, -4]]\r\n\t\t};\r\n\t\treturn marker;\r\n\t}\r\n\r\n\tfunction triangle(size, source, styles) {\r\n\t\tvar sign = source ? -1 : 1;\r\n\t\tvar marker = {\r\n\t\t\tviewBox: new Rectangle(-5, -5, 10, 10),\r\n\t\t\tsize: size,\r\n\t\t\tref: [4*sign, 0],\r\n\t\t\tfill: styles.color\r\n\t\t};\r\n\t\tmarker.shape = {\r\n\t\t\tname: 'Polygon',\r\n\t\t\tpoints: [[-5*sign, -5], [-5*sign, 5], [4*sign, 0]]\r\n\t\t};\r\n\t\treturn marker;\r\n\t}\r\n\r\n\tfunction oval(size, source, styles) {\r\n\t\tvar r = size / 2;\r\n\t\tvar marker = {\r\n\t\t\tviewBox: new Rectangle(-r, -r, size, size),\r\n\t\t\tsize: size,\r\n\t\t\tref: [0, 0],\r\n\t\t\tfill: styles.color\r\n\t\t};\r\n\t\tmarker.shape = '<ellipse cx=\"0\" cy=\"0\" rx=\"' + r + '\" ry=\"' + r + '\"></ellipse>';\r\n\t\treturn marker;\r\n\t}\r\n\r\n\tfunction diamond(size, source, styles) {\r\n\t\tvar sign = source ? -1 : 1;\r\n\t\tvar marker = {\r\n\t\t\tviewBox: new Rectangle(-5, -5, 10, 10),\r\n\t\t\tsize: size,\r\n\t\t\tref: [4*sign, 0],\r\n\t\t\tfill: styles.color\r\n\t\t};\r\n\t\tmarker.shape = '';\r\n\t\treturn marker;\r\n\t}\r\n\t/** End Standard Marker Type **/\r\n\tfunction getMarker(config, source) {\r\n\t\tvar factory = registry[config.type];\r\n\t\tvar marker = factory(config.size, source, config);\r\n\t\tmarker.id = config.id;\r\n\t\treturn marker;\r\n\t}\r\n\r\n\tregistry['arrow'] = arrow;\r\n\tregistry['triangle'] = triangle;\r\n\tregistry['oval'] = oval;\r\n\tregistry['diamond'] = diamond;\r\n\r\n\treturn {\r\n\t\tregistry: registry,\r\n\t\tgetMarker: getMarker\r\n\t};\r\n})();\r\n\r\nexport default Marker;\r\n\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/view/Marker.js\n **/","import _ from \"lodash\";\r\nimport Utils from \"../util/Utils\";\r\n\r\nclass Layout {\r\n\tconstructor(config={}) {\r\n\t\tif (config.hasOwnProperty(\"orientation\") && _.isString(config.orientation)) {\r\n\t\t\tif (config.orientation.toUpperCase() == \"HORIZONTAL\")\r\n\t\t\t\tconfig.orientation = Layout.HORIZONTAL;\r\n\t\t\telse\r\n\t\t\t\tdelete config.orientation;\r\n\t\t}\r\n\t\tUtils.initConfig(this, config);\r\n\t}\r\n\r\n\tlayout(root, bounds) {}\r\n\treset() {}\r\n\tdestroy() {}\r\n}\r\nLayout.VERTICAL = 0;\r\nLayout.HORIZONTAL = 1;\r\n\r\nLayout.DEFAULTS = {\r\n\torientation: Layout.VERTICAL\r\n};\r\n\r\nexport default Layout;\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/layout/Layout.js\n **/","import Layout from \"./Layout\";\r\n\r\nclass FlowLayout extends Layout {\r\n\tlayout(root, bounds) {\r\n\t\tvar items;\r\n\t\tif (!root)\r\n\t\t\titems = this.owner.childNodes;\r\n\t\telse if (_.isArray(root))\r\n\t\t\titems = root;\r\n\t\telse\r\n\t\t\titems = root.getLinkedNodes('target');\r\n\t\tif (!items || items.length == 0) return;\r\n\r\n\t\tvar x = 0, y = 0, h = 0, node;\r\n\t\tvar p1 = 0, p2 = 0;\r\n\t\tfor (var i = 0; i < items.length; i++) {\r\n\t\t\tnode = items[i];\r\n\t\t\tif (x > 0 && x + this.hgap + node.getProperty(\"width\") > bounds.width) {\r\n\t\t\t\t// create new line\r\n\t\t\t\ty += h + this.vgap;\r\n\t\t\t\tx = 0;h = 0;p1 = 0;p2++;\r\n\t\t\t}\r\n\t\t\tnode._flPos = [p1, p2];\r\n\t\t\tnode.moveTo([bounds.x + x, bounds.y + y]);\r\n\t\t\tx += this.hgap + node.getProperty(\"width\");\r\n\t\t\tp1++;\r\n\t\t\th = h < node.getProperty(\"height\") ? node.getProperty(\"height\") : h;\r\n\t\t}\r\n\t\tthis.trigger(new Rectangle(bounds.x, bounds.y, bounds.width, y + h));\r\n\t}\r\n}\r\n\r\nFlowLayout.DEFAULTS = {\r\n\thgap: 10,\r\n\tvgap: 10\r\n};\r\n\r\nexport default FlowLayout;\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/layout/FlowLayout.js\n **/","import _ from \"lodash\";\r\nimport Events from \"bean\";\r\nimport Utils from \"../util/Utils\";\r\nimport DomUtils from \"../util/DomUtils\";\r\nimport Layout from \"../layout/Layout\";\r\nimport Rectangle from \"../geometry/Rectangle\";\r\nimport EventDispatcher from \"../event/EventDispatcher\";\r\nimport GraphBehavior from \"../behavior/GraphBehavior\";\r\nimport SelectionBehavior from \"../behavior/SelectionBehavior\";\r\nimport Label from \"./Label\";\r\n\r\nclass Renderer {\r\n\tconstructor(id, container, config = {}, graph = null) {\r\n\t\tthis.id = id;\r\n\t\tthis.box = DomUtils.createElement('div', {id: this.id, tabindex: 0, ns: 'graph'}, {overflow: \"hidden\", width: \"100%\", height: \"100%\", position: 'relative'});\r\n\t\tcontainer.appendChild(this.box);\r\n\t\tif (config.layout) {\r\n\t\t\tlet layoutClass = Utils.getConstructor(config.layout.jsClass, Layout);\r\n\t\t\tthis.layout = new layoutClass(config.layout.config);\r\n\t\t\tdelete config.layout;\r\n\t\t}\r\n\t\tthis.clear = true;\r\n\t\tthis._translate = [0, 0];\r\n\t\tthis._scale = 1.0;\r\n\t\tthis.graph = graph;\r\n\t\tthis.dispatcher = null;\r\n\t\tthis.graphBehavior = null;\r\n\t\tthis.selectionBehavior = null;\r\n\t\tthis.nodeBehavior = null;\r\n\t\tthis.edgeBehavior = null;\r\n\t\tthis.connectionBehavior = null;\r\n\t\tUtils.initConfig(this, config);\r\n\r\n\t\tEvents.on(Label.editor, 'editor.update.*', function(key, value) {\r\n\t\t\tconsole.log(key + '=' + value);\r\n\t\t});\r\n\t}\r\n\r\n\tget graph() {\r\n\t\treturn this._graph;\r\n\t}\r\n\r\n\tset graph(graph) {\r\n\t\tthis._graph = graph;\r\n\t\tlet root = graph.currentRoot;\r\n\t\tif (root) {\r\n\t\t\tthis._translate = [root.viewProp(this.id, 'x') || 0, root.viewProp(this.id, 'y') || 0];\r\n\t\t\tthis._scale = root.viewProp(this.id, 'scale') || 1.0;\r\n\t\t}\r\n\t}\r\n\r\n\tviewport(scaled, viewport) {\r\n\t\tif (_.isUndefined(scaled) || _.isNull(scaled)) scaled = false;\r\n\t\tif (!viewport) {\r\n\t\t\tvar vp = new Rectangle(0, 0, this.box.offsetWidth, this.box.offsetHeight);\r\n\t\t\tif (scaled)\r\n\t\t\t\treturn Utils.scale(this.translate, this.scale, vp);\r\n\t\t\treturn vp;\r\n\t\t}\r\n\t\tif (!scaled) viewport = Utils.scale(this.translate, this.scale, viewport);\r\n\t\tvar w = this.box.offsetWidth;\r\n\t\tvar scale = w / viewport.width;\r\n\t\tthis.transform(-viewport.x*scale, -viewport.y*scale, scale);\r\n\t}\r\n\r\n\tget translate() { return this._translate; }\r\n\tset translate(t) { this.transform(t[0], t[1]); }\r\n\tget scale() { return this._scale; }\r\n\tset scale(k) {\r\n\t\tswitch (k) {\r\n\t\t\tcase \"in\":\r\n\t\t\t\tk = this.scale * this.prop(\"zoomFactor\");\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"out\":\r\n\t\t\t\tk = this.scale / this.prop(\"zoomFactor\");\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"actual\":\r\n\t\t\t\tk = 1.0;\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"fit\":\r\n\t\t\t\tvar gridSize = this.prop(\"gridSize\") * 2;\r\n\r\n\t\t\t\tvar gBounds = this.getBounds();\r\n\t\t\t\tvar vBounds = this.viewport();\r\n\r\n\t\t\t\tvBounds.width -= gridSize;\r\n\t\t\t\tvBounds.height -= gridSize;\r\n\r\n\t\t\t\t/* Do not zoom more than actual if graph already fits into the bounds */\r\n\t\t\t\tk = Math.min((vBounds.width / gBounds.width), (vBounds.height /gBounds.height), 1.0);\r\n\r\n\t\t\t\t//TODO: Add centering code here or trigger an event for that\r\n\t\t\t\tbreak;\r\n\t\t\tdefault:\r\n\t\t\t\tif (_.isString(k)) k = parseFloat(k);\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\t\tthis.transform(null, null, k);\r\n\t}\r\n\r\n\ttransform(x = null, y = null, scale = null) {\r\n\t\tlet graph = this.graph;\r\n\t\tlet root = graph ? graph.currentRoot : null;\r\n\t\tif (!_.isNull(x)) {\r\n\t\t\tthis._translate[0] = x;\r\n\t\t\tif (root)\r\n\t\t\t\troot.viewProp(this.id, 'x', x);\r\n\t\t}\r\n\t\tif (!_.isNull(y)) {\r\n\t\t\tthis._translate[1] = y;\r\n\t\t\tif (root)\r\n\t\t\t\troot.viewProp(this.id, 'y', y);\r\n\t\t}\r\n\t\tif (!_.isNull(scale)) {\r\n\t\t\tthis._scale = scale;\r\n\t\t\tif (root)\r\n\t\t\t\troot.viewProp(this.id, 'scale', scale);\r\n\t\t\t// sync the scale between the dispatcher and the graph\r\n\t\t\tlet s = this.dispatcher.scale;\r\n\t\t\tif (s != scale)\r\n\t\t\t\tthis.dispatcher.scale = scale;\r\n\t\t}\r\n\t\tthis.refresh();\r\n\t}\r\n\r\n\trender() {\r\n\t\tif (!this._graph) return false;\r\n\t\tif (this.layout)\r\n\t\t\tthis.layout.layout(this._graph.currentRoot, this.viewport());\r\n\r\n\t\tthis.initializeBehaviors();\r\n\t\treturn true;\r\n\t}\r\n\r\n\trenderLabel(box) {\r\n\t\treturn this.constructor.renderLabel(box);\r\n\t}\r\n\r\n\trenderLink(shape) {\r\n\t\treturn this.constructor.renderLink(shape);\r\n\t}\r\n\r\n\trenderMarkers(markers) {\r\n\t\treturn this.constructor.renderMarkers(markers);\r\n\t}\r\n\r\n\tinitializeBehaviors() {\r\n\t\t// create the event dispatcher if necessary.\r\n\t\tif (!this.dispatcher) {\r\n\t\t\tthis.dispatcher = new EventDispatcher(this.box, [this.prop('minZoom'), this.prop('maxZoom')]);\r\n\t\t\tlet jsClass;\r\n\t\t\tif (this.prop('graphBehavior')) {\r\n\t\t\t\tjsClass = Utils.getConstructor(this.prop('graphBehavior'));\r\n\t\t\t\tthis.graphBehavior = new jsClass(this);\r\n\t\t\t}\r\n\t\t\tif (this.prop('selectionBehavior')) {\r\n\t\t\t\tjsClass = Utils.getConstructor(this.prop('selectionBehavior'));\r\n\t\t\t\tthis.selectionBehavior = new jsClass(this);\r\n\t\t\t}\r\n\t\t\t/*this.dispatcher.register('mouseup.node.label', function(type, ns, target, pos, event) {\r\n\t\t\t\tlet node = this._graph.nodes[target.getAttribute('id')];\r\n\t\t\t\tif (!this.dispatcher.dragging && !node._firstSelection) {\r\n\t\t\t\t\tLabel._delayEdit = _.delay(() => {\r\n\t\t\t\t\t\tif (Label._delayEdit) {\r\n\t\t\t\t\t\t\tdelete Label._delayEdit;\r\n\t\t\t\t\t\t\tLabel.editor.start(node.id, this.box, node.getLabelBox(this.id), target, event.nsTarget, this.scale);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}, 250);\r\n\t\t\t\t}\r\n\t\t\t}, this);\r\n\t\t\tthis.dispatcher.register([/^mousedown/, /^zoom/], function(type, ns, target, pos, event) {\r\n\t\t\t\tif (!DomUtils.eventFromInput(event)) {\r\n\t\t\t\t\tLabel.editor.stop();\r\n\t\t\t\t}\r\n\t\t\t}, this);*/\r\n\t\t}\r\n\t\tthis.dispatcher.start();\r\n\t}\r\n\r\n\trefresh() {}\r\n\r\n\t/**\r\n\t * Get the template for the specified key.\r\n\t * @param key\r\n\t * @param config if the template is a function, this config will be passed as the argument.\r\n\t * @param preprocessor if the template contains preprossing elements, such as #{shape}, the preprocessor will be\r\n\t * used to render them.\r\n\t * @returns {*}\r\n\t */\r\n\tgetTemplate(key, config, preprocessor) {\r\n\t\tvar t = this.constructor.TEMPLATES[key];\r\n\t\tif (t && _.isFunction(t)) {\r\n\t\t\tt = t(config);\r\n\t\t}\r\n\t\t// check if there are any preprocessing tags.\r\n\t\tif (preprocessor) {\r\n\t\t\tvar parts = t.match(/(#{[^#]*})/g);\r\n\t\t\tvar obj = {};\r\n\t\t\tfor (let part in parts) {\r\n\t\t\t\tpart = parts[part];\r\n\t\t\t\tpart = part.substring(2, part.length -1).trim();\r\n\t\t\t\tobj[part] = preprocessor[_.camelCase('render ' + part)](this);\r\n\t\t\t}\r\n\t\t\tt = _.template(t, {interpolate: /#{([\\s\\S]+?)}/g})(obj);\r\n\t\t}\r\n\t\treturn t;\r\n\t}\r\n\r\n\treset() {}\r\n\r\n\tdestroy() {\r\n\t\tdelete this._graph;\r\n\t\tdelete this.layout;\r\n\t\tif (this.dispatcher) {\r\n\t\t\tthis.dispatcher.stop();\r\n\t\t\tdelete this.dispatcher;\r\n\t\t}\r\n\t\tthis.box.innerHTML = '';\r\n\t}\r\n}\r\nRenderer.DEFAULTS = {\r\n\tdefaultClickMode: \"pan\",\r\n\thideOutline: false,\r\n\tsingleSelect: true,\r\n\tdraggable: true,\r\n\tgridEnabled: false,\r\n\tguidesEnabled: true,\r\n\tgridSize: 30,\r\n\tmaxZoom: 4.0,\r\n\tminZoom: 0.2,\r\n\tzoomFactor: 1.2,\r\n\tmaskOpacity: 0.5,\r\n\tgraphBehavior: GraphBehavior,\r\n\tselectionBehavior: SelectionBehavior\r\n};\r\n\r\nexport default Renderer;\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/view/Renderer.js\n **/","/**\r\n * Created by tong on 6/28/2016.\r\n */\r\nimport Behavior from \"./Behavior\";\r\n\r\n/**\r\n * Graph handler handles Panning and Zoom and rubber band selection\r\n */\r\nclass GraphBehavior extends Behavior {\r\n\tconstructor(renderer) {\r\n\t\tsuper(renderer);\r\n\t\tlet dispatcher = renderer.dispatcher;\r\n\t\tlet f = function(type, ns, graph, pos, event) {\r\n\t\t\t//Cursor.updateCursor(type, ns, graph, event);\r\n\t\t};\r\n\t\tdispatcher.register(/^drag.*\\.graph$/, this.handleDrag, this);\r\n\t\tdispatcher.register(/^zoom/, this.handleZoom, this);\r\n\t\t//dispatcher.register(['mousedown.graph', 'mouseenter.graph', 'mouseleave.graph'], f);\r\n\t\tthis.offset = null;\r\n\t}\r\n\r\n\thandleZoom(type, ns, graph, pos, event) {\r\n\t\tthis.renderer.transform(null, null, event.scale);\r\n\t}\r\n\r\n\thandleDrag(type, ns, graph, pos, event) {\r\n\t\tif (type == 'dragstart') {\r\n\t\t\tlet pan = (this.renderer.prop(\"defaultClickMode\") == \"pan\") ^ (event.ctrlKey || event.shiftKey);\r\n\t\t\tif (!pan) return;\r\n\t\t\tlet t = this.renderer.translate;\r\n\t\t\tthis.offset = [t[0] - pos[0], t[1] - pos[1]];\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tif (!this.offset) return;\r\n\t\tthis.renderer.transform(pos[0] + this.offset[0], pos[1] + this.offset[1]);\r\n\t\tif (type == 'dragend') {\r\n\t\t\t//Cursor.updateCursor('mouseup', ns, graph, event);\r\n\t\t\tdelete this.offset;\r\n\t\t}\r\n\t}\r\n}\r\n\r\nexport default GraphBehavior;\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/behavior/GraphBehavior.js\n **/","export default class Behavior {\r\n\tconstructor(renderer) {\r\n\t\tthis.renderer = renderer;\r\n\t}\r\n\r\n\tdestroy() {\r\n\t\tdelete this.renderer;\r\n\t}\r\n}\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/behavior/Behavior.js\n **/","import Rectangle from \"../geometry/Rectangle\";\r\nimport Cell from \"../graph/Cell\";\r\nimport Behavior from \"./Behavior\";\r\n\r\nclass SelectionBehavior extends Behavior {\r\n\tconstructor(renderer) {\r\n\t\tsuper(renderer);\r\n\t\tlet dispatcher = renderer.dispatcher;\r\n\t\tdispatcher.register('mousedown.*', this.selectCell, this);\r\n\t\tdispatcher.register('mouseup.*', this.unselectCell, this);\r\n\t\tdispatcher.register('drag*.graph', this.handleMultiSelect, this);\r\n\t\t//graph.on(Graph.EVENT_TYPES.SELECTION_CHANGE, this.updateSelections, this);\r\n\t\tthis.selectedNodes = null;\r\n\t\tthis.selectedLinks = null;\r\n\t\tthis.attachedLinks = null;\r\n\t}\r\n\r\n\tupdateSelections() {\r\n\t\tif (this.selectedNodes)\r\n\t\t\tthis.selectedNodes.classed('selected', false);\r\n\t\tif (this.selectedLinks)\r\n\t\t\tthis.selectedLinks.classed('selected', false);\r\n\r\n\t\tthis.selectedNodes = null;\r\n\t\tthis.selectedLinks = null;\r\n\t\tthis.attachedLinks = null;\r\n\r\n\t\tif (this.graph.selectedVertices && this.graph.selectedVertices.length > 0) {\r\n\t\t\tthis.selectedNodes = this.graph.renderer.getShapes(this.graph.selectedVertices);\r\n\t\t\tthis.attachedLinks = this.graph.renderer.getShapes(this.graph.getAttachedEdges());\r\n\t\t\tthis.selectedNodes.classed('selected', true);\r\n\t\t}\r\n\r\n\t\tif (this.graph.selectedEdges && this.graph.selectedEdges.length > 0) {\r\n\t\t\tthis.selectedLinks = this.graph.renderer.getShapes(this.graph.selectedEdges);\r\n\t\t\tthis.selectedLinks.classed('selected', true);\r\n\t\t}\r\n\t}\r\n\r\n\tselectCell(type, ns, data, pos, event) {\r\n\t\tvar cell = data == this.graph ? null : data;\r\n\t\tif (cell && !(cell instanceof Cell)) return;\r\n\t\tvar toggle = event.ctrlKey || event.shiftKey;\r\n\t\tif (cell && (cell instanceof Cell)) {\r\n\t\t\tif (!this.graph.isSelected(cell))\r\n\t\t\t\tdelete cell._firstSelection;\r\n\t\t\telse\r\n\t\t\t\tcell._firstSelection = true;\r\n\r\n\t\t\td3.select(event.dataTarget).moveToFront();\r\n\t\t\tthis.graph.setSelection(cell, toggle);\r\n\t\t}\r\n\t}\r\n\r\n\tunselectCell(type, ns, data, pos, event) {\r\n\t\tvar cell = data == this.graph ? null : data;\r\n\t\tif (cell && !(cell instanceof Cell)) return;\r\n\t\tvar ctrlKey = event.ctrlKey || event.shiftKey;\r\n\t\tif (!cell) {\r\n\t\t\tthis.graph.setSelection(cell, ctrlKey);\r\n\t\t}\r\n\t}\r\n\r\n\thandleMultiSelect(type, ns, data, pos, event) {\r\n\t\tpos = util.scale(this.graph, pos);\r\n\r\n\t\tif (type == 'dragstart') {\r\n\t\t\tvar select = (this.graph.getProperty(\"defaultClickMode\") == \"select\") ^ (event.ctrlKey || event.shiftKey);\r\n\t\t\tif (!select) return;\r\n\t\t\tthis.startPt = new Point(pos[0], pos[1]);\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tif (!this.startPt) return;\r\n\t\tvar rect = Rectangle.getBoundingRectangle([new Point(pos[0], pos[1]), this.startPt]);\r\n\t\tvar renderer = this.graph.renderer;\r\n\t\tif (!this.rubberband) {\r\n\t\t\tthis.rubberband = d3.select(renderer.appendNode(renderer.getCellLayer(), {\r\n\t\t\t\ttemplate: _.template('<g><rect x=\"0\" y=\"0\" width=\"100\" height=\"100\" stroke=\"#000000\" fill=\"none\" stroke-dasharray=\"3 3\"/></g>')\r\n\t\t\t}, false));\r\n\t\t}\r\n\t\tif (type == 'dragend') {\r\n\t\t\tvar cells = this.graph.getCurrentRoot().children;\r\n\t\t\t// TODO: Define if we want to select vertexes / edges or both\r\n\t\t\tcells = _.filter(cells, function (cell) {\r\n\t\t\t\tvar box = cell.getBounds();\r\n\t\t\t\tif (rect.contains(box)) {\r\n\t\t\t\t\treturn true;\r\n\t\t\t\t}\r\n\t\t\t\treturn false;\r\n\t\t\t});\r\n\t\t\t// TODO: Set selection\r\n\t\t\tthis.graph.setSelection(cells, event.ctrlKey);\r\n\r\n\t\t\tthis.rubberband.remove();\r\n\t\t\tdelete this.startPt;\r\n\t\t\tdelete this.rubberband;\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tthis.rubberband.select(\"rect\").attr({x: rect.x, y: rect.y, width: rect.width, height: rect.height});\r\n\t}\r\n\r\n\tdestroy() {\r\n\t\tsuper.destroy();\r\n\t\tdelete this.selectedNodes;\r\n\t\tdelete this.selectedLinks;\r\n\t\tdelete this.attachedLinks;\r\n\t}\r\n}\r\n\r\nexport default SelectionBehavior;\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/behavior/SelectionBehavior.js\n **/","import _ from \"lodash\";\nimport Base64 from \"../util/base64\";\nimport DomUtils from \"../util/DomUtils\";\nimport Renderer from \"./Renderer\";\nimport StringBuffer from \"../util/StringBuffer\";\n\nconst NS = 'http://www.w3.org/2000/svg';\nif (typeof (SVGElement) != \"undefined\") {\n\tvar svg = document.createElementNS(NS, \"svg\");\n\tsvg.innerHTML = '<circle/>';\n\tif (svg.firstChild !== \"[object SVGCircleElement]\") {\n\t\tObject.defineProperties(SVGElement.prototype, {\n\t\t\t\"outerHTML\": {\n\t\t\t\tenumerable: false,\n\t\t\t\tconfigurable: true,\n\t\t\t\tget: function() {\n\t\t\t\t\tvar $node, $temp;\n\t\t\t\t\t$temp = document.createElement('div');\n\t\t\t\t\t$node = this.cloneNode(true);\n\t\t\t\t\t$temp.appendChild($node);\n\t\t\t\t\treturn $temp.innerHTML;\n\t\t\t\t}\n\t\t\t},\n\t\t\t\"innerHTML\": {\n\t\t\t\tenumerable: false,\n\t\t\t\tconfigurable: true,\n\t\t\t\tget: function() {\n\t\t\t\t\tvar s = this.outerHTML;\n\t\t\t\t\tvar ropen = new RegExp(\"<\" + this.nodeName + '\\\\b(?:([\"\\'])[^\"]*?(\\\\1)|[^>])*>', \"i\");\n\t\t\t\t\tvar rclose = new RegExp(\"<\\/\" + this.nodeName + \">$\", \"i\");\n\t\t\t\t\treturn  s.replace(ropen, \"\").replace(rclose, \"\");\n\t\t\t\t},\n\t\t\t\tset: function(markup) {\n\t\t\t\t\t// empty el first.\n\t\t\t\t\tlet child;\n\t\t\t\t\twhile (child = this.lastChild)\n\t\t\t\t\t\tthis.removeChild(child);\n\t\t\t\t\tlet buf = new StringBuffer();\n\t\t\t\t\tbuf.append('<svg>').append(markup).append('</svg');\n\t\t\t\t\tlet $temp = DomUtils.createElement('div', null, null, buf.toString()).firstElementChild;\n\t\t\t\t\twhile ($temp.firstChild)\n\t\t\t\t\t\tthis.appendChild($temp.firstChild);\n\t\t\t\t}\n\t\t\t}\n\t\t})\n\t}\n\t// Define the toDataURL for SVG\n\tSVGElement.prototype.toDataURL = function(type, options = {}) {\n\t\tlet _svg = this;\n\n\t\tlet debug = function(msg) {};\n\n\t\tif (options['debug'] == true && typeof(console) != 'undefined')\n\t\t\tdebug = function(msg) { console.log(\"SVG.toDataURL:\", msg); };\n\n\t\tfunction exportSVG() {\n\t\t\tvar svg_xml = _svg.outerHTML;\n\t\t\tvar svg_dataurl = base64dataURLencode(svg_xml);\n\t\t\tdebug(type + \" length: \" + svg_dataurl.length);\n\n\t\t\t// NOTE double data carrier\n\t\t\tif (options.callback) options.callback(svg_dataurl);\n\t\t\treturn svg_dataurl;\n\t\t}\n\n\t\tfunction base64dataURLencode(s) {\n\t\t\tvar b64 = \"data:image/svg+xml;base64,\";\n\n\t\t\t// https://developer.mozilla.org/en/DOM/window.btoa\n\t\t\tif (window.btoa) {\n\t\t\t\tdebug(\"using window.btoa for base64 encoding\");\n\t\t\t\tb64 += btoa(s);\n\t\t\t} else {\n\t\t\t\tdebug(\"using custom base64 encoder\");\n\t\t\t\tb64 += Base64.encode(s);\n\t\t\t}\n\n\t\t\treturn b64;\n\t\t}\n\n\t\t// Native export doesn't work very well. should use canvg instead.\n\t\tfunction exportImage(type) {\n\t\t\tvar canvas = document.createElement(\"canvas\");\n\t\t\tvar ctx = canvas.getContext('2d');\n\n\t\t\t// TODO: if (options.keepOutsideViewport), do some translation magic?\n\n\t\t\tvar svg_img = new Image();\n\t\t\tvar svg_xml = _svg.outerHTML;\n\t\t\tsvg_img.src = base64dataURLencode(svg_xml);\n\n\t\t\tsvg_img.onload = function() {\n\t\t\t\tdebug(\"exported image size: \" + [svg_img.width, svg_img.height]);\n\t\t\t\tcanvas.width = svg_img.width;\n\t\t\t\tcanvas.height = svg_img.height;\n\t\t\t\tctx.drawImage(svg_img, 0, 0);\n\n\t\t\t\t// SECURITY_ERR WILL HAPPEN NOW\n\t\t\t\tvar image_dataurl = canvas.toDataURL(type);\n\t\t\t\tdebug(type + \" length: \" + image_dataurl.length);\n\n\t\t\t\tif (options.callback) options.callback( image_dataurl );\n\t\t\t\telse debug(\"WARNING: no callback set, so nothing happens.\");\n\t\t\t};\n\n\t\t\tsvg_img.onerror = function() {\n\t\t\t\tdebug(\n\t\t\t\t\t\"Can't export! Maybe your browser doesn't support \" +\n\t\t\t\t\t\"SVG in img element or SVG input for Canvas drawImage?\\n\" +\n\t\t\t\t\t\"http://en.wikipedia.org/wiki/SVG#Native_support\"\n\t\t\t\t);\n\t\t\t};\n\n\t\t\t// NOTE: will not return anything\n\t\t}\n\n\t\tfunction exportImageCanvg(type) {\n\t\t\tif (!canvg) return null;\n\t\t\tlet canvas = DomUtils.createElement('canvas', null, {display: \"none\"});\n\t\t\tdocument.body.appendChild(canvas);\n\t\t\tif (type == 'javascript') {\n\t\t\t\tvar xcanvas = new jsCanvas ('jscanvastest');\n\t\t\t\txcanvas.canvas.style.display = 'none';\n\t\t\t\t//xcanvas.canvas = canvas;\n\t\t\t}\n\n\t\t\tif (!options.keepOutsideViewport) {\n\t\t\t\tcanvg(canvas, _svg.outerHTML);\n\t\t\t} else {\n\t\t\t\tlet padding = options.padding || 0;\n\t\t\t\tlet scale = 1.0;\n\t\t\t\tlet translate = [0, 0];\n\t\t\t\tlet bbox = _svg.getBBox();\n\t\t\t\tdebug(\"detected svg dimensions \" + [bbox.x, bbox.y, bbox.width, bbox.height]);\n\t\t\t\tlet transform = _svg.firstElementChild.getAttribute('transform');\n\t\t\t\tif (transform) {\n\t\t\t\t\tdebug('detected svg transform ' + transform);\n\t\t\t\t\ttransform = SVGRenderer.transform(transform);\n\t\t\t\t\ttranslate = transform.translate;\n\t\t\t\t\tscale = transform.scale;\n\t\t\t\t}\n\t\t\t\tlet buf = new StringBuffer();\n\t\t\t\tbuf.append('<svg width=\"').append(bbox.width + 2*padding).append('px\" height=\"').append(bbox.height + 2*padding).append('px\"><g transform=\"translate(')\n\t\t\t\t\t.append(-bbox.x+translate[0]+padding).append(',').append(-bbox.y+translate[1]+padding).append(')scale(').append(scale).append(')\">')\n\t\t\t\t\t.append(_svg.firstElementChild.innerHTML).append('</g></svg>');\n\t\t\t\tif (type == 'javascript') {\n\t\t\t\t\txcanvas.compile(buf.toString(), function () {\n\t\t\t\t\t\tif (options.callback) options.callback(xcanvas.toString());\n\t\t\t\t\t});\n\t\t\t\t\treturn;\n\t\t\t\t} else\n\t\t\t\t\tcanvg(canvas, buf.toString());\n\t\t\t}\n\t\t\tvar image_dataurl = canvas.toDataURL(type);\n\t\t\tif (options.callback) options.callback( image_dataurl );\n\t\t\tcanvas.parentNode.removeChild(canvas);\n\t\t\treturn image_dataurl;\n\t\t}\n\n\t\tif (!type) type = \"image/svg+xml\";\n\n\t\tif (options.keepNonSafe) debug(\"NOTE: keepNonSafe is NOT supported and will be ignored!\");\n\t\tif (options.keepOutsideViewport) debug(\"NOTE: keepOutsideViewport is only supported with canvg exporter.\");\n\n\t\tswitch (type) {\n\t\t\tcase \"image/svg+xml\":\n\t\t\t\treturn exportSVG();\n\t\t\tcase \"image/png\":\n\t\t\tcase \"image/jpeg\":\n\t\t\tcase \"javascript\":\n\t\t\t\tif (!options.renderer) {\n\t\t\t\t\tif (window.canvg) options.renderer = \"canvg\";\n\t\t\t\t\telse options.renderer=\"native\";\n\t\t\t\t}\n\t\t\t\tswitch (options.renderer) {\n\t\t\t\t\tcase \"canvg\":\n\t\t\t\t\t\tdebug(\"using canvg renderer for \" + type + \" image export\");\n\t\t\t\t\t\treturn exportImageCanvg(type);\n\t\t\t\t\tcase \"native\":\n\t\t\t\t\t\tdebug(\"using native renderer for \" + type + \" export. THIS MIGHT FAIL.\");\n\t\t\t\t\t\treturn exportImage(type);\n\t\t\t\t\tdefault:\n\t\t\t\t\t\tdebug(\"unknown image renderer given, doing noting (\" + options.renderer + \")\");\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tdebug(\"Sorry! Exporting as '\" + type + \"' is not supported!\");\n\t\t}\n\t\treturn null;\n\t}\n}\n\nclass SVGRenderer extends Renderer {\n\trender() {\n\t\tlet result = super.render();\n\t\tif (result) {\n\t\t\tlet root = this.graph.currentRoot;\n\t\t\tlet buf = new StringBuffer('<svg width=\"100%\" height=\"100%\" xmlns=\"http://www.w3.org/2000/svg\">');\n\t\t\tlet t = this.translate;\n\t\t\tbuf.append('<g transform=\"translate(').append(t[0]).append(',').append(t[1]).append(')scale(').append(this.scale).append(')\">');\n\t\t\tbuf.append(this.renderDefs());\n\t\t\tbuf.append(root.render(this));\n\t\t\tbuf.append('</g></svg>');\n\t\t\tthis.box.innerHTML = buf.toString();\n\t\t\tthis.svg = this.box.firstElementChild;\n\t\t}\n\t}\n\n\trenderDefs() {\n\t\tlet buf = new StringBuffer('<defs>');\n\t\tbuf.append(this.getTemplate('Grid', this.prop(\"gridSize\")));\n\t\tlet markers = this.graph.markers;\n\t\tif (markers.length > 0)\n\t\t\tbuf.append(SVGRenderer.renderMarkers(markers));\n\t\tbuf.append('</defs>');\n\t\treturn buf.toString();\n\t}\n\n\trefresh() {\n\t\tif (!this.svg) return;\n\t\tlet g = this.svg.querySelector('g');\n\t\tlet t = this.translate;\n\t\tg.setAttribute('transform', 'translate(' + t[0] + ',' + t[1] + ')scale(' + this.scale + ')');\n\t}\n\n\tstatic renderMarkers(markers) {\n\t\tlet buf = new StringBuffer(), str1, str2;\n\t\tmarkers.forEach(function(marker) {\n\t\t\tstr1 = this.TEMPLATES['Marker'](marker);\n\t\t\tstr2 = marker.shape;\n\t\t\tif (!_.isString(str2))\n\t\t\t\tstr2 = this.renderShape(str2);\n\t\t\tstr1 = str1.replace(/\\#\\{shape\\}/, str2);\n\t\t\tbuf.append(str1);\n\t\t}, this);\n\t\treturn buf.toString();\n\t}\n\n\tstatic renderLabel(box) {\n\t\treturn this.TEMPLATES['Label'](box);\n\t}\n\n\tstatic renderShape(shape) {\n\t\tlet template = this.TEMPLATES[shape.name];\n\t\tif (_.isString(template))\n\t\t\ttemplate = _.template(template);\n\t\treturn template(shape);\n\t}\n\n\tstatic getPathData(shape) {\n\t\tlet points = shape.points;\n\t\tlet controlPts = shape.controlPts;\n\t\tif (!points || points.length == 0) return '';\n\n\t\tif (!controlPts && shape.round) {\n\t\t\t// render rounded line joins.\n\t\t\tlet newPts = [];\n\t\t\tcontrolPts = [];\n\t\t\tlet prev = points[0], next, d1, d2, corner;\n\t\t\tnewPts.push(prev);\n\t\t\tfor (let i = 1; i < points.length - 1; i++) {\n\t\t\t\tnext = points[i];\n\t\t\t\t// set the control point first.\n\t\t\t\tcontrolPts[2*i] = [next, next];\n\t\t\t\t// check the size of the corner.\n\t\t\t\td1 = prev.distance(next);\n\t\t\t\td2 = next.distance(points[i+1]);\n\t\t\t\tcorner = Math.min(shape.round, d1/2, d2/2);\n\t\t\t\t// split the point into two.\n\t\t\t\tnewPts.push(next.getDirection(prev).scale(corner).translate(next));\n\t\t\t\tnewPts.push(next.getDirection(points[i+1]).scale(corner).translate(next));\n\t\t\t\tprev = next;\n\t\t\t}\n\t\t\tnewPts.push(points[points.length - 1]);\n\t\t\tpoints = newPts;\n\t\t}\n\t\tlet buf = new StringBuffer('M'), point;\n\t\tfor (let i = 0; i < points.length; i++) {\n\t\t\tpoint = points[i];\n\t\t\tif (i == 0)\n\t\t\t\tbuf.append(point);\n\t\t\telse {\n\t\t\t\tif (controlPts && controlPts[i]) {\n\t\t\t\t\tbuf.append(' C ');\n\t\t\t\t\tfor (let j = 0; j < controlPts[i].length; j++)\n\t\t\t\t\t\tbuf.append(controlPts[i][j]).append(' ');\n\t\t\t\t\tbuf.append(point);\n\t\t\t\t} else\n\t\t\t\t\tbuf.append(' L ').append(point);\n\t\t\t}\n\t\t}\n\t\treturn buf.toString();\n\t}\n\n\tstatic renderLink(shape) {\n\t\tlet buf = new StringBuffer();\n\t\tlet d = SVGRenderer.getPathData(shape);\n\t\tif (shape.showGauge)\n\t\t\tbuf.append('<path style=\"stroke: white; stroke-width: 9; visibility: hidden; pointer-events: stroke;\" d=\"')\n\t\t\t\t.append(d).append('\"/>');\n\t\tbuf.append('<path d=\"').append(d).append('\"');\n\t\tif (shape.startMarker || shape.endMarker) {\n\t\t\tbuf.append(' style=\"');\n\t\t\tif (shape.startMarker)\n\t\t\t\tbuf.append('marker-start: url(#').append(_.isString(shape.startMarker) ? shape.startMarker : shape.startMarker.id).append(');');\n\t\t\tif (shape.endMarker)\n\t\t\t\tbuf.append('marker-end: url(#').append(_.isString(shape.endMarker) ? shape.endMarker : shape.endMarker.id).append(');');\n\t\t\tbuf.append('\"');\n\t\t}\n\t\tbuf.append('/>');\n\t\treturn buf.toString();\n\t}\n\n\tstatic appendContent(el, content) {\n\t\tlet buf = new StringBuffer();\n\t\tbuf.append('<svg>').append(content).append('</svg');\n\t\tlet temp = DomUtils.createElement('div', null, null, buf.toString()).firstElementChild;\n\n\t\twhile (temp.firstChild)\n\t\t\tel.appendChild(temp.firstChild);\n\t\treturn el;\n\t}\n\n\tstatic transform(transform) {\n\t\tlet translate = [0, 0], scale = 1.0;\n\t\t//\n\t\tlet parts = transform.match(/translate\\(\\s*([^)]+)/);\n\t\tif (parts) {\n\t\t\tlet m = parts[1].trim().match(/([\\d.-]+)[ ,]([\\d.-]+)/);\n\t\t\tif (m) {\n\t\t\t\ttranslate[0] = parseFloat(m[1]) || 0;\n\t\t\t\ttranslate[1] = parseFloat(m[2]) || 0;\n\t\t\t} else\n\t\t\t\ttranslate[0] = translate[1] = parseFloat(parts[1]);\n\t\t}\n\t\tparts = transform.match(/scale\\(\\s*([^)]+)/);\n\t\tif (parts)\n\t\t\tscale = parseFloat(parts[1]) || 1.0;\n\n\t\treturn {translate, scale};\n\t}\n}\nSVGRenderer.TEMPLATES = {\n\t$root: '<g id=\"${id}\" class=\"${className}\">#{children}</g>',\n\t$node: '<g id=\"${id}\" class=\"${className}\" style=\"${style}\" ns=\"${namespace}\" transform=\"translate(${x},${y})\">#{shape}#{label}</g>',\n\t$edge: '<g id=\"${id}\" class=\"${className}\" style=\"${style}\" ns=\"${namespace}\">#{shape}#{label}</g>',\n\tEllipse: '<ellipse cx=\"0\" cy=\"0\" rx=\"${width/2}\" ry=\"${height/2}\"/>',\n\tRectangle: '<rect x=\"${-width/2}\" y=\"${-height/2}\" width=\"${width}\" height=\"${height}\" rx=\"9\" ry=\"9\"/>',\n\tTriangle: '<polygon points=\"${-width/2},${-height/2} ${width/2},${-height/2} 0,${height/2}\"/>',\n\tRhombus: '<polygon points=\"0,${-height/2} ${width/2},0 0,${height/2} ${-width/2},0\"/>',\n\tHexagon: function(config) {\n\t\tvar vertical = config.direction == 'north' || config.direction == 'south';\n\t\tif (vertical)\n\t\t\treturn '<polygon points=\"0,${-height/2} ${width/2},${-height/4} ${width/2},${height/4} 0,${height/2} ${-width/2},${height/4} ${-width/2},${-height/4}\"/>';\n\t\telse\n\t\t\treturn '<polygon points=\"${-width/2},0 ${width/4},${-height/2} ${width/4},${-height/2} ${width/2},0 ${width/4},${height/2} ${-width/4},${height/2}\"/>';\n\t},\n\tPolygon: function(shape) {\n\t\tlet buf = new StringBuffer('<polygon points=\"');\n\t\tshape.points.forEach(function(pt){\n\t\t\tbuf.append(pt[0]).append(',').append(pt[1]).append(' ');\n\t\t});\n\t\tbuf.removeLast();\n\t\tbuf.append('\"/>');\n\t\treturn buf.toString();\n\t},\n\tImage: function(config) {\n\t\treturn '<image x=\"${-width/2}\" y=\"${-height/2}\" width=\"${width}\" height=\"${height}\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" xlink:href=\"' + config.image + '\"/>';\n\t},\n\tMarker: function(marker) {\n\t\treturn `\n<marker id=\"${marker.id}\" markerWidth=\"${marker.size}\" markerHeight=\"${marker.size}\" refx=\"${marker.ref[0]}\" \nrefy=\"${marker.ref[1]}\" orient=\"auto\" viewbox=\"${marker.viewBox.x} ${marker.viewBox.y} ${marker.viewBox.width} ${marker.viewBox.height}\"\nmarkerUnits=\"userSpaceOnUse\" ${marker.fill ? `style=\"stroke: ${marker.fill};fill:${marker.fill}\"` : ''}>#{shape}</marker>\n`.trim();\n\t},\n\tGrid: function(size) {\n\t\treturn `\n<pattern id=\"GridPattern\" width=\"${size}\" height=\"${size}\" patternUnits=\"userSpaceOnUse\">\n\t<ellipse cx=\"0\" cy=\"0\" rx=\"1\" ry=\"1\" fill=\"#999999\"/>\n\t<ellipse cx=\"0\" cy=\"${size}\" rx=\"1\" ry=\"1\" fill=\"#999999\"/>\n\t<ellipse cx=\"${size}\" cy=\"0\" rx=\"1\" ry=\"1\" fill=\"#999999\"/>\n\t<ellipse cx=\"${size}\" cy=\"${size}\" rx=\"1\" ry=\"1\" fill=\"#999999\"/>\n</pattern>`.trim();\n\t},\n\tLabel: _.template(`\n<% var box = _.has(data, \"dx\") ? data : (data.getLabelBox ? data.getLabelBox() : null); \n   if (box) {%>\n\t<g <% if (box.config && box.config.class) {%>class=\"<%=box.config.class%>\"<%}%>\\\n\t\t<% if (box.config && box.config.ns) {%>ns=\"<%=box.config.ns%>\"<%}%>\\\n\t\t<% if (box.config && box.config.inlineStyle) {%>\\\n\t\t\tfont-size=\"<%=box.config.fontSize%>\"\\\n\t\t\tfont-family=\"<%=box.config.fontFamily%>\"\\\n\t\t\tfont-weight=\"<% if (box.bold) {%>bold<%} else {%>normal<%}%>\"\\\n\t\t\t<% if (box.underline) {%>text-decoration=\"underline\"<%}%>\\\n\t\t\t<% if (box.italic) {%>font-style=\"italic\"<%}%>\\\n\t\t<%}%>\\\n\t\ttext-anchor=\"<%=box.anchor%>\"\\\n\t\ttransform=\"translate(<%=box.bounds.x%>,<%=box.bounds.y%>)<% if (box.config && box.config.rotation) {%>rotate(<%=box.config.rotation%> <%=box.pivot[0]%> <%=box.pivot[1]%>)<%}%>\">\n\t<% if (box.config.backgroundStyle) {%>\n\t\t<rect x=\"<%=-box.bounds.width/2%>\" y=\"<%=-box.bounds.height/2%>\" width=\"<%=box.bounds.width%>\" height=\"<%=box.bounds.height%>\" style=\"<%=box.config.backgroundStyle%>\"/>\n\t<% } if (_.isArray(box.label)) { \n\t\t_.each(box.label, function(value, line) {%>\n\t\t\t<text <% if (box.config && box.config.textStyle) {%>style=\"<%=box.config.textStyle%>\"<%}%>\\\n\t\t\t\tdx=\"<%=box.dx%>\" dy=\"<%=box.dy + box.lineHeight * line%>\"><%=value%></text>\n\t\t<%});} else { %>\n\t\t\t<text><%=box.label%></text>\n\t\t<%}%>\n\t\t<% if (box.config.title) {%>\n\t\t\t<title><%=box.config.title%></title>\n\t\t<%}%>\n\t</g>\n<%}%>\n`.trim(), {variable: \"data\"})   //TODO add more inline text styles.\n};\n\nexport default SVGRenderer;\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/view/SVGRenderer.js\n **/"]}